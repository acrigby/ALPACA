{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5393124654889108, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.473971339066823, "policy_loss": -0.05084460806101561, "vf_loss": 7.510175555944443, "vf_explained_var": 0.016113569339116413, "kl": 0.014640406521933378, "entropy": 1.3488767206668855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 1026, "num_env_steps_trained": 1026, "num_agent_steps_sampled": 1026, "num_agent_steps_trained": 1026}, "sampler_results": {"episode_reward_max": 53.40723597191311, "episode_reward_min": -41.958557128906364, "episode_reward_mean": -8.533202837730386, "episode_len_mean": 6.379746835443038, "episode_media": {}, "episodes_this_iter": 158, "episodes_timesteps_total": 1008, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.547178352328558, -12.602584886154034, 1.1238133233901522, -23.801745605468682, -34.73566894531257, -27.04299316406241, -1.05693382391172, 20.446704590457728, 5.114427593754726, 2.0100921518731383, 18.236303270660684, -8.131738757280857, -9.05224942401503, -20.84130859375, 15.169904188905548, -26.12875976562509, -22.219433593750182, -15.866371242497792, -15.008605957031136, 0.07878417968765916, 2.8191369071020063, -20.55253286287268, -5.908056640625091, -16.69044345818594, -20.98608021937588, 44.08536987152354, 4.9099022834100765, -10.919060231174228, 21.504417157160788, -21.930371093750068, -41.958557128906364, -13.433995363425836, -1.694336016020955, 4.502164945510501, -4.478942871093636, -18.094389774961996, -0.023757729946353834, 14.104931640625068, -28.508241129643537, -30.888598632812432, 24.575357047027637, 46.71158082710484, -11.758953572748624, -19.594459108024083, -20.229380935117774, -7.597970769628731, -10.584240722656318, -18.617238863720672, -19.344470214843682, 4.422619628906318, -6.692092919245127, -24.180543480835198, -25.896191406250068, -19.969715003652354, -9.744409075930491, 26.083801269531364, -12.82770948085654, -9.21669205398149, -21.891367392873576, -33.31352539062493, -17.162191602881265, 28.885208452461924, 2.48253744507133, -2.46403451416154, 10.86577239454482, -21.65737794237623, 53.40723597191311, -34.73566894531257, -11.445068359374773, -5.449352118727916, -19.070574047484286, -17.146319484830997, 13.9119222097911, -20.49717414204781, -29.168896484375068, 3.51970427725945, -23.27233351720787, -9.201611328125068, -4.016388536797223, -28.236145019531136, -29.907153320312432, -2.030958858615577, 8.964928969254103, -13.287485495742658, 8.049179336573445, -28.436718750000068, -5.843667852363353, -12.607499562207522, 2.9267673818799693, 4.449023437499932, -31.466235351562432, -19.128627120872764, -24.242570047237635, -19.78459980411658, 4.5858301657811325, -11.24555207262354, 0.4757542570575879, 11.91423820852981, -30.502697753906318, -9.374016059609062, -0.6377132266109271, -15.124840920839148, -13.978724415015222, 0.679752369170842, -7.267343394827094, -1.2701817951279395, 43.10681177353257, -30.586853027343864, -15.22934732620179, -12.095434570312591, -9.130932617187682, -27.155773925781318, 10.66944081517886, -8.349264892380063, -16.037924126263363, -3.1175043142303593, -6.3712652650472705, -28.146923247500993, 2.0560856113498858, -26.669262695312568, -1.193535852249795, -21.996984863281227, -22.371350097656318, 7.646643066406227, -17.56880231516783, -19.332849121093773, -23.238342285156136, -12.94885760422649, -12.544946778318163, -20.832214355468636, -2.177722167968682, -11.737280273437364, 4.1744157593166165, 4.772725636872337, 27.104239236741222, -22.411994817703842, -28.705432128906182, -10.291533438605825, -20.949276296556107, -26.382275390625068, -6.472873713203683, -5.647058105468659, 1.5612583497264723, -24.46891848469687, -10.185974802183253, -12.112591566316325, -26.821826171874818, -13.109543894353578, -18.125756835937523, -1.3594551672636612, 33.90640993279658, -7.655346679687568, -9.38054168762045, -19.80630709031533, -5.6040388890043005, -2.122180175781182, -18.761657714843636, 1.1683279755889089], "episode_lengths": [8, 13, 5, 3, 3, 8, 7, 6, 6, 6, 7, 6, 5, 6, 7, 4, 8, 8, 5, 11, 5, 3, 4, 4, 3, 20, 6, 8, 8, 3, 9, 3, 5, 4, 9, 3, 4, 15, 3, 3, 16, 20, 6, 3, 3, 6, 3, 3, 9, 3, 5, 7, 3, 5, 6, 19, 4, 4, 3, 3, 7, 12, 4, 7, 6, 3, 25, 3, 10, 5, 11, 4, 16, 3, 3, 4, 9, 3, 5, 5, 3, 4, 4, 8, 7, 3, 8, 8, 9, 7, 3, 5, 5, 6, 8, 9, 6, 7, 3, 3, 5, 4, 6, 6, 6, 6, 20, 5, 5, 4, 8, 3, 8, 4, 8, 3, 6, 3, 11, 3, 5, 9, 3, 5, 5, 5, 5, 4, 7, 5, 3, 6, 5, 6, 12, 4, 3, 7, 4, 3, 4, 6, 14, 6, 5, 10, 8, 7, 5, 4, 9, 3, 5, 5, 9, 3, 5, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.798039170198656, "mean_inference_ms": 1.3146430104839335, "mean_action_processing_ms": 0.21227845943496976, "mean_env_wait_ms": 649.502257625952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010669581114539235, "StateBufferConnector_ms": 0.03012523656871536, "ViewRequirementAgentConnector_ms": 0.19061831985344865}, "num_episodes": 158, "episode_return_max": 53.40723597191311, "episode_return_min": -41.958557128906364, "episode_return_mean": -8.533202837730386}, "env_runner_results": {"episode_reward_max": 53.40723597191311, "episode_reward_min": -41.958557128906364, "episode_reward_mean": -8.533202837730386, "episode_len_mean": 6.379746835443038, "episode_media": {}, "episodes_this_iter": 158, "episodes_timesteps_total": 1008, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.547178352328558, -12.602584886154034, 1.1238133233901522, -23.801745605468682, -34.73566894531257, -27.04299316406241, -1.05693382391172, 20.446704590457728, 5.114427593754726, 2.0100921518731383, 18.236303270660684, -8.131738757280857, -9.05224942401503, -20.84130859375, 15.169904188905548, -26.12875976562509, -22.219433593750182, -15.866371242497792, -15.008605957031136, 0.07878417968765916, 2.8191369071020063, -20.55253286287268, -5.908056640625091, -16.69044345818594, -20.98608021937588, 44.08536987152354, 4.9099022834100765, -10.919060231174228, 21.504417157160788, -21.930371093750068, -41.958557128906364, -13.433995363425836, -1.694336016020955, 4.502164945510501, -4.478942871093636, -18.094389774961996, -0.023757729946353834, 14.104931640625068, -28.508241129643537, -30.888598632812432, 24.575357047027637, 46.71158082710484, -11.758953572748624, -19.594459108024083, -20.229380935117774, -7.597970769628731, -10.584240722656318, -18.617238863720672, -19.344470214843682, 4.422619628906318, -6.692092919245127, -24.180543480835198, -25.896191406250068, -19.969715003652354, -9.744409075930491, 26.083801269531364, -12.82770948085654, -9.21669205398149, -21.891367392873576, -33.31352539062493, -17.162191602881265, 28.885208452461924, 2.48253744507133, -2.46403451416154, 10.86577239454482, -21.65737794237623, 53.40723597191311, -34.73566894531257, -11.445068359374773, -5.449352118727916, -19.070574047484286, -17.146319484830997, 13.9119222097911, -20.49717414204781, -29.168896484375068, 3.51970427725945, -23.27233351720787, -9.201611328125068, -4.016388536797223, -28.236145019531136, -29.907153320312432, -2.030958858615577, 8.964928969254103, -13.287485495742658, 8.049179336573445, -28.436718750000068, -5.843667852363353, -12.607499562207522, 2.9267673818799693, 4.449023437499932, -31.466235351562432, -19.128627120872764, -24.242570047237635, -19.78459980411658, 4.5858301657811325, -11.24555207262354, 0.4757542570575879, 11.91423820852981, -30.502697753906318, -9.374016059609062, -0.6377132266109271, -15.124840920839148, -13.978724415015222, 0.679752369170842, -7.267343394827094, -1.2701817951279395, 43.10681177353257, -30.586853027343864, -15.22934732620179, -12.095434570312591, -9.130932617187682, -27.155773925781318, 10.66944081517886, -8.349264892380063, -16.037924126263363, -3.1175043142303593, -6.3712652650472705, -28.146923247500993, 2.0560856113498858, -26.669262695312568, -1.193535852249795, -21.996984863281227, -22.371350097656318, 7.646643066406227, -17.56880231516783, -19.332849121093773, -23.238342285156136, -12.94885760422649, -12.544946778318163, -20.832214355468636, -2.177722167968682, -11.737280273437364, 4.1744157593166165, 4.772725636872337, 27.104239236741222, -22.411994817703842, -28.705432128906182, -10.291533438605825, -20.949276296556107, -26.382275390625068, -6.472873713203683, -5.647058105468659, 1.5612583497264723, -24.46891848469687, -10.185974802183253, -12.112591566316325, -26.821826171874818, -13.109543894353578, -18.125756835937523, -1.3594551672636612, 33.90640993279658, -7.655346679687568, -9.38054168762045, -19.80630709031533, -5.6040388890043005, -2.122180175781182, -18.761657714843636, 1.1683279755889089], "episode_lengths": [8, 13, 5, 3, 3, 8, 7, 6, 6, 6, 7, 6, 5, 6, 7, 4, 8, 8, 5, 11, 5, 3, 4, 4, 3, 20, 6, 8, 8, 3, 9, 3, 5, 4, 9, 3, 4, 15, 3, 3, 16, 20, 6, 3, 3, 6, 3, 3, 9, 3, 5, 7, 3, 5, 6, 19, 4, 4, 3, 3, 7, 12, 4, 7, 6, 3, 25, 3, 10, 5, 11, 4, 16, 3, 3, 4, 9, 3, 5, 5, 3, 4, 4, 8, 7, 3, 8, 8, 9, 7, 3, 5, 5, 6, 8, 9, 6, 7, 3, 3, 5, 4, 6, 6, 6, 6, 20, 5, 5, 4, 8, 3, 8, 4, 8, 3, 6, 3, 11, 3, 5, 9, 3, 5, 5, 5, 5, 4, 7, 5, 3, 6, 5, 6, 12, 4, 3, 7, 4, 3, 4, 6, 14, 6, 5, 10, 8, 7, 5, 4, 9, 3, 5, 5, 9, 3, 5, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.798039170198656, "mean_inference_ms": 1.3146430104839335, "mean_action_processing_ms": 0.21227845943496976, "mean_env_wait_ms": 649.502257625952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010669581114539235, "StateBufferConnector_ms": 0.03012523656871536, "ViewRequirementAgentConnector_ms": 0.19061831985344865}, "num_episodes": 158, "episode_return_max": 53.40723597191311, "episode_return_min": -41.958557128906364, "episode_return_mean": -8.533202837730386}, "episode_reward_max": 53.40723597191311, "episode_reward_min": -41.958557128906364, "episode_reward_mean": -8.533202837730386, "episode_len_mean": 6.379746835443038, "episodes_this_iter": 158, "episodes_timesteps_total": 1008, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.547178352328558, -12.602584886154034, 1.1238133233901522, -23.801745605468682, -34.73566894531257, -27.04299316406241, -1.05693382391172, 20.446704590457728, 5.114427593754726, 2.0100921518731383, 18.236303270660684, -8.131738757280857, -9.05224942401503, -20.84130859375, 15.169904188905548, -26.12875976562509, -22.219433593750182, -15.866371242497792, -15.008605957031136, 0.07878417968765916, 2.8191369071020063, -20.55253286287268, -5.908056640625091, -16.69044345818594, -20.98608021937588, 44.08536987152354, 4.9099022834100765, -10.919060231174228, 21.504417157160788, -21.930371093750068, -41.958557128906364, -13.433995363425836, -1.694336016020955, 4.502164945510501, -4.478942871093636, -18.094389774961996, -0.023757729946353834, 14.104931640625068, -28.508241129643537, -30.888598632812432, 24.575357047027637, 46.71158082710484, -11.758953572748624, -19.594459108024083, -20.229380935117774, -7.597970769628731, -10.584240722656318, -18.617238863720672, -19.344470214843682, 4.422619628906318, -6.692092919245127, -24.180543480835198, -25.896191406250068, -19.969715003652354, -9.744409075930491, 26.083801269531364, -12.82770948085654, -9.21669205398149, -21.891367392873576, -33.31352539062493, -17.162191602881265, 28.885208452461924, 2.48253744507133, -2.46403451416154, 10.86577239454482, -21.65737794237623, 53.40723597191311, -34.73566894531257, -11.445068359374773, -5.449352118727916, -19.070574047484286, -17.146319484830997, 13.9119222097911, -20.49717414204781, -29.168896484375068, 3.51970427725945, -23.27233351720787, -9.201611328125068, -4.016388536797223, -28.236145019531136, -29.907153320312432, -2.030958858615577, 8.964928969254103, -13.287485495742658, 8.049179336573445, -28.436718750000068, -5.843667852363353, -12.607499562207522, 2.9267673818799693, 4.449023437499932, -31.466235351562432, -19.128627120872764, -24.242570047237635, -19.78459980411658, 4.5858301657811325, -11.24555207262354, 0.4757542570575879, 11.91423820852981, -30.502697753906318, -9.374016059609062, -0.6377132266109271, -15.124840920839148, -13.978724415015222, 0.679752369170842, -7.267343394827094, -1.2701817951279395, 43.10681177353257, -30.586853027343864, -15.22934732620179, -12.095434570312591, -9.130932617187682, -27.155773925781318, 10.66944081517886, -8.349264892380063, -16.037924126263363, -3.1175043142303593, -6.3712652650472705, -28.146923247500993, 2.0560856113498858, -26.669262695312568, -1.193535852249795, -21.996984863281227, -22.371350097656318, 7.646643066406227, -17.56880231516783, -19.332849121093773, -23.238342285156136, -12.94885760422649, -12.544946778318163, -20.832214355468636, -2.177722167968682, -11.737280273437364, 4.1744157593166165, 4.772725636872337, 27.104239236741222, -22.411994817703842, -28.705432128906182, -10.291533438605825, -20.949276296556107, -26.382275390625068, -6.472873713203683, -5.647058105468659, 1.5612583497264723, -24.46891848469687, -10.185974802183253, -12.112591566316325, -26.821826171874818, -13.109543894353578, -18.125756835937523, -1.3594551672636612, 33.90640993279658, -7.655346679687568, -9.38054168762045, -19.80630709031533, -5.6040388890043005, -2.122180175781182, -18.761657714843636, 1.1683279755889089], "episode_lengths": [8, 13, 5, 3, 3, 8, 7, 6, 6, 6, 7, 6, 5, 6, 7, 4, 8, 8, 5, 11, 5, 3, 4, 4, 3, 20, 6, 8, 8, 3, 9, 3, 5, 4, 9, 3, 4, 15, 3, 3, 16, 20, 6, 3, 3, 6, 3, 3, 9, 3, 5, 7, 3, 5, 6, 19, 4, 4, 3, 3, 7, 12, 4, 7, 6, 3, 25, 3, 10, 5, 11, 4, 16, 3, 3, 4, 9, 3, 5, 5, 3, 4, 4, 8, 7, 3, 8, 8, 9, 7, 3, 5, 5, 6, 8, 9, 6, 7, 3, 3, 5, 4, 6, 6, 6, 6, 20, 5, 5, 4, 8, 3, 8, 4, 8, 3, 6, 3, 11, 3, 5, 9, 3, 5, 5, 5, 5, 4, 7, 5, 3, 6, 5, 6, 12, 4, 3, 7, 4, 3, 4, 6, 14, 6, 5, 10, 8, 7, 5, 4, 9, 3, 5, 5, 9, 3, 5, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.798039170198656, "mean_inference_ms": 1.3146430104839335, "mean_action_processing_ms": 0.21227845943496976, "mean_env_wait_ms": 649.502257625952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010669581114539235, "StateBufferConnector_ms": 0.03012523656871536, "ViewRequirementAgentConnector_ms": 0.19061831985344865}, "num_episodes": 158, "episode_return_max": 53.40723597191311, "episode_return_min": -41.958557128906364, "episode_return_mean": -8.533202837730386, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026, "num_agent_steps_trained": 1026, "num_env_steps_sampled": 1026, "num_env_steps_trained": 1026, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 7.352679346610647, "num_env_steps_trained_throughput_per_sec": 7.352679346610647, "timesteps_total": 1026, "num_env_steps_sampled_lifetime": 1026, "num_agent_steps_sampled_lifetime": 1026, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 1026, "timers": {"training_iteration_time_ms": 139540.982, "restore_workers_time_ms": 0.027, "training_step_time_ms": 139540.905, "sample_time_ms": 137110.51, "load_time_ms": 0.875, "load_throughput": 1171937.882, "learn_time_ms": 2415.248, "learn_throughput": 424.801, "synch_weights_time_ms": 13.693}, "counters": {"num_env_steps_sampled": 1026, "num_env_steps_trained": 1026, "num_agent_steps_sampled": 1026, "num_agent_steps_trained": 1026}, "done": false, "episodes_total": 158, "training_iteration": 1, "trial_id": "fe178_00003", "date": "2024-08-15_16-54-47", "timestamp": 1723762487, "time_this_iter_s": 139.54585337638855, "time_total_s": 139.54585337638855, "pid": 67487, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 139.54585337638855, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.070500000000003, "ram_util_percent": 12.532}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2658060093720755, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.100146851936976, "policy_loss": -0.048099883319810036, "vf_loss": 7.134168211619059, "vf_explained_var": 0.06997146482268969, "kl": 0.014078522087485612, "entropy": 1.303560080130895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 2052, "num_env_steps_trained": 2052, "num_agent_steps_sampled": 2052, "num_agent_steps_trained": 2052}, "sampler_results": {"episode_reward_max": 113.4484812667917, "episode_reward_min": -34.73566894531257, "episode_reward_mean": 3.388883043416134, "episode_len_mean": 8.462809917355372, "episode_media": {}, "episodes_this_iter": 121, "episodes_timesteps_total": 1024, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0367166590184524, -15.431177393857809, -5.257800365106803, -1.719593287597604, 86.83130141212087, 23.09942392230886, 11.553665943344981, 22.518021533389515, 1.922993332503367, -17.756006878892833, 49.673507358959796, -6.364746093750114, -22.713951228729627, -9.695197707088596, 7.477168490422741, 17.155699217549568, 14.541139522647583, 1.3458603202492299, 5.510934185873339, 5.006872558593727, -28.298539996351963, 13.95398194529588, -0.041498837438950886, -1.601808337825517, 44.31477564922346, 57.78437435850924, -5.34978594408615, 63.40071927117046, -8.41527099609391, -14.24397023690966, 13.307432890281007, -13.263019615516782, -20.561140259047875, -16.68457615507073, 4.079638038416135, -17.75140710748053, -11.866943359375, -33.31352539062493, -8.48457449813641, 21.128137207031273, 11.359228964450097, 71.30759277343782, 9.699121093750023, 97.72169430118396, -14.399307519942454, 0.9811538641280748, 9.734095449699112, -32.15662841796882, -29.832446289062432, 31.35117088867416, -8.454866415657989, 3.177405306397688, 5.20672023503964, 24.381547043977776, -9.39849476376861, -25.76968994140634, -21.064623860481277, -33.31352539062493, -8.783467533209091, 10.882850564789393, -28.134655761718818, 16.482132215218087, 24.04307536765029, 4.314766588283021, -1.2504194243923195, -27.54651871804498, 20.94705410219244, -23.893516174438275, 8.326599121093864, -19.888049316406182, -14.193154325321132, 8.855908203125068, 0.010010092057768816, -5.067053222656341, -0.4418114676592495, 23.544702107126056, 6.225070178191345, -23.03882325882813, 10.118433189838072, -28.103833007812568, 59.18360166126814, -9.209724536736644, -22.290942382812545, -1.9095180853302054, 1.3979506257862084, -1.0369061538046935, 9.712440013058355, 49.066286893635436, 3.6297151622709833, -18.878257912901702, -14.254678008141312, 1.9623328736886947, 113.4484812667917, -18.740884928408207, -5.668909433742385, 2.8341262248120955, -2.861889648437341, -18.183782673569638, -4.8708597888466585, 3.272072206841301, -3.9169870767771044, 10.364585137009257, 2.4590594406989226, -26.15706688070054, 1.599624278997112, -7.051580783799025, -9.007712021754969, -26.735974121093818, 23.662835692292333, 52.28056397966155, 16.225027937906532, -34.73566894531257, 8.249230957031273, -4.685732154867722, -19.351434350063073, -4.490381820200241, 0.9987164568565703, 12.204296517980652, -10.55364052904332, 6.529457188095648, 51.87313232421866], "episode_lengths": [5, 8, 3, 3, 30, 8, 17, 15, 5, 4, 18, 5, 5, 3, 6, 9, 11, 9, 6, 7, 3, 10, 4, 6, 14, 16, 3, 21, 7, 3, 6, 11, 3, 4, 7, 3, 14, 3, 6, 11, 7, 28, 5, 50, 3, 8, 5, 3, 3, 12, 4, 11, 5, 18, 3, 4, 7, 3, 3, 4, 3, 6, 10, 5, 5, 7, 10, 4, 5, 7, 4, 11, 17, 10, 7, 10, 27, 7, 7, 3, 23, 5, 4, 5, 4, 8, 10, 17, 5, 3, 4, 7, 37, 4, 8, 5, 7, 3, 3, 6, 4, 6, 5, 4, 11, 3, 9, 3, 15, 23, 10, 3, 11, 4, 6, 3, 8, 10, 1, 8, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.53416016588808, "mean_inference_ms": 1.3013661569811745, "mean_action_processing_ms": 0.21101083450569225, "mean_env_wait_ms": 624.6648854790914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991884657174102, "StateBufferConnector_ms": 0.021960518576882103, "ViewRequirementAgentConnector_ms": 0.18362013761662255}, "num_episodes": 121, "episode_return_max": 113.4484812667917, "episode_return_min": -34.73566894531257, "episode_return_mean": 3.388883043416134}, "env_runner_results": {"episode_reward_max": 113.4484812667917, "episode_reward_min": -34.73566894531257, "episode_reward_mean": 3.388883043416134, "episode_len_mean": 8.462809917355372, "episode_media": {}, "episodes_this_iter": 121, "episodes_timesteps_total": 1024, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0367166590184524, -15.431177393857809, -5.257800365106803, -1.719593287597604, 86.83130141212087, 23.09942392230886, 11.553665943344981, 22.518021533389515, 1.922993332503367, -17.756006878892833, 49.673507358959796, -6.364746093750114, -22.713951228729627, -9.695197707088596, 7.477168490422741, 17.155699217549568, 14.541139522647583, 1.3458603202492299, 5.510934185873339, 5.006872558593727, -28.298539996351963, 13.95398194529588, -0.041498837438950886, -1.601808337825517, 44.31477564922346, 57.78437435850924, -5.34978594408615, 63.40071927117046, -8.41527099609391, -14.24397023690966, 13.307432890281007, -13.263019615516782, -20.561140259047875, -16.68457615507073, 4.079638038416135, -17.75140710748053, -11.866943359375, -33.31352539062493, -8.48457449813641, 21.128137207031273, 11.359228964450097, 71.30759277343782, 9.699121093750023, 97.72169430118396, -14.399307519942454, 0.9811538641280748, 9.734095449699112, -32.15662841796882, -29.832446289062432, 31.35117088867416, -8.454866415657989, 3.177405306397688, 5.20672023503964, 24.381547043977776, -9.39849476376861, -25.76968994140634, -21.064623860481277, -33.31352539062493, -8.783467533209091, 10.882850564789393, -28.134655761718818, 16.482132215218087, 24.04307536765029, 4.314766588283021, -1.2504194243923195, -27.54651871804498, 20.94705410219244, -23.893516174438275, 8.326599121093864, -19.888049316406182, -14.193154325321132, 8.855908203125068, 0.010010092057768816, -5.067053222656341, -0.4418114676592495, 23.544702107126056, 6.225070178191345, -23.03882325882813, 10.118433189838072, -28.103833007812568, 59.18360166126814, -9.209724536736644, -22.290942382812545, -1.9095180853302054, 1.3979506257862084, -1.0369061538046935, 9.712440013058355, 49.066286893635436, 3.6297151622709833, -18.878257912901702, -14.254678008141312, 1.9623328736886947, 113.4484812667917, -18.740884928408207, -5.668909433742385, 2.8341262248120955, -2.861889648437341, -18.183782673569638, -4.8708597888466585, 3.272072206841301, -3.9169870767771044, 10.364585137009257, 2.4590594406989226, -26.15706688070054, 1.599624278997112, -7.051580783799025, -9.007712021754969, -26.735974121093818, 23.662835692292333, 52.28056397966155, 16.225027937906532, -34.73566894531257, 8.249230957031273, -4.685732154867722, -19.351434350063073, -4.490381820200241, 0.9987164568565703, 12.204296517980652, -10.55364052904332, 6.529457188095648, 51.87313232421866], "episode_lengths": [5, 8, 3, 3, 30, 8, 17, 15, 5, 4, 18, 5, 5, 3, 6, 9, 11, 9, 6, 7, 3, 10, 4, 6, 14, 16, 3, 21, 7, 3, 6, 11, 3, 4, 7, 3, 14, 3, 6, 11, 7, 28, 5, 50, 3, 8, 5, 3, 3, 12, 4, 11, 5, 18, 3, 4, 7, 3, 3, 4, 3, 6, 10, 5, 5, 7, 10, 4, 5, 7, 4, 11, 17, 10, 7, 10, 27, 7, 7, 3, 23, 5, 4, 5, 4, 8, 10, 17, 5, 3, 4, 7, 37, 4, 8, 5, 7, 3, 3, 6, 4, 6, 5, 4, 11, 3, 9, 3, 15, 23, 10, 3, 11, 4, 6, 3, 8, 10, 1, 8, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.53416016588808, "mean_inference_ms": 1.3013661569811745, "mean_action_processing_ms": 0.21101083450569225, "mean_env_wait_ms": 624.6648854790914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991884657174102, "StateBufferConnector_ms": 0.021960518576882103, "ViewRequirementAgentConnector_ms": 0.18362013761662255}, "num_episodes": 121, "episode_return_max": 113.4484812667917, "episode_return_min": -34.73566894531257, "episode_return_mean": 3.388883043416134}, "episode_reward_max": 113.4484812667917, "episode_reward_min": -34.73566894531257, "episode_reward_mean": 3.388883043416134, "episode_len_mean": 8.462809917355372, "episodes_this_iter": 121, "episodes_timesteps_total": 1024, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.0367166590184524, -15.431177393857809, -5.257800365106803, -1.719593287597604, 86.83130141212087, 23.09942392230886, 11.553665943344981, 22.518021533389515, 1.922993332503367, -17.756006878892833, 49.673507358959796, -6.364746093750114, -22.713951228729627, -9.695197707088596, 7.477168490422741, 17.155699217549568, 14.541139522647583, 1.3458603202492299, 5.510934185873339, 5.006872558593727, -28.298539996351963, 13.95398194529588, -0.041498837438950886, -1.601808337825517, 44.31477564922346, 57.78437435850924, -5.34978594408615, 63.40071927117046, -8.41527099609391, -14.24397023690966, 13.307432890281007, -13.263019615516782, -20.561140259047875, -16.68457615507073, 4.079638038416135, -17.75140710748053, -11.866943359375, -33.31352539062493, -8.48457449813641, 21.128137207031273, 11.359228964450097, 71.30759277343782, 9.699121093750023, 97.72169430118396, -14.399307519942454, 0.9811538641280748, 9.734095449699112, -32.15662841796882, -29.832446289062432, 31.35117088867416, -8.454866415657989, 3.177405306397688, 5.20672023503964, 24.381547043977776, -9.39849476376861, -25.76968994140634, -21.064623860481277, -33.31352539062493, -8.783467533209091, 10.882850564789393, -28.134655761718818, 16.482132215218087, 24.04307536765029, 4.314766588283021, -1.2504194243923195, -27.54651871804498, 20.94705410219244, -23.893516174438275, 8.326599121093864, -19.888049316406182, -14.193154325321132, 8.855908203125068, 0.010010092057768816, -5.067053222656341, -0.4418114676592495, 23.544702107126056, 6.225070178191345, -23.03882325882813, 10.118433189838072, -28.103833007812568, 59.18360166126814, -9.209724536736644, -22.290942382812545, -1.9095180853302054, 1.3979506257862084, -1.0369061538046935, 9.712440013058355, 49.066286893635436, 3.6297151622709833, -18.878257912901702, -14.254678008141312, 1.9623328736886947, 113.4484812667917, -18.740884928408207, -5.668909433742385, 2.8341262248120955, -2.861889648437341, -18.183782673569638, -4.8708597888466585, 3.272072206841301, -3.9169870767771044, 10.364585137009257, 2.4590594406989226, -26.15706688070054, 1.599624278997112, -7.051580783799025, -9.007712021754969, -26.735974121093818, 23.662835692292333, 52.28056397966155, 16.225027937906532, -34.73566894531257, 8.249230957031273, -4.685732154867722, -19.351434350063073, -4.490381820200241, 0.9987164568565703, 12.204296517980652, -10.55364052904332, 6.529457188095648, 51.87313232421866], "episode_lengths": [5, 8, 3, 3, 30, 8, 17, 15, 5, 4, 18, 5, 5, 3, 6, 9, 11, 9, 6, 7, 3, 10, 4, 6, 14, 16, 3, 21, 7, 3, 6, 11, 3, 4, 7, 3, 14, 3, 6, 11, 7, 28, 5, 50, 3, 8, 5, 3, 3, 12, 4, 11, 5, 18, 3, 4, 7, 3, 3, 4, 3, 6, 10, 5, 5, 7, 10, 4, 5, 7, 4, 11, 17, 10, 7, 10, 27, 7, 7, 3, 23, 5, 4, 5, 4, 8, 10, 17, 5, 3, 4, 7, 37, 4, 8, 5, 7, 3, 3, 6, 4, 6, 5, 4, 11, 3, 9, 3, 15, 23, 10, 3, 11, 4, 6, 3, 8, 10, 1, 8, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.53416016588808, "mean_inference_ms": 1.3013661569811745, "mean_action_processing_ms": 0.21101083450569225, "mean_env_wait_ms": 624.6648854790914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991884657174102, "StateBufferConnector_ms": 0.021960518576882103, "ViewRequirementAgentConnector_ms": 0.18362013761662255}, "num_episodes": 121, "episode_return_max": 113.4484812667917, "episode_return_min": -34.73566894531257, "episode_return_mean": 3.388883043416134, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2052, "num_agent_steps_trained": 2052, "num_env_steps_sampled": 2052, "num_env_steps_trained": 2052, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 7.654797000873381, "num_env_steps_trained_throughput_per_sec": 7.654797000873381, "timesteps_total": 2052, "num_env_steps_sampled_lifetime": 2052, "num_agent_steps_sampled_lifetime": 2052, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 2052, "timers": {"training_iteration_time_ms": 136787.3, "restore_workers_time_ms": 0.028, "training_step_time_ms": 136787.221, "sample_time_ms": 134889.177, "load_time_ms": 0.672, "load_throughput": 1526554.063, "learn_time_ms": 1883.184, "learn_throughput": 544.822, "synch_weights_time_ms": 13.713}, "counters": {"num_env_steps_sampled": 2052, "num_env_steps_trained": 2052, "num_agent_steps_sampled": 2052, "num_agent_steps_trained": 2052}, "done": false, "episodes_total": 279, "training_iteration": 2, "trial_id": "fe178_00003", "date": "2024-08-15_16-57-01", "timestamp": 1723762621, "time_this_iter_s": 134.0385811328888, "time_total_s": 273.58443450927734, "pid": 67487, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 273.58443450927734, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 24.885863874345553, "ram_util_percent": 13.381675392670159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.658504311740399, "cur_kl_coeff": 1.0, "cur_lr": 0.00010000000000000003, "total_loss": 7.114066056410471, "policy_loss": -0.04759485078199456, "vf_loss": 7.149776909748713, "vf_explained_var": 0.1078215795258681, "kl": 0.011884043812187927, "entropy": 1.1769529720147451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 3090, "num_env_steps_trained": 3090, "num_agent_steps_sampled": 3090, "num_agent_steps_trained": 3090}, "sampler_results": {"episode_reward_max": 193.8918934743793, "episode_reward_min": -27.74936925836522, "episode_reward_mean": 19.385922315732195, "episode_len_mean": 12.615384615384615, "episode_media": {}, "episodes_this_iter": 78, "episodes_timesteps_total": 984, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.7652587890625, 15.563556679057285, 8.89609222666951, -2.2874646951265305, 7.229905556910211, 6.406011453466178, -11.42561125145403, 64.85810064402573, 41.91734680801521, 20.60060376178177, 6.337403970401894, 116.49713642465099, -8.21337890625, 19.093538059105697, 17.556528263819303, 39.537593296677926, 6.497708411100064, 5.679141562290397, -0.02497994161853967, 12.538311643292957, -18.257111433206546, -12.339565597907779, -7.638274465328891, 12.876619516243977, -3.9066177359436125, 1.5370961570199029, -15.520031412743378, -10.151944534061116, -7.02118067919082, -18.290102132960854, -17.635451335557093, 24.0879042362552, -8.864249933201222, 3.8053778930181323, 10.668138089499166, 118.83152921789167, -19.38065533774757, -0.7000741274541156, 50.58340200864768, -10.41032270537653, -24.063105072367932, 193.8918934743793, 1.2562433852490358, 26.412696958155948, 13.599005920227683, 47.00711173523227, -10.98023823243571, -10.701182012543953, 1.236777531876598, -19.336679114648234, -1.7190518877605, 32.82071562870311, 8.624519654501384, 127.95460699419583, 0.443005738357499, 6.276544717651632, 19.502039516753314, -21.06329576744048, -22.209021394049614, 16.47121053598528, 21.616186789823303, 161.6702746196505, 21.505903046139153, 35.21137485650161, 80.9409974961338, -0.9876934602393703, -27.74936925836522, 14.272752294505494, 99.30023237002814, 40.46151123046866, 13.823526527854426, 16.56400465443096, 163.66581169546396, -2.9358735216304126, 21.749840428902473, 20.21191892421973, 4.825830078125023, 14.764142679426698], "episode_lengths": [6, 9, 10, 7, 5, 8, 6, 31, 21, 10, 6, 48, 6, 6, 7, 33, 8, 4, 11, 11, 14, 5, 5, 7, 4, 4, 3, 7, 4, 8, 8, 7, 5, 9, 6, 31, 6, 9, 20, 7, 3, 46, 10, 11, 18, 12, 4, 5, 5, 6, 3, 10, 7, 50, 13, 14, 13, 6, 4, 11, 8, 49, 13, 10, 36, 4, 3, 24, 37, 18, 8, 10, 50, 4, 11, 10, 5, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.16509897622169, "mean_inference_ms": 1.2723424460252404, "mean_action_processing_ms": 0.20918347825588895, "mean_env_wait_ms": 561.804304662459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010664107889773936, "StateBufferConnector_ms": 0.02063249833320863, "ViewRequirementAgentConnector_ms": 0.18437961567501057}, "num_episodes": 78, "episode_return_max": 193.8918934743793, "episode_return_min": -27.74936925836522, "episode_return_mean": 19.385922315732195}, "env_runner_results": {"episode_reward_max": 193.8918934743793, "episode_reward_min": -27.74936925836522, "episode_reward_mean": 19.385922315732195, "episode_len_mean": 12.615384615384615, "episode_media": {}, "episodes_this_iter": 78, "episodes_timesteps_total": 984, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.7652587890625, 15.563556679057285, 8.89609222666951, -2.2874646951265305, 7.229905556910211, 6.406011453466178, -11.42561125145403, 64.85810064402573, 41.91734680801521, 20.60060376178177, 6.337403970401894, 116.49713642465099, -8.21337890625, 19.093538059105697, 17.556528263819303, 39.537593296677926, 6.497708411100064, 5.679141562290397, -0.02497994161853967, 12.538311643292957, -18.257111433206546, -12.339565597907779, -7.638274465328891, 12.876619516243977, -3.9066177359436125, 1.5370961570199029, -15.520031412743378, -10.151944534061116, -7.02118067919082, -18.290102132960854, -17.635451335557093, 24.0879042362552, -8.864249933201222, 3.8053778930181323, 10.668138089499166, 118.83152921789167, -19.38065533774757, -0.7000741274541156, 50.58340200864768, -10.41032270537653, -24.063105072367932, 193.8918934743793, 1.2562433852490358, 26.412696958155948, 13.599005920227683, 47.00711173523227, -10.98023823243571, -10.701182012543953, 1.236777531876598, -19.336679114648234, -1.7190518877605, 32.82071562870311, 8.624519654501384, 127.95460699419583, 0.443005738357499, 6.276544717651632, 19.502039516753314, -21.06329576744048, -22.209021394049614, 16.47121053598528, 21.616186789823303, 161.6702746196505, 21.505903046139153, 35.21137485650161, 80.9409974961338, -0.9876934602393703, -27.74936925836522, 14.272752294505494, 99.30023237002814, 40.46151123046866, 13.823526527854426, 16.56400465443096, 163.66581169546396, -2.9358735216304126, 21.749840428902473, 20.21191892421973, 4.825830078125023, 14.764142679426698], "episode_lengths": [6, 9, 10, 7, 5, 8, 6, 31, 21, 10, 6, 48, 6, 6, 7, 33, 8, 4, 11, 11, 14, 5, 5, 7, 4, 4, 3, 7, 4, 8, 8, 7, 5, 9, 6, 31, 6, 9, 20, 7, 3, 46, 10, 11, 18, 12, 4, 5, 5, 6, 3, 10, 7, 50, 13, 14, 13, 6, 4, 11, 8, 49, 13, 10, 36, 4, 3, 24, 37, 18, 8, 10, 50, 4, 11, 10, 5, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.16509897622169, "mean_inference_ms": 1.2723424460252404, "mean_action_processing_ms": 0.20918347825588895, "mean_env_wait_ms": 561.804304662459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010664107889773936, "StateBufferConnector_ms": 0.02063249833320863, "ViewRequirementAgentConnector_ms": 0.18437961567501057}, "num_episodes": 78, "episode_return_max": 193.8918934743793, "episode_return_min": -27.74936925836522, "episode_return_mean": 19.385922315732195}, "episode_reward_max": 193.8918934743793, "episode_reward_min": -27.74936925836522, "episode_reward_mean": 19.385922315732195, "episode_len_mean": 12.615384615384615, "episodes_this_iter": 78, "episodes_timesteps_total": 984, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.7652587890625, 15.563556679057285, 8.89609222666951, -2.2874646951265305, 7.229905556910211, 6.406011453466178, -11.42561125145403, 64.85810064402573, 41.91734680801521, 20.60060376178177, 6.337403970401894, 116.49713642465099, -8.21337890625, 19.093538059105697, 17.556528263819303, 39.537593296677926, 6.497708411100064, 5.679141562290397, -0.02497994161853967, 12.538311643292957, -18.257111433206546, -12.339565597907779, -7.638274465328891, 12.876619516243977, -3.9066177359436125, 1.5370961570199029, -15.520031412743378, -10.151944534061116, -7.02118067919082, -18.290102132960854, -17.635451335557093, 24.0879042362552, -8.864249933201222, 3.8053778930181323, 10.668138089499166, 118.83152921789167, -19.38065533774757, -0.7000741274541156, 50.58340200864768, -10.41032270537653, -24.063105072367932, 193.8918934743793, 1.2562433852490358, 26.412696958155948, 13.599005920227683, 47.00711173523227, -10.98023823243571, -10.701182012543953, 1.236777531876598, -19.336679114648234, -1.7190518877605, 32.82071562870311, 8.624519654501384, 127.95460699419583, 0.443005738357499, 6.276544717651632, 19.502039516753314, -21.06329576744048, -22.209021394049614, 16.47121053598528, 21.616186789823303, 161.6702746196505, 21.505903046139153, 35.21137485650161, 80.9409974961338, -0.9876934602393703, -27.74936925836522, 14.272752294505494, 99.30023237002814, 40.46151123046866, 13.823526527854426, 16.56400465443096, 163.66581169546396, -2.9358735216304126, 21.749840428902473, 20.21191892421973, 4.825830078125023, 14.764142679426698], "episode_lengths": [6, 9, 10, 7, 5, 8, 6, 31, 21, 10, 6, 48, 6, 6, 7, 33, 8, 4, 11, 11, 14, 5, 5, 7, 4, 4, 3, 7, 4, 8, 8, 7, 5, 9, 6, 31, 6, 9, 20, 7, 3, 46, 10, 11, 18, 12, 4, 5, 5, 6, 3, 10, 7, 50, 13, 14, 13, 6, 4, 11, 8, 49, 13, 10, 36, 4, 3, 24, 37, 18, 8, 10, 50, 4, 11, 10, 5, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.16509897622169, "mean_inference_ms": 1.2723424460252404, "mean_action_processing_ms": 0.20918347825588895, "mean_env_wait_ms": 561.804304662459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010664107889773936, "StateBufferConnector_ms": 0.02063249833320863, "ViewRequirementAgentConnector_ms": 0.18437961567501057}, "num_episodes": 78, "episode_return_max": 193.8918934743793, "episode_return_min": -27.74936925836522, "episode_return_mean": 19.385922315732195, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3090, "num_agent_steps_trained": 3090, "num_env_steps_sampled": 3090, "num_env_steps_trained": 3090, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 8.717452607273897, "num_env_steps_trained_throughput_per_sec": 8.717452607273897, "timesteps_total": 3090, "num_env_steps_sampled_lifetime": 3090, "num_agent_steps_sampled_lifetime": 3090, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 3090, "timers": {"training_iteration_time_ms": 117694.946, "restore_workers_time_ms": 0.023, "training_step_time_ms": 117694.88, "sample_time_ms": 116359.852, "load_time_ms": 0.824, "load_throughput": 1245544.401, "learn_time_ms": 1321.128, "learn_throughput": 776.609, "synch_weights_time_ms": 12.58}, "counters": {"num_env_steps_sampled": 3090, "num_env_steps_trained": 3090, "num_agent_steps_sampled": 3090, "num_agent_steps_trained": 3090}, "done": false, "episodes_total": 304, "training_iteration": 5, "trial_id": "fe178_00003", "date": "2024-08-15_16-59-18", "timestamp": 1723762758, "time_this_iter_s": 117.69909334182739, "time_total_s": 387.58244037628174, "pid": 99756, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 117.69909334182739, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.168639053254438, "ram_util_percent": 13.00059171597633}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.252565305431684, "cur_kl_coeff": 1.0, "cur_lr": 0.00010000000000000003, "total_loss": 6.994516271352768, "policy_loss": -0.03586532582606499, "vf_loss": 7.021475607156754, "vf_explained_var": 0.3075249920288722, "kl": 0.008905990878467225, "entropy": 1.1831208715836208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 4116, "num_env_steps_trained": 4116, "num_agent_steps_sampled": 4116, "num_agent_steps_trained": 4116}, "sampler_results": {"episode_reward_max": 193.8918934743793, "episode_reward_min": -27.74936925836522, "episode_reward_mean": 31.53459651580166, "episode_len_mean": 15.89, "episode_media": {}, "episodes_this_iter": 57, "episodes_timesteps_total": 1589, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.83152921789167, -19.38065533774757, -0.7000741274541156, 50.58340200864768, -10.41032270537653, -24.063105072367932, 193.8918934743793, 1.2562433852490358, 26.412696958155948, 13.599005920227683, 47.00711173523227, -10.98023823243571, -10.701182012543953, 1.236777531876598, -19.336679114648234, -1.7190518877605, 32.82071562870311, 8.624519654501384, 127.95460699419583, 0.443005738357499, 6.276544717651632, 19.502039516753314, -21.06329576744048, -22.209021394049614, 16.47121053598528, 21.616186789823303, 161.6702746196505, 21.505903046139153, 35.21137485650161, 80.9409974961338, -0.9876934602393703, -27.74936925836522, 14.272752294505494, 99.30023237002814, 40.46151123046866, 13.823526527854426, 16.56400465443096, 163.66581169546396, -2.9358735216304126, 21.749840428902473, 20.21191892421973, 4.825830078125023, 14.764142679426698, 53.326904296875, 112.69892760011345, 41.68122663402448, 41.63720544120224, 117.39979154405216, 9.79035369637296, 114.129907712403, 90.25136310670985, 36.65126182091471, 14.946464320364612, 30.599529052856084, 15.89337158203125, 20.030008067234917, 71.6168103195971, 40.43895850713807, -1.9011108398439092, 33.22575683593743, -21.06506779872859, 7.450152726097187, 17.856225038374305, 18.535301869753255, -10.89406529342807, 20.91557974808626, -15.607760112862422, 158.80565698374522, 72.26014402231266, 43.848504273720664, -3.748189532189329, 126.11382991782295, 36.9759321290246, -0.2540843827944883, 28.725448888510414, 21.00389396461253, -2.588547587682868, 18.43236306544695, -8.288952636718818, 24.90221053883964, 86.68400284400468, -11.319116202073474, 2.5040233304090833, 11.905506580517098, -4.715081739216885, 12.442102358061888, 63.39743170502571, 22.021806109498698, 22.99502766498233, 25.911889960393466, 73.57807961605901, 80.85377430675243, 10.120751488987423, 14.699343735852153, 10.48751469784844, -6.581944148084915, 58.57789119299929, -7.23581384982846, 44.95493441295366, 43.123173177675994], "episode_lengths": [31, 6, 9, 20, 7, 3, 46, 10, 11, 18, 12, 4, 5, 5, 6, 3, 10, 7, 50, 13, 14, 13, 6, 4, 11, 8, 49, 13, 10, 36, 4, 3, 24, 37, 18, 8, 10, 50, 4, 11, 10, 5, 11, 30, 32, 13, 18, 50, 17, 50, 27, 12, 12, 8, 6, 6, 27, 10, 7, 9, 8, 4, 9, 12, 6, 9, 8, 50, 30, 22, 3, 37, 17, 8, 11, 10, 10, 11, 3, 10, 34, 6, 4, 7, 6, 25, 24, 9, 28, 11, 45, 38, 6, 24, 5, 8, 23, 6, 18, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.609027221749392, "mean_inference_ms": 1.2629214913022744, "mean_action_processing_ms": 0.20901477941457058, "mean_env_wait_ms": 578.9097702866515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01052607808794294, "StateBufferConnector_ms": 0.015173605510166714, "ViewRequirementAgentConnector_ms": 0.17823760850088938}, "num_episodes": 57, "episode_return_max": 193.8918934743793, "episode_return_min": -27.74936925836522, "episode_return_mean": 31.53459651580166}, "env_runner_results": {"episode_reward_max": 193.8918934743793, "episode_reward_min": -27.74936925836522, "episode_reward_mean": 31.53459651580166, "episode_len_mean": 15.89, "episode_media": {}, "episodes_this_iter": 57, "episodes_timesteps_total": 1589, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.83152921789167, -19.38065533774757, -0.7000741274541156, 50.58340200864768, -10.41032270537653, -24.063105072367932, 193.8918934743793, 1.2562433852490358, 26.412696958155948, 13.599005920227683, 47.00711173523227, -10.98023823243571, -10.701182012543953, 1.236777531876598, -19.336679114648234, -1.7190518877605, 32.82071562870311, 8.624519654501384, 127.95460699419583, 0.443005738357499, 6.276544717651632, 19.502039516753314, -21.06329576744048, -22.209021394049614, 16.47121053598528, 21.616186789823303, 161.6702746196505, 21.505903046139153, 35.21137485650161, 80.9409974961338, -0.9876934602393703, -27.74936925836522, 14.272752294505494, 99.30023237002814, 40.46151123046866, 13.823526527854426, 16.56400465443096, 163.66581169546396, -2.9358735216304126, 21.749840428902473, 20.21191892421973, 4.825830078125023, 14.764142679426698, 53.326904296875, 112.69892760011345, 41.68122663402448, 41.63720544120224, 117.39979154405216, 9.79035369637296, 114.129907712403, 90.25136310670985, 36.65126182091471, 14.946464320364612, 30.599529052856084, 15.89337158203125, 20.030008067234917, 71.6168103195971, 40.43895850713807, -1.9011108398439092, 33.22575683593743, -21.06506779872859, 7.450152726097187, 17.856225038374305, 18.535301869753255, -10.89406529342807, 20.91557974808626, -15.607760112862422, 158.80565698374522, 72.26014402231266, 43.848504273720664, -3.748189532189329, 126.11382991782295, 36.9759321290246, -0.2540843827944883, 28.725448888510414, 21.00389396461253, -2.588547587682868, 18.43236306544695, -8.288952636718818, 24.90221053883964, 86.68400284400468, -11.319116202073474, 2.5040233304090833, 11.905506580517098, -4.715081739216885, 12.442102358061888, 63.39743170502571, 22.021806109498698, 22.99502766498233, 25.911889960393466, 73.57807961605901, 80.85377430675243, 10.120751488987423, 14.699343735852153, 10.48751469784844, -6.581944148084915, 58.57789119299929, -7.23581384982846, 44.95493441295366, 43.123173177675994], "episode_lengths": [31, 6, 9, 20, 7, 3, 46, 10, 11, 18, 12, 4, 5, 5, 6, 3, 10, 7, 50, 13, 14, 13, 6, 4, 11, 8, 49, 13, 10, 36, 4, 3, 24, 37, 18, 8, 10, 50, 4, 11, 10, 5, 11, 30, 32, 13, 18, 50, 17, 50, 27, 12, 12, 8, 6, 6, 27, 10, 7, 9, 8, 4, 9, 12, 6, 9, 8, 50, 30, 22, 3, 37, 17, 8, 11, 10, 10, 11, 3, 10, 34, 6, 4, 7, 6, 25, 24, 9, 28, 11, 45, 38, 6, 24, 5, 8, 23, 6, 18, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.609027221749392, "mean_inference_ms": 1.2629214913022744, "mean_action_processing_ms": 0.20901477941457058, "mean_env_wait_ms": 578.9097702866515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01052607808794294, "StateBufferConnector_ms": 0.015173605510166714, "ViewRequirementAgentConnector_ms": 0.17823760850088938}, "num_episodes": 57, "episode_return_max": 193.8918934743793, "episode_return_min": -27.74936925836522, "episode_return_mean": 31.53459651580166}, "episode_reward_max": 193.8918934743793, "episode_reward_min": -27.74936925836522, "episode_reward_mean": 31.53459651580166, "episode_len_mean": 15.89, "episodes_this_iter": 57, "episodes_timesteps_total": 1589, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [118.83152921789167, -19.38065533774757, -0.7000741274541156, 50.58340200864768, -10.41032270537653, -24.063105072367932, 193.8918934743793, 1.2562433852490358, 26.412696958155948, 13.599005920227683, 47.00711173523227, -10.98023823243571, -10.701182012543953, 1.236777531876598, -19.336679114648234, -1.7190518877605, 32.82071562870311, 8.624519654501384, 127.95460699419583, 0.443005738357499, 6.276544717651632, 19.502039516753314, -21.06329576744048, -22.209021394049614, 16.47121053598528, 21.616186789823303, 161.6702746196505, 21.505903046139153, 35.21137485650161, 80.9409974961338, -0.9876934602393703, -27.74936925836522, 14.272752294505494, 99.30023237002814, 40.46151123046866, 13.823526527854426, 16.56400465443096, 163.66581169546396, -2.9358735216304126, 21.749840428902473, 20.21191892421973, 4.825830078125023, 14.764142679426698, 53.326904296875, 112.69892760011345, 41.68122663402448, 41.63720544120224, 117.39979154405216, 9.79035369637296, 114.129907712403, 90.25136310670985, 36.65126182091471, 14.946464320364612, 30.599529052856084, 15.89337158203125, 20.030008067234917, 71.6168103195971, 40.43895850713807, -1.9011108398439092, 33.22575683593743, -21.06506779872859, 7.450152726097187, 17.856225038374305, 18.535301869753255, -10.89406529342807, 20.91557974808626, -15.607760112862422, 158.80565698374522, 72.26014402231266, 43.848504273720664, -3.748189532189329, 126.11382991782295, 36.9759321290246, -0.2540843827944883, 28.725448888510414, 21.00389396461253, -2.588547587682868, 18.43236306544695, -8.288952636718818, 24.90221053883964, 86.68400284400468, -11.319116202073474, 2.5040233304090833, 11.905506580517098, -4.715081739216885, 12.442102358061888, 63.39743170502571, 22.021806109498698, 22.99502766498233, 25.911889960393466, 73.57807961605901, 80.85377430675243, 10.120751488987423, 14.699343735852153, 10.48751469784844, -6.581944148084915, 58.57789119299929, -7.23581384982846, 44.95493441295366, 43.123173177675994], "episode_lengths": [31, 6, 9, 20, 7, 3, 46, 10, 11, 18, 12, 4, 5, 5, 6, 3, 10, 7, 50, 13, 14, 13, 6, 4, 11, 8, 49, 13, 10, 36, 4, 3, 24, 37, 18, 8, 10, 50, 4, 11, 10, 5, 11, 30, 32, 13, 18, 50, 17, 50, 27, 12, 12, 8, 6, 6, 27, 10, 7, 9, 8, 4, 9, 12, 6, 9, 8, 50, 30, 22, 3, 37, 17, 8, 11, 10, 10, 11, 3, 10, 34, 6, 4, 7, 6, 25, 24, 9, 28, 11, 45, 38, 6, 24, 5, 8, 23, 6, 18, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.609027221749392, "mean_inference_ms": 1.2629214913022744, "mean_action_processing_ms": 0.20901477941457058, "mean_env_wait_ms": 578.9097702866515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01052607808794294, "StateBufferConnector_ms": 0.015173605510166714, "ViewRequirementAgentConnector_ms": 0.17823760850088938}, "num_episodes": 57, "episode_return_max": 193.8918934743793, "episode_return_min": -27.74936925836522, "episode_return_mean": 31.53459651580166, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4116, "num_agent_steps_trained": 4116, "num_env_steps_sampled": 4116, "num_env_steps_trained": 4116, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 8.232192444102473, "num_env_steps_trained_throughput_per_sec": 8.232192444102473, "timesteps_total": 4116, "num_env_steps_sampled_lifetime": 4116, "num_agent_steps_sampled_lifetime": 4116, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 4116, "timers": {"training_iteration_time_ms": 121163.805, "restore_workers_time_ms": 0.019, "training_step_time_ms": 121163.746, "sample_time_ms": 119824.968, "load_time_ms": 0.631, "load_throughput": 1626977.657, "learn_time_ms": 1324.783, "learn_throughput": 774.466, "synch_weights_time_ms": 12.943}, "counters": {"num_env_steps_sampled": 4116, "num_env_steps_trained": 4116, "num_agent_steps_sampled": 4116, "num_agent_steps_trained": 4116}, "done": false, "episodes_total": 361, "training_iteration": 6, "trial_id": "fe178_00003", "date": "2024-08-15_17-01-22", "timestamp": 1723762882, "time_this_iter_s": 124.63651728630066, "time_total_s": 512.2189576625824, "pid": 99756, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 242.33561062812805, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.99209039548023, "ram_util_percent": 13.49830508474576}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.212712980310122, "cur_kl_coeff": 1.0, "cur_lr": 0.00010000000000000003, "total_loss": 7.41264774799347, "policy_loss": -0.03772018212669839, "vf_loss": 7.441155002514521, "vf_explained_var": 0.3518673859536648, "kl": 0.009212916419786214, "entropy": 1.1672620276610057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 5142, "num_env_steps_trained": 5142, "num_agent_steps_sampled": 5142, "num_agent_steps_trained": 5142}, "sampler_results": {"episode_reward_max": 226.5623784486529, "episode_reward_min": -21.06506779872859, "episode_reward_mean": 49.657905110417666, "episode_len_mean": 20.88, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 2088, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.66581169546396, -2.9358735216304126, 21.749840428902473, 20.21191892421973, 4.825830078125023, 14.764142679426698, 53.326904296875, 112.69892760011345, 41.68122663402448, 41.63720544120224, 117.39979154405216, 9.79035369637296, 114.129907712403, 90.25136310670985, 36.65126182091471, 14.946464320364612, 30.599529052856084, 15.89337158203125, 20.030008067234917, 71.6168103195971, 40.43895850713807, -1.9011108398439092, 33.22575683593743, -21.06506779872859, 7.450152726097187, 17.856225038374305, 18.535301869753255, -10.89406529342807, 20.91557974808626, -15.607760112862422, 158.80565698374522, 72.26014402231266, 43.848504273720664, -3.748189532189329, 126.11382991782295, 36.9759321290246, -0.2540843827944883, 28.725448888510414, 21.00389396461253, -2.588547587682868, 18.43236306544695, -8.288952636718818, 24.90221053883964, 86.68400284400468, -11.319116202073474, 2.5040233304090833, 11.905506580517098, -4.715081739216885, 12.442102358061888, 63.39743170502571, 22.021806109498698, 22.99502766498233, 25.911889960393466, 73.57807961605901, 80.85377430675243, 10.120751488987423, 14.699343735852153, 10.48751469784844, -6.581944148084915, 58.57789119299929, -7.23581384982846, 44.95493441295366, 43.123173177675994, 103.53811901900002, 116.3413022930215, -6.272580618236702, 77.80463782337755, 9.12152200447484, 45.11979479346577, 146.48844429084852, 19.800414798199597, 96.88589179432023, 181.85814414043114, 53.40268778752187, 165.811294180919, 130.78328390850237, 206.82576814279497, 8.020607847334816, 110.30405441656762, 46.92784558760292, 29.213523142555317, -8.415464579854302, 77.66845149899034, 34.823352988070695, 85.63010181713985, 129.53374529222265, 92.74116920474759, 29.07682905776221, 14.993610401706505, -11.640757146124429, 150.14780133781744, 88.64960721516286, 59.55386841856813, -5.176110839843773, -0.318543112179384, 116.53247567989824, 226.5623784486529, 104.65511927196977, 21.197833046774406, 65.11801464033334], "episode_lengths": [50, 4, 11, 10, 5, 11, 30, 32, 13, 18, 50, 17, 50, 27, 12, 12, 8, 6, 6, 27, 10, 7, 9, 8, 4, 9, 12, 6, 9, 8, 50, 30, 22, 3, 37, 17, 8, 11, 10, 10, 11, 3, 10, 34, 6, 4, 7, 6, 25, 24, 9, 28, 11, 45, 38, 6, 24, 5, 8, 23, 6, 18, 15, 26, 31, 11, 24, 11, 27, 30, 16, 36, 50, 39, 50, 50, 50, 9, 47, 19, 9, 1, 23, 42, 34, 50, 50, 13, 8, 7, 50, 34, 37, 1, 11, 27, 50, 36, 7, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.385748940502763, "mean_inference_ms": 1.258749094702832, "mean_action_processing_ms": 0.20824367971827187, "mean_env_wait_ms": 599.7975466386749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010598421096801758, "StateBufferConnector_ms": 0.012596368789672852, "ViewRequirementAgentConnector_ms": 0.17620086669921875}, "num_episodes": 37, "episode_return_max": 226.5623784486529, "episode_return_min": -21.06506779872859, "episode_return_mean": 49.657905110417666}, "env_runner_results": {"episode_reward_max": 226.5623784486529, "episode_reward_min": -21.06506779872859, "episode_reward_mean": 49.657905110417666, "episode_len_mean": 20.88, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 2088, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.66581169546396, -2.9358735216304126, 21.749840428902473, 20.21191892421973, 4.825830078125023, 14.764142679426698, 53.326904296875, 112.69892760011345, 41.68122663402448, 41.63720544120224, 117.39979154405216, 9.79035369637296, 114.129907712403, 90.25136310670985, 36.65126182091471, 14.946464320364612, 30.599529052856084, 15.89337158203125, 20.030008067234917, 71.6168103195971, 40.43895850713807, -1.9011108398439092, 33.22575683593743, -21.06506779872859, 7.450152726097187, 17.856225038374305, 18.535301869753255, -10.89406529342807, 20.91557974808626, -15.607760112862422, 158.80565698374522, 72.26014402231266, 43.848504273720664, -3.748189532189329, 126.11382991782295, 36.9759321290246, -0.2540843827944883, 28.725448888510414, 21.00389396461253, -2.588547587682868, 18.43236306544695, -8.288952636718818, 24.90221053883964, 86.68400284400468, -11.319116202073474, 2.5040233304090833, 11.905506580517098, -4.715081739216885, 12.442102358061888, 63.39743170502571, 22.021806109498698, 22.99502766498233, 25.911889960393466, 73.57807961605901, 80.85377430675243, 10.120751488987423, 14.699343735852153, 10.48751469784844, -6.581944148084915, 58.57789119299929, -7.23581384982846, 44.95493441295366, 43.123173177675994, 103.53811901900002, 116.3413022930215, -6.272580618236702, 77.80463782337755, 9.12152200447484, 45.11979479346577, 146.48844429084852, 19.800414798199597, 96.88589179432023, 181.85814414043114, 53.40268778752187, 165.811294180919, 130.78328390850237, 206.82576814279497, 8.020607847334816, 110.30405441656762, 46.92784558760292, 29.213523142555317, -8.415464579854302, 77.66845149899034, 34.823352988070695, 85.63010181713985, 129.53374529222265, 92.74116920474759, 29.07682905776221, 14.993610401706505, -11.640757146124429, 150.14780133781744, 88.64960721516286, 59.55386841856813, -5.176110839843773, -0.318543112179384, 116.53247567989824, 226.5623784486529, 104.65511927196977, 21.197833046774406, 65.11801464033334], "episode_lengths": [50, 4, 11, 10, 5, 11, 30, 32, 13, 18, 50, 17, 50, 27, 12, 12, 8, 6, 6, 27, 10, 7, 9, 8, 4, 9, 12, 6, 9, 8, 50, 30, 22, 3, 37, 17, 8, 11, 10, 10, 11, 3, 10, 34, 6, 4, 7, 6, 25, 24, 9, 28, 11, 45, 38, 6, 24, 5, 8, 23, 6, 18, 15, 26, 31, 11, 24, 11, 27, 30, 16, 36, 50, 39, 50, 50, 50, 9, 47, 19, 9, 1, 23, 42, 34, 50, 50, 13, 8, 7, 50, 34, 37, 1, 11, 27, 50, 36, 7, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.385748940502763, "mean_inference_ms": 1.258749094702832, "mean_action_processing_ms": 0.20824367971827187, "mean_env_wait_ms": 599.7975466386749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010598421096801758, "StateBufferConnector_ms": 0.012596368789672852, "ViewRequirementAgentConnector_ms": 0.17620086669921875}, "num_episodes": 37, "episode_return_max": 226.5623784486529, "episode_return_min": -21.06506779872859, "episode_return_mean": 49.657905110417666}, "episode_reward_max": 226.5623784486529, "episode_reward_min": -21.06506779872859, "episode_reward_mean": 49.657905110417666, "episode_len_mean": 20.88, "episodes_this_iter": 37, "episodes_timesteps_total": 2088, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [163.66581169546396, -2.9358735216304126, 21.749840428902473, 20.21191892421973, 4.825830078125023, 14.764142679426698, 53.326904296875, 112.69892760011345, 41.68122663402448, 41.63720544120224, 117.39979154405216, 9.79035369637296, 114.129907712403, 90.25136310670985, 36.65126182091471, 14.946464320364612, 30.599529052856084, 15.89337158203125, 20.030008067234917, 71.6168103195971, 40.43895850713807, -1.9011108398439092, 33.22575683593743, -21.06506779872859, 7.450152726097187, 17.856225038374305, 18.535301869753255, -10.89406529342807, 20.91557974808626, -15.607760112862422, 158.80565698374522, 72.26014402231266, 43.848504273720664, -3.748189532189329, 126.11382991782295, 36.9759321290246, -0.2540843827944883, 28.725448888510414, 21.00389396461253, -2.588547587682868, 18.43236306544695, -8.288952636718818, 24.90221053883964, 86.68400284400468, -11.319116202073474, 2.5040233304090833, 11.905506580517098, -4.715081739216885, 12.442102358061888, 63.39743170502571, 22.021806109498698, 22.99502766498233, 25.911889960393466, 73.57807961605901, 80.85377430675243, 10.120751488987423, 14.699343735852153, 10.48751469784844, -6.581944148084915, 58.57789119299929, -7.23581384982846, 44.95493441295366, 43.123173177675994, 103.53811901900002, 116.3413022930215, -6.272580618236702, 77.80463782337755, 9.12152200447484, 45.11979479346577, 146.48844429084852, 19.800414798199597, 96.88589179432023, 181.85814414043114, 53.40268778752187, 165.811294180919, 130.78328390850237, 206.82576814279497, 8.020607847334816, 110.30405441656762, 46.92784558760292, 29.213523142555317, -8.415464579854302, 77.66845149899034, 34.823352988070695, 85.63010181713985, 129.53374529222265, 92.74116920474759, 29.07682905776221, 14.993610401706505, -11.640757146124429, 150.14780133781744, 88.64960721516286, 59.55386841856813, -5.176110839843773, -0.318543112179384, 116.53247567989824, 226.5623784486529, 104.65511927196977, 21.197833046774406, 65.11801464033334], "episode_lengths": [50, 4, 11, 10, 5, 11, 30, 32, 13, 18, 50, 17, 50, 27, 12, 12, 8, 6, 6, 27, 10, 7, 9, 8, 4, 9, 12, 6, 9, 8, 50, 30, 22, 3, 37, 17, 8, 11, 10, 10, 11, 3, 10, 34, 6, 4, 7, 6, 25, 24, 9, 28, 11, 45, 38, 6, 24, 5, 8, 23, 6, 18, 15, 26, 31, 11, 24, 11, 27, 30, 16, 36, 50, 39, 50, 50, 50, 9, 47, 19, 9, 1, 23, 42, 34, 50, 50, 13, 8, 7, 50, 34, 37, 1, 11, 27, 50, 36, 7, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.385748940502763, "mean_inference_ms": 1.258749094702832, "mean_action_processing_ms": 0.20824367971827187, "mean_env_wait_ms": 599.7975466386749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010598421096801758, "StateBufferConnector_ms": 0.012596368789672852, "ViewRequirementAgentConnector_ms": 0.17620086669921875}, "num_episodes": 37, "episode_return_max": 226.5623784486529, "episode_return_min": -21.06506779872859, "episode_return_mean": 49.657905110417666, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5142, "num_agent_steps_trained": 5142, "num_env_steps_sampled": 5142, "num_env_steps_trained": 5142, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 7.349144123932835, "num_env_steps_trained_throughput_per_sec": 7.349144123932835, "timesteps_total": 5142, "num_env_steps_sampled_lifetime": 5142, "num_agent_steps_sampled_lifetime": 5142, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 5142, "timers": {"training_iteration_time_ms": 127311.905, "restore_workers_time_ms": 0.019, "training_step_time_ms": 127311.847, "sample_time_ms": 125961.851, "load_time_ms": 0.579, "load_throughput": 1771657.433, "learn_time_ms": 1336.122, "learn_throughput": 767.894, "synch_weights_time_ms": 12.918}, "counters": {"num_env_steps_sampled": 5142, "num_env_steps_trained": 5142, "num_agent_steps_sampled": 5142, "num_agent_steps_trained": 5142}, "done": false, "episodes_total": 398, "training_iteration": 7, "trial_id": "fe178_00003", "date": "2024-08-15_17-03-42", "timestamp": 1723763022, "time_this_iter_s": 139.61212706565857, "time_total_s": 651.831084728241, "pid": 99756, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 381.9477376937866, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.052, "ram_util_percent": 13.794500000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.656349900364876, "cur_kl_coeff": 1.0, "cur_lr": 0.00010000000000000003, "total_loss": 7.467796621719996, "policy_loss": -0.034431509642551344, "vf_loss": 7.494424376885096, "vf_explained_var": 0.3816347839931647, "kl": 0.007803821463191265, "entropy": 1.0874517696599166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 6168, "num_env_steps_trained": 6168, "num_agent_steps_sampled": 6168, "num_agent_steps_trained": 6168}, "sampler_results": {"episode_reward_max": 226.5623784486529, "episode_reward_min": -11.640757146124429, "episode_reward_mean": 65.42471503246476, "episode_len_mean": 24.57, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 2457, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.725448888510414, 21.00389396461253, -2.588547587682868, 18.43236306544695, -8.288952636718818, 24.90221053883964, 86.68400284400468, -11.319116202073474, 2.5040233304090833, 11.905506580517098, -4.715081739216885, 12.442102358061888, 63.39743170502571, 22.021806109498698, 22.99502766498233, 25.911889960393466, 73.57807961605901, 80.85377430675243, 10.120751488987423, 14.699343735852153, 10.48751469784844, -6.581944148084915, 58.57789119299929, -7.23581384982846, 44.95493441295366, 43.123173177675994, 103.53811901900002, 116.3413022930215, -6.272580618236702, 77.80463782337755, 9.12152200447484, 45.11979479346577, 146.48844429084852, 19.800414798199597, 96.88589179432023, 181.85814414043114, 53.40268778752187, 165.811294180919, 130.78328390850237, 206.82576814279497, 8.020607847334816, 110.30405441656762, 46.92784558760292, 29.213523142555317, -8.415464579854302, 77.66845149899034, 34.823352988070695, 85.63010181713985, 129.53374529222265, 92.74116920474759, 29.07682905776221, 14.993610401706505, -11.640757146124429, 150.14780133781744, 88.64960721516286, 59.55386841856813, -5.176110839843773, -0.318543112179384, 116.53247567989824, 226.5623784486529, 104.65511927196977, 21.197833046774406, 65.11801464033334, 77.42160271674918, 4.165691765298334, 11.673567470966134, 14.234225223156727, 65.53233094831937, 168.3427381056223, 91.47410672942294, 133.42763025302196, 7.965337573772729, 102.318499984095, 215.8839204606326, 213.79697150558167, 144.35799318780943, 178.31740989054958, 32.121577291461435, 20.76233956913643, 43.00907343334744, 136.56264337628676, 94.89730088878031, 12.502342720858337, 44.74569922151697, 2.6769008990260943, 121.72294382756569, 28.787231175056945, 152.01549666208427, 164.22900485730253, 130.99495469356566, 17.636532504145677, 78.27454565727886, 70.13446213013167, 73.38612961277988, -2.8548581593387325, 16.84606746812777, 164.5356263016957, 120.31559087797123, 14.85584302750651, 125.50207792484997], "episode_lengths": [11, 10, 10, 11, 3, 10, 34, 6, 4, 7, 6, 25, 24, 9, 28, 11, 45, 38, 6, 24, 5, 8, 23, 6, 18, 15, 26, 31, 11, 24, 11, 27, 30, 16, 36, 50, 39, 50, 50, 50, 9, 47, 19, 9, 1, 23, 42, 34, 50, 50, 13, 8, 7, 50, 34, 37, 1, 11, 27, 50, 36, 7, 27, 27, 12, 6, 10, 32, 50, 25, 40, 12, 50, 48, 50, 50, 50, 9, 9, 14, 42, 23, 9, 11, 4, 28, 11, 50, 43, 50, 8, 41, 19, 20, 11, 9, 50, 47, 10, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.028646327136958, "mean_inference_ms": 1.256709049095541, "mean_action_processing_ms": 0.20863056612045633, "mean_env_wait_ms": 615.8441491725083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01082754135131836, "StateBufferConnector_ms": 0.01104879379272461, "ViewRequirementAgentConnector_ms": 0.17447257041931152}, "num_episodes": 37, "episode_return_max": 226.5623784486529, "episode_return_min": -11.640757146124429, "episode_return_mean": 65.42471503246476}, "env_runner_results": {"episode_reward_max": 226.5623784486529, "episode_reward_min": -11.640757146124429, "episode_reward_mean": 65.42471503246476, "episode_len_mean": 24.57, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 2457, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.725448888510414, 21.00389396461253, -2.588547587682868, 18.43236306544695, -8.288952636718818, 24.90221053883964, 86.68400284400468, -11.319116202073474, 2.5040233304090833, 11.905506580517098, -4.715081739216885, 12.442102358061888, 63.39743170502571, 22.021806109498698, 22.99502766498233, 25.911889960393466, 73.57807961605901, 80.85377430675243, 10.120751488987423, 14.699343735852153, 10.48751469784844, -6.581944148084915, 58.57789119299929, -7.23581384982846, 44.95493441295366, 43.123173177675994, 103.53811901900002, 116.3413022930215, -6.272580618236702, 77.80463782337755, 9.12152200447484, 45.11979479346577, 146.48844429084852, 19.800414798199597, 96.88589179432023, 181.85814414043114, 53.40268778752187, 165.811294180919, 130.78328390850237, 206.82576814279497, 8.020607847334816, 110.30405441656762, 46.92784558760292, 29.213523142555317, -8.415464579854302, 77.66845149899034, 34.823352988070695, 85.63010181713985, 129.53374529222265, 92.74116920474759, 29.07682905776221, 14.993610401706505, -11.640757146124429, 150.14780133781744, 88.64960721516286, 59.55386841856813, -5.176110839843773, -0.318543112179384, 116.53247567989824, 226.5623784486529, 104.65511927196977, 21.197833046774406, 65.11801464033334, 77.42160271674918, 4.165691765298334, 11.673567470966134, 14.234225223156727, 65.53233094831937, 168.3427381056223, 91.47410672942294, 133.42763025302196, 7.965337573772729, 102.318499984095, 215.8839204606326, 213.79697150558167, 144.35799318780943, 178.31740989054958, 32.121577291461435, 20.76233956913643, 43.00907343334744, 136.56264337628676, 94.89730088878031, 12.502342720858337, 44.74569922151697, 2.6769008990260943, 121.72294382756569, 28.787231175056945, 152.01549666208427, 164.22900485730253, 130.99495469356566, 17.636532504145677, 78.27454565727886, 70.13446213013167, 73.38612961277988, -2.8548581593387325, 16.84606746812777, 164.5356263016957, 120.31559087797123, 14.85584302750651, 125.50207792484997], "episode_lengths": [11, 10, 10, 11, 3, 10, 34, 6, 4, 7, 6, 25, 24, 9, 28, 11, 45, 38, 6, 24, 5, 8, 23, 6, 18, 15, 26, 31, 11, 24, 11, 27, 30, 16, 36, 50, 39, 50, 50, 50, 9, 47, 19, 9, 1, 23, 42, 34, 50, 50, 13, 8, 7, 50, 34, 37, 1, 11, 27, 50, 36, 7, 27, 27, 12, 6, 10, 32, 50, 25, 40, 12, 50, 48, 50, 50, 50, 9, 9, 14, 42, 23, 9, 11, 4, 28, 11, 50, 43, 50, 8, 41, 19, 20, 11, 9, 50, 47, 10, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.028646327136958, "mean_inference_ms": 1.256709049095541, "mean_action_processing_ms": 0.20863056612045633, "mean_env_wait_ms": 615.8441491725083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01082754135131836, "StateBufferConnector_ms": 0.01104879379272461, "ViewRequirementAgentConnector_ms": 0.17447257041931152}, "num_episodes": 37, "episode_return_max": 226.5623784486529, "episode_return_min": -11.640757146124429, "episode_return_mean": 65.42471503246476}, "episode_reward_max": 226.5623784486529, "episode_reward_min": -11.640757146124429, "episode_reward_mean": 65.42471503246476, "episode_len_mean": 24.57, "episodes_this_iter": 37, "episodes_timesteps_total": 2457, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.725448888510414, 21.00389396461253, -2.588547587682868, 18.43236306544695, -8.288952636718818, 24.90221053883964, 86.68400284400468, -11.319116202073474, 2.5040233304090833, 11.905506580517098, -4.715081739216885, 12.442102358061888, 63.39743170502571, 22.021806109498698, 22.99502766498233, 25.911889960393466, 73.57807961605901, 80.85377430675243, 10.120751488987423, 14.699343735852153, 10.48751469784844, -6.581944148084915, 58.57789119299929, -7.23581384982846, 44.95493441295366, 43.123173177675994, 103.53811901900002, 116.3413022930215, -6.272580618236702, 77.80463782337755, 9.12152200447484, 45.11979479346577, 146.48844429084852, 19.800414798199597, 96.88589179432023, 181.85814414043114, 53.40268778752187, 165.811294180919, 130.78328390850237, 206.82576814279497, 8.020607847334816, 110.30405441656762, 46.92784558760292, 29.213523142555317, -8.415464579854302, 77.66845149899034, 34.823352988070695, 85.63010181713985, 129.53374529222265, 92.74116920474759, 29.07682905776221, 14.993610401706505, -11.640757146124429, 150.14780133781744, 88.64960721516286, 59.55386841856813, -5.176110839843773, -0.318543112179384, 116.53247567989824, 226.5623784486529, 104.65511927196977, 21.197833046774406, 65.11801464033334, 77.42160271674918, 4.165691765298334, 11.673567470966134, 14.234225223156727, 65.53233094831937, 168.3427381056223, 91.47410672942294, 133.42763025302196, 7.965337573772729, 102.318499984095, 215.8839204606326, 213.79697150558167, 144.35799318780943, 178.31740989054958, 32.121577291461435, 20.76233956913643, 43.00907343334744, 136.56264337628676, 94.89730088878031, 12.502342720858337, 44.74569922151697, 2.6769008990260943, 121.72294382756569, 28.787231175056945, 152.01549666208427, 164.22900485730253, 130.99495469356566, 17.636532504145677, 78.27454565727886, 70.13446213013167, 73.38612961277988, -2.8548581593387325, 16.84606746812777, 164.5356263016957, 120.31559087797123, 14.85584302750651, 125.50207792484997], "episode_lengths": [11, 10, 10, 11, 3, 10, 34, 6, 4, 7, 6, 25, 24, 9, 28, 11, 45, 38, 6, 24, 5, 8, 23, 6, 18, 15, 26, 31, 11, 24, 11, 27, 30, 16, 36, 50, 39, 50, 50, 50, 9, 47, 19, 9, 1, 23, 42, 34, 50, 50, 13, 8, 7, 50, 34, 37, 1, 11, 27, 50, 36, 7, 27, 27, 12, 6, 10, 32, 50, 25, 40, 12, 50, 48, 50, 50, 50, 9, 9, 14, 42, 23, 9, 11, 4, 28, 11, 50, 43, 50, 8, 41, 19, 20, 11, 9, 50, 47, 10, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.028646327136958, "mean_inference_ms": 1.256709049095541, "mean_action_processing_ms": 0.20863056612045633, "mean_env_wait_ms": 615.8441491725083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01082754135131836, "StateBufferConnector_ms": 0.01104879379272461, "ViewRequirementAgentConnector_ms": 0.17447257041931152}, "num_episodes": 37, "episode_return_max": 226.5623784486529, "episode_return_min": -11.640757146124429, "episode_return_mean": 65.42471503246476, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6168, "num_agent_steps_trained": 6168, "num_env_steps_sampled": 6168, "num_env_steps_trained": 6168, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 8.495603267047581, "num_env_steps_trained_throughput_per_sec": 8.495603267047581, "timesteps_total": 6168, "num_env_steps_sampled_lifetime": 6168, "num_agent_steps_sampled_lifetime": 6168, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 6168, "timers": {"training_iteration_time_ms": 125676.02, "restore_workers_time_ms": 0.02, "training_step_time_ms": 125675.961, "sample_time_ms": 124339.685, "load_time_ms": 0.545, "load_throughput": 1881042.904, "learn_time_ms": 1322.43, "learn_throughput": 775.844, "synch_weights_time_ms": 12.933}, "counters": {"num_env_steps_sampled": 6168, "num_env_steps_trained": 6168, "num_agent_steps_sampled": 6168, "num_agent_steps_trained": 6168}, "done": false, "episodes_total": 435, "training_iteration": 8, "trial_id": "fe178_00003", "date": "2024-08-15_17-05-43", "timestamp": 1723763143, "time_this_iter_s": 120.77251362800598, "time_total_s": 772.603598356247, "pid": 99756, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 502.7202513217926, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.57383720930233, "ram_util_percent": 14.043604651162791}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.449147886037826, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 7.694825053215027, "policy_loss": -0.02115584925826018, "vf_loss": 7.712541019916534, "vf_explained_var": 0.3221966763337453, "kl": 0.006879822762463842, "entropy": 0.867243326207002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6192, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 6192, "num_agent_steps_trained": 6192}, "sampler_results": {"episode_reward_max": 217.54112792973467, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 138.82721118690898, "episode_len_mean": 36.44444444444444, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 328, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.917976946970815, "mean_inference_ms": 1.266028841488815, "mean_action_processing_ms": 0.21268246578835281, "mean_env_wait_ms": 652.1567250881461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009748670789930556, "StateBufferConnector_ms": 0.008310212029351128, "ViewRequirementAgentConnector_ms": 0.16959773169623482}, "num_episodes": 9, "episode_return_max": 217.54112792973467, "episode_return_min": 3.705244261992334, "episode_return_mean": 138.82721118690898}, "env_runner_results": {"episode_reward_max": 217.54112792973467, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 138.82721118690898, "episode_len_mean": 36.44444444444444, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 328, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.917976946970815, "mean_inference_ms": 1.266028841488815, "mean_action_processing_ms": 0.21268246578835281, "mean_env_wait_ms": 652.1567250881461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009748670789930556, "StateBufferConnector_ms": 0.008310212029351128, "ViewRequirementAgentConnector_ms": 0.16959773169623482}, "num_episodes": 9, "episode_return_max": 217.54112792973467, "episode_return_min": 3.705244261992334, "episode_return_mean": 138.82721118690898}, "episode_reward_max": 217.54112792973467, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 138.82721118690898, "episode_len_mean": 36.44444444444444, "episodes_this_iter": 9, "episodes_timesteps_total": 328, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.917976946970815, "mean_inference_ms": 1.266028841488815, "mean_action_processing_ms": 0.21268246578835281, "mean_env_wait_ms": 652.1567250881461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009748670789930556, "StateBufferConnector_ms": 0.008310212029351128, "ViewRequirementAgentConnector_ms": 0.16959773169623482}, "num_episodes": 9, "episode_return_max": 217.54112792973467, "episode_return_min": 3.705244261992334, "episode_return_mean": 138.82721118690898, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6192, "num_agent_steps_trained": 6192, "num_env_steps_sampled": 6192, "num_env_steps_trained": 6192, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.697893746978145, "num_env_steps_trained_throughput_per_sec": 7.697893746978145, "timesteps_total": 6192, "num_env_steps_sampled_lifetime": 6192, "num_agent_steps_sampled_lifetime": 6192, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 6192, "timers": {"training_iteration_time_ms": 67031.334, "restore_workers_time_ms": 0.019, "training_step_time_ms": 67031.274, "sample_time_ms": 60368.968, "load_time_ms": 0.852, "load_throughput": 605726.522, "learn_time_ms": 6648.028, "learn_throughput": 77.617, "synch_weights_time_ms": 12.955}, "counters": {"num_env_steps_sampled": 6192, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 6192, "num_agent_steps_trained": 6192}, "done": false, "episodes_total": 384, "training_iteration": 12, "trial_id": "fe178_00003", "date": "2024-08-15_17-07-09", "timestamp": 1723763229, "time_this_iter_s": 67.03418588638306, "time_total_s": 762.6438822746277, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 67.03418588638306, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.536458333333332, "ram_util_percent": 12.688541666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.627471197644869, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 7.860186449686686, "policy_loss": -0.028188588206345837, "vf_loss": 7.8831406792004906, "vf_explained_var": 0.4419887403647105, "kl": 0.010468614503558394, "entropy": 0.8615675409634908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6708, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 6708, "num_agent_steps_trained": 6708}, "sampler_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 158.78907921287927, "episode_len_mean": 42.04761904761905, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 883, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.7796559024424585, "mean_inference_ms": 1.2586211299485588, "mean_action_processing_ms": 0.21050263827654453, "mean_env_wait_ms": 659.9714549260478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01125335693359375, "StateBufferConnector_ms": 0.006975446428571429, "ViewRequirementAgentConnector_ms": 0.16946452004568918}, "num_episodes": 12, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 158.78907921287927}, "env_runner_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 158.78907921287927, "episode_len_mean": 42.04761904761905, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 883, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.7796559024424585, "mean_inference_ms": 1.2586211299485588, "mean_action_processing_ms": 0.21050263827654453, "mean_env_wait_ms": 659.9714549260478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01125335693359375, "StateBufferConnector_ms": 0.006975446428571429, "ViewRequirementAgentConnector_ms": 0.16946452004568918}, "num_episodes": 12, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 158.78907921287927}, "episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 158.78907921287927, "episode_len_mean": 42.04761904761905, "episodes_this_iter": 12, "episodes_timesteps_total": 883, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.7796559024424585, "mean_inference_ms": 1.2586211299485588, "mean_action_processing_ms": 0.21050263827654453, "mean_env_wait_ms": 659.9714549260478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01125335693359375, "StateBufferConnector_ms": 0.006975446428571429, "ViewRequirementAgentConnector_ms": 0.16946452004568918}, "num_episodes": 12, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 158.78907921287927, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6708, "num_agent_steps_trained": 6708, "num_env_steps_sampled": 6708, "num_env_steps_trained": 6708, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.205967059614462, "num_env_steps_trained_throughput_per_sec": 8.205967059614462, "timesteps_total": 6708, "num_env_steps_sampled_lifetime": 6708, "num_agent_steps_sampled_lifetime": 6708, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 6708, "timers": {"training_iteration_time_ms": 64956.209, "restore_workers_time_ms": 0.019, "training_step_time_ms": 64956.148, "sample_time_ms": 61283.246, "load_time_ms": 0.615, "load_throughput": 839023.401, "learn_time_ms": 3658.824, "learn_throughput": 141.029, "synch_weights_time_ms": 13.088}, "counters": {"num_env_steps_sampled": 6708, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 6708, "num_agent_steps_trained": 6708}, "done": false, "episodes_total": 396, "training_iteration": 13, "trial_id": "fe178_00003", "date": "2024-08-15_17-08-11", "timestamp": 1723763291, "time_this_iter_s": 62.88391709327698, "time_total_s": 825.5277993679047, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 129.91810297966003, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.49777777777778, "ram_util_percent": 13.335555555555558}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.631277958552042, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 7.935648659865062, "policy_loss": -0.01754814775971075, "vf_loss": 7.950321865081787, "vf_explained_var": 0.35813976377248763, "kl": 0.005749831457581302, "entropy": 0.8013085762659709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7224, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 7224, "num_agent_steps_trained": 7224}, "sampler_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 164.57834830919862, "episode_len_mean": 42.81818181818182, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1413, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.806536360965957, "mean_inference_ms": 1.2561583025525822, "mean_action_processing_ms": 0.20996664487353156, "mean_env_wait_ms": 660.5448541338175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01141519257516572, "StateBufferConnector_ms": 0.006688002384070194, "ViewRequirementAgentConnector_ms": 0.17073876930005621}, "num_episodes": 12, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 164.57834830919862}, "env_runner_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 164.57834830919862, "episode_len_mean": 42.81818181818182, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1413, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.806536360965957, "mean_inference_ms": 1.2561583025525822, "mean_action_processing_ms": 0.20996664487353156, "mean_env_wait_ms": 660.5448541338175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01141519257516572, "StateBufferConnector_ms": 0.006688002384070194, "ViewRequirementAgentConnector_ms": 0.17073876930005621}, "num_episodes": 12, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 164.57834830919862}, "episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 164.57834830919862, "episode_len_mean": 42.81818181818182, "episodes_this_iter": 12, "episodes_timesteps_total": 1413, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.806536360965957, "mean_inference_ms": 1.2561583025525822, "mean_action_processing_ms": 0.20996664487353156, "mean_env_wait_ms": 660.5448541338175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01141519257516572, "StateBufferConnector_ms": 0.006688002384070194, "ViewRequirementAgentConnector_ms": 0.17073876930005621}, "num_episodes": 12, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 164.57834830919862, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7224, "num_agent_steps_trained": 7224, "num_env_steps_sampled": 7224, "num_env_steps_trained": 7224, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.184528804529762, "num_env_steps_trained_throughput_per_sec": 8.184528804529762, "timesteps_total": 7224, "num_env_steps_sampled_lifetime": 7224, "num_agent_steps_sampled_lifetime": 7224, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 7224, "timers": {"training_iteration_time_ms": 64319.404, "restore_workers_time_ms": 0.019, "training_step_time_ms": 64319.343, "sample_time_ms": 61642.097, "load_time_ms": 0.534, "load_throughput": 967195.381, "learn_time_ms": 2663.207, "learn_throughput": 193.751, "synch_weights_time_ms": 13.162}, "counters": {"num_env_steps_sampled": 7224, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 7224, "num_agent_steps_trained": 7224}, "done": false, "episodes_total": 408, "training_iteration": 14, "trial_id": "fe178_00003", "date": "2024-08-15_17-09-15", "timestamp": 1723763355, "time_this_iter_s": 63.04922437667847, "time_total_s": 888.5770237445831, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 192.9673273563385, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.005555555555556, "ram_util_percent": 13.428888888888894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.223499051729839, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.198456327120462, "policy_loss": -0.02399477200427403, "vf_loss": 8.218202249209087, "vf_explained_var": 0.43583248456319174, "kl": 0.008497600505825783, "entropy": 0.7474981144070625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7740, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 7740, "num_agent_steps_trained": 7740}, "sampler_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 171.9578214302999, "episode_len_mean": 42.955555555555556, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1933, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.879637144277611, "mean_inference_ms": 1.255996922074361, "mean_action_processing_ms": 0.20991110286256418, "mean_env_wait_ms": 660.5614160806904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011281967163085938, "StateBufferConnector_ms": 0.0065602196587456595, "ViewRequirementAgentConnector_ms": 0.17314434051513672}, "num_episodes": 12, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 171.9578214302999}, "env_runner_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 171.9578214302999, "episode_len_mean": 42.955555555555556, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1933, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.879637144277611, "mean_inference_ms": 1.255996922074361, "mean_action_processing_ms": 0.20991110286256418, "mean_env_wait_ms": 660.5614160806904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011281967163085938, "StateBufferConnector_ms": 0.0065602196587456595, "ViewRequirementAgentConnector_ms": 0.17314434051513672}, "num_episodes": 12, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 171.9578214302999}, "episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 171.9578214302999, "episode_len_mean": 42.955555555555556, "episodes_this_iter": 12, "episodes_timesteps_total": 1933, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.879637144277611, "mean_inference_ms": 1.255996922074361, "mean_action_processing_ms": 0.20991110286256418, "mean_env_wait_ms": 660.5614160806904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011281967163085938, "StateBufferConnector_ms": 0.0065602196587456595, "ViewRequirementAgentConnector_ms": 0.17314434051513672}, "num_episodes": 12, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 171.9578214302999, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7740, "num_agent_steps_trained": 7740, "num_env_steps_sampled": 7740, "num_env_steps_trained": 7740, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.094810432142104, "num_env_steps_trained_throughput_per_sec": 8.094810432142104, "timesteps_total": 7740, "num_env_steps_sampled_lifetime": 7740, "num_agent_steps_sampled_lifetime": 7740, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 7740, "timers": {"training_iteration_time_ms": 64175.692, "restore_workers_time_ms": 0.02, "training_step_time_ms": 64175.63, "sample_time_ms": 61991.627, "load_time_ms": 0.496, "load_throughput": 1040384.984, "learn_time_ms": 2170.034, "learn_throughput": 237.784, "synch_weights_time_ms": 13.142}, "counters": {"num_env_steps_sampled": 7740, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 7740, "num_agent_steps_trained": 7740}, "done": false, "episodes_total": 420, "training_iteration": 15, "trial_id": "fe178_00003", "date": "2024-08-15_17-10-18", "timestamp": 1723763418, "time_this_iter_s": 63.74809384346008, "time_total_s": 952.3251175880432, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 256.7154211997986, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.39560439560439, "ram_util_percent": 12.534065934065934}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.432795707384745, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 7.984596419334411, "policy_loss": -0.04099716113414616, "vf_loss": 8.018828018506367, "vf_explained_var": 0.2952300891280174, "kl": 0.013531141599136046, "entropy": 0.7560590128103892, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8256, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 8256, "num_agent_steps_trained": 8256}, "sampler_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 175.01305602614858, "episode_len_mean": 43.527272727272724, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2394, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.896332560873, "mean_inference_ms": 1.2553432713605555, "mean_action_processing_ms": 0.20994034555432428, "mean_env_wait_ms": 669.3624135234618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011338754133744673, "StateBufferConnector_ms": 0.006478049538352273, "ViewRequirementAgentConnector_ms": 0.17392288554798474}, "num_episodes": 10, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 175.01305602614858}, "env_runner_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 175.01305602614858, "episode_len_mean": 43.527272727272724, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2394, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.896332560873, "mean_inference_ms": 1.2553432713605555, "mean_action_processing_ms": 0.20994034555432428, "mean_env_wait_ms": 669.3624135234618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011338754133744673, "StateBufferConnector_ms": 0.006478049538352273, "ViewRequirementAgentConnector_ms": 0.17392288554798474}, "num_episodes": 10, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 175.01305602614858}, "episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 175.01305602614858, "episode_len_mean": 43.527272727272724, "episodes_this_iter": 10, "episodes_timesteps_total": 2394, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.896332560873, "mean_inference_ms": 1.2553432713605555, "mean_action_processing_ms": 0.20994034555432428, "mean_env_wait_ms": 669.3624135234618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011338754133744673, "StateBufferConnector_ms": 0.006478049538352273, "ViewRequirementAgentConnector_ms": 0.17392288554798474}, "num_episodes": 10, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 175.01305602614858, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8256, "num_agent_steps_trained": 8256, "num_env_steps_sampled": 8256, "num_env_steps_trained": 8256, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 5.955072577036281, "num_env_steps_trained_throughput_per_sec": 5.955072577036281, "timesteps_total": 8256, "num_env_steps_sampled_lifetime": 8256, "num_agent_steps_sampled_lifetime": 8256, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 8256, "timers": {"training_iteration_time_ms": 68670.32, "restore_workers_time_ms": 0.021, "training_step_time_ms": 68670.259, "sample_time_ms": 66784.361, "load_time_ms": 0.46, "load_throughput": 1120681.889, "learn_time_ms": 1872.096, "learn_throughput": 275.627, "synch_weights_time_ms": 13.032}, "counters": {"num_env_steps_sampled": 8256, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 8256, "num_agent_steps_trained": 8256}, "done": false, "episodes_total": 430, "training_iteration": 16, "trial_id": "fe178_00003", "date": "2024-08-15_17-11-45", "timestamp": 1723763505, "time_this_iter_s": 86.65268969535828, "time_total_s": 1038.9778072834015, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 343.36811089515686, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.643548387096775, "ram_util_percent": 12.828225806451615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.514027913411459, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.374188661575317, "policy_loss": -0.02085965177975595, "vf_loss": 8.39160351753235, "vf_explained_var": 0.26368323067824045, "kl": 0.00688960087433531, "entropy": 0.6216906358798345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8772, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 8772, "num_agent_steps_trained": 8772}, "sampler_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 172.41659600976803, "episode_len_mean": 43.0735294117647, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 2929, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.915010207117298, "mean_inference_ms": 1.25513141779549, "mean_action_processing_ms": 0.21005821914944878, "mean_env_wait_ms": 672.5849875577842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011380630380967083, "StateBufferConnector_ms": 0.006376294528736788, "ViewRequirementAgentConnector_ms": 0.1739943728727453}, "num_episodes": 13, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 172.41659600976803}, "env_runner_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 172.41659600976803, "episode_len_mean": 43.0735294117647, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 2929, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.915010207117298, "mean_inference_ms": 1.25513141779549, "mean_action_processing_ms": 0.21005821914944878, "mean_env_wait_ms": 672.5849875577842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011380630380967083, "StateBufferConnector_ms": 0.006376294528736788, "ViewRequirementAgentConnector_ms": 0.1739943728727453}, "num_episodes": 13, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 172.41659600976803}, "episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 172.41659600976803, "episode_len_mean": 43.0735294117647, "episodes_this_iter": 13, "episodes_timesteps_total": 2929, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.915010207117298, "mean_inference_ms": 1.25513141779549, "mean_action_processing_ms": 0.21005821914944878, "mean_env_wait_ms": 672.5849875577842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011380630380967083, "StateBufferConnector_ms": 0.006376294528736788, "ViewRequirementAgentConnector_ms": 0.1739943728727453}, "num_episodes": 13, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 172.41659600976803, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8772, "num_agent_steps_trained": 8772, "num_env_steps_sampled": 8772, "num_env_steps_trained": 8772, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.514852259211139, "num_env_steps_trained_throughput_per_sec": 9.514852259211139, "timesteps_total": 8772, "num_env_steps_sampled_lifetime": 8772, "num_agent_steps_sampled_lifetime": 8772, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 8772, "timers": {"training_iteration_time_ms": 66263.77, "restore_workers_time_ms": 0.02, "training_step_time_ms": 66263.711, "sample_time_ms": 64577.602, "load_time_ms": 0.443, "load_throughput": 1163581.11, "learn_time_ms": 1672.269, "learn_throughput": 308.563, "synch_weights_time_ms": 13.088}, "counters": {"num_env_steps_sampled": 8772, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 8772, "num_agent_steps_trained": 8772}, "done": false, "episodes_total": 443, "training_iteration": 17, "trial_id": "fe178_00003", "date": "2024-08-15_17-12-39", "timestamp": 1723763559, "time_this_iter_s": 54.23427629470825, "time_total_s": 1093.2120835781097, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 397.6023871898651, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.41558441558441, "ram_util_percent": 12.942857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.819372389713923, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.466890076796213, "policy_loss": -0.020784812234342098, "vf_loss": 8.484185246626536, "vf_explained_var": 0.36312530289093653, "kl": 0.006979166238964616, "entropy": 0.6774843563636144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9288, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 9288, "num_agent_steps_trained": 9288}, "sampler_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 178.75476252552335, "episode_len_mean": 43.8125, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3505, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.932233559184587, "mean_inference_ms": 1.2549488371704638, "mean_action_processing_ms": 0.21012597106475264, "mean_env_wait_ms": 669.3925590035273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0115165114402771, "StateBufferConnector_ms": 0.00632554292678833, "ViewRequirementAgentConnector_ms": 0.17350971698760986}, "num_episodes": 12, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 178.75476252552335}, "env_runner_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 178.75476252552335, "episode_len_mean": 43.8125, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3505, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.932233559184587, "mean_inference_ms": 1.2549488371704638, "mean_action_processing_ms": 0.21012597106475264, "mean_env_wait_ms": 669.3925590035273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0115165114402771, "StateBufferConnector_ms": 0.00632554292678833, "ViewRequirementAgentConnector_ms": 0.17350971698760986}, "num_episodes": 12, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 178.75476252552335}, "episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 178.75476252552335, "episode_len_mean": 43.8125, "episodes_this_iter": 12, "episodes_timesteps_total": 3505, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.932233559184587, "mean_inference_ms": 1.2549488371704638, "mean_action_processing_ms": 0.21012597106475264, "mean_env_wait_ms": 669.3925590035273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0115165114402771, "StateBufferConnector_ms": 0.00632554292678833, "ViewRequirementAgentConnector_ms": 0.17350971698760986}, "num_episodes": 12, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 178.75476252552335, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9288, "num_agent_steps_trained": 9288, "num_env_steps_sampled": 9288, "num_env_steps_trained": 9288, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 12.231817173601002, "num_env_steps_trained_throughput_per_sec": 12.231817173601002, "timesteps_total": 9288, "num_env_steps_sampled_lifetime": 9288, "num_agent_steps_sampled_lifetime": 9288, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 9288, "timers": {"training_iteration_time_ms": 62823.956, "restore_workers_time_ms": 0.019, "training_step_time_ms": 62823.9, "sample_time_ms": 61280.959, "load_time_ms": 0.424, "load_throughput": 1217244.58, "learn_time_ms": 1529.215, "learn_throughput": 337.428, "synch_weights_time_ms": 13.01}, "counters": {"num_env_steps_sampled": 9288, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 9288, "num_agent_steps_trained": 9288}, "done": false, "episodes_total": 455, "training_iteration": 18, "trial_id": "fe178_00003", "date": "2024-08-15_17-13-21", "timestamp": 1723763601, "time_this_iter_s": 42.18861413002014, "time_total_s": 1135.4006977081299, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 439.79100131988525, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.8, "ram_util_percent": 13.004918032786886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.718230148156485, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.33593731323878, "policy_loss": -0.022515939346825085, "vf_loss": 8.35490042368571, "vf_explained_var": 0.22472764899333317, "kl": 0.007105707295067987, "entropy": 0.5939018780986468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9804, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 9804, "num_agent_steps_trained": 9804}, "sampler_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 178.46717819631507, "episode_len_mean": 43.62637362637363, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.945677677164538, "mean_inference_ms": 1.2547004129363166, "mean_action_processing_ms": 0.2101714547886959, "mean_env_wait_ms": 665.7349138285671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01139667007949326, "StateBufferConnector_ms": 0.0062832465538611776, "ViewRequirementAgentConnector_ms": 0.1731951158125322}, "num_episodes": 11, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 178.46717819631507}, "env_runner_results": {"episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 178.46717819631507, "episode_len_mean": 43.62637362637363, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.945677677164538, "mean_inference_ms": 1.2547004129363166, "mean_action_processing_ms": 0.2101714547886959, "mean_env_wait_ms": 665.7349138285671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01139667007949326, "StateBufferConnector_ms": 0.0062832465538611776, "ViewRequirementAgentConnector_ms": 0.1731951158125322}, "num_episodes": 11, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 178.46717819631507}, "episode_reward_max": 269.2759655776395, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 178.46717819631507, "episode_len_mean": 43.62637362637363, "episodes_this_iter": 11, "episodes_timesteps_total": 3970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [217.54112792973467, 124.25199145239606, 114.75937809198501, 160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538], "episode_lengths": [50, 34, 25, 50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.945677677164538, "mean_inference_ms": 1.2547004129363166, "mean_action_processing_ms": 0.2101714547886959, "mean_env_wait_ms": 665.7349138285671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01139667007949326, "StateBufferConnector_ms": 0.0062832465538611776, "ViewRequirementAgentConnector_ms": 0.1731951158125322}, "num_episodes": 11, "episode_return_max": 269.2759655776395, "episode_return_min": 3.705244261992334, "episode_return_mean": 178.46717819631507, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9804, "num_agent_steps_trained": 9804, "num_env_steps_sampled": 9804, "num_env_steps_trained": 9804, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.925068143280042, "num_env_steps_trained_throughput_per_sec": 8.925068143280042, "timesteps_total": 9804, "num_env_steps_sampled_lifetime": 9804, "num_agent_steps_sampled_lifetime": 9804, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 9804, "timers": {"training_iteration_time_ms": 62197.799, "restore_workers_time_ms": 0.019, "training_step_time_ms": 62197.743, "sample_time_ms": 60771.528, "load_time_ms": 0.41, "load_throughput": 1259297.906, "learn_time_ms": 1412.465, "learn_throughput": 365.319, "synch_weights_time_ms": 13.052}, "counters": {"num_env_steps_sampled": 9804, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 9804, "num_agent_steps_trained": 9804}, "done": false, "episodes_total": 466, "training_iteration": 19, "trial_id": "fe178_00003", "date": "2024-08-15_17-14-19", "timestamp": 1723763659, "time_this_iter_s": 57.81834387779236, "time_total_s": 1193.2190415859222, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 497.6093451976776, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.37926829268292, "ram_util_percent": 12.818292682926828}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.4991237938404085, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.764290499687196, "policy_loss": -0.018009222586018343, "vf_loss": 8.778891940911612, "vf_explained_var": 0.4769851138194402, "kl": 0.006815267029591462, "entropy": 0.47843072153627875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10320, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 10320, "num_agent_steps_trained": 10320}, "sampler_results": {"episode_reward_max": 301.20492172777875, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 182.91888923186391, "episode_len_mean": 43.87, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4387, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875], "episode_lengths": [50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.971082917687291, "mean_inference_ms": 1.2541985105128584, "mean_action_processing_ms": 0.21009019330705797, "mean_env_wait_ms": 662.7479272544832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011596918106079102, "StateBufferConnector_ms": 0.006255388259887695, "ViewRequirementAgentConnector_ms": 0.1726243495941162}, "num_episodes": 12, "episode_return_max": 301.20492172777875, "episode_return_min": 3.705244261992334, "episode_return_mean": 182.91888923186391}, "env_runner_results": {"episode_reward_max": 301.20492172777875, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 182.91888923186391, "episode_len_mean": 43.87, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4387, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875], "episode_lengths": [50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.971082917687291, "mean_inference_ms": 1.2541985105128584, "mean_action_processing_ms": 0.21009019330705797, "mean_env_wait_ms": 662.7479272544832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011596918106079102, "StateBufferConnector_ms": 0.006255388259887695, "ViewRequirementAgentConnector_ms": 0.1726243495941162}, "num_episodes": 12, "episode_return_max": 301.20492172777875, "episode_return_min": 3.705244261992334, "episode_return_mean": 182.91888923186391}, "episode_reward_max": 301.20492172777875, "episode_reward_min": 3.705244261992334, "episode_reward_mean": 182.91888923186391, "episode_len_mean": 43.87, "episodes_this_iter": 12, "episodes_timesteps_total": 4387, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [160.0866123951144, 29.831995190809607, 189.38202479305056, 3.705244261992334, 204.19759814465536, 205.68892842244287, 269.2759655776395, 192.57079879341853, 178.96208612803224, 139.59267941159476, 200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875], "episode_lengths": [50, 12, 50, 7, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.971082917687291, "mean_inference_ms": 1.2541985105128584, "mean_action_processing_ms": 0.21009019330705797, "mean_env_wait_ms": 662.7479272544832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011596918106079102, "StateBufferConnector_ms": 0.006255388259887695, "ViewRequirementAgentConnector_ms": 0.1726243495941162}, "num_episodes": 12, "episode_return_max": 301.20492172777875, "episode_return_min": 3.705244261992334, "episode_return_mean": 182.91888923186391, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10320, "num_agent_steps_trained": 10320, "num_env_steps_sampled": 10320, "num_env_steps_trained": 10320, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.688640670927583, "num_env_steps_trained_throughput_per_sec": 8.688640670927583, "timesteps_total": 10320, "num_env_steps_sampled_lifetime": 10320, "num_agent_steps_sampled_lifetime": 10320, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 10320, "timers": {"training_iteration_time_ms": 61885.588, "restore_workers_time_ms": 0.018, "training_step_time_ms": 61885.534, "sample_time_ms": 60547.396, "load_time_ms": 0.399, "load_throughput": 1292953.719, "learn_time_ms": 1324.396, "learn_throughput": 389.611, "synch_weights_time_ms": 13.061}, "counters": {"num_env_steps_sampled": 10320, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 10320, "num_agent_steps_trained": 10320}, "done": false, "episodes_total": 478, "training_iteration": 20, "trial_id": "fe178_00003", "date": "2024-08-15_17-15-19", "timestamp": 1723763719, "time_this_iter_s": 59.39131450653076, "time_total_s": 1252.610356092453, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 557.0006597042084, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 26.423529411764704, "ram_util_percent": 13.076470588235289}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.56754395365715, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.587965273857117, "policy_loss": -0.032678228647758566, "vf_loss": 8.613960270086924, "vf_explained_var": 0.2730894808967908, "kl": 0.013366228347513243, "entropy": 0.5288133397698402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10836, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 10836, "num_agent_steps_trained": 10836}, "sampler_results": {"episode_reward_max": 301.20492172777875, "episode_reward_min": 42.52349337115902, "episode_reward_mean": 188.83569771601594, "episode_len_mean": 44.52, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4452, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213], "episode_lengths": [50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.970619227433779, "mean_inference_ms": 1.2528111659561996, "mean_action_processing_ms": 0.20990537457164266, "mean_env_wait_ms": 661.174010140974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011808395385742188, "StateBufferConnector_ms": 0.006042003631591797, "ViewRequirementAgentConnector_ms": 0.1728675365447998}, "num_episodes": 10, "episode_return_max": 301.20492172777875, "episode_return_min": 42.52349337115902, "episode_return_mean": 188.83569771601594}, "env_runner_results": {"episode_reward_max": 301.20492172777875, "episode_reward_min": 42.52349337115902, "episode_reward_mean": 188.83569771601594, "episode_len_mean": 44.52, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4452, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213], "episode_lengths": [50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.970619227433779, "mean_inference_ms": 1.2528111659561996, "mean_action_processing_ms": 0.20990537457164266, "mean_env_wait_ms": 661.174010140974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011808395385742188, "StateBufferConnector_ms": 0.006042003631591797, "ViewRequirementAgentConnector_ms": 0.1728675365447998}, "num_episodes": 10, "episode_return_max": 301.20492172777875, "episode_return_min": 42.52349337115902, "episode_return_mean": 188.83569771601594}, "episode_reward_max": 301.20492172777875, "episode_reward_min": 42.52349337115902, "episode_reward_mean": 188.83569771601594, "episode_len_mean": 44.52, "episodes_this_iter": 10, "episodes_timesteps_total": 4452, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [200.80617181683562, 214.40059313828897, 140.49487639695525, 139.81002564764572, 135.5116126940585, 184.45790840287526, 139.21886716749952, 150.02417761344043, 142.63269803174722, 212.7165336374506, 223.6830357396434, 106.24429701819979, 174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213], "episode_lengths": [50, 50, 50, 33, 50, 40, 50, 32, 35, 50, 50, 25, 50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.970619227433779, "mean_inference_ms": 1.2528111659561996, "mean_action_processing_ms": 0.20990537457164266, "mean_env_wait_ms": 661.174010140974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011808395385742188, "StateBufferConnector_ms": 0.006042003631591797, "ViewRequirementAgentConnector_ms": 0.1728675365447998}, "num_episodes": 10, "episode_return_max": 301.20492172777875, "episode_return_min": 42.52349337115902, "episode_return_mean": 188.83569771601594, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10836, "num_agent_steps_trained": 10836, "num_env_steps_sampled": 10836, "num_env_steps_trained": 10836, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.16170082256106, "num_env_steps_trained_throughput_per_sec": 8.16170082256106, "timesteps_total": 10836, "num_env_steps_sampled_lifetime": 10836, "num_agent_steps_sampled_lifetime": 10836, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 10836, "timers": {"training_iteration_time_ms": 62019.242, "restore_workers_time_ms": 0.018, "training_step_time_ms": 62019.19, "sample_time_ms": 60750.911, "load_time_ms": 0.391, "load_throughput": 1320556.998, "learn_time_ms": 1254.551, "learn_throughput": 411.303, "synch_weights_time_ms": 13.06}, "counters": {"num_env_steps_sampled": 10836, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 10836, "num_agent_steps_trained": 10836}, "done": false, "episodes_total": 488, "training_iteration": 21, "trial_id": "fe178_00003", "date": "2024-08-15_17-16-22", "timestamp": 1723763782, "time_this_iter_s": 63.225544691085815, "time_total_s": 1315.8359007835388, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 620.2262043952942, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.587777777777777, "ram_util_percent": 12.958888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.776834301153818, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.616529357433318, "policy_loss": -0.030837355305751164, "vf_loss": 8.64214882850647, "vf_explained_var": 0.32921062658230466, "kl": 0.010435723329101166, "entropy": 0.38480428407589595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11352, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 11352, "num_agent_steps_trained": 11352}, "sampler_results": {"episode_reward_max": 301.20492172777875, "episode_reward_min": 42.52349337115902, "episode_reward_mean": 197.13779543546258, "episode_len_mean": 45.31, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4531, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575], "episode_lengths": [50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.003650023976142, "mean_inference_ms": 1.2523796076656994, "mean_action_processing_ms": 0.21003436228954903, "mean_env_wait_ms": 658.2025010006495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011667728424072266, "StateBufferConnector_ms": 0.006058454513549805, "ViewRequirementAgentConnector_ms": 0.1733241081237793}, "num_episodes": 12, "episode_return_max": 301.20492172777875, "episode_return_min": 42.52349337115902, "episode_return_mean": 197.13779543546258}, "env_runner_results": {"episode_reward_max": 301.20492172777875, "episode_reward_min": 42.52349337115902, "episode_reward_mean": 197.13779543546258, "episode_len_mean": 45.31, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4531, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575], "episode_lengths": [50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.003650023976142, "mean_inference_ms": 1.2523796076656994, "mean_action_processing_ms": 0.21003436228954903, "mean_env_wait_ms": 658.2025010006495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011667728424072266, "StateBufferConnector_ms": 0.006058454513549805, "ViewRequirementAgentConnector_ms": 0.1733241081237793}, "num_episodes": 12, "episode_return_max": 301.20492172777875, "episode_return_min": 42.52349337115902, "episode_return_mean": 197.13779543546258}, "episode_reward_max": 301.20492172777875, "episode_reward_min": 42.52349337115902, "episode_reward_mean": 197.13779543546258, "episode_len_mean": 45.31, "episodes_this_iter": 12, "episodes_timesteps_total": 4531, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [174.22376048663472, 182.20874205792455, 153.46965387943385, 129.42355470142755, 209.31260324100072, 192.00109713819205, 214.36730429003575, 156.2315505113978, 205.7422703055451, 196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575], "episode_lengths": [50, 50, 43, 36, 50, 50, 50, 41, 50, 50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.003650023976142, "mean_inference_ms": 1.2523796076656994, "mean_action_processing_ms": 0.21003436228954903, "mean_env_wait_ms": 658.2025010006495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011667728424072266, "StateBufferConnector_ms": 0.006058454513549805, "ViewRequirementAgentConnector_ms": 0.1733241081237793}, "num_episodes": 12, "episode_return_max": 301.20492172777875, "episode_return_min": 42.52349337115902, "episode_return_mean": 197.13779543546258, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11352, "num_agent_steps_trained": 11352, "num_env_steps_sampled": 11352, "num_env_steps_trained": 11352, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.603457064570122, "num_env_steps_trained_throughput_per_sec": 8.603457064570122, "timesteps_total": 11352, "num_env_steps_sampled_lifetime": 11352, "num_agent_steps_sampled_lifetime": 11352, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 11352, "timers": {"training_iteration_time_ms": 61313.699, "restore_workers_time_ms": 0.017, "training_step_time_ms": 61313.649, "sample_time_ms": 60642.938, "load_time_ms": 0.336, "load_throughput": 1536135.186, "learn_time_ms": 657.03, "learn_throughput": 785.353, "synch_weights_time_ms": 13.091}, "counters": {"num_env_steps_sampled": 11352, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 11352, "num_agent_steps_trained": 11352}, "done": false, "episodes_total": 500, "training_iteration": 22, "trial_id": "fe178_00003", "date": "2024-08-15_17-17-22", "timestamp": 1723763842, "time_this_iter_s": 59.97979283332825, "time_total_s": 1375.815693616867, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 680.2059972286224, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 27.317441860465113, "ram_util_percent": 12.096511627906974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.613414978981018, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.414674079418182, "policy_loss": -0.039045522548258306, "vf_loss": 8.44903222322464, "vf_explained_var": 0.2208135813474655, "kl": 0.00937472773875996, "entropy": 0.3883120199044546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11868, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 11868, "num_agent_steps_trained": 11868}, "sampler_results": {"episode_reward_max": 301.20492172777875, "episode_reward_min": 42.52349337115902, "episode_reward_mean": 201.33709495741846, "episode_len_mean": 45.52, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 4552, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575, 280.68966250788253, 206.26544254892343, 251.65670273400428, 262.7799125910935, 242.49784187564, 133.91726837234324, 261.0575859501132, 243.27501542314457, 154.77105680402985], "episode_lengths": [50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.016078722305097, "mean_inference_ms": 1.2525656565619783, "mean_action_processing_ms": 0.21023900279767183, "mean_env_wait_ms": 656.1811452353219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01160430908203125, "StateBufferConnector_ms": 0.0060651302337646484, "ViewRequirementAgentConnector_ms": 0.1732349395751953}, "num_episodes": 9, "episode_return_max": 301.20492172777875, "episode_return_min": 42.52349337115902, "episode_return_mean": 201.33709495741846}, "env_runner_results": {"episode_reward_max": 301.20492172777875, "episode_reward_min": 42.52349337115902, "episode_reward_mean": 201.33709495741846, "episode_len_mean": 45.52, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 4552, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575, 280.68966250788253, 206.26544254892343, 251.65670273400428, 262.7799125910935, 242.49784187564, 133.91726837234324, 261.0575859501132, 243.27501542314457, 154.77105680402985], "episode_lengths": [50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.016078722305097, "mean_inference_ms": 1.2525656565619783, "mean_action_processing_ms": 0.21023900279767183, "mean_env_wait_ms": 656.1811452353219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01160430908203125, "StateBufferConnector_ms": 0.0060651302337646484, "ViewRequirementAgentConnector_ms": 0.1732349395751953}, "num_episodes": 9, "episode_return_max": 301.20492172777875, "episode_return_min": 42.52349337115902, "episode_return_mean": 201.33709495741846}, "episode_reward_max": 301.20492172777875, "episode_reward_min": 42.52349337115902, "episode_reward_mean": 201.33709495741846, "episode_len_mean": 45.52, "episodes_this_iter": 9, "episodes_timesteps_total": 4552, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [196.8239221922771, 199.9497460069055, 59.472648300450416, 60.72296540036848, 257.43032547477253, 244.81655166422019, 244.14942183026778, 209.0666492136445, 264.3053236971489, 207.74751163343012, 156.78913444091154, 245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575, 280.68966250788253, 206.26544254892343, 251.65670273400428, 262.7799125910935, 242.49784187564, 133.91726837234324, 261.0575859501132, 243.27501542314457, 154.77105680402985], "episode_lengths": [50, 50, 19, 14, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.016078722305097, "mean_inference_ms": 1.2525656565619783, "mean_action_processing_ms": 0.21023900279767183, "mean_env_wait_ms": 656.1811452353219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01160430908203125, "StateBufferConnector_ms": 0.0060651302337646484, "ViewRequirementAgentConnector_ms": 0.1732349395751953}, "num_episodes": 9, "episode_return_max": 301.20492172777875, "episode_return_min": 42.52349337115902, "episode_return_mean": 201.33709495741846, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11868, "num_agent_steps_trained": 11868, "num_env_steps_sampled": 11868, "num_env_steps_trained": 11868, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.42315334338196, "num_env_steps_trained_throughput_per_sec": 8.42315334338196, "timesteps_total": 11868, "num_env_steps_sampled_lifetime": 11868, "num_agent_steps_sampled_lifetime": 11868, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 11868, "timers": {"training_iteration_time_ms": 61151.563, "restore_workers_time_ms": 0.016, "training_step_time_ms": 61151.516, "sample_time_ms": 60478.932, "load_time_ms": 0.331, "load_throughput": 1557582.486, "learn_time_ms": 658.901, "learn_throughput": 783.123, "synch_weights_time_ms": 13.101}, "counters": {"num_env_steps_sampled": 11868, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 11868, "num_agent_steps_trained": 11868}, "done": false, "episodes_total": 509, "training_iteration": 23, "trial_id": "fe178_00003", "date": "2024-08-15_17-18-23", "timestamp": 1723763903, "time_this_iter_s": 61.26318001747131, "time_total_s": 1437.0788736343384, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 741.4691772460938, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 25.714772727272724, "ram_util_percent": 12.630681818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.9867293993632, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.470815447966258, "policy_loss": -0.03313300571753643, "vf_loss": 8.498309636116028, "vf_explained_var": 0.30966934164365134, "kl": 0.011277691133061742, "entropy": 0.32585113688061634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12384, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 12384, "num_agent_steps_trained": 12384}, "sampler_results": {"episode_reward_max": 301.20492172777875, "episode_reward_min": 42.52349337115902, "episode_reward_mean": 205.74646019780707, "episode_len_mean": 46.27, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4627, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575, 280.68966250788253, 206.26544254892343, 251.65670273400428, 262.7799125910935, 242.49784187564, 133.91726837234324, 261.0575859501132, 243.27501542314457, 154.77105680402985, 120.17941109787891, 288.2038672673007, 160.67993258719622, 262.58444930992755, 253.63339490243015, 205.43800871207168, 182.98287494841674, 284.43740925467694, 282.71856849987773, 249.5309528787585, 251.82185443472622], "episode_lengths": [50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 45, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.99949700226707, "mean_inference_ms": 1.2520486326122806, "mean_action_processing_ms": 0.21034832032390763, "mean_env_wait_ms": 655.2216045879885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011633157730102539, "StateBufferConnector_ms": 0.006037712097167969, "ViewRequirementAgentConnector_ms": 0.17252182960510254}, "num_episodes": 11, "episode_return_max": 301.20492172777875, "episode_return_min": 42.52349337115902, "episode_return_mean": 205.74646019780707}, "env_runner_results": {"episode_reward_max": 301.20492172777875, "episode_reward_min": 42.52349337115902, "episode_reward_mean": 205.74646019780707, "episode_len_mean": 46.27, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4627, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575, 280.68966250788253, 206.26544254892343, 251.65670273400428, 262.7799125910935, 242.49784187564, 133.91726837234324, 261.0575859501132, 243.27501542314457, 154.77105680402985, 120.17941109787891, 288.2038672673007, 160.67993258719622, 262.58444930992755, 253.63339490243015, 205.43800871207168, 182.98287494841674, 284.43740925467694, 282.71856849987773, 249.5309528787585, 251.82185443472622], "episode_lengths": [50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 45, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.99949700226707, "mean_inference_ms": 1.2520486326122806, "mean_action_processing_ms": 0.21034832032390763, "mean_env_wait_ms": 655.2216045879885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011633157730102539, "StateBufferConnector_ms": 0.006037712097167969, "ViewRequirementAgentConnector_ms": 0.17252182960510254}, "num_episodes": 11, "episode_return_max": 301.20492172777875, "episode_return_min": 42.52349337115902, "episode_return_mean": 205.74646019780707}, "episode_reward_max": 301.20492172777875, "episode_reward_min": 42.52349337115902, "episode_reward_mean": 205.74646019780707, "episode_len_mean": 46.27, "episodes_this_iter": 11, "episodes_timesteps_total": 4627, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [245.86305028687286, 242.78864828556237, 197.73949275400628, 214.9286677674533, 181.63365150323375, 178.15640416035126, 42.52349337115902, 191.03958068972236, 174.39325568945412, 218.5498725668611, 159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575, 280.68966250788253, 206.26544254892343, 251.65670273400428, 262.7799125910935, 242.49784187564, 133.91726837234324, 261.0575859501132, 243.27501542314457, 154.77105680402985, 120.17941109787891, 288.2038672673007, 160.67993258719622, 262.58444930992755, 253.63339490243015, 205.43800871207168, 182.98287494841674, 284.43740925467694, 282.71856849987773, 249.5309528787585, 251.82185443472622], "episode_lengths": [50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 45, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.99949700226707, "mean_inference_ms": 1.2520486326122806, "mean_action_processing_ms": 0.21034832032390763, "mean_env_wait_ms": 655.2216045879885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011633157730102539, "StateBufferConnector_ms": 0.006037712097167969, "ViewRequirementAgentConnector_ms": 0.17252182960510254}, "num_episodes": 11, "episode_return_max": 301.20492172777875, "episode_return_min": 42.52349337115902, "episode_return_mean": 205.74646019780707, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12384, "num_agent_steps_trained": 12384, "num_env_steps_sampled": 12384, "num_env_steps_trained": 12384, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 6.869490561327672, "num_env_steps_trained_throughput_per_sec": 6.869490561327672, "timesteps_total": 12384, "num_env_steps_sampled_lifetime": 12384, "num_agent_steps_sampled_lifetime": 12384, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 12384, "timers": {"training_iteration_time_ms": 62358.459, "restore_workers_time_ms": 0.016, "training_step_time_ms": 62358.414, "sample_time_ms": 61685.623, "load_time_ms": 0.327, "load_throughput": 1576645.199, "learn_time_ms": 659.136, "learn_throughput": 782.843, "synch_weights_time_ms": 13.08}, "counters": {"num_env_steps_sampled": 12384, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 12384, "num_agent_steps_trained": 12384}, "done": false, "episodes_total": 520, "training_iteration": 24, "trial_id": "fe178_00003", "date": "2024-08-15_17-19-38", "timestamp": 1723763978, "time_this_iter_s": 75.11815595626831, "time_total_s": 1512.1970295906067, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 816.5873332023621, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 21.74672897196262, "ram_util_percent": 12.734579439252338}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.967304344971975, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.836990213394165, "policy_loss": -0.020403481212755044, "vf_loss": 8.854124029477438, "vf_explained_var": 0.18891083399454753, "kl": 0.006539143163355559, "entropy": 0.22977098658060033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12900, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 12900, "num_agent_steps_trained": 12900}, "sampler_results": {"episode_reward_max": 305.92584968913496, "episode_reward_min": 48.84513101274774, "episode_reward_mean": 212.57953536515427, "episode_len_mean": 46.66, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4666, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575, 280.68966250788253, 206.26544254892343, 251.65670273400428, 262.7799125910935, 242.49784187564, 133.91726837234324, 261.0575859501132, 243.27501542314457, 154.77105680402985, 120.17941109787891, 288.2038672673007, 160.67993258719622, 262.58444930992755, 253.63339490243015, 205.43800871207168, 182.98287494841674, 284.43740925467694, 282.71856849987773, 249.5309528787585, 251.82185443472622, 263.68233667601754, 266.4615670063234, 272.9327751752677, 255.915614527128, 258.572892318931, 238.89077906648765, 221.51545767667398, 305.92584968913496, 234.67992892031089, 252.34643275312348], "episode_lengths": [50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 45, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.991144290245797, "mean_inference_ms": 1.2515819961545718, "mean_action_processing_ms": 0.21031860189366156, "mean_env_wait_ms": 649.6248385047853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011545419692993164, "StateBufferConnector_ms": 0.00600886344909668, "ViewRequirementAgentConnector_ms": 0.17172455787658691}, "num_episodes": 10, "episode_return_max": 305.92584968913496, "episode_return_min": 48.84513101274774, "episode_return_mean": 212.57953536515427}, "env_runner_results": {"episode_reward_max": 305.92584968913496, "episode_reward_min": 48.84513101274774, "episode_reward_mean": 212.57953536515427, "episode_len_mean": 46.66, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4666, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575, 280.68966250788253, 206.26544254892343, 251.65670273400428, 262.7799125910935, 242.49784187564, 133.91726837234324, 261.0575859501132, 243.27501542314457, 154.77105680402985, 120.17941109787891, 288.2038672673007, 160.67993258719622, 262.58444930992755, 253.63339490243015, 205.43800871207168, 182.98287494841674, 284.43740925467694, 282.71856849987773, 249.5309528787585, 251.82185443472622, 263.68233667601754, 266.4615670063234, 272.9327751752677, 255.915614527128, 258.572892318931, 238.89077906648765, 221.51545767667398, 305.92584968913496, 234.67992892031089, 252.34643275312348], "episode_lengths": [50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 45, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.991144290245797, "mean_inference_ms": 1.2515819961545718, "mean_action_processing_ms": 0.21031860189366156, "mean_env_wait_ms": 649.6248385047853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011545419692993164, "StateBufferConnector_ms": 0.00600886344909668, "ViewRequirementAgentConnector_ms": 0.17172455787658691}, "num_episodes": 10, "episode_return_max": 305.92584968913496, "episode_return_min": 48.84513101274774, "episode_return_mean": 212.57953536515427}, "episode_reward_max": 305.92584968913496, "episode_reward_min": 48.84513101274774, "episode_reward_mean": 212.57953536515427, "episode_len_mean": 46.66, "episodes_this_iter": 10, "episodes_timesteps_total": 4666, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [159.66992454350964, 142.53981327418495, 70.930016029446, 90.80832726687765, 193.28558038723247, 186.13816777977428, 58.67676665225184, 243.41552001979971, 222.05695053938956, 181.2806882020103, 219.74274782773455, 204.93791534343978, 125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575, 280.68966250788253, 206.26544254892343, 251.65670273400428, 262.7799125910935, 242.49784187564, 133.91726837234324, 261.0575859501132, 243.27501542314457, 154.77105680402985, 120.17941109787891, 288.2038672673007, 160.67993258719622, 262.58444930992755, 253.63339490243015, 205.43800871207168, 182.98287494841674, 284.43740925467694, 282.71856849987773, 249.5309528787585, 251.82185443472622, 263.68233667601754, 266.4615670063234, 272.9327751752677, 255.915614527128, 258.572892318931, 238.89077906648765, 221.51545767667398, 305.92584968913496, 234.67992892031089, 252.34643275312348], "episode_lengths": [50, 31, 28, 19, 50, 50, 22, 50, 50, 50, 50, 50, 35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 45, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.991144290245797, "mean_inference_ms": 1.2515819961545718, "mean_action_processing_ms": 0.21031860189366156, "mean_env_wait_ms": 649.6248385047853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011545419692993164, "StateBufferConnector_ms": 0.00600886344909668, "ViewRequirementAgentConnector_ms": 0.17172455787658691}, "num_episodes": 10, "episode_return_max": 305.92584968913496, "episode_return_min": 48.84513101274774, "episode_return_mean": 212.57953536515427, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12900, "num_agent_steps_trained": 12900, "num_env_steps_sampled": 12900, "num_env_steps_trained": 12900, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.177781990952262, "num_env_steps_trained_throughput_per_sec": 8.177781990952262, "timesteps_total": 12900, "num_env_steps_sampled_lifetime": 12900, "num_agent_steps_sampled_lifetime": 12900, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 12900, "timers": {"training_iteration_time_ms": 62293.784, "restore_workers_time_ms": 0.016, "training_step_time_ms": 62293.74, "sample_time_ms": 61633.939, "load_time_ms": 0.323, "load_throughput": 1595239.083, "learn_time_ms": 646.221, "learn_throughput": 798.488, "synch_weights_time_ms": 13.017}, "counters": {"num_env_steps_sampled": 12900, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 12900, "num_agent_steps_trained": 12900}, "done": false, "episodes_total": 530, "training_iteration": 25, "trial_id": "fe178_00003", "date": "2024-08-15_17-20-42", "timestamp": 1723764042, "time_this_iter_s": 63.101744651794434, "time_total_s": 1575.2987742424011, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 879.6890778541565, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.37888888888889, "ram_util_percent": 12.585555555555553}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.203728147347768, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.659665922323862, "policy_loss": -0.018278890382498504, "vf_loss": 8.673410876592, "vf_explained_var": 0.1717908317844073, "kl": 0.009067806240637678, "entropy": 0.19928368786349893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13416, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 13416, "num_agent_steps_trained": 13416}, "sampler_results": {"episode_reward_max": 305.92584968913496, "episode_reward_min": 48.84513101274774, "episode_reward_mean": 222.667531262441, "episode_len_mean": 47.51, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4751, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575, 280.68966250788253, 206.26544254892343, 251.65670273400428, 262.7799125910935, 242.49784187564, 133.91726837234324, 261.0575859501132, 243.27501542314457, 154.77105680402985, 120.17941109787891, 288.2038672673007, 160.67993258719622, 262.58444930992755, 253.63339490243015, 205.43800871207168, 182.98287494841674, 284.43740925467694, 282.71856849987773, 249.5309528787585, 251.82185443472622, 263.68233667601754, 266.4615670063234, 272.9327751752677, 255.915614527128, 258.572892318931, 238.89077906648765, 221.51545767667398, 305.92584968913496, 234.67992892031089, 252.34643275312348, 181.73328431616397, 231.04976775317067, 272.8180442242197, 291.7231884339916, 259.68210664691713, 273.86374017399, 236.31977596851135, 255.26960780902704, 284.26266612497835, 262.84262316833923, 231.42132478521717, 201.295878189799], "episode_lengths": [35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 45, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.98199319514438, "mean_inference_ms": 1.2509200387274342, "mean_action_processing_ms": 0.21024629889576538, "mean_env_wait_ms": 646.0245214039659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011519432067871094, "StateBufferConnector_ms": 0.006037235260009766, "ViewRequirementAgentConnector_ms": 0.17243432998657227}, "num_episodes": 12, "episode_return_max": 305.92584968913496, "episode_return_min": 48.84513101274774, "episode_return_mean": 222.667531262441}, "env_runner_results": {"episode_reward_max": 305.92584968913496, "episode_reward_min": 48.84513101274774, "episode_reward_mean": 222.667531262441, "episode_len_mean": 47.51, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4751, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575, 280.68966250788253, 206.26544254892343, 251.65670273400428, 262.7799125910935, 242.49784187564, 133.91726837234324, 261.0575859501132, 243.27501542314457, 154.77105680402985, 120.17941109787891, 288.2038672673007, 160.67993258719622, 262.58444930992755, 253.63339490243015, 205.43800871207168, 182.98287494841674, 284.43740925467694, 282.71856849987773, 249.5309528787585, 251.82185443472622, 263.68233667601754, 266.4615670063234, 272.9327751752677, 255.915614527128, 258.572892318931, 238.89077906648765, 221.51545767667398, 305.92584968913496, 234.67992892031089, 252.34643275312348, 181.73328431616397, 231.04976775317067, 272.8180442242197, 291.7231884339916, 259.68210664691713, 273.86374017399, 236.31977596851135, 255.26960780902704, 284.26266612497835, 262.84262316833923, 231.42132478521717, 201.295878189799], "episode_lengths": [35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 45, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.98199319514438, "mean_inference_ms": 1.2509200387274342, "mean_action_processing_ms": 0.21024629889576538, "mean_env_wait_ms": 646.0245214039659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011519432067871094, "StateBufferConnector_ms": 0.006037235260009766, "ViewRequirementAgentConnector_ms": 0.17243432998657227}, "num_episodes": 12, "episode_return_max": 305.92584968913496, "episode_return_min": 48.84513101274774, "episode_return_mean": 222.667531262441}, "episode_reward_max": 305.92584968913496, "episode_reward_min": 48.84513101274774, "episode_reward_mean": 222.667531262441, "episode_len_mean": 47.51, "episodes_this_iter": 12, "episodes_timesteps_total": 4751, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [125.12802936040083, 221.0342706768442, 236.8683307759399, 194.65983653862912, 161.65271072318404, 243.33228691683667, 173.79239470093904, 151.93517125442634, 249.85998474843944, 241.04948054761223, 247.88909209804513, 256.87372099471344, 197.10519340203484, 108.8250255553973, 83.66133627337392, 228.73949770523615, 142.20437951354603, 234.83712623652826, 188.4292843113115, 217.87842948903892, 188.6802137632253, 131.76817339585233, 215.78758112793878, 199.3211664513538, 159.6907544614303, 226.924842300024, 216.0460024751393, 225.70370385277096, 120.29520127288112, 222.05498625707457, 236.46534825821004, 266.6694442442598, 48.84513101274774, 242.81854388038994, 241.20932505313067, 301.20492172777875, 210.222408396988, 186.33115346790487, 163.37055774574367, 232.4071196880065, 279.7077626713232, 245.29762210188142, 276.7813466269099, 102.66597962630263, 253.56255227312198, 214.62827893577213, 269.0298104716872, 250.55268740543164, 216.95410364141918, 248.1150482386322, 200.20188407250038, 238.21107005214316, 191.5105317073491, 214.86127699345735, 277.2101568812913, 227.94144598248823, 260.50381887177, 225.11873493113575, 280.68966250788253, 206.26544254892343, 251.65670273400428, 262.7799125910935, 242.49784187564, 133.91726837234324, 261.0575859501132, 243.27501542314457, 154.77105680402985, 120.17941109787891, 288.2038672673007, 160.67993258719622, 262.58444930992755, 253.63339490243015, 205.43800871207168, 182.98287494841674, 284.43740925467694, 282.71856849987773, 249.5309528787585, 251.82185443472622, 263.68233667601754, 266.4615670063234, 272.9327751752677, 255.915614527128, 258.572892318931, 238.89077906648765, 221.51545767667398, 305.92584968913496, 234.67992892031089, 252.34643275312348, 181.73328431616397, 231.04976775317067, 272.8180442242197, 291.7231884339916, 259.68210664691713, 273.86374017399, 236.31977596851135, 255.26960780902704, 284.26266612497835, 262.84262316833923, 231.42132478521717, 201.295878189799], "episode_lengths": [35, 50, 50, 50, 42, 50, 35, 49, 50, 50, 50, 50, 50, 24, 18, 50, 39, 50, 50, 50, 50, 34, 50, 50, 28, 49, 50, 50, 36, 50, 50, 50, 15, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 45, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.98199319514438, "mean_inference_ms": 1.2509200387274342, "mean_action_processing_ms": 0.21024629889576538, "mean_env_wait_ms": 646.0245214039659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011519432067871094, "StateBufferConnector_ms": 0.006037235260009766, "ViewRequirementAgentConnector_ms": 0.17243432998657227}, "num_episodes": 12, "episode_return_max": 305.92584968913496, "episode_return_min": 48.84513101274774, "episode_return_mean": 222.667531262441, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13416, "num_agent_steps_trained": 13416, "num_env_steps_sampled": 13416, "num_env_steps_trained": 13416, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.445598480136072, "num_env_steps_trained_throughput_per_sec": 7.445598480136072, "timesteps_total": 13416, "num_env_steps_sampled_lifetime": 13416, "num_agent_steps_sampled_lifetime": 13416, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 13416, "timers": {"training_iteration_time_ms": 60559.171, "restore_workers_time_ms": 0.015, "training_step_time_ms": 60559.129, "sample_time_ms": 59899.456, "load_time_ms": 0.323, "load_throughput": 1599246.925, "learn_time_ms": 645.993, "learn_throughput": 798.771, "synch_weights_time_ms": 13.112}, "counters": {"num_env_steps_sampled": 13416, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 13416, "num_agent_steps_trained": 13416}, "done": false, "episodes_total": 542, "training_iteration": 26, "trial_id": "fe178_00003", "date": "2024-08-15_17-21-51", "timestamp": 1723764111, "time_this_iter_s": 69.30634140968323, "time_total_s": 1644.6051156520844, "pid": 59213, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 948.9954192638397, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.42828282828283, "ram_util_percent": 10.683838383838381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.5129858215649925, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.41887085835139, "policy_loss": -0.018055119241277378, "vf_loss": 8.434063482284547, "vf_explained_var": 0.3130422383546829, "kl": 0.005724883801425687, "entropy": 0.2029735055946124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13932, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 13932, "num_agent_steps_trained": 13932}, "sampler_results": {"episode_reward_max": 320.6069977584889, "episode_reward_min": 220.13217423544273, "episode_reward_mean": 253.93995546709905, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.26098781535546, 220.13217423544273, 266.26828313225684, 320.6069977584889, 252.89488215600602, 239.47640770504432], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.127090004668839, "mean_inference_ms": 1.2526498443778904, "mean_action_processing_ms": 0.2086002707938125, "mean_env_wait_ms": 588.0197830127116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0088651974995931, "StateBufferConnector_ms": 0.00589291254679362, "ViewRequirementAgentConnector_ms": 0.16417503356933594}, "num_episodes": 6, "episode_return_max": 320.6069977584889, "episode_return_min": 220.13217423544273, "episode_return_mean": 253.93995546709905}, "env_runner_results": {"episode_reward_max": 320.6069977584889, "episode_reward_min": 220.13217423544273, "episode_reward_mean": 253.93995546709905, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.26098781535546, 220.13217423544273, 266.26828313225684, 320.6069977584889, 252.89488215600602, 239.47640770504432], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.127090004668839, "mean_inference_ms": 1.2526498443778904, "mean_action_processing_ms": 0.2086002707938125, "mean_env_wait_ms": 588.0197830127116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0088651974995931, "StateBufferConnector_ms": 0.00589291254679362, "ViewRequirementAgentConnector_ms": 0.16417503356933594}, "num_episodes": 6, "episode_return_max": 320.6069977584889, "episode_return_min": 220.13217423544273, "episode_return_mean": 253.93995546709905}, "episode_reward_max": 320.6069977584889, "episode_reward_min": 220.13217423544273, "episode_reward_mean": 253.93995546709905, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [224.26098781535546, 220.13217423544273, 266.26828313225684, 320.6069977584889, 252.89488215600602, 239.47640770504432], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.127090004668839, "mean_inference_ms": 1.2526498443778904, "mean_action_processing_ms": 0.2086002707938125, "mean_env_wait_ms": 588.0197830127116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0088651974995931, "StateBufferConnector_ms": 0.00589291254679362, "ViewRequirementAgentConnector_ms": 0.16417503356933594}, "num_episodes": 6, "episode_return_max": 320.6069977584889, "episode_return_min": 220.13217423544273, "episode_return_mean": 253.93995546709905, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13932, "num_agent_steps_trained": 13932, "num_env_steps_sampled": 13932, "num_env_steps_trained": 13932, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.905822147322294, "num_env_steps_trained_throughput_per_sec": 8.905822147322294, "timesteps_total": 13932, "num_env_steps_sampled_lifetime": 13932, "num_agent_steps_sampled_lifetime": 13932, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 13932, "timers": {"training_iteration_time_ms": 57939.635, "restore_workers_time_ms": 0.014, "training_step_time_ms": 57939.589, "sample_time_ms": 54445.142, "load_time_ms": 0.789, "load_throughput": 653855.246, "learn_time_ms": 3480.248, "learn_throughput": 148.265, "synch_weights_time_ms": 12.982}, "counters": {"num_env_steps_sampled": 13932, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 13932, "num_agent_steps_trained": 13932}, "done": false, "episodes_total": 548, "training_iteration": 27, "trial_id": "fe178_00003", "date": "2024-08-15_17-23-14", "timestamp": 1723764194, "time_this_iter_s": 57.94282841682434, "time_total_s": 1702.5479440689087, "pid": 72075, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 57.94282841682434, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.171084337349395, "ram_util_percent": 11.5289156626506}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.705174841483434, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.831563572088877, "policy_loss": -0.023905195544163385, "vf_loss": 8.850627235571544, "vf_explained_var": 0.3186069721976916, "kl": 0.009683120440362632, "entropy": 0.08081875698796163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "sampler_results": {"episode_reward_max": 320.6069977584889, "episode_reward_min": 204.66797256097544, "episode_reward_mean": 259.9179604820291, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.26098781535546, 220.13217423544273, 266.26828313225684, 320.6069977584889, 252.89488215600602, 239.47640770504432, 291.4338300556491, 304.94691334355446, 271.79222151925273, 204.66797256097544, 287.62743282896963, 252.5788308939036, 249.57793038754517, 258.2908702057154, 219.9302209009303, 281.7059781898492, 255.05489571379167, 277.27645927379393], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.870943050723724, "mean_inference_ms": 1.2579079104972604, "mean_action_processing_ms": 0.20856299935499295, "mean_env_wait_ms": 576.6167370901082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0125937991672092, "StateBufferConnector_ms": 0.006510151757134331, "ViewRequirementAgentConnector_ms": 0.17359654108683267}, "num_episodes": 12, "episode_return_max": 320.6069977584889, "episode_return_min": 204.66797256097544, "episode_return_mean": 259.9179604820291}, "env_runner_results": {"episode_reward_max": 320.6069977584889, "episode_reward_min": 204.66797256097544, "episode_reward_mean": 259.9179604820291, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.26098781535546, 220.13217423544273, 266.26828313225684, 320.6069977584889, 252.89488215600602, 239.47640770504432, 291.4338300556491, 304.94691334355446, 271.79222151925273, 204.66797256097544, 287.62743282896963, 252.5788308939036, 249.57793038754517, 258.2908702057154, 219.9302209009303, 281.7059781898492, 255.05489571379167, 277.27645927379393], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.870943050723724, "mean_inference_ms": 1.2579079104972604, "mean_action_processing_ms": 0.20856299935499295, "mean_env_wait_ms": 576.6167370901082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0125937991672092, "StateBufferConnector_ms": 0.006510151757134331, "ViewRequirementAgentConnector_ms": 0.17359654108683267}, "num_episodes": 12, "episode_return_max": 320.6069977584889, "episode_return_min": 204.66797256097544, "episode_return_mean": 259.9179604820291}, "episode_reward_max": 320.6069977584889, "episode_reward_min": 204.66797256097544, "episode_reward_mean": 259.9179604820291, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [224.26098781535546, 220.13217423544273, 266.26828313225684, 320.6069977584889, 252.89488215600602, 239.47640770504432, 291.4338300556491, 304.94691334355446, 271.79222151925273, 204.66797256097544, 287.62743282896963, 252.5788308939036, 249.57793038754517, 258.2908702057154, 219.9302209009303, 281.7059781898492, 255.05489571379167, 277.27645927379393], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.870943050723724, "mean_inference_ms": 1.2579079104972604, "mean_action_processing_ms": 0.20856299935499295, "mean_env_wait_ms": 576.6167370901082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0125937991672092, "StateBufferConnector_ms": 0.006510151757134331, "ViewRequirementAgentConnector_ms": 0.17359654108683267}, "num_episodes": 12, "episode_return_max": 320.6069977584889, "episode_return_min": 204.66797256097544, "episode_return_mean": 259.9179604820291, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.519890832857627, "num_env_steps_trained_throughput_per_sec": 9.519890832857627, "timesteps_total": 14448, "num_env_steps_sampled_lifetime": 14448, "num_agent_steps_sampled_lifetime": 14448, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 14448, "timers": {"training_iteration_time_ms": 56070.977, "restore_workers_time_ms": 0.022, "training_step_time_ms": 56070.913, "sample_time_ms": 54017.907, "load_time_ms": 0.557, "load_throughput": 926085.094, "learn_time_ms": 2038.72, "learn_throughput": 253.1, "synch_weights_time_ms": 13.368}, "counters": {"num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "done": false, "episodes_total": 560, "training_iteration": 28, "trial_id": "fe178_00003", "date": "2024-08-15_17-24-08", "timestamp": 1723764248, "time_this_iter_s": 54.20571184158325, "time_total_s": 1756.753655910492, "pid": 72075, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 112.14854025840759, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.058974358974357, "ram_util_percent": 12.299999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.630966879924139, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.787153077125549, "policy_loss": -0.015261037678768238, "vf_loss": 8.799453512827556, "vf_explained_var": 0.4035182202855746, "kl": 0.005921146237962053, "entropy": 0.06536484799968699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14964, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 14964, "num_agent_steps_trained": 14964}, "sampler_results": {"episode_reward_max": 320.6069977584889, "episode_reward_min": 93.80201843467033, "episode_reward_mean": 260.33379247305686, "episode_len_mean": 48.96666666666667, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1469, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.26098781535546, 220.13217423544273, 266.26828313225684, 320.6069977584889, 252.89488215600602, 239.47640770504432, 291.4338300556491, 304.94691334355446, 271.79222151925273, 204.66797256097544, 287.62743282896963, 252.5788308939036, 249.57793038754517, 258.2908702057154, 219.9302209009303, 281.7059781898492, 255.05489571379167, 277.27645927379393, 258.40602696328483, 93.80201843467033, 208.9321405774105, 295.52067313695335, 283.43274486140166, 262.57838063116685, 264.0083958895298, 278.1641253260249, 286.5027445030007, 301.1102169655099, 290.467421681608, 308.56559654461915], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.161241847596504, "mean_inference_ms": 1.2600304266691045, "mean_action_processing_ms": 0.20861308436124507, "mean_env_wait_ms": 587.8995503381008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012972354888916016, "StateBufferConnector_ms": 0.0065199534098307295, "ViewRequirementAgentConnector_ms": 0.17336130142211914}, "num_episodes": 12, "episode_return_max": 320.6069977584889, "episode_return_min": 93.80201843467033, "episode_return_mean": 260.33379247305686}, "env_runner_results": {"episode_reward_max": 320.6069977584889, "episode_reward_min": 93.80201843467033, "episode_reward_mean": 260.33379247305686, "episode_len_mean": 48.96666666666667, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1469, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.26098781535546, 220.13217423544273, 266.26828313225684, 320.6069977584889, 252.89488215600602, 239.47640770504432, 291.4338300556491, 304.94691334355446, 271.79222151925273, 204.66797256097544, 287.62743282896963, 252.5788308939036, 249.57793038754517, 258.2908702057154, 219.9302209009303, 281.7059781898492, 255.05489571379167, 277.27645927379393, 258.40602696328483, 93.80201843467033, 208.9321405774105, 295.52067313695335, 283.43274486140166, 262.57838063116685, 264.0083958895298, 278.1641253260249, 286.5027445030007, 301.1102169655099, 290.467421681608, 308.56559654461915], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.161241847596504, "mean_inference_ms": 1.2600304266691045, "mean_action_processing_ms": 0.20861308436124507, "mean_env_wait_ms": 587.8995503381008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012972354888916016, "StateBufferConnector_ms": 0.0065199534098307295, "ViewRequirementAgentConnector_ms": 0.17336130142211914}, "num_episodes": 12, "episode_return_max": 320.6069977584889, "episode_return_min": 93.80201843467033, "episode_return_mean": 260.33379247305686}, "episode_reward_max": 320.6069977584889, "episode_reward_min": 93.80201843467033, "episode_reward_mean": 260.33379247305686, "episode_len_mean": 48.96666666666667, "episodes_this_iter": 12, "episodes_timesteps_total": 1469, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [224.26098781535546, 220.13217423544273, 266.26828313225684, 320.6069977584889, 252.89488215600602, 239.47640770504432, 291.4338300556491, 304.94691334355446, 271.79222151925273, 204.66797256097544, 287.62743282896963, 252.5788308939036, 249.57793038754517, 258.2908702057154, 219.9302209009303, 281.7059781898492, 255.05489571379167, 277.27645927379393, 258.40602696328483, 93.80201843467033, 208.9321405774105, 295.52067313695335, 283.43274486140166, 262.57838063116685, 264.0083958895298, 278.1641253260249, 286.5027445030007, 301.1102169655099, 290.467421681608, 308.56559654461915], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.161241847596504, "mean_inference_ms": 1.2600304266691045, "mean_action_processing_ms": 0.20861308436124507, "mean_env_wait_ms": 587.8995503381008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012972354888916016, "StateBufferConnector_ms": 0.0065199534098307295, "ViewRequirementAgentConnector_ms": 0.17336130142211914}, "num_episodes": 12, "episode_return_max": 320.6069977584889, "episode_return_min": 93.80201843467033, "episode_return_mean": 260.33379247305686, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14964, "num_agent_steps_trained": 14964, "num_env_steps_sampled": 14964, "num_env_steps_trained": 14964, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.305170108504905, "num_env_steps_trained_throughput_per_sec": 8.305170108504905, "timesteps_total": 14964, "num_env_steps_sampled_lifetime": 14964, "num_agent_steps_sampled_lifetime": 14964, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 14964, "timers": {"training_iteration_time_ms": 58090.646, "restore_workers_time_ms": 0.02, "training_step_time_ms": 58090.587, "sample_time_ms": 56494.901, "load_time_ms": 0.485, "load_throughput": 1064914.317, "learn_time_ms": 1581.768, "learn_throughput": 326.217, "synch_weights_time_ms": 13.116}, "counters": {"num_env_steps_sampled": 14964, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 14964, "num_agent_steps_trained": 14964}, "done": false, "episodes_total": 572, "training_iteration": 29, "trial_id": "fe178_00003", "date": "2024-08-15_17-25-10", "timestamp": 1723764310, "time_this_iter_s": 62.133164405822754, "time_total_s": 1818.8868203163147, "pid": 72075, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 174.28170466423035, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.10337078651685, "ram_util_percent": 12.322471910112363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.617183456818262, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.584707244237263, "policy_loss": -0.020760397675136724, "vf_loss": 8.600552614529928, "vf_explained_var": 0.4516335502266884, "kl": 0.009830200650807528, "entropy": 0.03119831203172604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15480, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 15480, "num_agent_steps_trained": 15480}, "sampler_results": {"episode_reward_max": 312.7856721391065, "episode_reward_min": 98.66264338173818, "episode_reward_mean": 256.0795286874412, "episode_len_mean": 46.285714285714285, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 324, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [248.5303279163873, 266.1048304353641, 312.7856721391065, 297.11474753013295, 98.66264338173818, 273.72796071000215, 295.63051869935697], "episode_lengths": [50, 50, 50, 50, 24, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7282714561875805, "mean_inference_ms": 1.2521230919999247, "mean_action_processing_ms": 0.20999195931971756, "mean_env_wait_ms": 616.8913645501598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009744507925851005, "StateBufferConnector_ms": 0.006076267787388393, "ViewRequirementAgentConnector_ms": 0.17324515751429967}, "num_episodes": 7, "episode_return_max": 312.7856721391065, "episode_return_min": 98.66264338173818, "episode_return_mean": 256.0795286874412}, "env_runner_results": {"episode_reward_max": 312.7856721391065, "episode_reward_min": 98.66264338173818, "episode_reward_mean": 256.0795286874412, "episode_len_mean": 46.285714285714285, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 324, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [248.5303279163873, 266.1048304353641, 312.7856721391065, 297.11474753013295, 98.66264338173818, 273.72796071000215, 295.63051869935697], "episode_lengths": [50, 50, 50, 50, 24, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7282714561875805, "mean_inference_ms": 1.2521230919999247, "mean_action_processing_ms": 0.20999195931971756, "mean_env_wait_ms": 616.8913645501598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009744507925851005, "StateBufferConnector_ms": 0.006076267787388393, "ViewRequirementAgentConnector_ms": 0.17324515751429967}, "num_episodes": 7, "episode_return_max": 312.7856721391065, "episode_return_min": 98.66264338173818, "episode_return_mean": 256.0795286874412}, "episode_reward_max": 312.7856721391065, "episode_reward_min": 98.66264338173818, "episode_reward_mean": 256.0795286874412, "episode_len_mean": 46.285714285714285, "episodes_this_iter": 7, "episodes_timesteps_total": 324, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [248.5303279163873, 266.1048304353641, 312.7856721391065, 297.11474753013295, 98.66264338173818, 273.72796071000215, 295.63051869935697], "episode_lengths": [50, 50, 50, 50, 24, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7282714561875805, "mean_inference_ms": 1.2521230919999247, "mean_action_processing_ms": 0.20999195931971756, "mean_env_wait_ms": 616.8913645501598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009744507925851005, "StateBufferConnector_ms": 0.006076267787388393, "ViewRequirementAgentConnector_ms": 0.17324515751429967}, "num_episodes": 7, "episode_return_max": 312.7856721391065, "episode_return_min": 98.66264338173818, "episode_return_mean": 256.0795286874412, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15480, "num_agent_steps_trained": 15480, "num_env_steps_sampled": 15480, "num_env_steps_trained": 15480, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.864995651739925, "num_env_steps_trained_throughput_per_sec": 8.864995651739925, "timesteps_total": 15480, "num_env_steps_sampled_lifetime": 15480, "num_agent_steps_sampled_lifetime": 15480, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 15480, "timers": {"training_iteration_time_ms": 58206.471, "restore_workers_time_ms": 0.019, "training_step_time_ms": 58206.411, "sample_time_ms": 57510.658, "load_time_ms": 0.845, "load_throughput": 610855.451, "learn_time_ms": 681.08, "learn_throughput": 757.62, "synch_weights_time_ms": 13.37}, "counters": {"num_env_steps_sampled": 15480, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 15480, "num_agent_steps_trained": 15480}, "done": false, "episodes_total": 579, "training_iteration": 30, "trial_id": "fe178_00003", "date": "2024-08-15_17-26-39", "timestamp": 1723764399, "time_this_iter_s": 58.20976161956787, "time_total_s": 1877.0965819358826, "pid": 96536, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 58.20976161956787, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.947619047619053, "ram_util_percent": 12.17261904761905}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.202316941817601, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.73142656882604, "policy_loss": -0.023049259930849074, "vf_loss": 8.75069043636322, "vf_explained_var": 0.46009372770786283, "kl": 0.007571018378075678, "entropy": -0.029793080020075042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15996, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 15996, "num_agent_steps_trained": 15996}, "sampler_results": {"episode_reward_max": 312.7856721391065, "episode_reward_min": 98.66264338173818, "episode_reward_mean": 264.60410523630475, "episode_len_mean": 48.55555555555556, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 874, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [248.5303279163873, 266.1048304353641, 312.7856721391065, 297.11474753013295, 98.66264338173818, 273.72796071000215, 295.63051869935697, 253.57349766794147, 298.48729642611374, 217.4452297234595, 245.3531270996082, 294.69188717395235, 287.4283638322569, 250.61291686461334, 271.4236923928963, 285.9617002779057, 263.85597930958875, 301.483502673062], "episode_lengths": [50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0494201032357084, "mean_inference_ms": 1.2573089141566343, "mean_action_processing_ms": 0.20943139783031467, "mean_env_wait_ms": 551.868253404596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011800395117865669, "StateBufferConnector_ms": 0.006173716651068794, "ViewRequirementAgentConnector_ms": 0.17147726482815212}, "num_episodes": 11, "episode_return_max": 312.7856721391065, "episode_return_min": 98.66264338173818, "episode_return_mean": 264.60410523630475}, "env_runner_results": {"episode_reward_max": 312.7856721391065, "episode_reward_min": 98.66264338173818, "episode_reward_mean": 264.60410523630475, "episode_len_mean": 48.55555555555556, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 874, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [248.5303279163873, 266.1048304353641, 312.7856721391065, 297.11474753013295, 98.66264338173818, 273.72796071000215, 295.63051869935697, 253.57349766794147, 298.48729642611374, 217.4452297234595, 245.3531270996082, 294.69188717395235, 287.4283638322569, 250.61291686461334, 271.4236923928963, 285.9617002779057, 263.85597930958875, 301.483502673062], "episode_lengths": [50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0494201032357084, "mean_inference_ms": 1.2573089141566343, "mean_action_processing_ms": 0.20943139783031467, "mean_env_wait_ms": 551.868253404596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011800395117865669, "StateBufferConnector_ms": 0.006173716651068794, "ViewRequirementAgentConnector_ms": 0.17147726482815212}, "num_episodes": 11, "episode_return_max": 312.7856721391065, "episode_return_min": 98.66264338173818, "episode_return_mean": 264.60410523630475}, "episode_reward_max": 312.7856721391065, "episode_reward_min": 98.66264338173818, "episode_reward_mean": 264.60410523630475, "episode_len_mean": 48.55555555555556, "episodes_this_iter": 11, "episodes_timesteps_total": 874, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [248.5303279163873, 266.1048304353641, 312.7856721391065, 297.11474753013295, 98.66264338173818, 273.72796071000215, 295.63051869935697, 253.57349766794147, 298.48729642611374, 217.4452297234595, 245.3531270996082, 294.69188717395235, 287.4283638322569, 250.61291686461334, 271.4236923928963, 285.9617002779057, 263.85597930958875, 301.483502673062], "episode_lengths": [50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0494201032357084, "mean_inference_ms": 1.2573089141566343, "mean_action_processing_ms": 0.20943139783031467, "mean_env_wait_ms": 551.868253404596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011800395117865669, "StateBufferConnector_ms": 0.006173716651068794, "ViewRequirementAgentConnector_ms": 0.17147726482815212}, "num_episodes": 11, "episode_return_max": 312.7856721391065, "episode_return_min": 98.66264338173818, "episode_return_mean": 264.60410523630475, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15996, "num_agent_steps_trained": 15996, "num_env_steps_sampled": 15996, "num_env_steps_trained": 15996, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.519621659136632, "num_env_steps_trained_throughput_per_sec": 13.519621659136632, "timesteps_total": 15996, "num_env_steps_sampled_lifetime": 15996, "num_agent_steps_sampled_lifetime": 15996, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 15996, "timers": {"training_iteration_time_ms": 48186.616, "restore_workers_time_ms": 0.021, "training_step_time_ms": 48186.549, "sample_time_ms": 47496.697, "load_time_ms": 0.589, "load_throughput": 875687.179, "learn_time_ms": 675.556, "learn_throughput": 763.815, "synch_weights_time_ms": 13.333}, "counters": {"num_env_steps_sampled": 15996, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 15996, "num_agent_steps_trained": 15996}, "done": false, "episodes_total": 590, "training_iteration": 31, "trial_id": "fe178_00003", "date": "2024-08-15_17-27-18", "timestamp": 1723764438, "time_this_iter_s": 38.17009997367859, "time_total_s": 1915.2666819095612, "pid": 96536, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 96.37986159324646, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.22962962962964, "ram_util_percent": 12.411111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.546055312951406, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.664654835065205, "policy_loss": -0.01998549368387709, "vf_loss": 8.680110549926757, "vf_explained_var": 0.1735276997089386, "kl": 0.009059487510301724, "entropy": -0.09419901318227251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16512, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 16512, "num_agent_steps_trained": 16512}, "sampler_results": {"episode_reward_max": 328.9045981510659, "episode_reward_min": 98.66264338173818, "episode_reward_mean": 274.77807982431085, "episode_len_mean": 49.13333333333333, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1474, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [248.5303279163873, 266.1048304353641, 312.7856721391065, 297.11474753013295, 98.66264338173818, 273.72796071000215, 295.63051869935697, 253.57349766794147, 298.48729642611374, 217.4452297234595, 245.3531270996082, 294.69188717395235, 287.4283638322569, 250.61291686461334, 271.4236923928963, 285.9617002779057, 263.85597930958875, 301.483502673062, 272.09018193337096, 267.49056071736146, 270.73820976499564, 242.4408902077987, 328.9045981510659, 256.34807164824826, 292.0955979253228, 311.72151677940707, 317.06323440100954, 328.6079992542035, 309.18867558176265, 283.7789641112929], "episode_lengths": [50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.269106790390753, "mean_inference_ms": 1.2597691579015327, "mean_action_processing_ms": 0.20934584650896065, "mean_env_wait_ms": 533.4228739731566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012293656667073568, "StateBufferConnector_ms": 0.006179014841715495, "ViewRequirementAgentConnector_ms": 0.1700901985168457}, "num_episodes": 12, "episode_return_max": 328.9045981510659, "episode_return_min": 98.66264338173818, "episode_return_mean": 274.77807982431085}, "env_runner_results": {"episode_reward_max": 328.9045981510659, "episode_reward_min": 98.66264338173818, "episode_reward_mean": 274.77807982431085, "episode_len_mean": 49.13333333333333, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1474, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [248.5303279163873, 266.1048304353641, 312.7856721391065, 297.11474753013295, 98.66264338173818, 273.72796071000215, 295.63051869935697, 253.57349766794147, 298.48729642611374, 217.4452297234595, 245.3531270996082, 294.69188717395235, 287.4283638322569, 250.61291686461334, 271.4236923928963, 285.9617002779057, 263.85597930958875, 301.483502673062, 272.09018193337096, 267.49056071736146, 270.73820976499564, 242.4408902077987, 328.9045981510659, 256.34807164824826, 292.0955979253228, 311.72151677940707, 317.06323440100954, 328.6079992542035, 309.18867558176265, 283.7789641112929], "episode_lengths": [50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.269106790390753, "mean_inference_ms": 1.2597691579015327, "mean_action_processing_ms": 0.20934584650896065, "mean_env_wait_ms": 533.4228739731566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012293656667073568, "StateBufferConnector_ms": 0.006179014841715495, "ViewRequirementAgentConnector_ms": 0.1700901985168457}, "num_episodes": 12, "episode_return_max": 328.9045981510659, "episode_return_min": 98.66264338173818, "episode_return_mean": 274.77807982431085}, "episode_reward_max": 328.9045981510659, "episode_reward_min": 98.66264338173818, "episode_reward_mean": 274.77807982431085, "episode_len_mean": 49.13333333333333, "episodes_this_iter": 12, "episodes_timesteps_total": 1474, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [248.5303279163873, 266.1048304353641, 312.7856721391065, 297.11474753013295, 98.66264338173818, 273.72796071000215, 295.63051869935697, 253.57349766794147, 298.48729642611374, 217.4452297234595, 245.3531270996082, 294.69188717395235, 287.4283638322569, 250.61291686461334, 271.4236923928963, 285.9617002779057, 263.85597930958875, 301.483502673062, 272.09018193337096, 267.49056071736146, 270.73820976499564, 242.4408902077987, 328.9045981510659, 256.34807164824826, 292.0955979253228, 311.72151677940707, 317.06323440100954, 328.6079992542035, 309.18867558176265, 283.7789641112929], "episode_lengths": [50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.269106790390753, "mean_inference_ms": 1.2597691579015327, "mean_action_processing_ms": 0.20934584650896065, "mean_env_wait_ms": 533.4228739731566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012293656667073568, "StateBufferConnector_ms": 0.006179014841715495, "ViewRequirementAgentConnector_ms": 0.1700901985168457}, "num_episodes": 12, "episode_return_max": 328.9045981510659, "episode_return_min": 98.66264338173818, "episode_return_mean": 274.77807982431085, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16512, "num_agent_steps_trained": 16512, "num_env_steps_sampled": 16512, "num_env_steps_trained": 16512, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 11.145572319317404, "num_env_steps_trained_throughput_per_sec": 11.145572319317404, "timesteps_total": 16512, "num_env_steps_sampled_lifetime": 16512, "num_agent_steps_sampled_lifetime": 16512, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 16512, "timers": {"training_iteration_time_ms": 47556.552, "restore_workers_time_ms": 0.02, "training_step_time_ms": 47556.487, "sample_time_ms": 46878.669, "load_time_ms": 0.512, "load_throughput": 1008039.527, "learn_time_ms": 663.718, "learn_throughput": 777.439, "synch_weights_time_ms": 13.263}, "counters": {"num_env_steps_sampled": 16512, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 16512, "num_agent_steps_trained": 16512}, "done": false, "episodes_total": 602, "training_iteration": 32, "trial_id": "fe178_00003", "date": "2024-08-15_17-28-04", "timestamp": 1723764484, "time_this_iter_s": 46.29992938041687, "time_total_s": 1961.566611289978, "pid": 96536, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 142.67979097366333, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 28.67878787878788, "ram_util_percent": 11.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.53133739431699, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.833175420761108, "policy_loss": -0.01210649727533261, "vf_loss": 8.842003830273946, "vf_explained_var": 0.04394800265630086, "kl": 0.006556157528636979, "entropy": -0.11647079018875957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17028, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 17028, "num_agent_steps_trained": 17028}, "sampler_results": {"episode_reward_max": 317.7921860395282, "episode_reward_min": 93.45817290769114, "episode_reward_mean": 228.08512729091655, "episode_len_mean": 43.125, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 345, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [266.9343855237731, 276.35144159799364, 255.4703915991958, 113.86241455078118, 194.27734240460802, 317.7921860395282, 93.45817290769114, 306.53468370376135], "episode_lengths": [50, 50, 50, 23, 50, 50, 22, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.251009231326224, "mean_inference_ms": 1.2642018411351343, "mean_action_processing_ms": 0.21035815107411351, "mean_env_wait_ms": 472.0835764517729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00978708267211914, "StateBufferConnector_ms": 0.006043910980224609, "ViewRequirementAgentConnector_ms": 0.17216503620147705}, "num_episodes": 8, "episode_return_max": 317.7921860395282, "episode_return_min": 93.45817290769114, "episode_return_mean": 228.08512729091655}, "env_runner_results": {"episode_reward_max": 317.7921860395282, "episode_reward_min": 93.45817290769114, "episode_reward_mean": 228.08512729091655, "episode_len_mean": 43.125, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 345, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [266.9343855237731, 276.35144159799364, 255.4703915991958, 113.86241455078118, 194.27734240460802, 317.7921860395282, 93.45817290769114, 306.53468370376135], "episode_lengths": [50, 50, 50, 23, 50, 50, 22, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.251009231326224, "mean_inference_ms": 1.2642018411351343, "mean_action_processing_ms": 0.21035815107411351, "mean_env_wait_ms": 472.0835764517729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00978708267211914, "StateBufferConnector_ms": 0.006043910980224609, "ViewRequirementAgentConnector_ms": 0.17216503620147705}, "num_episodes": 8, "episode_return_max": 317.7921860395282, "episode_return_min": 93.45817290769114, "episode_return_mean": 228.08512729091655}, "episode_reward_max": 317.7921860395282, "episode_reward_min": 93.45817290769114, "episode_reward_mean": 228.08512729091655, "episode_len_mean": 43.125, "episodes_this_iter": 8, "episodes_timesteps_total": 345, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [266.9343855237731, 276.35144159799364, 255.4703915991958, 113.86241455078118, 194.27734240460802, 317.7921860395282, 93.45817290769114, 306.53468370376135], "episode_lengths": [50, 50, 50, 23, 50, 50, 22, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.251009231326224, "mean_inference_ms": 1.2642018411351343, "mean_action_processing_ms": 0.21035815107411351, "mean_env_wait_ms": 472.0835764517729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00978708267211914, "StateBufferConnector_ms": 0.006043910980224609, "ViewRequirementAgentConnector_ms": 0.17216503620147705}, "num_episodes": 8, "episode_return_max": 317.7921860395282, "episode_return_min": 93.45817290769114, "episode_return_mean": 228.08512729091655, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17028, "num_agent_steps_trained": 17028, "num_env_steps_sampled": 17028, "num_env_steps_trained": 17028, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 11.386322986365128, "num_env_steps_trained_throughput_per_sec": 11.386322986365128, "timesteps_total": 17028, "num_env_steps_sampled_lifetime": 17028, "num_agent_steps_sampled_lifetime": 17028, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 17028, "timers": {"training_iteration_time_ms": 45317.54, "restore_workers_time_ms": 0.02, "training_step_time_ms": 45317.475, "sample_time_ms": 44642.625, "load_time_ms": 0.808, "load_throughput": 638613.415, "learn_time_ms": 660.157, "learn_throughput": 781.632, "synch_weights_time_ms": 13.399}, "counters": {"num_env_steps_sampled": 17028, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 17028, "num_agent_steps_trained": 17028}, "done": false, "episodes_total": 610, "training_iteration": 33, "trial_id": "fe178_00003", "date": "2024-08-15_17-29-17", "timestamp": 1723764557, "time_this_iter_s": 45.3203661441803, "time_total_s": 2006.8869774341583, "pid": 19845, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 45.3203661441803, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 32.5, "ram_util_percent": 12.39846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.762741855780284, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.880980602900188, "policy_loss": -0.020941320057803144, "vf_loss": 8.897527555624643, "vf_explained_var": 0.053791015843550366, "kl": 0.008788874853054334, "entropy": -0.14343455427636703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17544, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 17544, "num_agent_steps_trained": 17544}, "sampler_results": {"episode_reward_max": 329.0981999393431, "episode_reward_min": 93.45817290769114, "episode_reward_mean": 266.21425639997983, "episode_len_mean": 47.10526315789474, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 895, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [266.9343855237731, 276.35144159799364, 255.4703915991958, 113.86241455078118, 194.27734240460802, 317.7921860395282, 93.45817290769114, 306.53468370376135, 320.5139188198017, 279.55258747960676, 329.0981999393431, 286.1285881762421, 293.44822134722943, 298.986371765766, 313.6731423894093, 298.69333808780596, 256.95626813864953, 250.36088160190178, 305.97833552653003], "episode_lengths": [50, 50, 50, 23, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.351190938956555, "mean_inference_ms": 1.2638921700887096, "mean_action_processing_ms": 0.21015749477594053, "mean_env_wait_ms": 493.40496817116974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011577104267321135, "StateBufferConnector_ms": 0.006152454175447163, "ViewRequirementAgentConnector_ms": 0.17241176805998149}, "num_episodes": 11, "episode_return_max": 329.0981999393431, "episode_return_min": 93.45817290769114, "episode_return_mean": 266.21425639997983}, "env_runner_results": {"episode_reward_max": 329.0981999393431, "episode_reward_min": 93.45817290769114, "episode_reward_mean": 266.21425639997983, "episode_len_mean": 47.10526315789474, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 895, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [266.9343855237731, 276.35144159799364, 255.4703915991958, 113.86241455078118, 194.27734240460802, 317.7921860395282, 93.45817290769114, 306.53468370376135, 320.5139188198017, 279.55258747960676, 329.0981999393431, 286.1285881762421, 293.44822134722943, 298.986371765766, 313.6731423894093, 298.69333808780596, 256.95626813864953, 250.36088160190178, 305.97833552653003], "episode_lengths": [50, 50, 50, 23, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.351190938956555, "mean_inference_ms": 1.2638921700887096, "mean_action_processing_ms": 0.21015749477594053, "mean_env_wait_ms": 493.40496817116974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011577104267321135, "StateBufferConnector_ms": 0.006152454175447163, "ViewRequirementAgentConnector_ms": 0.17241176805998149}, "num_episodes": 11, "episode_return_max": 329.0981999393431, "episode_return_min": 93.45817290769114, "episode_return_mean": 266.21425639997983}, "episode_reward_max": 329.0981999393431, "episode_reward_min": 93.45817290769114, "episode_reward_mean": 266.21425639997983, "episode_len_mean": 47.10526315789474, "episodes_this_iter": 11, "episodes_timesteps_total": 895, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [266.9343855237731, 276.35144159799364, 255.4703915991958, 113.86241455078118, 194.27734240460802, 317.7921860395282, 93.45817290769114, 306.53468370376135, 320.5139188198017, 279.55258747960676, 329.0981999393431, 286.1285881762421, 293.44822134722943, 298.986371765766, 313.6731423894093, 298.69333808780596, 256.95626813864953, 250.36088160190178, 305.97833552653003], "episode_lengths": [50, 50, 50, 23, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.351190938956555, "mean_inference_ms": 1.2638921700887096, "mean_action_processing_ms": 0.21015749477594053, "mean_env_wait_ms": 493.40496817116974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011577104267321135, "StateBufferConnector_ms": 0.006152454175447163, "ViewRequirementAgentConnector_ms": 0.17241176805998149}, "num_episodes": 11, "episode_return_max": 329.0981999393431, "episode_return_min": 93.45817290769114, "episode_return_mean": 266.21425639997983, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17544, "num_agent_steps_trained": 17544, "num_env_steps_sampled": 17544, "num_env_steps_trained": 17544, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.096347072962502, "num_env_steps_trained_throughput_per_sec": 10.096347072962502, "timesteps_total": 17544, "num_env_steps_sampled_lifetime": 17544, "num_agent_steps_sampled_lifetime": 17544, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 17544, "timers": {"training_iteration_time_ms": 48212.573, "restore_workers_time_ms": 0.019, "training_step_time_ms": 48212.511, "sample_time_ms": 47544.99, "load_time_ms": 0.573, "load_throughput": 899900.567, "learn_time_ms": 653.331, "learn_throughput": 789.799, "synch_weights_time_ms": 13.248}, "counters": {"num_env_steps_sampled": 17544, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 17544, "num_agent_steps_trained": 17544}, "done": false, "episodes_total": 621, "training_iteration": 34, "trial_id": "fe178_00003", "date": "2024-08-15_17-30-08", "timestamp": 1723764608, "time_this_iter_s": 51.110875368118286, "time_total_s": 2057.9978528022766, "pid": 19845, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 96.43124151229858, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.971232876712335, "ram_util_percent": 12.49041095890411}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.097618762652079, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 9.06910920937856, "policy_loss": -0.015194448782131076, "vf_loss": 9.07943681081136, "vf_explained_var": 0.10256648808717728, "kl": 0.0097335861120276, "entropy": -0.20570122889863948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18060, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 18060, "num_agent_steps_trained": 18060}, "sampler_results": {"episode_reward_max": 330.3003804765031, "episode_reward_min": 93.45817290769114, "episode_reward_mean": 274.6073933512663, "episode_len_mean": 48.166666666666664, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1445, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [266.9343855237731, 276.35144159799364, 255.4703915991958, 113.86241455078118, 194.27734240460802, 317.7921860395282, 93.45817290769114, 306.53468370376135, 320.5139188198017, 279.55258747960676, 329.0981999393431, 286.1285881762421, 293.44822134722943, 298.986371765766, 313.6731423894093, 298.69333808780596, 256.95626813864953, 250.36088160190178, 305.97833552653003, 330.3003804765031, 280.70539904288523, 323.04481048902073, 298.71982712884346, 278.6491933648377, 287.80853662863717, 251.1320040852894, 289.18795480046987, 277.59208731061693, 301.21412906988354, 261.79660654138416], "episode_lengths": [50, 50, 50, 23, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.440584898206835, "mean_inference_ms": 1.264339930366138, "mean_action_processing_ms": 0.21026172587576994, "mean_env_wait_ms": 508.4471985487728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011896292368570963, "StateBufferConnector_ms": 0.0062465667724609375, "ViewRequirementAgentConnector_ms": 0.17417987187703451}, "num_episodes": 11, "episode_return_max": 330.3003804765031, "episode_return_min": 93.45817290769114, "episode_return_mean": 274.6073933512663}, "env_runner_results": {"episode_reward_max": 330.3003804765031, "episode_reward_min": 93.45817290769114, "episode_reward_mean": 274.6073933512663, "episode_len_mean": 48.166666666666664, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1445, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [266.9343855237731, 276.35144159799364, 255.4703915991958, 113.86241455078118, 194.27734240460802, 317.7921860395282, 93.45817290769114, 306.53468370376135, 320.5139188198017, 279.55258747960676, 329.0981999393431, 286.1285881762421, 293.44822134722943, 298.986371765766, 313.6731423894093, 298.69333808780596, 256.95626813864953, 250.36088160190178, 305.97833552653003, 330.3003804765031, 280.70539904288523, 323.04481048902073, 298.71982712884346, 278.6491933648377, 287.80853662863717, 251.1320040852894, 289.18795480046987, 277.59208731061693, 301.21412906988354, 261.79660654138416], "episode_lengths": [50, 50, 50, 23, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.440584898206835, "mean_inference_ms": 1.264339930366138, "mean_action_processing_ms": 0.21026172587576994, "mean_env_wait_ms": 508.4471985487728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011896292368570963, "StateBufferConnector_ms": 0.0062465667724609375, "ViewRequirementAgentConnector_ms": 0.17417987187703451}, "num_episodes": 11, "episode_return_max": 330.3003804765031, "episode_return_min": 93.45817290769114, "episode_return_mean": 274.6073933512663}, "episode_reward_max": 330.3003804765031, "episode_reward_min": 93.45817290769114, "episode_reward_mean": 274.6073933512663, "episode_len_mean": 48.166666666666664, "episodes_this_iter": 11, "episodes_timesteps_total": 1445, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [266.9343855237731, 276.35144159799364, 255.4703915991958, 113.86241455078118, 194.27734240460802, 317.7921860395282, 93.45817290769114, 306.53468370376135, 320.5139188198017, 279.55258747960676, 329.0981999393431, 286.1285881762421, 293.44822134722943, 298.986371765766, 313.6731423894093, 298.69333808780596, 256.95626813864953, 250.36088160190178, 305.97833552653003, 330.3003804765031, 280.70539904288523, 323.04481048902073, 298.71982712884346, 278.6491933648377, 287.80853662863717, 251.1320040852894, 289.18795480046987, 277.59208731061693, 301.21412906988354, 261.79660654138416], "episode_lengths": [50, 50, 50, 23, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.440584898206835, "mean_inference_ms": 1.264339930366138, "mean_action_processing_ms": 0.21026172587576994, "mean_env_wait_ms": 508.4471985487728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011896292368570963, "StateBufferConnector_ms": 0.0062465667724609375, "ViewRequirementAgentConnector_ms": 0.17417987187703451}, "num_episodes": 11, "episode_return_max": 330.3003804765031, "episode_return_min": 93.45817290769114, "episode_return_mean": 274.6073933512663, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18060, "num_agent_steps_trained": 18060, "num_env_steps_sampled": 18060, "num_env_steps_trained": 18060, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.17977377672902, "num_env_steps_trained_throughput_per_sec": 9.17977377672902, "timesteps_total": 18060, "num_env_steps_sampled_lifetime": 18060, "num_agent_steps_sampled_lifetime": 18060, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 18060, "timers": {"training_iteration_time_ms": 50878.565, "restore_workers_time_ms": 0.019, "training_step_time_ms": 50878.504, "sample_time_ms": 50221.808, "load_time_ms": 0.488, "load_throughput": 1058318.271, "learn_time_ms": 642.776, "learn_throughput": 802.768, "synch_weights_time_ms": 13.114}, "counters": {"num_env_steps_sampled": 18060, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 18060, "num_agent_steps_trained": 18060}, "done": false, "episodes_total": 632, "training_iteration": 35, "trial_id": "fe178_00003", "date": "2024-08-15_17-31-05", "timestamp": 1723764665, "time_this_iter_s": 56.21370887756348, "time_total_s": 2114.21156167984, "pid": 19845, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 152.64495038986206, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.337037037037035, "ram_util_percent": 12.43827160493827}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.65563393831253, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 9.0781054576238, "policy_loss": -0.009638020768761635, "vf_loss": 9.079509886105855, "vf_explained_var": 0.02792929659287135, "kl": 0.01646727462939778, "entropy": -0.25643265144899485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18576, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 18576, "num_agent_steps_trained": 18576}, "sampler_results": {"episode_reward_max": 328.9083101200313, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 263.12007934897844, "episode_len_mean": 45.857142857142854, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 321, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313], "episode_lengths": [21, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.740588966457322, "mean_inference_ms": 1.2745822004496756, "mean_action_processing_ms": 0.21115821374852475, "mean_env_wait_ms": 427.4371284960917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010258810860770089, "StateBufferConnector_ms": 0.006229536873953683, "ViewRequirementAgentConnector_ms": 0.17849717821393693}, "num_episodes": 7, "episode_return_max": 328.9083101200313, "episode_return_min": 102.7045936445259, "episode_return_mean": 263.12007934897844}, "env_runner_results": {"episode_reward_max": 328.9083101200313, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 263.12007934897844, "episode_len_mean": 45.857142857142854, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 321, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313], "episode_lengths": [21, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.740588966457322, "mean_inference_ms": 1.2745822004496756, "mean_action_processing_ms": 0.21115821374852475, "mean_env_wait_ms": 427.4371284960917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010258810860770089, "StateBufferConnector_ms": 0.006229536873953683, "ViewRequirementAgentConnector_ms": 0.17849717821393693}, "num_episodes": 7, "episode_return_max": 328.9083101200313, "episode_return_min": 102.7045936445259, "episode_return_mean": 263.12007934897844}, "episode_reward_max": 328.9083101200313, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 263.12007934897844, "episode_len_mean": 45.857142857142854, "episodes_this_iter": 7, "episodes_timesteps_total": 321, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313], "episode_lengths": [21, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.740588966457322, "mean_inference_ms": 1.2745822004496756, "mean_action_processing_ms": 0.21115821374852475, "mean_env_wait_ms": 427.4371284960917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010258810860770089, "StateBufferConnector_ms": 0.006229536873953683, "ViewRequirementAgentConnector_ms": 0.17849717821393693}, "num_episodes": 7, "episode_return_max": 328.9083101200313, "episode_return_min": 102.7045936445259, "episode_return_mean": 263.12007934897844, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18576, "num_agent_steps_trained": 18576, "num_env_steps_sampled": 18576, "num_env_steps_trained": 18576, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 11.694483136023974, "num_env_steps_trained_throughput_per_sec": 11.694483136023974, "timesteps_total": 18576, "num_env_steps_sampled_lifetime": 18576, "num_agent_steps_sampled_lifetime": 18576, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 18576, "timers": {"training_iteration_time_ms": 44123.385, "restore_workers_time_ms": 0.057, "training_step_time_ms": 44123.279, "sample_time_ms": 40571.967, "load_time_ms": 0.825, "load_throughput": 625147.563, "learn_time_ms": 3536.485, "learn_throughput": 145.908, "synch_weights_time_ms": 13.499}, "counters": {"num_env_steps_sampled": 18576, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 18576, "num_agent_steps_trained": 18576}, "done": false, "episodes_total": 639, "training_iteration": 36, "trial_id": "fe178_00003", "date": "2024-08-15_17-32-17", "timestamp": 1723764737, "time_this_iter_s": 44.12639927864075, "time_total_s": 2158.337960958481, "pid": 43296, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 44.12639927864075, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 34.8484375, "ram_util_percent": 11.884375000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.980099105834961, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.918041372299195, "policy_loss": -0.01789105621476968, "vf_loss": 8.932603152592977, "vf_explained_var": 0.09295517206192017, "kl": 0.006658613141433991, "entropy": -0.33759242373829085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19092, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 19092, "num_agent_steps_trained": 19092}, "sampler_results": {"episode_reward_max": 351.81629960602083, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 274.65269115077626, "episode_len_mean": 47.05, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 941, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.319376329545302, "mean_inference_ms": 1.270891001007342, "mean_action_processing_ms": 0.21072394364252886, "mean_env_wait_ms": 460.2690525961337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011878013610839844, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.17095685005187988}, "num_episodes": 13, "episode_return_max": 351.81629960602083, "episode_return_min": 102.7045936445259, "episode_return_mean": 274.65269115077626}, "env_runner_results": {"episode_reward_max": 351.81629960602083, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 274.65269115077626, "episode_len_mean": 47.05, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 941, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.319376329545302, "mean_inference_ms": 1.270891001007342, "mean_action_processing_ms": 0.21072394364252886, "mean_env_wait_ms": 460.2690525961337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011878013610839844, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.17095685005187988}, "num_episodes": 13, "episode_return_max": 351.81629960602083, "episode_return_min": 102.7045936445259, "episode_return_mean": 274.65269115077626}, "episode_reward_max": 351.81629960602083, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 274.65269115077626, "episode_len_mean": 47.05, "episodes_this_iter": 13, "episodes_timesteps_total": 941, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.319376329545302, "mean_inference_ms": 1.270891001007342, "mean_action_processing_ms": 0.21072394364252886, "mean_env_wait_ms": 460.2690525961337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011878013610839844, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.17095685005187988}, "num_episodes": 13, "episode_return_max": 351.81629960602083, "episode_return_min": 102.7045936445259, "episode_return_mean": 274.65269115077626, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19092, "num_agent_steps_trained": 19092, "num_env_steps_sampled": 19092, "num_env_steps_trained": 19092, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.31167759930085, "num_env_steps_trained_throughput_per_sec": 10.31167759930085, "timesteps_total": 19092, "num_env_steps_sampled_lifetime": 19092, "num_agent_steps_sampled_lifetime": 19092, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 19092, "timers": {"training_iteration_time_ms": 47081.875, "restore_workers_time_ms": 0.036, "training_step_time_ms": 47081.797, "sample_time_ms": 44960.462, "load_time_ms": 0.578, "load_throughput": 892110.826, "learn_time_ms": 2107.514, "learn_throughput": 244.838, "synch_weights_time_ms": 12.88}, "counters": {"num_env_steps_sampled": 19092, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 19092, "num_agent_steps_trained": 19092}, "done": false, "episodes_total": 652, "training_iteration": 37, "trial_id": "fe178_00003", "date": "2024-08-15_17-33-07", "timestamp": 1723764787, "time_this_iter_s": 50.04405164718628, "time_total_s": 2208.382012605667, "pid": 43296, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 94.17045092582703, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.33943661971831, "ram_util_percent": 11.540845070422531}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.794770753383636, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.851903557777405, "policy_loss": -0.0160536066784213, "vf_loss": 8.86373750368754, "vf_explained_var": 0.28094845165808996, "kl": 0.008439175583287896, "entropy": -0.32632086910307406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19608, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 19608, "num_agent_steps_trained": 19608}, "sampler_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 276.139199570218, "episode_len_mean": 47.13333333333333, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1414, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.398881258576655, "mean_inference_ms": 1.2668170101419076, "mean_action_processing_ms": 0.2101535394822917, "mean_env_wait_ms": 478.2654427809851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012055238087972006, "StateBufferConnector_ms": 0.005965232849121094, "ViewRequirementAgentConnector_ms": 0.171052614847819}, "num_episodes": 10, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 276.139199570218}, "env_runner_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 276.139199570218, "episode_len_mean": 47.13333333333333, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1414, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.398881258576655, "mean_inference_ms": 1.2668170101419076, "mean_action_processing_ms": 0.2101535394822917, "mean_env_wait_ms": 478.2654427809851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012055238087972006, "StateBufferConnector_ms": 0.005965232849121094, "ViewRequirementAgentConnector_ms": 0.171052614847819}, "num_episodes": 10, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 276.139199570218}, "episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 276.139199570218, "episode_len_mean": 47.13333333333333, "episodes_this_iter": 10, "episodes_timesteps_total": 1414, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.398881258576655, "mean_inference_ms": 1.2668170101419076, "mean_action_processing_ms": 0.2101535394822917, "mean_env_wait_ms": 478.2654427809851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012055238087972006, "StateBufferConnector_ms": 0.005965232849121094, "ViewRequirementAgentConnector_ms": 0.171052614847819}, "num_episodes": 10, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 276.139199570218, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19608, "num_agent_steps_trained": 19608, "num_env_steps_sampled": 19608, "num_env_steps_trained": 19608, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.297355489674768, "num_env_steps_trained_throughput_per_sec": 9.297355489674768, "timesteps_total": 19608, "num_env_steps_sampled_lifetime": 19608, "num_agent_steps_sampled_lifetime": 19608, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 19608, "timers": {"training_iteration_time_ms": 49887.804, "restore_workers_time_ms": 0.029, "training_step_time_ms": 49887.736, "sample_time_ms": 48245.465, "load_time_ms": 0.498, "load_throughput": 1036357.956, "learn_time_ms": 1628.223, "learn_throughput": 316.91, "synch_weights_time_ms": 13.221}, "counters": {"num_env_steps_sampled": 19608, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 19608, "num_agent_steps_trained": 19608}, "done": false, "episodes_total": 662, "training_iteration": 38, "trial_id": "fe178_00003", "date": "2024-08-15_17-34-03", "timestamp": 1723764843, "time_this_iter_s": 55.502819776535034, "time_total_s": 2263.884832382202, "pid": 43296, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 149.67327070236206, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.920253164556954, "ram_util_percent": 12.33291139240506}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.051043677330018, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.464067077636718, "policy_loss": -0.01746702870974938, "vf_loss": 8.477564485867818, "vf_explained_var": 0.2605480194091797, "kl": 0.007939258853487749, "entropy": -0.26581833985013265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20124, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 20124, "num_agent_steps_trained": 20124}, "sampler_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 276.9004648770699, "episode_len_mean": 47.794871794871796, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 1864, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.436593842553569, "mean_inference_ms": 1.2658771288005917, "mean_action_processing_ms": 0.20985954277562358, "mean_env_wait_ms": 492.24007974158053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012153234237279648, "StateBufferConnector_ms": 0.005935399960248898, "ViewRequirementAgentConnector_ms": 0.1714963179368239}, "num_episodes": 9, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 276.9004648770699}, "env_runner_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 276.9004648770699, "episode_len_mean": 47.794871794871796, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 1864, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.436593842553569, "mean_inference_ms": 1.2658771288005917, "mean_action_processing_ms": 0.20985954277562358, "mean_env_wait_ms": 492.24007974158053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012153234237279648, "StateBufferConnector_ms": 0.005935399960248898, "ViewRequirementAgentConnector_ms": 0.1714963179368239}, "num_episodes": 9, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 276.9004648770699}, "episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 276.9004648770699, "episode_len_mean": 47.794871794871796, "episodes_this_iter": 9, "episodes_timesteps_total": 1864, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.436593842553569, "mean_inference_ms": 1.2658771288005917, "mean_action_processing_ms": 0.20985954277562358, "mean_env_wait_ms": 492.24007974158053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012153234237279648, "StateBufferConnector_ms": 0.005935399960248898, "ViewRequirementAgentConnector_ms": 0.1714963179368239}, "num_episodes": 9, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 276.9004648770699, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20124, "num_agent_steps_trained": 20124, "num_env_steps_sampled": 20124, "num_env_steps_trained": 20124, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.911966882115498, "num_env_steps_trained_throughput_per_sec": 8.911966882115498, "timesteps_total": 20124, "num_env_steps_sampled_lifetime": 20124, "num_agent_steps_sampled_lifetime": 20124, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 20124, "timers": {"training_iteration_time_ms": 51890.776, "restore_workers_time_ms": 0.027, "training_step_time_ms": 51890.708, "sample_time_ms": 50500.208, "load_time_ms": 0.459, "load_throughput": 1122978.785, "learn_time_ms": 1376.394, "learn_throughput": 374.893, "synch_weights_time_ms": 13.327}, "counters": {"num_env_steps_sampled": 20124, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 20124, "num_agent_steps_trained": 20124}, "done": false, "episodes_total": 671, "training_iteration": 39, "trial_id": "fe178_00003", "date": "2024-08-15_17-35-01", "timestamp": 1723764901, "time_this_iter_s": 57.902984857559204, "time_total_s": 2321.7878172397614, "pid": 43296, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 207.57625555992126, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.771084337349397, "ram_util_percent": 12.421686746987955}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.002212462822596, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 9.10750679175059, "policy_loss": -0.01862763420213014, "vf_loss": 9.12243835926056, "vf_explained_var": 0.07535918454329173, "kl": 0.00739196287371353, "entropy": -0.424156404286623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20640, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 20640, "num_agent_steps_trained": 20640}, "sampler_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 284.11670665701587, "episode_len_mean": 48.31372549019608, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2464, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.482278170075463, "mean_inference_ms": 1.2637673074981042, "mean_action_processing_ms": 0.2095842292408531, "mean_env_wait_ms": 504.6670520473431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012085484523399203, "StateBufferConnector_ms": 0.005941297493728937, "ViewRequirementAgentConnector_ms": 0.17158283906824448}, "num_episodes": 12, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 284.11670665701587}, "env_runner_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 284.11670665701587, "episode_len_mean": 48.31372549019608, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2464, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.482278170075463, "mean_inference_ms": 1.2637673074981042, "mean_action_processing_ms": 0.2095842292408531, "mean_env_wait_ms": 504.6670520473431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012085484523399203, "StateBufferConnector_ms": 0.005941297493728937, "ViewRequirementAgentConnector_ms": 0.17158283906824448}, "num_episodes": 12, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 284.11670665701587}, "episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 284.11670665701587, "episode_len_mean": 48.31372549019608, "episodes_this_iter": 12, "episodes_timesteps_total": 2464, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.482278170075463, "mean_inference_ms": 1.2637673074981042, "mean_action_processing_ms": 0.2095842292408531, "mean_env_wait_ms": 504.6670520473431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012085484523399203, "StateBufferConnector_ms": 0.005941297493728937, "ViewRequirementAgentConnector_ms": 0.17158283906824448}, "num_episodes": 12, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 284.11670665701587, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20640, "num_agent_steps_trained": 20640, "num_env_steps_sampled": 20640, "num_env_steps_trained": 20640, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.68750685378997, "num_env_steps_trained_throughput_per_sec": 9.68750685378997, "timesteps_total": 20640, "num_env_steps_sampled_lifetime": 20640, "num_agent_steps_sampled_lifetime": 20640, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 20640, "timers": {"training_iteration_time_ms": 52165.519, "restore_workers_time_ms": 0.025, "training_step_time_ms": 52165.453, "sample_time_ms": 50910.247, "load_time_ms": 0.448, "load_throughput": 1152551.317, "learn_time_ms": 1241.056, "learn_throughput": 415.775, "synch_weights_time_ms": 13.387}, "counters": {"num_env_steps_sampled": 20640, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 20640, "num_agent_steps_trained": 20640}, "done": false, "episodes_total": 683, "training_iteration": 40, "trial_id": "fe178_00003", "date": "2024-08-15_17-35-54", "timestamp": 1723764954, "time_this_iter_s": 53.267945289611816, "time_total_s": 2375.055762529373, "pid": 43296, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 260.8442008495331, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 28.58026315789474, "ram_util_percent": 12.006578947368423}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.991899746656419, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 9.349866008758545, "policy_loss": -0.02314723711460829, "vf_loss": 9.368875416119893, "vf_explained_var": 0.0949600617090861, "kl": 0.008275905422551067, "entropy": -0.4616832988957564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 21156, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 21156, "num_agent_steps_trained": 21156}, "sampler_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 286.6519567630843, "episode_len_mean": 48.56666666666667, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 2914, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764, 294.96589714483343, 283.0247685692474, 319.37419408903355, 304.2149528309589, 270.9834495178906, 298.5470163154558, 303.87054831748884, 322.1173304140643, 312.06720907827736], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.493567897964491, "mean_inference_ms": 1.2623805772541814, "mean_action_processing_ms": 0.20955993356326452, "mean_env_wait_ms": 512.0378186878022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012217362721761068, "StateBufferConnector_ms": 0.0059664249420166016, "ViewRequirementAgentConnector_ms": 0.17174641291300455}, "num_episodes": 9, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 286.6519567630843}, "env_runner_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 286.6519567630843, "episode_len_mean": 48.56666666666667, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 2914, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764, 294.96589714483343, 283.0247685692474, 319.37419408903355, 304.2149528309589, 270.9834495178906, 298.5470163154558, 303.87054831748884, 322.1173304140643, 312.06720907827736], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.493567897964491, "mean_inference_ms": 1.2623805772541814, "mean_action_processing_ms": 0.20955993356326452, "mean_env_wait_ms": 512.0378186878022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012217362721761068, "StateBufferConnector_ms": 0.0059664249420166016, "ViewRequirementAgentConnector_ms": 0.17174641291300455}, "num_episodes": 9, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 286.6519567630843}, "episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 286.6519567630843, "episode_len_mean": 48.56666666666667, "episodes_this_iter": 9, "episodes_timesteps_total": 2914, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764, 294.96589714483343, 283.0247685692474, 319.37419408903355, 304.2149528309589, 270.9834495178906, 298.5470163154558, 303.87054831748884, 322.1173304140643, 312.06720907827736], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.493567897964491, "mean_inference_ms": 1.2623805772541814, "mean_action_processing_ms": 0.20955993356326452, "mean_env_wait_ms": 512.0378186878022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012217362721761068, "StateBufferConnector_ms": 0.0059664249420166016, "ViewRequirementAgentConnector_ms": 0.17174641291300455}, "num_episodes": 9, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 286.6519567630843, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21156, "num_agent_steps_trained": 21156, "num_env_steps_sampled": 21156, "num_env_steps_trained": 21156, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.14352924523873, "num_env_steps_trained_throughput_per_sec": 9.14352924523873, "timesteps_total": 21156, "num_env_steps_sampled_lifetime": 21156, "num_agent_steps_sampled_lifetime": 21156, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 21156, "timers": {"training_iteration_time_ms": 52876.827, "restore_workers_time_ms": 0.025, "training_step_time_ms": 52876.762, "sample_time_ms": 51717.003, "load_time_ms": 0.431, "load_throughput": 1196715.988, "learn_time_ms": 1145.654, "learn_throughput": 450.398, "synch_weights_time_ms": 13.367}, "counters": {"num_env_steps_sampled": 21156, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 21156, "num_agent_steps_trained": 21156}, "done": false, "episodes_total": 692, "training_iteration": 41, "trial_id": "fe178_00003", "date": "2024-08-15_17-36-50", "timestamp": 1723765010, "time_this_iter_s": 56.43683910369873, "time_total_s": 2431.492601633072, "pid": 43296, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 317.2810399532318, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 27.7, "ram_util_percent": 12.192592592592595}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.69785783290863, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 9.120943315823872, "policy_loss": -0.008797302717963855, "vf_loss": 9.127233537038167, "vf_explained_var": 0.07259973784287771, "kl": 0.005014296770789868, "entropy": -0.4425192637989918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 21672, "num_env_steps_trained": 21672, "num_agent_steps_sampled": 21672, "num_agent_steps_trained": 21672}, "sampler_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 290.6527458837954, "episode_len_mean": 48.80555555555556, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3514, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764, 294.96589714483343, 283.0247685692474, 319.37419408903355, 304.2149528309589, 270.9834495178906, 298.5470163154558, 303.87054831748884, 322.1173304140643, 312.06720907827736, 327.24870995386595, 309.4484513394568, 353.65857650770164, 308.606029294676, 332.00117862030567, 320.04384865894616, 322.58233254764707, 305.4524692699272, 261.9129503651941, 301.1450622018393, 282.5595668624815, 303.22112222616363], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.521359267052225, "mean_inference_ms": 1.261586211104346, "mean_action_processing_ms": 0.20953190182370987, "mean_env_wait_ms": 520.0784782526882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011783175998263888, "StateBufferConnector_ms": 0.005933642387390137, "ViewRequirementAgentConnector_ms": 0.17229119936625162}, "num_episodes": 12, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 290.6527458837954}, "env_runner_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 290.6527458837954, "episode_len_mean": 48.80555555555556, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3514, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764, 294.96589714483343, 283.0247685692474, 319.37419408903355, 304.2149528309589, 270.9834495178906, 298.5470163154558, 303.87054831748884, 322.1173304140643, 312.06720907827736, 327.24870995386595, 309.4484513394568, 353.65857650770164, 308.606029294676, 332.00117862030567, 320.04384865894616, 322.58233254764707, 305.4524692699272, 261.9129503651941, 301.1450622018393, 282.5595668624815, 303.22112222616363], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.521359267052225, "mean_inference_ms": 1.261586211104346, "mean_action_processing_ms": 0.20953190182370987, "mean_env_wait_ms": 520.0784782526882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011783175998263888, "StateBufferConnector_ms": 0.005933642387390137, "ViewRequirementAgentConnector_ms": 0.17229119936625162}, "num_episodes": 12, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 290.6527458837954}, "episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 290.6527458837954, "episode_len_mean": 48.80555555555556, "episodes_this_iter": 12, "episodes_timesteps_total": 3514, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764, 294.96589714483343, 283.0247685692474, 319.37419408903355, 304.2149528309589, 270.9834495178906, 298.5470163154558, 303.87054831748884, 322.1173304140643, 312.06720907827736, 327.24870995386595, 309.4484513394568, 353.65857650770164, 308.606029294676, 332.00117862030567, 320.04384865894616, 322.58233254764707, 305.4524692699272, 261.9129503651941, 301.1450622018393, 282.5595668624815, 303.22112222616363], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.521359267052225, "mean_inference_ms": 1.261586211104346, "mean_action_processing_ms": 0.20953190182370987, "mean_env_wait_ms": 520.0784782526882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011783175998263888, "StateBufferConnector_ms": 0.005933642387390137, "ViewRequirementAgentConnector_ms": 0.17229119936625162}, "num_episodes": 12, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 290.6527458837954, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21672, "num_agent_steps_trained": 21672, "num_env_steps_sampled": 21672, "num_env_steps_trained": 21672, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.206262566692693, "num_env_steps_trained_throughput_per_sec": 9.206262566692693, "timesteps_total": 21672, "num_env_steps_sampled_lifetime": 21672, "num_agent_steps_sampled_lifetime": 21672, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 21672, "timers": {"training_iteration_time_ms": 53329.968, "restore_workers_time_ms": 0.024, "training_step_time_ms": 53329.905, "sample_time_ms": 52236.645, "load_time_ms": 0.418, "load_throughput": 1233297.464, "learn_time_ms": 1079.157, "learn_throughput": 478.151, "synch_weights_time_ms": 13.383}, "counters": {"num_env_steps_sampled": 21672, "num_env_steps_trained": 21672, "num_agent_steps_sampled": 21672, "num_agent_steps_trained": 21672}, "done": false, "episodes_total": 704, "training_iteration": 42, "trial_id": "fe178_00003", "date": "2024-08-15_17-37-46", "timestamp": 1723765066, "time_this_iter_s": 56.052294969558716, "time_total_s": 2487.5448966026306, "pid": 43296, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 373.3333349227905, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.847499999999997, "ram_util_percent": 12.49125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.286860124270122, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.92998362382253, "policy_loss": -0.023107098244751493, "vf_loss": 8.947288091977438, "vf_explained_var": 0.01823490212361018, "kl": 0.011605176015536721, "entropy": -0.560754930973053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22188, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 22188, "num_agent_steps_trained": 22188}, "sampler_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 292.9148971573913, "episode_len_mean": 48.93827160493827, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 3964, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764, 294.96589714483343, 283.0247685692474, 319.37419408903355, 304.2149528309589, 270.9834495178906, 298.5470163154558, 303.87054831748884, 322.1173304140643, 312.06720907827736, 327.24870995386595, 309.4484513394568, 353.65857650770164, 308.606029294676, 332.00117862030567, 320.04384865894616, 322.58233254764707, 305.4524692699272, 261.9129503651941, 301.1450622018393, 282.5595668624815, 303.22112222616363, 309.8433674766343, 299.81202612379025, 326.93135152740956, 280.55453351387564, 310.83826652661617, 328.6299027111979, 323.4849637199231, 322.2145902379817, 296.7999642780022], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5353707869061175, "mean_inference_ms": 1.2612667935034594, "mean_action_processing_ms": 0.20944889212499904, "mean_env_wait_ms": 524.6001469929897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011532100630395207, "StateBufferConnector_ms": 0.005925143206561053, "ViewRequirementAgentConnector_ms": 0.17204078627221378}, "num_episodes": 9, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 292.9148971573913}, "env_runner_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 292.9148971573913, "episode_len_mean": 48.93827160493827, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 3964, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764, 294.96589714483343, 283.0247685692474, 319.37419408903355, 304.2149528309589, 270.9834495178906, 298.5470163154558, 303.87054831748884, 322.1173304140643, 312.06720907827736, 327.24870995386595, 309.4484513394568, 353.65857650770164, 308.606029294676, 332.00117862030567, 320.04384865894616, 322.58233254764707, 305.4524692699272, 261.9129503651941, 301.1450622018393, 282.5595668624815, 303.22112222616363, 309.8433674766343, 299.81202612379025, 326.93135152740956, 280.55453351387564, 310.83826652661617, 328.6299027111979, 323.4849637199231, 322.2145902379817, 296.7999642780022], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5353707869061175, "mean_inference_ms": 1.2612667935034594, "mean_action_processing_ms": 0.20944889212499904, "mean_env_wait_ms": 524.6001469929897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011532100630395207, "StateBufferConnector_ms": 0.005925143206561053, "ViewRequirementAgentConnector_ms": 0.17204078627221378}, "num_episodes": 9, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 292.9148971573913}, "episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 292.9148971573913, "episode_len_mean": 48.93827160493827, "episodes_this_iter": 9, "episodes_timesteps_total": 3964, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764, 294.96589714483343, 283.0247685692474, 319.37419408903355, 304.2149528309589, 270.9834495178906, 298.5470163154558, 303.87054831748884, 322.1173304140643, 312.06720907827736, 327.24870995386595, 309.4484513394568, 353.65857650770164, 308.606029294676, 332.00117862030567, 320.04384865894616, 322.58233254764707, 305.4524692699272, 261.9129503651941, 301.1450622018393, 282.5595668624815, 303.22112222616363, 309.8433674766343, 299.81202612379025, 326.93135152740956, 280.55453351387564, 310.83826652661617, 328.6299027111979, 323.4849637199231, 322.2145902379817, 296.7999642780022], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5353707869061175, "mean_inference_ms": 1.2612667935034594, "mean_action_processing_ms": 0.20944889212499904, "mean_env_wait_ms": 524.6001469929897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011532100630395207, "StateBufferConnector_ms": 0.005925143206561053, "ViewRequirementAgentConnector_ms": 0.17204078627221378}, "num_episodes": 9, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 292.9148971573913, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22188, "num_agent_steps_trained": 22188, "num_env_steps_sampled": 22188, "num_env_steps_trained": 22188, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.703062814181736, "num_env_steps_trained_throughput_per_sec": 9.703062814181736, "timesteps_total": 22188, "num_env_steps_sampled_lifetime": 22188, "num_agent_steps_sampled_lifetime": 22188, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 22188, "timers": {"training_iteration_time_ms": 53311.11, "restore_workers_time_ms": 0.023, "training_step_time_ms": 53311.047, "sample_time_ms": 52270.573, "load_time_ms": 0.411, "load_throughput": 1256282.609, "learn_time_ms": 1026.426, "learn_throughput": 502.715, "synch_weights_time_ms": 13.343}, "counters": {"num_env_steps_sampled": 22188, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 22188, "num_agent_steps_trained": 22188}, "done": false, "episodes_total": 713, "training_iteration": 43, "trial_id": "fe178_00003", "date": "2024-08-15_17-38-40", "timestamp": 1723765120, "time_this_iter_s": 53.18284845352173, "time_total_s": 2540.7277450561523, "pid": 43296, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 426.51618337631226, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.117105263157896, "ram_util_percent": 12.582894736842107}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.290841130415597, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.926687359809875, "policy_loss": -0.013542860466986894, "vf_loss": 8.932735558350881, "vf_explained_var": 0.04661858975887299, "kl": 0.014989279228031322, "entropy": -0.4865349816779296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22704, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 22704, "num_agent_steps_trained": 22704}, "sampler_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 294.30788131630044, "episode_len_mean": 49.075268817204304, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4564, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764, 294.96589714483343, 283.0247685692474, 319.37419408903355, 304.2149528309589, 270.9834495178906, 298.5470163154558, 303.87054831748884, 322.1173304140643, 312.06720907827736, 327.24870995386595, 309.4484513394568, 353.65857650770164, 308.606029294676, 332.00117862030567, 320.04384865894616, 322.58233254764707, 305.4524692699272, 261.9129503651941, 301.1450622018393, 282.5595668624815, 303.22112222616363, 309.8433674766343, 299.81202612379025, 326.93135152740956, 280.55453351387564, 310.83826652661617, 328.6299027111979, 323.4849637199231, 322.2145902379817, 296.7999642780022, 274.5735848020732, 305.87379065099253, 333.3156037554355, 313.9490460521752, 330.36556585596395, 257.7260948399275, 316.1975324819885, 291.9078103423762, 304.3292678148256, 309.6074625741386, 279.2244681530626, 327.45606534428845], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.552952555759287, "mean_inference_ms": 1.260620722584991, "mean_action_processing_ms": 0.209411146627961, "mean_env_wait_ms": 529.742850163847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011276942427440356, "StateBufferConnector_ms": 0.005888169811617943, "ViewRequirementAgentConnector_ms": 0.172055664882865}, "num_episodes": 12, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 294.30788131630044}, "env_runner_results": {"episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 294.30788131630044, "episode_len_mean": 49.075268817204304, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4564, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764, 294.96589714483343, 283.0247685692474, 319.37419408903355, 304.2149528309589, 270.9834495178906, 298.5470163154558, 303.87054831748884, 322.1173304140643, 312.06720907827736, 327.24870995386595, 309.4484513394568, 353.65857650770164, 308.606029294676, 332.00117862030567, 320.04384865894616, 322.58233254764707, 305.4524692699272, 261.9129503651941, 301.1450622018393, 282.5595668624815, 303.22112222616363, 309.8433674766343, 299.81202612379025, 326.93135152740956, 280.55453351387564, 310.83826652661617, 328.6299027111979, 323.4849637199231, 322.2145902379817, 296.7999642780022, 274.5735848020732, 305.87379065099253, 333.3156037554355, 313.9490460521752, 330.36556585596395, 257.7260948399275, 316.1975324819885, 291.9078103423762, 304.3292678148256, 309.6074625741386, 279.2244681530626, 327.45606534428845], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.552952555759287, "mean_inference_ms": 1.260620722584991, "mean_action_processing_ms": 0.209411146627961, "mean_env_wait_ms": 529.742850163847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011276942427440356, "StateBufferConnector_ms": 0.005888169811617943, "ViewRequirementAgentConnector_ms": 0.172055664882865}, "num_episodes": 12, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 294.30788131630044}, "episode_reward_max": 353.94419915914546, "episode_reward_min": 102.7045936445259, "episode_reward_mean": 294.30788131630044, "episode_len_mean": 49.075268817204304, "episodes_this_iter": 12, "episodes_timesteps_total": 4564, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [102.7045936445259, 306.58784328440674, 260.5409027103345, 259.83581068213687, 284.7709405360007, 298.49215446541285, 328.9083101200313, 351.81629960602083, 316.99819447338723, 304.53962997430756, 296.6096661742541, 249.73757259666223, 243.2992007893634, 310.19790904980607, 218.020650518796, 305.5979992552199, 316.4274855268862, 338.64334149544743, 104.04766307616335, 295.2776550363623, 269.8084296933604, 114.59801332442697, 313.26838574413097, 288.1271465229585, 353.94419915914546, 281.4971447942667, 277.36555092272926, 315.628976982952, 283.7793274224195, 293.10498952462467, 294.8799046075234, 234.49887876815836, 276.6145590624394, 301.3364096628619, 275.44976220257405, 322.08406534471004, 248.78700343829422, 298.2669103617772, 263.0246496508488, 308.1227385493456, 254.2059059605944, 334.5292672627619, 302.0855579044033, 276.62984375079037, 335.72208818082174, 299.8509491418452, 275.9550348031644, 338.8462056794042, 341.2272426668376, 309.7512326530557, 313.90784274905764, 294.96589714483343, 283.0247685692474, 319.37419408903355, 304.2149528309589, 270.9834495178906, 298.5470163154558, 303.87054831748884, 322.1173304140643, 312.06720907827736, 327.24870995386595, 309.4484513394568, 353.65857650770164, 308.606029294676, 332.00117862030567, 320.04384865894616, 322.58233254764707, 305.4524692699272, 261.9129503651941, 301.1450622018393, 282.5595668624815, 303.22112222616363, 309.8433674766343, 299.81202612379025, 326.93135152740956, 280.55453351387564, 310.83826652661617, 328.6299027111979, 323.4849637199231, 322.2145902379817, 296.7999642780022, 274.5735848020732, 305.87379065099253, 333.3156037554355, 313.9490460521752, 330.36556585596395, 257.7260948399275, 316.1975324819885, 291.9078103423762, 304.3292678148256, 309.6074625741386, 279.2244681530626, 327.45606534428845], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.552952555759287, "mean_inference_ms": 1.260620722584991, "mean_action_processing_ms": 0.209411146627961, "mean_env_wait_ms": 529.742850163847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011276942427440356, "StateBufferConnector_ms": 0.005888169811617943, "ViewRequirementAgentConnector_ms": 0.172055664882865}, "num_episodes": 12, "episode_return_max": 353.94419915914546, "episode_return_min": 102.7045936445259, "episode_return_mean": 294.30788131630044, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22704, "num_agent_steps_trained": 22704, "num_env_steps_sampled": 22704, "num_env_steps_trained": 22704, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.137871569040946, "num_env_steps_trained_throughput_per_sec": 9.137871569040946, "timesteps_total": 22704, "num_env_steps_sampled_lifetime": 22704, "num_agent_steps_sampled_lifetime": 22704, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 22704, "timers": {"training_iteration_time_ms": 53661.91, "restore_workers_time_ms": 0.023, "training_step_time_ms": 53661.848, "sample_time_ms": 52658.466, "load_time_ms": 0.406, "load_throughput": 1270934.867, "learn_time_ms": 989.343, "learn_throughput": 521.558, "synch_weights_time_ms": 13.342}, "counters": {"num_env_steps_sampled": 22704, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 22704, "num_agent_steps_trained": 22704}, "done": false, "episodes_total": 725, "training_iteration": 44, "trial_id": "fe178_00003", "date": "2024-08-15_17-39-36", "timestamp": 1723765176, "time_this_iter_s": 56.47163915634155, "time_total_s": 2597.199384212494, "pid": 43296, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 482.9878225326538, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.27, "ram_util_percent": 12.179999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.8081028342247, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 9.131000169118245, "policy_loss": 0.0011583982734009624, "vf_loss": 9.104236765702565, "vf_explained_var": 0.028175340592861177, "kl": 0.051210135686873305, "entropy": -0.5226972965989262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220}, "sampler_results": {"episode_reward_max": 337.925757989091, "episode_reward_min": 127.47371826171877, "episode_reward_mean": 285.54548261051804, "episode_len_mean": 46.42857142857143, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 325, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.67091902600595, 320.5347007606797, 326.1539302706631, 127.47371826171877, 321.40717807666294, 337.925757989091, 284.652173888805], "episode_lengths": [50, 50, 50, 25, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.830414829974496, "mean_inference_ms": 1.275817748948271, "mean_action_processing_ms": 0.21048210720319074, "mean_env_wait_ms": 550.0207448436316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009642328534807478, "StateBufferConnector_ms": 0.006147793361118862, "ViewRequirementAgentConnector_ms": 0.1689502171107701}, "num_episodes": 7, "episode_return_max": 337.925757989091, "episode_return_min": 127.47371826171877, "episode_return_mean": 285.54548261051804}, "env_runner_results": {"episode_reward_max": 337.925757989091, "episode_reward_min": 127.47371826171877, "episode_reward_mean": 285.54548261051804, "episode_len_mean": 46.42857142857143, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 325, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.67091902600595, 320.5347007606797, 326.1539302706631, 127.47371826171877, 321.40717807666294, 337.925757989091, 284.652173888805], "episode_lengths": [50, 50, 50, 25, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.830414829974496, "mean_inference_ms": 1.275817748948271, "mean_action_processing_ms": 0.21048210720319074, "mean_env_wait_ms": 550.0207448436316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009642328534807478, "StateBufferConnector_ms": 0.006147793361118862, "ViewRequirementAgentConnector_ms": 0.1689502171107701}, "num_episodes": 7, "episode_return_max": 337.925757989091, "episode_return_min": 127.47371826171877, "episode_return_mean": 285.54548261051804}, "episode_reward_max": 337.925757989091, "episode_reward_min": 127.47371826171877, "episode_reward_mean": 285.54548261051804, "episode_len_mean": 46.42857142857143, "episodes_this_iter": 7, "episodes_timesteps_total": 325, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [280.67091902600595, 320.5347007606797, 326.1539302706631, 127.47371826171877, 321.40717807666294, 337.925757989091, 284.652173888805], "episode_lengths": [50, 50, 50, 25, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.830414829974496, "mean_inference_ms": 1.275817748948271, "mean_action_processing_ms": 0.21048210720319074, "mean_env_wait_ms": 550.0207448436316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009642328534807478, "StateBufferConnector_ms": 0.006147793361118862, "ViewRequirementAgentConnector_ms": 0.1689502171107701}, "num_episodes": 7, "episode_return_max": 337.925757989091, "episode_return_min": 127.47371826171877, "episode_return_mean": 285.54548261051804, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220, "num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.48328078057133, "num_env_steps_trained_throughput_per_sec": 9.48328078057133, "timesteps_total": 23220, "num_env_steps_sampled_lifetime": 23220, "num_agent_steps_sampled_lifetime": 23220, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 23220, "timers": {"training_iteration_time_ms": 54411.564, "restore_workers_time_ms": 0.022, "training_step_time_ms": 54411.485, "sample_time_ms": 50827.434, "load_time_ms": 0.763, "load_throughput": 676120.232, "learn_time_ms": 3569.397, "learn_throughput": 144.562, "synch_weights_time_ms": 13.394}, "counters": {"num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220}, "done": false, "episodes_total": 732, "training_iteration": 45, "trial_id": "fe178_00003", "date": "2024-08-15_17-40-52", "timestamp": 1723765252, "time_this_iter_s": 54.41494345664978, "time_total_s": 2651.6143276691437, "pid": 8963, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 54.41494345664978, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.456410256410255, "ram_util_percent": 12.485897435897435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.142852616310119, "cur_kl_coeff": 0.75, "cur_lr": 1e-05, "total_loss": 8.543949071566264, "policy_loss": -0.006740102171897888, "vf_loss": 8.547961715857188, "vf_explained_var": 0.15941757361094158, "kl": 0.0036367421897031678, "entropy": -0.14726141163458425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23736, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 23736, "num_agent_steps_trained": 23736}, "sampler_results": {"episode_reward_max": 338.4383095847117, "episode_reward_min": 81.48408203125007, "episode_reward_mean": 262.3302601364804, "episode_len_mean": 44.7, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 894, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.67091902600595, 320.5347007606797, 326.1539302706631, 127.47371826171877, 321.40717807666294, 337.925757989091, 284.652173888805, 275.87613369812357, 178.21637220376158, 332.7281481069701, 118.86196196701962, 301.19846136927447, 338.4383095847117, 81.48408203125007, 335.5528236691063, 239.22308772161676, 212.60086676924107, 217.30236594559153, 303.3128642854746, 312.99134710384027], "episode_lengths": [50, 50, 50, 25, 50, 50, 50, 50, 41, 50, 22, 50, 50, 17, 50, 50, 39, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3885315472196895, "mean_inference_ms": 1.279636327075559, "mean_action_processing_ms": 0.21069485454826714, "mean_env_wait_ms": 521.089367682447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011745691299438477, "StateBufferConnector_ms": 0.006498098373413086, "ViewRequirementAgentConnector_ms": 0.17539381980895996}, "num_episodes": 13, "episode_return_max": 338.4383095847117, "episode_return_min": 81.48408203125007, "episode_return_mean": 262.3302601364804}, "env_runner_results": {"episode_reward_max": 338.4383095847117, "episode_reward_min": 81.48408203125007, "episode_reward_mean": 262.3302601364804, "episode_len_mean": 44.7, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 894, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.67091902600595, 320.5347007606797, 326.1539302706631, 127.47371826171877, 321.40717807666294, 337.925757989091, 284.652173888805, 275.87613369812357, 178.21637220376158, 332.7281481069701, 118.86196196701962, 301.19846136927447, 338.4383095847117, 81.48408203125007, 335.5528236691063, 239.22308772161676, 212.60086676924107, 217.30236594559153, 303.3128642854746, 312.99134710384027], "episode_lengths": [50, 50, 50, 25, 50, 50, 50, 50, 41, 50, 22, 50, 50, 17, 50, 50, 39, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3885315472196895, "mean_inference_ms": 1.279636327075559, "mean_action_processing_ms": 0.21069485454826714, "mean_env_wait_ms": 521.089367682447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011745691299438477, "StateBufferConnector_ms": 0.006498098373413086, "ViewRequirementAgentConnector_ms": 0.17539381980895996}, "num_episodes": 13, "episode_return_max": 338.4383095847117, "episode_return_min": 81.48408203125007, "episode_return_mean": 262.3302601364804}, "episode_reward_max": 338.4383095847117, "episode_reward_min": 81.48408203125007, "episode_reward_mean": 262.3302601364804, "episode_len_mean": 44.7, "episodes_this_iter": 13, "episodes_timesteps_total": 894, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [280.67091902600595, 320.5347007606797, 326.1539302706631, 127.47371826171877, 321.40717807666294, 337.925757989091, 284.652173888805, 275.87613369812357, 178.21637220376158, 332.7281481069701, 118.86196196701962, 301.19846136927447, 338.4383095847117, 81.48408203125007, 335.5528236691063, 239.22308772161676, 212.60086676924107, 217.30236594559153, 303.3128642854746, 312.99134710384027], "episode_lengths": [50, 50, 50, 25, 50, 50, 50, 50, 41, 50, 22, 50, 50, 17, 50, 50, 39, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3885315472196895, "mean_inference_ms": 1.279636327075559, "mean_action_processing_ms": 0.21069485454826714, "mean_env_wait_ms": 521.089367682447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011745691299438477, "StateBufferConnector_ms": 0.006498098373413086, "ViewRequirementAgentConnector_ms": 0.17539381980895996}, "num_episodes": 13, "episode_return_max": 338.4383095847117, "episode_return_min": 81.48408203125007, "episode_return_mean": 262.3302601364804, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23736, "num_agent_steps_trained": 23736, "num_env_steps_sampled": 23736, "num_env_steps_trained": 23736, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.867901881800012, "num_env_steps_trained_throughput_per_sec": 9.867901881800012, "timesteps_total": 23736, "num_env_steps_sampled_lifetime": 23736, "num_agent_steps_sampled_lifetime": 23736, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 23736, "timers": {"training_iteration_time_ms": 53351.165, "restore_workers_time_ms": 0.026, "training_step_time_ms": 53351.085, "sample_time_ms": 51212.535, "load_time_ms": 0.55, "load_throughput": 937721.345, "learn_time_ms": 2124.408, "learn_throughput": 242.891, "synch_weights_time_ms": 13.214}, "counters": {"num_env_steps_sampled": 23736, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 23736, "num_agent_steps_trained": 23736}, "done": false, "episodes_total": 745, "training_iteration": 46, "trial_id": "fe178_00003", "date": "2024-08-15_17-41-45", "timestamp": 1723765305, "time_this_iter_s": 52.29383301734924, "time_total_s": 2703.908160686493, "pid": 8963, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 106.70877647399902, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.905333333333335, "ram_util_percent": 12.582666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.345487300554911, "cur_kl_coeff": 0.375, "cur_lr": 1e-05, "total_loss": 9.022790892918904, "policy_loss": -0.008780663770933946, "vf_loss": 9.030588587125143, "vf_explained_var": 0.08990061978499095, "kl": 0.0026212944163959673, "entropy": -0.24610571833327413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24252, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 24252, "num_agent_steps_trained": 24252}, "sampler_results": {"episode_reward_max": 338.4383095847117, "episode_reward_min": 68.70753740807999, "episode_reward_mean": 249.1603333930786, "episode_len_mean": 43.03125, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1377, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.67091902600595, 320.5347007606797, 326.1539302706631, 127.47371826171877, 321.40717807666294, 337.925757989091, 284.652173888805, 275.87613369812357, 178.21637220376158, 332.7281481069701, 118.86196196701962, 301.19846136927447, 338.4383095847117, 81.48408203125007, 335.5528236691063, 239.22308772161676, 212.60086676924107, 217.30236594559153, 303.3128642854746, 312.99134710384027, 238.6042771080868, 280.22339855446035, 324.5375265998571, 256.6966010037345, 316.2012382759037, 305.0487977945584, 94.04236742855625, 295.20783002740296, 97.20506402610243, 68.70753740807999, 299.3058202979445, 150.74500732421893], "episode_lengths": [50, 50, 50, 25, 50, 50, 50, 50, 41, 50, 22, 50, 50, 17, 50, 50, 39, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 22, 14, 50, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5768100684105075, "mean_inference_ms": 1.2780549300605073, "mean_action_processing_ms": 0.2105743971591893, "mean_env_wait_ms": 518.9818551354203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011588633060455322, "StateBufferConnector_ms": 0.006355345249176025, "ViewRequirementAgentConnector_ms": 0.17226636409759521}, "num_episodes": 12, "episode_return_max": 338.4383095847117, "episode_return_min": 68.70753740807999, "episode_return_mean": 249.1603333930786}, "env_runner_results": {"episode_reward_max": 338.4383095847117, "episode_reward_min": 68.70753740807999, "episode_reward_mean": 249.1603333930786, "episode_len_mean": 43.03125, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1377, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.67091902600595, 320.5347007606797, 326.1539302706631, 127.47371826171877, 321.40717807666294, 337.925757989091, 284.652173888805, 275.87613369812357, 178.21637220376158, 332.7281481069701, 118.86196196701962, 301.19846136927447, 338.4383095847117, 81.48408203125007, 335.5528236691063, 239.22308772161676, 212.60086676924107, 217.30236594559153, 303.3128642854746, 312.99134710384027, 238.6042771080868, 280.22339855446035, 324.5375265998571, 256.6966010037345, 316.2012382759037, 305.0487977945584, 94.04236742855625, 295.20783002740296, 97.20506402610243, 68.70753740807999, 299.3058202979445, 150.74500732421893], "episode_lengths": [50, 50, 50, 25, 50, 50, 50, 50, 41, 50, 22, 50, 50, 17, 50, 50, 39, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 22, 14, 50, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5768100684105075, "mean_inference_ms": 1.2780549300605073, "mean_action_processing_ms": 0.2105743971591893, "mean_env_wait_ms": 518.9818551354203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011588633060455322, "StateBufferConnector_ms": 0.006355345249176025, "ViewRequirementAgentConnector_ms": 0.17226636409759521}, "num_episodes": 12, "episode_return_max": 338.4383095847117, "episode_return_min": 68.70753740807999, "episode_return_mean": 249.1603333930786}, "episode_reward_max": 338.4383095847117, "episode_reward_min": 68.70753740807999, "episode_reward_mean": 249.1603333930786, "episode_len_mean": 43.03125, "episodes_this_iter": 12, "episodes_timesteps_total": 1377, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [280.67091902600595, 320.5347007606797, 326.1539302706631, 127.47371826171877, 321.40717807666294, 337.925757989091, 284.652173888805, 275.87613369812357, 178.21637220376158, 332.7281481069701, 118.86196196701962, 301.19846136927447, 338.4383095847117, 81.48408203125007, 335.5528236691063, 239.22308772161676, 212.60086676924107, 217.30236594559153, 303.3128642854746, 312.99134710384027, 238.6042771080868, 280.22339855446035, 324.5375265998571, 256.6966010037345, 316.2012382759037, 305.0487977945584, 94.04236742855625, 295.20783002740296, 97.20506402610243, 68.70753740807999, 299.3058202979445, 150.74500732421893], "episode_lengths": [50, 50, 50, 25, 50, 50, 50, 50, 41, 50, 22, 50, 50, 17, 50, 50, 39, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 22, 14, 50, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5768100684105075, "mean_inference_ms": 1.2780549300605073, "mean_action_processing_ms": 0.2105743971591893, "mean_env_wait_ms": 518.9818551354203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011588633060455322, "StateBufferConnector_ms": 0.006355345249176025, "ViewRequirementAgentConnector_ms": 0.17226636409759521}, "num_episodes": 12, "episode_return_max": 338.4383095847117, "episode_return_min": 68.70753740807999, "episode_return_mean": 249.1603333930786, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24252, "num_agent_steps_trained": 24252, "num_env_steps_sampled": 24252, "num_env_steps_trained": 24252, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.77954772883576, "num_env_steps_trained_throughput_per_sec": 9.77954772883576, "timesteps_total": 24252, "num_env_steps_sampled_lifetime": 24252, "num_agent_steps_sampled_lifetime": 24252, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 24252, "timers": {"training_iteration_time_ms": 53155.172, "restore_workers_time_ms": 0.023, "training_step_time_ms": 53155.102, "sample_time_ms": 51509.628, "load_time_ms": 0.49, "load_throughput": 1053339.162, "learn_time_ms": 1631.52, "learn_throughput": 316.269, "synch_weights_time_ms": 13.129}, "counters": {"num_env_steps_sampled": 24252, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 24252, "num_agent_steps_trained": 24252}, "done": false, "episodes_total": 757, "training_iteration": 47, "trial_id": "fe178_00003", "date": "2024-08-15_17-42-37", "timestamp": 1723765357, "time_this_iter_s": 52.76641345024109, "time_total_s": 2756.674574136734, "pid": 8963, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.16000000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.76, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 159.4751899242401, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.095999999999997, "ram_util_percent": 12.386666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.8930397550265, "cur_kl_coeff": 0.375, "cur_lr": 1e-05, "total_loss": 9.195271094640097, "policy_loss": -0.013751215549806755, "vf_loss": 9.207602612177531, "vf_explained_var": 0.18172829697529475, "kl": 0.0037854693435633163, "entropy": -0.5715176189939181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220}, "sampler_results": {"episode_reward_max": 331.1563004505605, "episode_reward_min": 135.38154511915147, "episode_reward_mean": 281.660501631106, "episode_len_mean": 46.42857142857143, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 325, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.57324790102706, 330.4469985557704, 284.4439505575955, 331.1563004505605, 268.8747718672504, 135.38154511915147, 301.7466969663868], "episode_lengths": [50, 50, 50, 50, 50, 25, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.806245684819464, "mean_inference_ms": 1.2813080316302419, "mean_action_processing_ms": 0.21355962518400745, "mean_env_wait_ms": 537.8505067872296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010292870657784598, "StateBufferConnector_ms": 0.006338528224400112, "ViewRequirementAgentConnector_ms": 0.176412718636649}, "num_episodes": 7, "episode_return_max": 331.1563004505605, "episode_return_min": 135.38154511915147, "episode_return_mean": 281.660501631106}, "env_runner_results": {"episode_reward_max": 331.1563004505605, "episode_reward_min": 135.38154511915147, "episode_reward_mean": 281.660501631106, "episode_len_mean": 46.42857142857143, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 325, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.57324790102706, 330.4469985557704, 284.4439505575955, 331.1563004505605, 268.8747718672504, 135.38154511915147, 301.7466969663868], "episode_lengths": [50, 50, 50, 50, 50, 25, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.806245684819464, "mean_inference_ms": 1.2813080316302419, "mean_action_processing_ms": 0.21355962518400745, "mean_env_wait_ms": 537.8505067872296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010292870657784598, "StateBufferConnector_ms": 0.006338528224400112, "ViewRequirementAgentConnector_ms": 0.176412718636649}, "num_episodes": 7, "episode_return_max": 331.1563004505605, "episode_return_min": 135.38154511915147, "episode_return_mean": 281.660501631106}, "episode_reward_max": 331.1563004505605, "episode_reward_min": 135.38154511915147, "episode_reward_mean": 281.660501631106, "episode_len_mean": 46.42857142857143, "episodes_this_iter": 7, "episodes_timesteps_total": 325, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [319.57324790102706, 330.4469985557704, 284.4439505575955, 331.1563004505605, 268.8747718672504, 135.38154511915147, 301.7466969663868], "episode_lengths": [50, 50, 50, 50, 50, 25, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.806245684819464, "mean_inference_ms": 1.2813080316302419, "mean_action_processing_ms": 0.21355962518400745, "mean_env_wait_ms": 537.8505067872296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010292870657784598, "StateBufferConnector_ms": 0.006338528224400112, "ViewRequirementAgentConnector_ms": 0.176412718636649}, "num_episodes": 7, "episode_return_max": 331.1563004505605, "episode_return_min": 135.38154511915147, "episode_return_mean": 281.660501631106, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220, "num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.78495560127788, "num_env_steps_trained_throughput_per_sec": 9.78495560127788, "timesteps_total": 23220, "num_env_steps_sampled_lifetime": 23220, "num_agent_steps_sampled_lifetime": 23220, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 23220, "timers": {"training_iteration_time_ms": 52734.031, "restore_workers_time_ms": 0.021, "training_step_time_ms": 52733.966, "sample_time_ms": 49799.23, "load_time_ms": 0.73, "load_throughput": 706582.065, "learn_time_ms": 2920.43, "learn_throughput": 176.686, "synch_weights_time_ms": 13.113}, "counters": {"num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220}, "done": false, "episodes_total": 729, "training_iteration": 45, "trial_id": "fe178_00003", "date": "2024-08-15_17-43-49", "timestamp": 1723765429, "time_this_iter_s": 52.73677706718445, "time_total_s": 2641.9940593242645, "pid": 33472, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4135626526076102, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0943999999999998, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 52.73677706718445, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 31.26842105263158, "ram_util_percent": 12.00263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.570126410325368, "cur_kl_coeff": 0.1875, "cur_lr": 1e-05, "total_loss": 9.073636110623678, "policy_loss": -0.010363348620012402, "vf_loss": 9.083169762293497, "vf_explained_var": 0.007769104341665904, "kl": 0.004424620573992799, "entropy": -0.47895651472111544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23736, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 23736, "num_agent_steps_trained": 23736}, "sampler_results": {"episode_reward_max": 349.65088865517424, "episode_reward_min": 61.722127026461294, "episode_reward_mean": 287.9083893708486, "episode_len_mean": 46.94736842105263, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 892, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.57324790102706, 330.4469985557704, 284.4439505575955, 331.1563004505605, 268.8747718672504, 135.38154511915147, 301.7466969663868, 301.39179517458547, 300.0447533628888, 61.722127026461294, 341.25364235855966, 318.5989430125687, 287.24151663206834, 287.154863374461, 309.81423209353915, 306.4529804145589, 293.38929313922034, 341.92085138429564, 349.65088865517424], "episode_lengths": [50, 50, 50, 50, 50, 25, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.260765353886541, "mean_inference_ms": 1.2787117820388036, "mean_action_processing_ms": 0.21156496301471736, "mean_env_wait_ms": 559.3159764724669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011920928955078125, "StateBufferConnector_ms": 0.006245311937834087, "ViewRequirementAgentConnector_ms": 0.1729977758307206}, "num_episodes": 12, "episode_return_max": 349.65088865517424, "episode_return_min": 61.722127026461294, "episode_return_mean": 287.9083893708486}, "env_runner_results": {"episode_reward_max": 349.65088865517424, "episode_reward_min": 61.722127026461294, "episode_reward_mean": 287.9083893708486, "episode_len_mean": 46.94736842105263, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 892, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.57324790102706, 330.4469985557704, 284.4439505575955, 331.1563004505605, 268.8747718672504, 135.38154511915147, 301.7466969663868, 301.39179517458547, 300.0447533628888, 61.722127026461294, 341.25364235855966, 318.5989430125687, 287.24151663206834, 287.154863374461, 309.81423209353915, 306.4529804145589, 293.38929313922034, 341.92085138429564, 349.65088865517424], "episode_lengths": [50, 50, 50, 50, 50, 25, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.260765353886541, "mean_inference_ms": 1.2787117820388036, "mean_action_processing_ms": 0.21156496301471736, "mean_env_wait_ms": 559.3159764724669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011920928955078125, "StateBufferConnector_ms": 0.006245311937834087, "ViewRequirementAgentConnector_ms": 0.1729977758307206}, "num_episodes": 12, "episode_return_max": 349.65088865517424, "episode_return_min": 61.722127026461294, "episode_return_mean": 287.9083893708486}, "episode_reward_max": 349.65088865517424, "episode_reward_min": 61.722127026461294, "episode_reward_mean": 287.9083893708486, "episode_len_mean": 46.94736842105263, "episodes_this_iter": 12, "episodes_timesteps_total": 892, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [319.57324790102706, 330.4469985557704, 284.4439505575955, 331.1563004505605, 268.8747718672504, 135.38154511915147, 301.7466969663868, 301.39179517458547, 300.0447533628888, 61.722127026461294, 341.25364235855966, 318.5989430125687, 287.24151663206834, 287.154863374461, 309.81423209353915, 306.4529804145589, 293.38929313922034, 341.92085138429564, 349.65088865517424], "episode_lengths": [50, 50, 50, 50, 50, 25, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.260765353886541, "mean_inference_ms": 1.2787117820388036, "mean_action_processing_ms": 0.21156496301471736, "mean_env_wait_ms": 559.3159764724669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011920928955078125, "StateBufferConnector_ms": 0.006245311937834087, "ViewRequirementAgentConnector_ms": 0.1729977758307206}, "num_episodes": 12, "episode_return_max": 349.65088865517424, "episode_return_min": 61.722127026461294, "episode_return_mean": 287.9083893708486, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23736, "num_agent_steps_trained": 23736, "num_env_steps_sampled": 23736, "num_env_steps_trained": 23736, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.105826098548714, "num_env_steps_trained_throughput_per_sec": 9.105826098548714, "timesteps_total": 23736, "num_env_steps_sampled_lifetime": 23736, "num_agent_steps_sampled_lifetime": 23736, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 23736, "timers": {"training_iteration_time_ms": 54700.529, "restore_workers_time_ms": 0.02, "training_step_time_ms": 54700.47, "sample_time_ms": 52906.729, "load_time_ms": 0.536, "load_throughput": 963392.328, "learn_time_ms": 1779.981, "learn_throughput": 289.891, "synch_weights_time_ms": 12.88}, "counters": {"num_env_steps_sampled": 23736, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 23736, "num_agent_steps_trained": 23736}, "done": false, "episodes_total": 741, "training_iteration": 46, "trial_id": "fe178_00003", "date": "2024-08-15_17-44-45", "timestamp": 1723765485, "time_this_iter_s": 56.66985845565796, "time_total_s": 2698.6639177799225, "pid": 33472, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4135626526076102, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0943999999999998, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 109.40663552284241, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.846913580246913, "ram_util_percent": 12.490123456790124}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.585025258858998, "cur_kl_coeff": 0.09375, "cur_lr": 1e-05, "total_loss": 9.143567609786988, "policy_loss": -0.00908793630078435, "vf_loss": 9.151811035474141, "vf_explained_var": 0.03279983500639597, "kl": 0.009006877073263678, "entropy": -0.5359116084873676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24252, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 24252, "num_agent_steps_trained": 24252}, "sampler_results": {"episode_reward_max": 349.65088865517424, "episode_reward_min": 61.722127026461294, "episode_reward_mean": 287.61300087175727, "episode_len_mean": 47.1, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1413, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.57324790102706, 330.4469985557704, 284.4439505575955, 331.1563004505605, 268.8747718672504, 135.38154511915147, 301.7466969663868, 301.39179517458547, 300.0447533628888, 61.722127026461294, 341.25364235855966, 318.5989430125687, 287.24151663206834, 287.154863374461, 309.81423209353915, 306.4529804145589, 293.38929313922034, 341.92085138429564, 349.65088865517424, 263.58238438411905, 281.3196064540342, 112.21491888866501, 313.7274790656312, 307.2757497803199, 294.08364441489226, 312.41898298581617, 277.28348741931075, 337.3284204991488, 335.79165509286537, 323.1042991217907], "episode_lengths": [50, 50, 50, 50, 50, 25, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.378431247472949, "mean_inference_ms": 1.2738091771306357, "mean_action_processing_ms": 0.21069546308242645, "mean_env_wait_ms": 566.9095447520234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012118816375732422, "StateBufferConnector_ms": 0.006295045216878255, "ViewRequirementAgentConnector_ms": 0.17270326614379883}, "num_episodes": 11, "episode_return_max": 349.65088865517424, "episode_return_min": 61.722127026461294, "episode_return_mean": 287.61300087175727}, "env_runner_results": {"episode_reward_max": 349.65088865517424, "episode_reward_min": 61.722127026461294, "episode_reward_mean": 287.61300087175727, "episode_len_mean": 47.1, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1413, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.57324790102706, 330.4469985557704, 284.4439505575955, 331.1563004505605, 268.8747718672504, 135.38154511915147, 301.7466969663868, 301.39179517458547, 300.0447533628888, 61.722127026461294, 341.25364235855966, 318.5989430125687, 287.24151663206834, 287.154863374461, 309.81423209353915, 306.4529804145589, 293.38929313922034, 341.92085138429564, 349.65088865517424, 263.58238438411905, 281.3196064540342, 112.21491888866501, 313.7274790656312, 307.2757497803199, 294.08364441489226, 312.41898298581617, 277.28348741931075, 337.3284204991488, 335.79165509286537, 323.1042991217907], "episode_lengths": [50, 50, 50, 50, 50, 25, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.378431247472949, "mean_inference_ms": 1.2738091771306357, "mean_action_processing_ms": 0.21069546308242645, "mean_env_wait_ms": 566.9095447520234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012118816375732422, "StateBufferConnector_ms": 0.006295045216878255, "ViewRequirementAgentConnector_ms": 0.17270326614379883}, "num_episodes": 11, "episode_return_max": 349.65088865517424, "episode_return_min": 61.722127026461294, "episode_return_mean": 287.61300087175727}, "episode_reward_max": 349.65088865517424, "episode_reward_min": 61.722127026461294, "episode_reward_mean": 287.61300087175727, "episode_len_mean": 47.1, "episodes_this_iter": 11, "episodes_timesteps_total": 1413, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [319.57324790102706, 330.4469985557704, 284.4439505575955, 331.1563004505605, 268.8747718672504, 135.38154511915147, 301.7466969663868, 301.39179517458547, 300.0447533628888, 61.722127026461294, 341.25364235855966, 318.5989430125687, 287.24151663206834, 287.154863374461, 309.81423209353915, 306.4529804145589, 293.38929313922034, 341.92085138429564, 349.65088865517424, 263.58238438411905, 281.3196064540342, 112.21491888866501, 313.7274790656312, 307.2757497803199, 294.08364441489226, 312.41898298581617, 277.28348741931075, 337.3284204991488, 335.79165509286537, 323.1042991217907], "episode_lengths": [50, 50, 50, 50, 50, 25, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.378431247472949, "mean_inference_ms": 1.2738091771306357, "mean_action_processing_ms": 0.21069546308242645, "mean_env_wait_ms": 566.9095447520234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012118816375732422, "StateBufferConnector_ms": 0.006295045216878255, "ViewRequirementAgentConnector_ms": 0.17270326614379883}, "num_episodes": 11, "episode_return_max": 349.65088865517424, "episode_return_min": 61.722127026461294, "episode_return_mean": 287.61300087175727, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24252, "num_agent_steps_trained": 24252, "num_env_steps_sampled": 24252, "num_env_steps_trained": 24252, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.216873161207369, "num_env_steps_trained_throughput_per_sec": 9.216873161207369, "timesteps_total": 24252, "num_env_steps_sampled_lifetime": 24252, "num_agent_steps_sampled_lifetime": 24252, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 24252, "timers": {"training_iteration_time_ms": 55128.45, "restore_workers_time_ms": 0.018, "training_step_time_ms": 55128.393, "sample_time_ms": 53703.672, "load_time_ms": 0.473, "load_throughput": 1091407.395, "learn_time_ms": 1411.281, "learn_throughput": 365.625, "synch_weights_time_ms": 12.669}, "counters": {"num_env_steps_sampled": 24252, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 24252, "num_agent_steps_trained": 24252}, "done": false, "episodes_total": 752, "training_iteration": 47, "trial_id": "fe178_00003", "date": "2024-08-15_17-45-41", "timestamp": 1723765541, "time_this_iter_s": 55.98704791069031, "time_total_s": 2754.650965690613, "pid": 33472, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4135626526076102, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0943999999999998, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 165.39368343353271, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.66375, "ram_util_percent": 12.1725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.043348773320515, "cur_kl_coeff": 0.25, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.218384873867034, "policy_loss": -0.010114441891588891, "vf_loss": 9.222401295105616, "vf_explained_var": -0.08039421563347181, "kl": 0.024392262987629202, "entropy": -0.7014094017446041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 25794, "num_env_steps_trained": 25794, "num_agent_steps_sampled": 25794, "num_agent_steps_trained": 25794}, "sampler_results": {"episode_reward_max": 359.88222599292055, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 306.9306314928866, "episode_len_mean": 48.26315789473684, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 917, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.6424829595276, 306.8172901006111, 297.7175647236076, 338.4202332700031, 317.2894151399419, 92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315], "episode_lengths": [50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.441054282310981, "mean_inference_ms": 1.2657942211613367, "mean_action_processing_ms": 0.2096592285641842, "mean_env_wait_ms": 542.3536249590328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012259734304327714, "StateBufferConnector_ms": 0.005808629487690173, "ViewRequirementAgentConnector_ms": 0.16447368421052633}, "num_episodes": 19, "episode_return_max": 359.88222599292055, "episode_return_min": 92.89244610937851, "episode_return_mean": 306.9306314928866}, "env_runner_results": {"episode_reward_max": 359.88222599292055, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 306.9306314928866, "episode_len_mean": 48.26315789473684, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 917, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.6424829595276, 306.8172901006111, 297.7175647236076, 338.4202332700031, 317.2894151399419, 92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315], "episode_lengths": [50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.441054282310981, "mean_inference_ms": 1.2657942211613367, "mean_action_processing_ms": 0.2096592285641842, "mean_env_wait_ms": 542.3536249590328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012259734304327714, "StateBufferConnector_ms": 0.005808629487690173, "ViewRequirementAgentConnector_ms": 0.16447368421052633}, "num_episodes": 19, "episode_return_max": 359.88222599292055, "episode_return_min": 92.89244610937851, "episode_return_mean": 306.9306314928866}, "episode_reward_max": 359.88222599292055, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 306.9306314928866, "episode_len_mean": 48.26315789473684, "episodes_this_iter": 19, "episodes_timesteps_total": 917, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [267.6424829595276, 306.8172901006111, 297.7175647236076, 338.4202332700031, 317.2894151399419, 92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315], "episode_lengths": [50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.441054282310981, "mean_inference_ms": 1.2657942211613367, "mean_action_processing_ms": 0.2096592285641842, "mean_env_wait_ms": 542.3536249590328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012259734304327714, "StateBufferConnector_ms": 0.005808629487690173, "ViewRequirementAgentConnector_ms": 0.16447368421052633}, "num_episodes": 19, "episode_return_max": 359.88222599292055, "episode_return_min": 92.89244610937851, "episode_return_mean": 306.9306314928866, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25794, "num_agent_steps_trained": 25794, "num_env_steps_sampled": 25794, "num_env_steps_trained": 25794, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.778598491017314, "num_env_steps_trained_throughput_per_sec": 9.778598491017314, "timesteps_total": 25794, "num_env_steps_sampled_lifetime": 25794, "num_agent_steps_sampled_lifetime": 25794, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 25794, "timers": {"training_iteration_time_ms": 104923.023, "restore_workers_time_ms": 0.019, "training_step_time_ms": 104922.965, "sample_time_ms": 98461.728, "load_time_ms": 0.861, "load_throughput": 1192065.347, "learn_time_ms": 6446.652, "learn_throughput": 159.152, "synch_weights_time_ms": 13.151}, "counters": {"num_env_steps_sampled": 25794, "num_env_steps_trained": 25794, "num_agent_steps_sampled": 25794, "num_agent_steps_trained": 25794}, "done": false, "episodes_total": 810, "training_iteration": 49, "trial_id": "fe178_00003", "date": "2024-08-15_17-47-43", "timestamp": 1723765663, "time_this_iter_s": 104.9260663986206, "time_total_s": 2905.606391429901, "pid": 57094, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.38889123387447605, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.978620259509809, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 104.9260663986206, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.72733333333333, "ram_util_percent": 11.017333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.778110481301944, "cur_kl_coeff": 0.375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.109891386826833, "policy_loss": -0.001574597996659577, "vf_loss": 9.107387006282806, "vf_explained_var": -0.06945043727755547, "kl": 0.010877232450246093, "entropy": -0.6834678572913011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 26820, "num_env_steps_trained": 26820, "num_agent_steps_sampled": 26820, "num_agent_steps_trained": 26820}, "sampler_results": {"episode_reward_max": 360.8902063446212, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 311.87101916828857, "episode_len_mean": 48.26315789473684, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 1834, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.6424829595276, 306.8172901006111, 297.7175647236076, 338.4202332700031, 317.2894151399419, 92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315, 323.0757340901137, 352.21332258802033, 319.3747340873739, 147.29741470848435, 323.25066179317554, 318.2202750073487, 220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124], "episode_lengths": [50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.446244199288961, "mean_inference_ms": 1.2661732944379267, "mean_action_processing_ms": 0.20950455311675492, "mean_env_wait_ms": 524.5360830472767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01312306052760074, "StateBufferConnector_ms": 0.005866979297838713, "ViewRequirementAgentConnector_ms": 0.16532069758365028}, "num_episodes": 19, "episode_return_max": 360.8902063446212, "episode_return_min": 92.89244610937851, "episode_return_mean": 311.87101916828857}, "env_runner_results": {"episode_reward_max": 360.8902063446212, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 311.87101916828857, "episode_len_mean": 48.26315789473684, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 1834, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.6424829595276, 306.8172901006111, 297.7175647236076, 338.4202332700031, 317.2894151399419, 92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315, 323.0757340901137, 352.21332258802033, 319.3747340873739, 147.29741470848435, 323.25066179317554, 318.2202750073487, 220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124], "episode_lengths": [50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.446244199288961, "mean_inference_ms": 1.2661732944379267, "mean_action_processing_ms": 0.20950455311675492, "mean_env_wait_ms": 524.5360830472767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01312306052760074, "StateBufferConnector_ms": 0.005866979297838713, "ViewRequirementAgentConnector_ms": 0.16532069758365028}, "num_episodes": 19, "episode_return_max": 360.8902063446212, "episode_return_min": 92.89244610937851, "episode_return_mean": 311.87101916828857}, "episode_reward_max": 360.8902063446212, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 311.87101916828857, "episode_len_mean": 48.26315789473684, "episodes_this_iter": 19, "episodes_timesteps_total": 1834, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [267.6424829595276, 306.8172901006111, 297.7175647236076, 338.4202332700031, 317.2894151399419, 92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315, 323.0757340901137, 352.21332258802033, 319.3747340873739, 147.29741470848435, 323.25066179317554, 318.2202750073487, 220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124], "episode_lengths": [50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.446244199288961, "mean_inference_ms": 1.2661732944379267, "mean_action_processing_ms": 0.20950455311675492, "mean_env_wait_ms": 524.5360830472767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01312306052760074, "StateBufferConnector_ms": 0.005866979297838713, "ViewRequirementAgentConnector_ms": 0.16532069758365028}, "num_episodes": 19, "episode_return_max": 360.8902063446212, "episode_return_min": 92.89244610937851, "episode_return_mean": 311.87101916828857, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26820, "num_agent_steps_trained": 26820, "num_env_steps_sampled": 26820, "num_env_steps_trained": 26820, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.253256379384846, "num_env_steps_trained_throughput_per_sec": 11.253256379384846, "timesteps_total": 26820, "num_env_steps_sampled_lifetime": 26820, "num_agent_steps_sampled_lifetime": 26820, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 26820, "timers": {"training_iteration_time_ms": 98048.321, "restore_workers_time_ms": 0.018, "training_step_time_ms": 98048.267, "sample_time_ms": 94139.581, "load_time_ms": 0.618, "load_throughput": 1659605.054, "learn_time_ms": 3894.717, "learn_throughput": 263.434, "synch_weights_time_ms": 12.913}, "counters": {"num_env_steps_sampled": 26820, "num_env_steps_trained": 26820, "num_agent_steps_sampled": 26820, "num_agent_steps_trained": 26820}, "done": false, "episodes_total": 829, "training_iteration": 50, "trial_id": "fe178_00003", "date": "2024-08-15_17-49-14", "timestamp": 1723765754, "time_this_iter_s": 91.17671370506287, "time_total_s": 2996.783105134964, "pid": 57094, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.38889123387447605, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.978620259509809, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 196.10278010368347, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 27.776153846153846, "ram_util_percent": 11.43923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.7439728418986, "cur_kl_coeff": 0.375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.064965744813284, "policy_loss": -0.005824499375497301, "vf_loss": 9.068580202261607, "vf_explained_var": 0.03241685231526693, "kl": 0.005893251597688516, "entropy": -0.6773697131002943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 27846, "num_env_steps_trained": 27846, "num_agent_steps_sampled": 27846, "num_agent_steps_trained": 27846}, "sampler_results": {"episode_reward_max": 360.8902063446212, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 308.76532321821605, "episode_len_mean": 48.193548387096776, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 2988, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.6424829595276, 306.8172901006111, 297.7175647236076, 338.4202332700031, 317.2894151399419, 92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315, 323.0757340901137, 352.21332258802033, 319.3747340873739, 147.29741470848435, 323.25066179317554, 318.2202750073487, 220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124, 308.1635799013973, 343.91766058165695, 324.1740470591953, 309.62479091810644, 336.73573705090683, 326.1570243816386, 249.23298811082594, 306.85638869733464, 315.228807431455, 327.68945638958405, 310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386], "episode_lengths": [50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5597402078424585, "mean_inference_ms": 1.2641980364429808, "mean_action_processing_ms": 0.20937955105413522, "mean_env_wait_ms": 519.3188903746554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012556583650650517, "StateBufferConnector_ms": 0.005891246180380544, "ViewRequirementAgentConnector_ms": 0.1646876335144043}, "num_episodes": 24, "episode_return_max": 360.8902063446212, "episode_return_min": 92.89244610937851, "episode_return_mean": 308.76532321821605}, "env_runner_results": {"episode_reward_max": 360.8902063446212, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 308.76532321821605, "episode_len_mean": 48.193548387096776, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 2988, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.6424829595276, 306.8172901006111, 297.7175647236076, 338.4202332700031, 317.2894151399419, 92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315, 323.0757340901137, 352.21332258802033, 319.3747340873739, 147.29741470848435, 323.25066179317554, 318.2202750073487, 220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124, 308.1635799013973, 343.91766058165695, 324.1740470591953, 309.62479091810644, 336.73573705090683, 326.1570243816386, 249.23298811082594, 306.85638869733464, 315.228807431455, 327.68945638958405, 310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386], "episode_lengths": [50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5597402078424585, "mean_inference_ms": 1.2641980364429808, "mean_action_processing_ms": 0.20937955105413522, "mean_env_wait_ms": 519.3188903746554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012556583650650517, "StateBufferConnector_ms": 0.005891246180380544, "ViewRequirementAgentConnector_ms": 0.1646876335144043}, "num_episodes": 24, "episode_return_max": 360.8902063446212, "episode_return_min": 92.89244610937851, "episode_return_mean": 308.76532321821605}, "episode_reward_max": 360.8902063446212, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 308.76532321821605, "episode_len_mean": 48.193548387096776, "episodes_this_iter": 24, "episodes_timesteps_total": 2988, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [267.6424829595276, 306.8172901006111, 297.7175647236076, 338.4202332700031, 317.2894151399419, 92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315, 323.0757340901137, 352.21332258802033, 319.3747340873739, 147.29741470848435, 323.25066179317554, 318.2202750073487, 220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124, 308.1635799013973, 343.91766058165695, 324.1740470591953, 309.62479091810644, 336.73573705090683, 326.1570243816386, 249.23298811082594, 306.85638869733464, 315.228807431455, 327.68945638958405, 310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386], "episode_lengths": [50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5597402078424585, "mean_inference_ms": 1.2641980364429808, "mean_action_processing_ms": 0.20937955105413522, "mean_env_wait_ms": 519.3188903746554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012556583650650517, "StateBufferConnector_ms": 0.005891246180380544, "ViewRequirementAgentConnector_ms": 0.1646876335144043}, "num_episodes": 24, "episode_return_max": 360.8902063446212, "episode_return_min": 92.89244610937851, "episode_return_mean": 308.76532321821605, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27846, "num_agent_steps_trained": 27846, "num_env_steps_sampled": 27846, "num_env_steps_trained": 27846, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.659997238272904, "num_env_steps_trained_throughput_per_sec": 9.659997238272904, "timesteps_total": 27846, "num_env_steps_sampled_lifetime": 27846, "num_agent_steps_sampled_lifetime": 27846, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 27846, "timers": {"training_iteration_time_ms": 100769.288, "restore_workers_time_ms": 0.017, "training_step_time_ms": 100769.235, "sample_time_ms": 97751.842, "load_time_ms": 0.541, "load_throughput": 1897981.14, "learn_time_ms": 3003.602, "learn_throughput": 341.59, "synch_weights_time_ms": 12.863}, "counters": {"num_env_steps_sampled": 27846, "num_env_steps_trained": 27846, "num_agent_steps_sampled": 27846, "num_agent_steps_trained": 27846}, "done": false, "episodes_total": 853, "training_iteration": 51, "trial_id": "fe178_00003", "date": "2024-08-15_17-51-01", "timestamp": 1723765861, "time_this_iter_s": 106.21446800231934, "time_total_s": 3102.9975731372833, "pid": 57094, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.38889123387447605, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.978620259509809, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 302.3172481060028, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.81776315789474, "ram_util_percent": 11.567105263157893}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.817705467840035, "cur_kl_coeff": 0.375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.013692206144333, "policy_loss": -0.008881734831569095, "vf_loss": 9.01947564681371, "vf_explained_var": 0.22309705888231596, "kl": 0.008262221501840828, "entropy": -0.6075190300509955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 28872, "num_env_steps_trained": 28872, "num_agent_steps_sampled": 28872, "num_agent_steps_trained": 28872}, "sampler_results": {"episode_reward_max": 360.8902063446212, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 302.0874475483335, "episode_len_mean": 47.55421686746988, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 3947, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.6424829595276, 306.8172901006111, 297.7175647236076, 338.4202332700031, 317.2894151399419, 92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315, 323.0757340901137, 352.21332258802033, 319.3747340873739, 147.29741470848435, 323.25066179317554, 318.2202750073487, 220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124, 308.1635799013973, 343.91766058165695, 324.1740470591953, 309.62479091810644, 336.73573705090683, 326.1570243816386, 249.23298811082594, 306.85638869733464, 315.228807431455, 327.68945638958405, 310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386, 251.83762673361025, 303.19743436795017, 346.7216308980343, 328.0017452232315, 160.6935913085938, 323.4929283908425, 288.78767460423404, 328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324], "episode_lengths": [50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.606717403190548, "mean_inference_ms": 1.26299389902149, "mean_action_processing_ms": 0.20917379771942396, "mean_env_wait_ms": 519.3117172961431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011823550764336643, "StateBufferConnector_ms": 0.0058458512087902394, "ViewRequirementAgentConnector_ms": 0.1644045473581337}, "num_episodes": 21, "episode_return_max": 360.8902063446212, "episode_return_min": 92.89244610937851, "episode_return_mean": 302.0874475483335}, "env_runner_results": {"episode_reward_max": 360.8902063446212, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 302.0874475483335, "episode_len_mean": 47.55421686746988, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 3947, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.6424829595276, 306.8172901006111, 297.7175647236076, 338.4202332700031, 317.2894151399419, 92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315, 323.0757340901137, 352.21332258802033, 319.3747340873739, 147.29741470848435, 323.25066179317554, 318.2202750073487, 220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124, 308.1635799013973, 343.91766058165695, 324.1740470591953, 309.62479091810644, 336.73573705090683, 326.1570243816386, 249.23298811082594, 306.85638869733464, 315.228807431455, 327.68945638958405, 310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386, 251.83762673361025, 303.19743436795017, 346.7216308980343, 328.0017452232315, 160.6935913085938, 323.4929283908425, 288.78767460423404, 328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324], "episode_lengths": [50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.606717403190548, "mean_inference_ms": 1.26299389902149, "mean_action_processing_ms": 0.20917379771942396, "mean_env_wait_ms": 519.3117172961431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011823550764336643, "StateBufferConnector_ms": 0.0058458512087902394, "ViewRequirementAgentConnector_ms": 0.1644045473581337}, "num_episodes": 21, "episode_return_max": 360.8902063446212, "episode_return_min": 92.89244610937851, "episode_return_mean": 302.0874475483335}, "episode_reward_max": 360.8902063446212, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 302.0874475483335, "episode_len_mean": 47.55421686746988, "episodes_this_iter": 21, "episodes_timesteps_total": 3947, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [267.6424829595276, 306.8172901006111, 297.7175647236076, 338.4202332700031, 317.2894151399419, 92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315, 323.0757340901137, 352.21332258802033, 319.3747340873739, 147.29741470848435, 323.25066179317554, 318.2202750073487, 220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124, 308.1635799013973, 343.91766058165695, 324.1740470591953, 309.62479091810644, 336.73573705090683, 326.1570243816386, 249.23298811082594, 306.85638869733464, 315.228807431455, 327.68945638958405, 310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386, 251.83762673361025, 303.19743436795017, 346.7216308980343, 328.0017452232315, 160.6935913085938, 323.4929283908425, 288.78767460423404, 328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324], "episode_lengths": [50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.606717403190548, "mean_inference_ms": 1.26299389902149, "mean_action_processing_ms": 0.20917379771942396, "mean_env_wait_ms": 519.3117172961431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011823550764336643, "StateBufferConnector_ms": 0.0058458512087902394, "ViewRequirementAgentConnector_ms": 0.1644045473581337}, "num_episodes": 21, "episode_return_max": 360.8902063446212, "episode_return_min": 92.89244610937851, "episode_return_mean": 302.0874475483335, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28872, "num_agent_steps_trained": 28872, "num_env_steps_sampled": 28872, "num_env_steps_trained": 28872, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.817504075067914, "num_env_steps_trained_throughput_per_sec": 9.817504075067914, "timesteps_total": 28872, "num_env_steps_sampled_lifetime": 28872, "num_agent_steps_sampled_lifetime": 28872, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 28872, "timers": {"training_iteration_time_ms": 101703.772, "restore_workers_time_ms": 0.017, "training_step_time_ms": 101703.718, "sample_time_ms": 99108.815, "load_time_ms": 0.526, "load_throughput": 1949425.098, "learn_time_ms": 2580.973, "learn_throughput": 397.524, "synch_weights_time_ms": 13.027}, "counters": {"num_env_steps_sampled": 28872, "num_env_steps_trained": 28872, "num_agent_steps_sampled": 28872, "num_agent_steps_trained": 28872}, "done": false, "episodes_total": 874, "training_iteration": 52, "trial_id": "fe178_00003", "date": "2024-08-15_17-52-45", "timestamp": 1723765965, "time_this_iter_s": 104.51075053215027, "time_total_s": 3207.5083236694336, "pid": 57094, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.38889123387447605, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.978620259509809, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 406.8279986381531, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.916778523489935, "ram_util_percent": 11.508053691275169}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.1941299200058, "cur_kl_coeff": 0.375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.627292573451996, "policy_loss": -0.00757611938752234, "vf_loss": 8.630852794647216, "vf_explained_var": -0.004024731864531835, "kl": 0.010709113097983764, "entropy": -0.6383751187473535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 29898, "num_env_steps_trained": 29898, "num_agent_steps_sampled": 29898, "num_agent_steps_trained": 29898}, "sampler_results": {"episode_reward_max": 360.8902063446212, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 302.773135351575, "episode_len_mean": 47.66, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4766, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315, 323.0757340901137, 352.21332258802033, 319.3747340873739, 147.29741470848435, 323.25066179317554, 318.2202750073487, 220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124, 308.1635799013973, 343.91766058165695, 324.1740470591953, 309.62479091810644, 336.73573705090683, 326.1570243816386, 249.23298811082594, 306.85638869733464, 315.228807431455, 327.68945638958405, 310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386, 251.83762673361025, 303.19743436795017, 346.7216308980343, 328.0017452232315, 160.6935913085938, 323.4929283908425, 288.78767460423404, 328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324, 295.1471180456393, 341.14067636209273, 296.0581338323834, 330.9321392133064, 306.42444618504703, 107.16657408642334, 342.43823526386973, 337.5179893955047, 338.404503141471, 327.91671955435027, 296.1092586083574, 339.50859768443837, 317.90904618975526, 271.79865450440343, 312.7129284704687, 343.4738935751545, 337.46569715922453, 308.17432093984297, 269.97875283402175, 276.79859417767886, 320.9723526257324, 313.8937429903499], "episode_lengths": [17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.643279787307129, "mean_inference_ms": 1.2611020247572988, "mean_action_processing_ms": 0.20915352751361754, "mean_env_wait_ms": 516.212542883775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011489391326904297, "StateBufferConnector_ms": 0.005872488021850586, "ViewRequirementAgentConnector_ms": 0.16575145721435547}, "num_episodes": 22, "episode_return_max": 360.8902063446212, "episode_return_min": 92.89244610937851, "episode_return_mean": 302.773135351575}, "env_runner_results": {"episode_reward_max": 360.8902063446212, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 302.773135351575, "episode_len_mean": 47.66, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4766, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315, 323.0757340901137, 352.21332258802033, 319.3747340873739, 147.29741470848435, 323.25066179317554, 318.2202750073487, 220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124, 308.1635799013973, 343.91766058165695, 324.1740470591953, 309.62479091810644, 336.73573705090683, 326.1570243816386, 249.23298811082594, 306.85638869733464, 315.228807431455, 327.68945638958405, 310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386, 251.83762673361025, 303.19743436795017, 346.7216308980343, 328.0017452232315, 160.6935913085938, 323.4929283908425, 288.78767460423404, 328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324, 295.1471180456393, 341.14067636209273, 296.0581338323834, 330.9321392133064, 306.42444618504703, 107.16657408642334, 342.43823526386973, 337.5179893955047, 338.404503141471, 327.91671955435027, 296.1092586083574, 339.50859768443837, 317.90904618975526, 271.79865450440343, 312.7129284704687, 343.4738935751545, 337.46569715922453, 308.17432093984297, 269.97875283402175, 276.79859417767886, 320.9723526257324, 313.8937429903499], "episode_lengths": [17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.643279787307129, "mean_inference_ms": 1.2611020247572988, "mean_action_processing_ms": 0.20915352751361754, "mean_env_wait_ms": 516.212542883775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011489391326904297, "StateBufferConnector_ms": 0.005872488021850586, "ViewRequirementAgentConnector_ms": 0.16575145721435547}, "num_episodes": 22, "episode_return_max": 360.8902063446212, "episode_return_min": 92.89244610937851, "episode_return_mean": 302.773135351575}, "episode_reward_max": 360.8902063446212, "episode_reward_min": 92.89244610937851, "episode_reward_mean": 302.773135351575, "episode_len_mean": 47.66, "episodes_this_iter": 22, "episodes_timesteps_total": 4766, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [92.89244610937851, 339.4356022449011, 309.8727882334435, 358.9767985641822, 304.49066474916384, 359.88222599292055, 353.45993867975, 342.8332504550601, 332.66123909341866, 329.2561313562658, 313.455276765975, 302.43303177064377, 291.93419937522026, 272.2114187808315, 323.0757340901137, 352.21332258802033, 319.3747340873739, 147.29741470848435, 323.25066179317554, 318.2202750073487, 220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124, 308.1635799013973, 343.91766058165695, 324.1740470591953, 309.62479091810644, 336.73573705090683, 326.1570243816386, 249.23298811082594, 306.85638869733464, 315.228807431455, 327.68945638958405, 310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386, 251.83762673361025, 303.19743436795017, 346.7216308980343, 328.0017452232315, 160.6935913085938, 323.4929283908425, 288.78767460423404, 328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324, 295.1471180456393, 341.14067636209273, 296.0581338323834, 330.9321392133064, 306.42444618504703, 107.16657408642334, 342.43823526386973, 337.5179893955047, 338.404503141471, 327.91671955435027, 296.1092586083574, 339.50859768443837, 317.90904618975526, 271.79865450440343, 312.7129284704687, 343.4738935751545, 337.46569715922453, 308.17432093984297, 269.97875283402175, 276.79859417767886, 320.9723526257324, 313.8937429903499], "episode_lengths": [17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.643279787307129, "mean_inference_ms": 1.2611020247572988, "mean_action_processing_ms": 0.20915352751361754, "mean_env_wait_ms": 516.212542883775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011489391326904297, "StateBufferConnector_ms": 0.005872488021850586, "ViewRequirementAgentConnector_ms": 0.16575145721435547}, "num_episodes": 22, "episode_return_max": 360.8902063446212, "episode_return_min": 92.89244610937851, "episode_return_mean": 302.773135351575, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29898, "num_agent_steps_trained": 29898, "num_env_steps_sampled": 29898, "num_env_steps_trained": 29898, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.39087619107728, "num_env_steps_trained_throughput_per_sec": 11.39087619107728, "timesteps_total": 29898, "num_env_steps_sampled_lifetime": 29898, "num_agent_steps_sampled_lifetime": 29898, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 29898, "timers": {"training_iteration_time_ms": 99377.438, "restore_workers_time_ms": 0.017, "training_step_time_ms": 99377.386, "sample_time_ms": 97053.169, "load_time_ms": 0.508, "load_throughput": 2019785.931, "learn_time_ms": 2310.25, "learn_throughput": 444.108, "synch_weights_time_ms": 13.088}, "counters": {"num_env_steps_sampled": 29898, "num_env_steps_trained": 29898, "num_agent_steps_sampled": 29898, "num_agent_steps_trained": 29898}, "done": false, "episodes_total": 896, "training_iteration": 53, "trial_id": "fe178_00003", "date": "2024-08-15_17-54-15", "timestamp": 1723766055, "time_this_iter_s": 90.07604670524597, "time_total_s": 3297.5843703746796, "pid": 57094, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.38889123387447605, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.978620259509809, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 496.90404534339905, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 28.33875968992248, "ram_util_percent": 11.487596899224805}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.912127508719763, "cur_kl_coeff": 0.375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.525098238388697, "policy_loss": -0.010137308482080698, "vf_loss": 8.532619037230809, "vf_explained_var": 0.10087489932775498, "kl": 0.006977381504962096, "entropy": -0.6695742821631332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 30924, "num_env_steps_trained": 30924, "num_agent_steps_sampled": 30924, "num_agent_steps_trained": 30924}, "sampler_results": {"episode_reward_max": 361.64837660290425, "episode_reward_min": 94.57017126839968, "episode_reward_mean": 302.25677674573365, "episode_len_mean": 47.85, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4785, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124, 308.1635799013973, 343.91766058165695, 324.1740470591953, 309.62479091810644, 336.73573705090683, 326.1570243816386, 249.23298811082594, 306.85638869733464, 315.228807431455, 327.68945638958405, 310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386, 251.83762673361025, 303.19743436795017, 346.7216308980343, 328.0017452232315, 160.6935913085938, 323.4929283908425, 288.78767460423404, 328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324, 295.1471180456393, 341.14067636209273, 296.0581338323834, 330.9321392133064, 306.42444618504703, 107.16657408642334, 342.43823526386973, 337.5179893955047, 338.404503141471, 327.91671955435027, 296.1092586083574, 339.50859768443837, 317.90904618975526, 271.79865450440343, 312.7129284704687, 343.4738935751545, 337.46569715922453, 308.17432093984297, 269.97875283402175, 276.79859417767886, 320.9723526257324, 313.8937429903499, 304.75730580718727, 317.6873789043546, 292.4839318810453, 326.28006739574533, 321.8625567283524, 361.64837660290425, 282.33577658384803, 347.90448423272653, 324.25030750297935, 311.541322416993, 293.0670988607006, 334.7647569843628, 294.47195185183716, 345.70111893268836, 322.0770553402394, 287.9953897234701, 335.8923646785972, 206.72461533414292, 316.159551707643, 107.98588239170897], "episode_lengths": [40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.69315555307325, "mean_inference_ms": 1.259213549439194, "mean_action_processing_ms": 0.2090842421946804, "mean_env_wait_ms": 511.82298554926706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011397838592529297, "StateBufferConnector_ms": 0.0059392452239990234, "ViewRequirementAgentConnector_ms": 0.16799664497375488}, "num_episodes": 20, "episode_return_max": 361.64837660290425, "episode_return_min": 94.57017126839968, "episode_return_mean": 302.25677674573365}, "env_runner_results": {"episode_reward_max": 361.64837660290425, "episode_reward_min": 94.57017126839968, "episode_reward_mean": 302.25677674573365, "episode_len_mean": 47.85, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4785, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124, 308.1635799013973, 343.91766058165695, 324.1740470591953, 309.62479091810644, 336.73573705090683, 326.1570243816386, 249.23298811082594, 306.85638869733464, 315.228807431455, 327.68945638958405, 310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386, 251.83762673361025, 303.19743436795017, 346.7216308980343, 328.0017452232315, 160.6935913085938, 323.4929283908425, 288.78767460423404, 328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324, 295.1471180456393, 341.14067636209273, 296.0581338323834, 330.9321392133064, 306.42444618504703, 107.16657408642334, 342.43823526386973, 337.5179893955047, 338.404503141471, 327.91671955435027, 296.1092586083574, 339.50859768443837, 317.90904618975526, 271.79865450440343, 312.7129284704687, 343.4738935751545, 337.46569715922453, 308.17432093984297, 269.97875283402175, 276.79859417767886, 320.9723526257324, 313.8937429903499, 304.75730580718727, 317.6873789043546, 292.4839318810453, 326.28006739574533, 321.8625567283524, 361.64837660290425, 282.33577658384803, 347.90448423272653, 324.25030750297935, 311.541322416993, 293.0670988607006, 334.7647569843628, 294.47195185183716, 345.70111893268836, 322.0770553402394, 287.9953897234701, 335.8923646785972, 206.72461533414292, 316.159551707643, 107.98588239170897], "episode_lengths": [40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.69315555307325, "mean_inference_ms": 1.259213549439194, "mean_action_processing_ms": 0.2090842421946804, "mean_env_wait_ms": 511.82298554926706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011397838592529297, "StateBufferConnector_ms": 0.0059392452239990234, "ViewRequirementAgentConnector_ms": 0.16799664497375488}, "num_episodes": 20, "episode_return_max": 361.64837660290425, "episode_return_min": 94.57017126839968, "episode_return_mean": 302.25677674573365}, "episode_reward_max": 361.64837660290425, "episode_reward_min": 94.57017126839968, "episode_reward_mean": 302.25677674573365, "episode_len_mean": 47.85, "episodes_this_iter": 20, "episodes_timesteps_total": 4785, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [220.42807124592076, 341.0103955561539, 328.1125033515965, 313.8404941566578, 309.47527769406634, 292.3752501517225, 318.23157641638693, 351.50687015111725, 360.8902063446212, 345.1812034398584, 355.31494589866185, 349.29271123072647, 350.3250821181124, 308.1635799013973, 343.91766058165695, 324.1740470591953, 309.62479091810644, 336.73573705090683, 326.1570243816386, 249.23298811082594, 306.85638869733464, 315.228807431455, 327.68945638958405, 310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386, 251.83762673361025, 303.19743436795017, 346.7216308980343, 328.0017452232315, 160.6935913085938, 323.4929283908425, 288.78767460423404, 328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324, 295.1471180456393, 341.14067636209273, 296.0581338323834, 330.9321392133064, 306.42444618504703, 107.16657408642334, 342.43823526386973, 337.5179893955047, 338.404503141471, 327.91671955435027, 296.1092586083574, 339.50859768443837, 317.90904618975526, 271.79865450440343, 312.7129284704687, 343.4738935751545, 337.46569715922453, 308.17432093984297, 269.97875283402175, 276.79859417767886, 320.9723526257324, 313.8937429903499, 304.75730580718727, 317.6873789043546, 292.4839318810453, 326.28006739574533, 321.8625567283524, 361.64837660290425, 282.33577658384803, 347.90448423272653, 324.25030750297935, 311.541322416993, 293.0670988607006, 334.7647569843628, 294.47195185183716, 345.70111893268836, 322.0770553402394, 287.9953897234701, 335.8923646785972, 206.72461533414292, 316.159551707643, 107.98588239170897], "episode_lengths": [40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.69315555307325, "mean_inference_ms": 1.259213549439194, "mean_action_processing_ms": 0.2090842421946804, "mean_env_wait_ms": 511.82298554926706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011397838592529297, "StateBufferConnector_ms": 0.0059392452239990234, "ViewRequirementAgentConnector_ms": 0.16799664497375488}, "num_episodes": 20, "episode_return_max": 361.64837660290425, "episode_return_min": 94.57017126839968, "episode_return_mean": 302.25677674573365, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30924, "num_agent_steps_trained": 30924, "num_env_steps_sampled": 30924, "num_env_steps_trained": 30924, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.26350847558549, "num_env_steps_trained_throughput_per_sec": 10.26350847558549, "timesteps_total": 30924, "num_env_steps_sampled_lifetime": 30924, "num_agent_steps_sampled_lifetime": 30924, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 30924, "timers": {"training_iteration_time_ms": 99475.503, "restore_workers_time_ms": 0.017, "training_step_time_ms": 99475.452, "sample_time_ms": 97317.653, "load_time_ms": 0.491, "load_throughput": 2087487.705, "learn_time_ms": 2143.999, "learn_throughput": 478.545, "synch_weights_time_ms": 12.961}, "counters": {"num_env_steps_sampled": 30924, "num_env_steps_trained": 30924, "num_agent_steps_sampled": 30924, "num_agent_steps_trained": 30924}, "done": false, "episodes_total": 916, "training_iteration": 54, "trial_id": "fe178_00003", "date": "2024-08-15_17-55-55", "timestamp": 1723766155, "time_this_iter_s": 99.96957015991211, "time_total_s": 3397.5539405345917, "pid": 57094, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.38889123387447605, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.978620259509809, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 596.8736155033112, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.96643356643357, "ram_util_percent": 11.494405594405594}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.138342939813931, "cur_kl_coeff": 0.375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.04287471373876, "policy_loss": -0.003238713062213113, "vf_loss": 9.044214657942454, "vf_explained_var": 0.08203902269403139, "kl": 0.005063064407478807, "entropy": -0.6853934732576211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 31950, "num_env_steps_trained": 31950, "num_agent_steps_sampled": 31950, "num_agent_steps_trained": 31950}, "sampler_results": {"episode_reward_max": 361.64837660290425, "episode_reward_min": 94.57017126839968, "episode_reward_mean": 295.71993831330946, "episode_len_mean": 47.34, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 4734, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386, 251.83762673361025, 303.19743436795017, 346.7216308980343, 328.0017452232315, 160.6935913085938, 323.4929283908425, 288.78767460423404, 328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324, 295.1471180456393, 341.14067636209273, 296.0581338323834, 330.9321392133064, 306.42444618504703, 107.16657408642334, 342.43823526386973, 337.5179893955047, 338.404503141471, 327.91671955435027, 296.1092586083574, 339.50859768443837, 317.90904618975526, 271.79865450440343, 312.7129284704687, 343.4738935751545, 337.46569715922453, 308.17432093984297, 269.97875283402175, 276.79859417767886, 320.9723526257324, 313.8937429903499, 304.75730580718727, 317.6873789043546, 292.4839318810453, 326.28006739574533, 321.8625567283524, 361.64837660290425, 282.33577658384803, 347.90448423272653, 324.25030750297935, 311.541322416993, 293.0670988607006, 334.7647569843628, 294.47195185183716, 345.70111893268836, 322.0770553402394, 287.9953897234701, 335.8923646785972, 206.72461533414292, 316.159551707643, 107.98588239170897, 299.5665087924984, 310.73260093688356, 329.419058329346, 306.78462895558806, 145.89534127402095, 161.23597412109382, 187.76402022136858, 294.6073097975294, 333.82655731674527, 321.58088508136535, 323.33234809412755, 339.5978924298154, 327.97575177921874, 351.31921258209144, 296.95885757119464, 254.48975458155167, 305.92491649756903, 352.4407566071599, 283.58254388776635, 252.56464242578642, 296.66782003667566, 309.26175049631405, 344.55209321957284], "episode_lengths": [50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 21, 50, 50, 50, 50, 27, 27, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.765498582995573, "mean_inference_ms": 1.257757766749327, "mean_action_processing_ms": 0.20902216261781292, "mean_env_wait_ms": 513.703529426068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010992765426635742, "StateBufferConnector_ms": 0.005951404571533203, "ViewRequirementAgentConnector_ms": 0.1696617603302002}, "num_episodes": 23, "episode_return_max": 361.64837660290425, "episode_return_min": 94.57017126839968, "episode_return_mean": 295.71993831330946}, "env_runner_results": {"episode_reward_max": 361.64837660290425, "episode_reward_min": 94.57017126839968, "episode_reward_mean": 295.71993831330946, "episode_len_mean": 47.34, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 4734, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386, 251.83762673361025, 303.19743436795017, 346.7216308980343, 328.0017452232315, 160.6935913085938, 323.4929283908425, 288.78767460423404, 328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324, 295.1471180456393, 341.14067636209273, 296.0581338323834, 330.9321392133064, 306.42444618504703, 107.16657408642334, 342.43823526386973, 337.5179893955047, 338.404503141471, 327.91671955435027, 296.1092586083574, 339.50859768443837, 317.90904618975526, 271.79865450440343, 312.7129284704687, 343.4738935751545, 337.46569715922453, 308.17432093984297, 269.97875283402175, 276.79859417767886, 320.9723526257324, 313.8937429903499, 304.75730580718727, 317.6873789043546, 292.4839318810453, 326.28006739574533, 321.8625567283524, 361.64837660290425, 282.33577658384803, 347.90448423272653, 324.25030750297935, 311.541322416993, 293.0670988607006, 334.7647569843628, 294.47195185183716, 345.70111893268836, 322.0770553402394, 287.9953897234701, 335.8923646785972, 206.72461533414292, 316.159551707643, 107.98588239170897, 299.5665087924984, 310.73260093688356, 329.419058329346, 306.78462895558806, 145.89534127402095, 161.23597412109382, 187.76402022136858, 294.6073097975294, 333.82655731674527, 321.58088508136535, 323.33234809412755, 339.5978924298154, 327.97575177921874, 351.31921258209144, 296.95885757119464, 254.48975458155167, 305.92491649756903, 352.4407566071599, 283.58254388776635, 252.56464242578642, 296.66782003667566, 309.26175049631405, 344.55209321957284], "episode_lengths": [50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 21, 50, 50, 50, 50, 27, 27, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.765498582995573, "mean_inference_ms": 1.257757766749327, "mean_action_processing_ms": 0.20902216261781292, "mean_env_wait_ms": 513.703529426068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010992765426635742, "StateBufferConnector_ms": 0.005951404571533203, "ViewRequirementAgentConnector_ms": 0.1696617603302002}, "num_episodes": 23, "episode_return_max": 361.64837660290425, "episode_return_min": 94.57017126839968, "episode_return_mean": 295.71993831330946}, "episode_reward_max": 361.64837660290425, "episode_reward_min": 94.57017126839968, "episode_reward_mean": 295.71993831330946, "episode_len_mean": 47.34, "episodes_this_iter": 23, "episodes_timesteps_total": 4734, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [310.05210817810683, 302.36122266099903, 143.39079895591914, 111.57081298828132, 332.35843590195, 312.9504511784473, 268.372302239065, 341.82904128063825, 330.53514822923444, 333.1785351108989, 335.7811429487446, 333.05799226000505, 332.42389554983373, 356.70894313020386, 251.83762673361025, 303.19743436795017, 346.7216308980343, 328.0017452232315, 160.6935913085938, 323.4929283908425, 288.78767460423404, 328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324, 295.1471180456393, 341.14067636209273, 296.0581338323834, 330.9321392133064, 306.42444618504703, 107.16657408642334, 342.43823526386973, 337.5179893955047, 338.404503141471, 327.91671955435027, 296.1092586083574, 339.50859768443837, 317.90904618975526, 271.79865450440343, 312.7129284704687, 343.4738935751545, 337.46569715922453, 308.17432093984297, 269.97875283402175, 276.79859417767886, 320.9723526257324, 313.8937429903499, 304.75730580718727, 317.6873789043546, 292.4839318810453, 326.28006739574533, 321.8625567283524, 361.64837660290425, 282.33577658384803, 347.90448423272653, 324.25030750297935, 311.541322416993, 293.0670988607006, 334.7647569843628, 294.47195185183716, 345.70111893268836, 322.0770553402394, 287.9953897234701, 335.8923646785972, 206.72461533414292, 316.159551707643, 107.98588239170897, 299.5665087924984, 310.73260093688356, 329.419058329346, 306.78462895558806, 145.89534127402095, 161.23597412109382, 187.76402022136858, 294.6073097975294, 333.82655731674527, 321.58088508136535, 323.33234809412755, 339.5978924298154, 327.97575177921874, 351.31921258209144, 296.95885757119464, 254.48975458155167, 305.92491649756903, 352.4407566071599, 283.58254388776635, 252.56464242578642, 296.66782003667566, 309.26175049631405, 344.55209321957284], "episode_lengths": [50, 50, 35, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 21, 50, 50, 50, 50, 27, 27, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.765498582995573, "mean_inference_ms": 1.257757766749327, "mean_action_processing_ms": 0.20902216261781292, "mean_env_wait_ms": 513.703529426068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010992765426635742, "StateBufferConnector_ms": 0.005951404571533203, "ViewRequirementAgentConnector_ms": 0.1696617603302002}, "num_episodes": 23, "episode_return_max": 361.64837660290425, "episode_return_min": 94.57017126839968, "episode_return_mean": 295.71993831330946, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31950, "num_agent_steps_trained": 31950, "num_env_steps_sampled": 31950, "num_env_steps_trained": 31950, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.723644595544018, "num_env_steps_trained_throughput_per_sec": 9.723644595544018, "timesteps_total": 31950, "num_env_steps_sampled_lifetime": 31950, "num_agent_steps_sampled_lifetime": 31950, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 31950, "timers": {"training_iteration_time_ms": 100338.432, "restore_workers_time_ms": 0.017, "training_step_time_ms": 100338.381, "sample_time_ms": 98313.02, "load_time_ms": 0.476, "load_throughput": 2154447.957, "learn_time_ms": 2011.623, "learn_throughput": 510.036, "synch_weights_time_ms": 12.926}, "counters": {"num_env_steps_sampled": 31950, "num_env_steps_trained": 31950, "num_agent_steps_sampled": 31950, "num_agent_steps_trained": 31950}, "done": false, "episodes_total": 939, "training_iteration": 55, "trial_id": "fe178_00003", "date": "2024-08-15_17-57-41", "timestamp": 1723766261, "time_this_iter_s": 105.51991486549377, "time_total_s": 3503.0738554000854, "pid": 57094, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.38889123387447605, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.978620259509809, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 702.3935303688049, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 24.566887417218542, "ram_util_percent": 11.733774834437085}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.446814793348313, "cur_kl_coeff": 0.375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.837262938419977, "policy_loss": -0.008956523274537175, "vf_loss": 8.84291483561198, "vf_explained_var": 0.09084361369411151, "kl": 0.00881228376383803, "entropy": -0.7384849261492491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 32976, "num_env_steps_trained": 32976, "num_agent_steps_sampled": 32976, "num_agent_steps_trained": 32976}, "sampler_results": {"episode_reward_max": 361.64837660290425, "episode_reward_min": 58.924363388772804, "episode_reward_mean": 295.742292382812, "episode_len_mean": 47.31, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4731, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324, 295.1471180456393, 341.14067636209273, 296.0581338323834, 330.9321392133064, 306.42444618504703, 107.16657408642334, 342.43823526386973, 337.5179893955047, 338.404503141471, 327.91671955435027, 296.1092586083574, 339.50859768443837, 317.90904618975526, 271.79865450440343, 312.7129284704687, 343.4738935751545, 337.46569715922453, 308.17432093984297, 269.97875283402175, 276.79859417767886, 320.9723526257324, 313.8937429903499, 304.75730580718727, 317.6873789043546, 292.4839318810453, 326.28006739574533, 321.8625567283524, 361.64837660290425, 282.33577658384803, 347.90448423272653, 324.25030750297935, 311.541322416993, 293.0670988607006, 334.7647569843628, 294.47195185183716, 345.70111893268836, 322.0770553402394, 287.9953897234701, 335.8923646785972, 206.72461533414292, 316.159551707643, 107.98588239170897, 299.5665087924984, 310.73260093688356, 329.419058329346, 306.78462895558806, 145.89534127402095, 161.23597412109382, 187.76402022136858, 294.6073097975294, 333.82655731674527, 321.58088508136535, 323.33234809412755, 339.5978924298154, 327.97575177921874, 351.31921258209144, 296.95885757119464, 254.48975458155167, 305.92491649756903, 352.4407566071599, 283.58254388776635, 252.56464242578642, 296.66782003667566, 309.26175049631405, 344.55209321957284, 287.8568336551306, 314.74287019633823, 335.68586782512915, 347.9801609784639, 324.58361724592766, 318.7486160221559, 262.42644862986873, 58.924363388772804, 337.0371516419856, 327.85307525699056, 281.28995988203485, 266.29721998738506, 328.9118334493004, 326.24038022203314, 346.3466403542702, 317.1442000396066, 87.54433294920534, 336.34637611755056, 325.4233195739172, 331.3465702344905, 286.80903143852214], "episode_lengths": [50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 21, 50, 50, 50, 50, 27, 27, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.768145791150179, "mean_inference_ms": 1.2566257545339576, "mean_action_processing_ms": 0.2091944996318613, "mean_env_wait_ms": 514.9611823850631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01063394546508789, "StateBufferConnector_ms": 0.005955219268798828, "ViewRequirementAgentConnector_ms": 0.1697998046875}, "num_episodes": 21, "episode_return_max": 361.64837660290425, "episode_return_min": 58.924363388772804, "episode_return_mean": 295.742292382812}, "env_runner_results": {"episode_reward_max": 361.64837660290425, "episode_reward_min": 58.924363388772804, "episode_reward_mean": 295.742292382812, "episode_len_mean": 47.31, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4731, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324, 295.1471180456393, 341.14067636209273, 296.0581338323834, 330.9321392133064, 306.42444618504703, 107.16657408642334, 342.43823526386973, 337.5179893955047, 338.404503141471, 327.91671955435027, 296.1092586083574, 339.50859768443837, 317.90904618975526, 271.79865450440343, 312.7129284704687, 343.4738935751545, 337.46569715922453, 308.17432093984297, 269.97875283402175, 276.79859417767886, 320.9723526257324, 313.8937429903499, 304.75730580718727, 317.6873789043546, 292.4839318810453, 326.28006739574533, 321.8625567283524, 361.64837660290425, 282.33577658384803, 347.90448423272653, 324.25030750297935, 311.541322416993, 293.0670988607006, 334.7647569843628, 294.47195185183716, 345.70111893268836, 322.0770553402394, 287.9953897234701, 335.8923646785972, 206.72461533414292, 316.159551707643, 107.98588239170897, 299.5665087924984, 310.73260093688356, 329.419058329346, 306.78462895558806, 145.89534127402095, 161.23597412109382, 187.76402022136858, 294.6073097975294, 333.82655731674527, 321.58088508136535, 323.33234809412755, 339.5978924298154, 327.97575177921874, 351.31921258209144, 296.95885757119464, 254.48975458155167, 305.92491649756903, 352.4407566071599, 283.58254388776635, 252.56464242578642, 296.66782003667566, 309.26175049631405, 344.55209321957284, 287.8568336551306, 314.74287019633823, 335.68586782512915, 347.9801609784639, 324.58361724592766, 318.7486160221559, 262.42644862986873, 58.924363388772804, 337.0371516419856, 327.85307525699056, 281.28995988203485, 266.29721998738506, 328.9118334493004, 326.24038022203314, 346.3466403542702, 317.1442000396066, 87.54433294920534, 336.34637611755056, 325.4233195739172, 331.3465702344905, 286.80903143852214], "episode_lengths": [50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 21, 50, 50, 50, 50, 27, 27, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.768145791150179, "mean_inference_ms": 1.2566257545339576, "mean_action_processing_ms": 0.2091944996318613, "mean_env_wait_ms": 514.9611823850631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01063394546508789, "StateBufferConnector_ms": 0.005955219268798828, "ViewRequirementAgentConnector_ms": 0.1697998046875}, "num_episodes": 21, "episode_return_max": 361.64837660290425, "episode_return_min": 58.924363388772804, "episode_return_mean": 295.742292382812}, "episode_reward_max": 361.64837660290425, "episode_reward_min": 58.924363388772804, "episode_reward_mean": 295.742292382812, "episode_len_mean": 47.31, "episodes_this_iter": 21, "episodes_timesteps_total": 4731, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [328.00190588580506, 233.06306467801312, 325.64980619859864, 322.89162343484315, 327.0421977057096, 296.41084477434435, 94.57017126839968, 251.82857480246963, 349.5303780140994, 312.7994746091259, 337.47454091552123, 129.6561175351954, 294.8707445796337, 323.2860310540324, 295.1471180456393, 341.14067636209273, 296.0581338323834, 330.9321392133064, 306.42444618504703, 107.16657408642334, 342.43823526386973, 337.5179893955047, 338.404503141471, 327.91671955435027, 296.1092586083574, 339.50859768443837, 317.90904618975526, 271.79865450440343, 312.7129284704687, 343.4738935751545, 337.46569715922453, 308.17432093984297, 269.97875283402175, 276.79859417767886, 320.9723526257324, 313.8937429903499, 304.75730580718727, 317.6873789043546, 292.4839318810453, 326.28006739574533, 321.8625567283524, 361.64837660290425, 282.33577658384803, 347.90448423272653, 324.25030750297935, 311.541322416993, 293.0670988607006, 334.7647569843628, 294.47195185183716, 345.70111893268836, 322.0770553402394, 287.9953897234701, 335.8923646785972, 206.72461533414292, 316.159551707643, 107.98588239170897, 299.5665087924984, 310.73260093688356, 329.419058329346, 306.78462895558806, 145.89534127402095, 161.23597412109382, 187.76402022136858, 294.6073097975294, 333.82655731674527, 321.58088508136535, 323.33234809412755, 339.5978924298154, 327.97575177921874, 351.31921258209144, 296.95885757119464, 254.48975458155167, 305.92491649756903, 352.4407566071599, 283.58254388776635, 252.56464242578642, 296.66782003667566, 309.26175049631405, 344.55209321957284, 287.8568336551306, 314.74287019633823, 335.68586782512915, 347.9801609784639, 324.58361724592766, 318.7486160221559, 262.42644862986873, 58.924363388772804, 337.0371516419856, 327.85307525699056, 281.28995988203485, 266.29721998738506, 328.9118334493004, 326.24038022203314, 346.3466403542702, 317.1442000396066, 87.54433294920534, 336.34637611755056, 325.4233195739172, 331.3465702344905, 286.80903143852214], "episode_lengths": [50, 40, 50, 50, 50, 50, 18, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 21, 50, 50, 50, 50, 27, 27, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.768145791150179, "mean_inference_ms": 1.2566257545339576, "mean_action_processing_ms": 0.2091944996318613, "mean_env_wait_ms": 514.9611823850631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01063394546508789, "StateBufferConnector_ms": 0.005955219268798828, "ViewRequirementAgentConnector_ms": 0.1697998046875}, "num_episodes": 21, "episode_return_max": 361.64837660290425, "episode_return_min": 58.924363388772804, "episode_return_mean": 295.742292382812, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32976, "num_agent_steps_trained": 32976, "num_env_steps_sampled": 32976, "num_env_steps_trained": 32976, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.50507628581203, "num_env_steps_trained_throughput_per_sec": 10.50507628581203, "timesteps_total": 32976, "num_env_steps_sampled_lifetime": 32976, "num_agent_steps_sampled_lifetime": 32976, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 32976, "timers": {"training_iteration_time_ms": 100004.513, "restore_workers_time_ms": 0.017, "training_step_time_ms": 100004.462, "sample_time_ms": 98080.901, "load_time_ms": 0.463, "load_throughput": 2217938.876, "learn_time_ms": 1909.878, "learn_throughput": 537.207, "synch_weights_time_ms": 12.893}, "counters": {"num_env_steps_sampled": 32976, "num_env_steps_trained": 32976, "num_agent_steps_sampled": 32976, "num_agent_steps_trained": 32976}, "done": false, "episodes_total": 960, "training_iteration": 56, "trial_id": "fe178_00003", "date": "2024-08-15_17-59-18", "timestamp": 1723766358, "time_this_iter_s": 97.67067694664001, "time_total_s": 3600.7445323467255, "pid": 57094, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.38889123387447605, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.978620259509809, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 800.064207315445, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.37482014388489, "ram_util_percent": 11.677697841726618}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.517387145757676, "cur_kl_coeff": 0.5625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.0460369626681, "policy_loss": -0.005485519749345258, "vf_loss": 9.047391535838445, "vf_explained_var": -0.187670236825943, "kl": 0.0073438516186204415, "entropy": -0.5050799960270524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 33462, "num_env_steps_trained": 33462, "num_agent_steps_sampled": 33462, "num_agent_steps_trained": 33462}, "sampler_results": {"episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 279.60980376372095, "episode_len_mean": 46.7, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 934, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [237.17012807129385, 250.85725675706146, 277.40682010010926, 321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.619814298873724, "mean_inference_ms": 1.2485332267228944, "mean_action_processing_ms": 0.20686277123384697, "mean_env_wait_ms": 482.25078596625224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01142263412475586, "StateBufferConnector_ms": 0.006083250045776367, "ViewRequirementAgentConnector_ms": 0.16475677490234375}, "num_episodes": 20, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 279.60980376372095}, "env_runner_results": {"episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 279.60980376372095, "episode_len_mean": 46.7, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 934, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [237.17012807129385, 250.85725675706146, 277.40682010010926, 321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.619814298873724, "mean_inference_ms": 1.2485332267228944, "mean_action_processing_ms": 0.20686277123384697, "mean_env_wait_ms": 482.25078596625224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01142263412475586, "StateBufferConnector_ms": 0.006083250045776367, "ViewRequirementAgentConnector_ms": 0.16475677490234375}, "num_episodes": 20, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 279.60980376372095}, "episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 279.60980376372095, "episode_len_mean": 46.7, "episodes_this_iter": 20, "episodes_timesteps_total": 934, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [237.17012807129385, 250.85725675706146, 277.40682010010926, 321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.619814298873724, "mean_inference_ms": 1.2485332267228944, "mean_action_processing_ms": 0.20686277123384697, "mean_env_wait_ms": 482.25078596625224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01142263412475586, "StateBufferConnector_ms": 0.006083250045776367, "ViewRequirementAgentConnector_ms": 0.16475677490234375}, "num_episodes": 20, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 279.60980376372095, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33462, "num_agent_steps_trained": 33462, "num_env_steps_sampled": 33462, "num_env_steps_trained": 33462, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.981246246066625, "num_env_steps_trained_throughput_per_sec": 10.981246246066625, "timesteps_total": 33462, "num_env_steps_sampled_lifetime": 33462, "num_agent_steps_sampled_lifetime": 33462, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 33462, "timers": {"training_iteration_time_ms": 93432.03, "restore_workers_time_ms": 0.017, "training_step_time_ms": 93431.974, "sample_time_ms": 89265.565, "load_time_ms": 0.83, "load_throughput": 1235886.245, "learn_time_ms": 4152.415, "learn_throughput": 247.085, "synch_weights_time_ms": 12.666}, "counters": {"num_env_steps_sampled": 33462, "num_env_steps_trained": 33462, "num_agent_steps_sampled": 33462, "num_agent_steps_trained": 33462}, "done": false, "episodes_total": 965, "training_iteration": 49, "trial_id": "fe178_00003", "date": "2024-08-15_18-01-10", "timestamp": 1723766470, "time_this_iter_s": 93.43490648269653, "time_total_s": 3645.5713686943054, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 93.43490648269653, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.368656716417913, "ram_util_percent": 11.735820895522385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.025840326150258, "cur_kl_coeff": 0.5625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.441223541895548, "policy_loss": -0.011254980554804206, "vf_loss": 9.44808125893275, "vf_explained_var": 0.01593188171585401, "kl": 0.007817335771505896, "entropy": -0.6868187143156926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 34488, "num_env_steps_trained": 34488, "num_agent_steps_sampled": 34488, "num_agent_steps_trained": 34488}, "sampler_results": {"episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 298.95214984562955, "episode_len_mean": 48.26315789473684, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1834, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [237.17012807129385, 250.85725675706146, 277.40682010010926, 321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325, 328.73591102006003, 331.0946499991491, 332.59344469665893, 322.2196409642662, 292.95463260961554, 257.3625570829616, 355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.498248407443417, "mean_inference_ms": 1.247767592893351, "mean_action_processing_ms": 0.20659129190143596, "mean_env_wait_ms": 505.3340954629919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012280439075670745, "StateBufferConnector_ms": 0.006109162380820827, "ViewRequirementAgentConnector_ms": 0.1648444878427606}, "num_episodes": 18, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 298.95214984562955}, "env_runner_results": {"episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 298.95214984562955, "episode_len_mean": 48.26315789473684, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1834, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [237.17012807129385, 250.85725675706146, 277.40682010010926, 321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325, 328.73591102006003, 331.0946499991491, 332.59344469665893, 322.2196409642662, 292.95463260961554, 257.3625570829616, 355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.498248407443417, "mean_inference_ms": 1.247767592893351, "mean_action_processing_ms": 0.20659129190143596, "mean_env_wait_ms": 505.3340954629919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012280439075670745, "StateBufferConnector_ms": 0.006109162380820827, "ViewRequirementAgentConnector_ms": 0.1648444878427606}, "num_episodes": 18, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 298.95214984562955}, "episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 298.95214984562955, "episode_len_mean": 48.26315789473684, "episodes_this_iter": 18, "episodes_timesteps_total": 1834, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [237.17012807129385, 250.85725675706146, 277.40682010010926, 321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325, 328.73591102006003, 331.0946499991491, 332.59344469665893, 322.2196409642662, 292.95463260961554, 257.3625570829616, 355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.498248407443417, "mean_inference_ms": 1.247767592893351, "mean_action_processing_ms": 0.20659129190143596, "mean_env_wait_ms": 505.3340954629919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012280439075670745, "StateBufferConnector_ms": 0.006109162380820827, "ViewRequirementAgentConnector_ms": 0.1648444878427606}, "num_episodes": 18, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 298.95214984562955, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34488, "num_agent_steps_trained": 34488, "num_env_steps_sampled": 34488, "num_env_steps_trained": 34488, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.58891367079008, "num_env_steps_trained_throughput_per_sec": 9.58891367079008, "timesteps_total": 34488, "num_env_steps_sampled_lifetime": 34488, "num_agent_steps_sampled_lifetime": 34488, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 34488, "timers": {"training_iteration_time_ms": 100215.304, "restore_workers_time_ms": 0.018, "training_step_time_ms": 100215.245, "sample_time_ms": 97441.624, "load_time_ms": 0.594, "load_throughput": 1726521.927, "learn_time_ms": 2759.653, "learn_throughput": 371.786, "synch_weights_time_ms": 12.971}, "counters": {"num_env_steps_sampled": 34488, "num_env_steps_trained": 34488, "num_agent_steps_sampled": 34488, "num_agent_steps_trained": 34488}, "done": false, "episodes_total": 983, "training_iteration": 50, "trial_id": "fe178_00003", "date": "2024-08-15_18-02-57", "timestamp": 1723766577, "time_this_iter_s": 107.00221848487854, "time_total_s": 3752.573587179184, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 200.43712496757507, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 24.269281045751633, "ram_util_percent": 11.701307189542483}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.322461209694545, "cur_kl_coeff": 0.5625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.013829320669174, "policy_loss": -0.010038440471786696, "vf_loss": 9.020549619197846, "vf_explained_var": -0.03416836510101954, "kl": 0.0058990574684701464, "entropy": -0.585569295908014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 35514, "num_env_steps_trained": 35514, "num_agent_steps_sampled": 35514, "num_agent_steps_trained": 35514}, "sampler_results": {"episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 300.22150297793434, "episode_len_mean": 48.43333333333333, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 2906, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [237.17012807129385, 250.85725675706146, 277.40682010010926, 321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325, 328.73591102006003, 331.0946499991491, 332.59344469665893, 322.2196409642662, 292.95463260961554, 257.3625570829616, 355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474, 320.33011294159434, 333.15180919689476, 327.67451145170946, 100.59117512934728, 325.942775304684, 287.9273501515415, 313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.518870684050175, "mean_inference_ms": 1.2478800626060673, "mean_action_processing_ms": 0.20666804691369992, "mean_env_wait_ms": 519.6313852306915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012149810791015625, "StateBufferConnector_ms": 0.006212393442789714, "ViewRequirementAgentConnector_ms": 0.16634305318196616}, "num_episodes": 22, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 300.22150297793434}, "env_runner_results": {"episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 300.22150297793434, "episode_len_mean": 48.43333333333333, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 2906, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [237.17012807129385, 250.85725675706146, 277.40682010010926, 321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325, 328.73591102006003, 331.0946499991491, 332.59344469665893, 322.2196409642662, 292.95463260961554, 257.3625570829616, 355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474, 320.33011294159434, 333.15180919689476, 327.67451145170946, 100.59117512934728, 325.942775304684, 287.9273501515415, 313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.518870684050175, "mean_inference_ms": 1.2478800626060673, "mean_action_processing_ms": 0.20666804691369992, "mean_env_wait_ms": 519.6313852306915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012149810791015625, "StateBufferConnector_ms": 0.006212393442789714, "ViewRequirementAgentConnector_ms": 0.16634305318196616}, "num_episodes": 22, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 300.22150297793434}, "episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 300.22150297793434, "episode_len_mean": 48.43333333333333, "episodes_this_iter": 22, "episodes_timesteps_total": 2906, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [237.17012807129385, 250.85725675706146, 277.40682010010926, 321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325, 328.73591102006003, 331.0946499991491, 332.59344469665893, 322.2196409642662, 292.95463260961554, 257.3625570829616, 355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474, 320.33011294159434, 333.15180919689476, 327.67451145170946, 100.59117512934728, 325.942775304684, 287.9273501515415, 313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.518870684050175, "mean_inference_ms": 1.2478800626060673, "mean_action_processing_ms": 0.20666804691369992, "mean_env_wait_ms": 519.6313852306915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012149810791015625, "StateBufferConnector_ms": 0.006212393442789714, "ViewRequirementAgentConnector_ms": 0.16634305318196616}, "num_episodes": 22, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 300.22150297793434, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35514, "num_agent_steps_trained": 35514, "num_env_steps_sampled": 35514, "num_env_steps_trained": 35514, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.557433511554695, "num_env_steps_trained_throughput_per_sec": 9.557433511554695, "timesteps_total": 35514, "num_env_steps_sampled_lifetime": 35514, "num_agent_steps_sampled_lifetime": 35514, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 35514, "timers": {"training_iteration_time_ms": 102593.872, "restore_workers_time_ms": 0.019, "training_step_time_ms": 102593.812, "sample_time_ms": 100287.806, "load_time_ms": 0.544, "load_throughput": 1886058.103, "learn_time_ms": 2292.034, "learn_throughput": 447.637, "synch_weights_time_ms": 13.057}, "counters": {"num_env_steps_sampled": 35514, "num_env_steps_trained": 35514, "num_agent_steps_sampled": 35514, "num_agent_steps_trained": 35514}, "done": false, "episodes_total": 1005, "training_iteration": 51, "trial_id": "fe178_00003", "date": "2024-08-15_18-04-44", "timestamp": 1723766684, "time_this_iter_s": 107.35439205169678, "time_total_s": 3859.9279792308807, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 307.79151701927185, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.307843137254903, "ram_util_percent": 11.926797385620917}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.11856829126676, "cur_kl_coeff": 0.5625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.121720627943676, "policy_loss": -0.004641982978985955, "vf_loss": 9.119808828830719, "vf_explained_var": -0.03502222547928492, "kl": 0.011651218557867367, "entropy": -0.6917130933453639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 36540, "num_env_steps_trained": 36540, "num_agent_steps_sampled": 36540, "num_agent_steps_trained": 36540}, "sampler_results": {"episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 305.1574268732842, "episode_len_mean": 48.839506172839506, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 3956, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [237.17012807129385, 250.85725675706146, 277.40682010010926, 321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325, 328.73591102006003, 331.0946499991491, 332.59344469665893, 322.2196409642662, 292.95463260961554, 257.3625570829616, 355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474, 320.33011294159434, 333.15180919689476, 327.67451145170946, 100.59117512934728, 325.942775304684, 287.9273501515415, 313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487, 325.8348644997851, 333.25092188942136, 350.0301346187459, 325.7681362304878, 350.00815818304625, 320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.540935037105052, "mean_inference_ms": 1.2471763432440564, "mean_action_processing_ms": 0.20669247256565135, "mean_env_wait_ms": 522.5660730218406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011495307639793114, "StateBufferConnector_ms": 0.006194467897768374, "ViewRequirementAgentConnector_ms": 0.1667743847693926}, "num_episodes": 21, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 305.1574268732842}, "env_runner_results": {"episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 305.1574268732842, "episode_len_mean": 48.839506172839506, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 3956, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [237.17012807129385, 250.85725675706146, 277.40682010010926, 321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325, 328.73591102006003, 331.0946499991491, 332.59344469665893, 322.2196409642662, 292.95463260961554, 257.3625570829616, 355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474, 320.33011294159434, 333.15180919689476, 327.67451145170946, 100.59117512934728, 325.942775304684, 287.9273501515415, 313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487, 325.8348644997851, 333.25092188942136, 350.0301346187459, 325.7681362304878, 350.00815818304625, 320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.540935037105052, "mean_inference_ms": 1.2471763432440564, "mean_action_processing_ms": 0.20669247256565135, "mean_env_wait_ms": 522.5660730218406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011495307639793114, "StateBufferConnector_ms": 0.006194467897768374, "ViewRequirementAgentConnector_ms": 0.1667743847693926}, "num_episodes": 21, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 305.1574268732842}, "episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 305.1574268732842, "episode_len_mean": 48.839506172839506, "episodes_this_iter": 21, "episodes_timesteps_total": 3956, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [237.17012807129385, 250.85725675706146, 277.40682010010926, 321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325, 328.73591102006003, 331.0946499991491, 332.59344469665893, 322.2196409642662, 292.95463260961554, 257.3625570829616, 355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474, 320.33011294159434, 333.15180919689476, 327.67451145170946, 100.59117512934728, 325.942775304684, 287.9273501515415, 313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487, 325.8348644997851, 333.25092188942136, 350.0301346187459, 325.7681362304878, 350.00815818304625, 320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.540935037105052, "mean_inference_ms": 1.2471763432440564, "mean_action_processing_ms": 0.20669247256565135, "mean_env_wait_ms": 522.5660730218406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011495307639793114, "StateBufferConnector_ms": 0.006194467897768374, "ViewRequirementAgentConnector_ms": 0.1667743847693926}, "num_episodes": 21, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 305.1574268732842, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36540, "num_agent_steps_trained": 36540, "num_env_steps_sampled": 36540, "num_env_steps_trained": 36540, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.023611853322478, "num_env_steps_trained_throughput_per_sec": 11.023611853322478, "timesteps_total": 36540, "num_env_steps_sampled_lifetime": 36540, "num_agent_steps_sampled_lifetime": 36540, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 36540, "timers": {"training_iteration_time_ms": 100213.643, "restore_workers_time_ms": 0.018, "training_step_time_ms": 100213.585, "sample_time_ms": 98188.179, "load_time_ms": 0.491, "load_throughput": 2088500.803, "learn_time_ms": 2011.458, "learn_throughput": 510.078, "synch_weights_time_ms": 13.091}, "counters": {"num_env_steps_sampled": 36540, "num_env_steps_trained": 36540, "num_agent_steps_sampled": 36540, "num_agent_steps_trained": 36540}, "done": false, "episodes_total": 1026, "training_iteration": 52, "trial_id": "fe178_00003", "date": "2024-08-15_18-06-17", "timestamp": 1723766777, "time_this_iter_s": 93.07635021209717, "time_total_s": 3953.004329442978, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 400.867867231369, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.72631578947368, "ram_util_percent": 12.043609022556392}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.982034074266751, "cur_kl_coeff": 0.5625, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.711628156900407, "policy_loss": -0.006174035923322663, "vf_loss": 8.715254414081574, "vf_explained_var": -0.1066892643769582, "kl": 0.004529241002122338, "entropy": -0.5285417915632328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 37566, "num_env_steps_trained": 37566, "num_agent_steps_sampled": 37566, "num_agent_steps_trained": 37566}, "sampler_results": {"episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 304.2196537025786, "episode_len_mean": 48.54, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4854, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325, 328.73591102006003, 331.0946499991491, 332.59344469665893, 322.2196409642662, 292.95463260961554, 257.3625570829616, 355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474, 320.33011294159434, 333.15180919689476, 327.67451145170946, 100.59117512934728, 325.942775304684, 287.9273501515415, 313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487, 325.8348644997851, 333.25092188942136, 350.0301346187459, 325.7681362304878, 350.00815818304625, 320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704, 266.77962688070505, 313.6399716358438, 290.2020536686622, 334.04346539461267, 124.95233062426269, 291.7111980269841, 335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425], "episode_lengths": [50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.573310671576411, "mean_inference_ms": 1.2453549522673408, "mean_action_processing_ms": 0.2067360041795135, "mean_env_wait_ms": 524.8865564747969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011129379272460938, "StateBufferConnector_ms": 0.006163120269775391, "ViewRequirementAgentConnector_ms": 0.1672344207763672}, "num_episodes": 22, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 304.2196537025786}, "env_runner_results": {"episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 304.2196537025786, "episode_len_mean": 48.54, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4854, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325, 328.73591102006003, 331.0946499991491, 332.59344469665893, 322.2196409642662, 292.95463260961554, 257.3625570829616, 355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474, 320.33011294159434, 333.15180919689476, 327.67451145170946, 100.59117512934728, 325.942775304684, 287.9273501515415, 313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487, 325.8348644997851, 333.25092188942136, 350.0301346187459, 325.7681362304878, 350.00815818304625, 320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704, 266.77962688070505, 313.6399716358438, 290.2020536686622, 334.04346539461267, 124.95233062426269, 291.7111980269841, 335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425], "episode_lengths": [50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.573310671576411, "mean_inference_ms": 1.2453549522673408, "mean_action_processing_ms": 0.2067360041795135, "mean_env_wait_ms": 524.8865564747969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011129379272460938, "StateBufferConnector_ms": 0.006163120269775391, "ViewRequirementAgentConnector_ms": 0.1672344207763672}, "num_episodes": 22, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 304.2196537025786}, "episode_reward_max": 365.87317703376414, "episode_reward_min": 80.42305619283962, "episode_reward_mean": 304.2196537025786, "episode_len_mean": 48.54, "episodes_this_iter": 22, "episodes_timesteps_total": 4854, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [321.7632063501317, 245.48035267521425, 332.88350207566, 80.42305619283962, 265.4889751620137, 340.8697738529986, 309.82952317227546, 365.87317703376414, 295.89806129113924, 275.4032492851146, 307.9080245383517, 307.0355213849557, 306.5651055008061, 106.9142121724916, 275.8077291890725, 359.73645642129253, 328.8819440478325, 328.73591102006003, 331.0946499991491, 332.59344469665893, 322.2196409642662, 292.95463260961554, 257.3625570829616, 355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474, 320.33011294159434, 333.15180919689476, 327.67451145170946, 100.59117512934728, 325.942775304684, 287.9273501515415, 313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487, 325.8348644997851, 333.25092188942136, 350.0301346187459, 325.7681362304878, 350.00815818304625, 320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704, 266.77962688070505, 313.6399716358438, 290.2020536686622, 334.04346539461267, 124.95233062426269, 291.7111980269841, 335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425], "episode_lengths": [50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.573310671576411, "mean_inference_ms": 1.2453549522673408, "mean_action_processing_ms": 0.2067360041795135, "mean_env_wait_ms": 524.8865564747969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011129379272460938, "StateBufferConnector_ms": 0.006163120269775391, "ViewRequirementAgentConnector_ms": 0.1672344207763672}, "num_episodes": 22, "episode_return_max": 365.87317703376414, "episode_return_min": 80.42305619283962, "episode_return_mean": 304.2196537025786, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37566, "num_agent_steps_trained": 37566, "num_env_steps_sampled": 37566, "num_env_steps_trained": 37566, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.461457605735076, "num_env_steps_trained_throughput_per_sec": 10.461457605735076, "timesteps_total": 37566, "num_env_steps_sampled_lifetime": 37566, "num_agent_steps_sampled_lifetime": 37566, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 37566, "timers": {"training_iteration_time_ms": 99785.774, "restore_workers_time_ms": 0.018, "training_step_time_ms": 99785.717, "sample_time_ms": 97890.124, "load_time_ms": 0.477, "load_throughput": 2151247.702, "learn_time_ms": 1881.577, "learn_throughput": 545.287, "synch_weights_time_ms": 13.178}, "counters": {"num_env_steps_sampled": 37566, "num_env_steps_trained": 37566, "num_agent_steps_sampled": 37566, "num_agent_steps_trained": 37566}, "done": false, "episodes_total": 1048, "training_iteration": 53, "trial_id": "fe178_00003", "date": "2024-08-15_18-07-55", "timestamp": 1723766875, "time_this_iter_s": 98.07815623283386, "time_total_s": 4051.0824856758118, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 498.9460234642029, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 26.317142857142855, "ram_util_percent": 11.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.70152904589971, "cur_kl_coeff": 0.28125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.997040448586146, "policy_loss": -0.003272599808406085, "vf_loss": 8.996079409122467, "vf_explained_var": -0.08248538250724474, "kl": 0.015052988835639913, "entropy": -0.69122102043281, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 38592, "num_env_steps_trained": 38592, "num_agent_steps_sampled": 38592, "num_agent_steps_trained": 38592}, "sampler_results": {"episode_reward_max": 361.5059485176236, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 304.8979688815282, "episode_len_mean": 48.53, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 4853, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474, 320.33011294159434, 333.15180919689476, 327.67451145170946, 100.59117512934728, 325.942775304684, 287.9273501515415, 313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487, 325.8348644997851, 333.25092188942136, 350.0301346187459, 325.7681362304878, 350.00815818304625, 320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704, 266.77962688070505, 313.6399716358438, 290.2020536686622, 334.04346539461267, 124.95233062426269, 291.7111980269841, 335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425, 288.2752415597063, 332.1279138735293, 326.0184796457359, 290.5133014141124, 312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.596291191602399, "mean_inference_ms": 1.2452994029794682, "mean_action_processing_ms": 0.2069125202405366, "mean_env_wait_ms": 532.6394310228632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010808467864990234, "StateBufferConnector_ms": 0.006180286407470703, "ViewRequirementAgentConnector_ms": 0.16850948333740234}, "num_episodes": 23, "episode_return_max": 361.5059485176236, "episode_return_min": 80.96603846992576, "episode_return_mean": 304.8979688815282}, "env_runner_results": {"episode_reward_max": 361.5059485176236, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 304.8979688815282, "episode_len_mean": 48.53, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 4853, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474, 320.33011294159434, 333.15180919689476, 327.67451145170946, 100.59117512934728, 325.942775304684, 287.9273501515415, 313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487, 325.8348644997851, 333.25092188942136, 350.0301346187459, 325.7681362304878, 350.00815818304625, 320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704, 266.77962688070505, 313.6399716358438, 290.2020536686622, 334.04346539461267, 124.95233062426269, 291.7111980269841, 335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425, 288.2752415597063, 332.1279138735293, 326.0184796457359, 290.5133014141124, 312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.596291191602399, "mean_inference_ms": 1.2452994029794682, "mean_action_processing_ms": 0.2069125202405366, "mean_env_wait_ms": 532.6394310228632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010808467864990234, "StateBufferConnector_ms": 0.006180286407470703, "ViewRequirementAgentConnector_ms": 0.16850948333740234}, "num_episodes": 23, "episode_return_max": 361.5059485176236, "episode_return_min": 80.96603846992576, "episode_return_mean": 304.8979688815282}, "episode_reward_max": 361.5059485176236, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 304.8979688815282, "episode_len_mean": 48.53, "episodes_this_iter": 23, "episodes_timesteps_total": 4853, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [355.5528876414222, 325.05264811806853, 268.76165960850057, 322.24795526857946, 290.56086632540246, 351.2721867227021, 336.08134478700657, 361.5059485176236, 329.4970291864045, 325.2565095329176, 304.1224338121719, 333.11331296599474, 320.33011294159434, 333.15180919689476, 327.67451145170946, 100.59117512934728, 325.942775304684, 287.9273501515415, 313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487, 325.8348644997851, 333.25092188942136, 350.0301346187459, 325.7681362304878, 350.00815818304625, 320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704, 266.77962688070505, 313.6399716358438, 290.2020536686622, 334.04346539461267, 124.95233062426269, 291.7111980269841, 335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425, 288.2752415597063, 332.1279138735293, 326.0184796457359, 290.5133014141124, 312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.596291191602399, "mean_inference_ms": 1.2452994029794682, "mean_action_processing_ms": 0.2069125202405366, "mean_env_wait_ms": 532.6394310228632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010808467864990234, "StateBufferConnector_ms": 0.006180286407470703, "ViewRequirementAgentConnector_ms": 0.16850948333740234}, "num_episodes": 23, "episode_return_max": 361.5059485176236, "episode_return_min": 80.96603846992576, "episode_return_mean": 304.8979688815282, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38592, "num_agent_steps_trained": 38592, "num_env_steps_sampled": 38592, "num_env_steps_trained": 38592, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.04393369538249, "num_env_steps_trained_throughput_per_sec": 10.04393369538249, "timesteps_total": 38592, "num_env_steps_sampled_lifetime": 38592, "num_agent_steps_sampled_lifetime": 38592, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 38592, "timers": {"training_iteration_time_ms": 100180.016, "restore_workers_time_ms": 0.019, "training_step_time_ms": 100179.959, "sample_time_ms": 98388.576, "load_time_ms": 0.47, "load_throughput": 2183890.334, "learn_time_ms": 1777.408, "learn_throughput": 577.245, "synch_weights_time_ms": 13.152}, "counters": {"num_env_steps_sampled": 38592, "num_env_steps_trained": 38592, "num_agent_steps_sampled": 38592, "num_agent_steps_trained": 38592}, "done": false, "episodes_total": 1071, "training_iteration": 54, "trial_id": "fe178_00003", "date": "2024-08-15_18-09-37", "timestamp": 1723766977, "time_this_iter_s": 102.15518474578857, "time_total_s": 4153.2376704216, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 601.1012082099915, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.502758620689654, "ram_util_percent": 11.479999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.58440581758817, "cur_kl_coeff": 0.28125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.81653461853663, "policy_loss": 0.0001070055877789855, "vf_loss": 8.812091914812724, "vf_explained_var": -0.1267038476963838, "kl": 0.015415897141671546, "entropy": -0.6246967272212108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 39618, "num_env_steps_trained": 39618, "num_agent_steps_sampled": 39618, "num_agent_steps_trained": 39618}, "sampler_results": {"episode_reward_max": 360.15105369550145, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 305.8226158596617, "episode_len_mean": 48.81, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 4881, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487, 325.8348644997851, 333.25092188942136, 350.0301346187459, 325.7681362304878, 350.00815818304625, 320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704, 266.77962688070505, 313.6399716358438, 290.2020536686622, 334.04346539461267, 124.95233062426269, 291.7111980269841, 335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425, 288.2752415597063, 332.1279138735293, 326.0184796457359, 290.5133014141124, 312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445, 348.32104252045906, 323.73147746945756, 349.12474759392154, 307.11902996607483, 334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.640322494979098, "mean_inference_ms": 1.244370600606181, "mean_action_processing_ms": 0.20708683286675394, "mean_env_wait_ms": 529.8011371378782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010244607925415039, "StateBufferConnector_ms": 0.006184101104736328, "ViewRequirementAgentConnector_ms": 0.1692357063293457}, "num_episodes": 18, "episode_return_max": 360.15105369550145, "episode_return_min": 80.96603846992576, "episode_return_mean": 305.8226158596617}, "env_runner_results": {"episode_reward_max": 360.15105369550145, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 305.8226158596617, "episode_len_mean": 48.81, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 4881, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487, 325.8348644997851, 333.25092188942136, 350.0301346187459, 325.7681362304878, 350.00815818304625, 320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704, 266.77962688070505, 313.6399716358438, 290.2020536686622, 334.04346539461267, 124.95233062426269, 291.7111980269841, 335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425, 288.2752415597063, 332.1279138735293, 326.0184796457359, 290.5133014141124, 312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445, 348.32104252045906, 323.73147746945756, 349.12474759392154, 307.11902996607483, 334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.640322494979098, "mean_inference_ms": 1.244370600606181, "mean_action_processing_ms": 0.20708683286675394, "mean_env_wait_ms": 529.8011371378782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010244607925415039, "StateBufferConnector_ms": 0.006184101104736328, "ViewRequirementAgentConnector_ms": 0.1692357063293457}, "num_episodes": 18, "episode_return_max": 360.15105369550145, "episode_return_min": 80.96603846992576, "episode_return_mean": 305.8226158596617}, "episode_reward_max": 360.15105369550145, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 305.8226158596617, "episode_len_mean": 48.81, "episodes_this_iter": 18, "episodes_timesteps_total": 4881, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [313.4427698722021, 319.86344124761365, 272.8723495417994, 298.8475144779392, 311.9148969976067, 350.43647873010286, 253.75158557078862, 311.45378184047075, 342.6324872281252, 299.20234332317136, 311.1001547665788, 309.0736224885658, 276.5568344744071, 317.85972614207657, 341.20409338157253, 327.27867028334487, 325.8348644997851, 333.25092188942136, 350.0301346187459, 325.7681362304878, 350.00815818304625, 320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704, 266.77962688070505, 313.6399716358438, 290.2020536686622, 334.04346539461267, 124.95233062426269, 291.7111980269841, 335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425, 288.2752415597063, 332.1279138735293, 326.0184796457359, 290.5133014141124, 312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445, 348.32104252045906, 323.73147746945756, 349.12474759392154, 307.11902996607483, 334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.640322494979098, "mean_inference_ms": 1.244370600606181, "mean_action_processing_ms": 0.20708683286675394, "mean_env_wait_ms": 529.8011371378782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010244607925415039, "StateBufferConnector_ms": 0.006184101104736328, "ViewRequirementAgentConnector_ms": 0.1692357063293457}, "num_episodes": 18, "episode_return_max": 360.15105369550145, "episode_return_min": 80.96603846992576, "episode_return_mean": 305.8226158596617, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39618, "num_agent_steps_trained": 39618, "num_env_steps_sampled": 39618, "num_env_steps_trained": 39618, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.046303514455438, "num_env_steps_trained_throughput_per_sec": 11.046303514455438, "timesteps_total": 39618, "num_env_steps_sampled_lifetime": 39618, "num_agent_steps_sampled_lifetime": 39618, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 39618, "timers": {"training_iteration_time_ms": 99137.408, "restore_workers_time_ms": 0.019, "training_step_time_ms": 99137.353, "sample_time_ms": 97418.426, "load_time_ms": 0.452, "load_throughput": 2268164.395, "learn_time_ms": 1704.894, "learn_throughput": 601.797, "synch_weights_time_ms": 13.234}, "counters": {"num_env_steps_sampled": 39618, "num_env_steps_trained": 39618, "num_agent_steps_sampled": 39618, "num_agent_steps_trained": 39618}, "done": false, "episodes_total": 1089, "training_iteration": 55, "trial_id": "fe178_00003", "date": "2024-08-15_18-11-10", "timestamp": 1723767070, "time_this_iter_s": 92.88554430007935, "time_total_s": 4246.12321472168, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 693.9867525100708, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.455639097744363, "ram_util_percent": 11.090225563909774}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.850060458978017, "cur_kl_coeff": 0.28125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.724470963080725, "policy_loss": 0.000977393197050939, "vf_loss": 8.717509996891021, "vf_explained_var": -0.05923577398061752, "kl": 0.02127506569813823, "entropy": -0.7275333451728027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 40644, "num_env_steps_trained": 40644, "num_agent_steps_sampled": 40644, "num_agent_steps_trained": 40644}, "sampler_results": {"episode_reward_max": 360.15105369550145, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 305.1767242935423, "episode_len_mean": 48.81, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4881, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704, 266.77962688070505, 313.6399716358438, 290.2020536686622, 334.04346539461267, 124.95233062426269, 291.7111980269841, 335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425, 288.2752415597063, 332.1279138735293, 326.0184796457359, 290.5133014141124, 312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445, 348.32104252045906, 323.73147746945756, 349.12474759392154, 307.11902996607483, 334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776, 332.5496897136253, 289.6615196479017, 286.3327308245695, 244.09969655092107, 348.6291565467633, 349.5195614067643, 341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.653221753059841, "mean_inference_ms": 1.243471575633319, "mean_action_processing_ms": 0.20734675787736756, "mean_env_wait_ms": 525.9281963233548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009961128234863281, "StateBufferConnector_ms": 0.0061528682708740234, "ViewRequirementAgentConnector_ms": 0.17004966735839844}, "num_episodes": 21, "episode_return_max": 360.15105369550145, "episode_return_min": 80.96603846992576, "episode_return_mean": 305.1767242935423}, "env_runner_results": {"episode_reward_max": 360.15105369550145, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 305.1767242935423, "episode_len_mean": 48.81, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4881, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704, 266.77962688070505, 313.6399716358438, 290.2020536686622, 334.04346539461267, 124.95233062426269, 291.7111980269841, 335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425, 288.2752415597063, 332.1279138735293, 326.0184796457359, 290.5133014141124, 312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445, 348.32104252045906, 323.73147746945756, 349.12474759392154, 307.11902996607483, 334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776, 332.5496897136253, 289.6615196479017, 286.3327308245695, 244.09969655092107, 348.6291565467633, 349.5195614067643, 341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.653221753059841, "mean_inference_ms": 1.243471575633319, "mean_action_processing_ms": 0.20734675787736756, "mean_env_wait_ms": 525.9281963233548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009961128234863281, "StateBufferConnector_ms": 0.0061528682708740234, "ViewRequirementAgentConnector_ms": 0.17004966735839844}, "num_episodes": 21, "episode_return_max": 360.15105369550145, "episode_return_min": 80.96603846992576, "episode_return_mean": 305.1767242935423}, "episode_reward_max": 360.15105369550145, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 305.1767242935423, "episode_len_mean": 48.81, "episodes_this_iter": 21, "episodes_timesteps_total": 4881, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [320.122728388711, 332.1863730114221, 321.2381838078651, 326.1611798961141, 319.3543487242319, 279.71182563364016, 351.68377800246697, 350.7825946309552, 306.21572294793634, 282.78131143457705, 283.4517780921182, 322.3341003263127, 314.3100109997331, 316.77101888449147, 323.71556133772395, 268.74866652017704, 266.77962688070505, 313.6399716358438, 290.2020536686622, 334.04346539461267, 124.95233062426269, 291.7111980269841, 335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425, 288.2752415597063, 332.1279138735293, 326.0184796457359, 290.5133014141124, 312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445, 348.32104252045906, 323.73147746945756, 349.12474759392154, 307.11902996607483, 334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776, 332.5496897136253, 289.6615196479017, 286.3327308245695, 244.09969655092107, 348.6291565467633, 349.5195614067643, 341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.653221753059841, "mean_inference_ms": 1.243471575633319, "mean_action_processing_ms": 0.20734675787736756, "mean_env_wait_ms": 525.9281963233548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009961128234863281, "StateBufferConnector_ms": 0.0061528682708740234, "ViewRequirementAgentConnector_ms": 0.17004966735839844}, "num_episodes": 21, "episode_return_max": 360.15105369550145, "episode_return_min": 80.96603846992576, "episode_return_mean": 305.1767242935423, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40644, "num_agent_steps_trained": 40644, "num_env_steps_sampled": 40644, "num_env_steps_trained": 40644, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.882642098734049, "num_env_steps_trained_throughput_per_sec": 9.882642098734049, "timesteps_total": 40644, "num_env_steps_sampled_lifetime": 40644, "num_agent_steps_sampled_lifetime": 40644, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 40644, "timers": {"training_iteration_time_ms": 99722.533, "restore_workers_time_ms": 0.02, "training_step_time_ms": 99722.477, "sample_time_ms": 98067.251, "load_time_ms": 0.441, "load_throughput": 2326295.509, "learn_time_ms": 1641.345, "learn_throughput": 625.097, "synch_weights_time_ms": 13.107}, "counters": {"num_env_steps_sampled": 40644, "num_env_steps_trained": 40644, "num_agent_steps_sampled": 40644, "num_agent_steps_trained": 40644}, "done": false, "episodes_total": 1110, "training_iteration": 56, "trial_id": "fe178_00003", "date": "2024-08-15_18-12-54", "timestamp": 1723767174, "time_this_iter_s": 103.82234334945679, "time_total_s": 4349.9455580711365, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 797.8090958595276, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.5277027027027, "ram_util_percent": 11.564864864864864}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.076594533522925, "cur_kl_coeff": 0.421875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.965187168121338, "policy_loss": 0.002695783158803048, "vf_loss": 8.956101721525192, "vf_explained_var": -0.13606721262137095, "kl": 0.015145894479642133, "entropy": -0.7392006006091834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2040.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 41670, "num_env_steps_trained": 41670, "num_agent_steps_sampled": 41670, "num_agent_steps_trained": 41670}, "sampler_results": {"episode_reward_max": 361.7631018733514, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 306.91766941218543, "episode_len_mean": 48.79, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4879, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425, 288.2752415597063, 332.1279138735293, 326.0184796457359, 290.5133014141124, 312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445, 348.32104252045906, 323.73147746945756, 349.12474759392154, 307.11902996607483, 334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776, 332.5496897136253, 289.6615196479017, 286.3327308245695, 244.09969655092107, 348.6291565467633, 349.5195614067643, 341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216, 346.9358991120325, 339.08599848978866, 328.9012170757839, 335.20536903777935, 287.81525703690295, 346.29010813270054, 338.59695733941726, 343.4255263731206, 297.9698632932321, 231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514], "episode_lengths": [50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.667014001819992, "mean_inference_ms": 1.2432854592906266, "mean_action_processing_ms": 0.20750481219759515, "mean_env_wait_ms": 524.9135430215664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010139226913452148, "StateBufferConnector_ms": 0.006148338317871094, "ViewRequirementAgentConnector_ms": 0.17020678520202637}, "num_episodes": 22, "episode_return_max": 361.7631018733514, "episode_return_min": 80.96603846992576, "episode_return_mean": 306.91766941218543}, "env_runner_results": {"episode_reward_max": 361.7631018733514, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 306.91766941218543, "episode_len_mean": 48.79, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4879, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425, 288.2752415597063, 332.1279138735293, 326.0184796457359, 290.5133014141124, 312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445, 348.32104252045906, 323.73147746945756, 349.12474759392154, 307.11902996607483, 334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776, 332.5496897136253, 289.6615196479017, 286.3327308245695, 244.09969655092107, 348.6291565467633, 349.5195614067643, 341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216, 346.9358991120325, 339.08599848978866, 328.9012170757839, 335.20536903777935, 287.81525703690295, 346.29010813270054, 338.59695733941726, 343.4255263731206, 297.9698632932321, 231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514], "episode_lengths": [50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.667014001819992, "mean_inference_ms": 1.2432854592906266, "mean_action_processing_ms": 0.20750481219759515, "mean_env_wait_ms": 524.9135430215664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010139226913452148, "StateBufferConnector_ms": 0.006148338317871094, "ViewRequirementAgentConnector_ms": 0.17020678520202637}, "num_episodes": 22, "episode_return_max": 361.7631018733514, "episode_return_min": 80.96603846992576, "episode_return_mean": 306.91766941218543}, "episode_reward_max": 361.7631018733514, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 306.91766941218543, "episode_len_mean": 48.79, "episodes_this_iter": 22, "episodes_timesteps_total": 4879, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [335.9078492744507, 285.34349321612063, 344.69201400396446, 146.59121205527026, 328.80965580384776, 324.24153228856454, 305.6662416120269, 343.02198735931233, 280.09849014191207, 319.2223277907568, 298.5132502700257, 314.9539786698887, 343.45858038845523, 349.04445534361315, 288.2847143833857, 240.46956961763425, 288.2752415597063, 332.1279138735293, 326.0184796457359, 290.5133014141124, 312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445, 348.32104252045906, 323.73147746945756, 349.12474759392154, 307.11902996607483, 334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776, 332.5496897136253, 289.6615196479017, 286.3327308245695, 244.09969655092107, 348.6291565467633, 349.5195614067643, 341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216, 346.9358991120325, 339.08599848978866, 328.9012170757839, 335.20536903777935, 287.81525703690295, 346.29010813270054, 338.59695733941726, 343.4255263731206, 297.9698632932321, 231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514], "episode_lengths": [50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.667014001819992, "mean_inference_ms": 1.2432854592906266, "mean_action_processing_ms": 0.20750481219759515, "mean_env_wait_ms": 524.9135430215664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010139226913452148, "StateBufferConnector_ms": 0.006148338317871094, "ViewRequirementAgentConnector_ms": 0.17020678520202637}, "num_episodes": 22, "episode_return_max": 361.7631018733514, "episode_return_min": 80.96603846992576, "episode_return_mean": 306.91766941218543, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41670, "num_agent_steps_trained": 41670, "num_env_steps_sampled": 41670, "num_env_steps_trained": 41670, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.019232341014598, "num_env_steps_trained_throughput_per_sec": 10.019232341014598, "timesteps_total": 41670, "num_env_steps_sampled_lifetime": 41670, "num_agent_steps_sampled_lifetime": 41670, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 41670, "timers": {"training_iteration_time_ms": 100020.37, "restore_workers_time_ms": 0.019, "training_step_time_ms": 100020.316, "sample_time_ms": 98409.139, "load_time_ms": 0.433, "load_throughput": 2367661.275, "learn_time_ms": 1597.293, "learn_throughput": 642.337, "synch_weights_time_ms": 13.12}, "counters": {"num_env_steps_sampled": 41670, "num_env_steps_trained": 41670, "num_agent_steps_sampled": 41670, "num_agent_steps_trained": 41670}, "done": false, "episodes_total": 1132, "training_iteration": 57, "trial_id": "fe178_00003", "date": "2024-08-15_18-14-37", "timestamp": 1723767277, "time_this_iter_s": 102.40713167190552, "time_total_s": 4452.352689743042, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 900.2162275314331, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.08299319727891, "ram_util_percent": 11.37142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.159721570213637, "cur_kl_coeff": 0.421875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.972795522212982, "policy_loss": -0.0042230588267557325, "vf_loss": 8.970170056819915, "vf_explained_var": -0.0866268165409565, "kl": 0.016233523070939854, "entropy": -0.7604535706341267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2280.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 42696, "num_env_steps_trained": 42696, "num_agent_steps_sampled": 42696, "num_agent_steps_trained": 42696}, "sampler_results": {"episode_reward_max": 361.7631018733514, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 308.2282669731962, "episode_len_mean": 48.88, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4888, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445, 348.32104252045906, 323.73147746945756, 349.12474759392154, 307.11902996607483, 334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776, 332.5496897136253, 289.6615196479017, 286.3327308245695, 244.09969655092107, 348.6291565467633, 349.5195614067643, 341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216, 346.9358991120325, 339.08599848978866, 328.9012170757839, 335.20536903777935, 287.81525703690295, 346.29010813270054, 338.59695733941726, 343.4255263731206, 297.9698632932321, 231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514, 309.9996724612782, 327.4272790568279, 304.89535185746286, 157.9130411025979, 297.0872112212511, 307.85742720578804, 351.436779478661, 329.3753503287022, 332.3362181492664, 291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236], "episode_lengths": [50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.669775428307734, "mean_inference_ms": 1.242752949972747, "mean_action_processing_ms": 0.20758909664985853, "mean_env_wait_ms": 523.5109976028947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010866403579711914, "StateBufferConnector_ms": 0.00616145133972168, "ViewRequirementAgentConnector_ms": 0.1707017421722412}, "num_episodes": 20, "episode_return_max": 361.7631018733514, "episode_return_min": 80.96603846992576, "episode_return_mean": 308.2282669731962}, "env_runner_results": {"episode_reward_max": 361.7631018733514, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 308.2282669731962, "episode_len_mean": 48.88, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4888, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445, 348.32104252045906, 323.73147746945756, 349.12474759392154, 307.11902996607483, 334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776, 332.5496897136253, 289.6615196479017, 286.3327308245695, 244.09969655092107, 348.6291565467633, 349.5195614067643, 341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216, 346.9358991120325, 339.08599848978866, 328.9012170757839, 335.20536903777935, 287.81525703690295, 346.29010813270054, 338.59695733941726, 343.4255263731206, 297.9698632932321, 231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514, 309.9996724612782, 327.4272790568279, 304.89535185746286, 157.9130411025979, 297.0872112212511, 307.85742720578804, 351.436779478661, 329.3753503287022, 332.3362181492664, 291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236], "episode_lengths": [50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.669775428307734, "mean_inference_ms": 1.242752949972747, "mean_action_processing_ms": 0.20758909664985853, "mean_env_wait_ms": 523.5109976028947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010866403579711914, "StateBufferConnector_ms": 0.00616145133972168, "ViewRequirementAgentConnector_ms": 0.1707017421722412}, "num_episodes": 20, "episode_return_max": 361.7631018733514, "episode_return_min": 80.96603846992576, "episode_return_mean": 308.2282669731962}, "episode_reward_max": 361.7631018733514, "episode_reward_min": 80.96603846992576, "episode_reward_mean": 308.2282669731962, "episode_len_mean": 48.88, "episodes_this_iter": 20, "episodes_timesteps_total": 4888, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [312.7559961895886, 352.805293311674, 80.96603846992576, 318.17229946504074, 254.6866176185177, 354.363530343931, 299.80169090321345, 321.69891792719295, 299.3440853482513, 346.2572804959359, 360.15105369550145, 86.59293668687582, 301.76776951543883, 317.9196632014017, 347.29246544004735, 293.2400193733776, 308.65801167227875, 330.28183673620305, 235.8637817261445, 348.32104252045906, 323.73147746945756, 349.12474759392154, 307.11902996607483, 334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776, 332.5496897136253, 289.6615196479017, 286.3327308245695, 244.09969655092107, 348.6291565467633, 349.5195614067643, 341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216, 346.9358991120325, 339.08599848978866, 328.9012170757839, 335.20536903777935, 287.81525703690295, 346.29010813270054, 338.59695733941726, 343.4255263731206, 297.9698632932321, 231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514, 309.9996724612782, 327.4272790568279, 304.89535185746286, 157.9130411025979, 297.0872112212511, 307.85742720578804, 351.436779478661, 329.3753503287022, 332.3362181492664, 291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236], "episode_lengths": [50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.669775428307734, "mean_inference_ms": 1.242752949972747, "mean_action_processing_ms": 0.20758909664985853, "mean_env_wait_ms": 523.5109976028947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010866403579711914, "StateBufferConnector_ms": 0.00616145133972168, "ViewRequirementAgentConnector_ms": 0.1707017421722412}, "num_episodes": 20, "episode_return_max": 361.7631018733514, "episode_return_min": 80.96603846992576, "episode_return_mean": 308.2282669731962, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42696, "num_agent_steps_trained": 42696, "num_env_steps_sampled": 42696, "num_env_steps_trained": 42696, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.053690738498368, "num_env_steps_trained_throughput_per_sec": 11.053690738498368, "timesteps_total": 42696, "num_env_steps_sampled_lifetime": 42696, "num_agent_steps_sampled_lifetime": 42696, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 42696, "timers": {"training_iteration_time_ms": 99300.302, "restore_workers_time_ms": 0.019, "training_step_time_ms": 99300.249, "sample_time_ms": 97719.721, "load_time_ms": 0.428, "load_throughput": 2394877.792, "learn_time_ms": 1566.665, "learn_throughput": 654.894, "synch_weights_time_ms": 13.106}, "counters": {"num_env_steps_sampled": 42696, "num_env_steps_trained": 42696, "num_agent_steps_sampled": 42696, "num_agent_steps_trained": 42696}, "done": false, "episodes_total": 1152, "training_iteration": 58, "trial_id": "fe178_00003", "date": "2024-08-15_18-16-09", "timestamp": 1723767369, "time_this_iter_s": 92.82367014884949, "time_total_s": 4545.1763598918915, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 993.0398976802826, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.34469696969697, "ram_util_percent": 11.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.763146629929544, "cur_kl_coeff": 0.421875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.61582780877749, "policy_loss": -0.004703949764370918, "vf_loss": 8.617820223172506, "vf_explained_var": 0.0015614454944928486, "kl": 0.0064273025299684825, "entropy": -0.7681903697550296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2520.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 43722, "num_env_steps_trained": 43722, "num_agent_steps_sampled": 43722, "num_agent_steps_trained": 43722}, "sampler_results": {"episode_reward_max": 361.7631018733514, "episode_reward_min": 80.99189565319165, "episode_reward_mean": 309.9360161965014, "episode_len_mean": 49.22, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 4922, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776, 332.5496897136253, 289.6615196479017, 286.3327308245695, 244.09969655092107, 348.6291565467633, 349.5195614067643, 341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216, 346.9358991120325, 339.08599848978866, 328.9012170757839, 335.20536903777935, 287.81525703690295, 346.29010813270054, 338.59695733941726, 343.4255263731206, 297.9698632932321, 231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514, 309.9996724612782, 327.4272790568279, 304.89535185746286, 157.9130411025979, 297.0872112212511, 307.85742720578804, 351.436779478661, 329.3753503287022, 332.3362181492664, 291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236, 281.6824997612043, 97.23576997160386, 316.8953532765554, 319.92707096899363, 298.5732348408658, 308.9549807923536, 251.85470487202178, 313.50592851786513, 347.0579986476773, 323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.662708704314778, "mean_inference_ms": 1.242115233399958, "mean_action_processing_ms": 0.20767323675307436, "mean_env_wait_ms": 522.8074558619751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011184215545654297, "StateBufferConnector_ms": 0.006158113479614258, "ViewRequirementAgentConnector_ms": 0.17068743705749512}, "num_episodes": 23, "episode_return_max": 361.7631018733514, "episode_return_min": 80.99189565319165, "episode_return_mean": 309.9360161965014}, "env_runner_results": {"episode_reward_max": 361.7631018733514, "episode_reward_min": 80.99189565319165, "episode_reward_mean": 309.9360161965014, "episode_len_mean": 49.22, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 4922, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776, 332.5496897136253, 289.6615196479017, 286.3327308245695, 244.09969655092107, 348.6291565467633, 349.5195614067643, 341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216, 346.9358991120325, 339.08599848978866, 328.9012170757839, 335.20536903777935, 287.81525703690295, 346.29010813270054, 338.59695733941726, 343.4255263731206, 297.9698632932321, 231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514, 309.9996724612782, 327.4272790568279, 304.89535185746286, 157.9130411025979, 297.0872112212511, 307.85742720578804, 351.436779478661, 329.3753503287022, 332.3362181492664, 291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236, 281.6824997612043, 97.23576997160386, 316.8953532765554, 319.92707096899363, 298.5732348408658, 308.9549807923536, 251.85470487202178, 313.50592851786513, 347.0579986476773, 323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.662708704314778, "mean_inference_ms": 1.242115233399958, "mean_action_processing_ms": 0.20767323675307436, "mean_env_wait_ms": 522.8074558619751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011184215545654297, "StateBufferConnector_ms": 0.006158113479614258, "ViewRequirementAgentConnector_ms": 0.17068743705749512}, "num_episodes": 23, "episode_return_max": 361.7631018733514, "episode_return_min": 80.99189565319165, "episode_return_mean": 309.9360161965014}, "episode_reward_max": 361.7631018733514, "episode_reward_min": 80.99189565319165, "episode_reward_mean": 309.9360161965014, "episode_len_mean": 49.22, "episodes_this_iter": 23, "episodes_timesteps_total": 4922, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.1365554861999, 333.8173441232808, 315.282073421666, 308.9902427422419, 286.6934795758374, 281.6157184746567, 272.41459307982825, 344.5204766093445, 331.35017791106947, 309.1608108562205, 310.4176836606648, 251.26515197310357, 329.7868292087846, 353.35977980310776, 332.5496897136253, 289.6615196479017, 286.3327308245695, 244.09969655092107, 348.6291565467633, 349.5195614067643, 341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216, 346.9358991120325, 339.08599848978866, 328.9012170757839, 335.20536903777935, 287.81525703690295, 346.29010813270054, 338.59695733941726, 343.4255263731206, 297.9698632932321, 231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514, 309.9996724612782, 327.4272790568279, 304.89535185746286, 157.9130411025979, 297.0872112212511, 307.85742720578804, 351.436779478661, 329.3753503287022, 332.3362181492664, 291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236, 281.6824997612043, 97.23576997160386, 316.8953532765554, 319.92707096899363, 298.5732348408658, 308.9549807923536, 251.85470487202178, 313.50592851786513, 347.0579986476773, 323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.662708704314778, "mean_inference_ms": 1.242115233399958, "mean_action_processing_ms": 0.20767323675307436, "mean_env_wait_ms": 522.8074558619751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011184215545654297, "StateBufferConnector_ms": 0.006158113479614258, "ViewRequirementAgentConnector_ms": 0.17068743705749512}, "num_episodes": 23, "episode_return_max": 361.7631018733514, "episode_return_min": 80.99189565319165, "episode_return_mean": 309.9360161965014, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43722, "num_agent_steps_trained": 43722, "num_env_steps_sampled": 43722, "num_env_steps_trained": 43722, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.935350835726506, "num_env_steps_trained_throughput_per_sec": 9.935350835726506, "timesteps_total": 43722, "num_env_steps_sampled_lifetime": 43722, "num_agent_steps_sampled_lifetime": 43722, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 43722, "timers": {"training_iteration_time_ms": 100283.861, "restore_workers_time_ms": 0.018, "training_step_time_ms": 100283.81, "sample_time_ms": 98989.703, "load_time_ms": 0.38, "load_throughput": 2697183.268, "learn_time_ms": 1280.297, "learn_throughput": 801.376, "synch_weights_time_ms": 13.12}, "counters": {"num_env_steps_sampled": 43722, "num_env_steps_trained": 43722, "num_agent_steps_sampled": 43722, "num_agent_steps_trained": 43722}, "done": false, "episodes_total": 1175, "training_iteration": 59, "trial_id": "fe178_00003", "date": "2024-08-15_18-17-53", "timestamp": 1723767473, "time_this_iter_s": 103.2714171409607, "time_total_s": 4648.447777032852, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1096.3113148212433, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.911486486486485, "ram_util_percent": 11.581756756756755}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.54932515323162, "cur_kl_coeff": 0.421875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.070646760861079, "policy_loss": -0.009820322428519527, "vf_loss": 8.077689749002456, "vf_explained_var": -0.05253590866923332, "kl": 0.006583211130116788, "entropy": -0.6157661341751616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2760.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 44748, "num_env_steps_trained": 44748, "num_agent_steps_sampled": 44748, "num_agent_steps_trained": 44748}, "sampler_results": {"episode_reward_max": 361.7631018733514, "episode_reward_min": 74.34669391802646, "episode_reward_mean": 305.17234749572754, "episode_len_mean": 48.57, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4857, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216, 346.9358991120325, 339.08599848978866, 328.9012170757839, 335.20536903777935, 287.81525703690295, 346.29010813270054, 338.59695733941726, 343.4255263731206, 297.9698632932321, 231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514, 309.9996724612782, 327.4272790568279, 304.89535185746286, 157.9130411025979, 297.0872112212511, 307.85742720578804, 351.436779478661, 329.3753503287022, 332.3362181492664, 291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236, 281.6824997612043, 97.23576997160386, 316.8953532765554, 319.92707096899363, 298.5732348408658, 308.9549807923536, 251.85470487202178, 313.50592851786513, 347.0579986476773, 323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197, 108.48148799599566, 331.89002816868134, 333.7392617380447, 252.42776958078164, 280.17939867950474, 264.32783485754265, 74.34669391802646, 343.2306513061305, 336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.66866100917395, "mean_inference_ms": 1.2417002534986257, "mean_action_processing_ms": 0.207720349017383, "mean_env_wait_ms": 522.8461680840265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011414766311645508, "StateBufferConnector_ms": 0.006138324737548828, "ViewRequirementAgentConnector_ms": 0.17041444778442383}, "num_episodes": 20, "episode_return_max": 361.7631018733514, "episode_return_min": 74.34669391802646, "episode_return_mean": 305.17234749572754}, "env_runner_results": {"episode_reward_max": 361.7631018733514, "episode_reward_min": 74.34669391802646, "episode_reward_mean": 305.17234749572754, "episode_len_mean": 48.57, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4857, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216, 346.9358991120325, 339.08599848978866, 328.9012170757839, 335.20536903777935, 287.81525703690295, 346.29010813270054, 338.59695733941726, 343.4255263731206, 297.9698632932321, 231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514, 309.9996724612782, 327.4272790568279, 304.89535185746286, 157.9130411025979, 297.0872112212511, 307.85742720578804, 351.436779478661, 329.3753503287022, 332.3362181492664, 291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236, 281.6824997612043, 97.23576997160386, 316.8953532765554, 319.92707096899363, 298.5732348408658, 308.9549807923536, 251.85470487202178, 313.50592851786513, 347.0579986476773, 323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197, 108.48148799599566, 331.89002816868134, 333.7392617380447, 252.42776958078164, 280.17939867950474, 264.32783485754265, 74.34669391802646, 343.2306513061305, 336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.66866100917395, "mean_inference_ms": 1.2417002534986257, "mean_action_processing_ms": 0.207720349017383, "mean_env_wait_ms": 522.8461680840265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011414766311645508, "StateBufferConnector_ms": 0.006138324737548828, "ViewRequirementAgentConnector_ms": 0.17041444778442383}, "num_episodes": 20, "episode_return_max": 361.7631018733514, "episode_return_min": 74.34669391802646, "episode_return_mean": 305.17234749572754}, "episode_reward_max": 361.7631018733514, "episode_reward_min": 74.34669391802646, "episode_reward_mean": 305.17234749572754, "episode_len_mean": 48.57, "episodes_this_iter": 20, "episodes_timesteps_total": 4857, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [341.6532584290731, 324.6923927201155, 304.1188438655796, 316.95240189646023, 268.78402846665176, 315.66653862311387, 303.12375219690733, 289.3944095424078, 321.5299634319666, 338.18567782360077, 312.81109132108026, 269.8232868522976, 347.06065781445034, 317.1169226618396, 356.0882288398216, 346.9358991120325, 339.08599848978866, 328.9012170757839, 335.20536903777935, 287.81525703690295, 346.29010813270054, 338.59695733941726, 343.4255263731206, 297.9698632932321, 231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514, 309.9996724612782, 327.4272790568279, 304.89535185746286, 157.9130411025979, 297.0872112212511, 307.85742720578804, 351.436779478661, 329.3753503287022, 332.3362181492664, 291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236, 281.6824997612043, 97.23576997160386, 316.8953532765554, 319.92707096899363, 298.5732348408658, 308.9549807923536, 251.85470487202178, 313.50592851786513, 347.0579986476773, 323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197, 108.48148799599566, 331.89002816868134, 333.7392617380447, 252.42776958078164, 280.17939867950474, 264.32783485754265, 74.34669391802646, 343.2306513061305, 336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.66866100917395, "mean_inference_ms": 1.2417002534986257, "mean_action_processing_ms": 0.207720349017383, "mean_env_wait_ms": 522.8461680840265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011414766311645508, "StateBufferConnector_ms": 0.006138324737548828, "ViewRequirementAgentConnector_ms": 0.17041444778442383}, "num_episodes": 20, "episode_return_max": 361.7631018733514, "episode_return_min": 74.34669391802646, "episode_return_mean": 305.17234749572754, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44748, "num_agent_steps_trained": 44748, "num_env_steps_sampled": 44748, "num_env_steps_trained": 44748, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.141916388088932, "num_env_steps_trained_throughput_per_sec": 11.141916388088932, "timesteps_total": 44748, "num_env_steps_sampled_lifetime": 44748, "num_agent_steps_sampled_lifetime": 44748, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 44748, "timers": {"training_iteration_time_ms": 98792.475, "restore_workers_time_ms": 0.018, "training_step_time_ms": 98792.425, "sample_time_ms": 97527.548, "load_time_ms": 0.381, "load_throughput": 2694649.909, "learn_time_ms": 1251.086, "learn_throughput": 820.088, "synch_weights_time_ms": 13.106}, "counters": {"num_env_steps_sampled": 44748, "num_env_steps_trained": 44748, "num_agent_steps_sampled": 44748, "num_agent_steps_trained": 44748}, "done": false, "episodes_total": 1195, "training_iteration": 60, "trial_id": "fe178_00003", "date": "2024-08-15_18-19-25", "timestamp": 1723767565, "time_this_iter_s": 92.08830857276917, "time_total_s": 4740.536085605621, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1188.3996233940125, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 27.495419847328243, "ram_util_percent": 11.576335877862597}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.170568271478018, "cur_kl_coeff": 0.421875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.418265851338704, "policy_loss": -0.0066688749628762405, "vf_loss": 8.42317203481992, "vf_explained_var": 0.0006652553876241048, "kl": 0.004178215379701619, "entropy": -0.7030995534112056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3000.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 45774, "num_env_steps_trained": 45774, "num_agent_steps_sampled": 45774, "num_agent_steps_trained": 45774}, "sampler_results": {"episode_reward_max": 361.7631018733514, "episode_reward_min": 63.91062588935526, "episode_reward_mean": 294.1183297539082, "episode_len_mean": 47.19, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 4719, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514, 309.9996724612782, 327.4272790568279, 304.89535185746286, 157.9130411025979, 297.0872112212511, 307.85742720578804, 351.436779478661, 329.3753503287022, 332.3362181492664, 291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236, 281.6824997612043, 97.23576997160386, 316.8953532765554, 319.92707096899363, 298.5732348408658, 308.9549807923536, 251.85470487202178, 313.50592851786513, 347.0579986476773, 323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197, 108.48148799599566, 331.89002816868134, 333.7392617380447, 252.42776958078164, 280.17939867950474, 264.32783485754265, 74.34669391802646, 343.2306513061305, 336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835, 241.68769770584953, 309.31742739276586, 299.4050669353272, 244.30769752260017, 313.5971071822963, 306.55041683216996, 288.9453706228055, 329.9143789304492, 99.53567867696978, 231.9725926194252, 292.6099062077746, 340.46316406791516, 334.8700799753687, 337.5388601862193, 357.54316985785033, 349.94345706029577, 336.60504189490075, 341.6016988121818, 63.91062588935526, 324.81913109393395, 351.8511907264756, 93.00309577174369, 282.79569112795025, 113.03732910156248], "episode_lengths": [50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 41, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 18, 50, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.680308850075319, "mean_inference_ms": 1.2399028062303998, "mean_action_processing_ms": 0.2077391301533275, "mean_env_wait_ms": 522.1214991774566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01118779182434082, "StateBufferConnector_ms": 0.006134510040283203, "ViewRequirementAgentConnector_ms": 0.1700894832611084}, "num_episodes": 24, "episode_return_max": 361.7631018733514, "episode_return_min": 63.91062588935526, "episode_return_mean": 294.1183297539082}, "env_runner_results": {"episode_reward_max": 361.7631018733514, "episode_reward_min": 63.91062588935526, "episode_reward_mean": 294.1183297539082, "episode_len_mean": 47.19, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 4719, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514, 309.9996724612782, 327.4272790568279, 304.89535185746286, 157.9130411025979, 297.0872112212511, 307.85742720578804, 351.436779478661, 329.3753503287022, 332.3362181492664, 291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236, 281.6824997612043, 97.23576997160386, 316.8953532765554, 319.92707096899363, 298.5732348408658, 308.9549807923536, 251.85470487202178, 313.50592851786513, 347.0579986476773, 323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197, 108.48148799599566, 331.89002816868134, 333.7392617380447, 252.42776958078164, 280.17939867950474, 264.32783485754265, 74.34669391802646, 343.2306513061305, 336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835, 241.68769770584953, 309.31742739276586, 299.4050669353272, 244.30769752260017, 313.5971071822963, 306.55041683216996, 288.9453706228055, 329.9143789304492, 99.53567867696978, 231.9725926194252, 292.6099062077746, 340.46316406791516, 334.8700799753687, 337.5388601862193, 357.54316985785033, 349.94345706029577, 336.60504189490075, 341.6016988121818, 63.91062588935526, 324.81913109393395, 351.8511907264756, 93.00309577174369, 282.79569112795025, 113.03732910156248], "episode_lengths": [50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 41, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 18, 50, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.680308850075319, "mean_inference_ms": 1.2399028062303998, "mean_action_processing_ms": 0.2077391301533275, "mean_env_wait_ms": 522.1214991774566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01118779182434082, "StateBufferConnector_ms": 0.006134510040283203, "ViewRequirementAgentConnector_ms": 0.1700894832611084}, "num_episodes": 24, "episode_return_max": 361.7631018733514, "episode_return_min": 63.91062588935526, "episode_return_mean": 294.1183297539082}, "episode_reward_max": 361.7631018733514, "episode_reward_min": 63.91062588935526, "episode_reward_mean": 294.1183297539082, "episode_len_mean": 47.19, "episodes_this_iter": 24, "episodes_timesteps_total": 4719, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [231.80739681725265, 285.809101677496, 312.9846408401971, 318.33611718493256, 80.99189565319165, 330.3927516129906, 316.27172995259997, 351.73621206866045, 340.70496499543657, 322.6119504737656, 311.2016397477841, 286.1546419454403, 361.7631018733514, 309.9996724612782, 327.4272790568279, 304.89535185746286, 157.9130411025979, 297.0872112212511, 307.85742720578804, 351.436779478661, 329.3753503287022, 332.3362181492664, 291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236, 281.6824997612043, 97.23576997160386, 316.8953532765554, 319.92707096899363, 298.5732348408658, 308.9549807923536, 251.85470487202178, 313.50592851786513, 347.0579986476773, 323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197, 108.48148799599566, 331.89002816868134, 333.7392617380447, 252.42776958078164, 280.17939867950474, 264.32783485754265, 74.34669391802646, 343.2306513061305, 336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835, 241.68769770584953, 309.31742739276586, 299.4050669353272, 244.30769752260017, 313.5971071822963, 306.55041683216996, 288.9453706228055, 329.9143789304492, 99.53567867696978, 231.9725926194252, 292.6099062077746, 340.46316406791516, 334.8700799753687, 337.5388601862193, 357.54316985785033, 349.94345706029577, 336.60504189490075, 341.6016988121818, 63.91062588935526, 324.81913109393395, 351.8511907264756, 93.00309577174369, 282.79569112795025, 113.03732910156248], "episode_lengths": [50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 41, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 18, 50, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.680308850075319, "mean_inference_ms": 1.2399028062303998, "mean_action_processing_ms": 0.2077391301533275, "mean_env_wait_ms": 522.1214991774566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01118779182434082, "StateBufferConnector_ms": 0.006134510040283203, "ViewRequirementAgentConnector_ms": 0.1700894832611084}, "num_episodes": 24, "episode_return_max": 361.7631018733514, "episode_return_min": 63.91062588935526, "episode_return_mean": 294.1183297539082, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45774, "num_agent_steps_trained": 45774, "num_env_steps_sampled": 45774, "num_env_steps_trained": 45774, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.300193357869702, "num_env_steps_trained_throughput_per_sec": 10.300193357869702, "timesteps_total": 45774, "num_env_steps_sampled_lifetime": 45774, "num_agent_steps_sampled_lifetime": 45774, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 45774, "timers": {"training_iteration_time_ms": 98018.353, "restore_workers_time_ms": 0.017, "training_step_time_ms": 98018.306, "sample_time_ms": 96754.038, "load_time_ms": 0.373, "load_throughput": 2747465.941, "learn_time_ms": 1250.531, "learn_throughput": 820.451, "synch_weights_time_ms": 13.061}, "counters": {"num_env_steps_sampled": 45774, "num_env_steps_trained": 45774, "num_agent_steps_sampled": 45774, "num_agent_steps_trained": 45774}, "done": false, "episodes_total": 1219, "training_iteration": 61, "trial_id": "fe178_00003", "date": "2024-08-15_18-21-05", "timestamp": 1723767665, "time_this_iter_s": 99.61345839500427, "time_total_s": 4840.149544000626, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1288.0130817890167, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.836619718309862, "ram_util_percent": 11.80281690140845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.146076218287151, "cur_kl_coeff": 0.2109375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.576486035188038, "policy_loss": -0.00794110173980395, "vf_loss": 8.582829002539317, "vf_explained_var": 0.0854191983739535, "kl": 0.007576053493056299, "entropy": -0.7370782406379779, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3240.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 46800, "num_env_steps_trained": 46800, "num_agent_steps_sampled": 46800, "num_agent_steps_trained": 46800}, "sampler_results": {"episode_reward_max": 358.0938417071119, "episode_reward_min": 63.91062588935526, "episode_reward_mean": 291.8343936961594, "episode_len_mean": 46.91, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4691, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236, 281.6824997612043, 97.23576997160386, 316.8953532765554, 319.92707096899363, 298.5732348408658, 308.9549807923536, 251.85470487202178, 313.50592851786513, 347.0579986476773, 323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197, 108.48148799599566, 331.89002816868134, 333.7392617380447, 252.42776958078164, 280.17939867950474, 264.32783485754265, 74.34669391802646, 343.2306513061305, 336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835, 241.68769770584953, 309.31742739276586, 299.4050669353272, 244.30769752260017, 313.5971071822963, 306.55041683216996, 288.9453706228055, 329.9143789304492, 99.53567867696978, 231.9725926194252, 292.6099062077746, 340.46316406791516, 334.8700799753687, 337.5388601862193, 357.54316985785033, 349.94345706029577, 336.60504189490075, 341.6016988121818, 63.91062588935526, 324.81913109393395, 351.8511907264756, 93.00309577174369, 282.79569112795025, 113.03732910156248, 352.5105977885376, 324.26013415778147, 341.1234313171622, 318.07306402839276, 236.88281507763668, 174.13623798103845, 313.83327605656166, 97.80738681102395, 281.8246416481474, 281.9662456755902, 324.5940306554216, 349.47429094194433, 324.74655881686357, 308.0556402029652, 358.0938417071119, 337.64830177187025, 259.7914470072447, 316.62811586292605, 106.32112924508425, 349.73875158611764, 336.8302676500638, 246.360663940572], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 41, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 18, 50, 21, 50, 50, 50, 50, 50, 33, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.688040007889412, "mean_inference_ms": 1.2386177599023092, "mean_action_processing_ms": 0.20763243101118545, "mean_env_wait_ms": 521.3472329741664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011032819747924805, "StateBufferConnector_ms": 0.006145477294921875, "ViewRequirementAgentConnector_ms": 0.1706223487854004}, "num_episodes": 22, "episode_return_max": 358.0938417071119, "episode_return_min": 63.91062588935526, "episode_return_mean": 291.8343936961594}, "env_runner_results": {"episode_reward_max": 358.0938417071119, "episode_reward_min": 63.91062588935526, "episode_reward_mean": 291.8343936961594, "episode_len_mean": 46.91, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4691, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236, 281.6824997612043, 97.23576997160386, 316.8953532765554, 319.92707096899363, 298.5732348408658, 308.9549807923536, 251.85470487202178, 313.50592851786513, 347.0579986476773, 323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197, 108.48148799599566, 331.89002816868134, 333.7392617380447, 252.42776958078164, 280.17939867950474, 264.32783485754265, 74.34669391802646, 343.2306513061305, 336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835, 241.68769770584953, 309.31742739276586, 299.4050669353272, 244.30769752260017, 313.5971071822963, 306.55041683216996, 288.9453706228055, 329.9143789304492, 99.53567867696978, 231.9725926194252, 292.6099062077746, 340.46316406791516, 334.8700799753687, 337.5388601862193, 357.54316985785033, 349.94345706029577, 336.60504189490075, 341.6016988121818, 63.91062588935526, 324.81913109393395, 351.8511907264756, 93.00309577174369, 282.79569112795025, 113.03732910156248, 352.5105977885376, 324.26013415778147, 341.1234313171622, 318.07306402839276, 236.88281507763668, 174.13623798103845, 313.83327605656166, 97.80738681102395, 281.8246416481474, 281.9662456755902, 324.5940306554216, 349.47429094194433, 324.74655881686357, 308.0556402029652, 358.0938417071119, 337.64830177187025, 259.7914470072447, 316.62811586292605, 106.32112924508425, 349.73875158611764, 336.8302676500638, 246.360663940572], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 41, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 18, 50, 21, 50, 50, 50, 50, 50, 33, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.688040007889412, "mean_inference_ms": 1.2386177599023092, "mean_action_processing_ms": 0.20763243101118545, "mean_env_wait_ms": 521.3472329741664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011032819747924805, "StateBufferConnector_ms": 0.006145477294921875, "ViewRequirementAgentConnector_ms": 0.1706223487854004}, "num_episodes": 22, "episode_return_max": 358.0938417071119, "episode_return_min": 63.91062588935526, "episode_return_mean": 291.8343936961594}, "episode_reward_max": 358.0938417071119, "episode_reward_min": 63.91062588935526, "episode_reward_mean": 291.8343936961594, "episode_len_mean": 46.91, "episodes_this_iter": 22, "episodes_timesteps_total": 4691, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [291.18573858241814, 327.2139597587935, 343.5019541848333, 306.46614957371725, 296.85948943590984, 306.61862976980643, 319.79521131982267, 332.1993630537519, 293.39644805916913, 342.55840244151307, 338.1903677718236, 281.6824997612043, 97.23576997160386, 316.8953532765554, 319.92707096899363, 298.5732348408658, 308.9549807923536, 251.85470487202178, 313.50592851786513, 347.0579986476773, 323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197, 108.48148799599566, 331.89002816868134, 333.7392617380447, 252.42776958078164, 280.17939867950474, 264.32783485754265, 74.34669391802646, 343.2306513061305, 336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835, 241.68769770584953, 309.31742739276586, 299.4050669353272, 244.30769752260017, 313.5971071822963, 306.55041683216996, 288.9453706228055, 329.9143789304492, 99.53567867696978, 231.9725926194252, 292.6099062077746, 340.46316406791516, 334.8700799753687, 337.5388601862193, 357.54316985785033, 349.94345706029577, 336.60504189490075, 341.6016988121818, 63.91062588935526, 324.81913109393395, 351.8511907264756, 93.00309577174369, 282.79569112795025, 113.03732910156248, 352.5105977885376, 324.26013415778147, 341.1234313171622, 318.07306402839276, 236.88281507763668, 174.13623798103845, 313.83327605656166, 97.80738681102395, 281.8246416481474, 281.9662456755902, 324.5940306554216, 349.47429094194433, 324.74655881686357, 308.0556402029652, 358.0938417071119, 337.64830177187025, 259.7914470072447, 316.62811586292605, 106.32112924508425, 349.73875158611764, 336.8302676500638, 246.360663940572], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 41, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 18, 50, 21, 50, 50, 50, 50, 50, 33, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.688040007889412, "mean_inference_ms": 1.2386177599023092, "mean_action_processing_ms": 0.20763243101118545, "mean_env_wait_ms": 521.3472329741664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011032819747924805, "StateBufferConnector_ms": 0.006145477294921875, "ViewRequirementAgentConnector_ms": 0.1706223487854004}, "num_episodes": 22, "episode_return_max": 358.0938417071119, "episode_return_min": 63.91062588935526, "episode_return_mean": 291.8343936961594, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46800, "num_agent_steps_trained": 46800, "num_env_steps_sampled": 46800, "num_env_steps_trained": 46800, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.229354888681709, "num_env_steps_trained_throughput_per_sec": 10.229354888681709, "timesteps_total": 46800, "num_env_steps_sampled_lifetime": 46800, "num_agent_steps_sampled_lifetime": 46800, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 46800, "timers": {"training_iteration_time_ms": 98741.016, "restore_workers_time_ms": 0.017, "training_step_time_ms": 98740.971, "sample_time_ms": 97462.915, "load_time_ms": 0.38, "load_throughput": 2702603.72, "learn_time_ms": 1264.364, "learn_throughput": 811.475, "synch_weights_time_ms": 13.017}, "counters": {"num_env_steps_sampled": 46800, "num_env_steps_trained": 46800, "num_agent_steps_sampled": 46800, "num_agent_steps_trained": 46800}, "done": false, "episodes_total": 1241, "training_iteration": 62, "trial_id": "fe178_00003", "date": "2024-08-15_18-22-45", "timestamp": 1723767765, "time_this_iter_s": 100.30347323417664, "time_total_s": 4940.453017234802, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1388.3165550231934, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.15972222222222, "ram_util_percent": 10.881250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.267762714624405, "cur_kl_coeff": 0.2109375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.611947735150656, "policy_loss": 0.003918892925139516, "vf_loss": 8.602042170365651, "vf_explained_var": -0.041761609415213265, "kl": 0.028381455066909086, "entropy": -0.6386798056463401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3480.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 47826, "num_env_steps_trained": 47826, "num_agent_steps_sampled": 47826, "num_agent_steps_trained": 47826}, "sampler_results": {"episode_reward_max": 368.91458260979425, "episode_reward_min": 63.91062588935526, "episode_reward_mean": 291.065913142082, "episode_len_mean": 46.94, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4694, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197, 108.48148799599566, 331.89002816868134, 333.7392617380447, 252.42776958078164, 280.17939867950474, 264.32783485754265, 74.34669391802646, 343.2306513061305, 336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835, 241.68769770584953, 309.31742739276586, 299.4050669353272, 244.30769752260017, 313.5971071822963, 306.55041683216996, 288.9453706228055, 329.9143789304492, 99.53567867696978, 231.9725926194252, 292.6099062077746, 340.46316406791516, 334.8700799753687, 337.5388601862193, 357.54316985785033, 349.94345706029577, 336.60504189490075, 341.6016988121818, 63.91062588935526, 324.81913109393395, 351.8511907264756, 93.00309577174369, 282.79569112795025, 113.03732910156248, 352.5105977885376, 324.26013415778147, 341.1234313171622, 318.07306402839276, 236.88281507763668, 174.13623798103845, 313.83327605656166, 97.80738681102395, 281.8246416481474, 281.9662456755902, 324.5940306554216, 349.47429094194433, 324.74655881686357, 308.0556402029652, 358.0938417071119, 337.64830177187025, 259.7914470072447, 316.62811586292605, 106.32112924508425, 349.73875158611764, 336.8302676500638, 246.360663940572, 248.68524421041218, 290.44555736895603, 248.2122989254678, 333.9506104442293, 327.14583631275127, 307.55628783768645, 323.34569157910926, 356.1545971476475, 333.0403473977016, 261.3915900757963, 305.34125806555323, 323.7493537159789, 335.18037637077634, 287.0776510238361, 306.9236777950294, 311.39931402687773, 287.2505906319219, 368.91458260979425, 97.17897094044213, 303.8813637129943], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 41, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 18, 50, 21, 50, 50, 50, 50, 50, 33, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6956337076598995, "mean_inference_ms": 1.2368529149213832, "mean_action_processing_ms": 0.20757391831949648, "mean_env_wait_ms": 520.6714421345586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010784149169921875, "StateBufferConnector_ms": 0.006133079528808594, "ViewRequirementAgentConnector_ms": 0.17015409469604492}, "num_episodes": 20, "episode_return_max": 368.91458260979425, "episode_return_min": 63.91062588935526, "episode_return_mean": 291.065913142082}, "env_runner_results": {"episode_reward_max": 368.91458260979425, "episode_reward_min": 63.91062588935526, "episode_reward_mean": 291.065913142082, "episode_len_mean": 46.94, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4694, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197, 108.48148799599566, 331.89002816868134, 333.7392617380447, 252.42776958078164, 280.17939867950474, 264.32783485754265, 74.34669391802646, 343.2306513061305, 336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835, 241.68769770584953, 309.31742739276586, 299.4050669353272, 244.30769752260017, 313.5971071822963, 306.55041683216996, 288.9453706228055, 329.9143789304492, 99.53567867696978, 231.9725926194252, 292.6099062077746, 340.46316406791516, 334.8700799753687, 337.5388601862193, 357.54316985785033, 349.94345706029577, 336.60504189490075, 341.6016988121818, 63.91062588935526, 324.81913109393395, 351.8511907264756, 93.00309577174369, 282.79569112795025, 113.03732910156248, 352.5105977885376, 324.26013415778147, 341.1234313171622, 318.07306402839276, 236.88281507763668, 174.13623798103845, 313.83327605656166, 97.80738681102395, 281.8246416481474, 281.9662456755902, 324.5940306554216, 349.47429094194433, 324.74655881686357, 308.0556402029652, 358.0938417071119, 337.64830177187025, 259.7914470072447, 316.62811586292605, 106.32112924508425, 349.73875158611764, 336.8302676500638, 246.360663940572, 248.68524421041218, 290.44555736895603, 248.2122989254678, 333.9506104442293, 327.14583631275127, 307.55628783768645, 323.34569157910926, 356.1545971476475, 333.0403473977016, 261.3915900757963, 305.34125806555323, 323.7493537159789, 335.18037637077634, 287.0776510238361, 306.9236777950294, 311.39931402687773, 287.2505906319219, 368.91458260979425, 97.17897094044213, 303.8813637129943], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 41, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 18, 50, 21, 50, 50, 50, 50, 50, 33, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6956337076598995, "mean_inference_ms": 1.2368529149213832, "mean_action_processing_ms": 0.20757391831949648, "mean_env_wait_ms": 520.6714421345586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010784149169921875, "StateBufferConnector_ms": 0.006133079528808594, "ViewRequirementAgentConnector_ms": 0.17015409469604492}, "num_episodes": 20, "episode_return_max": 368.91458260979425, "episode_return_min": 63.91062588935526, "episode_return_mean": 291.065913142082}, "episode_reward_max": 368.91458260979425, "episode_reward_min": 63.91062588935526, "episode_reward_mean": 291.065913142082, "episode_len_mean": 46.94, "episodes_this_iter": 20, "episodes_timesteps_total": 4694, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [323.54871465185823, 311.62801056924434, 280.553226362152, 335.95122726554644, 310.2059965764552, 270.31548061165086, 344.1966622231345, 313.18623512388456, 312.22628671659, 335.4018060769355, 344.7242937591507, 330.26098247382436, 345.53246235420613, 328.271581587197, 108.48148799599566, 331.89002816868134, 333.7392617380447, 252.42776958078164, 280.17939867950474, 264.32783485754265, 74.34669391802646, 343.2306513061305, 336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835, 241.68769770584953, 309.31742739276586, 299.4050669353272, 244.30769752260017, 313.5971071822963, 306.55041683216996, 288.9453706228055, 329.9143789304492, 99.53567867696978, 231.9725926194252, 292.6099062077746, 340.46316406791516, 334.8700799753687, 337.5388601862193, 357.54316985785033, 349.94345706029577, 336.60504189490075, 341.6016988121818, 63.91062588935526, 324.81913109393395, 351.8511907264756, 93.00309577174369, 282.79569112795025, 113.03732910156248, 352.5105977885376, 324.26013415778147, 341.1234313171622, 318.07306402839276, 236.88281507763668, 174.13623798103845, 313.83327605656166, 97.80738681102395, 281.8246416481474, 281.9662456755902, 324.5940306554216, 349.47429094194433, 324.74655881686357, 308.0556402029652, 358.0938417071119, 337.64830177187025, 259.7914470072447, 316.62811586292605, 106.32112924508425, 349.73875158611764, 336.8302676500638, 246.360663940572, 248.68524421041218, 290.44555736895603, 248.2122989254678, 333.9506104442293, 327.14583631275127, 307.55628783768645, 323.34569157910926, 356.1545971476475, 333.0403473977016, 261.3915900757963, 305.34125806555323, 323.7493537159789, 335.18037637077634, 287.0776510238361, 306.9236777950294, 311.39931402687773, 287.2505906319219, 368.91458260979425, 97.17897094044213, 303.8813637129943], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 41, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 18, 50, 21, 50, 50, 50, 50, 50, 33, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6956337076598995, "mean_inference_ms": 1.2368529149213832, "mean_action_processing_ms": 0.20757391831949648, "mean_env_wait_ms": 520.6714421345586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010784149169921875, "StateBufferConnector_ms": 0.006133079528808594, "ViewRequirementAgentConnector_ms": 0.17015409469604492}, "num_episodes": 20, "episode_return_max": 368.91458260979425, "episode_return_min": 63.91062588935526, "episode_return_mean": 291.065913142082, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47826, "num_agent_steps_trained": 47826, "num_env_steps_sampled": 47826, "num_env_steps_trained": 47826, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.769678671804769, "num_env_steps_trained_throughput_per_sec": 10.769678671804769, "timesteps_total": 47826, "num_env_steps_sampled_lifetime": 47826, "num_agent_steps_sampled_lifetime": 47826, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 47826, "timers": {"training_iteration_time_ms": 98460.334, "restore_workers_time_ms": 0.017, "training_step_time_ms": 98460.29, "sample_time_ms": 97191.237, "load_time_ms": 0.372, "load_throughput": 2755558.625, "learn_time_ms": 1255.491, "learn_throughput": 817.21, "synch_weights_time_ms": 12.904}, "counters": {"num_env_steps_sampled": 47826, "num_env_steps_trained": 47826, "num_agent_steps_sampled": 47826, "num_agent_steps_trained": 47826}, "done": false, "episodes_total": 1261, "training_iteration": 63, "trial_id": "fe178_00003", "date": "2024-08-15_18-24-20", "timestamp": 1723767860, "time_this_iter_s": 95.27121543884277, "time_total_s": 5035.724232673645, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1483.5877704620361, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 26.791176470588233, "ram_util_percent": 11.738970588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.746040703852973, "cur_kl_coeff": 0.31640625, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.534452267487843, "policy_loss": -0.0073626745860868445, "vf_loss": 8.538494129975637, "vf_explained_var": -0.019517896076043446, "kl": 0.01049545881293549, "entropy": -0.6637322010472417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3720.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 48852, "num_env_steps_trained": 48852, "num_agent_steps_sampled": 48852, "num_agent_steps_trained": 48852}, "sampler_results": {"episode_reward_max": 368.91458260979425, "episode_reward_min": 63.91062588935526, "episode_reward_mean": 289.52854137944513, "episode_len_mean": 47.05, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4705, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835, 241.68769770584953, 309.31742739276586, 299.4050669353272, 244.30769752260017, 313.5971071822963, 306.55041683216996, 288.9453706228055, 329.9143789304492, 99.53567867696978, 231.9725926194252, 292.6099062077746, 340.46316406791516, 334.8700799753687, 337.5388601862193, 357.54316985785033, 349.94345706029577, 336.60504189490075, 341.6016988121818, 63.91062588935526, 324.81913109393395, 351.8511907264756, 93.00309577174369, 282.79569112795025, 113.03732910156248, 352.5105977885376, 324.26013415778147, 341.1234313171622, 318.07306402839276, 236.88281507763668, 174.13623798103845, 313.83327605656166, 97.80738681102395, 281.8246416481474, 281.9662456755902, 324.5940306554216, 349.47429094194433, 324.74655881686357, 308.0556402029652, 358.0938417071119, 337.64830177187025, 259.7914470072447, 316.62811586292605, 106.32112924508425, 349.73875158611764, 336.8302676500638, 246.360663940572, 248.68524421041218, 290.44555736895603, 248.2122989254678, 333.9506104442293, 327.14583631275127, 307.55628783768645, 323.34569157910926, 356.1545971476475, 333.0403473977016, 261.3915900757963, 305.34125806555323, 323.7493537159789, 335.18037637077634, 287.0776510238361, 306.9236777950294, 311.39931402687773, 287.2505906319219, 368.91458260979425, 97.17897094044213, 303.8813637129943, 350.1590744902458, 293.75537952444023, 329.4442234462681, 101.94552001953127, 305.7131479383049, 338.28804081230066, 310.06376526502635, 301.64679069089937, 271.32963276999556, 218.17521484446888, 285.88947817383183, 246.59835036828213, 280.86250916979634, 95.98638916015636, 294.5192835531188, 351.5668379495345, 318.9440730871794, 318.3556664777654, 303.57054995900114, 336.13173843793476, 329.59098688105865, 338.3522633137057], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 41, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 18, 50, 21, 50, 50, 50, 50, 50, 33, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.697743439861633, "mean_inference_ms": 1.23574677453646, "mean_action_processing_ms": 0.2073796233606565, "mean_env_wait_ms": 520.0700649956308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01031041145324707, "StateBufferConnector_ms": 0.006156206130981445, "ViewRequirementAgentConnector_ms": 0.1696169376373291}, "num_episodes": 22, "episode_return_max": 368.91458260979425, "episode_return_min": 63.91062588935526, "episode_return_mean": 289.52854137944513}, "env_runner_results": {"episode_reward_max": 368.91458260979425, "episode_reward_min": 63.91062588935526, "episode_reward_mean": 289.52854137944513, "episode_len_mean": 47.05, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4705, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835, 241.68769770584953, 309.31742739276586, 299.4050669353272, 244.30769752260017, 313.5971071822963, 306.55041683216996, 288.9453706228055, 329.9143789304492, 99.53567867696978, 231.9725926194252, 292.6099062077746, 340.46316406791516, 334.8700799753687, 337.5388601862193, 357.54316985785033, 349.94345706029577, 336.60504189490075, 341.6016988121818, 63.91062588935526, 324.81913109393395, 351.8511907264756, 93.00309577174369, 282.79569112795025, 113.03732910156248, 352.5105977885376, 324.26013415778147, 341.1234313171622, 318.07306402839276, 236.88281507763668, 174.13623798103845, 313.83327605656166, 97.80738681102395, 281.8246416481474, 281.9662456755902, 324.5940306554216, 349.47429094194433, 324.74655881686357, 308.0556402029652, 358.0938417071119, 337.64830177187025, 259.7914470072447, 316.62811586292605, 106.32112924508425, 349.73875158611764, 336.8302676500638, 246.360663940572, 248.68524421041218, 290.44555736895603, 248.2122989254678, 333.9506104442293, 327.14583631275127, 307.55628783768645, 323.34569157910926, 356.1545971476475, 333.0403473977016, 261.3915900757963, 305.34125806555323, 323.7493537159789, 335.18037637077634, 287.0776510238361, 306.9236777950294, 311.39931402687773, 287.2505906319219, 368.91458260979425, 97.17897094044213, 303.8813637129943, 350.1590744902458, 293.75537952444023, 329.4442234462681, 101.94552001953127, 305.7131479383049, 338.28804081230066, 310.06376526502635, 301.64679069089937, 271.32963276999556, 218.17521484446888, 285.88947817383183, 246.59835036828213, 280.86250916979634, 95.98638916015636, 294.5192835531188, 351.5668379495345, 318.9440730871794, 318.3556664777654, 303.57054995900114, 336.13173843793476, 329.59098688105865, 338.3522633137057], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 41, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 18, 50, 21, 50, 50, 50, 50, 50, 33, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.697743439861633, "mean_inference_ms": 1.23574677453646, "mean_action_processing_ms": 0.2073796233606565, "mean_env_wait_ms": 520.0700649956308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01031041145324707, "StateBufferConnector_ms": 0.006156206130981445, "ViewRequirementAgentConnector_ms": 0.1696169376373291}, "num_episodes": 22, "episode_return_max": 368.91458260979425, "episode_return_min": 63.91062588935526, "episode_return_mean": 289.52854137944513}, "episode_reward_max": 368.91458260979425, "episode_reward_min": 63.91062588935526, "episode_reward_mean": 289.52854137944513, "episode_len_mean": 47.05, "episodes_this_iter": 22, "episodes_timesteps_total": 4705, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [336.57932648242655, 303.39503453247, 309.0467037852945, 278.8516577763696, 290.09961251796705, 346.1102322850829, 293.42654577558807, 330.83367929387055, 283.8935392318367, 332.28599103458856, 318.6816546904805, 325.4092978884835, 241.68769770584953, 309.31742739276586, 299.4050669353272, 244.30769752260017, 313.5971071822963, 306.55041683216996, 288.9453706228055, 329.9143789304492, 99.53567867696978, 231.9725926194252, 292.6099062077746, 340.46316406791516, 334.8700799753687, 337.5388601862193, 357.54316985785033, 349.94345706029577, 336.60504189490075, 341.6016988121818, 63.91062588935526, 324.81913109393395, 351.8511907264756, 93.00309577174369, 282.79569112795025, 113.03732910156248, 352.5105977885376, 324.26013415778147, 341.1234313171622, 318.07306402839276, 236.88281507763668, 174.13623798103845, 313.83327605656166, 97.80738681102395, 281.8246416481474, 281.9662456755902, 324.5940306554216, 349.47429094194433, 324.74655881686357, 308.0556402029652, 358.0938417071119, 337.64830177187025, 259.7914470072447, 316.62811586292605, 106.32112924508425, 349.73875158611764, 336.8302676500638, 246.360663940572, 248.68524421041218, 290.44555736895603, 248.2122989254678, 333.9506104442293, 327.14583631275127, 307.55628783768645, 323.34569157910926, 356.1545971476475, 333.0403473977016, 261.3915900757963, 305.34125806555323, 323.7493537159789, 335.18037637077634, 287.0776510238361, 306.9236777950294, 311.39931402687773, 287.2505906319219, 368.91458260979425, 97.17897094044213, 303.8813637129943, 350.1590744902458, 293.75537952444023, 329.4442234462681, 101.94552001953127, 305.7131479383049, 338.28804081230066, 310.06376526502635, 301.64679069089937, 271.32963276999556, 218.17521484446888, 285.88947817383183, 246.59835036828213, 280.86250916979634, 95.98638916015636, 294.5192835531188, 351.5668379495345, 318.9440730871794, 318.3556664777654, 303.57054995900114, 336.13173843793476, 329.59098688105865, 338.3522633137057], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 41, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 18, 50, 21, 50, 50, 50, 50, 50, 33, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.697743439861633, "mean_inference_ms": 1.23574677453646, "mean_action_processing_ms": 0.2073796233606565, "mean_env_wait_ms": 520.0700649956308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01031041145324707, "StateBufferConnector_ms": 0.006156206130981445, "ViewRequirementAgentConnector_ms": 0.1696169376373291}, "num_episodes": 22, "episode_return_max": 368.91458260979425, "episode_return_min": 63.91062588935526, "episode_return_mean": 289.52854137944513, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48852, "num_agent_steps_trained": 48852, "num_env_steps_sampled": 48852, "num_env_steps_trained": 48852, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.946851762692349, "num_env_steps_trained_throughput_per_sec": 9.946851762692349, "timesteps_total": 48852, "num_env_steps_sampled_lifetime": 48852, "num_agent_steps_sampled_lifetime": 48852, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 48852, "timers": {"training_iteration_time_ms": 98560.034, "restore_workers_time_ms": 0.015, "training_step_time_ms": 98559.992, "sample_time_ms": 97291.374, "load_time_ms": 0.36, "load_throughput": 2847641.546, "learn_time_ms": 1255.136, "learn_throughput": 817.442, "synch_weights_time_ms": 12.844}, "counters": {"num_env_steps_sampled": 48852, "num_env_steps_trained": 48852, "num_agent_steps_sampled": 48852, "num_agent_steps_trained": 48852}, "done": false, "episodes_total": 1283, "training_iteration": 64, "trial_id": "fe178_00003", "date": "2024-08-15_18-26-03", "timestamp": 1723767963, "time_this_iter_s": 103.15159463882446, "time_total_s": 5138.8758273124695, "pid": 54209, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.18432, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629057756431639, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1586.7393651008606, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.58231292517007, "ram_util_percent": 11.859863945578232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58.96656061410904, "cur_kl_coeff": 0.11262702941894531, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.380296047528585, "policy_loss": 0.012682506240283449, "vf_loss": 9.36193695863088, "vf_explained_var": 0.02079173078139623, "kl": 0.05040104031796059, "entropy": -1.3871465831995011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 47388, "num_env_steps_trained": 47388, "num_agent_steps_sampled": 47388, "num_agent_steps_trained": 47388}, "sampler_results": {"episode_reward_max": 358.77215576171875, "episode_reward_min": 329.8103467650762, "episode_reward_mean": 339.3625764416244, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.136281908700292, "mean_inference_ms": 1.2602230598186623, "mean_action_processing_ms": 0.20801244567637242, "mean_env_wait_ms": 543.565322612894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009079774220784506, "StateBufferConnector_ms": 0.005817413330078125, "ViewRequirementAgentConnector_ms": 0.16133387883504233}, "num_episodes": 6, "episode_return_max": 358.77215576171875, "episode_return_min": 329.8103467650762, "episode_return_mean": 339.3625764416244}, "env_runner_results": {"episode_reward_max": 358.77215576171875, "episode_reward_min": 329.8103467650762, "episode_reward_mean": 339.3625764416244, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.136281908700292, "mean_inference_ms": 1.2602230598186623, "mean_action_processing_ms": 0.20801244567637242, "mean_env_wait_ms": 543.565322612894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009079774220784506, "StateBufferConnector_ms": 0.005817413330078125, "ViewRequirementAgentConnector_ms": 0.16133387883504233}, "num_episodes": 6, "episode_return_max": 358.77215576171875, "episode_return_min": 329.8103467650762, "episode_return_mean": 339.3625764416244}, "episode_reward_max": 358.77215576171875, "episode_reward_min": 329.8103467650762, "episode_reward_mean": 339.3625764416244, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.136281908700292, "mean_inference_ms": 1.2602230598186623, "mean_action_processing_ms": 0.20801244567637242, "mean_env_wait_ms": 543.565322612894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009079774220784506, "StateBufferConnector_ms": 0.005817413330078125, "ViewRequirementAgentConnector_ms": 0.16133387883504233}, "num_episodes": 6, "episode_return_max": 358.77215576171875, "episode_return_min": 329.8103467650762, "episode_return_mean": 339.3625764416244, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47388, "num_agent_steps_trained": 47388, "num_env_steps_sampled": 47388, "num_env_steps_trained": 47388, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.416506883802894, "num_env_steps_trained_throughput_per_sec": 9.416506883802894, "timesteps_total": 47388, "num_env_steps_sampled_lifetime": 47388, "num_agent_steps_sampled_lifetime": 47388, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 47388, "timers": {"training_iteration_time_ms": 54797.399, "restore_workers_time_ms": 0.015, "training_step_time_ms": 54797.35, "sample_time_ms": 50095.66, "load_time_ms": 0.813, "load_throughput": 635053.07, "learn_time_ms": 4687.042, "learn_throughput": 110.091, "synch_weights_time_ms": 13.336}, "counters": {"num_env_steps_sampled": 47388, "num_env_steps_trained": 47388, "num_agent_steps_sampled": 47388, "num_agent_steps_trained": 47388}, "done": false, "episodes_total": 1226, "training_iteration": 76, "trial_id": "fe178_00003", "date": "2024-08-15_18-27-16", "timestamp": 1723768036, "time_this_iter_s": 54.80084776878357, "time_total_s": 4995.641968250275, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 54.80084776878357, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 24.306329113924054, "ram_util_percent": 11.570886075949367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.76619738141696, "cur_kl_coeff": 0.16894054412841797, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.575482328732809, "policy_loss": 0.004998905557052543, "vf_loss": 9.56422967116038, "vf_explained_var": 0.007814923922220865, "kl": 0.03701666901373149, "entropy": -1.3462869971990585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 47904, "num_env_steps_trained": 47904, "num_agent_steps_sampled": 47904, "num_agent_steps_trained": 47904}, "sampler_results": {"episode_reward_max": 358.77215576171875, "episode_reward_min": 257.02805389731117, "episode_reward_mean": 331.260764321363, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.858531401985126, "mean_inference_ms": 1.257124927789326, "mean_action_processing_ms": 0.20787230464399198, "mean_env_wait_ms": 534.9849119320097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01188251707288954, "StateBufferConnector_ms": 0.005952517191569011, "ViewRequirementAgentConnector_ms": 0.1623140441046821}, "num_episodes": 12, "episode_return_max": 358.77215576171875, "episode_return_min": 257.02805389731117, "episode_return_mean": 331.260764321363}, "env_runner_results": {"episode_reward_max": 358.77215576171875, "episode_reward_min": 257.02805389731117, "episode_reward_mean": 331.260764321363, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.858531401985126, "mean_inference_ms": 1.257124927789326, "mean_action_processing_ms": 0.20787230464399198, "mean_env_wait_ms": 534.9849119320097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01188251707288954, "StateBufferConnector_ms": 0.005952517191569011, "ViewRequirementAgentConnector_ms": 0.1623140441046821}, "num_episodes": 12, "episode_return_max": 358.77215576171875, "episode_return_min": 257.02805389731117, "episode_return_mean": 331.260764321363}, "episode_reward_max": 358.77215576171875, "episode_reward_min": 257.02805389731117, "episode_reward_mean": 331.260764321363, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.858531401985126, "mean_inference_ms": 1.257124927789326, "mean_action_processing_ms": 0.20787230464399198, "mean_env_wait_ms": 534.9849119320097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01188251707288954, "StateBufferConnector_ms": 0.005952517191569011, "ViewRequirementAgentConnector_ms": 0.1623140441046821}, "num_episodes": 12, "episode_return_max": 358.77215576171875, "episode_return_min": 257.02805389731117, "episode_return_mean": 331.260764321363, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47904, "num_agent_steps_trained": 47904, "num_env_steps_sampled": 47904, "num_env_steps_trained": 47904, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.601020000851506, "num_env_steps_trained_throughput_per_sec": 10.601020000851506, "timesteps_total": 47904, "num_env_steps_sampled_lifetime": 47904, "num_agent_steps_sampled_lifetime": 47904, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 47904, "timers": {"training_iteration_time_ms": 51735.985, "restore_workers_time_ms": 0.016, "training_step_time_ms": 51735.933, "sample_time_ms": 49053.581, "load_time_ms": 0.565, "load_throughput": 913190.238, "learn_time_ms": 2668.051, "learn_throughput": 193.4, "synch_weights_time_ms": 13.356}, "counters": {"num_env_steps_sampled": 47904, "num_env_steps_trained": 47904, "num_agent_steps_sampled": 47904, "num_agent_steps_trained": 47904}, "done": false, "episodes_total": 1238, "training_iteration": 77, "trial_id": "fe178_00003", "date": "2024-08-15_18-28-05", "timestamp": 1723768085, "time_this_iter_s": 48.677547454833984, "time_total_s": 5044.319515705109, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 103.47839522361755, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.550724637681157, "ram_util_percent": 11.624637681159422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.35116796096166, "cur_kl_coeff": 0.25341081619262695, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.893470764160156, "policy_loss": -0.0033944022143259645, "vf_loss": 9.892903367678324, "vf_explained_var": 0.02000842293103536, "kl": 0.01563400429804994, "entropy": -1.5584419071674347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 48420, "num_env_steps_trained": 48420, "num_agent_steps_sampled": 48420, "num_agent_steps_trained": 48420}, "sampler_results": {"episode_reward_max": 362.7671860902566, "episode_reward_min": 257.02805389731117, "episode_reward_mean": 337.06856640657605, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.142525300002793, "mean_inference_ms": 1.2563425078630033, "mean_action_processing_ms": 0.2078090357305991, "mean_env_wait_ms": 536.7849492944937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012494723002115885, "StateBufferConnector_ms": 0.0060939788818359375, "ViewRequirementAgentConnector_ms": 0.16433000564575195}, "num_episodes": 12, "episode_return_max": 362.7671860902566, "episode_return_min": 257.02805389731117, "episode_return_mean": 337.06856640657605}, "env_runner_results": {"episode_reward_max": 362.7671860902566, "episode_reward_min": 257.02805389731117, "episode_reward_mean": 337.06856640657605, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.142525300002793, "mean_inference_ms": 1.2563425078630033, "mean_action_processing_ms": 0.2078090357305991, "mean_env_wait_ms": 536.7849492944937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012494723002115885, "StateBufferConnector_ms": 0.0060939788818359375, "ViewRequirementAgentConnector_ms": 0.16433000564575195}, "num_episodes": 12, "episode_return_max": 362.7671860902566, "episode_return_min": 257.02805389731117, "episode_return_mean": 337.06856640657605}, "episode_reward_max": 362.7671860902566, "episode_reward_min": 257.02805389731117, "episode_reward_mean": 337.06856640657605, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.142525300002793, "mean_inference_ms": 1.2563425078630033, "mean_action_processing_ms": 0.2078090357305991, "mean_env_wait_ms": 536.7849492944937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012494723002115885, "StateBufferConnector_ms": 0.0060939788818359375, "ViewRequirementAgentConnector_ms": 0.16433000564575195}, "num_episodes": 12, "episode_return_max": 362.7671860902566, "episode_return_min": 257.02805389731117, "episode_return_mean": 337.06856640657605, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48420, "num_agent_steps_trained": 48420, "num_env_steps_sampled": 48420, "num_env_steps_trained": 48420, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.920854117420289, "num_env_steps_trained_throughput_per_sec": 9.920854117420289, "timesteps_total": 48420, "num_env_steps_sampled_lifetime": 48420, "num_agent_steps_sampled_lifetime": 48420, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 48420, "timers": {"training_iteration_time_ms": 51827.878, "restore_workers_time_ms": 0.018, "training_step_time_ms": 51827.822, "sample_time_ms": 49820.256, "load_time_ms": 0.488, "load_throughput": 1058145.794, "learn_time_ms": 1993.498, "learn_throughput": 258.842, "synch_weights_time_ms": 13.247}, "counters": {"num_env_steps_sampled": 48420, "num_env_steps_trained": 48420, "num_agent_steps_sampled": 48420, "num_agent_steps_trained": 48420}, "done": false, "episodes_total": 1250, "training_iteration": 78, "trial_id": "fe178_00003", "date": "2024-08-15_18-28-57", "timestamp": 1723768137, "time_this_iter_s": 52.014628648757935, "time_total_s": 5096.334144353867, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 155.4930238723755, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.689333333333334, "ram_util_percent": 11.70266666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.617748669783275, "cur_kl_coeff": 0.25341081619262695, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.264941628774007, "policy_loss": 0.01321107658247153, "vf_loss": 9.242485320568084, "vf_explained_var": 0.009636518359184266, "kl": 0.03648290832352609, "entropy": -0.9593066001931826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 48936, "num_env_steps_trained": 48936, "num_agent_steps_sampled": 48936, "num_agent_steps_trained": 48936}, "sampler_results": {"episode_reward_max": 362.7671860902566, "episode_reward_min": 257.02805389731117, "episode_reward_mean": 334.80015233747145, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.152038741065592, "mean_inference_ms": 1.2553833706392992, "mean_action_processing_ms": 0.2077479810231031, "mean_env_wait_ms": 538.7131960235531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013218323389689127, "StateBufferConnector_ms": 0.006071726481119792, "ViewRequirementAgentConnector_ms": 0.1643187469906277}, "num_episodes": 6, "episode_return_max": 362.7671860902566, "episode_return_min": 257.02805389731117, "episode_return_mean": 334.80015233747145}, "env_runner_results": {"episode_reward_max": 362.7671860902566, "episode_reward_min": 257.02805389731117, "episode_reward_mean": 334.80015233747145, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.152038741065592, "mean_inference_ms": 1.2553833706392992, "mean_action_processing_ms": 0.2077479810231031, "mean_env_wait_ms": 538.7131960235531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013218323389689127, "StateBufferConnector_ms": 0.006071726481119792, "ViewRequirementAgentConnector_ms": 0.1643187469906277}, "num_episodes": 6, "episode_return_max": 362.7671860902566, "episode_return_min": 257.02805389731117, "episode_return_mean": 334.80015233747145}, "episode_reward_max": 362.7671860902566, "episode_reward_min": 257.02805389731117, "episode_reward_mean": 334.80015233747145, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.152038741065592, "mean_inference_ms": 1.2553833706392992, "mean_action_processing_ms": 0.2077479810231031, "mean_env_wait_ms": 538.7131960235531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013218323389689127, "StateBufferConnector_ms": 0.006071726481119792, "ViewRequirementAgentConnector_ms": 0.1643187469906277}, "num_episodes": 6, "episode_return_max": 362.7671860902566, "episode_return_min": 257.02805389731117, "episode_return_mean": 334.80015233747145, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48936, "num_agent_steps_trained": 48936, "num_env_steps_sampled": 48936, "num_env_steps_trained": 48936, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.668249802144176, "num_env_steps_trained_throughput_per_sec": 9.668249802144176, "timesteps_total": 48936, "num_env_steps_sampled_lifetime": 48936, "num_agent_steps_sampled_lifetime": 48936, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 48936, "timers": {"training_iteration_time_ms": 52213.555, "restore_workers_time_ms": 0.02, "training_step_time_ms": 52213.495, "sample_time_ms": 50548.673, "load_time_ms": 0.444, "load_throughput": 1162643.494, "learn_time_ms": 1650.832, "learn_throughput": 312.57, "synch_weights_time_ms": 13.236}, "counters": {"num_env_steps_sampled": 48936, "num_env_steps_trained": 48936, "num_agent_steps_sampled": 48936, "num_agent_steps_trained": 48936}, "done": false, "episodes_total": 1256, "training_iteration": 79, "trial_id": "fe178_00003", "date": "2024-08-15_18-29-50", "timestamp": 1723768190, "time_this_iter_s": 53.37357831001282, "time_total_s": 5149.707722663879, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 208.8666021823883, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 23.87733333333333, "ram_util_percent": 11.76933333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.074976738293966, "cur_kl_coeff": 0.38011622428894043, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.449921592076619, "policy_loss": -0.0018677082688858112, "vf_loss": 9.44715214172999, "vf_explained_var": 0.002148917317390442, "kl": 0.012199233215993045, "entropy": -1.2842548459768295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 49452, "num_env_steps_trained": 49452, "num_agent_steps_sampled": 49452, "num_agent_steps_trained": 49452}, "sampler_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 257.02805389731117, "episode_reward_mean": 334.0185526346493, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.216616446464305, "mean_inference_ms": 1.2537806084505396, "mean_action_processing_ms": 0.2075947220928915, "mean_env_wait_ms": 545.7657086172694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013257066408793131, "StateBufferConnector_ms": 0.00611493984858195, "ViewRequirementAgentConnector_ms": 0.16554445028305054}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 257.02805389731117, "episode_return_mean": 334.0185526346493}, "env_runner_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 257.02805389731117, "episode_reward_mean": 334.0185526346493, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.216616446464305, "mean_inference_ms": 1.2537806084505396, "mean_action_processing_ms": 0.2075947220928915, "mean_env_wait_ms": 545.7657086172694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013257066408793131, "StateBufferConnector_ms": 0.00611493984858195, "ViewRequirementAgentConnector_ms": 0.16554445028305054}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 257.02805389731117, "episode_return_mean": 334.0185526346493}, "episode_reward_max": 365.47729461943266, "episode_reward_min": 257.02805389731117, "episode_reward_mean": 334.0185526346493, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.216616446464305, "mean_inference_ms": 1.2537806084505396, "mean_action_processing_ms": 0.2075947220928915, "mean_env_wait_ms": 545.7657086172694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013257066408793131, "StateBufferConnector_ms": 0.00611493984858195, "ViewRequirementAgentConnector_ms": 0.16554445028305054}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 257.02805389731117, "episode_return_mean": 334.0185526346493, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49452, "num_agent_steps_trained": 49452, "num_env_steps_sampled": 49452, "num_env_steps_trained": 49452, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.360402464837852, "num_env_steps_trained_throughput_per_sec": 8.360402464837852, "timesteps_total": 49452, "num_env_steps_sampled_lifetime": 49452, "num_agent_steps_sampled_lifetime": 49452, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 49452, "timers": {"training_iteration_time_ms": 54114.749, "restore_workers_time_ms": 0.019, "training_step_time_ms": 54114.693, "sample_time_ms": 52650.347, "load_time_ms": 0.417, "load_throughput": 1236155.394, "learn_time_ms": 1450.493, "learn_throughput": 355.741, "synch_weights_time_ms": 13.139}, "counters": {"num_env_steps_sampled": 49452, "num_env_steps_trained": 49452, "num_agent_steps_sampled": 49452, "num_agent_steps_trained": 49452}, "done": false, "episodes_total": 1268, "training_iteration": 80, "trial_id": "fe178_00003", "date": "2024-08-15_18-30-52", "timestamp": 1723768252, "time_this_iter_s": 61.7229220867157, "time_total_s": 5211.430644750595, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 270.589524269104, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.170786516853937, "ram_util_percent": 11.805617977528089}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.941819790999094, "cur_kl_coeff": 0.38011622428894043, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.406963388125101, "policy_loss": 0.0009292240099360546, "vf_loss": 9.40359977086385, "vf_explained_var": 0.07768649607896805, "kl": 0.006404248220561629, "entropy": -1.2262697597344716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 49968, "num_env_steps_trained": 49968, "num_agent_steps_sampled": 49968, "num_agent_steps_trained": 49968}, "sampler_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 328.9190958373168, "episode_len_mean": 49.5, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.284729616130477, "mean_inference_ms": 1.2527293648339513, "mean_action_processing_ms": 0.2075751983961777, "mean_env_wait_ms": 552.1001835293526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01331170399983724, "StateBufferConnector_ms": 0.006166696548461914, "ViewRequirementAgentConnector_ms": 0.16782005627950033}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 328.9190958373168}, "env_runner_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 328.9190958373168, "episode_len_mean": 49.5, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.284729616130477, "mean_inference_ms": 1.2527293648339513, "mean_action_processing_ms": 0.2075751983961777, "mean_env_wait_ms": 552.1001835293526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01331170399983724, "StateBufferConnector_ms": 0.006166696548461914, "ViewRequirementAgentConnector_ms": 0.16782005627950033}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 328.9190958373168}, "episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 328.9190958373168, "episode_len_mean": 49.5, "episodes_this_iter": 12, "episodes_timesteps_total": 2970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.284729616130477, "mean_inference_ms": 1.2527293648339513, "mean_action_processing_ms": 0.2075751983961777, "mean_env_wait_ms": 552.1001835293526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01331170399983724, "StateBufferConnector_ms": 0.006166696548461914, "ViewRequirementAgentConnector_ms": 0.16782005627950033}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 328.9190958373168, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49968, "num_agent_steps_trained": 49968, "num_env_steps_sampled": 49968, "num_env_steps_trained": 49968, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.451389573290399, "num_env_steps_trained_throughput_per_sec": 8.451389573290399, "timesteps_total": 49968, "num_env_steps_sampled_lifetime": 49968, "num_agent_steps_sampled_lifetime": 49968, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 49968, "timers": {"training_iteration_time_ms": 55271.468, "restore_workers_time_ms": 0.019, "training_step_time_ms": 55271.413, "sample_time_ms": 53942.837, "load_time_ms": 0.399, "load_throughput": 1291838.956, "learn_time_ms": 1314.75, "learn_throughput": 392.47, "synch_weights_time_ms": 13.133}, "counters": {"num_env_steps_sampled": 49968, "num_env_steps_trained": 49968, "num_agent_steps_sampled": 49968, "num_agent_steps_trained": 49968}, "done": false, "episodes_total": 1280, "training_iteration": 81, "trial_id": "fe178_00003", "date": "2024-08-15_18-31-53", "timestamp": 1723768313, "time_this_iter_s": 61.058597564697266, "time_total_s": 5272.489242315292, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 331.64812183380127, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.998850574712648, "ram_util_percent": 11.886206896551725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.07455815076828, "cur_kl_coeff": 0.38011622428894043, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.439964429537456, "policy_loss": -0.007702977334459623, "vf_loss": 9.443546811739603, "vf_explained_var": 0.028817408780256907, "kl": 0.010840266836753298, "entropy": -1.4501108050346374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 50484, "num_env_steps_trained": 50484, "num_agent_steps_sampled": 50484, "num_agent_steps_trained": 50484}, "sampler_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 328.81809644268924, "episode_len_mean": 49.583333333333336, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3570, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.348551814285154, "mean_inference_ms": 1.252343829985267, "mean_action_processing_ms": 0.20760739008293372, "mean_env_wait_ms": 554.2307098260454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012746122148301866, "StateBufferConnector_ms": 0.006189611223008897, "ViewRequirementAgentConnector_ms": 0.16817251841227213}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 328.81809644268924}, "env_runner_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 328.81809644268924, "episode_len_mean": 49.583333333333336, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3570, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.348551814285154, "mean_inference_ms": 1.252343829985267, "mean_action_processing_ms": 0.20760739008293372, "mean_env_wait_ms": 554.2307098260454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012746122148301866, "StateBufferConnector_ms": 0.006189611223008897, "ViewRequirementAgentConnector_ms": 0.16817251841227213}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 328.81809644268924}, "episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 328.81809644268924, "episode_len_mean": 49.583333333333336, "episodes_this_iter": 12, "episodes_timesteps_total": 3570, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.348551814285154, "mean_inference_ms": 1.252343829985267, "mean_action_processing_ms": 0.20760739008293372, "mean_env_wait_ms": 554.2307098260454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012746122148301866, "StateBufferConnector_ms": 0.006189611223008897, "ViewRequirementAgentConnector_ms": 0.16817251841227213}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 328.81809644268924, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50484, "num_agent_steps_trained": 50484, "num_env_steps_sampled": 50484, "num_env_steps_trained": 50484, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 11.235672028089075, "num_env_steps_trained_throughput_per_sec": 11.235672028089075, "timesteps_total": 50484, "num_env_steps_sampled_lifetime": 50484, "num_agent_steps_sampled_lifetime": 50484, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 50484, "timers": {"training_iteration_time_ms": 53936.283, "restore_workers_time_ms": 0.02, "training_step_time_ms": 53936.226, "sample_time_ms": 52697.217, "load_time_ms": 0.391, "load_throughput": 1319556.315, "learn_time_ms": 1225.097, "learn_throughput": 421.191, "synch_weights_time_ms": 13.233}, "counters": {"num_env_steps_sampled": 50484, "num_env_steps_trained": 50484, "num_agent_steps_sampled": 50484, "num_agent_steps_trained": 50484}, "done": false, "episodes_total": 1292, "training_iteration": 82, "trial_id": "fe178_00003", "date": "2024-08-15_18-32-39", "timestamp": 1723768359, "time_this_iter_s": 45.92853903770447, "time_total_s": 5318.417781352997, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 377.57666087150574, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 27.767692307692307, "ram_util_percent": 11.355384615384613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.833279236157736, "cur_kl_coeff": 0.38011622428894043, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.60429048538208, "policy_loss": -0.013823487733801206, "vf_loss": 9.613838664690654, "vf_explained_var": 0.11410914162794748, "kl": 0.01124727227385975, "entropy": -1.2611217732230822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 51000, "num_env_steps_trained": 51000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 51000}, "sampler_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 329.2838451540458, "episode_len_mean": 49.620253164556964, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 3920, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.366810937224769, "mean_inference_ms": 1.2524576105566487, "mean_action_processing_ms": 0.20761036201428387, "mean_env_wait_ms": 553.0892968421673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012515164628813538, "StateBufferConnector_ms": 0.006203409991686857, "ViewRequirementAgentConnector_ms": 0.16822965839241125}, "num_episodes": 7, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 329.2838451540458}, "env_runner_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 329.2838451540458, "episode_len_mean": 49.620253164556964, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 3920, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.366810937224769, "mean_inference_ms": 1.2524576105566487, "mean_action_processing_ms": 0.20761036201428387, "mean_env_wait_ms": 553.0892968421673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012515164628813538, "StateBufferConnector_ms": 0.006203409991686857, "ViewRequirementAgentConnector_ms": 0.16822965839241125}, "num_episodes": 7, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 329.2838451540458}, "episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 329.2838451540458, "episode_len_mean": 49.620253164556964, "episodes_this_iter": 7, "episodes_timesteps_total": 3920, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.366810937224769, "mean_inference_ms": 1.2524576105566487, "mean_action_processing_ms": 0.20761036201428387, "mean_env_wait_ms": 553.0892968421673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012515164628813538, "StateBufferConnector_ms": 0.006203409991686857, "ViewRequirementAgentConnector_ms": 0.16822965839241125}, "num_episodes": 7, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 329.2838451540458, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 51000, "num_env_steps_sampled": 51000, "num_env_steps_trained": 51000, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.246028670797596, "num_env_steps_trained_throughput_per_sec": 14.246028670797596, "timesteps_total": 51000, "num_env_steps_sampled_lifetime": 51000, "num_agent_steps_sampled_lifetime": 51000, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 51000, "timers": {"training_iteration_time_ms": 51721.827, "restore_workers_time_ms": 0.019, "training_step_time_ms": 51721.771, "sample_time_ms": 50558.486, "load_time_ms": 0.388, "load_throughput": 1330931.425, "learn_time_ms": 1149.386, "learn_throughput": 448.935, "synch_weights_time_ms": 13.227}, "counters": {"num_env_steps_sampled": 51000, "num_env_steps_trained": 51000, "num_agent_steps_sampled": 51000, "num_agent_steps_trained": 51000}, "done": false, "episodes_total": 1299, "training_iteration": 83, "trial_id": "fe178_00003", "date": "2024-08-15_18-33-15", "timestamp": 1723768395, "time_this_iter_s": 36.22424244880676, "time_total_s": 5354.642023801804, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 413.8009033203125, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 33.5923076923077, "ram_util_percent": 11.682692307692312}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.78237842321396, "cur_kl_coeff": 0.38011622428894043, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.37207194964091, "policy_loss": -0.0017237362762292227, "vf_loss": 9.37298792997996, "vf_explained_var": 0.012359278897444407, "kl": 0.0021250000036791097, "entropy": -1.1929409071803092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 51516, "num_env_steps_trained": 51516, "num_agent_steps_sampled": 51516, "num_agent_steps_trained": 51516}, "sampler_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 326.49230667694206, "episode_len_mean": 49.362637362637365, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4492, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.398358854785237, "mean_inference_ms": 1.2521662139263177, "mean_action_processing_ms": 0.20763879632249715, "mean_env_wait_ms": 551.52658610093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012058216136890454, "StateBufferConnector_ms": 0.0061333834469973385, "ViewRequirementAgentConnector_ms": 0.1671586717878069}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 326.49230667694206}, "env_runner_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 326.49230667694206, "episode_len_mean": 49.362637362637365, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4492, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.398358854785237, "mean_inference_ms": 1.2521662139263177, "mean_action_processing_ms": 0.20763879632249715, "mean_env_wait_ms": 551.52658610093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012058216136890454, "StateBufferConnector_ms": 0.0061333834469973385, "ViewRequirementAgentConnector_ms": 0.1671586717878069}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 326.49230667694206}, "episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 326.49230667694206, "episode_len_mean": 49.362637362637365, "episodes_this_iter": 12, "episodes_timesteps_total": 4492, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.8103467650762, 341.02730393601837, 339.18377079894043, 337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.398358854785237, "mean_inference_ms": 1.2521662139263177, "mean_action_processing_ms": 0.20763879632249715, "mean_env_wait_ms": 551.52658610093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012058216136890454, "StateBufferConnector_ms": 0.0061333834469973385, "ViewRequirementAgentConnector_ms": 0.1671586717878069}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 326.49230667694206, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51516, "num_agent_steps_trained": 51516, "num_env_steps_sampled": 51516, "num_env_steps_trained": 51516, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.357996026014504, "num_env_steps_trained_throughput_per_sec": 10.357996026014504, "timesteps_total": 51516, "num_env_steps_sampled_lifetime": 51516, "num_agent_steps_sampled_lifetime": 51516, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 51516, "timers": {"training_iteration_time_ms": 51510.135, "restore_workers_time_ms": 0.019, "training_step_time_ms": 51510.08, "sample_time_ms": 50410.318, "load_time_ms": 0.38, "load_throughput": 1356525.369, "learn_time_ms": 1085.861, "learn_throughput": 475.199, "synch_weights_time_ms": 13.241}, "counters": {"num_env_steps_sampled": 51516, "num_env_steps_trained": 51516, "num_agent_steps_sampled": 51516, "num_agent_steps_trained": 51516}, "done": false, "episodes_total": 1311, "training_iteration": 84, "trial_id": "fe178_00003", "date": "2024-08-15_18-34-05", "timestamp": 1723768445, "time_this_iter_s": 49.82064175605774, "time_total_s": 5404.462665557861, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 463.62154507637024, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.45774647887324, "ram_util_percent": 11.74084507042253}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 52.975031757354735, "cur_kl_coeff": 0.19005811214447021, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.50080438454946, "policy_loss": 0.013179515895899385, "vf_loss": 9.470393514633178, "vf_explained_var": 0.009186985592047373, "kl": 0.09066365038937599, "entropy": -1.5079059153795242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52032, "num_env_steps_trained": 52032, "num_agent_steps_sampled": 52032, "num_agent_steps_trained": 52032}, "sampler_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 327.092293218772, "episode_len_mean": 49.42, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4942, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.469596953025326, "mean_inference_ms": 1.2513017955190926, "mean_action_processing_ms": 0.20774609256276386, "mean_env_wait_ms": 550.862540126256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011934995651245117, "StateBufferConnector_ms": 0.006127834320068359, "ViewRequirementAgentConnector_ms": 0.16699647903442383}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 327.092293218772}, "env_runner_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 327.092293218772, "episode_len_mean": 49.42, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4942, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.469596953025326, "mean_inference_ms": 1.2513017955190926, "mean_action_processing_ms": 0.20774609256276386, "mean_env_wait_ms": 550.862540126256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011934995651245117, "StateBufferConnector_ms": 0.006127834320068359, "ViewRequirementAgentConnector_ms": 0.16699647903442383}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 327.092293218772}, "episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 327.092293218772, "episode_len_mean": 49.42, "episodes_this_iter": 12, "episodes_timesteps_total": 4942, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [337.4879852777619, 329.8938961102305, 358.77215576171875, 343.00521614509313, 343.9553752467489, 301.61912009256923, 340.3630211661927, 318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.469596953025326, "mean_inference_ms": 1.2513017955190926, "mean_action_processing_ms": 0.20774609256276386, "mean_env_wait_ms": 550.862540126256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011934995651245117, "StateBufferConnector_ms": 0.006127834320068359, "ViewRequirementAgentConnector_ms": 0.16699647903442383}, "num_episodes": 12, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 327.092293218772, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52032, "num_agent_steps_trained": 52032, "num_env_steps_sampled": 52032, "num_env_steps_trained": 52032, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.52578788059579, "num_env_steps_trained_throughput_per_sec": 9.52578788059579, "timesteps_total": 52032, "num_env_steps_sampled_lifetime": 52032, "num_agent_steps_sampled_lifetime": 52032, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 52032, "timers": {"training_iteration_time_ms": 51775.997, "restore_workers_time_ms": 0.018, "training_step_time_ms": 51775.945, "sample_time_ms": 50716.696, "load_time_ms": 0.378, "load_throughput": 1365119.758, "learn_time_ms": 1045.375, "learn_throughput": 493.603, "synch_weights_time_ms": 13.215}, "counters": {"num_env_steps_sampled": 52032, "num_env_steps_trained": 52032, "num_agent_steps_sampled": 52032, "num_agent_steps_trained": 52032}, "done": false, "episodes_total": 1323, "training_iteration": 85, "trial_id": "fe178_00003", "date": "2024-08-15_18-34-59", "timestamp": 1723768499, "time_this_iter_s": 54.17246341705322, "time_total_s": 5458.635128974915, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 517.7940084934235, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.102564102564102, "ram_util_percent": 11.801282051282048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.30782515207927, "cur_kl_coeff": 0.2850871682167053, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.445223522186279, "policy_loss": -0.0019501411821693181, "vf_loss": 9.441063777605693, "vf_explained_var": 0.03012652446826299, "kl": 0.021431640793650824, "entropy": -1.340176091591517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52548, "num_env_steps_trained": 52548, "num_agent_steps_sampled": 52548, "num_agent_steps_trained": 52548}, "sampler_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 327.1116635560196, "episode_len_mean": 49.42, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 4942, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.528878299808967, "mean_inference_ms": 1.250582832203743, "mean_action_processing_ms": 0.20768365224744048, "mean_env_wait_ms": 551.4398162461869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011809825897216797, "StateBufferConnector_ms": 0.0061550140380859375, "ViewRequirementAgentConnector_ms": 0.1670091152191162}, "num_episodes": 7, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 327.1116635560196}, "env_runner_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 327.1116635560196, "episode_len_mean": 49.42, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 4942, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.528878299808967, "mean_inference_ms": 1.250582832203743, "mean_action_processing_ms": 0.20768365224744048, "mean_env_wait_ms": 551.4398162461869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011809825897216797, "StateBufferConnector_ms": 0.0061550140380859375, "ViewRequirementAgentConnector_ms": 0.1670091152191162}, "num_episodes": 7, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 327.1116635560196}, "episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 327.1116635560196, "episode_len_mean": 49.42, "episodes_this_iter": 7, "episodes_timesteps_total": 4942, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [318.99054149229744, 257.02805389731117, 351.35806224547474, 336.554088151651, 356.1557396815449, 354.59500699863406, 293.9560223144062, 328.93805170286373, 304.9113147442723, 354.65243145246365, 356.1206814728221, 352.338859685259, 359.26835937500005, 341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.528878299808967, "mean_inference_ms": 1.250582832203743, "mean_action_processing_ms": 0.20768365224744048, "mean_env_wait_ms": 551.4398162461869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011809825897216797, "StateBufferConnector_ms": 0.0061550140380859375, "ViewRequirementAgentConnector_ms": 0.1670091152191162}, "num_episodes": 7, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 327.1116635560196, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52548, "num_agent_steps_trained": 52548, "num_env_steps_sampled": 52548, "num_env_steps_trained": 52548, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.985732477357152, "num_env_steps_trained_throughput_per_sec": 9.985732477357152, "timesteps_total": 52548, "num_env_steps_sampled_lifetime": 52548, "num_agent_steps_sampled_lifetime": 52548, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 52548, "timers": {"training_iteration_time_ms": 51463.631, "restore_workers_time_ms": 0.018, "training_step_time_ms": 51463.579, "sample_time_ms": 50809.135, "load_time_ms": 0.325, "load_throughput": 1588215.208, "learn_time_ms": 640.584, "learn_throughput": 805.515, "synch_weights_time_ms": 13.279}, "counters": {"num_env_steps_sampled": 52548, "num_env_steps_trained": 52548, "num_agent_steps_sampled": 52548, "num_agent_steps_trained": 52548}, "done": false, "episodes_total": 1330, "training_iteration": 86, "trial_id": "fe178_00003", "date": "2024-08-15_18-35-51", "timestamp": 1723768551, "time_this_iter_s": 51.67763876914978, "time_total_s": 5510.312767744064, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 569.4716472625732, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.599999999999998, "ram_util_percent": 10.920270270270269}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.824889330069222, "cur_kl_coeff": 0.427630752325058, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.928058326244354, "policy_loss": -0.0076460937348504865, "vf_loss": 8.934312816460928, "vf_explained_var": 0.023045775294303895, "kl": 0.0032541419282450202, "entropy": -1.2725441272060076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53064, "num_env_steps_trained": 53064, "num_agent_steps_sampled": 53064, "num_agent_steps_trained": 53064}, "sampler_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 320.7737657248559, "episode_len_mean": 48.61, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 4861, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815, 341.6831195362862, 352.5081363758947, 298.9339056553853, 334.9286126791755, 359.3349251663362, 312.873792466425, 129.58426513671884, 115.58613026021327, 348.48445570141763, 341.7985981380548, 127.49956054687505, 341.8075842808657, 286.0543441539812], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 21, 50, 50, 22, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5688965423365495, "mean_inference_ms": 1.249191346365271, "mean_action_processing_ms": 0.20771619863288251, "mean_env_wait_ms": 552.5345673540506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011332988739013672, "StateBufferConnector_ms": 0.006191253662109375, "ViewRequirementAgentConnector_ms": 0.16769766807556152}, "num_episodes": 13, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 320.7737657248559}, "env_runner_results": {"episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 320.7737657248559, "episode_len_mean": 48.61, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 4861, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815, 341.6831195362862, 352.5081363758947, 298.9339056553853, 334.9286126791755, 359.3349251663362, 312.873792466425, 129.58426513671884, 115.58613026021327, 348.48445570141763, 341.7985981380548, 127.49956054687505, 341.8075842808657, 286.0543441539812], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 21, 50, 50, 22, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5688965423365495, "mean_inference_ms": 1.249191346365271, "mean_action_processing_ms": 0.20771619863288251, "mean_env_wait_ms": 552.5345673540506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011332988739013672, "StateBufferConnector_ms": 0.006191253662109375, "ViewRequirementAgentConnector_ms": 0.16769766807556152}, "num_episodes": 13, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 320.7737657248559}, "episode_reward_max": 365.47729461943266, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 320.7737657248559, "episode_len_mean": 48.61, "episodes_this_iter": 13, "episodes_timesteps_total": 4861, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [341.6469258295601, 338.5175252451822, 334.8687124381314, 357.8271687792295, 326.2431063256108, 360.20096297496053, 362.7671860902566, 317.31749260215804, 315.1684781575863, 332.5337102804094, 334.28084845283297, 309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815, 341.6831195362862, 352.5081363758947, 298.9339056553853, 334.9286126791755, 359.3349251663362, 312.873792466425, 129.58426513671884, 115.58613026021327, 348.48445570141763, 341.7985981380548, 127.49956054687505, 341.8075842808657, 286.0543441539812], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 21, 50, 50, 22, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5688965423365495, "mean_inference_ms": 1.249191346365271, "mean_action_processing_ms": 0.20771619863288251, "mean_env_wait_ms": 552.5345673540506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011332988739013672, "StateBufferConnector_ms": 0.006191253662109375, "ViewRequirementAgentConnector_ms": 0.16769766807556152}, "num_episodes": 13, "episode_return_max": 365.47729461943266, "episode_return_min": 107.64580078125005, "episode_return_mean": 320.7737657248559, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53064, "num_agent_steps_trained": 53064, "num_env_steps_sampled": 53064, "num_env_steps_trained": 53064, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.429378748169434, "num_env_steps_trained_throughput_per_sec": 10.429378748169434, "timesteps_total": 53064, "num_env_steps_sampled_lifetime": 53064, "num_agent_steps_sampled_lifetime": 53064, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 53064, "timers": {"training_iteration_time_ms": 51543.737, "restore_workers_time_ms": 0.018, "training_step_time_ms": 51543.687, "sample_time_ms": 50884.822, "load_time_ms": 0.327, "load_throughput": 1579867.774, "learn_time_ms": 644.957, "learn_throughput": 800.053, "synch_weights_time_ms": 13.323}, "counters": {"num_env_steps_sampled": 53064, "num_env_steps_trained": 53064, "num_agent_steps_sampled": 53064, "num_agent_steps_trained": 53064}, "done": false, "episodes_total": 1343, "training_iteration": 87, "trial_id": "fe178_00003", "date": "2024-08-15_18-36-40", "timestamp": 1723768600, "time_this_iter_s": 49.479294776916504, "time_total_s": 5559.792062520981, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 618.9509420394897, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.81, "ram_util_percent": 11.269999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.17863235870997, "cur_kl_coeff": 0.213815376162529, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.756571714083353, "policy_loss": -0.00518719640870889, "vf_loss": 9.75749630133311, "vf_explained_var": 0.09967317233482996, "kl": 0.019936281380557978, "entropy": -1.6427700370550156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53580, "num_env_steps_trained": 53580, "num_agent_steps_sampled": 53580, "num_agent_steps_trained": 53580}, "sampler_results": {"episode_reward_max": 366.3756775563769, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 320.62344495861447, "episode_len_mean": 48.61, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4861, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815, 341.6831195362862, 352.5081363758947, 298.9339056553853, 334.9286126791755, 359.3349251663362, 312.873792466425, 129.58426513671884, 115.58613026021327, 348.48445570141763, 341.7985981380548, 127.49956054687505, 341.8075842808657, 286.0543441539812, 308.35780620713524, 337.53278041130545, 336.91368597885634, 331.7591737713213, 330.5579883399656, 366.3756775563769, 335.0767099205291, 300.8191684869493, 357.84273688005663, 351.11558722818353, 349.9887257711004], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 21, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.595780948874728, "mean_inference_ms": 1.249099282442547, "mean_action_processing_ms": 0.2076645450588687, "mean_env_wait_ms": 551.706768247262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010870218276977539, "StateBufferConnector_ms": 0.006196022033691406, "ViewRequirementAgentConnector_ms": 0.16801881790161133}, "num_episodes": 11, "episode_return_max": 366.3756775563769, "episode_return_min": 107.64580078125005, "episode_return_mean": 320.62344495861447}, "env_runner_results": {"episode_reward_max": 366.3756775563769, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 320.62344495861447, "episode_len_mean": 48.61, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4861, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815, 341.6831195362862, 352.5081363758947, 298.9339056553853, 334.9286126791755, 359.3349251663362, 312.873792466425, 129.58426513671884, 115.58613026021327, 348.48445570141763, 341.7985981380548, 127.49956054687505, 341.8075842808657, 286.0543441539812, 308.35780620713524, 337.53278041130545, 336.91368597885634, 331.7591737713213, 330.5579883399656, 366.3756775563769, 335.0767099205291, 300.8191684869493, 357.84273688005663, 351.11558722818353, 349.9887257711004], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 21, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.595780948874728, "mean_inference_ms": 1.249099282442547, "mean_action_processing_ms": 0.2076645450588687, "mean_env_wait_ms": 551.706768247262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010870218276977539, "StateBufferConnector_ms": 0.006196022033691406, "ViewRequirementAgentConnector_ms": 0.16801881790161133}, "num_episodes": 11, "episode_return_max": 366.3756775563769, "episode_return_min": 107.64580078125005, "episode_return_mean": 320.62344495861447}, "episode_reward_max": 366.3756775563769, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 320.62344495861447, "episode_len_mean": 48.61, "episodes_this_iter": 11, "episodes_timesteps_total": 4861, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [309.58858586562957, 331.8593765930744, 329.9768333838634, 341.7932389987245, 280.4731137983628, 365.47729461943266, 349.47064153169634, 316.8586545465809, 305.73456381533794, 353.03972325704433, 329.53772017571714, 348.7880522543402, 310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815, 341.6831195362862, 352.5081363758947, 298.9339056553853, 334.9286126791755, 359.3349251663362, 312.873792466425, 129.58426513671884, 115.58613026021327, 348.48445570141763, 341.7985981380548, 127.49956054687505, 341.8075842808657, 286.0543441539812, 308.35780620713524, 337.53278041130545, 336.91368597885634, 331.7591737713213, 330.5579883399656, 366.3756775563769, 335.0767099205291, 300.8191684869493, 357.84273688005663, 351.11558722818353, 349.9887257711004], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 21, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.595780948874728, "mean_inference_ms": 1.249099282442547, "mean_action_processing_ms": 0.2076645450588687, "mean_env_wait_ms": 551.706768247262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010870218276977539, "StateBufferConnector_ms": 0.006196022033691406, "ViewRequirementAgentConnector_ms": 0.16801881790161133}, "num_episodes": 11, "episode_return_max": 366.3756775563769, "episode_return_min": 107.64580078125005, "episode_return_mean": 320.62344495861447, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53580, "num_agent_steps_trained": 53580, "num_env_steps_sampled": 53580, "num_env_steps_trained": 53580, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 11.85734960943015, "num_env_steps_trained_throughput_per_sec": 11.85734960943015, "timesteps_total": 53580, "num_env_steps_sampled_lifetime": 53580, "num_agent_steps_sampled_lifetime": 53580, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 53580, "timers": {"training_iteration_time_ms": 50694.303, "restore_workers_time_ms": 0.018, "training_step_time_ms": 50694.255, "sample_time_ms": 50039.199, "load_time_ms": 0.324, "load_throughput": 1590315.867, "learn_time_ms": 641.239, "learn_throughput": 804.692, "synch_weights_time_ms": 13.239}, "counters": {"num_env_steps_sampled": 53580, "num_env_steps_trained": 53580, "num_agent_steps_sampled": 53580, "num_agent_steps_trained": 53580}, "done": false, "episodes_total": 1354, "training_iteration": 88, "trial_id": "fe178_00003", "date": "2024-08-15_18-37-24", "timestamp": 1723768644, "time_this_iter_s": 43.521355390548706, "time_total_s": 5603.3134179115295, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 662.4722974300385, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 29.361290322580647, "ram_util_percent": 11.443548387096772}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.45098893642425, "cur_kl_coeff": 0.213815376162529, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.428423420588176, "policy_loss": 0.0007782168453559279, "vf_loss": 9.421626957257589, "vf_explained_var": 0.07578874379396439, "kl": 0.02814712852341472, "entropy": -1.3984881351391474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "sampler_results": {"episode_reward_max": 366.3756775563769, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 321.0309119656056, "episode_len_mean": 48.61, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4861, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815, 341.6831195362862, 352.5081363758947, 298.9339056553853, 334.9286126791755, 359.3349251663362, 312.873792466425, 129.58426513671884, 115.58613026021327, 348.48445570141763, 341.7985981380548, 127.49956054687505, 341.8075842808657, 286.0543441539812, 308.35780620713524, 337.53278041130545, 336.91368597885634, 331.7591737713213, 330.5579883399656, 366.3756775563769, 335.0767099205291, 300.8191684869493, 357.84273688005663, 351.11558722818353, 349.9887257711004, 344.00283280693907, 315.52989069419806, 253.9612669436371, 312.48758634588177, 357.96982385122806, 336.2150289855142, 347.7924788072411, 361.95610869963593, 353.3935005799965, 355.94464663990493, 324.09238144404503, 339.9989537406857], "episode_lengths": [50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 21, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.636068154862707, "mean_inference_ms": 1.2489871820074205, "mean_action_processing_ms": 0.20775254258688242, "mean_env_wait_ms": 548.5471480788292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010343074798583984, "StateBufferConnector_ms": 0.006192207336425781, "ViewRequirementAgentConnector_ms": 0.16794729232788086}, "num_episodes": 12, "episode_return_max": 366.3756775563769, "episode_return_min": 107.64580078125005, "episode_return_mean": 321.0309119656056}, "env_runner_results": {"episode_reward_max": 366.3756775563769, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 321.0309119656056, "episode_len_mean": 48.61, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4861, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815, 341.6831195362862, 352.5081363758947, 298.9339056553853, 334.9286126791755, 359.3349251663362, 312.873792466425, 129.58426513671884, 115.58613026021327, 348.48445570141763, 341.7985981380548, 127.49956054687505, 341.8075842808657, 286.0543441539812, 308.35780620713524, 337.53278041130545, 336.91368597885634, 331.7591737713213, 330.5579883399656, 366.3756775563769, 335.0767099205291, 300.8191684869493, 357.84273688005663, 351.11558722818353, 349.9887257711004, 344.00283280693907, 315.52989069419806, 253.9612669436371, 312.48758634588177, 357.96982385122806, 336.2150289855142, 347.7924788072411, 361.95610869963593, 353.3935005799965, 355.94464663990493, 324.09238144404503, 339.9989537406857], "episode_lengths": [50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 21, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.636068154862707, "mean_inference_ms": 1.2489871820074205, "mean_action_processing_ms": 0.20775254258688242, "mean_env_wait_ms": 548.5471480788292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010343074798583984, "StateBufferConnector_ms": 0.006192207336425781, "ViewRequirementAgentConnector_ms": 0.16794729232788086}, "num_episodes": 12, "episode_return_max": 366.3756775563769, "episode_return_min": 107.64580078125005, "episode_return_mean": 321.0309119656056}, "episode_reward_max": 366.3756775563769, "episode_reward_min": 107.64580078125005, "episode_reward_mean": 321.0309119656056, "episode_len_mean": 48.61, "episodes_this_iter": 12, "episodes_timesteps_total": 4861, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [310.5857715634204, 348.34943436967245, 309.1942976835065, 107.64580078125005, 276.78354070964593, 336.7357536380701, 338.096997595512, 348.4464466210676, 344.66016381588884, 321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815, 341.6831195362862, 352.5081363758947, 298.9339056553853, 334.9286126791755, 359.3349251663362, 312.873792466425, 129.58426513671884, 115.58613026021327, 348.48445570141763, 341.7985981380548, 127.49956054687505, 341.8075842808657, 286.0543441539812, 308.35780620713524, 337.53278041130545, 336.91368597885634, 331.7591737713213, 330.5579883399656, 366.3756775563769, 335.0767099205291, 300.8191684869493, 357.84273688005663, 351.11558722818353, 349.9887257711004, 344.00283280693907, 315.52989069419806, 253.9612669436371, 312.48758634588177, 357.96982385122806, 336.2150289855142, 347.7924788072411, 361.95610869963593, 353.3935005799965, 355.94464663990493, 324.09238144404503, 339.9989537406857], "episode_lengths": [50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 21, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.636068154862707, "mean_inference_ms": 1.2489871820074205, "mean_action_processing_ms": 0.20775254258688242, "mean_env_wait_ms": 548.5471480788292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010343074798583984, "StateBufferConnector_ms": 0.006192207336425781, "ViewRequirementAgentConnector_ms": 0.16794729232788086}, "num_episodes": 12, "episode_return_max": 366.3756775563769, "episode_return_min": 107.64580078125005, "episode_return_mean": 321.0309119656056, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.626507244708188, "num_env_steps_trained_throughput_per_sec": 9.626507244708188, "timesteps_total": 54096, "num_env_steps_sampled_lifetime": 54096, "num_agent_steps_sampled_lifetime": 54096, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 54096, "timers": {"training_iteration_time_ms": 50717.446, "restore_workers_time_ms": 0.017, "training_step_time_ms": 50717.399, "sample_time_ms": 50058.674, "load_time_ms": 0.326, "load_throughput": 1582871.984, "learn_time_ms": 644.914, "learn_throughput": 800.107, "synch_weights_time_ms": 13.233}, "counters": {"num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "done": false, "episodes_total": 1366, "training_iteration": 89, "trial_id": "fe178_00003", "date": "2024-08-15_18-38-18", "timestamp": 1723768698, "time_this_iter_s": 53.605690479278564, "time_total_s": 5656.919108390808, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 716.077987909317, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.27012987012987, "ram_util_percent": 11.325974025974025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.896698915958405, "cur_kl_coeff": 0.3207230642437935, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.121307571729025, "policy_loss": -0.005187021599461635, "vf_loss": 9.12585293451945, "vf_explained_var": 0.02226429134607315, "kl": 0.002000582146384909, "entropy": -1.110001033047835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 54612, "num_env_steps_trained": 54612, "num_agent_steps_sampled": 54612, "num_agent_steps_trained": 54612}, "sampler_results": {"episode_reward_max": 366.3756775563769, "episode_reward_min": 80.08557919784033, "episode_reward_mean": 319.4151039175329, "episode_len_mean": 48.33, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 4833, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815, 341.6831195362862, 352.5081363758947, 298.9339056553853, 334.9286126791755, 359.3349251663362, 312.873792466425, 129.58426513671884, 115.58613026021327, 348.48445570141763, 341.7985981380548, 127.49956054687505, 341.8075842808657, 286.0543441539812, 308.35780620713524, 337.53278041130545, 336.91368597885634, 331.7591737713213, 330.5579883399656, 366.3756775563769, 335.0767099205291, 300.8191684869493, 357.84273688005663, 351.11558722818353, 349.9887257711004, 344.00283280693907, 315.52989069419806, 253.9612669436371, 312.48758634588177, 357.96982385122806, 336.2150289855142, 347.7924788072411, 361.95610869963593, 353.3935005799965, 355.94464663990493, 324.09238144404503, 339.9989537406857, 320.4305740698936, 360.43913523909873, 343.28150157547947, 152.82685555243802, 335.74602216961046, 325.7652949841049, 304.78287200280215, 80.08557919784033, 335.55956717950926], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 21, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 16, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.655027536562319, "mean_inference_ms": 1.2482899657731847, "mean_action_processing_ms": 0.2077772137752404, "mean_env_wait_ms": 545.3825604533441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01005697250366211, "StateBufferConnector_ms": 0.006168365478515625, "ViewRequirementAgentConnector_ms": 0.16677403450012207}, "num_episodes": 9, "episode_return_max": 366.3756775563769, "episode_return_min": 80.08557919784033, "episode_return_mean": 319.4151039175329}, "env_runner_results": {"episode_reward_max": 366.3756775563769, "episode_reward_min": 80.08557919784033, "episode_reward_mean": 319.4151039175329, "episode_len_mean": 48.33, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 4833, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815, 341.6831195362862, 352.5081363758947, 298.9339056553853, 334.9286126791755, 359.3349251663362, 312.873792466425, 129.58426513671884, 115.58613026021327, 348.48445570141763, 341.7985981380548, 127.49956054687505, 341.8075842808657, 286.0543441539812, 308.35780620713524, 337.53278041130545, 336.91368597885634, 331.7591737713213, 330.5579883399656, 366.3756775563769, 335.0767099205291, 300.8191684869493, 357.84273688005663, 351.11558722818353, 349.9887257711004, 344.00283280693907, 315.52989069419806, 253.9612669436371, 312.48758634588177, 357.96982385122806, 336.2150289855142, 347.7924788072411, 361.95610869963593, 353.3935005799965, 355.94464663990493, 324.09238144404503, 339.9989537406857, 320.4305740698936, 360.43913523909873, 343.28150157547947, 152.82685555243802, 335.74602216961046, 325.7652949841049, 304.78287200280215, 80.08557919784033, 335.55956717950926], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 21, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 16, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.655027536562319, "mean_inference_ms": 1.2482899657731847, "mean_action_processing_ms": 0.2077772137752404, "mean_env_wait_ms": 545.3825604533441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01005697250366211, "StateBufferConnector_ms": 0.006168365478515625, "ViewRequirementAgentConnector_ms": 0.16677403450012207}, "num_episodes": 9, "episode_return_max": 366.3756775563769, "episode_return_min": 80.08557919784033, "episode_return_mean": 319.4151039175329}, "episode_reward_max": 366.3756775563769, "episode_reward_min": 80.08557919784033, "episode_reward_mean": 319.4151039175329, "episode_len_mean": 48.33, "episodes_this_iter": 9, "episodes_timesteps_total": 4833, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [321.50375274629073, 312.08470790820877, 342.85198509177116, 329.4573892229082, 334.79438796172036, 269.3392130048754, 347.1137461501008, 347.84398699133726, 329.90864510863605, 346.1485569650537, 342.66275529515354, 340.57947260623405, 353.37850341796866, 321.7158379086209, 322.84670964276717, 276.15614581910773, 342.0636207247646, 357.3098113450678, 306.0164959994355, 317.82701492070277, 330.0492299195796, 359.0364221993758, 356.8359325405961, 311.44591637123955, 302.414075169263, 118.7261962890625, 345.7522290273992, 320.7631332630594, 291.7829863503952, 334.9791069239481, 325.64816707957647, 324.0467964393949, 332.8798820022479, 331.0034754360869, 334.56007455702553, 334.8200178946449, 345.7883438259576, 340.9287176841184, 354.492808870244, 332.10246588591116, 354.0400439779838, 268.11443664413605, 362.7049560546873, 341.70462447967157, 343.892276735636, 284.70894376283803, 326.78963551318753, 353.18358234113316, 329.7725023658341, 341.4837554455803, 346.57512009887483, 333.89807070378276, 351.37012548300663, 316.4360726897175, 337.4981567382815, 341.6831195362862, 352.5081363758947, 298.9339056553853, 334.9286126791755, 359.3349251663362, 312.873792466425, 129.58426513671884, 115.58613026021327, 348.48445570141763, 341.7985981380548, 127.49956054687505, 341.8075842808657, 286.0543441539812, 308.35780620713524, 337.53278041130545, 336.91368597885634, 331.7591737713213, 330.5579883399656, 366.3756775563769, 335.0767099205291, 300.8191684869493, 357.84273688005663, 351.11558722818353, 349.9887257711004, 344.00283280693907, 315.52989069419806, 253.9612669436371, 312.48758634588177, 357.96982385122806, 336.2150289855142, 347.7924788072411, 361.95610869963593, 353.3935005799965, 355.94464663990493, 324.09238144404503, 339.9989537406857, 320.4305740698936, 360.43913523909873, 343.28150157547947, 152.82685555243802, 335.74602216961046, 325.7652949841049, 304.78287200280215, 80.08557919784033, 335.55956717950926], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 21, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 16, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.655027536562319, "mean_inference_ms": 1.2482899657731847, "mean_action_processing_ms": 0.2077772137752404, "mean_env_wait_ms": 545.3825604533441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01005697250366211, "StateBufferConnector_ms": 0.006168365478515625, "ViewRequirementAgentConnector_ms": 0.16677403450012207}, "num_episodes": 9, "episode_return_max": 366.3756775563769, "episode_return_min": 80.08557919784033, "episode_return_mean": 319.4151039175329, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54612, "num_agent_steps_trained": 54612, "num_env_steps_sampled": 54612, "num_env_steps_trained": 54612, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.568554777427536, "num_env_steps_trained_throughput_per_sec": 9.568554777427536, "timesteps_total": 54612, "num_env_steps_sampled_lifetime": 54612, "num_agent_steps_sampled_lifetime": 54612, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 54612, "timers": {"training_iteration_time_ms": 49938.158, "restore_workers_time_ms": 0.017, "training_step_time_ms": 49938.112, "sample_time_ms": 49283.138, "load_time_ms": 0.326, "load_throughput": 1580906.402, "learn_time_ms": 641.102, "learn_throughput": 804.864, "synch_weights_time_ms": 13.29}, "counters": {"num_env_steps_sampled": 54612, "num_env_steps_trained": 54612, "num_agent_steps_sampled": 54612, "num_agent_steps_trained": 54612}, "done": false, "episodes_total": 1375, "training_iteration": 90, "trial_id": "fe178_00003", "date": "2024-08-15_18-39-11", "timestamp": 1723768751, "time_this_iter_s": 53.930423974990845, "time_total_s": 5710.849532365799, "pid": 45001, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 770.0084118843079, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.376623376623378, "ram_util_percent": 11.336363636363634}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.121791183948517, "cur_kl_coeff": 0.16036153212189674, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.471002729733785, "policy_loss": -0.011130242515355349, "vf_loss": 9.481466166178386, "vf_explained_var": 0.06165504107872645, "kl": 0.004158268862972998, "entropy": -1.4170186986525855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 55128, "num_env_steps_trained": 55128, "num_agent_steps_sampled": 55128, "num_agent_steps_trained": 55128}, "sampler_results": {"episode_reward_max": 357.6504641863548, "episode_reward_min": 99.07479396792797, "episode_reward_mean": 296.578698072632, "episode_len_mean": 44.857142857142854, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 314, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [251.04645695004035, 312.67181600196574, 344.8106201171877, 355.79988064707135, 354.9968546378757, 357.6504641863548, 99.07479396792797], "episode_lengths": [45, 50, 50, 50, 50, 50, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.728442146664574, "mean_inference_ms": 1.2562490253417167, "mean_action_processing_ms": 0.2077076039682272, "mean_env_wait_ms": 467.04887521678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009901182992117745, "StateBufferConnector_ms": 0.005963870457240513, "ViewRequirementAgentConnector_ms": 0.1706838607788086}, "num_episodes": 7, "episode_return_max": 357.6504641863548, "episode_return_min": 99.07479396792797, "episode_return_mean": 296.578698072632}, "env_runner_results": {"episode_reward_max": 357.6504641863548, "episode_reward_min": 99.07479396792797, "episode_reward_mean": 296.578698072632, "episode_len_mean": 44.857142857142854, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 314, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [251.04645695004035, 312.67181600196574, 344.8106201171877, 355.79988064707135, 354.9968546378757, 357.6504641863548, 99.07479396792797], "episode_lengths": [45, 50, 50, 50, 50, 50, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.728442146664574, "mean_inference_ms": 1.2562490253417167, "mean_action_processing_ms": 0.2077076039682272, "mean_env_wait_ms": 467.04887521678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009901182992117745, "StateBufferConnector_ms": 0.005963870457240513, "ViewRequirementAgentConnector_ms": 0.1706838607788086}, "num_episodes": 7, "episode_return_max": 357.6504641863548, "episode_return_min": 99.07479396792797, "episode_return_mean": 296.578698072632}, "episode_reward_max": 357.6504641863548, "episode_reward_min": 99.07479396792797, "episode_reward_mean": 296.578698072632, "episode_len_mean": 44.857142857142854, "episodes_this_iter": 7, "episodes_timesteps_total": 314, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [251.04645695004035, 312.67181600196574, 344.8106201171877, 355.79988064707135, 354.9968546378757, 357.6504641863548, 99.07479396792797], "episode_lengths": [45, 50, 50, 50, 50, 50, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.728442146664574, "mean_inference_ms": 1.2562490253417167, "mean_action_processing_ms": 0.2077076039682272, "mean_env_wait_ms": 467.04887521678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009901182992117745, "StateBufferConnector_ms": 0.005963870457240513, "ViewRequirementAgentConnector_ms": 0.1706838607788086}, "num_episodes": 7, "episode_return_max": 357.6504641863548, "episode_return_min": 99.07479396792797, "episode_return_mean": 296.578698072632, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55128, "num_agent_steps_trained": 55128, "num_env_steps_sampled": 55128, "num_env_steps_trained": 55128, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.804764278794378, "num_env_steps_trained_throughput_per_sec": 10.804764278794378, "timesteps_total": 55128, "num_env_steps_sampled_lifetime": 55128, "num_agent_steps_sampled_lifetime": 55128, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 55128, "timers": {"training_iteration_time_ms": 47756.723, "restore_workers_time_ms": 0.019, "training_step_time_ms": 47756.663, "sample_time_ms": 44207.302, "load_time_ms": 0.795, "load_throughput": 649343.194, "learn_time_ms": 3534.857, "learn_throughput": 145.975, "synch_weights_time_ms": 13.258}, "counters": {"num_env_steps_sampled": 55128, "num_env_steps_trained": 55128, "num_agent_steps_sampled": 55128, "num_agent_steps_trained": 55128}, "done": false, "episodes_total": 1382, "training_iteration": 91, "trial_id": "fe178_00003", "date": "2024-08-15_18-40-21", "timestamp": 1723768821, "time_this_iter_s": 47.75957727432251, "time_total_s": 5758.6091096401215, "pid": 37324, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 47.75957727432251, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.45507246376812, "ram_util_percent": 11.397101449275363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.893444061279297, "cur_kl_coeff": 0.08018076606094837, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.467233347892762, "policy_loss": -0.013524051662534476, "vf_loss": 9.479672718048096, "vf_explained_var": 0.005650537212689718, "kl": 0.013527283602646397, "entropy": -1.3764191205302874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 55644, "num_env_steps_trained": 55644, "num_agent_steps_sampled": 55644, "num_agent_steps_trained": 55644}, "sampler_results": {"episode_reward_max": 357.6504641863548, "episode_reward_min": 99.07479396792797, "episode_reward_mean": 322.3531960328099, "episode_len_mean": 48.10526315789474, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 914, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [251.04645695004035, 312.67181600196574, 344.8106201171877, 355.79988064707135, 354.9968546378757, 357.6504641863548, 99.07479396792797, 352.5433396979418, 339.56661407366664, 354.3835446566358, 347.7732737368974, 299.1723266601564, 342.79308638903757, 324.1123427935573, 330.92774320957284, 338.31566639802907, 348.8729572243474, 313.3079985551624, 356.8909447199599], "episode_lengths": [45, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.11480634999002, "mean_inference_ms": 1.2534428751005233, "mean_action_processing_ms": 0.20656722623821877, "mean_env_wait_ms": 459.92338466915413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011360017876876028, "StateBufferConnector_ms": 0.00602571587813528, "ViewRequirementAgentConnector_ms": 0.16859079662122226}, "num_episodes": 12, "episode_return_max": 357.6504641863548, "episode_return_min": 99.07479396792797, "episode_return_mean": 322.3531960328099}, "env_runner_results": {"episode_reward_max": 357.6504641863548, "episode_reward_min": 99.07479396792797, "episode_reward_mean": 322.3531960328099, "episode_len_mean": 48.10526315789474, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 914, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [251.04645695004035, 312.67181600196574, 344.8106201171877, 355.79988064707135, 354.9968546378757, 357.6504641863548, 99.07479396792797, 352.5433396979418, 339.56661407366664, 354.3835446566358, 347.7732737368974, 299.1723266601564, 342.79308638903757, 324.1123427935573, 330.92774320957284, 338.31566639802907, 348.8729572243474, 313.3079985551624, 356.8909447199599], "episode_lengths": [45, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.11480634999002, "mean_inference_ms": 1.2534428751005233, "mean_action_processing_ms": 0.20656722623821877, "mean_env_wait_ms": 459.92338466915413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011360017876876028, "StateBufferConnector_ms": 0.00602571587813528, "ViewRequirementAgentConnector_ms": 0.16859079662122226}, "num_episodes": 12, "episode_return_max": 357.6504641863548, "episode_return_min": 99.07479396792797, "episode_return_mean": 322.3531960328099}, "episode_reward_max": 357.6504641863548, "episode_reward_min": 99.07479396792797, "episode_reward_mean": 322.3531960328099, "episode_len_mean": 48.10526315789474, "episodes_this_iter": 12, "episodes_timesteps_total": 914, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [251.04645695004035, 312.67181600196574, 344.8106201171877, 355.79988064707135, 354.9968546378757, 357.6504641863548, 99.07479396792797, 352.5433396979418, 339.56661407366664, 354.3835446566358, 347.7732737368974, 299.1723266601564, 342.79308638903757, 324.1123427935573, 330.92774320957284, 338.31566639802907, 348.8729572243474, 313.3079985551624, 356.8909447199599], "episode_lengths": [45, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.11480634999002, "mean_inference_ms": 1.2534428751005233, "mean_action_processing_ms": 0.20656722623821877, "mean_env_wait_ms": 459.92338466915413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011360017876876028, "StateBufferConnector_ms": 0.00602571587813528, "ViewRequirementAgentConnector_ms": 0.16859079662122226}, "num_episodes": 12, "episode_return_max": 357.6504641863548, "episode_return_min": 99.07479396792797, "episode_return_mean": 322.3531960328099, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55644, "num_agent_steps_trained": 55644, "num_env_steps_sampled": 55644, "num_env_steps_trained": 55644, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.477269198706106, "num_env_steps_trained_throughput_per_sec": 10.477269198706106, "timesteps_total": 55644, "num_env_steps_sampled_lifetime": 55644, "num_agent_steps_sampled_lifetime": 55644, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 55644, "timers": {"training_iteration_time_ms": 48503.104, "restore_workers_time_ms": 0.019, "training_step_time_ms": 48503.047, "sample_time_ms": 46400.924, "load_time_ms": 0.555, "load_throughput": 929865.033, "learn_time_ms": 2088.069, "learn_throughput": 247.118, "synch_weights_time_ms": 13.142}, "counters": {"num_env_steps_sampled": 55644, "num_env_steps_trained": 55644, "num_agent_steps_sampled": 55644, "num_agent_steps_trained": 55644}, "done": false, "episodes_total": 1394, "training_iteration": 92, "trial_id": "fe178_00003", "date": "2024-08-15_18-41-11", "timestamp": 1723768871, "time_this_iter_s": 49.25279521942139, "time_total_s": 5807.861904859543, "pid": 37324, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 97.0123724937439, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.840000000000003, "ram_util_percent": 10.86857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.71588348944982, "cur_kl_coeff": 0.08018076606094837, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.359015027681986, "policy_loss": -0.005026650087287029, "vf_loss": 9.363360087076822, "vf_explained_var": 0.04472406009833018, "kl": 0.008500738796283259, "entropy": -1.3067896351218224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 56160, "num_env_steps_trained": 56160, "num_agent_steps_sampled": 56160, "num_agent_steps_trained": 56160}, "sampler_results": {"episode_reward_max": 357.6504641863548, "episode_reward_min": 99.07479396792797, "episode_reward_mean": 319.3563586388511, "episode_len_mean": 48.166666666666664, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1445, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [251.04645695004035, 312.67181600196574, 344.8106201171877, 355.79988064707135, 354.9968546378757, 357.6504641863548, 99.07479396792797, 352.5433396979418, 339.56661407366664, 354.3835446566358, 347.7732737368974, 299.1723266601564, 342.79308638903757, 324.1123427935573, 330.92774320957284, 338.31566639802907, 348.8729572243474, 313.3079985551624, 356.8909447199599, 356.37142933553093, 179.22641601562498, 338.04127904930607, 337.77848190305536, 336.5040116998309, 328.96682818254214, 314.02375947862424, 298.9668720609594, 317.86344294976124, 333.56504356980537, 314.6724702971014], "episode_lengths": [45, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.319356289273112, "mean_inference_ms": 1.2533692628508364, "mean_action_processing_ms": 0.20626780801697647, "mean_env_wait_ms": 467.8390562822141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011699994405110678, "StateBufferConnector_ms": 0.005995432535807292, "ViewRequirementAgentConnector_ms": 0.16815582911173502}, "num_episodes": 11, "episode_return_max": 357.6504641863548, "episode_return_min": 99.07479396792797, "episode_return_mean": 319.3563586388511}, "env_runner_results": {"episode_reward_max": 357.6504641863548, "episode_reward_min": 99.07479396792797, "episode_reward_mean": 319.3563586388511, "episode_len_mean": 48.166666666666664, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1445, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [251.04645695004035, 312.67181600196574, 344.8106201171877, 355.79988064707135, 354.9968546378757, 357.6504641863548, 99.07479396792797, 352.5433396979418, 339.56661407366664, 354.3835446566358, 347.7732737368974, 299.1723266601564, 342.79308638903757, 324.1123427935573, 330.92774320957284, 338.31566639802907, 348.8729572243474, 313.3079985551624, 356.8909447199599, 356.37142933553093, 179.22641601562498, 338.04127904930607, 337.77848190305536, 336.5040116998309, 328.96682818254214, 314.02375947862424, 298.9668720609594, 317.86344294976124, 333.56504356980537, 314.6724702971014], "episode_lengths": [45, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.319356289273112, "mean_inference_ms": 1.2533692628508364, "mean_action_processing_ms": 0.20626780801697647, "mean_env_wait_ms": 467.8390562822141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011699994405110678, "StateBufferConnector_ms": 0.005995432535807292, "ViewRequirementAgentConnector_ms": 0.16815582911173502}, "num_episodes": 11, "episode_return_max": 357.6504641863548, "episode_return_min": 99.07479396792797, "episode_return_mean": 319.3563586388511}, "episode_reward_max": 357.6504641863548, "episode_reward_min": 99.07479396792797, "episode_reward_mean": 319.3563586388511, "episode_len_mean": 48.166666666666664, "episodes_this_iter": 11, "episodes_timesteps_total": 1445, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [251.04645695004035, 312.67181600196574, 344.8106201171877, 355.79988064707135, 354.9968546378757, 357.6504641863548, 99.07479396792797, 352.5433396979418, 339.56661407366664, 354.3835446566358, 347.7732737368974, 299.1723266601564, 342.79308638903757, 324.1123427935573, 330.92774320957284, 338.31566639802907, 348.8729572243474, 313.3079985551624, 356.8909447199599, 356.37142933553093, 179.22641601562498, 338.04127904930607, 337.77848190305536, 336.5040116998309, 328.96682818254214, 314.02375947862424, 298.9668720609594, 317.86344294976124, 333.56504356980537, 314.6724702971014], "episode_lengths": [45, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.319356289273112, "mean_inference_ms": 1.2533692628508364, "mean_action_processing_ms": 0.20626780801697647, "mean_env_wait_ms": 467.8390562822141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011699994405110678, "StateBufferConnector_ms": 0.005995432535807292, "ViewRequirementAgentConnector_ms": 0.16815582911173502}, "num_episodes": 11, "episode_return_max": 357.6504641863548, "episode_return_min": 99.07479396792797, "episode_return_mean": 319.3563586388511, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56160, "num_agent_steps_trained": 56160, "num_env_steps_sampled": 56160, "num_env_steps_trained": 56160, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.322080115079038, "num_env_steps_trained_throughput_per_sec": 10.322080115079038, "timesteps_total": 56160, "num_env_steps_sampled_lifetime": 56160, "num_agent_steps_sampled_lifetime": 56160, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 56160, "timers": {"training_iteration_time_ms": 48998.716, "restore_workers_time_ms": 0.02, "training_step_time_ms": 48998.657, "sample_time_ms": 47366.517, "load_time_ms": 0.475, "load_throughput": 1087386.132, "learn_time_ms": 1618.213, "learn_throughput": 318.87, "synch_weights_time_ms": 13.134}, "counters": {"num_env_steps_sampled": 56160, "num_env_steps_trained": 56160, "num_agent_steps_sampled": 56160, "num_agent_steps_trained": 56160}, "done": false, "episodes_total": 1405, "training_iteration": 93, "trial_id": "fe178_00003", "date": "2024-08-15_18-42-01", "timestamp": 1723768921, "time_this_iter_s": 49.99274563789368, "time_total_s": 5857.8546504974365, "pid": 37324, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 147.00511813163757, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.61111111111111, "ram_util_percent": 11.24027777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.218825733661653, "cur_kl_coeff": 0.08018076606094837, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.301658550898233, "policy_loss": -0.008841301058419048, "vf_loss": 9.30945094426473, "vf_explained_var": 0.17799196441968282, "kl": 0.013081025907137288, "entropy": -1.592848281065623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 56676, "num_env_steps_trained": 56676, "num_agent_steps_sampled": 56676, "num_agent_steps_trained": 56676}, "sampler_results": {"episode_reward_max": 359.0780883789064, "episode_reward_min": 152.74786376953125, "episode_reward_mean": 310.84657004550746, "episode_len_mean": 46.57142857142857, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 326, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.25828857421857, 317.4439721632985, 359.0780883789064, 338.76082463490644, 152.74786376953125, 323.74359210609293, 332.89336069159805], "episode_lengths": [50, 50, 50, 50, 26, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.735663606615489, "mean_inference_ms": 1.2700855242599212, "mean_action_processing_ms": 0.20964392300309803, "mean_env_wait_ms": 494.3775684375481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009454999651227678, "StateBufferConnector_ms": 0.005922998700823102, "ViewRequirementAgentConnector_ms": 0.16654559544154576}, "num_episodes": 7, "episode_return_max": 359.0780883789064, "episode_return_min": 152.74786376953125, "episode_return_mean": 310.84657004550746}, "env_runner_results": {"episode_reward_max": 359.0780883789064, "episode_reward_min": 152.74786376953125, "episode_reward_mean": 310.84657004550746, "episode_len_mean": 46.57142857142857, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 326, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.25828857421857, 317.4439721632985, 359.0780883789064, 338.76082463490644, 152.74786376953125, 323.74359210609293, 332.89336069159805], "episode_lengths": [50, 50, 50, 50, 26, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.735663606615489, "mean_inference_ms": 1.2700855242599212, "mean_action_processing_ms": 0.20964392300309803, "mean_env_wait_ms": 494.3775684375481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009454999651227678, "StateBufferConnector_ms": 0.005922998700823102, "ViewRequirementAgentConnector_ms": 0.16654559544154576}, "num_episodes": 7, "episode_return_max": 359.0780883789064, "episode_return_min": 152.74786376953125, "episode_return_mean": 310.84657004550746}, "episode_reward_max": 359.0780883789064, "episode_reward_min": 152.74786376953125, "episode_reward_mean": 310.84657004550746, "episode_len_mean": 46.57142857142857, "episodes_this_iter": 7, "episodes_timesteps_total": 326, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [351.25828857421857, 317.4439721632985, 359.0780883789064, 338.76082463490644, 152.74786376953125, 323.74359210609293, 332.89336069159805], "episode_lengths": [50, 50, 50, 50, 26, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.735663606615489, "mean_inference_ms": 1.2700855242599212, "mean_action_processing_ms": 0.20964392300309803, "mean_env_wait_ms": 494.3775684375481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009454999651227678, "StateBufferConnector_ms": 0.005922998700823102, "ViewRequirementAgentConnector_ms": 0.16654559544154576}, "num_episodes": 7, "episode_return_max": 359.0780883789064, "episode_return_min": 152.74786376953125, "episode_return_mean": 310.84657004550746, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56676, "num_agent_steps_trained": 56676, "num_env_steps_sampled": 56676, "num_env_steps_trained": 56676, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.74645915444687, "num_env_steps_trained_throughput_per_sec": 10.74645915444687, "timesteps_total": 56676, "num_env_steps_sampled_lifetime": 56676, "num_agent_steps_sampled_lifetime": 56676, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 56676, "timers": {"training_iteration_time_ms": 48015.83, "restore_workers_time_ms": 0.02, "training_step_time_ms": 48015.764, "sample_time_ms": 45868.839, "load_time_ms": 0.794, "load_throughput": 649928.187, "learn_time_ms": 2132.385, "learn_throughput": 241.983, "synch_weights_time_ms": 13.241}, "counters": {"num_env_steps_sampled": 56676, "num_env_steps_trained": 56676, "num_agent_steps_sampled": 56676, "num_agent_steps_trained": 56676}, "done": false, "episodes_total": 1412, "training_iteration": 94, "trial_id": "fe178_00003", "date": "2024-08-15_18-43-18", "timestamp": 1723768998, "time_this_iter_s": 48.01858425140381, "time_total_s": 5905.87323474884, "pid": 57265, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 48.01858425140381, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 26.226086956521748, "ram_util_percent": 11.397101449275363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 55.67292293310165, "cur_kl_coeff": 0.08018076606094837, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.493024516105653, "policy_loss": 0.010162840007493894, "vf_loss": 9.47783694267273, "vf_explained_var": 0.1077972228328387, "kl": 0.06266668310781824, "entropy": -1.6431184321641923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 57192, "num_env_steps_trained": 57192, "num_agent_steps_sampled": 57192, "num_agent_steps_trained": 57192}, "sampler_results": {"episode_reward_max": 359.0780883789064, "episode_reward_min": 152.74786376953125, "episode_reward_mean": 324.5970718921942, "episode_len_mean": 48.666666666666664, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 876, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.25828857421857, 317.4439721632985, 359.0780883789064, 338.76082463490644, 152.74786376953125, 323.74359210609293, 332.89336069159805, 296.9975560360053, 324.142244343699, 356.05972645074706, 333.11603229349663, 340.59310075601303, 345.2163949035496, 317.35031467095445, 329.51100376459624, 350.6094415780078, 340.4933035292267, 332.7321854146484], "episode_lengths": [50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.020356385797039, "mean_inference_ms": 1.2667527568161738, "mean_action_processing_ms": 0.2083089943938331, "mean_env_wait_ms": 499.64280535110123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011894438001844618, "StateBufferConnector_ms": 0.006063779195149739, "ViewRequirementAgentConnector_ms": 0.1664333873324924}, "num_episodes": 11, "episode_return_max": 359.0780883789064, "episode_return_min": 152.74786376953125, "episode_return_mean": 324.5970718921942}, "env_runner_results": {"episode_reward_max": 359.0780883789064, "episode_reward_min": 152.74786376953125, "episode_reward_mean": 324.5970718921942, "episode_len_mean": 48.666666666666664, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 876, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.25828857421857, 317.4439721632985, 359.0780883789064, 338.76082463490644, 152.74786376953125, 323.74359210609293, 332.89336069159805, 296.9975560360053, 324.142244343699, 356.05972645074706, 333.11603229349663, 340.59310075601303, 345.2163949035496, 317.35031467095445, 329.51100376459624, 350.6094415780078, 340.4933035292267, 332.7321854146484], "episode_lengths": [50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.020356385797039, "mean_inference_ms": 1.2667527568161738, "mean_action_processing_ms": 0.2083089943938331, "mean_env_wait_ms": 499.64280535110123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011894438001844618, "StateBufferConnector_ms": 0.006063779195149739, "ViewRequirementAgentConnector_ms": 0.1664333873324924}, "num_episodes": 11, "episode_return_max": 359.0780883789064, "episode_return_min": 152.74786376953125, "episode_return_mean": 324.5970718921942}, "episode_reward_max": 359.0780883789064, "episode_reward_min": 152.74786376953125, "episode_reward_mean": 324.5970718921942, "episode_len_mean": 48.666666666666664, "episodes_this_iter": 11, "episodes_timesteps_total": 876, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [351.25828857421857, 317.4439721632985, 359.0780883789064, 338.76082463490644, 152.74786376953125, 323.74359210609293, 332.89336069159805, 296.9975560360053, 324.142244343699, 356.05972645074706, 333.11603229349663, 340.59310075601303, 345.2163949035496, 317.35031467095445, 329.51100376459624, 350.6094415780078, 340.4933035292267, 332.7321854146484], "episode_lengths": [50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.020356385797039, "mean_inference_ms": 1.2667527568161738, "mean_action_processing_ms": 0.2083089943938331, "mean_env_wait_ms": 499.64280535110123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011894438001844618, "StateBufferConnector_ms": 0.006063779195149739, "ViewRequirementAgentConnector_ms": 0.1664333873324924}, "num_episodes": 11, "episode_return_max": 359.0780883789064, "episode_return_min": 152.74786376953125, "episode_return_mean": 324.5970718921942, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57192, "num_agent_steps_trained": 57192, "num_env_steps_sampled": 57192, "num_env_steps_trained": 57192, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.822540795285862, "num_env_steps_trained_throughput_per_sec": 10.822540795285862, "timesteps_total": 57192, "num_env_steps_sampled_lifetime": 57192, "num_agent_steps_sampled_lifetime": 57192, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 57192, "timers": {"training_iteration_time_ms": 47847.055, "restore_workers_time_ms": 0.019, "training_step_time_ms": 47846.993, "sample_time_ms": 46453.605, "load_time_ms": 0.572, "load_throughput": 902527.466, "learn_time_ms": 1379.245, "learn_throughput": 374.118, "synch_weights_time_ms": 13.192}, "counters": {"num_env_steps_sampled": 57192, "num_env_steps_trained": 57192, "num_agent_steps_sampled": 57192, "num_agent_steps_trained": 57192}, "done": false, "episodes_total": 1423, "training_iteration": 95, "trial_id": "fe178_00003", "date": "2024-08-15_18-44-06", "timestamp": 1723769046, "time_this_iter_s": 47.68110489845276, "time_total_s": 5953.554339647293, "pid": 57265, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 95.69968914985657, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.288235294117648, "ram_util_percent": 11.463235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 68.16305259863536, "cur_kl_coeff": 0.12027114909142256, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.592943596839905, "policy_loss": 0.02574727068034311, "vf_loss": 9.554098113377888, "vf_explained_var": 0.026331458985805512, "kl": 0.10890537905409776, "entropy": -1.6697381456693015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 57708, "num_env_steps_trained": 57708, "num_agent_steps_sampled": 57708, "num_agent_steps_trained": 57708}, "sampler_results": {"episode_reward_max": 365.27077636718764, "episode_reward_min": 152.74786376953125, "episode_reward_mean": 330.7556862350163, "episode_len_mean": 49.2, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1476, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.25828857421857, 317.4439721632985, 359.0780883789064, 338.76082463490644, 152.74786376953125, 323.74359210609293, 332.89336069159805, 296.9975560360053, 324.142244343699, 356.05972645074706, 333.11603229349663, 340.59310075601303, 345.2163949035496, 317.35031467095445, 329.51100376459624, 350.6094415780078, 340.4933035292267, 332.7321854146484, 337.63536699941545, 333.640312219774, 308.51106436641334, 342.67351942943344, 337.65068602270674, 341.8301378446571, 340.0592305374328, 344.93893007962185, 365.27077636718764, 349.71844795531314, 330.6857831584836, 347.30903801055405], "episode_lengths": [50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.225080991425996, "mean_inference_ms": 1.2637438269122023, "mean_action_processing_ms": 0.20785208497555285, "mean_env_wait_ms": 508.72014336334456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0121156374613444, "StateBufferConnector_ms": 0.005946954091389974, "ViewRequirementAgentConnector_ms": 0.1643951733907064}, "num_episodes": 12, "episode_return_max": 365.27077636718764, "episode_return_min": 152.74786376953125, "episode_return_mean": 330.7556862350163}, "env_runner_results": {"episode_reward_max": 365.27077636718764, "episode_reward_min": 152.74786376953125, "episode_reward_mean": 330.7556862350163, "episode_len_mean": 49.2, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1476, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.25828857421857, 317.4439721632985, 359.0780883789064, 338.76082463490644, 152.74786376953125, 323.74359210609293, 332.89336069159805, 296.9975560360053, 324.142244343699, 356.05972645074706, 333.11603229349663, 340.59310075601303, 345.2163949035496, 317.35031467095445, 329.51100376459624, 350.6094415780078, 340.4933035292267, 332.7321854146484, 337.63536699941545, 333.640312219774, 308.51106436641334, 342.67351942943344, 337.65068602270674, 341.8301378446571, 340.0592305374328, 344.93893007962185, 365.27077636718764, 349.71844795531314, 330.6857831584836, 347.30903801055405], "episode_lengths": [50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.225080991425996, "mean_inference_ms": 1.2637438269122023, "mean_action_processing_ms": 0.20785208497555285, "mean_env_wait_ms": 508.72014336334456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0121156374613444, "StateBufferConnector_ms": 0.005946954091389974, "ViewRequirementAgentConnector_ms": 0.1643951733907064}, "num_episodes": 12, "episode_return_max": 365.27077636718764, "episode_return_min": 152.74786376953125, "episode_return_mean": 330.7556862350163}, "episode_reward_max": 365.27077636718764, "episode_reward_min": 152.74786376953125, "episode_reward_mean": 330.7556862350163, "episode_len_mean": 49.2, "episodes_this_iter": 12, "episodes_timesteps_total": 1476, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [351.25828857421857, 317.4439721632985, 359.0780883789064, 338.76082463490644, 152.74786376953125, 323.74359210609293, 332.89336069159805, 296.9975560360053, 324.142244343699, 356.05972645074706, 333.11603229349663, 340.59310075601303, 345.2163949035496, 317.35031467095445, 329.51100376459624, 350.6094415780078, 340.4933035292267, 332.7321854146484, 337.63536699941545, 333.640312219774, 308.51106436641334, 342.67351942943344, 337.65068602270674, 341.8301378446571, 340.0592305374328, 344.93893007962185, 365.27077636718764, 349.71844795531314, 330.6857831584836, 347.30903801055405], "episode_lengths": [50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.225080991425996, "mean_inference_ms": 1.2637438269122023, "mean_action_processing_ms": 0.20785208497555285, "mean_env_wait_ms": 508.72014336334456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0121156374613444, "StateBufferConnector_ms": 0.005946954091389974, "ViewRequirementAgentConnector_ms": 0.1643951733907064}, "num_episodes": 12, "episode_return_max": 365.27077636718764, "episode_return_min": 152.74786376953125, "episode_return_mean": 330.7556862350163, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57708, "num_agent_steps_trained": 57708, "num_env_steps_sampled": 57708, "num_env_steps_trained": 57708, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.75223259555261, "num_env_steps_trained_throughput_per_sec": 9.75223259555261, "timesteps_total": 57708, "num_env_steps_sampled_lifetime": 57708, "num_agent_steps_sampled_lifetime": 57708, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 57708, "timers": {"training_iteration_time_ms": 49535.027, "restore_workers_time_ms": 0.018, "training_step_time_ms": 49534.968, "sample_time_ms": 48371.876, "load_time_ms": 0.51, "load_throughput": 1012756.605, "learn_time_ms": 1148.899, "learn_throughput": 449.126, "synch_weights_time_ms": 13.334}, "counters": {"num_env_steps_sampled": 57708, "num_env_steps_trained": 57708, "num_agent_steps_sampled": 57708, "num_agent_steps_trained": 57708}, "done": false, "episodes_total": 1435, "training_iteration": 96, "trial_id": "fe178_00003", "date": "2024-08-15_18-44-59", "timestamp": 1723769099, "time_this_iter_s": 52.914286851882935, "time_total_s": 6006.468626499176, "pid": 57265, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.30936931388388617, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.299022178050136, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 148.6139760017395, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.132894736842108, "ram_util_percent": 11.334210526315792}}
