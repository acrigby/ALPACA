{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5913092722495397, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.600454417864482, "policy_loss": -0.03944777819948892, "vf_loss": 7.628154567877451, "vf_explained_var": 0.004672634601593018, "kl": 0.011747646377989442, "entropy": 1.3488782207171122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 516, "num_env_steps_trained": 516, "num_agent_steps_sampled": 516, "num_agent_steps_trained": 516}, "sampler_results": {"episode_reward_max": 81.49595144393055, "episode_reward_min": -34.08674316406257, "episode_reward_mean": -5.353861632032574, "episode_len_mean": 6.791666666666667, "episode_media": {}, "episodes_this_iter": 72, "episodes_timesteps_total": 489, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.08674316406257, -4.204375259687026, -30.597668457031318, 7.625973780752929, 25.79036649982629, -15.01779949951208, -8.488185681939129, -6.11669921875, -9.678038849898485, -4.251565921309407, 25.58438718760658, 20.92094679617111, -26.297497558593818, 36.6391652184999, -2.990552632479819, 3.39353468474701, 6.019057971779262, -24.386706542968682, 81.49595144393055, 0.24035986662954656, -14.108117675781159, 7.3621704101562955, 57.25480613950383, -17.8831522127618, -2.487194824218818, -20.197265625, -4.500390625000136, 14.460015620379167, -6.664038910759089, -8.48009675152423, 2.187745327923608, -26.0251739745042, -1.6778686523438182, -6.167602539062614, -31.153088378906318, -23.596667480468682, -10.745152563459328, -5.645430303183048, -24.13132324218759, -5.971008670951505, -18.696652642107438, 1.5110740849856938, -30.98732910156241, -16.47949722336142, -0.26997621309362785, 2.3084838867187045, -20.149067820450057, -10.135547890544387, -6.3524726605750175, 16.002209472656318, -4.953001191448834, -14.191747626186611, -4.9746469770202, -5.028083894828114, 3.0465759330326136, -1.062462529513084, -15.186699239981067, -28.911511230468818, -34.04725341796882, -7.707958984375068, -17.941169612679914, -10.77880722732283, -16.397598849501037, 9.932055965824759, -21.279663085937386, -0.8725954640533473, -24.785705566406364, -2.7495391456226344, -16.65906806789809, 41.85639900893186, -26.536364746093682, -16.425491181056486], "episode_lengths": [3, 5, 3, 6, 11, 3, 7, 10, 8, 5, 12, 10, 3, 10, 5, 6, 5, 3, 30, 7, 12, 6, 22, 4, 3, 6, 12, 12, 5, 3, 5, 5, 3, 5, 3, 3, 12, 4, 4, 4, 4, 6, 4, 3, 9, 6, 4, 8, 5, 15, 3, 7, 3, 4, 7, 11, 3, 3, 3, 3, 8, 5, 8, 5, 11, 8, 5, 5, 4, 18, 3, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.775038133635828, "mean_inference_ms": 1.3069557656425776, "mean_action_processing_ms": 0.21340065227766758, "mean_env_wait_ms": 685.0363026024586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010635354268698044, "StateBufferConnector_ms": 0.032242893436808646, "ViewRequirementAgentConnector_ms": 0.1988499344866953}, "num_episodes": 72, "episode_return_max": 81.49595144393055, "episode_return_min": -34.08674316406257, "episode_return_mean": -5.353861632032574}, "env_runner_results": {"episode_reward_max": 81.49595144393055, "episode_reward_min": -34.08674316406257, "episode_reward_mean": -5.353861632032574, "episode_len_mean": 6.791666666666667, "episode_media": {}, "episodes_this_iter": 72, "episodes_timesteps_total": 489, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.08674316406257, -4.204375259687026, -30.597668457031318, 7.625973780752929, 25.79036649982629, -15.01779949951208, -8.488185681939129, -6.11669921875, -9.678038849898485, -4.251565921309407, 25.58438718760658, 20.92094679617111, -26.297497558593818, 36.6391652184999, -2.990552632479819, 3.39353468474701, 6.019057971779262, -24.386706542968682, 81.49595144393055, 0.24035986662954656, -14.108117675781159, 7.3621704101562955, 57.25480613950383, -17.8831522127618, -2.487194824218818, -20.197265625, -4.500390625000136, 14.460015620379167, -6.664038910759089, -8.48009675152423, 2.187745327923608, -26.0251739745042, -1.6778686523438182, -6.167602539062614, -31.153088378906318, -23.596667480468682, -10.745152563459328, -5.645430303183048, -24.13132324218759, -5.971008670951505, -18.696652642107438, 1.5110740849856938, -30.98732910156241, -16.47949722336142, -0.26997621309362785, 2.3084838867187045, -20.149067820450057, -10.135547890544387, -6.3524726605750175, 16.002209472656318, -4.953001191448834, -14.191747626186611, -4.9746469770202, -5.028083894828114, 3.0465759330326136, -1.062462529513084, -15.186699239981067, -28.911511230468818, -34.04725341796882, -7.707958984375068, -17.941169612679914, -10.77880722732283, -16.397598849501037, 9.932055965824759, -21.279663085937386, -0.8725954640533473, -24.785705566406364, -2.7495391456226344, -16.65906806789809, 41.85639900893186, -26.536364746093682, -16.425491181056486], "episode_lengths": [3, 5, 3, 6, 11, 3, 7, 10, 8, 5, 12, 10, 3, 10, 5, 6, 5, 3, 30, 7, 12, 6, 22, 4, 3, 6, 12, 12, 5, 3, 5, 5, 3, 5, 3, 3, 12, 4, 4, 4, 4, 6, 4, 3, 9, 6, 4, 8, 5, 15, 3, 7, 3, 4, 7, 11, 3, 3, 3, 3, 8, 5, 8, 5, 11, 8, 5, 5, 4, 18, 3, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.775038133635828, "mean_inference_ms": 1.3069557656425776, "mean_action_processing_ms": 0.21340065227766758, "mean_env_wait_ms": 685.0363026024586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010635354268698044, "StateBufferConnector_ms": 0.032242893436808646, "ViewRequirementAgentConnector_ms": 0.1988499344866953}, "num_episodes": 72, "episode_return_max": 81.49595144393055, "episode_return_min": -34.08674316406257, "episode_return_mean": -5.353861632032574}, "episode_reward_max": 81.49595144393055, "episode_reward_min": -34.08674316406257, "episode_reward_mean": -5.353861632032574, "episode_len_mean": 6.791666666666667, "episodes_this_iter": 72, "episodes_timesteps_total": 489, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.08674316406257, -4.204375259687026, -30.597668457031318, 7.625973780752929, 25.79036649982629, -15.01779949951208, -8.488185681939129, -6.11669921875, -9.678038849898485, -4.251565921309407, 25.58438718760658, 20.92094679617111, -26.297497558593818, 36.6391652184999, -2.990552632479819, 3.39353468474701, 6.019057971779262, -24.386706542968682, 81.49595144393055, 0.24035986662954656, -14.108117675781159, 7.3621704101562955, 57.25480613950383, -17.8831522127618, -2.487194824218818, -20.197265625, -4.500390625000136, 14.460015620379167, -6.664038910759089, -8.48009675152423, 2.187745327923608, -26.0251739745042, -1.6778686523438182, -6.167602539062614, -31.153088378906318, -23.596667480468682, -10.745152563459328, -5.645430303183048, -24.13132324218759, -5.971008670951505, -18.696652642107438, 1.5110740849856938, -30.98732910156241, -16.47949722336142, -0.26997621309362785, 2.3084838867187045, -20.149067820450057, -10.135547890544387, -6.3524726605750175, 16.002209472656318, -4.953001191448834, -14.191747626186611, -4.9746469770202, -5.028083894828114, 3.0465759330326136, -1.062462529513084, -15.186699239981067, -28.911511230468818, -34.04725341796882, -7.707958984375068, -17.941169612679914, -10.77880722732283, -16.397598849501037, 9.932055965824759, -21.279663085937386, -0.8725954640533473, -24.785705566406364, -2.7495391456226344, -16.65906806789809, 41.85639900893186, -26.536364746093682, -16.425491181056486], "episode_lengths": [3, 5, 3, 6, 11, 3, 7, 10, 8, 5, 12, 10, 3, 10, 5, 6, 5, 3, 30, 7, 12, 6, 22, 4, 3, 6, 12, 12, 5, 3, 5, 5, 3, 5, 3, 3, 12, 4, 4, 4, 4, 6, 4, 3, 9, 6, 4, 8, 5, 15, 3, 7, 3, 4, 7, 11, 3, 3, 3, 3, 8, 5, 8, 5, 11, 8, 5, 5, 4, 18, 3, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.775038133635828, "mean_inference_ms": 1.3069557656425776, "mean_action_processing_ms": 0.21340065227766758, "mean_env_wait_ms": 685.0363026024586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010635354268698044, "StateBufferConnector_ms": 0.032242893436808646, "ViewRequirementAgentConnector_ms": 0.1988499344866953}, "num_episodes": 72, "episode_return_max": 81.49595144393055, "episode_return_min": -34.08674316406257, "episode_return_mean": -5.353861632032574, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516, "num_agent_steps_trained": 516, "num_env_steps_sampled": 516, "num_env_steps_trained": 516, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.025825714929325, "num_env_steps_trained_throughput_per_sec": 7.025825714929325, "timesteps_total": 516, "num_env_steps_sampled_lifetime": 516, "num_agent_steps_sampled_lifetime": 516, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 516, "timers": {"training_iteration_time_ms": 73443.345, "restore_workers_time_ms": 0.04, "training_step_time_ms": 73443.244, "sample_time_ms": 72779.777, "load_time_ms": 0.862, "load_throughput": 598357.994, "learn_time_ms": 648.508, "learn_throughput": 795.673, "synch_weights_time_ms": 13.521}, "counters": {"num_env_steps_sampled": 516, "num_env_steps_trained": 516, "num_agent_steps_sampled": 516, "num_agent_steps_trained": 516}, "done": false, "episodes_total": 72, "training_iteration": 1, "trial_id": "fe178_00005", "date": "2024-08-15_16-53-41", "timestamp": 1723762421, "time_this_iter_s": 73.44719910621643, "time_total_s": 73.44719910621643, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 73.44719910621643, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.85142857142857, "ram_util_percent": 12.292380952380952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7444590499003727, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4099661668141685, "policy_loss": -0.03592956877934436, "vf_loss": 7.434152499834696, "vf_explained_var": 0.019964146117369335, "kl": 0.011743225403879873, "entropy": 1.286862979332606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1032, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 1032, "num_agent_steps_trained": 1032}, "sampler_results": {"episode_reward_max": 98.0794524083763, "episode_reward_min": -34.04725341796882, "episode_reward_mean": -3.549727544079001, "episode_len_mean": 7.46, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 746, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.0251739745042, -1.6778686523438182, -6.167602539062614, -31.153088378906318, -23.596667480468682, -10.745152563459328, -5.645430303183048, -24.13132324218759, -5.971008670951505, -18.696652642107438, 1.5110740849856938, -30.98732910156241, -16.47949722336142, -0.26997621309362785, 2.3084838867187045, -20.149067820450057, -10.135547890544387, -6.3524726605750175, 16.002209472656318, -4.953001191448834, -14.191747626186611, -4.9746469770202, -5.028083894828114, 3.0465759330326136, -1.062462529513084, -15.186699239981067, -28.911511230468818, -34.04725341796882, -7.707958984375068, -17.941169612679914, -10.77880722732283, -16.397598849501037, 9.932055965824759, -21.279663085937386, -0.8725954640533473, -24.785705566406364, -2.7495391456226344, -16.65906806789809, 41.85639900893186, -26.536364746093682, -16.425491181056486, 13.55050865274886, 59.00073811274615, 3.5379887305464877, 12.900531546453905, -23.170920787063608, 3.541743821924115, -5.375919871165323, -18.428625878710662, -23.579785156250068, -21.551525878906318, -6.108018844523144, -29.809045410156386, 10.858401383762484, -9.703584575399816, -20.76162991386434, -26.32142879425517, -13.629744821408508, 14.114126961626823, -4.593086404244971, -11.61490383083293, 9.045637723132074, 3.1488765490524173, -14.956977891702024, -24.631823730468682, -20.83524953540359, -10.900403825042375, 4.558749037906807, 53.53066168661741, 15.419780799481032, -23.000227844713777, 12.40199137392446, -15.716643502328523, 98.0794524083763, 2.774596107279791, -7.261499023437409, 42.66284352201028, -9.837956352480433, -11.756115722656318, 20.59548159774988, 53.19787382069046, 33.82048650979732, -2.201000976562568, -7.022509765624932, -28.327221679687568, -12.626231281054913, -2.683337402343682, 7.2239038076526185, -19.23950284901271, 3.8155092573126694, 21.574108886718818, -18.598378709250213, -0.5628953237300607, -2.469984812610292, -5.905834960937568, 3.799314951885492, -0.5473299510814513, 34.63137782048635, -17.292251422588834, 12.280586294689897], "episode_lengths": [5, 3, 5, 3, 3, 12, 4, 4, 4, 4, 6, 4, 3, 9, 6, 4, 8, 5, 15, 3, 7, 3, 4, 7, 11, 3, 3, 3, 3, 8, 5, 8, 5, 11, 8, 5, 5, 4, 18, 3, 13, 13, 36, 7, 6, 4, 5, 6, 11, 3, 3, 5, 6, 9, 7, 5, 4, 3, 6, 7, 4, 12, 8, 5, 3, 4, 6, 4, 15, 8, 4, 5, 9, 35, 5, 4, 32, 6, 3, 8, 15, 32, 3, 3, 3, 7, 3, 5, 4, 6, 11, 3, 3, 10, 3, 9, 11, 29, 6, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.98979425538014, "mean_inference_ms": 1.3028095049063204, "mean_action_processing_ms": 0.21217473851716467, "mean_env_wait_ms": 658.4610601561657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010284231768714056, "StateBufferConnector_ms": 0.029130525059170194, "ViewRequirementAgentConnector_ms": 0.19031720028983223}, "num_episodes": 59, "episode_return_max": 98.0794524083763, "episode_return_min": -34.04725341796882, "episode_return_mean": -3.549727544079001}, "env_runner_results": {"episode_reward_max": 98.0794524083763, "episode_reward_min": -34.04725341796882, "episode_reward_mean": -3.549727544079001, "episode_len_mean": 7.46, "episode_media": {}, "episodes_this_iter": 59, "episodes_timesteps_total": 746, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.0251739745042, -1.6778686523438182, -6.167602539062614, -31.153088378906318, -23.596667480468682, -10.745152563459328, -5.645430303183048, -24.13132324218759, -5.971008670951505, -18.696652642107438, 1.5110740849856938, -30.98732910156241, -16.47949722336142, -0.26997621309362785, 2.3084838867187045, -20.149067820450057, -10.135547890544387, -6.3524726605750175, 16.002209472656318, -4.953001191448834, -14.191747626186611, -4.9746469770202, -5.028083894828114, 3.0465759330326136, -1.062462529513084, -15.186699239981067, -28.911511230468818, -34.04725341796882, -7.707958984375068, -17.941169612679914, -10.77880722732283, -16.397598849501037, 9.932055965824759, -21.279663085937386, -0.8725954640533473, -24.785705566406364, -2.7495391456226344, -16.65906806789809, 41.85639900893186, -26.536364746093682, -16.425491181056486, 13.55050865274886, 59.00073811274615, 3.5379887305464877, 12.900531546453905, -23.170920787063608, 3.541743821924115, -5.375919871165323, -18.428625878710662, -23.579785156250068, -21.551525878906318, -6.108018844523144, -29.809045410156386, 10.858401383762484, -9.703584575399816, -20.76162991386434, -26.32142879425517, -13.629744821408508, 14.114126961626823, -4.593086404244971, -11.61490383083293, 9.045637723132074, 3.1488765490524173, -14.956977891702024, -24.631823730468682, -20.83524953540359, -10.900403825042375, 4.558749037906807, 53.53066168661741, 15.419780799481032, -23.000227844713777, 12.40199137392446, -15.716643502328523, 98.0794524083763, 2.774596107279791, -7.261499023437409, 42.66284352201028, -9.837956352480433, -11.756115722656318, 20.59548159774988, 53.19787382069046, 33.82048650979732, -2.201000976562568, -7.022509765624932, -28.327221679687568, -12.626231281054913, -2.683337402343682, 7.2239038076526185, -19.23950284901271, 3.8155092573126694, 21.574108886718818, -18.598378709250213, -0.5628953237300607, -2.469984812610292, -5.905834960937568, 3.799314951885492, -0.5473299510814513, 34.63137782048635, -17.292251422588834, 12.280586294689897], "episode_lengths": [5, 3, 5, 3, 3, 12, 4, 4, 4, 4, 6, 4, 3, 9, 6, 4, 8, 5, 15, 3, 7, 3, 4, 7, 11, 3, 3, 3, 3, 8, 5, 8, 5, 11, 8, 5, 5, 4, 18, 3, 13, 13, 36, 7, 6, 4, 5, 6, 11, 3, 3, 5, 6, 9, 7, 5, 4, 3, 6, 7, 4, 12, 8, 5, 3, 4, 6, 4, 15, 8, 4, 5, 9, 35, 5, 4, 32, 6, 3, 8, 15, 32, 3, 3, 3, 7, 3, 5, 4, 6, 11, 3, 3, 10, 3, 9, 11, 29, 6, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.98979425538014, "mean_inference_ms": 1.3028095049063204, "mean_action_processing_ms": 0.21217473851716467, "mean_env_wait_ms": 658.4610601561657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010284231768714056, "StateBufferConnector_ms": 0.029130525059170194, "ViewRequirementAgentConnector_ms": 0.19031720028983223}, "num_episodes": 59, "episode_return_max": 98.0794524083763, "episode_return_min": -34.04725341796882, "episode_return_mean": -3.549727544079001}, "episode_reward_max": 98.0794524083763, "episode_reward_min": -34.04725341796882, "episode_reward_mean": -3.549727544079001, "episode_len_mean": 7.46, "episodes_this_iter": 59, "episodes_timesteps_total": 746, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.0251739745042, -1.6778686523438182, -6.167602539062614, -31.153088378906318, -23.596667480468682, -10.745152563459328, -5.645430303183048, -24.13132324218759, -5.971008670951505, -18.696652642107438, 1.5110740849856938, -30.98732910156241, -16.47949722336142, -0.26997621309362785, 2.3084838867187045, -20.149067820450057, -10.135547890544387, -6.3524726605750175, 16.002209472656318, -4.953001191448834, -14.191747626186611, -4.9746469770202, -5.028083894828114, 3.0465759330326136, -1.062462529513084, -15.186699239981067, -28.911511230468818, -34.04725341796882, -7.707958984375068, -17.941169612679914, -10.77880722732283, -16.397598849501037, 9.932055965824759, -21.279663085937386, -0.8725954640533473, -24.785705566406364, -2.7495391456226344, -16.65906806789809, 41.85639900893186, -26.536364746093682, -16.425491181056486, 13.55050865274886, 59.00073811274615, 3.5379887305464877, 12.900531546453905, -23.170920787063608, 3.541743821924115, -5.375919871165323, -18.428625878710662, -23.579785156250068, -21.551525878906318, -6.108018844523144, -29.809045410156386, 10.858401383762484, -9.703584575399816, -20.76162991386434, -26.32142879425517, -13.629744821408508, 14.114126961626823, -4.593086404244971, -11.61490383083293, 9.045637723132074, 3.1488765490524173, -14.956977891702024, -24.631823730468682, -20.83524953540359, -10.900403825042375, 4.558749037906807, 53.53066168661741, 15.419780799481032, -23.000227844713777, 12.40199137392446, -15.716643502328523, 98.0794524083763, 2.774596107279791, -7.261499023437409, 42.66284352201028, -9.837956352480433, -11.756115722656318, 20.59548159774988, 53.19787382069046, 33.82048650979732, -2.201000976562568, -7.022509765624932, -28.327221679687568, -12.626231281054913, -2.683337402343682, 7.2239038076526185, -19.23950284901271, 3.8155092573126694, 21.574108886718818, -18.598378709250213, -0.5628953237300607, -2.469984812610292, -5.905834960937568, 3.799314951885492, -0.5473299510814513, 34.63137782048635, -17.292251422588834, 12.280586294689897], "episode_lengths": [5, 3, 5, 3, 3, 12, 4, 4, 4, 4, 6, 4, 3, 9, 6, 4, 8, 5, 15, 3, 7, 3, 4, 7, 11, 3, 3, 3, 3, 8, 5, 8, 5, 11, 8, 5, 5, 4, 18, 3, 13, 13, 36, 7, 6, 4, 5, 6, 11, 3, 3, 5, 6, 9, 7, 5, 4, 3, 6, 7, 4, 12, 8, 5, 3, 4, 6, 4, 15, 8, 4, 5, 9, 35, 5, 4, 32, 6, 3, 8, 15, 32, 3, 3, 3, 7, 3, 5, 4, 6, 11, 3, 3, 10, 3, 9, 11, 29, 6, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.98979425538014, "mean_inference_ms": 1.3028095049063204, "mean_action_processing_ms": 0.21217473851716467, "mean_env_wait_ms": 658.4610601561657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010284231768714056, "StateBufferConnector_ms": 0.029130525059170194, "ViewRequirementAgentConnector_ms": 0.19031720028983223}, "num_episodes": 59, "episode_return_max": 98.0794524083763, "episode_return_min": -34.04725341796882, "episode_return_mean": -3.549727544079001, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032, "num_agent_steps_trained": 1032, "num_env_steps_sampled": 1032, "num_env_steps_trained": 1032, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.9581615010616416, "num_env_steps_trained_throughput_per_sec": 7.9581615010616416, "timesteps_total": 1032, "num_env_steps_sampled_lifetime": 1032, "num_agent_steps_sampled_lifetime": 1032, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 1032, "timers": {"training_iteration_time_ms": 69141.226, "restore_workers_time_ms": 0.03, "training_step_time_ms": 69141.149, "sample_time_ms": 68477.523, "load_time_ms": 0.615, "load_throughput": 839674.438, "learn_time_ms": 649.486, "learn_throughput": 794.474, "synch_weights_time_ms": 13.093}, "counters": {"num_env_steps_sampled": 1032, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 1032, "num_agent_steps_trained": 1032}, "done": false, "episodes_total": 131, "training_iteration": 2, "trial_id": "fe178_00005", "date": "2024-08-15_16-54-46", "timestamp": 1723762486, "time_this_iter_s": 64.84283185005188, "time_total_s": 138.2900309562683, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 138.2900309562683, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.406451612903222, "ram_util_percent": 12.790322580645162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2825913300116856, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.543181268374125, "policy_loss": -0.037755444754535954, "vf_loss": 7.571460417906443, "vf_explained_var": 0.04386239945888519, "kl": 0.009476323111054322, "entropy": 1.2373999198277792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1548, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 1548, "num_agent_steps_trained": 1548}, "sampler_results": {"episode_reward_max": 98.0794524083763, "episode_reward_min": -33.4641865471628, "episode_reward_mean": 2.25525426647807, "episode_len_mean": 8.81, "episode_media": {}, "episodes_this_iter": 53, "episodes_timesteps_total": 881, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.858401383762484, -9.703584575399816, -20.76162991386434, -26.32142879425517, -13.629744821408508, 14.114126961626823, -4.593086404244971, -11.61490383083293, 9.045637723132074, 3.1488765490524173, -14.956977891702024, -24.631823730468682, -20.83524953540359, -10.900403825042375, 4.558749037906807, 53.53066168661741, 15.419780799481032, -23.000227844713777, 12.40199137392446, -15.716643502328523, 98.0794524083763, 2.774596107279791, -7.261499023437409, 42.66284352201028, -9.837956352480433, -11.756115722656318, 20.59548159774988, 53.19787382069046, 33.82048650979732, -2.201000976562568, -7.022509765624932, -28.327221679687568, -12.626231281054913, -2.683337402343682, 7.2239038076526185, -19.23950284901271, 3.8155092573126694, 21.574108886718818, -18.598378709250213, -0.5628953237300607, -2.469984812610292, -5.905834960937568, 3.799314951885492, -0.5473299510814513, 34.63137782048635, -17.292251422588834, 12.280586294689897, 81.82395212762138, -1.6008661276748626, 3.949182128906159, 4.153346595784399, 3.10445023754329, 0.47173513996744987, 43.3573746435344, -17.543896484374955, 34.7672433619594, 6.7368073176272105, -20.153200028635354, 3.203189645946054, -8.24352000989434, 60.81538192753379, 57.60758353686094, 6.290683569067937, -4.542419659033385, 25.022088310920594, -11.882221471359685, 24.914135742187455, -31.883679199218818, 29.39775714938564, -0.0855748810229926, -21.378698802436418, 28.66047784532998, -2.018113011635478, -20.63360721480531, 21.514733886718886, 1.420881912707543, -13.911230468749977, -13.453579149467217, -27.174157714843886, -27.548805912885996, -33.4641865471628, -21.569031680610465, -10.124899446401741, 10.955358886718727, -21.23610974184595, -30.310290527343682, 2.800862217138956, -22.521923828125068, 18.365995203969348, -5.935378799761708, -28.684094238281205, 19.086732130275777, -10.315376332125936, 59.2008170837435, -21.0472902535803, -22.71567382812509, 0.27907045751078385, 17.617752726711444, 1.2650090694212963, -5.815356445312432], "episode_lengths": [9, 7, 5, 4, 3, 6, 7, 4, 12, 8, 5, 3, 4, 6, 4, 15, 8, 4, 5, 9, 35, 5, 4, 32, 6, 3, 8, 15, 32, 3, 3, 3, 7, 3, 5, 4, 6, 11, 3, 3, 10, 3, 9, 11, 29, 6, 7, 37, 6, 8, 9, 5, 10, 19, 12, 12, 7, 3, 4, 3, 31, 17, 5, 9, 10, 5, 18, 3, 12, 11, 5, 18, 12, 3, 16, 5, 5, 8, 6, 7, 5, 3, 6, 5, 4, 3, 8, 3, 12, 10, 8, 8, 8, 27, 4, 4, 9, 9, 7, 3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.12924600440884, "mean_inference_ms": 1.2996293467923234, "mean_action_processing_ms": 0.2119799746509684, "mean_env_wait_ms": 642.2720904958685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010370492935180664, "StateBufferConnector_ms": 0.023432493209838867, "ViewRequirementAgentConnector_ms": 0.18576955795288086}, "num_episodes": 53, "episode_return_max": 98.0794524083763, "episode_return_min": -33.4641865471628, "episode_return_mean": 2.25525426647807}, "env_runner_results": {"episode_reward_max": 98.0794524083763, "episode_reward_min": -33.4641865471628, "episode_reward_mean": 2.25525426647807, "episode_len_mean": 8.81, "episode_media": {}, "episodes_this_iter": 53, "episodes_timesteps_total": 881, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.858401383762484, -9.703584575399816, -20.76162991386434, -26.32142879425517, -13.629744821408508, 14.114126961626823, -4.593086404244971, -11.61490383083293, 9.045637723132074, 3.1488765490524173, -14.956977891702024, -24.631823730468682, -20.83524953540359, -10.900403825042375, 4.558749037906807, 53.53066168661741, 15.419780799481032, -23.000227844713777, 12.40199137392446, -15.716643502328523, 98.0794524083763, 2.774596107279791, -7.261499023437409, 42.66284352201028, -9.837956352480433, -11.756115722656318, 20.59548159774988, 53.19787382069046, 33.82048650979732, -2.201000976562568, -7.022509765624932, -28.327221679687568, -12.626231281054913, -2.683337402343682, 7.2239038076526185, -19.23950284901271, 3.8155092573126694, 21.574108886718818, -18.598378709250213, -0.5628953237300607, -2.469984812610292, -5.905834960937568, 3.799314951885492, -0.5473299510814513, 34.63137782048635, -17.292251422588834, 12.280586294689897, 81.82395212762138, -1.6008661276748626, 3.949182128906159, 4.153346595784399, 3.10445023754329, 0.47173513996744987, 43.3573746435344, -17.543896484374955, 34.7672433619594, 6.7368073176272105, -20.153200028635354, 3.203189645946054, -8.24352000989434, 60.81538192753379, 57.60758353686094, 6.290683569067937, -4.542419659033385, 25.022088310920594, -11.882221471359685, 24.914135742187455, -31.883679199218818, 29.39775714938564, -0.0855748810229926, -21.378698802436418, 28.66047784532998, -2.018113011635478, -20.63360721480531, 21.514733886718886, 1.420881912707543, -13.911230468749977, -13.453579149467217, -27.174157714843886, -27.548805912885996, -33.4641865471628, -21.569031680610465, -10.124899446401741, 10.955358886718727, -21.23610974184595, -30.310290527343682, 2.800862217138956, -22.521923828125068, 18.365995203969348, -5.935378799761708, -28.684094238281205, 19.086732130275777, -10.315376332125936, 59.2008170837435, -21.0472902535803, -22.71567382812509, 0.27907045751078385, 17.617752726711444, 1.2650090694212963, -5.815356445312432], "episode_lengths": [9, 7, 5, 4, 3, 6, 7, 4, 12, 8, 5, 3, 4, 6, 4, 15, 8, 4, 5, 9, 35, 5, 4, 32, 6, 3, 8, 15, 32, 3, 3, 3, 7, 3, 5, 4, 6, 11, 3, 3, 10, 3, 9, 11, 29, 6, 7, 37, 6, 8, 9, 5, 10, 19, 12, 12, 7, 3, 4, 3, 31, 17, 5, 9, 10, 5, 18, 3, 12, 11, 5, 18, 12, 3, 16, 5, 5, 8, 6, 7, 5, 3, 6, 5, 4, 3, 8, 3, 12, 10, 8, 8, 8, 27, 4, 4, 9, 9, 7, 3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.12924600440884, "mean_inference_ms": 1.2996293467923234, "mean_action_processing_ms": 0.2119799746509684, "mean_env_wait_ms": 642.2720904958685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010370492935180664, "StateBufferConnector_ms": 0.023432493209838867, "ViewRequirementAgentConnector_ms": 0.18576955795288086}, "num_episodes": 53, "episode_return_max": 98.0794524083763, "episode_return_min": -33.4641865471628, "episode_return_mean": 2.25525426647807}, "episode_reward_max": 98.0794524083763, "episode_reward_min": -33.4641865471628, "episode_reward_mean": 2.25525426647807, "episode_len_mean": 8.81, "episodes_this_iter": 53, "episodes_timesteps_total": 881, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.858401383762484, -9.703584575399816, -20.76162991386434, -26.32142879425517, -13.629744821408508, 14.114126961626823, -4.593086404244971, -11.61490383083293, 9.045637723132074, 3.1488765490524173, -14.956977891702024, -24.631823730468682, -20.83524953540359, -10.900403825042375, 4.558749037906807, 53.53066168661741, 15.419780799481032, -23.000227844713777, 12.40199137392446, -15.716643502328523, 98.0794524083763, 2.774596107279791, -7.261499023437409, 42.66284352201028, -9.837956352480433, -11.756115722656318, 20.59548159774988, 53.19787382069046, 33.82048650979732, -2.201000976562568, -7.022509765624932, -28.327221679687568, -12.626231281054913, -2.683337402343682, 7.2239038076526185, -19.23950284901271, 3.8155092573126694, 21.574108886718818, -18.598378709250213, -0.5628953237300607, -2.469984812610292, -5.905834960937568, 3.799314951885492, -0.5473299510814513, 34.63137782048635, -17.292251422588834, 12.280586294689897, 81.82395212762138, -1.6008661276748626, 3.949182128906159, 4.153346595784399, 3.10445023754329, 0.47173513996744987, 43.3573746435344, -17.543896484374955, 34.7672433619594, 6.7368073176272105, -20.153200028635354, 3.203189645946054, -8.24352000989434, 60.81538192753379, 57.60758353686094, 6.290683569067937, -4.542419659033385, 25.022088310920594, -11.882221471359685, 24.914135742187455, -31.883679199218818, 29.39775714938564, -0.0855748810229926, -21.378698802436418, 28.66047784532998, -2.018113011635478, -20.63360721480531, 21.514733886718886, 1.420881912707543, -13.911230468749977, -13.453579149467217, -27.174157714843886, -27.548805912885996, -33.4641865471628, -21.569031680610465, -10.124899446401741, 10.955358886718727, -21.23610974184595, -30.310290527343682, 2.800862217138956, -22.521923828125068, 18.365995203969348, -5.935378799761708, -28.684094238281205, 19.086732130275777, -10.315376332125936, 59.2008170837435, -21.0472902535803, -22.71567382812509, 0.27907045751078385, 17.617752726711444, 1.2650090694212963, -5.815356445312432], "episode_lengths": [9, 7, 5, 4, 3, 6, 7, 4, 12, 8, 5, 3, 4, 6, 4, 15, 8, 4, 5, 9, 35, 5, 4, 32, 6, 3, 8, 15, 32, 3, 3, 3, 7, 3, 5, 4, 6, 11, 3, 3, 10, 3, 9, 11, 29, 6, 7, 37, 6, 8, 9, 5, 10, 19, 12, 12, 7, 3, 4, 3, 31, 17, 5, 9, 10, 5, 18, 3, 12, 11, 5, 18, 12, 3, 16, 5, 5, 8, 6, 7, 5, 3, 6, 5, 4, 3, 8, 3, 12, 10, 8, 8, 8, 27, 4, 4, 9, 9, 7, 3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.12924600440884, "mean_inference_ms": 1.2996293467923234, "mean_action_processing_ms": 0.2119799746509684, "mean_env_wait_ms": 642.2720904958685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010370492935180664, "StateBufferConnector_ms": 0.023432493209838867, "ViewRequirementAgentConnector_ms": 0.18576955795288086}, "num_episodes": 53, "episode_return_max": 98.0794524083763, "episode_return_min": -33.4641865471628, "episode_return_mean": 2.25525426647807, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1548, "num_agent_steps_trained": 1548, "num_env_steps_sampled": 1548, "num_env_steps_trained": 1548, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.578887263639969, "num_env_steps_trained_throughput_per_sec": 7.578887263639969, "timesteps_total": 1548, "num_env_steps_sampled_lifetime": 1548, "num_agent_steps_sampled_lifetime": 1548, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 1548, "timers": {"training_iteration_time_ms": 68788.779, "restore_workers_time_ms": 0.025, "training_step_time_ms": 68788.713, "sample_time_ms": 68123.997, "load_time_ms": 0.515, "load_throughput": 1001508.961, "learn_time_ms": 650.712, "learn_throughput": 792.977, "synch_weights_time_ms": 13.106}, "counters": {"num_env_steps_sampled": 1548, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 1548, "num_agent_steps_trained": 1548}, "done": false, "episodes_total": 184, "training_iteration": 3, "trial_id": "fe178_00005", "date": "2024-08-15_16-55-54", "timestamp": 1723762554, "time_this_iter_s": 68.08819460868835, "time_total_s": 206.37822556495667, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 206.37822556495667, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.581443298969074, "ram_util_percent": 13.185567010309283}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.669291853904724, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.38705450296402, "policy_loss": -0.04725350394534568, "vf_loss": 7.420293951034546, "vf_explained_var": 0.11940071930487951, "kl": 0.014014029286393755, "entropy": 1.215669658780098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 2064, "num_agent_steps_trained": 2064}, "sampler_results": {"episode_reward_max": 122.27086951616224, "episode_reward_min": -33.4641865471628, "episode_reward_mean": 10.019756554240164, "episode_len_mean": 10.83, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 1083, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.799314951885492, -0.5473299510814513, 34.63137782048635, -17.292251422588834, 12.280586294689897, 81.82395212762138, -1.6008661276748626, 3.949182128906159, 4.153346595784399, 3.10445023754329, 0.47173513996744987, 43.3573746435344, -17.543896484374955, 34.7672433619594, 6.7368073176272105, -20.153200028635354, 3.203189645946054, -8.24352000989434, 60.81538192753379, 57.60758353686094, 6.290683569067937, -4.542419659033385, 25.022088310920594, -11.882221471359685, 24.914135742187455, -31.883679199218818, 29.39775714938564, -0.0855748810229926, -21.378698802436418, 28.66047784532998, -2.018113011635478, -20.63360721480531, 21.514733886718886, 1.420881912707543, -13.911230468749977, -13.453579149467217, -27.174157714843886, -27.548805912885996, -33.4641865471628, -21.569031680610465, -10.124899446401741, 10.955358886718727, -21.23610974184595, -30.310290527343682, 2.800862217138956, -22.521923828125068, 18.365995203969348, -5.935378799761708, -28.684094238281205, 19.086732130275777, -10.315376332125936, 59.2008170837435, -21.0472902535803, -22.71567382812509, 0.27907045751078385, 17.617752726711444, 1.2650090694212963, -5.815356445312432, 10.844409179687318, 11.175408048269162, 72.12393226656144, 86.7542409566705, -8.289979706041962, 5.66479586715019, -26.33370361328116, -8.310319548447467, 25.649229250134567, 91.45712899271354, 1.1658359471959443, 73.6467672518067, 47.77819192300505, 39.1323979685896, -8.344728844855524, -8.00071940675707, -0.26809850416134395, 105.53497469315585, 122.27086951616224, 3.850470801939082, 51.748705414848814, -12.169454776372348, -18.771620149053163, -3.3623302709801948, -15.421891322169316, -18.559142426059452, 2.851187286045615, 35.63871447076343, -7.457496262288501, 27.46204088466635, 9.983982822573239, 19.631682879846352, 6.69028852440708, 35.26374866310573, 20.751581077731657, -9.889576114428976, 31.099200769054164, -14.104457166583131, -5.903387310729002, -6.65747815719908, 88.89309662016416, 2.8960381834075974], "episode_lengths": [9, 11, 29, 6, 7, 37, 6, 8, 9, 5, 10, 19, 12, 12, 7, 3, 4, 3, 31, 17, 5, 9, 10, 5, 18, 3, 12, 11, 5, 18, 12, 3, 16, 5, 5, 8, 6, 7, 5, 3, 6, 5, 4, 3, 8, 3, 12, 10, 8, 8, 8, 27, 4, 4, 9, 9, 7, 3, 8, 8, 26, 19, 10, 5, 4, 9, 11, 25, 4, 24, 13, 28, 5, 4, 4, 38, 34, 16, 18, 9, 1, 7, 3, 4, 8, 12, 5, 21, 9, 9, 17, 21, 19, 5, 15, 8, 6, 5, 25, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.295886756172358, "mean_inference_ms": 1.2946438732135181, "mean_action_processing_ms": 0.2115229763872184, "mean_env_wait_ms": 643.0556978888602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01035618782043457, "StateBufferConnector_ms": 0.020154714584350586, "ViewRequirementAgentConnector_ms": 0.18295025825500488}, "num_episodes": 42, "episode_return_max": 122.27086951616224, "episode_return_min": -33.4641865471628, "episode_return_mean": 10.019756554240164}, "env_runner_results": {"episode_reward_max": 122.27086951616224, "episode_reward_min": -33.4641865471628, "episode_reward_mean": 10.019756554240164, "episode_len_mean": 10.83, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 1083, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.799314951885492, -0.5473299510814513, 34.63137782048635, -17.292251422588834, 12.280586294689897, 81.82395212762138, -1.6008661276748626, 3.949182128906159, 4.153346595784399, 3.10445023754329, 0.47173513996744987, 43.3573746435344, -17.543896484374955, 34.7672433619594, 6.7368073176272105, -20.153200028635354, 3.203189645946054, -8.24352000989434, 60.81538192753379, 57.60758353686094, 6.290683569067937, -4.542419659033385, 25.022088310920594, -11.882221471359685, 24.914135742187455, -31.883679199218818, 29.39775714938564, -0.0855748810229926, -21.378698802436418, 28.66047784532998, -2.018113011635478, -20.63360721480531, 21.514733886718886, 1.420881912707543, -13.911230468749977, -13.453579149467217, -27.174157714843886, -27.548805912885996, -33.4641865471628, -21.569031680610465, -10.124899446401741, 10.955358886718727, -21.23610974184595, -30.310290527343682, 2.800862217138956, -22.521923828125068, 18.365995203969348, -5.935378799761708, -28.684094238281205, 19.086732130275777, -10.315376332125936, 59.2008170837435, -21.0472902535803, -22.71567382812509, 0.27907045751078385, 17.617752726711444, 1.2650090694212963, -5.815356445312432, 10.844409179687318, 11.175408048269162, 72.12393226656144, 86.7542409566705, -8.289979706041962, 5.66479586715019, -26.33370361328116, -8.310319548447467, 25.649229250134567, 91.45712899271354, 1.1658359471959443, 73.6467672518067, 47.77819192300505, 39.1323979685896, -8.344728844855524, -8.00071940675707, -0.26809850416134395, 105.53497469315585, 122.27086951616224, 3.850470801939082, 51.748705414848814, -12.169454776372348, -18.771620149053163, -3.3623302709801948, -15.421891322169316, -18.559142426059452, 2.851187286045615, 35.63871447076343, -7.457496262288501, 27.46204088466635, 9.983982822573239, 19.631682879846352, 6.69028852440708, 35.26374866310573, 20.751581077731657, -9.889576114428976, 31.099200769054164, -14.104457166583131, -5.903387310729002, -6.65747815719908, 88.89309662016416, 2.8960381834075974], "episode_lengths": [9, 11, 29, 6, 7, 37, 6, 8, 9, 5, 10, 19, 12, 12, 7, 3, 4, 3, 31, 17, 5, 9, 10, 5, 18, 3, 12, 11, 5, 18, 12, 3, 16, 5, 5, 8, 6, 7, 5, 3, 6, 5, 4, 3, 8, 3, 12, 10, 8, 8, 8, 27, 4, 4, 9, 9, 7, 3, 8, 8, 26, 19, 10, 5, 4, 9, 11, 25, 4, 24, 13, 28, 5, 4, 4, 38, 34, 16, 18, 9, 1, 7, 3, 4, 8, 12, 5, 21, 9, 9, 17, 21, 19, 5, 15, 8, 6, 5, 25, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.295886756172358, "mean_inference_ms": 1.2946438732135181, "mean_action_processing_ms": 0.2115229763872184, "mean_env_wait_ms": 643.0556978888602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01035618782043457, "StateBufferConnector_ms": 0.020154714584350586, "ViewRequirementAgentConnector_ms": 0.18295025825500488}, "num_episodes": 42, "episode_return_max": 122.27086951616224, "episode_return_min": -33.4641865471628, "episode_return_mean": 10.019756554240164}, "episode_reward_max": 122.27086951616224, "episode_reward_min": -33.4641865471628, "episode_reward_mean": 10.019756554240164, "episode_len_mean": 10.83, "episodes_this_iter": 42, "episodes_timesteps_total": 1083, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.799314951885492, -0.5473299510814513, 34.63137782048635, -17.292251422588834, 12.280586294689897, 81.82395212762138, -1.6008661276748626, 3.949182128906159, 4.153346595784399, 3.10445023754329, 0.47173513996744987, 43.3573746435344, -17.543896484374955, 34.7672433619594, 6.7368073176272105, -20.153200028635354, 3.203189645946054, -8.24352000989434, 60.81538192753379, 57.60758353686094, 6.290683569067937, -4.542419659033385, 25.022088310920594, -11.882221471359685, 24.914135742187455, -31.883679199218818, 29.39775714938564, -0.0855748810229926, -21.378698802436418, 28.66047784532998, -2.018113011635478, -20.63360721480531, 21.514733886718886, 1.420881912707543, -13.911230468749977, -13.453579149467217, -27.174157714843886, -27.548805912885996, -33.4641865471628, -21.569031680610465, -10.124899446401741, 10.955358886718727, -21.23610974184595, -30.310290527343682, 2.800862217138956, -22.521923828125068, 18.365995203969348, -5.935378799761708, -28.684094238281205, 19.086732130275777, -10.315376332125936, 59.2008170837435, -21.0472902535803, -22.71567382812509, 0.27907045751078385, 17.617752726711444, 1.2650090694212963, -5.815356445312432, 10.844409179687318, 11.175408048269162, 72.12393226656144, 86.7542409566705, -8.289979706041962, 5.66479586715019, -26.33370361328116, -8.310319548447467, 25.649229250134567, 91.45712899271354, 1.1658359471959443, 73.6467672518067, 47.77819192300505, 39.1323979685896, -8.344728844855524, -8.00071940675707, -0.26809850416134395, 105.53497469315585, 122.27086951616224, 3.850470801939082, 51.748705414848814, -12.169454776372348, -18.771620149053163, -3.3623302709801948, -15.421891322169316, -18.559142426059452, 2.851187286045615, 35.63871447076343, -7.457496262288501, 27.46204088466635, 9.983982822573239, 19.631682879846352, 6.69028852440708, 35.26374866310573, 20.751581077731657, -9.889576114428976, 31.099200769054164, -14.104457166583131, -5.903387310729002, -6.65747815719908, 88.89309662016416, 2.8960381834075974], "episode_lengths": [9, 11, 29, 6, 7, 37, 6, 8, 9, 5, 10, 19, 12, 12, 7, 3, 4, 3, 31, 17, 5, 9, 10, 5, 18, 3, 12, 11, 5, 18, 12, 3, 16, 5, 5, 8, 6, 7, 5, 3, 6, 5, 4, 3, 8, 3, 12, 10, 8, 8, 8, 27, 4, 4, 9, 9, 7, 3, 8, 8, 26, 19, 10, 5, 4, 9, 11, 25, 4, 24, 13, 28, 5, 4, 4, 38, 34, 16, 18, 9, 1, 7, 3, 4, 8, 12, 5, 21, 9, 9, 17, 21, 19, 5, 15, 8, 6, 5, 25, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.295886756172358, "mean_inference_ms": 1.2946438732135181, "mean_action_processing_ms": 0.2115229763872184, "mean_env_wait_ms": 643.0556978888602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01035618782043457, "StateBufferConnector_ms": 0.020154714584350586, "ViewRequirementAgentConnector_ms": 0.18295025825500488}, "num_episodes": 42, "episode_return_max": 122.27086951616224, "episode_return_min": -33.4641865471628, "episode_return_mean": 10.019756554240164, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064, "num_agent_steps_trained": 2064, "num_env_steps_sampled": 2064, "num_env_steps_trained": 2064, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.125843603258016, "num_env_steps_trained_throughput_per_sec": 8.125843603258016, "timesteps_total": 2064, "num_env_steps_sampled_lifetime": 2064, "num_agent_steps_sampled_lifetime": 2064, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 2064, "timers": {"training_iteration_time_ms": 67466.863, "restore_workers_time_ms": 0.026, "training_step_time_ms": 67466.794, "sample_time_ms": 66796.821, "load_time_ms": 0.488, "load_throughput": 1057542.567, "learn_time_ms": 655.943, "learn_throughput": 786.653, "synch_weights_time_ms": 13.185}, "counters": {"num_env_steps_sampled": 2064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 2064, "num_agent_steps_trained": 2064}, "done": false, "episodes_total": 226, "training_iteration": 4, "trial_id": "fe178_00005", "date": "2024-08-15_16-56-57", "timestamp": 1723762617, "time_this_iter_s": 63.50512146949768, "time_total_s": 269.88334703445435, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 269.88334703445435, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.151648351648348, "ram_util_percent": 13.559340659340657}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.822110876441002, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.152009872595469, "policy_loss": -0.0337784784535567, "vf_loss": 7.1776766618092855, "vf_explained_var": 0.16944891115029653, "kl": 0.008111664377114873, "entropy": 1.1810262689987818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2580, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 2580, "num_agent_steps_trained": 2580}, "sampler_results": {"episode_reward_max": 122.27086951616224, "episode_reward_min": -33.4641865471628, "episode_reward_mean": 16.515393306766946, "episode_len_mean": 11.95, "episode_media": {}, "episodes_this_iter": 33, "episodes_timesteps_total": 1195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.420881912707543, -13.911230468749977, -13.453579149467217, -27.174157714843886, -27.548805912885996, -33.4641865471628, -21.569031680610465, -10.124899446401741, 10.955358886718727, -21.23610974184595, -30.310290527343682, 2.800862217138956, -22.521923828125068, 18.365995203969348, -5.935378799761708, -28.684094238281205, 19.086732130275777, -10.315376332125936, 59.2008170837435, -21.0472902535803, -22.71567382812509, 0.27907045751078385, 17.617752726711444, 1.2650090694212963, -5.815356445312432, 10.844409179687318, 11.175408048269162, 72.12393226656144, 86.7542409566705, -8.289979706041962, 5.66479586715019, -26.33370361328116, -8.310319548447467, 25.649229250134567, 91.45712899271354, 1.1658359471959443, 73.6467672518067, 47.77819192300505, 39.1323979685896, -8.344728844855524, -8.00071940675707, -0.26809850416134395, 105.53497469315585, 122.27086951616224, 3.850470801939082, 51.748705414848814, -12.169454776372348, -18.771620149053163, -3.3623302709801948, -15.421891322169316, -18.559142426059452, 2.851187286045615, 35.63871447076343, -7.457496262288501, 27.46204088466635, 9.983982822573239, 19.631682879846352, 6.69028852440708, 35.26374866310573, 20.751581077731657, -9.889576114428976, 31.099200769054164, -14.104457166583131, -5.903387310729002, -6.65747815719908, 88.89309662016416, 2.8960381834075974, 15.270317104206, 42.3012588202306, 1.1488443937863622, -8.209719510814878, 6.704242840356642, 100.97933845454945, 89.57787900848687, 27.689025894827225, 20.031134631688516, 9.316458365186463, -9.977643904225317, 16.7069973449685, 24.635894161519033, 11.705239167508694, 90.52020416499771, 37.84043316806746, 89.70048682841599, -13.544140625000068, 4.421406641747751, 105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543], "episode_lengths": [5, 5, 8, 6, 7, 5, 3, 6, 5, 4, 3, 8, 3, 12, 10, 8, 8, 8, 27, 4, 4, 9, 9, 7, 3, 8, 8, 26, 19, 10, 5, 4, 9, 11, 25, 4, 24, 13, 28, 5, 4, 4, 38, 34, 16, 18, 9, 1, 7, 3, 4, 8, 12, 5, 21, 9, 9, 17, 21, 19, 5, 15, 8, 6, 5, 25, 12, 10, 21, 7, 4, 9, 31, 39, 23, 12, 7, 6, 15, 9, 11, 26, 11, 31, 9, 4, 29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.488077917781865, "mean_inference_ms": 1.2912667176163601, "mean_action_processing_ms": 0.21105060741898407, "mean_env_wait_ms": 637.5005434536027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010722637176513672, "StateBufferConnector_ms": 0.01899266242980957, "ViewRequirementAgentConnector_ms": 0.18103432655334473}, "num_episodes": 33, "episode_return_max": 122.27086951616224, "episode_return_min": -33.4641865471628, "episode_return_mean": 16.515393306766946}, "env_runner_results": {"episode_reward_max": 122.27086951616224, "episode_reward_min": -33.4641865471628, "episode_reward_mean": 16.515393306766946, "episode_len_mean": 11.95, "episode_media": {}, "episodes_this_iter": 33, "episodes_timesteps_total": 1195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.420881912707543, -13.911230468749977, -13.453579149467217, -27.174157714843886, -27.548805912885996, -33.4641865471628, -21.569031680610465, -10.124899446401741, 10.955358886718727, -21.23610974184595, -30.310290527343682, 2.800862217138956, -22.521923828125068, 18.365995203969348, -5.935378799761708, -28.684094238281205, 19.086732130275777, -10.315376332125936, 59.2008170837435, -21.0472902535803, -22.71567382812509, 0.27907045751078385, 17.617752726711444, 1.2650090694212963, -5.815356445312432, 10.844409179687318, 11.175408048269162, 72.12393226656144, 86.7542409566705, -8.289979706041962, 5.66479586715019, -26.33370361328116, -8.310319548447467, 25.649229250134567, 91.45712899271354, 1.1658359471959443, 73.6467672518067, 47.77819192300505, 39.1323979685896, -8.344728844855524, -8.00071940675707, -0.26809850416134395, 105.53497469315585, 122.27086951616224, 3.850470801939082, 51.748705414848814, -12.169454776372348, -18.771620149053163, -3.3623302709801948, -15.421891322169316, -18.559142426059452, 2.851187286045615, 35.63871447076343, -7.457496262288501, 27.46204088466635, 9.983982822573239, 19.631682879846352, 6.69028852440708, 35.26374866310573, 20.751581077731657, -9.889576114428976, 31.099200769054164, -14.104457166583131, -5.903387310729002, -6.65747815719908, 88.89309662016416, 2.8960381834075974, 15.270317104206, 42.3012588202306, 1.1488443937863622, -8.209719510814878, 6.704242840356642, 100.97933845454945, 89.57787900848687, 27.689025894827225, 20.031134631688516, 9.316458365186463, -9.977643904225317, 16.7069973449685, 24.635894161519033, 11.705239167508694, 90.52020416499771, 37.84043316806746, 89.70048682841599, -13.544140625000068, 4.421406641747751, 105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543], "episode_lengths": [5, 5, 8, 6, 7, 5, 3, 6, 5, 4, 3, 8, 3, 12, 10, 8, 8, 8, 27, 4, 4, 9, 9, 7, 3, 8, 8, 26, 19, 10, 5, 4, 9, 11, 25, 4, 24, 13, 28, 5, 4, 4, 38, 34, 16, 18, 9, 1, 7, 3, 4, 8, 12, 5, 21, 9, 9, 17, 21, 19, 5, 15, 8, 6, 5, 25, 12, 10, 21, 7, 4, 9, 31, 39, 23, 12, 7, 6, 15, 9, 11, 26, 11, 31, 9, 4, 29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.488077917781865, "mean_inference_ms": 1.2912667176163601, "mean_action_processing_ms": 0.21105060741898407, "mean_env_wait_ms": 637.5005434536027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010722637176513672, "StateBufferConnector_ms": 0.01899266242980957, "ViewRequirementAgentConnector_ms": 0.18103432655334473}, "num_episodes": 33, "episode_return_max": 122.27086951616224, "episode_return_min": -33.4641865471628, "episode_return_mean": 16.515393306766946}, "episode_reward_max": 122.27086951616224, "episode_reward_min": -33.4641865471628, "episode_reward_mean": 16.515393306766946, "episode_len_mean": 11.95, "episodes_this_iter": 33, "episodes_timesteps_total": 1195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.420881912707543, -13.911230468749977, -13.453579149467217, -27.174157714843886, -27.548805912885996, -33.4641865471628, -21.569031680610465, -10.124899446401741, 10.955358886718727, -21.23610974184595, -30.310290527343682, 2.800862217138956, -22.521923828125068, 18.365995203969348, -5.935378799761708, -28.684094238281205, 19.086732130275777, -10.315376332125936, 59.2008170837435, -21.0472902535803, -22.71567382812509, 0.27907045751078385, 17.617752726711444, 1.2650090694212963, -5.815356445312432, 10.844409179687318, 11.175408048269162, 72.12393226656144, 86.7542409566705, -8.289979706041962, 5.66479586715019, -26.33370361328116, -8.310319548447467, 25.649229250134567, 91.45712899271354, 1.1658359471959443, 73.6467672518067, 47.77819192300505, 39.1323979685896, -8.344728844855524, -8.00071940675707, -0.26809850416134395, 105.53497469315585, 122.27086951616224, 3.850470801939082, 51.748705414848814, -12.169454776372348, -18.771620149053163, -3.3623302709801948, -15.421891322169316, -18.559142426059452, 2.851187286045615, 35.63871447076343, -7.457496262288501, 27.46204088466635, 9.983982822573239, 19.631682879846352, 6.69028852440708, 35.26374866310573, 20.751581077731657, -9.889576114428976, 31.099200769054164, -14.104457166583131, -5.903387310729002, -6.65747815719908, 88.89309662016416, 2.8960381834075974, 15.270317104206, 42.3012588202306, 1.1488443937863622, -8.209719510814878, 6.704242840356642, 100.97933845454945, 89.57787900848687, 27.689025894827225, 20.031134631688516, 9.316458365186463, -9.977643904225317, 16.7069973449685, 24.635894161519033, 11.705239167508694, 90.52020416499771, 37.84043316806746, 89.70048682841599, -13.544140625000068, 4.421406641747751, 105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543], "episode_lengths": [5, 5, 8, 6, 7, 5, 3, 6, 5, 4, 3, 8, 3, 12, 10, 8, 8, 8, 27, 4, 4, 9, 9, 7, 3, 8, 8, 26, 19, 10, 5, 4, 9, 11, 25, 4, 24, 13, 28, 5, 4, 4, 38, 34, 16, 18, 9, 1, 7, 3, 4, 8, 12, 5, 21, 9, 9, 17, 21, 19, 5, 15, 8, 6, 5, 25, 12, 10, 21, 7, 4, 9, 31, 39, 23, 12, 7, 6, 15, 9, 11, 26, 11, 31, 9, 4, 29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.488077917781865, "mean_inference_ms": 1.2912667176163601, "mean_action_processing_ms": 0.21105060741898407, "mean_env_wait_ms": 637.5005434536027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010722637176513672, "StateBufferConnector_ms": 0.01899266242980957, "ViewRequirementAgentConnector_ms": 0.18103432655334473}, "num_episodes": 33, "episode_return_max": 122.27086951616224, "episode_return_min": -33.4641865471628, "episode_return_mean": 16.515393306766946, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2580, "num_agent_steps_trained": 2580, "num_env_steps_sampled": 2580, "num_env_steps_trained": 2580, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.716719266706818, "num_env_steps_trained_throughput_per_sec": 8.716719266706818, "timesteps_total": 2580, "num_env_steps_sampled_lifetime": 2580, "num_agent_steps_sampled_lifetime": 2580, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 2580, "timers": {"training_iteration_time_ms": 65812.81, "restore_workers_time_ms": 0.025, "training_step_time_ms": 65812.744, "sample_time_ms": 65150.127, "load_time_ms": 0.461, "load_throughput": 1120217.839, "learn_time_ms": 648.568, "learn_throughput": 795.598, "synch_weights_time_ms": 13.242}, "counters": {"num_env_steps_sampled": 2580, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 2580, "num_agent_steps_trained": 2580}, "done": false, "episodes_total": 259, "training_iteration": 5, "trial_id": "fe178_00005", "date": "2024-08-15_16-57-57", "timestamp": 1723762677, "time_this_iter_s": 59.200636863708496, "time_total_s": 329.08398389816284, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 329.08398389816284, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 27.475, "ram_util_percent": 12.13809523809524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.311813195546468, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.348198660214742, "policy_loss": -0.03747939853152881, "vf_loss": 7.374379245440165, "vf_explained_var": 0.21906043688456217, "kl": 0.011298889901983482, "entropy": 1.1460735330979028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3096, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 3096, "num_agent_steps_trained": 3096}, "sampler_results": {"episode_reward_max": 148.43829370779395, "episode_reward_min": -26.33370361328116, "episode_reward_mean": 28.73427972890987, "episode_len_mean": 14.91, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 1491, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.7542409566705, -8.289979706041962, 5.66479586715019, -26.33370361328116, -8.310319548447467, 25.649229250134567, 91.45712899271354, 1.1658359471959443, 73.6467672518067, 47.77819192300505, 39.1323979685896, -8.344728844855524, -8.00071940675707, -0.26809850416134395, 105.53497469315585, 122.27086951616224, 3.850470801939082, 51.748705414848814, -12.169454776372348, -18.771620149053163, -3.3623302709801948, -15.421891322169316, -18.559142426059452, 2.851187286045615, 35.63871447076343, -7.457496262288501, 27.46204088466635, 9.983982822573239, 19.631682879846352, 6.69028852440708, 35.26374866310573, 20.751581077731657, -9.889576114428976, 31.099200769054164, -14.104457166583131, -5.903387310729002, -6.65747815719908, 88.89309662016416, 2.8960381834075974, 15.270317104206, 42.3012588202306, 1.1488443937863622, -8.209719510814878, 6.704242840356642, 100.97933845454945, 89.57787900848687, 27.689025894827225, 20.031134631688516, 9.316458365186463, -9.977643904225317, 16.7069973449685, 24.635894161519033, 11.705239167508694, 90.52020416499771, 37.84043316806746, 89.70048682841599, -13.544140625000068, 4.421406641747751, 105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494], "episode_lengths": [19, 10, 5, 4, 9, 11, 25, 4, 24, 13, 28, 5, 4, 4, 38, 34, 16, 18, 9, 1, 7, 3, 4, 8, 12, 5, 21, 9, 9, 17, 21, 19, 5, 15, 8, 6, 5, 25, 12, 10, 21, 7, 4, 9, 31, 39, 23, 12, 7, 6, 15, 9, 11, 26, 11, 31, 9, 4, 29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.74655749547812, "mean_inference_ms": 1.2880382646037023, "mean_action_processing_ms": 0.21084947305853532, "mean_env_wait_ms": 629.4671351160447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010547876358032227, "StateBufferConnector_ms": 0.015391826629638672, "ViewRequirementAgentConnector_ms": 0.18012738227844238}, "num_episodes": 28, "episode_return_max": 148.43829370779395, "episode_return_min": -26.33370361328116, "episode_return_mean": 28.73427972890987}, "env_runner_results": {"episode_reward_max": 148.43829370779395, "episode_reward_min": -26.33370361328116, "episode_reward_mean": 28.73427972890987, "episode_len_mean": 14.91, "episode_media": {}, "episodes_this_iter": 28, "episodes_timesteps_total": 1491, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.7542409566705, -8.289979706041962, 5.66479586715019, -26.33370361328116, -8.310319548447467, 25.649229250134567, 91.45712899271354, 1.1658359471959443, 73.6467672518067, 47.77819192300505, 39.1323979685896, -8.344728844855524, -8.00071940675707, -0.26809850416134395, 105.53497469315585, 122.27086951616224, 3.850470801939082, 51.748705414848814, -12.169454776372348, -18.771620149053163, -3.3623302709801948, -15.421891322169316, -18.559142426059452, 2.851187286045615, 35.63871447076343, -7.457496262288501, 27.46204088466635, 9.983982822573239, 19.631682879846352, 6.69028852440708, 35.26374866310573, 20.751581077731657, -9.889576114428976, 31.099200769054164, -14.104457166583131, -5.903387310729002, -6.65747815719908, 88.89309662016416, 2.8960381834075974, 15.270317104206, 42.3012588202306, 1.1488443937863622, -8.209719510814878, 6.704242840356642, 100.97933845454945, 89.57787900848687, 27.689025894827225, 20.031134631688516, 9.316458365186463, -9.977643904225317, 16.7069973449685, 24.635894161519033, 11.705239167508694, 90.52020416499771, 37.84043316806746, 89.70048682841599, -13.544140625000068, 4.421406641747751, 105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494], "episode_lengths": [19, 10, 5, 4, 9, 11, 25, 4, 24, 13, 28, 5, 4, 4, 38, 34, 16, 18, 9, 1, 7, 3, 4, 8, 12, 5, 21, 9, 9, 17, 21, 19, 5, 15, 8, 6, 5, 25, 12, 10, 21, 7, 4, 9, 31, 39, 23, 12, 7, 6, 15, 9, 11, 26, 11, 31, 9, 4, 29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.74655749547812, "mean_inference_ms": 1.2880382646037023, "mean_action_processing_ms": 0.21084947305853532, "mean_env_wait_ms": 629.4671351160447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010547876358032227, "StateBufferConnector_ms": 0.015391826629638672, "ViewRequirementAgentConnector_ms": 0.18012738227844238}, "num_episodes": 28, "episode_return_max": 148.43829370779395, "episode_return_min": -26.33370361328116, "episode_return_mean": 28.73427972890987}, "episode_reward_max": 148.43829370779395, "episode_reward_min": -26.33370361328116, "episode_reward_mean": 28.73427972890987, "episode_len_mean": 14.91, "episodes_this_iter": 28, "episodes_timesteps_total": 1491, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [86.7542409566705, -8.289979706041962, 5.66479586715019, -26.33370361328116, -8.310319548447467, 25.649229250134567, 91.45712899271354, 1.1658359471959443, 73.6467672518067, 47.77819192300505, 39.1323979685896, -8.344728844855524, -8.00071940675707, -0.26809850416134395, 105.53497469315585, 122.27086951616224, 3.850470801939082, 51.748705414848814, -12.169454776372348, -18.771620149053163, -3.3623302709801948, -15.421891322169316, -18.559142426059452, 2.851187286045615, 35.63871447076343, -7.457496262288501, 27.46204088466635, 9.983982822573239, 19.631682879846352, 6.69028852440708, 35.26374866310573, 20.751581077731657, -9.889576114428976, 31.099200769054164, -14.104457166583131, -5.903387310729002, -6.65747815719908, 88.89309662016416, 2.8960381834075974, 15.270317104206, 42.3012588202306, 1.1488443937863622, -8.209719510814878, 6.704242840356642, 100.97933845454945, 89.57787900848687, 27.689025894827225, 20.031134631688516, 9.316458365186463, -9.977643904225317, 16.7069973449685, 24.635894161519033, 11.705239167508694, 90.52020416499771, 37.84043316806746, 89.70048682841599, -13.544140625000068, 4.421406641747751, 105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494], "episode_lengths": [19, 10, 5, 4, 9, 11, 25, 4, 24, 13, 28, 5, 4, 4, 38, 34, 16, 18, 9, 1, 7, 3, 4, 8, 12, 5, 21, 9, 9, 17, 21, 19, 5, 15, 8, 6, 5, 25, 12, 10, 21, 7, 4, 9, 31, 39, 23, 12, 7, 6, 15, 9, 11, 26, 11, 31, 9, 4, 29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.74655749547812, "mean_inference_ms": 1.2880382646037023, "mean_action_processing_ms": 0.21084947305853532, "mean_env_wait_ms": 629.4671351160447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010547876358032227, "StateBufferConnector_ms": 0.015391826629638672, "ViewRequirementAgentConnector_ms": 0.18012738227844238}, "num_episodes": 28, "episode_return_max": 148.43829370779395, "episode_return_min": -26.33370361328116, "episode_return_mean": 28.73427972890987, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3096, "num_agent_steps_trained": 3096, "num_env_steps_sampled": 3096, "num_env_steps_trained": 3096, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.32131516156102, "num_env_steps_trained_throughput_per_sec": 9.32131516156102, "timesteps_total": 3096, "num_env_steps_sampled_lifetime": 3096, "num_agent_steps_sampled_lifetime": 3096, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 3096, "timers": {"training_iteration_time_ms": 64070.176, "restore_workers_time_ms": 0.025, "training_step_time_ms": 64070.112, "sample_time_ms": 63411.42, "load_time_ms": 0.44, "load_throughput": 1173571.187, "learn_time_ms": 644.893, "learn_throughput": 800.133, "synch_weights_time_ms": 13.04}, "counters": {"num_env_steps_sampled": 3096, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 3096, "num_agent_steps_trained": 3096}, "done": false, "episodes_total": 287, "training_iteration": 6, "trial_id": "fe178_00005", "date": "2024-08-15_16-58-52", "timestamp": 1723762732, "time_this_iter_s": 55.36063551902771, "time_total_s": 384.44461941719055, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 384.44461941719055, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.350632911392402, "ram_util_percent": 13.110126582278484}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.210105751951535, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.131781534353892, "policy_loss": -0.017722874809987844, "vf_loss": 7.144775211811066, "vf_explained_var": 0.2850464478135109, "kl": 0.004729264749767096, "entropy": 1.159212228655815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3612, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 3612, "num_agent_steps_trained": 3612}, "sampler_results": {"episode_reward_max": 190.95164547369546, "episode_reward_min": -18.559142426059452, "episode_reward_mean": 37.20956941341632, "episode_len_mean": 16.94, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 1694, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3623302709801948, -15.421891322169316, -18.559142426059452, 2.851187286045615, 35.63871447076343, -7.457496262288501, 27.46204088466635, 9.983982822573239, 19.631682879846352, 6.69028852440708, 35.26374866310573, 20.751581077731657, -9.889576114428976, 31.099200769054164, -14.104457166583131, -5.903387310729002, -6.65747815719908, 88.89309662016416, 2.8960381834075974, 15.270317104206, 42.3012588202306, 1.1488443937863622, -8.209719510814878, 6.704242840356642, 100.97933845454945, 89.57787900848687, 27.689025894827225, 20.031134631688516, 9.316458365186463, -9.977643904225317, 16.7069973449685, 24.635894161519033, 11.705239167508694, 90.52020416499771, 37.84043316806746, 89.70048682841599, -13.544140625000068, 4.421406641747751, 105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987], "episode_lengths": [7, 3, 4, 8, 12, 5, 21, 9, 9, 17, 21, 19, 5, 15, 8, 6, 5, 25, 12, 10, 21, 7, 4, 9, 31, 39, 23, 12, 7, 6, 15, 9, 11, 26, 11, 31, 9, 4, 29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.053545525142383, "mean_inference_ms": 1.2860718049070679, "mean_action_processing_ms": 0.21067723998583868, "mean_env_wait_ms": 624.8677383243946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010673999786376953, "StateBufferConnector_ms": 0.013986825942993164, "ViewRequirementAgentConnector_ms": 0.17964577674865723}, "num_episodes": 20, "episode_return_max": 190.95164547369546, "episode_return_min": -18.559142426059452, "episode_return_mean": 37.20956941341632}, "env_runner_results": {"episode_reward_max": 190.95164547369546, "episode_reward_min": -18.559142426059452, "episode_reward_mean": 37.20956941341632, "episode_len_mean": 16.94, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 1694, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3623302709801948, -15.421891322169316, -18.559142426059452, 2.851187286045615, 35.63871447076343, -7.457496262288501, 27.46204088466635, 9.983982822573239, 19.631682879846352, 6.69028852440708, 35.26374866310573, 20.751581077731657, -9.889576114428976, 31.099200769054164, -14.104457166583131, -5.903387310729002, -6.65747815719908, 88.89309662016416, 2.8960381834075974, 15.270317104206, 42.3012588202306, 1.1488443937863622, -8.209719510814878, 6.704242840356642, 100.97933845454945, 89.57787900848687, 27.689025894827225, 20.031134631688516, 9.316458365186463, -9.977643904225317, 16.7069973449685, 24.635894161519033, 11.705239167508694, 90.52020416499771, 37.84043316806746, 89.70048682841599, -13.544140625000068, 4.421406641747751, 105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987], "episode_lengths": [7, 3, 4, 8, 12, 5, 21, 9, 9, 17, 21, 19, 5, 15, 8, 6, 5, 25, 12, 10, 21, 7, 4, 9, 31, 39, 23, 12, 7, 6, 15, 9, 11, 26, 11, 31, 9, 4, 29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.053545525142383, "mean_inference_ms": 1.2860718049070679, "mean_action_processing_ms": 0.21067723998583868, "mean_env_wait_ms": 624.8677383243946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010673999786376953, "StateBufferConnector_ms": 0.013986825942993164, "ViewRequirementAgentConnector_ms": 0.17964577674865723}, "num_episodes": 20, "episode_return_max": 190.95164547369546, "episode_return_min": -18.559142426059452, "episode_return_mean": 37.20956941341632}, "episode_reward_max": 190.95164547369546, "episode_reward_min": -18.559142426059452, "episode_reward_mean": 37.20956941341632, "episode_len_mean": 16.94, "episodes_this_iter": 20, "episodes_timesteps_total": 1694, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3623302709801948, -15.421891322169316, -18.559142426059452, 2.851187286045615, 35.63871447076343, -7.457496262288501, 27.46204088466635, 9.983982822573239, 19.631682879846352, 6.69028852440708, 35.26374866310573, 20.751581077731657, -9.889576114428976, 31.099200769054164, -14.104457166583131, -5.903387310729002, -6.65747815719908, 88.89309662016416, 2.8960381834075974, 15.270317104206, 42.3012588202306, 1.1488443937863622, -8.209719510814878, 6.704242840356642, 100.97933845454945, 89.57787900848687, 27.689025894827225, 20.031134631688516, 9.316458365186463, -9.977643904225317, 16.7069973449685, 24.635894161519033, 11.705239167508694, 90.52020416499771, 37.84043316806746, 89.70048682841599, -13.544140625000068, 4.421406641747751, 105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987], "episode_lengths": [7, 3, 4, 8, 12, 5, 21, 9, 9, 17, 21, 19, 5, 15, 8, 6, 5, 25, 12, 10, 21, 7, 4, 9, 31, 39, 23, 12, 7, 6, 15, 9, 11, 26, 11, 31, 9, 4, 29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.053545525142383, "mean_inference_ms": 1.2860718049070679, "mean_action_processing_ms": 0.21067723998583868, "mean_env_wait_ms": 624.8677383243946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010673999786376953, "StateBufferConnector_ms": 0.013986825942993164, "ViewRequirementAgentConnector_ms": 0.17964577674865723}, "num_episodes": 20, "episode_return_max": 190.95164547369546, "episode_return_min": -18.559142426059452, "episode_return_mean": 37.20956941341632, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3612, "num_agent_steps_trained": 3612, "num_env_steps_sampled": 3612, "num_env_steps_trained": 3612, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.514076044635006, "num_env_steps_trained_throughput_per_sec": 8.514076044635006, "timesteps_total": 3612, "num_env_steps_sampled_lifetime": 3612, "num_agent_steps_sampled_lifetime": 3612, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 3612, "timers": {"training_iteration_time_ms": 63575.226, "restore_workers_time_ms": 0.024, "training_step_time_ms": 63575.166, "sample_time_ms": 62913.565, "load_time_ms": 0.423, "load_throughput": 1221169.277, "learn_time_ms": 647.926, "learn_throughput": 796.387, "synch_weights_time_ms": 12.95}, "counters": {"num_env_steps_sampled": 3612, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 3612, "num_agent_steps_trained": 3612}, "done": false, "episodes_total": 307, "training_iteration": 7, "trial_id": "fe178_00005", "date": "2024-08-15_16-59-53", "timestamp": 1723762793, "time_this_iter_s": 60.60890316963196, "time_total_s": 445.0535225868225, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 445.0535225868225, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.045977011494262, "ram_util_percent": 13.343678160919552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.025525532166163, "cur_kl_coeff": 0.5, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.512017881870269, "policy_loss": -0.03163106074401488, "vf_loss": 7.5382517099380495, "vf_explained_var": 0.38221038977305094, "kl": 0.01079456610405796, "entropy": 1.0813082019488016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4128, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 4128, "num_agent_steps_trained": 4128}, "sampler_results": {"episode_reward_max": 190.95164547369546, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 50.13904351838207, "episode_len_mean": 19.99, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 1999, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.704242840356642, 100.97933845454945, 89.57787900848687, 27.689025894827225, 20.031134631688516, 9.316458365186463, -9.977643904225317, 16.7069973449685, 24.635894161519033, 11.705239167508694, 90.52020416499771, 37.84043316806746, 89.70048682841599, -13.544140625000068, 4.421406641747751, 105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865], "episode_lengths": [9, 31, 39, 23, 12, 7, 6, 15, 9, 11, 26, 11, 31, 9, 4, 29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.738597297891566, "mean_inference_ms": 1.2838119205730474, "mean_action_processing_ms": 0.2104942908356644, "mean_env_wait_ms": 619.078897253914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010596275329589844, "StateBufferConnector_ms": 0.011770248413085938, "ViewRequirementAgentConnector_ms": 0.17928624153137207}, "num_episodes": 23, "episode_return_max": 190.95164547369546, "episode_return_min": -16.617272949218773, "episode_return_mean": 50.13904351838207}, "env_runner_results": {"episode_reward_max": 190.95164547369546, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 50.13904351838207, "episode_len_mean": 19.99, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 1999, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.704242840356642, 100.97933845454945, 89.57787900848687, 27.689025894827225, 20.031134631688516, 9.316458365186463, -9.977643904225317, 16.7069973449685, 24.635894161519033, 11.705239167508694, 90.52020416499771, 37.84043316806746, 89.70048682841599, -13.544140625000068, 4.421406641747751, 105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865], "episode_lengths": [9, 31, 39, 23, 12, 7, 6, 15, 9, 11, 26, 11, 31, 9, 4, 29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.738597297891566, "mean_inference_ms": 1.2838119205730474, "mean_action_processing_ms": 0.2104942908356644, "mean_env_wait_ms": 619.078897253914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010596275329589844, "StateBufferConnector_ms": 0.011770248413085938, "ViewRequirementAgentConnector_ms": 0.17928624153137207}, "num_episodes": 23, "episode_return_max": 190.95164547369546, "episode_return_min": -16.617272949218773, "episode_return_mean": 50.13904351838207}, "episode_reward_max": 190.95164547369546, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 50.13904351838207, "episode_len_mean": 19.99, "episodes_this_iter": 23, "episodes_timesteps_total": 1999, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.704242840356642, 100.97933845454945, 89.57787900848687, 27.689025894827225, 20.031134631688516, 9.316458365186463, -9.977643904225317, 16.7069973449685, 24.635894161519033, 11.705239167508694, 90.52020416499771, 37.84043316806746, 89.70048682841599, -13.544140625000068, 4.421406641747751, 105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865], "episode_lengths": [9, 31, 39, 23, 12, 7, 6, 15, 9, 11, 26, 11, 31, 9, 4, 29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.738597297891566, "mean_inference_ms": 1.2838119205730474, "mean_action_processing_ms": 0.2104942908356644, "mean_env_wait_ms": 619.078897253914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010596275329589844, "StateBufferConnector_ms": 0.011770248413085938, "ViewRequirementAgentConnector_ms": 0.17928624153137207}, "num_episodes": 23, "episode_return_max": 190.95164547369546, "episode_return_min": -16.617272949218773, "episode_return_mean": 50.13904351838207, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4128, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 4128, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.707605806143263, "num_env_steps_trained_throughput_per_sec": 8.707605806143263, "timesteps_total": 4128, "num_env_steps_sampled_lifetime": 4128, "num_agent_steps_sampled_lifetime": 4128, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 4128, "timers": {"training_iteration_time_ms": 63035.642, "restore_workers_time_ms": 0.023, "training_step_time_ms": 63035.583, "sample_time_ms": 62377.761, "load_time_ms": 0.421, "load_throughput": 1226818.317, "learn_time_ms": 644.129, "learn_throughput": 801.082, "synch_weights_time_ms": 12.978}, "counters": {"num_env_steps_sampled": 4128, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 4128, "num_agent_steps_trained": 4128}, "done": false, "episodes_total": 330, "training_iteration": 8, "trial_id": "fe178_00005", "date": "2024-08-15_17-00-52", "timestamp": 1723762852, "time_this_iter_s": 59.262577533721924, "time_total_s": 504.31610012054443, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 504.31610012054443, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 27.00235294117647, "ram_util_percent": 13.49882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.602663038174311, "cur_kl_coeff": 0.5, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.526310241222381, "policy_loss": -0.02018690521363169, "vf_loss": 7.541522280375163, "vf_explained_var": 0.43388257871071495, "kl": 0.009949737172004034, "entropy": 1.0488607714573541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4644, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 4644, "num_agent_steps_trained": 4644}, "sampler_results": {"episode_reward_max": 217.48595698959042, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 58.3279372971381, "episode_len_mean": 21.87, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 2187, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935], "episode_lengths": [29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.13133012601056, "mean_inference_ms": 1.2824141138819625, "mean_action_processing_ms": 0.21021382589014037, "mean_env_wait_ms": 618.3888248020277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010416269302368164, "StateBufferConnector_ms": 0.010684967041015625, "ViewRequirementAgentConnector_ms": 0.17768287658691406}, "num_episodes": 15, "episode_return_max": 217.48595698959042, "episode_return_min": -16.617272949218773, "episode_return_mean": 58.3279372971381}, "env_runner_results": {"episode_reward_max": 217.48595698959042, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 58.3279372971381, "episode_len_mean": 21.87, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 2187, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935], "episode_lengths": [29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.13133012601056, "mean_inference_ms": 1.2824141138819625, "mean_action_processing_ms": 0.21021382589014037, "mean_env_wait_ms": 618.3888248020277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010416269302368164, "StateBufferConnector_ms": 0.010684967041015625, "ViewRequirementAgentConnector_ms": 0.17768287658691406}, "num_episodes": 15, "episode_return_max": 217.48595698959042, "episode_return_min": -16.617272949218773, "episode_return_mean": 58.3279372971381}, "episode_reward_max": 217.48595698959042, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 58.3279372971381, "episode_len_mean": 21.87, "episodes_this_iter": 15, "episodes_timesteps_total": 2187, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [105.51934391927631, 51.15613904720931, 48.6160564375254, 13.86544078032125, 10.631119376569359, -6.443033405786025, 7.641305236834157, 60.96677780915081, 43.19358590612556, 23.67662476304679, 8.75738525390625, 9.427154128709589, 58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935], "episode_lengths": [29, 14, 30, 6, 12, 19, 9, 22, 13, 13, 4, 8, 16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.13133012601056, "mean_inference_ms": 1.2824141138819625, "mean_action_processing_ms": 0.21021382589014037, "mean_env_wait_ms": 618.3888248020277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010416269302368164, "StateBufferConnector_ms": 0.010684967041015625, "ViewRequirementAgentConnector_ms": 0.17768287658691406}, "num_episodes": 15, "episode_return_max": 217.48595698959042, "episode_return_min": -16.617272949218773, "episode_return_mean": 58.3279372971381, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4644, "num_agent_steps_trained": 4644, "num_env_steps_sampled": 4644, "num_env_steps_trained": 4644, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.891280623333986, "num_env_steps_trained_throughput_per_sec": 7.891280623333986, "timesteps_total": 4644, "num_env_steps_sampled_lifetime": 4644, "num_agent_steps_sampled_lifetime": 4644, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 4644, "timers": {"training_iteration_time_ms": 63297.086, "restore_workers_time_ms": 0.022, "training_step_time_ms": 63297.029, "sample_time_ms": 62639.866, "load_time_ms": 0.407, "load_throughput": 1267461.464, "learn_time_ms": 643.472, "learn_throughput": 801.9, "synch_weights_time_ms": 12.994}, "counters": {"num_env_steps_sampled": 4644, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 4644, "num_agent_steps_trained": 4644}, "done": false, "episodes_total": 345, "training_iteration": 9, "trial_id": "fe178_00005", "date": "2024-08-15_17-01-57", "timestamp": 1723762917, "time_this_iter_s": 65.39209961891174, "time_total_s": 569.7081997394562, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 569.7081997394562, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.08172043010753, "ram_util_percent": 13.667741935483873}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.193434023857117, "cur_kl_coeff": 0.5, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.805240726470947, "policy_loss": -0.019047236551220217, "vf_loss": 7.820409286022186, "vf_explained_var": 0.3068550114830335, "kl": 0.007757189245383719, "entropy": 1.048655705153942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5160, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 5160, "num_agent_steps_trained": 5160}, "sampler_results": {"episode_reward_max": 250.6712809967883, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 73.34133629323577, "episode_len_mean": 25.56, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2556, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312], "episode_lengths": [16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.273359754525835, "mean_inference_ms": 1.2806016840754924, "mean_action_processing_ms": 0.21014355292771747, "mean_env_wait_ms": 617.829125609755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010398387908935547, "StateBufferConnector_ms": 0.009911060333251953, "ViewRequirementAgentConnector_ms": 0.17781281471252441}, "num_episodes": 12, "episode_return_max": 250.6712809967883, "episode_return_min": -16.617272949218773, "episode_return_mean": 73.34133629323577}, "env_runner_results": {"episode_reward_max": 250.6712809967883, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 73.34133629323577, "episode_len_mean": 25.56, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2556, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312], "episode_lengths": [16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.273359754525835, "mean_inference_ms": 1.2806016840754924, "mean_action_processing_ms": 0.21014355292771747, "mean_env_wait_ms": 617.829125609755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010398387908935547, "StateBufferConnector_ms": 0.009911060333251953, "ViewRequirementAgentConnector_ms": 0.17781281471252441}, "num_episodes": 12, "episode_return_max": 250.6712809967883, "episode_return_min": -16.617272949218773, "episode_return_mean": 73.34133629323577}, "episode_reward_max": 250.6712809967883, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 73.34133629323577, "episode_len_mean": 25.56, "episodes_this_iter": 12, "episodes_timesteps_total": 2556, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.373249634079954, -13.939106614598543, 99.33373464088947, 25.69821164847103, -2.8755236568952114, 16.53645502548852, 128.43864408771057, 115.59847660599354, 31.309627685689506, -0.8395927218199688, -6.993693453275625, 37.71809460446222, 54.15191292764854, 65.63440459086496, 148.43829370779395, 19.915197747156753, 43.846659654195435, -1.5077251276702128, 5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312], "episode_lengths": [16, 4, 50, 18, 8, 11, 46, 39, 11, 9, 5, 9, 25, 30, 50, 9, 16, 5, 13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.273359754525835, "mean_inference_ms": 1.2806016840754924, "mean_action_processing_ms": 0.21014355292771747, "mean_env_wait_ms": 617.829125609755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010398387908935547, "StateBufferConnector_ms": 0.009911060333251953, "ViewRequirementAgentConnector_ms": 0.17781281471252441}, "num_episodes": 12, "episode_return_max": 250.6712809967883, "episode_return_min": -16.617272949218773, "episode_return_mean": 73.34133629323577, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160, "num_agent_steps_trained": 5160, "num_env_steps_sampled": 5160, "num_env_steps_trained": 5160, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.996635551409269, "num_env_steps_trained_throughput_per_sec": 7.996635551409269, "timesteps_total": 5160, "num_env_steps_sampled_lifetime": 5160, "num_agent_steps_sampled_lifetime": 5160, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 5160, "timers": {"training_iteration_time_ms": 63420.092, "restore_workers_time_ms": 0.021, "training_step_time_ms": 63420.038, "sample_time_ms": 62761.273, "load_time_ms": 0.402, "load_throughput": 1284199.172, "learn_time_ms": 645.08, "learn_throughput": 799.901, "synch_weights_time_ms": 13.0}, "counters": {"num_env_steps_sampled": 5160, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 5160, "num_agent_steps_trained": 5160}, "done": false, "episodes_total": 357, "training_iteration": 10, "trial_id": "fe178_00005", "date": "2024-08-15_17-03-02", "timestamp": 1723762982, "time_this_iter_s": 64.53100538253784, "time_total_s": 634.239205121994, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 634.239205121994, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 23.76086956521739, "ram_util_percent": 13.781521739130431}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.181152679522832, "cur_kl_coeff": 0.5, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.681583034992218, "policy_loss": -0.027400390803813936, "vf_loss": 7.702873023351033, "vf_explained_var": 0.2231755514939626, "kl": 0.012220786517476483, "entropy": 0.9020184685786565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5676, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 5676, "num_agent_steps_trained": 5676}, "sampler_results": {"episode_reward_max": 260.6184798684706, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 83.23650905625458, "episode_len_mean": 27.2, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 2720, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706], "episode_lengths": [13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.447416445669475, "mean_inference_ms": 1.2791784442795586, "mean_action_processing_ms": 0.20993335596909474, "mean_env_wait_ms": 619.6380060024213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010435819625854492, "StateBufferConnector_ms": 0.008981943130493164, "ViewRequirementAgentConnector_ms": 0.17665648460388184}, "num_episodes": 18, "episode_return_max": 260.6184798684706, "episode_return_min": -16.617272949218773, "episode_return_mean": 83.23650905625458}, "env_runner_results": {"episode_reward_max": 260.6184798684706, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 83.23650905625458, "episode_len_mean": 27.2, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 2720, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706], "episode_lengths": [13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.447416445669475, "mean_inference_ms": 1.2791784442795586, "mean_action_processing_ms": 0.20993335596909474, "mean_env_wait_ms": 619.6380060024213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010435819625854492, "StateBufferConnector_ms": 0.008981943130493164, "ViewRequirementAgentConnector_ms": 0.17665648460388184}, "num_episodes": 18, "episode_return_max": 260.6184798684706, "episode_return_min": -16.617272949218773, "episode_return_mean": 83.23650905625458}, "episode_reward_max": 260.6184798684706, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 83.23650905625458, "episode_len_mean": 27.2, "episodes_this_iter": 18, "episodes_timesteps_total": 2720, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.909685056223424, 74.06208915507517, 73.4563709506391, 18.93740718612372, 22.026693805738233, 6.143948049820665, 10.227457115295692, 29.44987686971534, 52.77898567560463, 2.1022865733518046, 42.88081957205668, 18.818688506036494, 40.22023107631048, 97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706], "episode_lengths": [13, 30, 24, 9, 16, 10, 8, 11, 20, 10, 15, 8, 12, 50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.447416445669475, "mean_inference_ms": 1.2791784442795586, "mean_action_processing_ms": 0.20993335596909474, "mean_env_wait_ms": 619.6380060024213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010435819625854492, "StateBufferConnector_ms": 0.008981943130493164, "ViewRequirementAgentConnector_ms": 0.17665648460388184}, "num_episodes": 18, "episode_return_max": 260.6184798684706, "episode_return_min": -16.617272949218773, "episode_return_mean": 83.23650905625458, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5676, "num_agent_steps_trained": 5676, "num_env_steps_sampled": 5676, "num_env_steps_trained": 5676, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.408439598109803, "num_env_steps_trained_throughput_per_sec": 8.408439598109803, "timesteps_total": 5676, "num_env_steps_sampled_lifetime": 5676, "num_agent_steps_sampled_lifetime": 5676, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 5676, "timers": {"training_iteration_time_ms": 62212.45, "restore_workers_time_ms": 0.019, "training_step_time_ms": 62212.402, "sample_time_ms": 61551.206, "load_time_ms": 0.351, "load_throughput": 1470086.173, "learn_time_ms": 647.645, "learn_throughput": 796.733, "synch_weights_time_ms": 12.949}, "counters": {"num_env_steps_sampled": 5676, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 5676, "num_agent_steps_trained": 5676}, "done": false, "episodes_total": 375, "training_iteration": 11, "trial_id": "fe178_00005", "date": "2024-08-15_17-04-03", "timestamp": 1723763043, "time_this_iter_s": 61.37049126625061, "time_total_s": 695.6096963882446, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 695.6096963882446, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.79659090909091, "ram_util_percent": 13.907954545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.167447983225187, "cur_kl_coeff": 0.5, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.046680454413096, "policy_loss": -0.02729145224827031, "vf_loss": 8.069422574838002, "vf_explained_var": 0.1946435198187828, "kl": 0.009098689727905812, "entropy": 0.9528989916046461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6192, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 6192, "num_agent_steps_trained": 6192}, "sampler_results": {"episode_reward_max": 260.6184798684706, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 93.23543472101088, "episode_len_mean": 29.8, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 2980, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137], "episode_lengths": [50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.574293201876296, "mean_inference_ms": 1.277359103325002, "mean_action_processing_ms": 0.20988228433891476, "mean_env_wait_ms": 620.6643018138252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010320901870727539, "StateBufferConnector_ms": 0.008782386779785156, "ViewRequirementAgentConnector_ms": 0.1764051914215088}, "num_episodes": 13, "episode_return_max": 260.6184798684706, "episode_return_min": -16.617272949218773, "episode_return_mean": 93.23543472101088}, "env_runner_results": {"episode_reward_max": 260.6184798684706, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 93.23543472101088, "episode_len_mean": 29.8, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 2980, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137], "episode_lengths": [50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.574293201876296, "mean_inference_ms": 1.277359103325002, "mean_action_processing_ms": 0.20988228433891476, "mean_env_wait_ms": 620.6643018138252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010320901870727539, "StateBufferConnector_ms": 0.008782386779785156, "ViewRequirementAgentConnector_ms": 0.1764051914215088}, "num_episodes": 13, "episode_return_max": 260.6184798684706, "episode_return_min": -16.617272949218773, "episode_return_mean": 93.23543472101088}, "episode_reward_max": 260.6184798684706, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 93.23543472101088, "episode_len_mean": 29.8, "episodes_this_iter": 13, "episodes_timesteps_total": 2980, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [97.21282436271571, 5.176036113501638, 26.40833590860524, 180.87636239226714, 55.395403989134536, 71.32312463523056, 28.308513705146993, 114.32460654211462, -9.81470451213022, 17.488906829220298, 76.7362440775729, 41.28830186669552, 100.37808269976045, 57.14743363486434, 141.1108323049416, 101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137], "episode_lengths": [50, 8, 12, 50, 24, 30, 15, 28, 4, 11, 24, 11, 33, 27, 31, 30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.574293201876296, "mean_inference_ms": 1.277359103325002, "mean_action_processing_ms": 0.20988228433891476, "mean_env_wait_ms": 620.6643018138252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010320901870727539, "StateBufferConnector_ms": 0.008782386779785156, "ViewRequirementAgentConnector_ms": 0.1764051914215088}, "num_episodes": 13, "episode_return_max": 260.6184798684706, "episode_return_min": -16.617272949218773, "episode_return_mean": 93.23543472101088, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6192, "num_agent_steps_trained": 6192, "num_env_steps_sampled": 6192, "num_env_steps_trained": 6192, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.801586417545424, "num_env_steps_trained_throughput_per_sec": 8.801586417545424, "timesteps_total": 6192, "num_env_steps_sampled_lifetime": 6192, "num_agent_steps_sampled_lifetime": 6192, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 6192, "timers": {"training_iteration_time_ms": 61591.12, "restore_workers_time_ms": 0.018, "training_step_time_ms": 61591.074, "sample_time_ms": 60928.314, "load_time_ms": 0.345, "load_throughput": 1494448.877, "learn_time_ms": 649.148, "learn_throughput": 794.888, "synch_weights_time_ms": 13.018}, "counters": {"num_env_steps_sampled": 6192, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 6192, "num_agent_steps_trained": 6192}, "done": false, "episodes_total": 388, "training_iteration": 12, "trial_id": "fe178_00005", "date": "2024-08-15_17-05-02", "timestamp": 1723763102, "time_this_iter_s": 58.62973237037659, "time_total_s": 754.2394287586212, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 754.2394287586212, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 26.118072289156622, "ram_util_percent": 14.030120481927705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.586730444431305, "cur_kl_coeff": 0.5, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.994776745637258, "policy_loss": -0.024213554663583638, "vf_loss": 8.015051166216532, "vf_explained_var": 0.3661808942755063, "kl": 0.007878164312630057, "entropy": 0.8394970779617628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6708, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 6708, "num_agent_steps_trained": 6708}, "sampler_results": {"episode_reward_max": 260.6184798684706, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 107.60481493245469, "episode_len_mean": 32.43, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 3243, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137, 162.0473934772084, 226.94496215759642, 90.52257707335207, 200.79678874712744, 210.22291254908862, 65.40935087764029, 29.52912731542368, 182.77389802712702, 217.8964371164817, 37.287266507425656, 218.726694047009, 212.5678459312404, 228.83209431159452, 182.89943425936195, 173.8415432963422], "episode_lengths": [30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9, 50, 50, 30, 50, 50, 19, 11, 50, 50, 11, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.858550761406912, "mean_inference_ms": 1.2758279589085137, "mean_action_processing_ms": 0.20955764222802223, "mean_env_wait_ms": 622.3044952974291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010281085968017578, "StateBufferConnector_ms": 0.008375167846679688, "ViewRequirementAgentConnector_ms": 0.17583727836608887}, "num_episodes": 15, "episode_return_max": 260.6184798684706, "episode_return_min": -16.617272949218773, "episode_return_mean": 107.60481493245469}, "env_runner_results": {"episode_reward_max": 260.6184798684706, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 107.60481493245469, "episode_len_mean": 32.43, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 3243, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137, 162.0473934772084, 226.94496215759642, 90.52257707335207, 200.79678874712744, 210.22291254908862, 65.40935087764029, 29.52912731542368, 182.77389802712702, 217.8964371164817, 37.287266507425656, 218.726694047009, 212.5678459312404, 228.83209431159452, 182.89943425936195, 173.8415432963422], "episode_lengths": [30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9, 50, 50, 30, 50, 50, 19, 11, 50, 50, 11, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.858550761406912, "mean_inference_ms": 1.2758279589085137, "mean_action_processing_ms": 0.20955764222802223, "mean_env_wait_ms": 622.3044952974291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010281085968017578, "StateBufferConnector_ms": 0.008375167846679688, "ViewRequirementAgentConnector_ms": 0.17583727836608887}, "num_episodes": 15, "episode_return_max": 260.6184798684706, "episode_return_min": -16.617272949218773, "episode_return_mean": 107.60481493245469}, "episode_reward_max": 260.6184798684706, "episode_reward_min": -16.617272949218773, "episode_reward_mean": 107.60481493245469, "episode_len_mean": 32.43, "episodes_this_iter": 15, "episodes_timesteps_total": 3243, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [101.0132648739588, 190.95164547369546, -16.617272949218773, 92.76577946065987, 48.95436504844791, 121.86341373263127, 30.460009976274804, -1.7805621750289902, 178.72881563902342, 31.560075967613827, 30.707546450205015, 11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137, 162.0473934772084, 226.94496215759642, 90.52257707335207, 200.79678874712744, 210.22291254908862, 65.40935087764029, 29.52912731542368, 182.77389802712702, 217.8964371164817, 37.287266507425656, 218.726694047009, 212.5678459312404, 228.83209431159452, 182.89943425936195, 173.8415432963422], "episode_lengths": [30, 50, 5, 29, 27, 44, 10, 4, 48, 12, 10, 9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9, 50, 50, 30, 50, 50, 19, 11, 50, 50, 11, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.858550761406912, "mean_inference_ms": 1.2758279589085137, "mean_action_processing_ms": 0.20955764222802223, "mean_env_wait_ms": 622.3044952974291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010281085968017578, "StateBufferConnector_ms": 0.008375167846679688, "ViewRequirementAgentConnector_ms": 0.17583727836608887}, "num_episodes": 15, "episode_return_max": 260.6184798684706, "episode_return_min": -16.617272949218773, "episode_return_mean": 107.60481493245469, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6708, "num_agent_steps_trained": 6708, "num_env_steps_sampled": 6708, "num_env_steps_trained": 6708, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.474956307742142, "num_env_steps_trained_throughput_per_sec": 8.474956307742142, "timesteps_total": 6708, "num_env_steps_sampled_lifetime": 6708, "num_agent_steps_sampled_lifetime": 6708, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 6708, "timers": {"training_iteration_time_ms": 60871.259, "restore_workers_time_ms": 0.018, "training_step_time_ms": 60871.214, "sample_time_ms": 60212.863, "load_time_ms": 0.342, "load_throughput": 1509563.273, "learn_time_ms": 644.762, "learn_throughput": 800.295, "synch_weights_time_ms": 13.001}, "counters": {"num_env_steps_sampled": 6708, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 6708, "num_agent_steps_trained": 6708}, "done": false, "episodes_total": 403, "training_iteration": 13, "trial_id": "fe178_00005", "date": "2024-08-15_17-06-03", "timestamp": 1723763163, "time_this_iter_s": 60.88888764381409, "time_total_s": 815.1283164024353, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 815.1283164024353, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.46666666666666, "ram_util_percent": 13.512643678160913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.004278337955474, "cur_kl_coeff": 0.5, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.6980751315752665, "policy_loss": -0.04671607383061201, "vf_loss": 7.741176227728526, "vf_explained_var": 0.25041176279385885, "kl": 0.007229959781155951, "entropy": 0.8059820200006167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7224, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 7224, "num_agent_steps_trained": 7224}, "sampler_results": {"episode_reward_max": 260.6184798684706, "episode_reward_min": -9.572340506862588, "episode_reward_mean": 113.81581660422007, "episode_len_mean": 33.86, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3386, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137, 162.0473934772084, 226.94496215759642, 90.52257707335207, 200.79678874712744, 210.22291254908862, 65.40935087764029, 29.52912731542368, 182.77389802712702, 217.8964371164817, 37.287266507425656, 218.726694047009, 212.5678459312404, 228.83209431159452, 182.89943425936195, 173.8415432963422, 159.79546481573084, 26.354823525440707, 24.803696831643776, 142.952330713532, 47.301976257407205, 217.57002605096932, 160.37911275255522, 167.02187519444868, 186.4171087566935, 135.6309202550589, 161.47991352132226], "episode_lengths": [9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9, 50, 50, 30, 50, 50, 19, 11, 50, 50, 11, 50, 50, 50, 50, 50, 47, 14, 9, 50, 10, 50, 32, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.389498411851546, "mean_inference_ms": 1.2743362723796625, "mean_action_processing_ms": 0.2094635463720139, "mean_env_wait_ms": 623.4169544521775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010224580764770508, "StateBufferConnector_ms": 0.00817108154296875, "ViewRequirementAgentConnector_ms": 0.175767183303833}, "num_episodes": 11, "episode_return_max": 260.6184798684706, "episode_return_min": -9.572340506862588, "episode_return_mean": 113.81581660422007}, "env_runner_results": {"episode_reward_max": 260.6184798684706, "episode_reward_min": -9.572340506862588, "episode_reward_mean": 113.81581660422007, "episode_len_mean": 33.86, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3386, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137, 162.0473934772084, 226.94496215759642, 90.52257707335207, 200.79678874712744, 210.22291254908862, 65.40935087764029, 29.52912731542368, 182.77389802712702, 217.8964371164817, 37.287266507425656, 218.726694047009, 212.5678459312404, 228.83209431159452, 182.89943425936195, 173.8415432963422, 159.79546481573084, 26.354823525440707, 24.803696831643776, 142.952330713532, 47.301976257407205, 217.57002605096932, 160.37911275255522, 167.02187519444868, 186.4171087566935, 135.6309202550589, 161.47991352132226], "episode_lengths": [9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9, 50, 50, 30, 50, 50, 19, 11, 50, 50, 11, 50, 50, 50, 50, 50, 47, 14, 9, 50, 10, 50, 32, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.389498411851546, "mean_inference_ms": 1.2743362723796625, "mean_action_processing_ms": 0.2094635463720139, "mean_env_wait_ms": 623.4169544521775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010224580764770508, "StateBufferConnector_ms": 0.00817108154296875, "ViewRequirementAgentConnector_ms": 0.175767183303833}, "num_episodes": 11, "episode_return_max": 260.6184798684706, "episode_return_min": -9.572340506862588, "episode_return_mean": 113.81581660422007}, "episode_reward_max": 260.6184798684706, "episode_reward_min": -9.572340506862588, "episode_reward_mean": 113.81581660422007, "episode_len_mean": 33.86, "episodes_this_iter": 11, "episodes_timesteps_total": 3386, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.460651673684708, 116.32010709427718, 121.70390258142527, 73.14982234088143, 99.2649448196641, 53.44012955787791, 74.9451983609586, 87.19372527448351, 22.935527363264157, 154.80031458897514, 14.414237600064155, 1.5307350953418677, 32.461716967502966, 164.5605086602347, 25.09734250502771, 49.491385332479865, 149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137, 162.0473934772084, 226.94496215759642, 90.52257707335207, 200.79678874712744, 210.22291254908862, 65.40935087764029, 29.52912731542368, 182.77389802712702, 217.8964371164817, 37.287266507425656, 218.726694047009, 212.5678459312404, 228.83209431159452, 182.89943425936195, 173.8415432963422, 159.79546481573084, 26.354823525440707, 24.803696831643776, 142.952330713532, 47.301976257407205, 217.57002605096932, 160.37911275255522, 167.02187519444868, 186.4171087566935, 135.6309202550589, 161.47991352132226], "episode_lengths": [9, 30, 45, 29, 33, 31, 22, 26, 11, 50, 9, 6, 11, 50, 11, 30, 50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9, 50, 50, 30, 50, 50, 19, 11, 50, 50, 11, 50, 50, 50, 50, 50, 47, 14, 9, 50, 10, 50, 32, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.389498411851546, "mean_inference_ms": 1.2743362723796625, "mean_action_processing_ms": 0.2094635463720139, "mean_env_wait_ms": 623.4169544521775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010224580764770508, "StateBufferConnector_ms": 0.00817108154296875, "ViewRequirementAgentConnector_ms": 0.175767183303833}, "num_episodes": 11, "episode_return_max": 260.6184798684706, "episode_return_min": -9.572340506862588, "episode_return_mean": 113.81581660422007, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7224, "num_agent_steps_trained": 7224, "num_env_steps_sampled": 7224, "num_env_steps_trained": 7224, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.544350749402223, "num_env_steps_trained_throughput_per_sec": 8.544350749402223, "timesteps_total": 7224, "num_env_steps_sampled_lifetime": 7224, "num_agent_steps_sampled_lifetime": 7224, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 7224, "timers": {"training_iteration_time_ms": 60560.227, "restore_workers_time_ms": 0.016, "training_step_time_ms": 60560.186, "sample_time_ms": 59905.437, "load_time_ms": 0.334, "load_throughput": 1543695.338, "learn_time_ms": 641.204, "learn_throughput": 804.736, "synch_weights_time_ms": 12.97}, "counters": {"num_env_steps_sampled": 7224, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 7224, "num_agent_steps_trained": 7224}, "done": false, "episodes_total": 414, "training_iteration": 14, "trial_id": "fe178_00005", "date": "2024-08-15_17-07-03", "timestamp": 1723763223, "time_this_iter_s": 60.394325971603394, "time_total_s": 875.5226423740387, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 875.5226423740387, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.947126436781616, "ram_util_percent": 12.664367816091952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.05717942516009, "cur_kl_coeff": 0.5, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.102051321665446, "policy_loss": -0.025196929780455925, "vf_loss": 8.123085494836172, "vf_explained_var": 0.3093552187085152, "kl": 0.008325386224305476, "entropy": 0.7511627604564031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7740, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 7740, "num_agent_steps_trained": 7740}, "sampler_results": {"episode_reward_max": 260.6184798684706, "episode_reward_min": -9.572340506862588, "episode_reward_mean": 126.42734336601433, "episode_len_mean": 36.17, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 3617, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137, 162.0473934772084, 226.94496215759642, 90.52257707335207, 200.79678874712744, 210.22291254908862, 65.40935087764029, 29.52912731542368, 182.77389802712702, 217.8964371164817, 37.287266507425656, 218.726694047009, 212.5678459312404, 228.83209431159452, 182.89943425936195, 173.8415432963422, 159.79546481573084, 26.354823525440707, 24.803696831643776, 142.952330713532, 47.301976257407205, 217.57002605096932, 160.37911275255522, 167.02187519444868, 186.4171087566935, 135.6309202550589, 161.47991352132226, 199.9745441640177, 196.23945667346902, 198.75090972705252, 157.21717638563462, 184.7639477900271, 33.67532216813133, -6.992346010323615, 204.0497797517088, 227.38939563679997, 177.7366385104333, 195.27321564306425, 47.53527195583604, 46.978197232925794, 192.60480595192485, 102.864901754429, 205.8617086604362], "episode_lengths": [50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9, 50, 50, 30, 50, 50, 19, 11, 50, 50, 11, 50, 50, 50, 50, 50, 47, 14, 9, 50, 10, 50, 32, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 1, 50, 50, 50, 50, 11, 11, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.631109019369283, "mean_inference_ms": 1.2731421790843584, "mean_action_processing_ms": 0.20955593178561968, "mean_env_wait_ms": 625.1871659534398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010384559631347656, "StateBufferConnector_ms": 0.007871866226196289, "ViewRequirementAgentConnector_ms": 0.17601513862609863}, "num_episodes": 16, "episode_return_max": 260.6184798684706, "episode_return_min": -9.572340506862588, "episode_return_mean": 126.42734336601433}, "env_runner_results": {"episode_reward_max": 260.6184798684706, "episode_reward_min": -9.572340506862588, "episode_reward_mean": 126.42734336601433, "episode_len_mean": 36.17, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 3617, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137, 162.0473934772084, 226.94496215759642, 90.52257707335207, 200.79678874712744, 210.22291254908862, 65.40935087764029, 29.52912731542368, 182.77389802712702, 217.8964371164817, 37.287266507425656, 218.726694047009, 212.5678459312404, 228.83209431159452, 182.89943425936195, 173.8415432963422, 159.79546481573084, 26.354823525440707, 24.803696831643776, 142.952330713532, 47.301976257407205, 217.57002605096932, 160.37911275255522, 167.02187519444868, 186.4171087566935, 135.6309202550589, 161.47991352132226, 199.9745441640177, 196.23945667346902, 198.75090972705252, 157.21717638563462, 184.7639477900271, 33.67532216813133, -6.992346010323615, 204.0497797517088, 227.38939563679997, 177.7366385104333, 195.27321564306425, 47.53527195583604, 46.978197232925794, 192.60480595192485, 102.864901754429, 205.8617086604362], "episode_lengths": [50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9, 50, 50, 30, 50, 50, 19, 11, 50, 50, 11, 50, 50, 50, 50, 50, 47, 14, 9, 50, 10, 50, 32, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 1, 50, 50, 50, 50, 11, 11, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.631109019369283, "mean_inference_ms": 1.2731421790843584, "mean_action_processing_ms": 0.20955593178561968, "mean_env_wait_ms": 625.1871659534398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010384559631347656, "StateBufferConnector_ms": 0.007871866226196289, "ViewRequirementAgentConnector_ms": 0.17601513862609863}, "num_episodes": 16, "episode_return_max": 260.6184798684706, "episode_return_min": -9.572340506862588, "episode_return_mean": 126.42734336601433}, "episode_reward_max": 260.6184798684706, "episode_reward_min": -9.572340506862588, "episode_reward_mean": 126.42734336601433, "episode_len_mean": 36.17, "episodes_this_iter": 16, "episodes_timesteps_total": 3617, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [149.33668298150434, 50.29232685388706, 168.6052611161541, 169.16798021139988, 106.89379967932217, 33.013986670770464, 38.00736945928486, 10.735598312401791, 149.68708796951012, 217.48595698959042, 34.099986778973005, 46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137, 162.0473934772084, 226.94496215759642, 90.52257707335207, 200.79678874712744, 210.22291254908862, 65.40935087764029, 29.52912731542368, 182.77389802712702, 217.8964371164817, 37.287266507425656, 218.726694047009, 212.5678459312404, 228.83209431159452, 182.89943425936195, 173.8415432963422, 159.79546481573084, 26.354823525440707, 24.803696831643776, 142.952330713532, 47.301976257407205, 217.57002605096932, 160.37911275255522, 167.02187519444868, 186.4171087566935, 135.6309202550589, 161.47991352132226, 199.9745441640177, 196.23945667346902, 198.75090972705252, 157.21717638563462, 184.7639477900271, 33.67532216813133, -6.992346010323615, 204.0497797517088, 227.38939563679997, 177.7366385104333, 195.27321564306425, 47.53527195583604, 46.978197232925794, 192.60480595192485, 102.864901754429, 205.8617086604362], "episode_lengths": [50, 22, 50, 50, 30, 13, 10, 10, 49, 50, 12, 18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9, 50, 50, 30, 50, 50, 19, 11, 50, 50, 11, 50, 50, 50, 50, 50, 47, 14, 9, 50, 10, 50, 32, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 1, 50, 50, 50, 50, 11, 11, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.631109019369283, "mean_inference_ms": 1.2731421790843584, "mean_action_processing_ms": 0.20955593178561968, "mean_env_wait_ms": 625.1871659534398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010384559631347656, "StateBufferConnector_ms": 0.007871866226196289, "ViewRequirementAgentConnector_ms": 0.17601513862609863}, "num_episodes": 16, "episode_return_max": 260.6184798684706, "episode_return_min": -9.572340506862588, "episode_return_mean": 126.42734336601433, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7740, "num_agent_steps_trained": 7740, "num_env_steps_sampled": 7740, "num_env_steps_trained": 7740, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.537550820486281, "num_env_steps_trained_throughput_per_sec": 7.537550820486281, "timesteps_total": 7740, "num_env_steps_sampled_lifetime": 7740, "num_agent_steps_sampled_lifetime": 7740, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 7740, "timers": {"training_iteration_time_ms": 61486.293, "restore_workers_time_ms": 0.015, "training_step_time_ms": 61486.254, "sample_time_ms": 60827.305, "load_time_ms": 0.33, "load_throughput": 1563885.298, "learn_time_ms": 645.468, "learn_throughput": 799.42, "synch_weights_time_ms": 12.919}, "counters": {"num_env_steps_sampled": 7740, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 7740, "num_agent_steps_trained": 7740}, "done": false, "episodes_total": 430, "training_iteration": 15, "trial_id": "fe178_00005", "date": "2024-08-15_17-08-12", "timestamp": 1723763292, "time_this_iter_s": 68.46074533462524, "time_total_s": 943.9833877086639, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 943.9833877086639, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 23.483505154639175, "ram_util_percent": 13.337113402061858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.027145218849182, "cur_kl_coeff": 0.5, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.305335040887197, "policy_loss": -0.0342414843578202, "vf_loss": 8.336807338396708, "vf_explained_var": 0.14036702811717988, "kl": 0.005538386268017534, "entropy": 0.7955213084816932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8256, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 8256, "num_agent_steps_trained": 8256}, "sampler_results": {"episode_reward_max": 260.6184798684706, "episode_reward_min": -9.572340506862588, "episode_reward_mean": 133.4586213911186, "episode_len_mean": 37.04, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3704, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137, 162.0473934772084, 226.94496215759642, 90.52257707335207, 200.79678874712744, 210.22291254908862, 65.40935087764029, 29.52912731542368, 182.77389802712702, 217.8964371164817, 37.287266507425656, 218.726694047009, 212.5678459312404, 228.83209431159452, 182.89943425936195, 173.8415432963422, 159.79546481573084, 26.354823525440707, 24.803696831643776, 142.952330713532, 47.301976257407205, 217.57002605096932, 160.37911275255522, 167.02187519444868, 186.4171087566935, 135.6309202550589, 161.47991352132226, 199.9745441640177, 196.23945667346902, 198.75090972705252, 157.21717638563462, 184.7639477900271, 33.67532216813133, -6.992346010323615, 204.0497797517088, 227.38939563679997, 177.7366385104333, 195.27321564306425, 47.53527195583604, 46.978197232925794, 192.60480595192485, 102.864901754429, 205.8617086604362, 245.94461119704624, 239.5605389319968, 177.22077934348687, 205.8026219033689, 195.37482365185406, 167.0860557210832, 192.04535663840028, 40.69028906041676, 143.6794586355859, 17.629997849600542, 205.41930660038793], "episode_lengths": [18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9, 50, 50, 30, 50, 50, 19, 11, 50, 50, 11, 50, 50, 50, 50, 50, 47, 14, 9, 50, 10, 50, 32, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 1, 50, 50, 50, 50, 11, 11, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 10, 30, 10, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.210359090548545, "mean_inference_ms": 1.271525492130512, "mean_action_processing_ms": 0.20928307931712578, "mean_env_wait_ms": 626.3325792307854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010707855224609375, "StateBufferConnector_ms": 0.007880926132202148, "ViewRequirementAgentConnector_ms": 0.1759798526763916}, "num_episodes": 11, "episode_return_max": 260.6184798684706, "episode_return_min": -9.572340506862588, "episode_return_mean": 133.4586213911186}, "env_runner_results": {"episode_reward_max": 260.6184798684706, "episode_reward_min": -9.572340506862588, "episode_reward_mean": 133.4586213911186, "episode_len_mean": 37.04, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3704, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137, 162.0473934772084, 226.94496215759642, 90.52257707335207, 200.79678874712744, 210.22291254908862, 65.40935087764029, 29.52912731542368, 182.77389802712702, 217.8964371164817, 37.287266507425656, 218.726694047009, 212.5678459312404, 228.83209431159452, 182.89943425936195, 173.8415432963422, 159.79546481573084, 26.354823525440707, 24.803696831643776, 142.952330713532, 47.301976257407205, 217.57002605096932, 160.37911275255522, 167.02187519444868, 186.4171087566935, 135.6309202550589, 161.47991352132226, 199.9745441640177, 196.23945667346902, 198.75090972705252, 157.21717638563462, 184.7639477900271, 33.67532216813133, -6.992346010323615, 204.0497797517088, 227.38939563679997, 177.7366385104333, 195.27321564306425, 47.53527195583604, 46.978197232925794, 192.60480595192485, 102.864901754429, 205.8617086604362, 245.94461119704624, 239.5605389319968, 177.22077934348687, 205.8026219033689, 195.37482365185406, 167.0860557210832, 192.04535663840028, 40.69028906041676, 143.6794586355859, 17.629997849600542, 205.41930660038793], "episode_lengths": [18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9, 50, 50, 30, 50, 50, 19, 11, 50, 50, 11, 50, 50, 50, 50, 50, 47, 14, 9, 50, 10, 50, 32, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 1, 50, 50, 50, 50, 11, 11, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 10, 30, 10, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.210359090548545, "mean_inference_ms": 1.271525492130512, "mean_action_processing_ms": 0.20928307931712578, "mean_env_wait_ms": 626.3325792307854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010707855224609375, "StateBufferConnector_ms": 0.007880926132202148, "ViewRequirementAgentConnector_ms": 0.1759798526763916}, "num_episodes": 11, "episode_return_max": 260.6184798684706, "episode_return_min": -9.572340506862588, "episode_return_mean": 133.4586213911186}, "episode_reward_max": 260.6184798684706, "episode_reward_min": -9.572340506862588, "episode_reward_mean": 133.4586213911186, "episode_len_mean": 37.04, "episodes_this_iter": 11, "episodes_timesteps_total": 3704, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.117760576195266, 129.40339617440475, 18.09100915958743, 4.2581310857121935, 191.034070043341, 115.90027782398504, 182.72093429179648, 250.6712809967883, 222.6369939580706, 110.2476255302924, 183.6769067095684, 227.18482805936156, 68.11618368323165, 25.34915505689797, 152.07199654849046, 148.7375461608312, 165.15197913280645, 92.29647746459794, 3.579350489761623, 22.91812343814871, 101.43101421740346, -7.854777409209078, 182.93613918299246, 117.51045784037483, 14.369624771145993, 145.23277733996423, 94.39504993526856, 210.46498519206727, 72.58758544921875, 186.5910704820306, 48.949656946565426, 81.39207694174235, 15.784526004715303, 260.6184798684706, 173.85554264375116, 54.207117878884844, 6.257395788914636, -9.572340506862588, 133.34374781026196, 187.84538499215967, 154.33755283586788, 177.30542391519958, 114.52257869384147, 176.9106454980892, 152.85097190475958, 61.54351632308759, 13.499568289670137, 162.0473934772084, 226.94496215759642, 90.52257707335207, 200.79678874712744, 210.22291254908862, 65.40935087764029, 29.52912731542368, 182.77389802712702, 217.8964371164817, 37.287266507425656, 218.726694047009, 212.5678459312404, 228.83209431159452, 182.89943425936195, 173.8415432963422, 159.79546481573084, 26.354823525440707, 24.803696831643776, 142.952330713532, 47.301976257407205, 217.57002605096932, 160.37911275255522, 167.02187519444868, 186.4171087566935, 135.6309202550589, 161.47991352132226, 199.9745441640177, 196.23945667346902, 198.75090972705252, 157.21717638563462, 184.7639477900271, 33.67532216813133, -6.992346010323615, 204.0497797517088, 227.38939563679997, 177.7366385104333, 195.27321564306425, 47.53527195583604, 46.978197232925794, 192.60480595192485, 102.864901754429, 205.8617086604362, 245.94461119704624, 239.5605389319968, 177.22077934348687, 205.8026219033689, 195.37482365185406, 167.0860557210832, 192.04535663840028, 40.69028906041676, 143.6794586355859, 17.629997849600542, 205.41930660038793], "episode_lengths": [18, 50, 11, 6, 50, 50, 50, 50, 50, 50, 50, 50, 38, 10, 50, 50, 50, 23, 11, 22, 28, 1, 50, 50, 9, 40, 22, 50, 30, 50, 12, 21, 6, 50, 50, 12, 10, 1, 44, 50, 50, 50, 50, 50, 50, 20, 9, 50, 50, 30, 50, 50, 19, 11, 50, 50, 11, 50, 50, 50, 50, 50, 47, 14, 9, 50, 10, 50, 32, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 1, 50, 50, 50, 50, 11, 11, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 10, 30, 10, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.210359090548545, "mean_inference_ms": 1.271525492130512, "mean_action_processing_ms": 0.20928307931712578, "mean_env_wait_ms": 626.3325792307854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010707855224609375, "StateBufferConnector_ms": 0.007880926132202148, "ViewRequirementAgentConnector_ms": 0.1759798526763916}, "num_episodes": 11, "episode_return_max": 260.6184798684706, "episode_return_min": -9.572340506862588, "episode_return_mean": 133.4586213911186, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8256, "num_agent_steps_trained": 8256, "num_env_steps_sampled": 8256, "num_env_steps_trained": 8256, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.270797035923255, "num_env_steps_trained_throughput_per_sec": 8.270797035923255, "timesteps_total": 8256, "num_env_steps_sampled_lifetime": 8256, "num_agent_steps_sampled_lifetime": 8256, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 8256, "timers": {"training_iteration_time_ms": 62189.412, "restore_workers_time_ms": 0.014, "training_step_time_ms": 62189.375, "sample_time_ms": 61526.101, "load_time_ms": 0.331, "load_throughput": 1559940.078, "learn_time_ms": 649.694, "learn_throughput": 794.219, "synch_weights_time_ms": 13.01}, "counters": {"num_env_steps_sampled": 8256, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 8256, "num_agent_steps_trained": 8256}, "done": false, "episodes_total": 441, "training_iteration": 16, "trial_id": "fe178_00005", "date": "2024-08-15_17-09-14", "timestamp": 1723763354, "time_this_iter_s": 62.39186334609985, "time_total_s": 1006.3752510547638, "pid": 67489, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1006.3752510547638, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.976666666666667, "ram_util_percent": 13.434444444444447}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.817836542924246, "cur_kl_coeff": 1.0, "cur_lr": 1e-05, "total_loss": 7.823406751950582, "policy_loss": -0.01659934064761425, "vf_loss": 7.835012523333232, "vf_explained_var": 0.41758887420097984, "kl": 0.004993660781933292, "entropy": 0.8683386375506719, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8256, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 8256, "num_agent_steps_trained": 8256}, "sampler_results": {"episode_reward_max": 225.87616075323803, "episode_reward_min": 42.28626454060331, "episode_reward_mean": 174.35294187812934, "episode_len_mean": 44.57142857142857, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 312, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022], "episode_lengths": [50, 50, 50, 50, 50, 12, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.707466792590512, "mean_inference_ms": 1.258086296920902, "mean_action_processing_ms": 0.20942664498766067, "mean_env_wait_ms": 669.5945932360119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00893047877720424, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.17536708286830358}, "num_episodes": 7, "episode_return_max": 225.87616075323803, "episode_return_min": 42.28626454060331, "episode_return_mean": 174.35294187812934}, "env_runner_results": {"episode_reward_max": 225.87616075323803, "episode_reward_min": 42.28626454060331, "episode_reward_mean": 174.35294187812934, "episode_len_mean": 44.57142857142857, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 312, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022], "episode_lengths": [50, 50, 50, 50, 50, 12, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.707466792590512, "mean_inference_ms": 1.258086296920902, "mean_action_processing_ms": 0.20942664498766067, "mean_env_wait_ms": 669.5945932360119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00893047877720424, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.17536708286830358}, "num_episodes": 7, "episode_return_max": 225.87616075323803, "episode_return_min": 42.28626454060331, "episode_return_mean": 174.35294187812934}, "episode_reward_max": 225.87616075323803, "episode_reward_min": 42.28626454060331, "episode_reward_mean": 174.35294187812934, "episode_len_mean": 44.57142857142857, "episodes_this_iter": 7, "episodes_timesteps_total": 312, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022], "episode_lengths": [50, 50, 50, 50, 50, 12, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.707466792590512, "mean_inference_ms": 1.258086296920902, "mean_action_processing_ms": 0.20942664498766067, "mean_env_wait_ms": 669.5945932360119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00893047877720424, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.17536708286830358}, "num_episodes": 7, "episode_return_max": 225.87616075323803, "episode_return_min": 42.28626454060331, "episode_return_mean": 174.35294187812934, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8256, "num_agent_steps_trained": 8256, "num_env_steps_sampled": 8256, "num_env_steps_trained": 8256, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.110827438757948, "num_env_steps_trained_throughput_per_sec": 8.110827438757948, "timesteps_total": 8256, "num_env_steps_sampled_lifetime": 8256, "num_agent_steps_sampled_lifetime": 8256, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 8256, "timers": {"training_iteration_time_ms": 63618.671, "restore_workers_time_ms": 0.014, "training_step_time_ms": 63618.626, "sample_time_ms": 62508.929, "load_time_ms": 0.82, "load_throughput": 628962.762, "learn_time_ms": 1096.179, "learn_throughput": 470.726, "synch_weights_time_ms": 12.268}, "counters": {"num_env_steps_sampled": 8256, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 8256, "num_agent_steps_trained": 8256}, "done": false, "episodes_total": 446, "training_iteration": 16, "trial_id": "fe178_00005", "date": "2024-08-15_17-10-37", "timestamp": 1723763437, "time_this_iter_s": 63.62165856361389, "time_total_s": 1009.6934289932251, "pid": 84768, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 63.62165856361389, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 24.767032967032968, "ram_util_percent": 12.665934065934062}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.569269490242004, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 7.777652076880137, "policy_loss": -0.020775836147367954, "vf_loss": 7.794601953029632, "vf_explained_var": 0.1506148154536883, "kl": 0.007652041877008845, "entropy": 0.8258279244105021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8772, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 8772, "num_agent_steps_trained": 8772}, "sampler_results": {"episode_reward_max": 237.61370309509084, "episode_reward_min": 35.77221234792296, "episode_reward_mean": 182.01234866277022, "episode_len_mean": 46.2, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2659601953273425, "mean_inference_ms": 1.2581997817160322, "mean_action_processing_ms": 0.20942937479519103, "mean_env_wait_ms": 689.8510564293117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011277198791503906, "StateBufferConnector_ms": 0.006166696548461914, "ViewRequirementAgentConnector_ms": 0.1738893985748291}, "num_episodes": 13, "episode_return_max": 237.61370309509084, "episode_return_min": 35.77221234792296, "episode_return_mean": 182.01234866277022}, "env_runner_results": {"episode_reward_max": 237.61370309509084, "episode_reward_min": 35.77221234792296, "episode_reward_mean": 182.01234866277022, "episode_len_mean": 46.2, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2659601953273425, "mean_inference_ms": 1.2581997817160322, "mean_action_processing_ms": 0.20942937479519103, "mean_env_wait_ms": 689.8510564293117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011277198791503906, "StateBufferConnector_ms": 0.006166696548461914, "ViewRequirementAgentConnector_ms": 0.1738893985748291}, "num_episodes": 13, "episode_return_max": 237.61370309509084, "episode_return_min": 35.77221234792296, "episode_return_mean": 182.01234866277022}, "episode_reward_max": 237.61370309509084, "episode_reward_min": 35.77221234792296, "episode_reward_mean": 182.01234866277022, "episode_len_mean": 46.2, "episodes_this_iter": 13, "episodes_timesteps_total": 924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2659601953273425, "mean_inference_ms": 1.2581997817160322, "mean_action_processing_ms": 0.20942937479519103, "mean_env_wait_ms": 689.8510564293117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011277198791503906, "StateBufferConnector_ms": 0.006166696548461914, "ViewRequirementAgentConnector_ms": 0.1738893985748291}, "num_episodes": 13, "episode_return_max": 237.61370309509084, "episode_return_min": 35.77221234792296, "episode_return_mean": 182.01234866277022, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8772, "num_agent_steps_trained": 8772, "num_env_steps_sampled": 8772, "num_env_steps_trained": 8772, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.1053503572810275, "num_env_steps_trained_throughput_per_sec": 7.1053503572810275, "timesteps_total": 8772, "num_env_steps_sampled_lifetime": 8772, "num_agent_steps_sampled_lifetime": 8772, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 8772, "timers": {"training_iteration_time_ms": 68120.006, "restore_workers_time_ms": 0.017, "training_step_time_ms": 68119.954, "sample_time_ms": 67250.78, "load_time_ms": 0.594, "load_throughput": 869355.639, "learn_time_ms": 855.453, "learn_throughput": 603.19, "synch_weights_time_ms": 12.755}, "counters": {"num_env_steps_sampled": 8772, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 8772, "num_agent_steps_trained": 8772}, "done": false, "episodes_total": 459, "training_iteration": 17, "trial_id": "fe178_00005", "date": "2024-08-15_17-11-49", "timestamp": 1723763509, "time_this_iter_s": 72.62435960769653, "time_total_s": 1082.3177886009216, "pid": 84768, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 136.24601817131042, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 21.745192307692307, "ram_util_percent": 12.83942307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.13541207810243, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.22804582118988, "policy_loss": -0.03679885679545502, "vf_loss": 8.257630336284638, "vf_explained_var": 0.4559490725398064, "kl": 0.01442859548327172, "entropy": 0.8505866477886835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9288, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 9288, "num_agent_steps_trained": 9288}, "sampler_results": {"episode_reward_max": 264.5304018364125, "episode_reward_min": 35.77221234792296, "episode_reward_mean": 187.15279037715194, "episode_len_mean": 47.46666666666667, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1424, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.357955701240997, "mean_inference_ms": 1.2594922909607302, "mean_action_processing_ms": 0.20967785473497727, "mean_env_wait_ms": 678.3523072330453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011766751607259115, "StateBufferConnector_ms": 0.0061575571695963545, "ViewRequirementAgentConnector_ms": 0.1747274398803711}, "num_episodes": 10, "episode_return_max": 264.5304018364125, "episode_return_min": 35.77221234792296, "episode_return_mean": 187.15279037715194}, "env_runner_results": {"episode_reward_max": 264.5304018364125, "episode_reward_min": 35.77221234792296, "episode_reward_mean": 187.15279037715194, "episode_len_mean": 47.46666666666667, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1424, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.357955701240997, "mean_inference_ms": 1.2594922909607302, "mean_action_processing_ms": 0.20967785473497727, "mean_env_wait_ms": 678.3523072330453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011766751607259115, "StateBufferConnector_ms": 0.0061575571695963545, "ViewRequirementAgentConnector_ms": 0.1747274398803711}, "num_episodes": 10, "episode_return_max": 264.5304018364125, "episode_return_min": 35.77221234792296, "episode_return_mean": 187.15279037715194}, "episode_reward_max": 264.5304018364125, "episode_reward_min": 35.77221234792296, "episode_reward_mean": 187.15279037715194, "episode_len_mean": 47.46666666666667, "episodes_this_iter": 10, "episodes_timesteps_total": 1424, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.357955701240997, "mean_inference_ms": 1.2594922909607302, "mean_action_processing_ms": 0.20967785473497727, "mean_env_wait_ms": 678.3523072330453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011766751607259115, "StateBufferConnector_ms": 0.0061575571695963545, "ViewRequirementAgentConnector_ms": 0.1747274398803711}, "num_episodes": 10, "episode_return_max": 264.5304018364125, "episode_return_min": 35.77221234792296, "episode_return_mean": 187.15279037715194, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9288, "num_agent_steps_trained": 9288, "num_env_steps_sampled": 9288, "num_env_steps_trained": 9288, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.847920764334416, "num_env_steps_trained_throughput_per_sec": 9.847920764334416, "timesteps_total": 9288, "num_env_steps_sampled_lifetime": 9288, "num_agent_steps_sampled_lifetime": 9288, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 9288, "timers": {"training_iteration_time_ms": 62878.959, "restore_workers_time_ms": 0.02, "training_step_time_ms": 62878.899, "sample_time_ms": 62090.757, "load_time_ms": 0.511, "load_throughput": 1010235.35, "learn_time_ms": 774.226, "learn_throughput": 666.472, "synch_weights_time_ms": 13.065}, "counters": {"num_env_steps_sampled": 9288, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 9288, "num_agent_steps_trained": 9288}, "done": false, "episodes_total": 469, "training_iteration": 18, "trial_id": "fe178_00005", "date": "2024-08-15_17-12-42", "timestamp": 1723763562, "time_this_iter_s": 52.39992308616638, "time_total_s": 1134.717711687088, "pid": 84768, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 188.6459412574768, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 28.753333333333334, "ram_util_percent": 12.944}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.80607800881068, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.415716540813445, "policy_loss": -0.031187235214747488, "vf_loss": 8.443219168980916, "vf_explained_var": 0.17754344294468563, "kl": 0.007369152329314457, "entropy": 0.7326175764203071, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9804, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 9804, "num_agent_steps_trained": 9804}, "sampler_results": {"episode_reward_max": 279.0018620941518, "episode_reward_min": 35.77221234792296, "episode_reward_mean": 185.95012711954277, "episode_len_mean": 46.125, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1845, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.419247574663119, "mean_inference_ms": 1.2602092266659561, "mean_action_processing_ms": 0.2097892947983493, "mean_env_wait_ms": 658.2170041374675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011751651763916016, "StateBufferConnector_ms": 0.006183981895446777, "ViewRequirementAgentConnector_ms": 0.17405927181243896}, "num_episodes": 10, "episode_return_max": 279.0018620941518, "episode_return_min": 35.77221234792296, "episode_return_mean": 185.95012711954277}, "env_runner_results": {"episode_reward_max": 279.0018620941518, "episode_reward_min": 35.77221234792296, "episode_reward_mean": 185.95012711954277, "episode_len_mean": 46.125, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1845, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.419247574663119, "mean_inference_ms": 1.2602092266659561, "mean_action_processing_ms": 0.2097892947983493, "mean_env_wait_ms": 658.2170041374675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011751651763916016, "StateBufferConnector_ms": 0.006183981895446777, "ViewRequirementAgentConnector_ms": 0.17405927181243896}, "num_episodes": 10, "episode_return_max": 279.0018620941518, "episode_return_min": 35.77221234792296, "episode_return_mean": 185.95012711954277}, "episode_reward_max": 279.0018620941518, "episode_reward_min": 35.77221234792296, "episode_reward_mean": 185.95012711954277, "episode_len_mean": 46.125, "episodes_this_iter": 10, "episodes_timesteps_total": 1845, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.419247574663119, "mean_inference_ms": 1.2602092266659561, "mean_action_processing_ms": 0.2097892947983493, "mean_env_wait_ms": 658.2170041374675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011751651763916016, "StateBufferConnector_ms": 0.006183981895446777, "ViewRequirementAgentConnector_ms": 0.17405927181243896}, "num_episodes": 10, "episode_return_max": 279.0018620941518, "episode_return_min": 35.77221234792296, "episode_return_mean": 185.95012711954277, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9804, "num_agent_steps_trained": 9804, "num_env_steps_sampled": 9804, "num_env_steps_trained": 9804, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 12.402745109563556, "num_env_steps_trained_throughput_per_sec": 12.402745109563556, "timesteps_total": 9804, "num_env_steps_sampled_lifetime": 9804, "num_agent_steps_sampled_lifetime": 9804, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 9804, "timers": {"training_iteration_time_ms": 57560.146, "restore_workers_time_ms": 0.019, "training_step_time_ms": 57560.086, "sample_time_ms": 56796.009, "load_time_ms": 0.473, "load_throughput": 1090033.173, "learn_time_ms": 750.133, "learn_throughput": 687.878, "synch_weights_time_ms": 13.139}, "counters": {"num_env_steps_sampled": 9804, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 9804, "num_agent_steps_trained": 9804}, "done": false, "episodes_total": 479, "training_iteration": 19, "trial_id": "fe178_00005", "date": "2024-08-15_17-13-23", "timestamp": 1723763603, "time_this_iter_s": 41.60697937011719, "time_total_s": 1176.3246910572052, "pid": 84768, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 230.252920627594, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.44745762711864, "ram_util_percent": 13.005084745762714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.600252389907837, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.289866948127747, "policy_loss": -0.026332841743715106, "vf_loss": 8.311883437633515, "vf_explained_var": 0.18793200502792995, "kl": 0.008632698291573393, "entropy": 0.6407577089965344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10320, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 10320, "num_agent_steps_trained": 10320}, "sampler_results": {"episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 188.73536167470556, "episode_len_mean": 45.68518518518518, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 2467, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.525378746530868, "mean_inference_ms": 1.25983554214642, "mean_action_processing_ms": 0.20985430568077523, "mean_env_wait_ms": 644.3372283394888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011579195658365885, "StateBufferConnector_ms": 0.0061984415407534, "ViewRequirementAgentConnector_ms": 0.17395416895548502}, "num_episodes": 14, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 188.73536167470556}, "env_runner_results": {"episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 188.73536167470556, "episode_len_mean": 45.68518518518518, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 2467, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.525378746530868, "mean_inference_ms": 1.25983554214642, "mean_action_processing_ms": 0.20985430568077523, "mean_env_wait_ms": 644.3372283394888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011579195658365885, "StateBufferConnector_ms": 0.0061984415407534, "ViewRequirementAgentConnector_ms": 0.17395416895548502}, "num_episodes": 14, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 188.73536167470556}, "episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 188.73536167470556, "episode_len_mean": 45.68518518518518, "episodes_this_iter": 14, "episodes_timesteps_total": 2467, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.525378746530868, "mean_inference_ms": 1.25983554214642, "mean_action_processing_ms": 0.20985430568077523, "mean_env_wait_ms": 644.3372283394888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011579195658365885, "StateBufferConnector_ms": 0.0061984415407534, "ViewRequirementAgentConnector_ms": 0.17395416895548502}, "num_episodes": 14, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 188.73536167470556, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10320, "num_agent_steps_trained": 10320, "num_env_steps_sampled": 10320, "num_env_steps_trained": 10320, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.58492902202352, "num_env_steps_trained_throughput_per_sec": 8.58492902202352, "timesteps_total": 10320, "num_env_steps_sampled_lifetime": 10320, "num_agent_steps_sampled_lifetime": 10320, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 10320, "timers": {"training_iteration_time_ms": 58069.185, "restore_workers_time_ms": 0.019, "training_step_time_ms": 58069.127, "sample_time_ms": 57323.285, "load_time_ms": 0.445, "load_throughput": 1160710.535, "learn_time_ms": 732.146, "learn_throughput": 704.778, "synch_weights_time_ms": 12.944}, "counters": {"num_env_steps_sampled": 10320, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 10320, "num_agent_steps_trained": 10320}, "done": false, "episodes_total": 493, "training_iteration": 20, "trial_id": "fe178_00005", "date": "2024-08-15_17-14-24", "timestamp": 1723763664, "time_this_iter_s": 60.108798027038574, "time_total_s": 1236.4334890842438, "pid": 84768, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 290.36171865463257, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.730232558139537, "ram_util_percent": 12.824418604651164}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.240103218952815, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.42793089946111, "policy_loss": -0.033382665117581686, "vf_loss": 8.454610474904378, "vf_explained_var": 0.1311153491338094, "kl": 0.013406185324811304, "entropy": 0.5574525766074657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10836, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 10836, "num_agent_steps_trained": 10836}, "sampler_results": {"episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 193.97980167604342, "episode_len_mean": 46.0, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2990, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.579126126289084, "mean_inference_ms": 1.2601367078827403, "mean_action_processing_ms": 0.20988754316411798, "mean_env_wait_ms": 637.6025712079528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0115966796875, "StateBufferConnector_ms": 0.006172473614032452, "ViewRequirementAgentConnector_ms": 0.1738108121431791}, "num_episodes": 11, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 193.97980167604342}, "env_runner_results": {"episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 193.97980167604342, "episode_len_mean": 46.0, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2990, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.579126126289084, "mean_inference_ms": 1.2601367078827403, "mean_action_processing_ms": 0.20988754316411798, "mean_env_wait_ms": 637.6025712079528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0115966796875, "StateBufferConnector_ms": 0.006172473614032452, "ViewRequirementAgentConnector_ms": 0.1738108121431791}, "num_episodes": 11, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 193.97980167604342}, "episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 193.97980167604342, "episode_len_mean": 46.0, "episodes_this_iter": 11, "episodes_timesteps_total": 2990, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.579126126289084, "mean_inference_ms": 1.2601367078827403, "mean_action_processing_ms": 0.20988754316411798, "mean_env_wait_ms": 637.6025712079528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0115966796875, "StateBufferConnector_ms": 0.006172473614032452, "ViewRequirementAgentConnector_ms": 0.1738108121431791}, "num_episodes": 11, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 193.97980167604342, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10836, "num_agent_steps_trained": 10836, "num_env_steps_sampled": 10836, "num_env_steps_trained": 10836, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.871388079664726, "num_env_steps_trained_throughput_per_sec": 8.871388079664726, "timesteps_total": 10836, "num_env_steps_sampled_lifetime": 10836, "num_agent_steps_sampled_lifetime": 10836, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 10836, "timers": {"training_iteration_time_ms": 58085.075, "restore_workers_time_ms": 0.018, "training_step_time_ms": 58085.02, "sample_time_ms": 57355.417, "load_time_ms": 0.424, "load_throughput": 1217815.36, "learn_time_ms": 715.958, "learn_throughput": 720.712, "synch_weights_time_ms": 12.929}, "counters": {"num_env_steps_sampled": 10836, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 10836, "num_agent_steps_trained": 10836}, "done": false, "episodes_total": 504, "training_iteration": 21, "trial_id": "fe178_00005", "date": "2024-08-15_17-15-22", "timestamp": 1723763722, "time_this_iter_s": 58.16769599914551, "time_total_s": 1294.6011850833893, "pid": 84768, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 348.5294146537781, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.55180722891566, "ram_util_percent": 13.083132530120478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.431022504965464, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.222856724262238, "policy_loss": -0.02311972053721547, "vf_loss": 8.241945946216584, "vf_explained_var": 0.04562902400890986, "kl": 0.008060951383232132, "entropy": 0.5740557792286078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11352, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 11352, "num_agent_steps_trained": 11352}, "sampler_results": {"episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 193.91778362604433, "episode_len_mean": 45.53947368421053, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3461, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.615738325026693, "mean_inference_ms": 1.2596647217658734, "mean_action_processing_ms": 0.20988614770941671, "mean_env_wait_ms": 633.5020769470433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011455699017173365, "StateBufferConnector_ms": 0.006177237159327457, "ViewRequirementAgentConnector_ms": 0.17318662844206156}, "num_episodes": 11, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 193.91778362604433}, "env_runner_results": {"episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 193.91778362604433, "episode_len_mean": 45.53947368421053, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3461, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.615738325026693, "mean_inference_ms": 1.2596647217658734, "mean_action_processing_ms": 0.20988614770941671, "mean_env_wait_ms": 633.5020769470433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011455699017173365, "StateBufferConnector_ms": 0.006177237159327457, "ViewRequirementAgentConnector_ms": 0.17318662844206156}, "num_episodes": 11, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 193.91778362604433}, "episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 193.91778362604433, "episode_len_mean": 45.53947368421053, "episodes_this_iter": 11, "episodes_timesteps_total": 3461, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.615738325026693, "mean_inference_ms": 1.2596647217658734, "mean_action_processing_ms": 0.20988614770941671, "mean_env_wait_ms": 633.5020769470433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011455699017173365, "StateBufferConnector_ms": 0.006177237159327457, "ViewRequirementAgentConnector_ms": 0.17318662844206156}, "num_episodes": 11, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 193.91778362604433, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11352, "num_agent_steps_trained": 11352, "num_env_steps_sampled": 11352, "num_env_steps_trained": 11352, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.541585411012989, "num_env_steps_trained_throughput_per_sec": 8.541585411012989, "timesteps_total": 11352, "num_env_steps_sampled_lifetime": 11352, "num_agent_steps_sampled_lifetime": 11352, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 11352, "timers": {"training_iteration_time_ms": 58417.256, "restore_workers_time_ms": 0.018, "training_step_time_ms": 58417.202, "sample_time_ms": 57705.949, "load_time_ms": 0.406, "load_throughput": 1269573.959, "learn_time_ms": 697.583, "learn_throughput": 739.697, "synch_weights_time_ms": 12.977}, "counters": {"num_env_steps_sampled": 11352, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 11352, "num_agent_steps_trained": 11352}, "done": false, "episodes_total": 515, "training_iteration": 22, "trial_id": "fe178_00005", "date": "2024-08-15_17-16-22", "timestamp": 1723763782, "time_this_iter_s": 60.41411113739014, "time_total_s": 1355.0152962207794, "pid": 84768, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 408.9435257911682, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 24.660465116279067, "ram_util_percent": 12.944186046511625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.363994971911113, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.462721554438273, "policy_loss": -0.01680533468412856, "vf_loss": 8.475400280952453, "vf_explained_var": 0.08543524742126465, "kl": 0.008253129592534502, "entropy": 0.4872600331902504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11868, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 11868, "num_agent_steps_trained": 11868}, "sampler_results": {"episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 196.66001065060857, "episode_len_mean": 45.6551724137931, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3972, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.64727954078644, "mean_inference_ms": 1.2597932331131256, "mean_action_processing_ms": 0.20995115033164383, "mean_env_wait_ms": 630.816862073635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01120128850827272, "StateBufferConnector_ms": 0.006128453660285336, "ViewRequirementAgentConnector_ms": 0.1723009964515423}, "num_episodes": 11, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 196.66001065060857}, "env_runner_results": {"episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 196.66001065060857, "episode_len_mean": 45.6551724137931, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3972, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.64727954078644, "mean_inference_ms": 1.2597932331131256, "mean_action_processing_ms": 0.20995115033164383, "mean_env_wait_ms": 630.816862073635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01120128850827272, "StateBufferConnector_ms": 0.006128453660285336, "ViewRequirementAgentConnector_ms": 0.1723009964515423}, "num_episodes": 11, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 196.66001065060857}, "episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 196.66001065060857, "episode_len_mean": 45.6551724137931, "episodes_this_iter": 11, "episodes_timesteps_total": 3972, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.64727954078644, "mean_inference_ms": 1.2597932331131256, "mean_action_processing_ms": 0.20995115033164383, "mean_env_wait_ms": 630.816862073635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01120128850827272, "StateBufferConnector_ms": 0.006128453660285336, "ViewRequirementAgentConnector_ms": 0.1723009964515423}, "num_episodes": 11, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 196.66001065060857, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11868, "num_agent_steps_trained": 11868, "num_env_steps_sampled": 11868, "num_env_steps_trained": 11868, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.577769188535852, "num_env_steps_trained_throughput_per_sec": 8.577769188535852, "timesteps_total": 11868, "num_env_steps_sampled_lifetime": 11868, "num_agent_steps_sampled_lifetime": 11868, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 11868, "timers": {"training_iteration_time_ms": 58634.539, "restore_workers_time_ms": 0.019, "training_step_time_ms": 58634.483, "sample_time_ms": 57926.502, "load_time_ms": 0.399, "load_throughput": 1293737.347, "learn_time_ms": 694.307, "learn_throughput": 743.187, "synch_weights_time_ms": 12.997}, "counters": {"num_env_steps_sampled": 11868, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 11868, "num_agent_steps_trained": 11868}, "done": false, "episodes_total": 526, "training_iteration": 23, "trial_id": "fe178_00005", "date": "2024-08-15_17-17-22", "timestamp": 1723763842, "time_this_iter_s": 60.15893316268921, "time_total_s": 1415.1742293834686, "pid": 84768, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 469.1024589538574, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 27.31627906976744, "ram_util_percent": 12.106976744186044}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.569750169912973, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.647558216253916, "policy_loss": -0.023957176079663137, "vf_loss": 8.667064146200817, "vf_explained_var": 0.14606679280598958, "kl": 0.008902284951182683, "entropy": 0.3985988731185595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12384, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 12384, "num_agent_steps_trained": 12384}, "sampler_results": {"episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 201.47274143539377, "episode_len_mean": 45.86734693877551, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4495, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287, 255.21235439513407, 251.3463328989742, 267.8009325250305, 257.1666581066067, 253.18759706924237, 224.9379447122767, 235.15932922047278, 271.0605855260529, 271.28033663114354, 251.07683715321417, 96.67882582749297], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.666380723540092, "mean_inference_ms": 1.2595848494114175, "mean_action_processing_ms": 0.20992114303618523, "mean_env_wait_ms": 629.1502548634519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011131228232870296, "StateBufferConnector_ms": 0.006140251548922792, "ViewRequirementAgentConnector_ms": 0.1727483710464166}, "num_episodes": 11, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 201.47274143539377}, "env_runner_results": {"episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 201.47274143539377, "episode_len_mean": 45.86734693877551, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4495, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287, 255.21235439513407, 251.3463328989742, 267.8009325250305, 257.1666581066067, 253.18759706924237, 224.9379447122767, 235.15932922047278, 271.0605855260529, 271.28033663114354, 251.07683715321417, 96.67882582749297], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.666380723540092, "mean_inference_ms": 1.2595848494114175, "mean_action_processing_ms": 0.20992114303618523, "mean_env_wait_ms": 629.1502548634519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011131228232870296, "StateBufferConnector_ms": 0.006140251548922792, "ViewRequirementAgentConnector_ms": 0.1727483710464166}, "num_episodes": 11, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 201.47274143539377}, "episode_reward_max": 279.0018620941518, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 201.47274143539377, "episode_len_mean": 45.86734693877551, "episodes_this_iter": 11, "episodes_timesteps_total": 4495, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [180.80250459503293, 195.52286920451354, 193.8232366045862, 174.57817676176128, 225.87616075323803, 42.28626454060331, 207.58138068717022, 210.72510920107084, 211.03951572271382, 227.83024259759412, 237.61370309509084, 186.33177240186188, 214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287, 255.21235439513407, 251.3463328989742, 267.8009325250305, 257.1666581066067, 253.18759706924237, 224.9379447122767, 235.15932922047278, 271.0605855260529, 271.28033663114354, 251.07683715321417, 96.67882582749297], "episode_lengths": [50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.666380723540092, "mean_inference_ms": 1.2595848494114175, "mean_action_processing_ms": 0.20992114303618523, "mean_env_wait_ms": 629.1502548634519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011131228232870296, "StateBufferConnector_ms": 0.006140251548922792, "ViewRequirementAgentConnector_ms": 0.1727483710464166}, "num_episodes": 11, "episode_return_max": 279.0018620941518, "episode_return_min": 30.23159148613159, "episode_return_mean": 201.47274143539377, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12384, "num_agent_steps_trained": 12384, "num_env_steps_sampled": 12384, "num_env_steps_trained": 12384, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.42142321801011, "num_env_steps_trained_throughput_per_sec": 8.42142321801011, "timesteps_total": 12384, "num_env_steps_sampled_lifetime": 12384, "num_agent_steps_sampled_lifetime": 12384, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 12384, "timers": {"training_iteration_time_ms": 58927.625, "restore_workers_time_ms": 0.019, "training_step_time_ms": 58927.571, "sample_time_ms": 58220.21, "load_time_ms": 0.391, "load_throughput": 1318063.864, "learn_time_ms": 693.682, "learn_throughput": 743.857, "synch_weights_time_ms": 13.01}, "counters": {"num_env_steps_sampled": 12384, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 12384, "num_agent_steps_trained": 12384}, "done": false, "episodes_total": 537, "training_iteration": 24, "trial_id": "fe178_00005", "date": "2024-08-15_17-18-24", "timestamp": 1723763904, "time_this_iter_s": 61.27600908279419, "time_total_s": 1476.4502384662628, "pid": 84768, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 530.3784680366516, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.827272727272728, "ram_util_percent": 12.63522727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.958708924055099, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.043447824319204, "policy_loss": -0.020109032358353335, "vf_loss": 8.060756023724874, "vf_explained_var": 0.2055462842186292, "kl": 0.005601455766275295, "entropy": 0.3587403349578381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12900, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 12900, "num_agent_steps_trained": 12900}, "sampler_results": {"episode_reward_max": 295.29927974093414, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 199.04506628283926, "episode_len_mean": 44.59, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 4459, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287, 255.21235439513407, 251.3463328989742, 267.8009325250305, 257.1666581066067, 253.18759706924237, 224.9379447122767, 235.15932922047278, 271.0605855260529, 271.28033663114354, 251.07683715321417, 96.67882582749297, 261.1128309598904, 30.6967768379525, 85.92043803349355, 89.28071834811827, 33.30656458211796, 232.75088545282472, 252.64832749486027, 266.2474432805678, 31.51622162813851, 217.6499656408664, 239.9312411053935, 202.9624326660016, 295.29927974093414, 214.86577800941478], "episode_lengths": [50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 11, 26, 20, 10, 50, 50, 50, 9, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.796338523291167, "mean_inference_ms": 1.2587219434439125, "mean_action_processing_ms": 0.20984690626061173, "mean_env_wait_ms": 623.4685035405084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011017084121704102, "StateBufferConnector_ms": 0.006360530853271484, "ViewRequirementAgentConnector_ms": 0.1720585823059082}, "num_episodes": 14, "episode_return_max": 295.29927974093414, "episode_return_min": 30.23159148613159, "episode_return_mean": 199.04506628283926}, "env_runner_results": {"episode_reward_max": 295.29927974093414, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 199.04506628283926, "episode_len_mean": 44.59, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 4459, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287, 255.21235439513407, 251.3463328989742, 267.8009325250305, 257.1666581066067, 253.18759706924237, 224.9379447122767, 235.15932922047278, 271.0605855260529, 271.28033663114354, 251.07683715321417, 96.67882582749297, 261.1128309598904, 30.6967768379525, 85.92043803349355, 89.28071834811827, 33.30656458211796, 232.75088545282472, 252.64832749486027, 266.2474432805678, 31.51622162813851, 217.6499656408664, 239.9312411053935, 202.9624326660016, 295.29927974093414, 214.86577800941478], "episode_lengths": [50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 11, 26, 20, 10, 50, 50, 50, 9, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.796338523291167, "mean_inference_ms": 1.2587219434439125, "mean_action_processing_ms": 0.20984690626061173, "mean_env_wait_ms": 623.4685035405084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011017084121704102, "StateBufferConnector_ms": 0.006360530853271484, "ViewRequirementAgentConnector_ms": 0.1720585823059082}, "num_episodes": 14, "episode_return_max": 295.29927974093414, "episode_return_min": 30.23159148613159, "episode_return_mean": 199.04506628283926}, "episode_reward_max": 295.29927974093414, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 199.04506628283926, "episode_len_mean": 44.59, "episodes_this_iter": 14, "episodes_timesteps_total": 4459, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [214.28534120058185, 168.66102207986302, 160.33501254062878, 35.77221234792296, 183.7802809227025, 175.93717039535548, 236.7751735487027, 170.68982405441028, 139.77645782169273, 126.95677474043985, 222.62029203603464, 228.83520093570462, 202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287, 255.21235439513407, 251.3463328989742, 267.8009325250305, 257.1666581066067, 253.18759706924237, 224.9379447122767, 235.15932922047278, 271.0605855260529, 271.28033663114354, 251.07683715321417, 96.67882582749297, 261.1128309598904, 30.6967768379525, 85.92043803349355, 89.28071834811827, 33.30656458211796, 232.75088545282472, 252.64832749486027, 266.2474432805678, 31.51622162813851, 217.6499656408664, 239.9312411053935, 202.9624326660016, 295.29927974093414, 214.86577800941478], "episode_lengths": [50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 11, 26, 20, 10, 50, 50, 50, 9, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.796338523291167, "mean_inference_ms": 1.2587219434439125, "mean_action_processing_ms": 0.20984690626061173, "mean_env_wait_ms": 623.4685035405084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011017084121704102, "StateBufferConnector_ms": 0.006360530853271484, "ViewRequirementAgentConnector_ms": 0.1720585823059082}, "num_episodes": 14, "episode_return_max": 295.29927974093414, "episode_return_min": 30.23159148613159, "episode_return_mean": 199.04506628283926, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12900, "num_agent_steps_trained": 12900, "num_env_steps_sampled": 12900, "num_env_steps_trained": 12900, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 6.920210670459483, "num_env_steps_trained_throughput_per_sec": 6.920210670459483, "timesteps_total": 12900, "num_env_steps_sampled_lifetime": 12900, "num_agent_steps_sampled_lifetime": 12900, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 12900, "timers": {"training_iteration_time_ms": 60491.284, "restore_workers_time_ms": 0.018, "training_step_time_ms": 60491.232, "sample_time_ms": 59787.143, "load_time_ms": 0.383, "load_throughput": 1346603.325, "learn_time_ms": 690.483, "learn_throughput": 747.303, "synch_weights_time_ms": 12.954}, "counters": {"num_env_steps_sampled": 12900, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 12900, "num_agent_steps_trained": 12900}, "done": false, "episodes_total": 551, "training_iteration": 25, "trial_id": "fe178_00005", "date": "2024-08-15_17-19-38", "timestamp": 1723763978, "time_this_iter_s": 74.56805396080017, "time_total_s": 1551.018292427063, "pid": 84768, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 604.9465219974518, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 21.569811320754717, "ram_util_percent": 12.731132075471699}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.088385252157847, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.172993711630504, "policy_loss": -0.02207127762182305, "vf_loss": 8.191393172740936, "vf_explained_var": 0.28122717440128325, "kl": 0.007343734214858463, "entropy": 0.32149736285209657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13416, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 13416, "num_agent_steps_trained": 13416}, "sampler_results": {"episode_reward_max": 295.29927974093414, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 203.67700817594286, "episode_len_mean": 44.06, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4406, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287, 255.21235439513407, 251.3463328989742, 267.8009325250305, 257.1666581066067, 253.18759706924237, 224.9379447122767, 235.15932922047278, 271.0605855260529, 271.28033663114354, 251.07683715321417, 96.67882582749297, 261.1128309598904, 30.6967768379525, 85.92043803349355, 89.28071834811827, 33.30656458211796, 232.75088545282472, 252.64832749486027, 266.2474432805678, 31.51622162813851, 217.6499656408664, 239.9312411053935, 202.9624326660016, 295.29927974093414, 214.86577800941478, 216.6995776075355, 280.9009467988022, 238.8991532677005, 247.9953195812845, 44.26229145414071, 253.10856669061673, 146.0868816294976, 215.74061667013973, 271.02975419215375, 268.4916838000664, 257.3741856370562, 87.02997460540578], "episode_lengths": [50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 11, 26, 20, 10, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 29, 50, 50, 50, 50, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.8294504431294465, "mean_inference_ms": 1.2588236126169494, "mean_action_processing_ms": 0.20996001597193115, "mean_env_wait_ms": 617.7198956767992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01086878776550293, "StateBufferConnector_ms": 0.006368398666381836, "ViewRequirementAgentConnector_ms": 0.17254352569580078}, "num_episodes": 12, "episode_return_max": 295.29927974093414, "episode_return_min": 30.23159148613159, "episode_return_mean": 203.67700817594286}, "env_runner_results": {"episode_reward_max": 295.29927974093414, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 203.67700817594286, "episode_len_mean": 44.06, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4406, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287, 255.21235439513407, 251.3463328989742, 267.8009325250305, 257.1666581066067, 253.18759706924237, 224.9379447122767, 235.15932922047278, 271.0605855260529, 271.28033663114354, 251.07683715321417, 96.67882582749297, 261.1128309598904, 30.6967768379525, 85.92043803349355, 89.28071834811827, 33.30656458211796, 232.75088545282472, 252.64832749486027, 266.2474432805678, 31.51622162813851, 217.6499656408664, 239.9312411053935, 202.9624326660016, 295.29927974093414, 214.86577800941478, 216.6995776075355, 280.9009467988022, 238.8991532677005, 247.9953195812845, 44.26229145414071, 253.10856669061673, 146.0868816294976, 215.74061667013973, 271.02975419215375, 268.4916838000664, 257.3741856370562, 87.02997460540578], "episode_lengths": [50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 11, 26, 20, 10, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 29, 50, 50, 50, 50, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.8294504431294465, "mean_inference_ms": 1.2588236126169494, "mean_action_processing_ms": 0.20996001597193115, "mean_env_wait_ms": 617.7198956767992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01086878776550293, "StateBufferConnector_ms": 0.006368398666381836, "ViewRequirementAgentConnector_ms": 0.17254352569580078}, "num_episodes": 12, "episode_return_max": 295.29927974093414, "episode_return_min": 30.23159148613159, "episode_return_mean": 203.67700817594286}, "episode_reward_max": 295.29927974093414, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 203.67700817594286, "episode_len_mean": 44.06, "episodes_this_iter": 12, "episodes_timesteps_total": 4406, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [202.2815148155118, 145.71893622833682, 216.21287354701047, 167.31206378818024, 264.5304018364125, 260.09222230982925, 44.52921393717422, 279.0018620941518, 219.81541669072584, 247.72051633999257, 41.82174085836576, 181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287, 255.21235439513407, 251.3463328989742, 267.8009325250305, 257.1666581066067, 253.18759706924237, 224.9379447122767, 235.15932922047278, 271.0605855260529, 271.28033663114354, 251.07683715321417, 96.67882582749297, 261.1128309598904, 30.6967768379525, 85.92043803349355, 89.28071834811827, 33.30656458211796, 232.75088545282472, 252.64832749486027, 266.2474432805678, 31.51622162813851, 217.6499656408664, 239.9312411053935, 202.9624326660016, 295.29927974093414, 214.86577800941478, 216.6995776075355, 280.9009467988022, 238.8991532677005, 247.9953195812845, 44.26229145414071, 253.10856669061673, 146.0868816294976, 215.74061667013973, 271.02975419215375, 268.4916838000664, 257.3741856370562, 87.02997460540578], "episode_lengths": [50, 50, 50, 50, 50, 50, 10, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 11, 26, 20, 10, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 29, 50, 50, 50, 50, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.8294504431294465, "mean_inference_ms": 1.2588236126169494, "mean_action_processing_ms": 0.20996001597193115, "mean_env_wait_ms": 617.7198956767992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01086878776550293, "StateBufferConnector_ms": 0.006368398666381836, "ViewRequirementAgentConnector_ms": 0.17254352569580078}, "num_episodes": 12, "episode_return_max": 295.29927974093414, "episode_return_min": 30.23159148613159, "episode_return_mean": 203.67700817594286, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13416, "num_agent_steps_trained": 13416, "num_env_steps_sampled": 13416, "num_env_steps_trained": 13416, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.945086481056721, "num_env_steps_trained_throughput_per_sec": 7.945086481056721, "timesteps_total": 13416, "num_env_steps_sampled_lifetime": 13416, "num_agent_steps_sampled_lifetime": 13416, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 13416, "timers": {"training_iteration_time_ms": 60623.998, "restore_workers_time_ms": 0.018, "training_step_time_ms": 60623.947, "sample_time_ms": 59966.491, "load_time_ms": 0.335, "load_throughput": 1541496.342, "learn_time_ms": 643.811, "learn_throughput": 801.477, "synch_weights_time_ms": 13.06}, "counters": {"num_env_steps_sampled": 13416, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 13416, "num_agent_steps_trained": 13416}, "done": false, "episodes_total": 563, "training_iteration": 26, "trial_id": "fe178_00005", "date": "2024-08-15_17-20-43", "timestamp": 1723764043, "time_this_iter_s": 64.9498643875122, "time_total_s": 1615.9681568145752, "pid": 84768, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 669.896386384964, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.36989247311828, "ram_util_percent": 12.559139784946236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.43577223221461, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.407480335235595, "policy_loss": -0.027153102743128935, "vf_loss": 8.430315486590068, "vf_explained_var": 0.20513295978307725, "kl": 0.008635646171145879, "entropy": 0.22640170641243457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13932, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 13932, "num_agent_steps_trained": 13932}, "sampler_results": {"episode_reward_max": 295.29927974093414, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 207.85873446084273, "episode_len_mean": 44.33, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4433, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287, 255.21235439513407, 251.3463328989742, 267.8009325250305, 257.1666581066067, 253.18759706924237, 224.9379447122767, 235.15932922047278, 271.0605855260529, 271.28033663114354, 251.07683715321417, 96.67882582749297, 261.1128309598904, 30.6967768379525, 85.92043803349355, 89.28071834811827, 33.30656458211796, 232.75088545282472, 252.64832749486027, 266.2474432805678, 31.51622162813851, 217.6499656408664, 239.9312411053935, 202.9624326660016, 295.29927974093414, 214.86577800941478, 216.6995776075355, 280.9009467988022, 238.8991532677005, 247.9953195812845, 44.26229145414071, 253.10856669061673, 146.0868816294976, 215.74061667013973, 271.02975419215375, 268.4916838000664, 257.3741856370562, 87.02997460540578, 234.02967214407562, 57.73644341021736, 291.54683679769676, 193.7335775399397, 291.15824025321126, 174.33359465429862, 256.592223477789, 251.50559887864097, 242.67572907340616, 242.97206810733184, 270.92540659906837], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 11, 26, 20, 10, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 29, 50, 50, 50, 50, 19, 50, 15, 50, 50, 50, 33, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.873109643532584, "mean_inference_ms": 1.258214696929041, "mean_action_processing_ms": 0.20979288654729736, "mean_env_wait_ms": 619.0999589213761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010670900344848633, "StateBufferConnector_ms": 0.006369590759277344, "ViewRequirementAgentConnector_ms": 0.1727440357208252}, "num_episodes": 11, "episode_return_max": 295.29927974093414, "episode_return_min": 30.23159148613159, "episode_return_mean": 207.85873446084273}, "env_runner_results": {"episode_reward_max": 295.29927974093414, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 207.85873446084273, "episode_len_mean": 44.33, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4433, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287, 255.21235439513407, 251.3463328989742, 267.8009325250305, 257.1666581066067, 253.18759706924237, 224.9379447122767, 235.15932922047278, 271.0605855260529, 271.28033663114354, 251.07683715321417, 96.67882582749297, 261.1128309598904, 30.6967768379525, 85.92043803349355, 89.28071834811827, 33.30656458211796, 232.75088545282472, 252.64832749486027, 266.2474432805678, 31.51622162813851, 217.6499656408664, 239.9312411053935, 202.9624326660016, 295.29927974093414, 214.86577800941478, 216.6995776075355, 280.9009467988022, 238.8991532677005, 247.9953195812845, 44.26229145414071, 253.10856669061673, 146.0868816294976, 215.74061667013973, 271.02975419215375, 268.4916838000664, 257.3741856370562, 87.02997460540578, 234.02967214407562, 57.73644341021736, 291.54683679769676, 193.7335775399397, 291.15824025321126, 174.33359465429862, 256.592223477789, 251.50559887864097, 242.67572907340616, 242.97206810733184, 270.92540659906837], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 11, 26, 20, 10, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 29, 50, 50, 50, 50, 19, 50, 15, 50, 50, 50, 33, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.873109643532584, "mean_inference_ms": 1.258214696929041, "mean_action_processing_ms": 0.20979288654729736, "mean_env_wait_ms": 619.0999589213761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010670900344848633, "StateBufferConnector_ms": 0.006369590759277344, "ViewRequirementAgentConnector_ms": 0.1727440357208252}, "num_episodes": 11, "episode_return_max": 295.29927974093414, "episode_return_min": 30.23159148613159, "episode_return_mean": 207.85873446084273}, "episode_reward_max": 295.29927974093414, "episode_reward_min": 30.23159148613159, "episode_reward_mean": 207.85873446084273, "episode_len_mean": 44.33, "episodes_this_iter": 11, "episodes_timesteps_total": 4433, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [181.2767818801911, 245.77577293579867, 165.80802669521432, 212.04156225805934, 185.63047977748045, 245.02797807424122, 235.2377564018571, 181.72411329132987, 183.52575218789013, 204.54884393485594, 249.14357626286375, 149.09950908780354, 219.19204573691388, 221.97488771507489, 235.35551644236665, 30.23159148613159, 235.13643037738882, 218.24266893587046, 145.26377571780233, 278.51196685055885, 211.8005939817147, 177.42539001980919, 200.49893893365515, 272.4875308392649, 202.8486571772737, 221.74418701994034, 221.35654538849627, 112.814429518386, 254.20807016004557, 263.28126861957674, 190.27722371346545, 259.8902229489255, 31.435913126241246, 233.55928443708237, 38.36772141321063, 219.46119330402826, 218.30036242819415, 249.42371992173298, 254.47532667853562, 238.59069037884228, 195.28278828628822, 278.9803313752629, 222.37308121492742, 238.59734335749016, 212.36175154179233, 272.64080185738055, 231.05282304101883, 40.54341614911277, 187.3899031509992, 210.54822142747076, 230.6093551428608, 246.57234276526287, 255.21235439513407, 251.3463328989742, 267.8009325250305, 257.1666581066067, 253.18759706924237, 224.9379447122767, 235.15932922047278, 271.0605855260529, 271.28033663114354, 251.07683715321417, 96.67882582749297, 261.1128309598904, 30.6967768379525, 85.92043803349355, 89.28071834811827, 33.30656458211796, 232.75088545282472, 252.64832749486027, 266.2474432805678, 31.51622162813851, 217.6499656408664, 239.9312411053935, 202.9624326660016, 295.29927974093414, 214.86577800941478, 216.6995776075355, 280.9009467988022, 238.8991532677005, 247.9953195812845, 44.26229145414071, 253.10856669061673, 146.0868816294976, 215.74061667013973, 271.02975419215375, 268.4916838000664, 257.3741856370562, 87.02997460540578, 234.02967214407562, 57.73644341021736, 291.54683679769676, 193.7335775399397, 291.15824025321126, 174.33359465429862, 256.592223477789, 251.50559887864097, 242.67572907340616, 242.97206810733184, 270.92540659906837], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50, 11, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 10, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 11, 26, 20, 10, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 11, 50, 29, 50, 50, 50, 50, 19, 50, 15, 50, 50, 50, 33, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.873109643532584, "mean_inference_ms": 1.258214696929041, "mean_action_processing_ms": 0.20979288654729736, "mean_env_wait_ms": 619.0999589213761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010670900344848633, "StateBufferConnector_ms": 0.006369590759277344, "ViewRequirementAgentConnector_ms": 0.1727440357208252}, "num_episodes": 11, "episode_return_max": 295.29927974093414, "episode_return_min": 30.23159148613159, "episode_return_mean": 207.85873446084273, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13932, "num_agent_steps_trained": 13932, "num_env_steps_sampled": 13932, "num_env_steps_trained": 13932, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.635609226211051, "num_env_steps_trained_throughput_per_sec": 7.635609226211051, "timesteps_total": 13932, "num_env_steps_sampled_lifetime": 13932, "num_agent_steps_sampled_lifetime": 13932, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 13932, "timers": {"training_iteration_time_ms": 60119.675, "restore_workers_time_ms": 0.017, "training_step_time_ms": 60119.626, "sample_time_ms": 59455.597, "load_time_ms": 0.332, "load_throughput": 1554003.636, "learn_time_ms": 650.323, "learn_throughput": 793.452, "synch_weights_time_ms": 13.128}, "counters": {"num_env_steps_sampled": 13932, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 13932, "num_agent_steps_trained": 13932}, "done": false, "episodes_total": 574, "training_iteration": 27, "trial_id": "fe178_00005", "date": "2024-08-15_17-21-51", "timestamp": 1723764111, "time_this_iter_s": 67.58196640014648, "time_total_s": 1683.5501232147217, "pid": 84768, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 737.4783527851105, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.239583333333332, "ram_util_percent": 10.645833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.58746252854665, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.3756183385849, "policy_loss": -0.01788136799974988, "vf_loss": 8.390787732601165, "vf_explained_var": 0.07522941033045451, "kl": 0.005423939367310168, "entropy": 0.24731218541661898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "sampler_results": {"episode_reward_max": 273.5489280531057, "episode_reward_min": 112.02007987034379, "episode_reward_mean": 235.8009449366237, "episode_len_mean": 46.142857142857146, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 323, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [238.0197192976413, 273.5489280531057, 273.4442517068171, 268.90543189803816, 112.02007987034379, 247.60554531822913, 237.0626584121905], "episode_lengths": [50, 50, 50, 50, 23, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.751667013309271, "mean_inference_ms": 1.265294054654627, "mean_action_processing_ms": 0.20802588689894905, "mean_env_wait_ms": 529.5713793468005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009352820260184152, "StateBufferConnector_ms": 0.005745887756347656, "ViewRequirementAgentConnector_ms": 0.16431808471679688}, "num_episodes": 7, "episode_return_max": 273.5489280531057, "episode_return_min": 112.02007987034379, "episode_return_mean": 235.8009449366237}, "env_runner_results": {"episode_reward_max": 273.5489280531057, "episode_reward_min": 112.02007987034379, "episode_reward_mean": 235.8009449366237, "episode_len_mean": 46.142857142857146, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 323, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [238.0197192976413, 273.5489280531057, 273.4442517068171, 268.90543189803816, 112.02007987034379, 247.60554531822913, 237.0626584121905], "episode_lengths": [50, 50, 50, 50, 23, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.751667013309271, "mean_inference_ms": 1.265294054654627, "mean_action_processing_ms": 0.20802588689894905, "mean_env_wait_ms": 529.5713793468005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009352820260184152, "StateBufferConnector_ms": 0.005745887756347656, "ViewRequirementAgentConnector_ms": 0.16431808471679688}, "num_episodes": 7, "episode_return_max": 273.5489280531057, "episode_return_min": 112.02007987034379, "episode_return_mean": 235.8009449366237}, "episode_reward_max": 273.5489280531057, "episode_reward_min": 112.02007987034379, "episode_reward_mean": 235.8009449366237, "episode_len_mean": 46.142857142857146, "episodes_this_iter": 7, "episodes_timesteps_total": 323, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [238.0197192976413, 273.5489280531057, 273.4442517068171, 268.90543189803816, 112.02007987034379, 247.60554531822913, 237.0626584121905], "episode_lengths": [50, 50, 50, 50, 23, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.751667013309271, "mean_inference_ms": 1.265294054654627, "mean_action_processing_ms": 0.20802588689894905, "mean_env_wait_ms": 529.5713793468005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009352820260184152, "StateBufferConnector_ms": 0.005745887756347656, "ViewRequirementAgentConnector_ms": 0.16431808471679688}, "num_episodes": 7, "episode_return_max": 273.5489280531057, "episode_return_min": 112.02007987034379, "episode_return_mean": 235.8009449366237, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.172165063435592, "num_env_steps_trained_throughput_per_sec": 10.172165063435592, "timesteps_total": 14448, "num_env_steps_sampled_lifetime": 14448, "num_agent_steps_sampled_lifetime": 14448, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 14448, "timers": {"training_iteration_time_ms": 50726.677, "restore_workers_time_ms": 0.021, "training_step_time_ms": 50726.605, "sample_time_ms": 49390.695, "load_time_ms": 0.784, "load_throughput": 658230.19, "learn_time_ms": 1321.305, "learn_throughput": 390.523, "synch_weights_time_ms": 13.355}, "counters": {"num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "done": false, "episodes_total": 581, "training_iteration": 28, "trial_id": "fe178_00005", "date": "2024-08-15_17-23-23", "timestamp": 1723764203, "time_this_iter_s": 50.72975039482117, "time_total_s": 1734.2798736095428, "pid": 74007, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 50.72975039482117, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.220547945205478, "ram_util_percent": 11.986301369863014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.178089505434036, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.831399667263032, "policy_loss": -0.023579240039301414, "vf_loss": 8.849508917331695, "vf_explained_var": 0.2300044998526573, "kl": 0.010939986423365031, "entropy": 0.14571300282453498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14964, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 14964, "num_agent_steps_trained": 14964}, "sampler_results": {"episode_reward_max": 316.1701053305632, "episode_reward_min": 112.02007987034379, "episode_reward_mean": 259.57973229115555, "episode_len_mean": 48.5, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 873, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [238.0197192976413, 273.5489280531057, 273.4442517068171, 268.90543189803816, 112.02007987034379, 247.60554531822913, 237.0626584121905, 296.98624116908076, 303.3555275682909, 211.33682360067138, 316.1701053305632, 246.5981595039268, 289.1809299886623, 275.1813648529153, 271.40656803838283, 285.9564635069621, 272.47860532564727, 253.17777779933118], "episode_lengths": [50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.040497636540536, "mean_inference_ms": 1.2622025664216907, "mean_action_processing_ms": 0.20724740433657204, "mean_env_wait_ms": 554.0862599868719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011516941918267144, "StateBufferConnector_ms": 0.006107489267985026, "ViewRequirementAgentConnector_ms": 0.16569428973727757}, "num_episodes": 11, "episode_return_max": 316.1701053305632, "episode_return_min": 112.02007987034379, "episode_return_mean": 259.57973229115555}, "env_runner_results": {"episode_reward_max": 316.1701053305632, "episode_reward_min": 112.02007987034379, "episode_reward_mean": 259.57973229115555, "episode_len_mean": 48.5, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 873, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [238.0197192976413, 273.5489280531057, 273.4442517068171, 268.90543189803816, 112.02007987034379, 247.60554531822913, 237.0626584121905, 296.98624116908076, 303.3555275682909, 211.33682360067138, 316.1701053305632, 246.5981595039268, 289.1809299886623, 275.1813648529153, 271.40656803838283, 285.9564635069621, 272.47860532564727, 253.17777779933118], "episode_lengths": [50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.040497636540536, "mean_inference_ms": 1.2622025664216907, "mean_action_processing_ms": 0.20724740433657204, "mean_env_wait_ms": 554.0862599868719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011516941918267144, "StateBufferConnector_ms": 0.006107489267985026, "ViewRequirementAgentConnector_ms": 0.16569428973727757}, "num_episodes": 11, "episode_return_max": 316.1701053305632, "episode_return_min": 112.02007987034379, "episode_return_mean": 259.57973229115555}, "episode_reward_max": 316.1701053305632, "episode_reward_min": 112.02007987034379, "episode_reward_mean": 259.57973229115555, "episode_len_mean": 48.5, "episodes_this_iter": 11, "episodes_timesteps_total": 873, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [238.0197192976413, 273.5489280531057, 273.4442517068171, 268.90543189803816, 112.02007987034379, 247.60554531822913, 237.0626584121905, 296.98624116908076, 303.3555275682909, 211.33682360067138, 316.1701053305632, 246.5981595039268, 289.1809299886623, 275.1813648529153, 271.40656803838283, 285.9564635069621, 272.47860532564727, 253.17777779933118], "episode_lengths": [50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.040497636540536, "mean_inference_ms": 1.2622025664216907, "mean_action_processing_ms": 0.20724740433657204, "mean_env_wait_ms": 554.0862599868719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011516941918267144, "StateBufferConnector_ms": 0.006107489267985026, "ViewRequirementAgentConnector_ms": 0.16569428973727757}, "num_episodes": 11, "episode_return_max": 316.1701053305632, "episode_return_min": 112.02007987034379, "episode_return_mean": 259.57973229115555, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14964, "num_agent_steps_trained": 14964, "num_env_steps_sampled": 14964, "num_env_steps_trained": 14964, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.098168711885911, "num_env_steps_trained_throughput_per_sec": 9.098168711885911, "timesteps_total": 14964, "num_env_steps_sampled_lifetime": 14964, "num_agent_steps_sampled_lifetime": 14964, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 14964, "timers": {"training_iteration_time_ms": 53720.702, "restore_workers_time_ms": 0.023, "training_step_time_ms": 53720.626, "sample_time_ms": 52744.444, "load_time_ms": 0.575, "load_throughput": 898033.554, "learn_time_ms": 961.784, "learn_throughput": 536.503, "synch_weights_time_ms": 13.44}, "counters": {"num_env_steps_sampled": 14964, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 14964, "num_agent_steps_trained": 14964}, "done": false, "episodes_total": 592, "training_iteration": 29, "trial_id": "fe178_00005", "date": "2024-08-15_17-24-19", "timestamp": 1723764259, "time_this_iter_s": 56.71801829338074, "time_total_s": 1790.9978919029236, "pid": 74007, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 107.4477686882019, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 27.05308641975309, "ram_util_percent": 12.309876543209876}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.917687050501506, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.796538217862446, "policy_loss": -0.0183463911836346, "vf_loss": 8.810298057397207, "vf_explained_var": 0.10608639617760976, "kl": 0.009172936795707073, "entropy": 0.06435212281843027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15480, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 15480, "num_agent_steps_trained": 15480}, "sampler_results": {"episode_reward_max": 316.1701053305632, "episode_reward_min": 112.02007987034379, "episode_reward_mean": 265.0345371836386, "episode_len_mean": 49.1, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1473, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [238.0197192976413, 273.5489280531057, 273.4442517068171, 268.90543189803816, 112.02007987034379, 247.60554531822913, 237.0626584121905, 296.98624116908076, 303.3555275682909, 211.33682360067138, 316.1701053305632, 246.5981595039268, 289.1809299886623, 275.1813648529153, 271.40656803838283, 285.9564635069621, 272.47860532564727, 253.17777779933118, 281.50836310600863, 280.2250347077299, 231.06012885613694, 300.50101524960564, 267.2584430824291, 304.2594404927354, 280.04763074648224, 287.2659164554676, 218.46706232773454, 275.8637668217724, 285.594708675544, 266.54942374671106], "episode_lengths": [50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.252660372015542, "mean_inference_ms": 1.2609141721516253, "mean_action_processing_ms": 0.20684710102642861, "mean_env_wait_ms": 568.2112906070103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012022654215494791, "StateBufferConnector_ms": 0.006124973297119141, "ViewRequirementAgentConnector_ms": 0.16574223836263022}, "num_episodes": 12, "episode_return_max": 316.1701053305632, "episode_return_min": 112.02007987034379, "episode_return_mean": 265.0345371836386}, "env_runner_results": {"episode_reward_max": 316.1701053305632, "episode_reward_min": 112.02007987034379, "episode_reward_mean": 265.0345371836386, "episode_len_mean": 49.1, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1473, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [238.0197192976413, 273.5489280531057, 273.4442517068171, 268.90543189803816, 112.02007987034379, 247.60554531822913, 237.0626584121905, 296.98624116908076, 303.3555275682909, 211.33682360067138, 316.1701053305632, 246.5981595039268, 289.1809299886623, 275.1813648529153, 271.40656803838283, 285.9564635069621, 272.47860532564727, 253.17777779933118, 281.50836310600863, 280.2250347077299, 231.06012885613694, 300.50101524960564, 267.2584430824291, 304.2594404927354, 280.04763074648224, 287.2659164554676, 218.46706232773454, 275.8637668217724, 285.594708675544, 266.54942374671106], "episode_lengths": [50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.252660372015542, "mean_inference_ms": 1.2609141721516253, "mean_action_processing_ms": 0.20684710102642861, "mean_env_wait_ms": 568.2112906070103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012022654215494791, "StateBufferConnector_ms": 0.006124973297119141, "ViewRequirementAgentConnector_ms": 0.16574223836263022}, "num_episodes": 12, "episode_return_max": 316.1701053305632, "episode_return_min": 112.02007987034379, "episode_return_mean": 265.0345371836386}, "episode_reward_max": 316.1701053305632, "episode_reward_min": 112.02007987034379, "episode_reward_mean": 265.0345371836386, "episode_len_mean": 49.1, "episodes_this_iter": 12, "episodes_timesteps_total": 1473, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [238.0197192976413, 273.5489280531057, 273.4442517068171, 268.90543189803816, 112.02007987034379, 247.60554531822913, 237.0626584121905, 296.98624116908076, 303.3555275682909, 211.33682360067138, 316.1701053305632, 246.5981595039268, 289.1809299886623, 275.1813648529153, 271.40656803838283, 285.9564635069621, 272.47860532564727, 253.17777779933118, 281.50836310600863, 280.2250347077299, 231.06012885613694, 300.50101524960564, 267.2584430824291, 304.2594404927354, 280.04763074648224, 287.2659164554676, 218.46706232773454, 275.8637668217724, 285.594708675544, 266.54942374671106], "episode_lengths": [50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.252660372015542, "mean_inference_ms": 1.2609141721516253, "mean_action_processing_ms": 0.20684710102642861, "mean_env_wait_ms": 568.2112906070103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012022654215494791, "StateBufferConnector_ms": 0.006124973297119141, "ViewRequirementAgentConnector_ms": 0.16574223836263022}, "num_episodes": 12, "episode_return_max": 316.1701053305632, "episode_return_min": 112.02007987034379, "episode_return_mean": 265.0345371836386, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15480, "num_agent_steps_trained": 15480, "num_env_steps_sampled": 15480, "num_env_steps_trained": 15480, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.837652335064469, "num_env_steps_trained_throughput_per_sec": 8.837652335064469, "timesteps_total": 15480, "num_env_steps_sampled_lifetime": 15480, "num_agent_steps_sampled_lifetime": 15480, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 15480, "timers": {"training_iteration_time_ms": 55275.987, "restore_workers_time_ms": 0.021, "training_step_time_ms": 55275.919, "sample_time_ms": 54395.711, "load_time_ms": 0.483, "load_throughput": 1068067.543, "learn_time_ms": 865.965, "learn_throughput": 595.867, "synch_weights_time_ms": 13.424}, "counters": {"num_env_steps_sampled": 15480, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 15480, "num_agent_steps_trained": 15480}, "done": false, "episodes_total": 604, "training_iteration": 30, "trial_id": "fe178_00005", "date": "2024-08-15_17-25-18", "timestamp": 1723764318, "time_this_iter_s": 58.38979506492615, "time_total_s": 1849.3876869678497, "pid": 74007, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 165.83756375312805, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.216867469879517, "ram_util_percent": 12.09397590361446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.122232283155123, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.833176755905152, "policy_loss": -0.01375644422757129, "vf_loss": 8.843755968411763, "vf_explained_var": 0.09459957927465439, "kl": 0.006354575794831161, "entropy": 0.1104298496618867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15996, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 15996, "num_agent_steps_trained": 15996}, "sampler_results": {"episode_reward_max": 299.103724077468, "episode_reward_min": 235.4385229090019, "episode_reward_mean": 271.04575608178374, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.176596115375387, "mean_inference_ms": 1.2615608529569544, "mean_action_processing_ms": 0.20968000550836438, "mean_env_wait_ms": 587.2894141865872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00959634780883789, "StateBufferConnector_ms": 0.005718072255452474, "ViewRequirementAgentConnector_ms": 0.17088651657104492}, "num_episodes": 6, "episode_return_max": 299.103724077468, "episode_return_min": 235.4385229090019, "episode_return_mean": 271.04575608178374}, "env_runner_results": {"episode_reward_max": 299.103724077468, "episode_reward_min": 235.4385229090019, "episode_reward_mean": 271.04575608178374, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.176596115375387, "mean_inference_ms": 1.2615608529569544, "mean_action_processing_ms": 0.20968000550836438, "mean_env_wait_ms": 587.2894141865872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00959634780883789, "StateBufferConnector_ms": 0.005718072255452474, "ViewRequirementAgentConnector_ms": 0.17088651657104492}, "num_episodes": 6, "episode_return_max": 299.103724077468, "episode_return_min": 235.4385229090019, "episode_return_mean": 271.04575608178374}, "episode_reward_max": 299.103724077468, "episode_reward_min": 235.4385229090019, "episode_reward_mean": 271.04575608178374, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.176596115375387, "mean_inference_ms": 1.2615608529569544, "mean_action_processing_ms": 0.20968000550836438, "mean_env_wait_ms": 587.2894141865872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00959634780883789, "StateBufferConnector_ms": 0.005718072255452474, "ViewRequirementAgentConnector_ms": 0.17088651657104492}, "num_episodes": 6, "episode_return_max": 299.103724077468, "episode_return_min": 235.4385229090019, "episode_return_mean": 271.04575608178374, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15996, "num_agent_steps_trained": 15996, "num_env_steps_sampled": 15996, "num_env_steps_trained": 15996, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.8123536815113, "num_env_steps_trained_throughput_per_sec": 8.8123536815113, "timesteps_total": 15996, "num_env_steps_sampled_lifetime": 15996, "num_agent_steps_sampled_lifetime": 15996, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 15996, "timers": {"training_iteration_time_ms": 58554.178, "restore_workers_time_ms": 0.02, "training_step_time_ms": 58554.107, "sample_time_ms": 55002.025, "load_time_ms": 0.748, "load_throughput": 689694.348, "learn_time_ms": 3537.26, "learn_throughput": 145.876, "synch_weights_time_ms": 13.529}, "counters": {"num_env_steps_sampled": 15996, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 15996, "num_agent_steps_trained": 15996}, "done": false, "episodes_total": 610, "training_iteration": 31, "trial_id": "fe178_00005", "date": "2024-08-15_17-26-57", "timestamp": 1723764417, "time_this_iter_s": 58.55688190460205, "time_total_s": 1907.9445688724518, "pid": 97854, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 58.55688190460205, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.317857142857147, "ram_util_percent": 12.380952380952383}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.670026936133702, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.950525403022766, "policy_loss": -0.016444946313276886, "vf_loss": 8.963937664031983, "vf_explained_var": 0.22294387519359588, "kl": 0.006065199993153873, "entropy": 0.004433338282008966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16512, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 16512, "num_agent_steps_trained": 16512}, "sampler_results": {"episode_reward_max": 316.9836901957657, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 264.2430799113639, "episode_len_mean": 46.55, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 931, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.22119451239215, "mean_inference_ms": 1.2625143556656309, "mean_action_processing_ms": 0.20933001233560206, "mean_env_wait_ms": 559.7648000417773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011926889419555664, "StateBufferConnector_ms": 0.007075071334838867, "ViewRequirementAgentConnector_ms": 0.1702260971069336}, "num_episodes": 14, "episode_return_max": 316.9836901957657, "episode_return_min": 38.45344811433017, "episode_return_mean": 264.2430799113639}, "env_runner_results": {"episode_reward_max": 316.9836901957657, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 264.2430799113639, "episode_len_mean": 46.55, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 931, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.22119451239215, "mean_inference_ms": 1.2625143556656309, "mean_action_processing_ms": 0.20933001233560206, "mean_env_wait_ms": 559.7648000417773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011926889419555664, "StateBufferConnector_ms": 0.007075071334838867, "ViewRequirementAgentConnector_ms": 0.1702260971069336}, "num_episodes": 14, "episode_return_max": 316.9836901957657, "episode_return_min": 38.45344811433017, "episode_return_mean": 264.2430799113639}, "episode_reward_max": 316.9836901957657, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 264.2430799113639, "episode_len_mean": 46.55, "episodes_this_iter": 14, "episodes_timesteps_total": 931, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.22119451239215, "mean_inference_ms": 1.2625143556656309, "mean_action_processing_ms": 0.20933001233560206, "mean_env_wait_ms": 559.7648000417773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011926889419555664, "StateBufferConnector_ms": 0.007075071334838867, "ViewRequirementAgentConnector_ms": 0.1702260971069336}, "num_episodes": 14, "episode_return_max": 316.9836901957657, "episode_return_min": 38.45344811433017, "episode_return_mean": 264.2430799113639, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16512, "num_agent_steps_trained": 16512, "num_env_steps_sampled": 16512, "num_env_steps_trained": 16512, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.698028212905495, "num_env_steps_trained_throughput_per_sec": 10.698028212905495, "timesteps_total": 16512, "num_env_steps_sampled_lifetime": 16512, "num_agent_steps_sampled_lifetime": 16512, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 16512, "timers": {"training_iteration_time_ms": 53393.688, "restore_workers_time_ms": 0.018, "training_step_time_ms": 53393.624, "sample_time_ms": 51314.2, "load_time_ms": 0.542, "load_throughput": 952579.606, "learn_time_ms": 2065.193, "learn_throughput": 249.856, "synch_weights_time_ms": 13.298}, "counters": {"num_env_steps_sampled": 16512, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 16512, "num_agent_steps_trained": 16512}, "done": false, "episodes_total": 624, "training_iteration": 32, "trial_id": "fe178_00005", "date": "2024-08-15_17-27-45", "timestamp": 1723764465, "time_this_iter_s": 48.236287355422974, "time_total_s": 1956.1808562278748, "pid": 97854, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 106.79316926002502, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.510144927536228, "ram_util_percent": 12.186956521739127}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.446749599774678, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.917667365074157, "policy_loss": -0.014942321887550255, "vf_loss": 8.929680522282919, "vf_explained_var": 0.060197510321935016, "kl": 0.005858170310725095, "entropy": -0.0057112380862236025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17028, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 17028, "num_agent_steps_trained": 17028}, "sampler_results": {"episode_reward_max": 326.9029837664604, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 272.1447336789482, "episode_len_mean": 47.4, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1422, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361, 298.1624838015481, 323.4332245121546, 269.43033736997995, 209.43131936693612, 326.9029837664604, 302.9063771064341, 239.40330823195683, 307.8707847516188, 277.92579907800194, 324.0137941560786], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.340786023354162, "mean_inference_ms": 1.2644273581895602, "mean_action_processing_ms": 0.20957773740524777, "mean_env_wait_ms": 545.0828577882851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012392203013102213, "StateBufferConnector_ms": 0.006682872772216797, "ViewRequirementAgentConnector_ms": 0.16946077346801758}, "num_episodes": 10, "episode_return_max": 326.9029837664604, "episode_return_min": 38.45344811433017, "episode_return_mean": 272.1447336789482}, "env_runner_results": {"episode_reward_max": 326.9029837664604, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 272.1447336789482, "episode_len_mean": 47.4, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1422, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361, 298.1624838015481, 323.4332245121546, 269.43033736997995, 209.43131936693612, 326.9029837664604, 302.9063771064341, 239.40330823195683, 307.8707847516188, 277.92579907800194, 324.0137941560786], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.340786023354162, "mean_inference_ms": 1.2644273581895602, "mean_action_processing_ms": 0.20957773740524777, "mean_env_wait_ms": 545.0828577882851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012392203013102213, "StateBufferConnector_ms": 0.006682872772216797, "ViewRequirementAgentConnector_ms": 0.16946077346801758}, "num_episodes": 10, "episode_return_max": 326.9029837664604, "episode_return_min": 38.45344811433017, "episode_return_mean": 272.1447336789482}, "episode_reward_max": 326.9029837664604, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 272.1447336789482, "episode_len_mean": 47.4, "episodes_this_iter": 10, "episodes_timesteps_total": 1422, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361, 298.1624838015481, 323.4332245121546, 269.43033736997995, 209.43131936693612, 326.9029837664604, 302.9063771064341, 239.40330823195683, 307.8707847516188, 277.92579907800194, 324.0137941560786], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.340786023354162, "mean_inference_ms": 1.2644273581895602, "mean_action_processing_ms": 0.20957773740524777, "mean_env_wait_ms": 545.0828577882851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012392203013102213, "StateBufferConnector_ms": 0.006682872772216797, "ViewRequirementAgentConnector_ms": 0.16946077346801758}, "num_episodes": 10, "episode_return_max": 326.9029837664604, "episode_return_min": 38.45344811433017, "episode_return_mean": 272.1447336789482, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17028, "num_agent_steps_trained": 17028, "num_env_steps_sampled": 17028, "num_env_steps_trained": 17028, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.117653775247106, "num_env_steps_trained_throughput_per_sec": 10.117653775247106, "timesteps_total": 17028, "num_env_steps_sampled_lifetime": 17028, "num_agent_steps_sampled_lifetime": 17028, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 17028, "timers": {"training_iteration_time_ms": 52595.784, "restore_workers_time_ms": 0.017, "training_step_time_ms": 52595.726, "sample_time_ms": 50972.237, "load_time_ms": 0.481, "load_throughput": 1072832.55, "learn_time_ms": 1609.343, "learn_throughput": 320.628, "synch_weights_time_ms": 13.315}, "counters": {"num_env_steps_sampled": 17028, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 17028, "num_agent_steps_trained": 17028}, "done": false, "episodes_total": 634, "training_iteration": 33, "trial_id": "fe178_00005", "date": "2024-08-15_17-28-36", "timestamp": 1723764516, "time_this_iter_s": 51.00300693511963, "time_total_s": 2007.1838631629944, "pid": 97854, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 157.79617619514465, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 28.40547945205479, "ram_util_percent": 11.319178082191781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.207313438256582, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 9.109921979904176, "policy_loss": -0.010209352585176627, "vf_loss": 9.11813604036967, "vf_explained_var": 0.12078948020935058, "kl": 0.003990584263071166, "entropy": -0.021023863325050723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17544, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 17544, "num_agent_steps_trained": 17544}, "sampler_results": {"episode_reward_max": 326.9029837664604, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 267.4835106390341, "episode_len_mean": 46.63414634146341, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1912, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361, 298.1624838015481, 323.4332245121546, 269.43033736997995, 209.43131936693612, 326.9029837664604, 302.9063771064341, 239.40330823195683, 307.8707847516188, 277.92579907800194, 324.0137941560786, 287.06950503933695, 269.5564664736681, 280.02014673960764, 89.8696223772394, 126.55292419768631, 316.6479698215635, 292.85399874507857, 283.0246582238703, 309.7538937629583, 260.03883467246965, 287.09390577847034], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 23, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.45810747790984, "mean_inference_ms": 1.266123772607947, "mean_action_processing_ms": 0.20989205118212068, "mean_env_wait_ms": 533.5174238490797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012087240451719702, "StateBufferConnector_ms": 0.006537321137218941, "ViewRequirementAgentConnector_ms": 0.1699831427597418}, "num_episodes": 11, "episode_return_max": 326.9029837664604, "episode_return_min": 38.45344811433017, "episode_return_mean": 267.4835106390341}, "env_runner_results": {"episode_reward_max": 326.9029837664604, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 267.4835106390341, "episode_len_mean": 46.63414634146341, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1912, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361, 298.1624838015481, 323.4332245121546, 269.43033736997995, 209.43131936693612, 326.9029837664604, 302.9063771064341, 239.40330823195683, 307.8707847516188, 277.92579907800194, 324.0137941560786, 287.06950503933695, 269.5564664736681, 280.02014673960764, 89.8696223772394, 126.55292419768631, 316.6479698215635, 292.85399874507857, 283.0246582238703, 309.7538937629583, 260.03883467246965, 287.09390577847034], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 23, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.45810747790984, "mean_inference_ms": 1.266123772607947, "mean_action_processing_ms": 0.20989205118212068, "mean_env_wait_ms": 533.5174238490797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012087240451719702, "StateBufferConnector_ms": 0.006537321137218941, "ViewRequirementAgentConnector_ms": 0.1699831427597418}, "num_episodes": 11, "episode_return_max": 326.9029837664604, "episode_return_min": 38.45344811433017, "episode_return_mean": 267.4835106390341}, "episode_reward_max": 326.9029837664604, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 267.4835106390341, "episode_len_mean": 46.63414634146341, "episodes_this_iter": 11, "episodes_timesteps_total": 1912, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361, 298.1624838015481, 323.4332245121546, 269.43033736997995, 209.43131936693612, 326.9029837664604, 302.9063771064341, 239.40330823195683, 307.8707847516188, 277.92579907800194, 324.0137941560786, 287.06950503933695, 269.5564664736681, 280.02014673960764, 89.8696223772394, 126.55292419768631, 316.6479698215635, 292.85399874507857, 283.0246582238703, 309.7538937629583, 260.03883467246965, 287.09390577847034], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 23, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.45810747790984, "mean_inference_ms": 1.266123772607947, "mean_action_processing_ms": 0.20989205118212068, "mean_env_wait_ms": 533.5174238490797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012087240451719702, "StateBufferConnector_ms": 0.006537321137218941, "ViewRequirementAgentConnector_ms": 0.1699831427597418}, "num_episodes": 11, "episode_return_max": 326.9029837664604, "episode_return_min": 38.45344811433017, "episode_return_mean": 267.4835106390341, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17544, "num_agent_steps_trained": 17544, "num_env_steps_sampled": 17544, "num_env_steps_trained": 17544, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 11.003988409071756, "num_env_steps_trained_throughput_per_sec": 11.003988409071756, "timesteps_total": 17544, "num_env_steps_sampled_lifetime": 17544, "num_agent_steps_sampled_lifetime": 17544, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 17544, "timers": {"training_iteration_time_ms": 51169.865, "restore_workers_time_ms": 0.02, "training_step_time_ms": 51169.8, "sample_time_ms": 49779.956, "load_time_ms": 0.441, "load_throughput": 1170345.202, "learn_time_ms": 1375.735, "learn_throughput": 375.072, "synch_weights_time_ms": 13.331}, "counters": {"num_env_steps_sampled": 17544, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 17544, "num_agent_steps_trained": 17544}, "done": false, "episodes_total": 645, "training_iteration": 34, "trial_id": "fe178_00005", "date": "2024-08-15_17-29-23", "timestamp": 1723764563, "time_this_iter_s": 46.89514350891113, "time_total_s": 2054.0790066719055, "pid": 97854, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 204.6913197040558, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 33.23582089552239, "ram_util_percent": 12.4044776119403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.455663132667542, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 8.503044299284618, "policy_loss": -0.022613643024427196, "vf_loss": 8.522042373816172, "vf_explained_var": 0.19151891767978668, "kl": 0.014462376803083524, "entropy": -0.028112088236957787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18060, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 18060, "num_agent_steps_trained": 18060}, "sampler_results": {"episode_reward_max": 326.9029837664604, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 263.205061945095, "episode_len_mean": 45.867924528301884, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2431, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361, 298.1624838015481, 323.4332245121546, 269.43033736997995, 209.43131936693612, 326.9029837664604, 302.9063771064341, 239.40330823195683, 307.8707847516188, 277.92579907800194, 324.0137941560786, 287.06950503933695, 269.5564664736681, 280.02014673960764, 89.8696223772394, 126.55292419768631, 316.6479698215635, 292.85399874507857, 283.0246582238703, 309.7538937629583, 260.03883467246965, 287.09390577847034, 316.10670425352146, 300.36433561842546, 274.14291276952184, 81.71732105105426, 192.69875069651232, 290.5562847971774, 317.5107654332715, 300.95995278998, 287.1272267046967, 64.67557620768171, 300.2477561154808, 256.9367604523173], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 38, 50, 50, 50, 50, 13, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.542256934925712, "mean_inference_ms": 1.2665747420715174, "mean_action_processing_ms": 0.20992247861124508, "mean_env_wait_ms": 528.449826709584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012123359824126621, "StateBufferConnector_ms": 0.006451246873387751, "ViewRequirementAgentConnector_ms": 0.17104283818658791}, "num_episodes": 12, "episode_return_max": 326.9029837664604, "episode_return_min": 38.45344811433017, "episode_return_mean": 263.205061945095}, "env_runner_results": {"episode_reward_max": 326.9029837664604, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 263.205061945095, "episode_len_mean": 45.867924528301884, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2431, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361, 298.1624838015481, 323.4332245121546, 269.43033736997995, 209.43131936693612, 326.9029837664604, 302.9063771064341, 239.40330823195683, 307.8707847516188, 277.92579907800194, 324.0137941560786, 287.06950503933695, 269.5564664736681, 280.02014673960764, 89.8696223772394, 126.55292419768631, 316.6479698215635, 292.85399874507857, 283.0246582238703, 309.7538937629583, 260.03883467246965, 287.09390577847034, 316.10670425352146, 300.36433561842546, 274.14291276952184, 81.71732105105426, 192.69875069651232, 290.5562847971774, 317.5107654332715, 300.95995278998, 287.1272267046967, 64.67557620768171, 300.2477561154808, 256.9367604523173], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 38, 50, 50, 50, 50, 13, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.542256934925712, "mean_inference_ms": 1.2665747420715174, "mean_action_processing_ms": 0.20992247861124508, "mean_env_wait_ms": 528.449826709584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012123359824126621, "StateBufferConnector_ms": 0.006451246873387751, "ViewRequirementAgentConnector_ms": 0.17104283818658791}, "num_episodes": 12, "episode_return_max": 326.9029837664604, "episode_return_min": 38.45344811433017, "episode_return_mean": 263.205061945095}, "episode_reward_max": 326.9029837664604, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 263.205061945095, "episode_len_mean": 45.867924528301884, "episodes_this_iter": 12, "episodes_timesteps_total": 2431, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361, 298.1624838015481, 323.4332245121546, 269.43033736997995, 209.43131936693612, 326.9029837664604, 302.9063771064341, 239.40330823195683, 307.8707847516188, 277.92579907800194, 324.0137941560786, 287.06950503933695, 269.5564664736681, 280.02014673960764, 89.8696223772394, 126.55292419768631, 316.6479698215635, 292.85399874507857, 283.0246582238703, 309.7538937629583, 260.03883467246965, 287.09390577847034, 316.10670425352146, 300.36433561842546, 274.14291276952184, 81.71732105105426, 192.69875069651232, 290.5562847971774, 317.5107654332715, 300.95995278998, 287.1272267046967, 64.67557620768171, 300.2477561154808, 256.9367604523173], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 38, 50, 50, 50, 50, 13, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.542256934925712, "mean_inference_ms": 1.2665747420715174, "mean_action_processing_ms": 0.20992247861124508, "mean_env_wait_ms": 528.449826709584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012123359824126621, "StateBufferConnector_ms": 0.006451246873387751, "ViewRequirementAgentConnector_ms": 0.17104283818658791}, "num_episodes": 12, "episode_return_max": 326.9029837664604, "episode_return_min": 38.45344811433017, "episode_return_mean": 263.205061945095, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18060, "num_agent_steps_trained": 18060, "num_env_steps_sampled": 18060, "num_env_steps_trained": 18060, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.013817745230664, "num_env_steps_trained_throughput_per_sec": 10.013817745230664, "timesteps_total": 18060, "num_env_steps_sampled_lifetime": 18060, "num_agent_steps_sampled_lifetime": 18060, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 18060, "timers": {"training_iteration_time_ms": 51241.659, "restore_workers_time_ms": 0.019, "training_step_time_ms": 51241.592, "sample_time_ms": 50000.171, "load_time_ms": 0.415, "load_throughput": 1244114.086, "learn_time_ms": 1227.512, "learn_throughput": 420.362, "synch_weights_time_ms": 13.175}, "counters": {"num_env_steps_sampled": 18060, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 18060, "num_agent_steps_trained": 18060}, "done": false, "episodes_total": 657, "training_iteration": 35, "trial_id": "fe178_00005", "date": "2024-08-15_17-30-15", "timestamp": 1723764615, "time_this_iter_s": 51.531806230545044, "time_total_s": 2105.6108129024506, "pid": 97854, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 256.22312593460083, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.97671232876712, "ram_util_percent": 12.504109589041095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.012405884265899, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.03091396490733, "policy_loss": -0.02125145116976152, "vf_loss": 9.049241360028585, "vf_explained_var": 0.0008942728241284688, "kl": 0.011696248453034045, "entropy": -0.13355492781847716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18576, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 18576, "num_agent_steps_trained": 18576}, "sampler_results": {"episode_reward_max": 326.9029837664604, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 267.1684359063437, "episode_len_mean": 46.523809523809526, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2931, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361, 298.1624838015481, 323.4332245121546, 269.43033736997995, 209.43131936693612, 326.9029837664604, 302.9063771064341, 239.40330823195683, 307.8707847516188, 277.92579907800194, 324.0137941560786, 287.06950503933695, 269.5564664736681, 280.02014673960764, 89.8696223772394, 126.55292419768631, 316.6479698215635, 292.85399874507857, 283.0246582238703, 309.7538937629583, 260.03883467246965, 287.09390577847034, 316.10670425352146, 300.36433561842546, 274.14291276952184, 81.71732105105426, 192.69875069651232, 290.5562847971774, 317.5107654332715, 300.95995278998, 287.1272267046967, 64.67557620768171, 300.2477561154808, 256.9367604523173, 314.0773327317002, 304.75451061334167, 279.6483381477904, 296.99623961681107, 294.5827127725037, 285.92340512584474, 220.84852635744227, 281.3825977402736, 296.8435463220356, 306.6859695818718], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 38, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.572823103496195, "mean_inference_ms": 1.2670943172036504, "mean_action_processing_ms": 0.21008747182043602, "mean_env_wait_ms": 527.8104333795171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01224336170014881, "StateBufferConnector_ms": 0.006380913749573723, "ViewRequirementAgentConnector_ms": 0.17158531007312594}, "num_episodes": 10, "episode_return_max": 326.9029837664604, "episode_return_min": 38.45344811433017, "episode_return_mean": 267.1684359063437}, "env_runner_results": {"episode_reward_max": 326.9029837664604, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 267.1684359063437, "episode_len_mean": 46.523809523809526, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2931, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361, 298.1624838015481, 323.4332245121546, 269.43033736997995, 209.43131936693612, 326.9029837664604, 302.9063771064341, 239.40330823195683, 307.8707847516188, 277.92579907800194, 324.0137941560786, 287.06950503933695, 269.5564664736681, 280.02014673960764, 89.8696223772394, 126.55292419768631, 316.6479698215635, 292.85399874507857, 283.0246582238703, 309.7538937629583, 260.03883467246965, 287.09390577847034, 316.10670425352146, 300.36433561842546, 274.14291276952184, 81.71732105105426, 192.69875069651232, 290.5562847971774, 317.5107654332715, 300.95995278998, 287.1272267046967, 64.67557620768171, 300.2477561154808, 256.9367604523173, 314.0773327317002, 304.75451061334167, 279.6483381477904, 296.99623961681107, 294.5827127725037, 285.92340512584474, 220.84852635744227, 281.3825977402736, 296.8435463220356, 306.6859695818718], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 38, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.572823103496195, "mean_inference_ms": 1.2670943172036504, "mean_action_processing_ms": 0.21008747182043602, "mean_env_wait_ms": 527.8104333795171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01224336170014881, "StateBufferConnector_ms": 0.006380913749573723, "ViewRequirementAgentConnector_ms": 0.17158531007312594}, "num_episodes": 10, "episode_return_max": 326.9029837664604, "episode_return_min": 38.45344811433017, "episode_return_mean": 267.1684359063437}, "episode_reward_max": 326.9029837664604, "episode_reward_min": 38.45344811433017, "episode_reward_mean": 267.1684359063437, "episode_len_mean": 46.523809523809526, "episodes_this_iter": 10, "episodes_timesteps_total": 2931, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [235.4385229090019, 276.11818829414386, 265.33262493680735, 270.2724038592924, 299.103724077468, 280.0090724139885, 316.9836901957657, 281.4076727758903, 298.87102135794515, 296.15243434719923, 273.1676661200688, 306.08778191181443, 286.95046713581786, 283.9947194068025, 298.7060208820752, 283.4079499179065, 38.45344811433017, 306.1635431061496, 108.277362534875, 279.9632839299361, 298.1624838015481, 323.4332245121546, 269.43033736997995, 209.43131936693612, 326.9029837664604, 302.9063771064341, 239.40330823195683, 307.8707847516188, 277.92579907800194, 324.0137941560786, 287.06950503933695, 269.5564664736681, 280.02014673960764, 89.8696223772394, 126.55292419768631, 316.6479698215635, 292.85399874507857, 283.0246582238703, 309.7538937629583, 260.03883467246965, 287.09390577847034, 316.10670425352146, 300.36433561842546, 274.14291276952184, 81.71732105105426, 192.69875069651232, 290.5562847971774, 317.5107654332715, 300.95995278998, 287.1272267046967, 64.67557620768171, 300.2477561154808, 256.9367604523173, 314.0773327317002, 304.75451061334167, 279.6483381477904, 296.99623961681107, 294.5827127725037, 285.92340512584474, 220.84852635744227, 281.3825977402736, 296.8435463220356, 306.6859695818718], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 9, 50, 22, 50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 38, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.572823103496195, "mean_inference_ms": 1.2670943172036504, "mean_action_processing_ms": 0.21008747182043602, "mean_env_wait_ms": 527.8104333795171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01224336170014881, "StateBufferConnector_ms": 0.006380913749573723, "ViewRequirementAgentConnector_ms": 0.17158531007312594}, "num_episodes": 10, "episode_return_max": 326.9029837664604, "episode_return_min": 38.45344811433017, "episode_return_mean": 267.1684359063437, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18576, "num_agent_steps_trained": 18576, "num_env_steps_sampled": 18576, "num_env_steps_trained": 18576, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.209079008088814, "num_env_steps_trained_throughput_per_sec": 9.209079008088814, "timesteps_total": 18576, "num_env_steps_sampled_lifetime": 18576, "num_agent_steps_sampled_lifetime": 18576, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 18576, "timers": {"training_iteration_time_ms": 52039.995, "restore_workers_time_ms": 0.019, "training_step_time_ms": 52039.93, "sample_time_ms": 50886.417, "load_time_ms": 0.403, "load_throughput": 1281133.108, "learn_time_ms": 1139.532, "learn_throughput": 452.817, "synch_weights_time_ms": 13.267}, "counters": {"num_env_steps_sampled": 18576, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 18576, "num_agent_steps_trained": 18576}, "done": false, "episodes_total": 667, "training_iteration": 36, "trial_id": "fe178_00005", "date": "2024-08-15_17-31-11", "timestamp": 1723764671, "time_this_iter_s": 56.035218238830566, "time_total_s": 2161.646031141281, "pid": 97854, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 312.2583441734314, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 27.2175, "ram_util_percent": 12.257499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.560301462809244, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.242367307345072, "policy_loss": -0.012763335447137555, "vf_loss": 9.252577352523804, "vf_explained_var": 0.04130224088827769, "kl": 0.010213063342722544, "entropy": -0.24310388321367402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19092, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 19092, "num_agent_steps_trained": 19092}, "sampler_results": {"episode_reward_max": 326.57331603299104, "episode_reward_min": 278.76602545666293, "episode_reward_mean": 298.4317402152613, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.174116014064043, "mean_inference_ms": 1.260192458200272, "mean_action_processing_ms": 0.20776900295096792, "mean_env_wait_ms": 533.4872870609678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00925461451212565, "StateBufferConnector_ms": 0.0058650970458984375, "ViewRequirementAgentConnector_ms": 0.16463200251261392}, "num_episodes": 6, "episode_return_max": 326.57331603299104, "episode_return_min": 278.76602545666293, "episode_return_mean": 298.4317402152613}, "env_runner_results": {"episode_reward_max": 326.57331603299104, "episode_reward_min": 278.76602545666293, "episode_reward_mean": 298.4317402152613, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.174116014064043, "mean_inference_ms": 1.260192458200272, "mean_action_processing_ms": 0.20776900295096792, "mean_env_wait_ms": 533.4872870609678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00925461451212565, "StateBufferConnector_ms": 0.0058650970458984375, "ViewRequirementAgentConnector_ms": 0.16463200251261392}, "num_episodes": 6, "episode_return_max": 326.57331603299104, "episode_return_min": 278.76602545666293, "episode_return_mean": 298.4317402152613}, "episode_reward_max": 326.57331603299104, "episode_reward_min": 278.76602545666293, "episode_reward_mean": 298.4317402152613, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.174116014064043, "mean_inference_ms": 1.260192458200272, "mean_action_processing_ms": 0.20776900295096792, "mean_env_wait_ms": 533.4872870609678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00925461451212565, "StateBufferConnector_ms": 0.0058650970458984375, "ViewRequirementAgentConnector_ms": 0.16463200251261392}, "num_episodes": 6, "episode_return_max": 326.57331603299104, "episode_return_min": 278.76602545666293, "episode_return_mean": 298.4317402152613, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19092, "num_agent_steps_trained": 19092, "num_env_steps_sampled": 19092, "num_env_steps_trained": 19092, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.925634561080049, "num_env_steps_trained_throughput_per_sec": 9.925634561080049, "timesteps_total": 19092, "num_env_steps_sampled_lifetime": 19092, "num_agent_steps_sampled_lifetime": 19092, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 19092, "timers": {"training_iteration_time_ms": 51986.614, "restore_workers_time_ms": 0.02, "training_step_time_ms": 51986.553, "sample_time_ms": 49339.067, "load_time_ms": 0.793, "load_throughput": 650318.769, "learn_time_ms": 2632.772, "learn_throughput": 195.991, "synch_weights_time_ms": 13.463}, "counters": {"num_env_steps_sampled": 19092, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 19092, "num_agent_steps_trained": 19092}, "done": false, "episodes_total": 673, "training_iteration": 37, "trial_id": "fe178_00005", "date": "2024-08-15_17-32-51", "timestamp": 1723764771, "time_this_iter_s": 51.989819288253784, "time_total_s": 2213.635850429535, "pid": 46029, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 51.989819288253784, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.168000000000006, "ram_util_percent": 11.597333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.336731390158336, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.226975790659587, "policy_loss": -0.025888964782158533, "vf_loss": 9.250694433848063, "vf_explained_var": 0.03770387669404348, "kl": 0.008681346930067472, "entropy": -0.2524397121121486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19608, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 19608, "num_agent_steps_trained": 19608}, "sampler_results": {"episode_reward_max": 326.57331603299104, "episode_reward_min": 197.98872977709323, "episode_reward_mean": 299.26603147386845, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.914483654325597, "mean_inference_ms": 1.260265160034985, "mean_action_processing_ms": 0.2079207024239759, "mean_env_wait_ms": 548.5443227344385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012058681911892362, "StateBufferConnector_ms": 0.0062677595350477434, "ViewRequirementAgentConnector_ms": 0.16761753294203016}, "num_episodes": 12, "episode_return_max": 326.57331603299104, "episode_return_min": 197.98872977709323, "episode_return_mean": 299.26603147386845}, "env_runner_results": {"episode_reward_max": 326.57331603299104, "episode_reward_min": 197.98872977709323, "episode_reward_mean": 299.26603147386845, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.914483654325597, "mean_inference_ms": 1.260265160034985, "mean_action_processing_ms": 0.2079207024239759, "mean_env_wait_ms": 548.5443227344385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012058681911892362, "StateBufferConnector_ms": 0.0062677595350477434, "ViewRequirementAgentConnector_ms": 0.16761753294203016}, "num_episodes": 12, "episode_return_max": 326.57331603299104, "episode_return_min": 197.98872977709323, "episode_return_mean": 299.26603147386845}, "episode_reward_max": 326.57331603299104, "episode_reward_min": 197.98872977709323, "episode_reward_mean": 299.26603147386845, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.914483654325597, "mean_inference_ms": 1.260265160034985, "mean_action_processing_ms": 0.2079207024239759, "mean_env_wait_ms": 548.5443227344385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012058681911892362, "StateBufferConnector_ms": 0.0062677595350477434, "ViewRequirementAgentConnector_ms": 0.16761753294203016}, "num_episodes": 12, "episode_return_max": 326.57331603299104, "episode_return_min": 197.98872977709323, "episode_return_mean": 299.26603147386845, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19608, "num_agent_steps_trained": 19608, "num_env_steps_sampled": 19608, "num_env_steps_trained": 19608, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.549902582878154, "num_env_steps_trained_throughput_per_sec": 9.549902582878154, "timesteps_total": 19608, "num_env_steps_sampled_lifetime": 19608, "num_agent_steps_sampled_lifetime": 19608, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 19608, "timers": {"training_iteration_time_ms": 53009.296, "restore_workers_time_ms": 0.021, "training_step_time_ms": 53009.232, "sample_time_ms": 51340.03, "load_time_ms": 0.58, "load_throughput": 889178.662, "learn_time_ms": 1654.981, "learn_throughput": 311.786, "synch_weights_time_ms": 13.28}, "counters": {"num_env_steps_sampled": 19608, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 19608, "num_agent_steps_trained": 19608}, "done": false, "episodes_total": 685, "training_iteration": 38, "trial_id": "fe178_00005", "date": "2024-08-15_17-33-45", "timestamp": 1723764825, "time_this_iter_s": 54.03510928153992, "time_total_s": 2267.670959711075, "pid": 46029, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 106.0249285697937, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.080519480519484, "ram_util_percent": 12.306493506493505}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.978899466991424, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.211523445447286, "policy_loss": -0.020525630897221467, "vf_loss": 9.229273692766826, "vf_explained_var": 0.172775436937809, "kl": 0.011101456852340642, "entropy": -0.3217892073715726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20124, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 20124, "num_agent_steps_trained": 20124}, "sampler_results": {"episode_reward_max": 342.0841014262346, "episode_reward_min": 197.98872977709323, "episode_reward_mean": 301.90265094117825, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.197239561906599, "mean_inference_ms": 1.2576286676390303, "mean_action_processing_ms": 0.20784893671223198, "mean_env_wait_ms": 562.6083177770942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012822945912679037, "StateBufferConnector_ms": 0.006365776062011719, "ViewRequirementAgentConnector_ms": 0.16947666803995767}, "num_episodes": 12, "episode_return_max": 342.0841014262346, "episode_return_min": 197.98872977709323, "episode_return_mean": 301.90265094117825}, "env_runner_results": {"episode_reward_max": 342.0841014262346, "episode_reward_min": 197.98872977709323, "episode_reward_mean": 301.90265094117825, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.197239561906599, "mean_inference_ms": 1.2576286676390303, "mean_action_processing_ms": 0.20784893671223198, "mean_env_wait_ms": 562.6083177770942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012822945912679037, "StateBufferConnector_ms": 0.006365776062011719, "ViewRequirementAgentConnector_ms": 0.16947666803995767}, "num_episodes": 12, "episode_return_max": 342.0841014262346, "episode_return_min": 197.98872977709323, "episode_return_mean": 301.90265094117825}, "episode_reward_max": 342.0841014262346, "episode_reward_min": 197.98872977709323, "episode_reward_mean": 301.90265094117825, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.197239561906599, "mean_inference_ms": 1.2576286676390303, "mean_action_processing_ms": 0.20784893671223198, "mean_env_wait_ms": 562.6083177770942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012822945912679037, "StateBufferConnector_ms": 0.006365776062011719, "ViewRequirementAgentConnector_ms": 0.16947666803995767}, "num_episodes": 12, "episode_return_max": 342.0841014262346, "episode_return_min": 197.98872977709323, "episode_return_mean": 301.90265094117825, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20124, "num_agent_steps_trained": 20124, "num_env_steps_sampled": 20124, "num_env_steps_trained": 20124, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.70996615100988, "num_env_steps_trained_throughput_per_sec": 8.70996615100988, "timesteps_total": 20124, "num_env_steps_sampled_lifetime": 20124, "num_agent_steps_sampled_lifetime": 20124, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 20124, "timers": {"training_iteration_time_ms": 55087.029, "restore_workers_time_ms": 0.02, "training_step_time_ms": 55086.967, "sample_time_ms": 53747.712, "load_time_ms": 0.505, "load_throughput": 1021680.974, "learn_time_ms": 1325.063, "learn_throughput": 389.415, "synch_weights_time_ms": 13.348}, "counters": {"num_env_steps_sampled": 20124, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 20124, "num_agent_steps_trained": 20124}, "done": false, "episodes_total": 697, "training_iteration": 39, "trial_id": "fe178_00005", "date": "2024-08-15_17-34-44", "timestamp": 1723764884, "time_this_iter_s": 59.24567270278931, "time_total_s": 2326.916632413864, "pid": 46029, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 165.270601272583, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.443529411764708, "ram_util_percent": 12.40117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.85028293132782, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 8.66027702887853, "policy_loss": -0.013419147596384089, "vf_loss": 8.670563995838165, "vf_explained_var": 0.1072789008418719, "kl": 0.012528416958231326, "entropy": -0.12239407789893449, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20640, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 20640, "num_agent_steps_trained": 20640}, "sampler_results": {"episode_reward_max": 342.0841014262346, "episode_reward_min": 197.98872977709323, "episode_reward_mean": 303.50194743617993, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2108367048761695, "mean_inference_ms": 1.2571360839324703, "mean_action_processing_ms": 0.20792553075088135, "mean_env_wait_ms": 565.536301973887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013942188686794706, "StateBufferConnector_ms": 0.006459818945990669, "ViewRequirementAgentConnector_ms": 0.17143156793382433}, "num_episodes": 6, "episode_return_max": 342.0841014262346, "episode_return_min": 197.98872977709323, "episode_return_mean": 303.50194743617993}, "env_runner_results": {"episode_reward_max": 342.0841014262346, "episode_reward_min": 197.98872977709323, "episode_reward_mean": 303.50194743617993, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2108367048761695, "mean_inference_ms": 1.2571360839324703, "mean_action_processing_ms": 0.20792553075088135, "mean_env_wait_ms": 565.536301973887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013942188686794706, "StateBufferConnector_ms": 0.006459818945990669, "ViewRequirementAgentConnector_ms": 0.17143156793382433}, "num_episodes": 6, "episode_return_max": 342.0841014262346, "episode_return_min": 197.98872977709323, "episode_return_mean": 303.50194743617993}, "episode_reward_max": 342.0841014262346, "episode_reward_min": 197.98872977709323, "episode_reward_mean": 303.50194743617993, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2108367048761695, "mean_inference_ms": 1.2571360839324703, "mean_action_processing_ms": 0.20792553075088135, "mean_env_wait_ms": 565.536301973887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013942188686794706, "StateBufferConnector_ms": 0.006459818945990669, "ViewRequirementAgentConnector_ms": 0.17143156793382433}, "num_episodes": 6, "episode_return_max": 342.0841014262346, "episode_return_min": 197.98872977709323, "episode_return_mean": 303.50194743617993, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20640, "num_agent_steps_trained": 20640, "num_env_steps_sampled": 20640, "num_env_steps_trained": 20640, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.767876318820853, "num_env_steps_trained_throughput_per_sec": 9.767876318820853, "timesteps_total": 20640, "num_env_steps_sampled_lifetime": 20640, "num_agent_steps_sampled_lifetime": 20640, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 20640, "timers": {"training_iteration_time_ms": 54521.83, "restore_workers_time_ms": 0.02, "training_step_time_ms": 54521.768, "sample_time_ms": 53341.051, "load_time_ms": 0.462, "load_throughput": 1117614.699, "learn_time_ms": 1166.685, "learn_throughput": 442.279, "synch_weights_time_ms": 13.248}, "counters": {"num_env_steps_sampled": 20640, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 20640, "num_agent_steps_trained": 20640}, "done": false, "episodes_total": 703, "training_iteration": 40, "trial_id": "fe178_00005", "date": "2024-08-15_17-35-37", "timestamp": 1723764937, "time_this_iter_s": 52.82909655570984, "time_total_s": 2379.745728969574, "pid": 46029, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 218.09969782829285, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.808, "ram_util_percent": 12.208}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.209338202079136, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.417426379521688, "policy_loss": -0.018701815822472174, "vf_loss": 9.43246885140737, "vf_explained_var": 0.04624579250812531, "kl": 0.01463701534424663, "entropy": -0.39030047846026716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 21156, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 21156, "num_agent_steps_trained": 21156}, "sampler_results": {"episode_reward_max": 342.0841014262346, "episode_reward_min": 197.98872977709323, "episode_reward_mean": 304.04310684852, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.281913544031236, "mean_inference_ms": 1.2574417824340407, "mean_action_processing_ms": 0.20823491570186095, "mean_env_wait_ms": 563.7477669095357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014029443264007568, "StateBufferConnector_ms": 0.006548563639322917, "ViewRequirementAgentConnector_ms": 0.1736124356587728}, "num_episodes": 12, "episode_return_max": 342.0841014262346, "episode_return_min": 197.98872977709323, "episode_return_mean": 304.04310684852}, "env_runner_results": {"episode_reward_max": 342.0841014262346, "episode_reward_min": 197.98872977709323, "episode_reward_mean": 304.04310684852, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.281913544031236, "mean_inference_ms": 1.2574417824340407, "mean_action_processing_ms": 0.20823491570186095, "mean_env_wait_ms": 563.7477669095357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014029443264007568, "StateBufferConnector_ms": 0.006548563639322917, "ViewRequirementAgentConnector_ms": 0.1736124356587728}, "num_episodes": 12, "episode_return_max": 342.0841014262346, "episode_return_min": 197.98872977709323, "episode_return_mean": 304.04310684852}, "episode_reward_max": 342.0841014262346, "episode_reward_min": 197.98872977709323, "episode_reward_mean": 304.04310684852, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.281913544031236, "mean_inference_ms": 1.2574417824340407, "mean_action_processing_ms": 0.20823491570186095, "mean_env_wait_ms": 563.7477669095357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014029443264007568, "StateBufferConnector_ms": 0.006548563639322917, "ViewRequirementAgentConnector_ms": 0.1736124356587728}, "num_episodes": 12, "episode_return_max": 342.0841014262346, "episode_return_min": 197.98872977709323, "episode_return_mean": 304.04310684852, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21156, "num_agent_steps_trained": 21156, "num_env_steps_sampled": 21156, "num_env_steps_trained": 21156, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 11.47597629035166, "num_env_steps_trained_throughput_per_sec": 11.47597629035166, "timesteps_total": 21156, "num_env_steps_sampled_lifetime": 21156, "num_agent_steps_sampled_lifetime": 21156, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 21156, "timers": {"training_iteration_time_ms": 52610.166, "restore_workers_time_ms": 0.021, "training_step_time_ms": 52610.104, "sample_time_ms": 51527.196, "load_time_ms": 0.444, "load_throughput": 1163330.931, "learn_time_ms": 1068.906, "learn_throughput": 482.736, "synch_weights_time_ms": 13.243}, "counters": {"num_env_steps_sampled": 21156, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 21156, "num_agent_steps_trained": 21156}, "done": false, "episodes_total": 715, "training_iteration": 41, "trial_id": "fe178_00005", "date": "2024-08-15_17-36-22", "timestamp": 1723764982, "time_this_iter_s": 44.96650004386902, "time_total_s": 2424.712229013443, "pid": 46029, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 263.06619787216187, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 33.787499999999994, "ram_util_percent": 11.915624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.851415220896403, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.420675094922384, "policy_loss": -0.018852441773439445, "vf_loss": 9.436844611167908, "vf_explained_var": 0.05117825865745544, "kl": 0.010731728163712735, "entropy": -0.49281079346934953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 21672, "num_env_steps_trained": 21672, "num_agent_steps_sampled": 21672, "num_agent_steps_trained": 21672}, "sampler_results": {"episode_reward_max": 342.1186412957634, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 302.01013103078077, "episode_len_mean": 49.40983606557377, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 3014, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.373472482269127, "mean_inference_ms": 1.257488611038445, "mean_action_processing_ms": 0.20841902328575324, "mean_env_wait_ms": 565.0746545130676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01379036512531218, "StateBufferConnector_ms": 0.006484594501432826, "ViewRequirementAgentConnector_ms": 0.1724258798067687}, "num_episodes": 13, "episode_return_max": 342.1186412957634, "episode_return_min": 70.87176447949803, "episode_return_mean": 302.01013103078077}, "env_runner_results": {"episode_reward_max": 342.1186412957634, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 302.01013103078077, "episode_len_mean": 49.40983606557377, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 3014, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.373472482269127, "mean_inference_ms": 1.257488611038445, "mean_action_processing_ms": 0.20841902328575324, "mean_env_wait_ms": 565.0746545130676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01379036512531218, "StateBufferConnector_ms": 0.006484594501432826, "ViewRequirementAgentConnector_ms": 0.1724258798067687}, "num_episodes": 13, "episode_return_max": 342.1186412957634, "episode_return_min": 70.87176447949803, "episode_return_mean": 302.01013103078077}, "episode_reward_max": 342.1186412957634, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 302.01013103078077, "episode_len_mean": 49.40983606557377, "episodes_this_iter": 13, "episodes_timesteps_total": 3014, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.373472482269127, "mean_inference_ms": 1.257488611038445, "mean_action_processing_ms": 0.20841902328575324, "mean_env_wait_ms": 565.0746545130676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01379036512531218, "StateBufferConnector_ms": 0.006484594501432826, "ViewRequirementAgentConnector_ms": 0.1724258798067687}, "num_episodes": 13, "episode_return_max": 342.1186412957634, "episode_return_min": 70.87176447949803, "episode_return_mean": 302.01013103078077, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21672, "num_agent_steps_trained": 21672, "num_env_steps_sampled": 21672, "num_env_steps_trained": 21672, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.745660611275875, "num_env_steps_trained_throughput_per_sec": 8.745660611275875, "timesteps_total": 21672, "num_env_steps_sampled_lifetime": 21672, "num_agent_steps_sampled_lifetime": 21672, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 21672, "timers": {"training_iteration_time_ms": 53675.256, "restore_workers_time_ms": 0.021, "training_step_time_ms": 53675.193, "sample_time_ms": 52658.076, "load_time_ms": 0.426, "load_throughput": 1210549.565, "learn_time_ms": 1003.118, "learn_throughput": 514.396, "synch_weights_time_ms": 13.266}, "counters": {"num_env_steps_sampled": 21672, "num_env_steps_trained": 21672, "num_agent_steps_sampled": 21672, "num_agent_steps_trained": 21672}, "done": false, "episodes_total": 728, "training_iteration": 42, "trial_id": "fe178_00005", "date": "2024-08-15_17-37-21", "timestamp": 1723765041, "time_this_iter_s": 59.00423884391785, "time_total_s": 2483.716467857361, "pid": 46029, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 322.0704367160797, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 27.029411764705884, "ram_util_percent": 12.452941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.839539376894633, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 8.988376633326213, "policy_loss": -0.014288021837516377, "vf_loss": 8.999474573135377, "vf_explained_var": 0.10185966491699219, "kl": 0.01276023950582991, "entropy": -0.361624256738772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22188, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 22188, "num_agent_steps_trained": 22188}, "sampler_results": {"episode_reward_max": 342.1186412957634, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 297.43346495583296, "episode_len_mean": 49.111111111111114, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3536, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.427578462492759, "mean_inference_ms": 1.2571660719968871, "mean_action_processing_ms": 0.2085320776867371, "mean_env_wait_ms": 565.5680042625796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013234880235460069, "StateBufferConnector_ms": 0.00644226868947347, "ViewRequirementAgentConnector_ms": 0.17176601621839735}, "num_episodes": 11, "episode_return_max": 342.1186412957634, "episode_return_min": 70.87176447949803, "episode_return_mean": 297.43346495583296}, "env_runner_results": {"episode_reward_max": 342.1186412957634, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 297.43346495583296, "episode_len_mean": 49.111111111111114, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3536, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.427578462492759, "mean_inference_ms": 1.2571660719968871, "mean_action_processing_ms": 0.2085320776867371, "mean_env_wait_ms": 565.5680042625796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013234880235460069, "StateBufferConnector_ms": 0.00644226868947347, "ViewRequirementAgentConnector_ms": 0.17176601621839735}, "num_episodes": 11, "episode_return_max": 342.1186412957634, "episode_return_min": 70.87176447949803, "episode_return_mean": 297.43346495583296}, "episode_reward_max": 342.1186412957634, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 297.43346495583296, "episode_len_mean": 49.111111111111114, "episodes_this_iter": 11, "episodes_timesteps_total": 3536, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.427578462492759, "mean_inference_ms": 1.2571660719968871, "mean_action_processing_ms": 0.2085320776867371, "mean_env_wait_ms": 565.5680042625796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013234880235460069, "StateBufferConnector_ms": 0.00644226868947347, "ViewRequirementAgentConnector_ms": 0.17176601621839735}, "num_episodes": 11, "episode_return_max": 342.1186412957634, "episode_return_min": 70.87176447949803, "episode_return_mean": 297.43346495583296, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22188, "num_agent_steps_trained": 22188, "num_env_steps_sampled": 22188, "num_env_steps_trained": 22188, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.882869977427854, "num_env_steps_trained_throughput_per_sec": 9.882869977427854, "timesteps_total": 22188, "num_env_steps_sampled_lifetime": 22188, "num_agent_steps_sampled_lifetime": 22188, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 22188, "timers": {"training_iteration_time_ms": 53466.157, "restore_workers_time_ms": 0.021, "training_step_time_ms": 53466.096, "sample_time_ms": 52501.641, "load_time_ms": 0.417, "load_throughput": 1237933.163, "learn_time_ms": 950.528, "learn_throughput": 542.856, "synch_weights_time_ms": 13.216}, "counters": {"num_env_steps_sampled": 22188, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 22188, "num_agent_steps_trained": 22188}, "done": false, "episodes_total": 739, "training_iteration": 43, "trial_id": "fe178_00005", "date": "2024-08-15_17-38-13", "timestamp": 1723765093, "time_this_iter_s": 52.215248823165894, "time_total_s": 2535.9317166805267, "pid": 46029, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 374.2856855392456, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.848648648648645, "ram_util_percent": 12.535135135135134}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.751510912179947, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.290676053365072, "policy_loss": -0.0064993333614741765, "vf_loss": 9.294864861170451, "vf_explained_var": 0.00048365294933319094, "kl": 0.009242166688396477, "entropy": -0.5251152254641056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22704, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 22704, "num_agent_steps_trained": 22704}, "sampler_results": {"episode_reward_max": 347.38329687694716, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 298.89967356898353, "episode_len_mean": 49.2, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 3936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.451568569550437, "mean_inference_ms": 1.2575635242260625, "mean_action_processing_ms": 0.2085967177355162, "mean_env_wait_ms": 565.7922861003735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012906491756439209, "StateBufferConnector_ms": 0.006441473960876465, "ViewRequirementAgentConnector_ms": 0.17237186431884766}, "num_episodes": 8, "episode_return_max": 347.38329687694716, "episode_return_min": 70.87176447949803, "episode_return_mean": 298.89967356898353}, "env_runner_results": {"episode_reward_max": 347.38329687694716, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 298.89967356898353, "episode_len_mean": 49.2, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 3936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.451568569550437, "mean_inference_ms": 1.2575635242260625, "mean_action_processing_ms": 0.2085967177355162, "mean_env_wait_ms": 565.7922861003735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012906491756439209, "StateBufferConnector_ms": 0.006441473960876465, "ViewRequirementAgentConnector_ms": 0.17237186431884766}, "num_episodes": 8, "episode_return_max": 347.38329687694716, "episode_return_min": 70.87176447949803, "episode_return_mean": 298.89967356898353}, "episode_reward_max": 347.38329687694716, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 298.89967356898353, "episode_len_mean": 49.2, "episodes_this_iter": 8, "episodes_timesteps_total": 3936, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.451568569550437, "mean_inference_ms": 1.2575635242260625, "mean_action_processing_ms": 0.2085967177355162, "mean_env_wait_ms": 565.7922861003735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012906491756439209, "StateBufferConnector_ms": 0.006441473960876465, "ViewRequirementAgentConnector_ms": 0.17237186431884766}, "num_episodes": 8, "episode_return_max": 347.38329687694716, "episode_return_min": 70.87176447949803, "episode_return_mean": 298.89967356898353, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22704, "num_agent_steps_trained": 22704, "num_env_steps_sampled": 22704, "num_env_steps_trained": 22704, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.75827431453748, "num_env_steps_trained_throughput_per_sec": 9.75827431453748, "timesteps_total": 22704, "num_env_steps_sampled_lifetime": 22704, "num_agent_steps_sampled_lifetime": 22704, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 22704, "timers": {"training_iteration_time_ms": 53392.665, "restore_workers_time_ms": 0.021, "training_step_time_ms": 53392.604, "sample_time_ms": 52460.092, "load_time_ms": 0.41, "load_throughput": 1258108.335, "learn_time_ms": 918.587, "learn_throughput": 561.732, "synch_weights_time_ms": 13.226}, "counters": {"num_env_steps_sampled": 22704, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 22704, "num_agent_steps_trained": 22704}, "done": false, "episodes_total": 747, "training_iteration": 44, "trial_id": "fe178_00005", "date": "2024-08-15_17-39-06", "timestamp": 1723765146, "time_this_iter_s": 52.88192176818848, "time_total_s": 2588.813638448715, "pid": 46029, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 427.1676073074341, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.496052631578944, "ram_util_percent": 12.381578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.333457845449448, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.13910142580668, "policy_loss": -0.01089326210009555, "vf_loss": 9.147525930404663, "vf_explained_var": 0.20175990710655847, "kl": 0.009874775783436122, "entropy": -0.43904844609399635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220}, "sampler_results": {"episode_reward_max": 347.38329687694716, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 298.1079478175959, "episode_len_mean": 48.96739130434783, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4505, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378, 346.31222806818766, 323.05736719728424, 274.88555047340054, 345.3150790809437, 88.9346342930694, 298.16868833052297, 326.7549160297099, 315.5626886369377, 299.72877798108567, 338.5484607155446, 300.76247856900176, 255.92644432445138], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.484974829603746, "mean_inference_ms": 1.2570786162972925, "mean_action_processing_ms": 0.2087127909930079, "mean_env_wait_ms": 566.1728771609521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012684386709462042, "StateBufferConnector_ms": 0.006504162498142408, "ViewRequirementAgentConnector_ms": 0.17402508984441342}, "num_episodes": 12, "episode_return_max": 347.38329687694716, "episode_return_min": 70.87176447949803, "episode_return_mean": 298.1079478175959}, "env_runner_results": {"episode_reward_max": 347.38329687694716, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 298.1079478175959, "episode_len_mean": 48.96739130434783, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4505, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378, 346.31222806818766, 323.05736719728424, 274.88555047340054, 345.3150790809437, 88.9346342930694, 298.16868833052297, 326.7549160297099, 315.5626886369377, 299.72877798108567, 338.5484607155446, 300.76247856900176, 255.92644432445138], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.484974829603746, "mean_inference_ms": 1.2570786162972925, "mean_action_processing_ms": 0.2087127909930079, "mean_env_wait_ms": 566.1728771609521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012684386709462042, "StateBufferConnector_ms": 0.006504162498142408, "ViewRequirementAgentConnector_ms": 0.17402508984441342}, "num_episodes": 12, "episode_return_max": 347.38329687694716, "episode_return_min": 70.87176447949803, "episode_return_mean": 298.1079478175959}, "episode_reward_max": 347.38329687694716, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 298.1079478175959, "episode_len_mean": 48.96739130434783, "episodes_this_iter": 12, "episodes_timesteps_total": 4505, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [292.07406996094375, 306.0894607713826, 297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378, 346.31222806818766, 323.05736719728424, 274.88555047340054, 345.3150790809437, 88.9346342930694, 298.16868833052297, 326.7549160297099, 315.5626886369377, 299.72877798108567, 338.5484607155446, 300.76247856900176, 255.92644432445138], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.484974829603746, "mean_inference_ms": 1.2570786162972925, "mean_action_processing_ms": 0.2087127909930079, "mean_env_wait_ms": 566.1728771609521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012684386709462042, "StateBufferConnector_ms": 0.006504162498142408, "ViewRequirementAgentConnector_ms": 0.17402508984441342}, "num_episodes": 12, "episode_return_max": 347.38329687694716, "episode_return_min": 70.87176447949803, "episode_return_mean": 298.1079478175959, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220, "num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.428656492833246, "num_env_steps_trained_throughput_per_sec": 9.428656492833246, "timesteps_total": 23220, "num_env_steps_sampled_lifetime": 23220, "num_agent_steps_sampled_lifetime": 23220, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 23220, "timers": {"training_iteration_time_ms": 53540.901, "restore_workers_time_ms": 0.02, "training_step_time_ms": 53540.843, "sample_time_ms": 52635.05, "load_time_ms": 0.402, "load_throughput": 1283835.208, "learn_time_ms": 891.94, "learn_throughput": 578.514, "synch_weights_time_ms": 13.17}, "counters": {"num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220}, "done": false, "episodes_total": 759, "training_iteration": 45, "trial_id": "fe178_00005", "date": "2024-08-15_17-40-01", "timestamp": 1723765201, "time_this_iter_s": 54.73044562339783, "time_total_s": 2643.544084072113, "pid": 46029, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 481.8980529308319, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.42820512820513, "ram_util_percent": 12.042307692307691}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.90715900460879, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.186356449127198, "policy_loss": -0.012792454023535052, "vf_loss": 9.19645725886027, "vf_explained_var": 0.013330698013305664, "kl": 0.010766447937203338, "entropy": -0.6285918657978375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23736, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 23736, "num_agent_steps_trained": 23736}, "sampler_results": {"episode_reward_max": 354.7328350389775, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 297.63818415428256, "episode_len_mean": 48.78, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4878, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378, 346.31222806818766, 323.05736719728424, 274.88555047340054, 345.3150790809437, 88.9346342930694, 298.16868833052297, 326.7549160297099, 315.5626886369377, 299.72877798108567, 338.5484607155446, 300.76247856900176, 255.92644432445138, 295.5177965865976, 299.652578313065, 267.364736339181, 354.7328350389775, 285.8894169307956, 322.3727186224079, 136.31782226562507, 339.6464212446176, 322.1983079524384, 312.3581136480538], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.531979550443886, "mean_inference_ms": 1.256779452838627, "mean_action_processing_ms": 0.20880597806207038, "mean_env_wait_ms": 566.7833215487623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012443780899047852, "StateBufferConnector_ms": 0.0064928531646728516, "ViewRequirementAgentConnector_ms": 0.17419910430908203}, "num_episodes": 10, "episode_return_max": 354.7328350389775, "episode_return_min": 70.87176447949803, "episode_return_mean": 297.63818415428256}, "env_runner_results": {"episode_reward_max": 354.7328350389775, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 297.63818415428256, "episode_len_mean": 48.78, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4878, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378, 346.31222806818766, 323.05736719728424, 274.88555047340054, 345.3150790809437, 88.9346342930694, 298.16868833052297, 326.7549160297099, 315.5626886369377, 299.72877798108567, 338.5484607155446, 300.76247856900176, 255.92644432445138, 295.5177965865976, 299.652578313065, 267.364736339181, 354.7328350389775, 285.8894169307956, 322.3727186224079, 136.31782226562507, 339.6464212446176, 322.1983079524384, 312.3581136480538], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.531979550443886, "mean_inference_ms": 1.256779452838627, "mean_action_processing_ms": 0.20880597806207038, "mean_env_wait_ms": 566.7833215487623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012443780899047852, "StateBufferConnector_ms": 0.0064928531646728516, "ViewRequirementAgentConnector_ms": 0.17419910430908203}, "num_episodes": 10, "episode_return_max": 354.7328350389775, "episode_return_min": 70.87176447949803, "episode_return_mean": 297.63818415428256}, "episode_reward_max": 354.7328350389775, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 297.63818415428256, "episode_len_mean": 48.78, "episodes_this_iter": 10, "episodes_timesteps_total": 4878, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [297.74612752017214, 289.34144154941526, 326.57331603299104, 278.76602545666293, 323.4923244012437, 197.98872977709323, 319.26186822001165, 303.1855355105954, 314.9159979777468, 320.31165506948594, 307.17097733953494, 307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378, 346.31222806818766, 323.05736719728424, 274.88555047340054, 345.3150790809437, 88.9346342930694, 298.16868833052297, 326.7549160297099, 315.5626886369377, 299.72877798108567, 338.5484607155446, 300.76247856900176, 255.92644432445138, 295.5177965865976, 299.652578313065, 267.364736339181, 354.7328350389775, 285.8894169307956, 322.3727186224079, 136.31782226562507, 339.6464212446176, 322.1983079524384, 312.3581136480538], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.531979550443886, "mean_inference_ms": 1.256779452838627, "mean_action_processing_ms": 0.20880597806207038, "mean_env_wait_ms": 566.7833215487623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012443780899047852, "StateBufferConnector_ms": 0.0064928531646728516, "ViewRequirementAgentConnector_ms": 0.17419910430908203}, "num_episodes": 10, "episode_return_max": 354.7328350389775, "episode_return_min": 70.87176447949803, "episode_return_mean": 297.63818415428256, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23736, "num_agent_steps_trained": 23736, "num_env_steps_sampled": 23736, "num_env_steps_trained": 23736, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.031933413197182, "num_env_steps_trained_throughput_per_sec": 10.031933413197182, "timesteps_total": 23736, "num_env_steps_sampled_lifetime": 23736, "num_agent_steps_sampled_lifetime": 23736, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 23736, "timers": {"training_iteration_time_ms": 53330.386, "restore_workers_time_ms": 0.019, "training_step_time_ms": 53330.331, "sample_time_ms": 52450.644, "load_time_ms": 0.394, "load_throughput": 1308184.758, "learn_time_ms": 865.861, "learn_throughput": 595.939, "synch_weights_time_ms": 13.158}, "counters": {"num_env_steps_sampled": 23736, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 23736, "num_agent_steps_trained": 23736}, "done": false, "episodes_total": 769, "training_iteration": 46, "trial_id": "fe178_00005", "date": "2024-08-15_17-40-52", "timestamp": 1723765252, "time_this_iter_s": 51.43992829322815, "time_total_s": 2694.984012365341, "pid": 46029, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 533.3379812240601, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.16986301369863, "ram_util_percent": 12.489041095890412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.86097386876742, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.213855123519897, "policy_loss": -0.014228033181279898, "vf_loss": 9.225289026896158, "vf_explained_var": 0.09591690401236216, "kl": 0.011176240490752175, "entropy": -0.4842236784597238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24252, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 24252, "num_agent_steps_trained": 24252}, "sampler_results": {"episode_reward_max": 354.7328350389775, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 299.50170153002125, "episode_len_mean": 48.78, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4878, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378, 346.31222806818766, 323.05736719728424, 274.88555047340054, 345.3150790809437, 88.9346342930694, 298.16868833052297, 326.7549160297099, 315.5626886369377, 299.72877798108567, 338.5484607155446, 300.76247856900176, 255.92644432445138, 295.5177965865976, 299.652578313065, 267.364736339181, 354.7328350389775, 285.8894169307956, 322.3727186224079, 136.31782226562507, 339.6464212446176, 322.1983079524384, 312.3581136480538, 338.67590584699064, 286.7508537689606, 299.28905899930606, 330.99760004009977, 291.9872300873383, 275.263153882289, 351.3371340512304, 323.0997155477269, 320.93085672786793, 333.6884389435079, 313.08578853350474], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.625134154035753, "mean_inference_ms": 1.2569888554237598, "mean_action_processing_ms": 0.20904352219464414, "mean_env_wait_ms": 568.6632051260898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012185811996459961, "StateBufferConnector_ms": 0.006519794464111328, "ViewRequirementAgentConnector_ms": 0.17540454864501953}, "num_episodes": 11, "episode_return_max": 354.7328350389775, "episode_return_min": 70.87176447949803, "episode_return_mean": 299.50170153002125}, "env_runner_results": {"episode_reward_max": 354.7328350389775, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 299.50170153002125, "episode_len_mean": 48.78, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4878, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378, 346.31222806818766, 323.05736719728424, 274.88555047340054, 345.3150790809437, 88.9346342930694, 298.16868833052297, 326.7549160297099, 315.5626886369377, 299.72877798108567, 338.5484607155446, 300.76247856900176, 255.92644432445138, 295.5177965865976, 299.652578313065, 267.364736339181, 354.7328350389775, 285.8894169307956, 322.3727186224079, 136.31782226562507, 339.6464212446176, 322.1983079524384, 312.3581136480538, 338.67590584699064, 286.7508537689606, 299.28905899930606, 330.99760004009977, 291.9872300873383, 275.263153882289, 351.3371340512304, 323.0997155477269, 320.93085672786793, 333.6884389435079, 313.08578853350474], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.625134154035753, "mean_inference_ms": 1.2569888554237598, "mean_action_processing_ms": 0.20904352219464414, "mean_env_wait_ms": 568.6632051260898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012185811996459961, "StateBufferConnector_ms": 0.006519794464111328, "ViewRequirementAgentConnector_ms": 0.17540454864501953}, "num_episodes": 11, "episode_return_max": 354.7328350389775, "episode_return_min": 70.87176447949803, "episode_return_mean": 299.50170153002125}, "episode_reward_max": 354.7328350389775, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 299.50170153002125, "episode_len_mean": 48.78, "episodes_this_iter": 11, "episodes_timesteps_total": 4878, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [307.63648463320646, 289.522060005031, 299.50977792225586, 312.00641655995787, 301.19629782190094, 302.5178933479184, 249.08629862086474, 294.60905509562207, 306.25218707097525, 292.6719678694527, 321.0094540427204, 312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378, 346.31222806818766, 323.05736719728424, 274.88555047340054, 345.3150790809437, 88.9346342930694, 298.16868833052297, 326.7549160297099, 315.5626886369377, 299.72877798108567, 338.5484607155446, 300.76247856900176, 255.92644432445138, 295.5177965865976, 299.652578313065, 267.364736339181, 354.7328350389775, 285.8894169307956, 322.3727186224079, 136.31782226562507, 339.6464212446176, 322.1983079524384, 312.3581136480538, 338.67590584699064, 286.7508537689606, 299.28905899930606, 330.99760004009977, 291.9872300873383, 275.263153882289, 351.3371340512304, 323.0997155477269, 320.93085672786793, 333.6884389435079, 313.08578853350474], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.625134154035753, "mean_inference_ms": 1.2569888554237598, "mean_action_processing_ms": 0.20904352219464414, "mean_env_wait_ms": 568.6632051260898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012185811996459961, "StateBufferConnector_ms": 0.006519794464111328, "ViewRequirementAgentConnector_ms": 0.17540454864501953}, "num_episodes": 11, "episode_return_max": 354.7328350389775, "episode_return_min": 70.87176447949803, "episode_return_mean": 299.50170153002125, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24252, "num_agent_steps_trained": 24252, "num_env_steps_sampled": 24252, "num_env_steps_trained": 24252, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.80311975580455, "num_env_steps_trained_throughput_per_sec": 9.80311975580455, "timesteps_total": 24252, "num_env_steps_sampled_lifetime": 24252, "num_agent_steps_sampled_lifetime": 24252, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 24252, "timers": {"training_iteration_time_ms": 53395.357, "restore_workers_time_ms": 0.019, "training_step_time_ms": 53395.303, "sample_time_ms": 52711.417, "load_time_ms": 0.346, "load_throughput": 1492799.603, "learn_time_ms": 670.141, "learn_throughput": 769.987, "synch_weights_time_ms": 13.146}, "counters": {"num_env_steps_sampled": 24252, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 24252, "num_agent_steps_trained": 24252}, "done": false, "episodes_total": 780, "training_iteration": 47, "trial_id": "fe178_00005", "date": "2024-08-15_17-41-45", "timestamp": 1723765305, "time_this_iter_s": 52.63978576660156, "time_total_s": 2747.6237981319427, "pid": 46029, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 585.9777669906616, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.938666666666663, "ram_util_percent": 12.575999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.936517884333929, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.122915716965993, "policy_loss": -0.01380698885768652, "vf_loss": 9.134369786580404, "vf_explained_var": -0.06529223720232645, "kl": 0.00941181963141086, "entropy": -0.5030875008553266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24768, "num_env_steps_trained": 24768, "num_agent_steps_sampled": 24768, "num_agent_steps_trained": 24768}, "sampler_results": {"episode_reward_max": 354.7328350389775, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 300.83322981586986, "episode_len_mean": 48.78, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4878, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378, 346.31222806818766, 323.05736719728424, 274.88555047340054, 345.3150790809437, 88.9346342930694, 298.16868833052297, 326.7549160297099, 315.5626886369377, 299.72877798108567, 338.5484607155446, 300.76247856900176, 255.92644432445138, 295.5177965865976, 299.652578313065, 267.364736339181, 354.7328350389775, 285.8894169307956, 322.3727186224079, 136.31782226562507, 339.6464212446176, 322.1983079524384, 312.3581136480538, 338.67590584699064, 286.7508537689606, 299.28905899930606, 330.99760004009977, 291.9872300873383, 275.263153882289, 351.3371340512304, 323.0997155477269, 320.93085672786793, 333.6884389435079, 313.08578853350474, 275.5935889269106, 288.8026394881838, 306.1211458953949, 312.5819206759393, 312.5584368535715, 341.38748903251803, 314.112399376101, 312.3615806936338, 339.695208327874, 283.6002889844439, 322.3560233201983], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.654094188310183, "mean_inference_ms": 1.2569234251421744, "mean_action_processing_ms": 0.20917275963099585, "mean_env_wait_ms": 567.9307905772404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011847972869873047, "StateBufferConnector_ms": 0.006519317626953125, "ViewRequirementAgentConnector_ms": 0.1757669448852539}, "num_episodes": 11, "episode_return_max": 354.7328350389775, "episode_return_min": 70.87176447949803, "episode_return_mean": 300.83322981586986}, "env_runner_results": {"episode_reward_max": 354.7328350389775, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 300.83322981586986, "episode_len_mean": 48.78, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4878, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378, 346.31222806818766, 323.05736719728424, 274.88555047340054, 345.3150790809437, 88.9346342930694, 298.16868833052297, 326.7549160297099, 315.5626886369377, 299.72877798108567, 338.5484607155446, 300.76247856900176, 255.92644432445138, 295.5177965865976, 299.652578313065, 267.364736339181, 354.7328350389775, 285.8894169307956, 322.3727186224079, 136.31782226562507, 339.6464212446176, 322.1983079524384, 312.3581136480538, 338.67590584699064, 286.7508537689606, 299.28905899930606, 330.99760004009977, 291.9872300873383, 275.263153882289, 351.3371340512304, 323.0997155477269, 320.93085672786793, 333.6884389435079, 313.08578853350474, 275.5935889269106, 288.8026394881838, 306.1211458953949, 312.5819206759393, 312.5584368535715, 341.38748903251803, 314.112399376101, 312.3615806936338, 339.695208327874, 283.6002889844439, 322.3560233201983], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.654094188310183, "mean_inference_ms": 1.2569234251421744, "mean_action_processing_ms": 0.20917275963099585, "mean_env_wait_ms": 567.9307905772404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011847972869873047, "StateBufferConnector_ms": 0.006519317626953125, "ViewRequirementAgentConnector_ms": 0.1757669448852539}, "num_episodes": 11, "episode_return_max": 354.7328350389775, "episode_return_min": 70.87176447949803, "episode_return_mean": 300.83322981586986}, "episode_reward_max": 354.7328350389775, "episode_reward_min": 70.87176447949803, "episode_reward_mean": 300.83322981586986, "episode_len_mean": 48.78, "episodes_this_iter": 11, "episodes_timesteps_total": 4878, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [312.9670928327652, 342.0841014262346, 324.1818933942476, 295.9295080613758, 310.00784191656703, 318.973668026972, 327.2445625105035, 276.0187134172595, 327.0390207512796, 320.4578222046727, 293.9321794073916, 324.298281176023, 273.57729034993724, 304.216903357652, 303.7858227079221, 325.20665829738715, 301.21297555346587, 298.4050721504413, 253.7647685760415, 336.922352358145, 308.57902648727674, 330.08750423373436, 312.8312318795368, 319.40941507494256, 342.1186412957634, 337.9817326561832, 259.86121952470734, 305.37822503614416, 264.86030430690073, 323.2059708711847, 334.474886148494, 328.25547925709674, 312.25573747992877, 316.4243168161962, 70.87176447949803, 309.1769646833354, 323.68362159323436, 299.51994022267695, 140.15313780037843, 275.02452517283416, 194.6901352812497, 316.68751555082326, 299.93112177039353, 272.02580989766096, 290.4161823077747, 320.49466412583405, 264.9209825502225, 318.72746926249863, 317.3204774972857, 298.56401033887664, 347.38329687694716, 260.1765058435134, 331.0105639689795, 333.36634764018754, 340.76752558048173, 268.1756809524378, 346.31222806818766, 323.05736719728424, 274.88555047340054, 345.3150790809437, 88.9346342930694, 298.16868833052297, 326.7549160297099, 315.5626886369377, 299.72877798108567, 338.5484607155446, 300.76247856900176, 255.92644432445138, 295.5177965865976, 299.652578313065, 267.364736339181, 354.7328350389775, 285.8894169307956, 322.3727186224079, 136.31782226562507, 339.6464212446176, 322.1983079524384, 312.3581136480538, 338.67590584699064, 286.7508537689606, 299.28905899930606, 330.99760004009977, 291.9872300873383, 275.263153882289, 351.3371340512304, 323.0997155477269, 320.93085672786793, 333.6884389435079, 313.08578853350474, 275.5935889269106, 288.8026394881838, 306.1211458953949, 312.5819206759393, 312.5584368535715, 341.38748903251803, 314.112399376101, 312.3615806936338, 339.695208327874, 283.6002889844439, 322.3560233201983], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 26, 50, 46, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.654094188310183, "mean_inference_ms": 1.2569234251421744, "mean_action_processing_ms": 0.20917275963099585, "mean_env_wait_ms": 567.9307905772404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011847972869873047, "StateBufferConnector_ms": 0.006519317626953125, "ViewRequirementAgentConnector_ms": 0.1757669448852539}, "num_episodes": 11, "episode_return_max": 354.7328350389775, "episode_return_min": 70.87176447949803, "episode_return_mean": 300.83322981586986, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24768, "num_agent_steps_trained": 24768, "num_env_steps_sampled": 24768, "num_env_steps_trained": 24768, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.72607481530179, "num_env_steps_trained_throughput_per_sec": 9.72607481530179, "timesteps_total": 24768, "num_env_steps_sampled_lifetime": 24768, "num_agent_steps_sampled_lifetime": 24768, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 24768, "timers": {"training_iteration_time_ms": 53297.486, "restore_workers_time_ms": 0.017, "training_step_time_ms": 53297.436, "sample_time_ms": 52617.609, "load_time_ms": 0.341, "load_throughput": 1512411.505, "learn_time_ms": 666.157, "learn_throughput": 774.592, "synch_weights_time_ms": 13.082}, "counters": {"num_env_steps_sampled": 24768, "num_env_steps_trained": 24768, "num_agent_steps_sampled": 24768, "num_agent_steps_trained": 24768}, "done": false, "episodes_total": 791, "training_iteration": 48, "trial_id": "fe178_00005", "date": "2024-08-15_17-42-38", "timestamp": 1723765358, "time_this_iter_s": 53.05652689933777, "time_total_s": 2800.6803250312805, "pid": 46029, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 639.0342938899994, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 29.119736842105254, "ram_util_percent": 12.386842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.838663349548975, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.116314888000488, "policy_loss": -0.011508470796979964, "vf_loss": 9.124678643544515, "vf_explained_var": -0.0052868187427520755, "kl": 0.012578803488580297, "entropy": -0.526985896533976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25284, "num_env_steps_trained": 25284, "num_agent_steps_sampled": 25284, "num_agent_steps_trained": 25284}, "sampler_results": {"episode_reward_max": 320.1808680890345, "episode_reward_min": 287.7417362474034, "episode_reward_mean": 306.2105405435571, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.4437789405431, 302.29105730769186, 287.7417362474034, 320.1808680890345, 308.32153928141105, 317.2842633952587], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2063322103799985, "mean_inference_ms": 1.2801424296879675, "mean_action_processing_ms": 0.21246520952246653, "mean_env_wait_ms": 527.561669605445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009512901306152344, "StateBufferConnector_ms": 0.006071726481119792, "ViewRequirementAgentConnector_ms": 0.16861359278361002}, "num_episodes": 6, "episode_return_max": 320.1808680890345, "episode_return_min": 287.7417362474034, "episode_return_mean": 306.2105405435571}, "env_runner_results": {"episode_reward_max": 320.1808680890345, "episode_reward_min": 287.7417362474034, "episode_reward_mean": 306.2105405435571, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.4437789405431, 302.29105730769186, 287.7417362474034, 320.1808680890345, 308.32153928141105, 317.2842633952587], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2063322103799985, "mean_inference_ms": 1.2801424296879675, "mean_action_processing_ms": 0.21246520952246653, "mean_env_wait_ms": 527.561669605445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009512901306152344, "StateBufferConnector_ms": 0.006071726481119792, "ViewRequirementAgentConnector_ms": 0.16861359278361002}, "num_episodes": 6, "episode_return_max": 320.1808680890345, "episode_return_min": 287.7417362474034, "episode_return_mean": 306.2105405435571}, "episode_reward_max": 320.1808680890345, "episode_reward_min": 287.7417362474034, "episode_reward_mean": 306.2105405435571, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [301.4437789405431, 302.29105730769186, 287.7417362474034, 320.1808680890345, 308.32153928141105, 317.2842633952587], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2063322103799985, "mean_inference_ms": 1.2801424296879675, "mean_action_processing_ms": 0.21246520952246653, "mean_env_wait_ms": 527.561669605445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009512901306152344, "StateBufferConnector_ms": 0.006071726481119792, "ViewRequirementAgentConnector_ms": 0.16861359278361002}, "num_episodes": 6, "episode_return_max": 320.1808680890345, "episode_return_min": 287.7417362474034, "episode_return_mean": 306.2105405435571, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25284, "num_agent_steps_trained": 25284, "num_env_steps_sampled": 25284, "num_env_steps_trained": 25284, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.215292607794007, "num_env_steps_trained_throughput_per_sec": 10.215292607794007, "timesteps_total": 25284, "num_env_steps_sampled_lifetime": 25284, "num_agent_steps_sampled_lifetime": 25284, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 25284, "timers": {"training_iteration_time_ms": 50512.514, "restore_workers_time_ms": 0.017, "training_step_time_ms": 50512.457, "sample_time_ms": 48784.171, "load_time_ms": 0.846, "load_throughput": 609822.729, "learn_time_ms": 1713.735, "learn_throughput": 301.097, "synch_weights_time_ms": 13.206}, "counters": {"num_env_steps_sampled": 25284, "num_env_steps_trained": 25284, "num_agent_steps_sampled": 25284, "num_agent_steps_trained": 25284}, "done": false, "episodes_total": 797, "training_iteration": 49, "trial_id": "fe178_00005", "date": "2024-08-15_17-44-05", "timestamp": 1723765445, "time_this_iter_s": 50.51562237739563, "time_total_s": 2851.195947408676, "pid": 36106, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 50.51562237739563, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 31.042465753424658, "ram_util_percent": 12.250684931506852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.902655106782912, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.228705088297525, "policy_loss": -0.019068368438941736, "vf_loss": 9.244155740737915, "vf_explained_var": 0.09332167108853658, "kl": 0.014471156087774117, "entropy": -0.5894777183420956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25800, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 25800, "num_agent_steps_trained": 25800}, "sampler_results": {"episode_reward_max": 344.4578631274357, "episode_reward_min": 83.54435831927464, "episode_reward_mean": 292.74324480233315, "episode_len_mean": 48.26315789473684, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 917, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.4437789405431, 302.29105730769186, 287.7417362474034, 320.1808680890345, 308.32153928141105, 317.2842633952587, 269.90725371395934, 265.2584916269489, 281.7143787923007, 308.72039554816223, 83.54435831927464, 344.4578631274357, 284.632532547126, 329.58972767633185, 309.34093056197696, 312.2647208290059, 306.3539075127115, 340.93451007805515, 288.13933764969767], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0984995818412315, "mean_inference_ms": 1.2762555360082903, "mean_action_processing_ms": 0.21189675259532373, "mean_env_wait_ms": 558.303267089985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012454233671489515, "StateBufferConnector_ms": 0.006226489418431332, "ViewRequirementAgentConnector_ms": 0.1691328851800216}, "num_episodes": 13, "episode_return_max": 344.4578631274357, "episode_return_min": 83.54435831927464, "episode_return_mean": 292.74324480233315}, "env_runner_results": {"episode_reward_max": 344.4578631274357, "episode_reward_min": 83.54435831927464, "episode_reward_mean": 292.74324480233315, "episode_len_mean": 48.26315789473684, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 917, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.4437789405431, 302.29105730769186, 287.7417362474034, 320.1808680890345, 308.32153928141105, 317.2842633952587, 269.90725371395934, 265.2584916269489, 281.7143787923007, 308.72039554816223, 83.54435831927464, 344.4578631274357, 284.632532547126, 329.58972767633185, 309.34093056197696, 312.2647208290059, 306.3539075127115, 340.93451007805515, 288.13933764969767], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0984995818412315, "mean_inference_ms": 1.2762555360082903, "mean_action_processing_ms": 0.21189675259532373, "mean_env_wait_ms": 558.303267089985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012454233671489515, "StateBufferConnector_ms": 0.006226489418431332, "ViewRequirementAgentConnector_ms": 0.1691328851800216}, "num_episodes": 13, "episode_return_max": 344.4578631274357, "episode_return_min": 83.54435831927464, "episode_return_mean": 292.74324480233315}, "episode_reward_max": 344.4578631274357, "episode_reward_min": 83.54435831927464, "episode_reward_mean": 292.74324480233315, "episode_len_mean": 48.26315789473684, "episodes_this_iter": 13, "episodes_timesteps_total": 917, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [301.4437789405431, 302.29105730769186, 287.7417362474034, 320.1808680890345, 308.32153928141105, 317.2842633952587, 269.90725371395934, 265.2584916269489, 281.7143787923007, 308.72039554816223, 83.54435831927464, 344.4578631274357, 284.632532547126, 329.58972767633185, 309.34093056197696, 312.2647208290059, 306.3539075127115, 340.93451007805515, 288.13933764969767], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0984995818412315, "mean_inference_ms": 1.2762555360082903, "mean_action_processing_ms": 0.21189675259532373, "mean_env_wait_ms": 558.303267089985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012454233671489515, "StateBufferConnector_ms": 0.006226489418431332, "ViewRequirementAgentConnector_ms": 0.1691328851800216}, "num_episodes": 13, "episode_return_max": 344.4578631274357, "episode_return_min": 83.54435831927464, "episode_return_mean": 292.74324480233315, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25800, "num_agent_steps_trained": 25800, "num_env_steps_sampled": 25800, "num_env_steps_trained": 25800, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.031640311456384, "num_env_steps_trained_throughput_per_sec": 9.031640311456384, "timesteps_total": 25800, "num_env_steps_sampled_lifetime": 25800, "num_agent_steps_sampled_lifetime": 25800, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 25800, "timers": {"training_iteration_time_ms": 53822.504, "restore_workers_time_ms": 0.023, "training_step_time_ms": 53822.436, "sample_time_ms": 52607.325, "load_time_ms": 0.614, "load_throughput": 840326.486, "learn_time_ms": 1200.748, "learn_throughput": 429.732, "synch_weights_time_ms": 13.347}, "counters": {"num_env_steps_sampled": 25800, "num_env_steps_trained": 25800, "num_agent_steps_sampled": 25800, "num_agent_steps_trained": 25800}, "done": false, "episodes_total": 810, "training_iteration": 50, "trial_id": "fe178_00005", "date": "2024-08-15_17-45-02", "timestamp": 1723765502, "time_this_iter_s": 57.135565519332886, "time_total_s": 2908.331512928009, "pid": 36106, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 107.65118789672852, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.214814814814815, "ram_util_percent": 12.507407407407406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.022129960854848, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.315306075414021, "policy_loss": -0.011743677034974098, "vf_loss": 9.322732528050741, "vf_explained_var": -0.1467364564538002, "kl": 0.017268984877352615, "entropy": -0.6815939889599879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26316, "num_env_steps_trained": 26316, "num_agent_steps_sampled": 26316, "num_agent_steps_trained": 26316}, "sampler_results": {"episode_reward_max": 356.5125469288426, "episode_reward_min": 83.54435831927464, "episode_reward_mean": 301.9526295961521, "episode_len_mean": 48.9, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1467, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.4437789405431, 302.29105730769186, 287.7417362474034, 320.1808680890345, 308.32153928141105, 317.2842633952587, 269.90725371395934, 265.2584916269489, 281.7143787923007, 308.72039554816223, 83.54435831927464, 344.4578631274357, 284.632532547126, 329.58972767633185, 309.34093056197696, 312.2647208290059, 306.3539075127115, 340.93451007805515, 288.13933764969767, 322.28118033566807, 298.231649558568, 313.08874119116365, 299.9435789980748, 297.67218928461995, 342.9998661899273, 331.8370794794814, 313.9185758909879, 325.159720504274, 294.81210827862526, 356.5125469288426], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.293007155721436, "mean_inference_ms": 1.2733871628796931, "mean_action_processing_ms": 0.21168838880927635, "mean_env_wait_ms": 562.7606914267375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012900829315185547, "StateBufferConnector_ms": 0.006241003672281901, "ViewRequirementAgentConnector_ms": 0.17058928807576498}, "num_episodes": 11, "episode_return_max": 356.5125469288426, "episode_return_min": 83.54435831927464, "episode_return_mean": 301.9526295961521}, "env_runner_results": {"episode_reward_max": 356.5125469288426, "episode_reward_min": 83.54435831927464, "episode_reward_mean": 301.9526295961521, "episode_len_mean": 48.9, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1467, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.4437789405431, 302.29105730769186, 287.7417362474034, 320.1808680890345, 308.32153928141105, 317.2842633952587, 269.90725371395934, 265.2584916269489, 281.7143787923007, 308.72039554816223, 83.54435831927464, 344.4578631274357, 284.632532547126, 329.58972767633185, 309.34093056197696, 312.2647208290059, 306.3539075127115, 340.93451007805515, 288.13933764969767, 322.28118033566807, 298.231649558568, 313.08874119116365, 299.9435789980748, 297.67218928461995, 342.9998661899273, 331.8370794794814, 313.9185758909879, 325.159720504274, 294.81210827862526, 356.5125469288426], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.293007155721436, "mean_inference_ms": 1.2733871628796931, "mean_action_processing_ms": 0.21168838880927635, "mean_env_wait_ms": 562.7606914267375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012900829315185547, "StateBufferConnector_ms": 0.006241003672281901, "ViewRequirementAgentConnector_ms": 0.17058928807576498}, "num_episodes": 11, "episode_return_max": 356.5125469288426, "episode_return_min": 83.54435831927464, "episode_return_mean": 301.9526295961521}, "episode_reward_max": 356.5125469288426, "episode_reward_min": 83.54435831927464, "episode_reward_mean": 301.9526295961521, "episode_len_mean": 48.9, "episodes_this_iter": 11, "episodes_timesteps_total": 1467, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [301.4437789405431, 302.29105730769186, 287.7417362474034, 320.1808680890345, 308.32153928141105, 317.2842633952587, 269.90725371395934, 265.2584916269489, 281.7143787923007, 308.72039554816223, 83.54435831927464, 344.4578631274357, 284.632532547126, 329.58972767633185, 309.34093056197696, 312.2647208290059, 306.3539075127115, 340.93451007805515, 288.13933764969767, 322.28118033566807, 298.231649558568, 313.08874119116365, 299.9435789980748, 297.67218928461995, 342.9998661899273, 331.8370794794814, 313.9185758909879, 325.159720504274, 294.81210827862526, 356.5125469288426], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.293007155721436, "mean_inference_ms": 1.2733871628796931, "mean_action_processing_ms": 0.21168838880927635, "mean_env_wait_ms": 562.7606914267375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012900829315185547, "StateBufferConnector_ms": 0.006241003672281901, "ViewRequirementAgentConnector_ms": 0.17058928807576498}, "num_episodes": 11, "episode_return_max": 356.5125469288426, "episode_return_min": 83.54435831927464, "episode_return_mean": 301.9526295961521, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26316, "num_agent_steps_trained": 26316, "num_env_steps_sampled": 26316, "num_env_steps_trained": 26316, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.789221995168896, "num_env_steps_trained_throughput_per_sec": 9.789221995168896, "timesteps_total": 26316, "num_env_steps_sampled_lifetime": 26316, "num_agent_steps_sampled_lifetime": 26316, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 26316, "timers": {"training_iteration_time_ms": 53452.017, "restore_workers_time_ms": 0.022, "training_step_time_ms": 53451.953, "sample_time_ms": 52419.833, "load_time_ms": 0.544, "load_throughput": 947989.866, "learn_time_ms": 1017.775, "learn_throughput": 506.988, "synch_weights_time_ms": 13.447}, "counters": {"num_env_steps_sampled": 26316, "num_env_steps_trained": 26316, "num_agent_steps_sampled": 26316, "num_agent_steps_trained": 26316}, "done": false, "episodes_total": 821, "training_iteration": 51, "trial_id": "fe178_00005", "date": "2024-08-15_17-45-55", "timestamp": 1723765555, "time_this_iter_s": 52.71433973312378, "time_total_s": 2961.045852661133, "pid": 36106, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 160.3655276298523, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.439473684210526, "ram_util_percent": 11.70921052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.701253453890484, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 9.504438479741415, "policy_loss": 0.0017024347946668664, "vf_loss": 9.496049364407858, "vf_explained_var": 0.11729582647482555, "kl": 0.02674652200488481, "entropy": -0.6768261512120565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26832, "num_env_steps_trained": 26832, "num_agent_steps_sampled": 26832, "num_agent_steps_trained": 26832}, "sampler_results": {"episode_reward_max": 343.78152689438434, "episode_reward_min": 125.55145699091241, "episode_reward_mean": 290.3006655447894, "episode_len_mean": 46.142857142857146, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 323, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245], "episode_lengths": [23, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.746632818713759, "mean_inference_ms": 1.2736805945585903, "mean_action_processing_ms": 0.21060151223870133, "mean_env_wait_ms": 503.69773788013674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009822845458984375, "StateBufferConnector_ms": 0.0058923448835100445, "ViewRequirementAgentConnector_ms": 0.1686845506940569}, "num_episodes": 7, "episode_return_max": 343.78152689438434, "episode_return_min": 125.55145699091241, "episode_return_mean": 290.3006655447894}, "env_runner_results": {"episode_reward_max": 343.78152689438434, "episode_reward_min": 125.55145699091241, "episode_reward_mean": 290.3006655447894, "episode_len_mean": 46.142857142857146, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 323, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245], "episode_lengths": [23, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.746632818713759, "mean_inference_ms": 1.2736805945585903, "mean_action_processing_ms": 0.21060151223870133, "mean_env_wait_ms": 503.69773788013674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009822845458984375, "StateBufferConnector_ms": 0.0058923448835100445, "ViewRequirementAgentConnector_ms": 0.1686845506940569}, "num_episodes": 7, "episode_return_max": 343.78152689438434, "episode_return_min": 125.55145699091241, "episode_return_mean": 290.3006655447894}, "episode_reward_max": 343.78152689438434, "episode_reward_min": 125.55145699091241, "episode_reward_mean": 290.3006655447894, "episode_len_mean": 46.142857142857146, "episodes_this_iter": 7, "episodes_timesteps_total": 323, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245], "episode_lengths": [23, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.746632818713759, "mean_inference_ms": 1.2736805945585903, "mean_action_processing_ms": 0.21060151223870133, "mean_env_wait_ms": 503.69773788013674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009822845458984375, "StateBufferConnector_ms": 0.0058923448835100445, "ViewRequirementAgentConnector_ms": 0.1686845506940569}, "num_episodes": 7, "episode_return_max": 343.78152689438434, "episode_return_min": 125.55145699091241, "episode_return_mean": 290.3006655447894, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26832, "num_agent_steps_trained": 26832, "num_env_steps_sampled": 26832, "num_env_steps_trained": 26832, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.707407379152405, "num_env_steps_trained_throughput_per_sec": 10.707407379152405, "timesteps_total": 26832, "num_env_steps_sampled_lifetime": 26832, "num_agent_steps_sampled_lifetime": 26832, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 26832, "timers": {"training_iteration_time_ms": 48190.95, "restore_workers_time_ms": 0.017, "training_step_time_ms": 48190.893, "sample_time_ms": 46886.14, "load_time_ms": 0.763, "load_throughput": 676120.232, "learn_time_ms": 1290.114, "learn_throughput": 399.965, "synch_weights_time_ms": 13.389}, "counters": {"num_env_steps_sampled": 26832, "num_env_steps_trained": 26832, "num_agent_steps_sampled": 26832, "num_agent_steps_trained": 26832}, "done": false, "episodes_total": 828, "training_iteration": 52, "trial_id": "fe178_00005", "date": "2024-08-15_17-47-05", "timestamp": 1723765625, "time_this_iter_s": 48.19396758079529, "time_total_s": 3009.239820241928, "pid": 59435, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 48.19396758079529, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 26.553623188405794, "ram_util_percent": 11.094202898550726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.625769199927648, "cur_kl_coeff": 0.375, "cur_lr": 1e-05, "total_loss": 9.084248383839926, "policy_loss": -0.018424451708172758, "vf_loss": 9.100160547097524, "vf_explained_var": -0.055539071559906006, "kl": 0.006699204368245167, "entropy": -0.6102384482122337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27348, "num_env_steps_trained": 27348, "num_agent_steps_sampled": 27348, "num_agent_steps_trained": 27348}, "sampler_results": {"episode_reward_max": 343.78152689438434, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 283.69742256468305, "episode_len_mean": 45.45, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 909, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.305119143254052, "mean_inference_ms": 1.270150075393787, "mean_action_processing_ms": 0.20980653822378464, "mean_env_wait_ms": 529.4619904737617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011415481567382812, "StateBufferConnector_ms": 0.006136894226074219, "ViewRequirementAgentConnector_ms": 0.17181754112243652}, "num_episodes": 13, "episode_return_max": 343.78152689438434, "episode_return_min": 118.55092419552915, "episode_return_mean": 283.69742256468305}, "env_runner_results": {"episode_reward_max": 343.78152689438434, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 283.69742256468305, "episode_len_mean": 45.45, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 909, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.305119143254052, "mean_inference_ms": 1.270150075393787, "mean_action_processing_ms": 0.20980653822378464, "mean_env_wait_ms": 529.4619904737617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011415481567382812, "StateBufferConnector_ms": 0.006136894226074219, "ViewRequirementAgentConnector_ms": 0.17181754112243652}, "num_episodes": 13, "episode_return_max": 343.78152689438434, "episode_return_min": 118.55092419552915, "episode_return_mean": 283.69742256468305}, "episode_reward_max": 343.78152689438434, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 283.69742256468305, "episode_len_mean": 45.45, "episodes_this_iter": 13, "episodes_timesteps_total": 909, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.305119143254052, "mean_inference_ms": 1.270150075393787, "mean_action_processing_ms": 0.20980653822378464, "mean_env_wait_ms": 529.4619904737617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011415481567382812, "StateBufferConnector_ms": 0.006136894226074219, "ViewRequirementAgentConnector_ms": 0.17181754112243652}, "num_episodes": 13, "episode_return_max": 343.78152689438434, "episode_return_min": 118.55092419552915, "episode_return_mean": 283.69742256468305, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27348, "num_agent_steps_trained": 27348, "num_env_steps_sampled": 27348, "num_env_steps_trained": 27348, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.327228918009599, "num_env_steps_trained_throughput_per_sec": 9.327228918009599, "timesteps_total": 27348, "num_env_steps_sampled_lifetime": 27348, "num_agent_steps_sampled_lifetime": 27348, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 27348, "timers": {"training_iteration_time_ms": 51756.43, "restore_workers_time_ms": 0.022, "training_step_time_ms": 51756.366, "sample_time_ms": 50769.346, "load_time_ms": 0.559, "load_throughput": 922925.742, "learn_time_ms": 972.68, "learn_throughput": 530.493, "synch_weights_time_ms": 13.393}, "counters": {"num_env_steps_sampled": 27348, "num_env_steps_trained": 27348, "num_agent_steps_sampled": 27348, "num_agent_steps_trained": 27348}, "done": false, "episodes_total": 841, "training_iteration": 53, "trial_id": "fe178_00005", "date": "2024-08-15_17-48-01", "timestamp": 1723765681, "time_this_iter_s": 55.32523846626282, "time_total_s": 3064.565058708191, "pid": 59435, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 103.5192060470581, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.29620253164557, "ram_util_percent": 11.379746835443038}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.978022515773773, "cur_kl_coeff": 0.375, "cur_lr": 1e-05, "total_loss": 9.415517028172811, "policy_loss": -0.011170451979463298, "vf_loss": 9.42361524105072, "vf_explained_var": 0.04121583700180054, "kl": 0.008192790976806013, "entropy": -0.8413988843560218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27864, "num_env_steps_trained": 27864, "num_agent_steps_sampled": 27864, "num_agent_steps_trained": 27864}, "sampler_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 290.6406053374489, "episode_len_mean": 46.41935483870968, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1439, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.435256054543638, "mean_inference_ms": 1.2703218621221402, "mean_action_processing_ms": 0.20964685940064076, "mean_env_wait_ms": 537.9889066160496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011494851881457914, "StateBufferConnector_ms": 0.006117359284431704, "ViewRequirementAgentConnector_ms": 0.17063233160203503}, "num_episodes": 11, "episode_return_max": 351.23922642405375, "episode_return_min": 118.55092419552915, "episode_return_mean": 290.6406053374489}, "env_runner_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 290.6406053374489, "episode_len_mean": 46.41935483870968, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1439, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.435256054543638, "mean_inference_ms": 1.2703218621221402, "mean_action_processing_ms": 0.20964685940064076, "mean_env_wait_ms": 537.9889066160496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011494851881457914, "StateBufferConnector_ms": 0.006117359284431704, "ViewRequirementAgentConnector_ms": 0.17063233160203503}, "num_episodes": 11, "episode_return_max": 351.23922642405375, "episode_return_min": 118.55092419552915, "episode_return_mean": 290.6406053374489}, "episode_reward_max": 351.23922642405375, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 290.6406053374489, "episode_len_mean": 46.41935483870968, "episodes_this_iter": 11, "episodes_timesteps_total": 1439, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.435256054543638, "mean_inference_ms": 1.2703218621221402, "mean_action_processing_ms": 0.20964685940064076, "mean_env_wait_ms": 537.9889066160496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011494851881457914, "StateBufferConnector_ms": 0.006117359284431704, "ViewRequirementAgentConnector_ms": 0.17063233160203503}, "num_episodes": 11, "episode_return_max": 351.23922642405375, "episode_return_min": 118.55092419552915, "episode_return_mean": 290.6406053374489, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27864, "num_agent_steps_trained": 27864, "num_env_steps_sampled": 27864, "num_env_steps_trained": 27864, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.551297052567714, "num_env_steps_trained_throughput_per_sec": 9.551297052567714, "timesteps_total": 27864, "num_env_steps_sampled_lifetime": 27864, "num_agent_steps_sampled_lifetime": 27864, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 27864, "timers": {"training_iteration_time_ms": 52512.316, "restore_workers_time_ms": 0.022, "training_step_time_ms": 52512.254, "sample_time_ms": 51634.97, "load_time_ms": 0.492, "load_throughput": 1048914.797, "learn_time_ms": 863.2, "learn_throughput": 597.775, "synch_weights_time_ms": 13.253}, "counters": {"num_env_steps_sampled": 27864, "num_env_steps_trained": 27864, "num_agent_steps_sampled": 27864, "num_agent_steps_trained": 27864}, "done": false, "episodes_total": 852, "training_iteration": 54, "trial_id": "fe178_00005", "date": "2024-08-15_17-48-55", "timestamp": 1723765735, "time_this_iter_s": 54.02705931663513, "time_total_s": 3118.592118024826, "pid": 59435, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 157.54626536369324, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.76538461538462, "ram_util_percent": 11.42820512820513}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.17782207727432, "cur_kl_coeff": 0.375, "cur_lr": 1e-05, "total_loss": 9.016990224520365, "policy_loss": -0.015939063656454287, "vf_loss": 9.029597318172454, "vf_explained_var": 0.07906993081172307, "kl": 0.008885504245093519, "entropy": -0.5830858846505483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28380, "num_env_steps_trained": 28380, "num_agent_steps_sampled": 28380, "num_agent_steps_trained": 28380}, "sampler_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 294.1793731929721, "episode_len_mean": 47.225, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 1889, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.47278796196555, "mean_inference_ms": 1.2686550158147518, "mean_action_processing_ms": 0.2093332895177115, "mean_env_wait_ms": 540.2658871415921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011806488037109375, "StateBufferConnector_ms": 0.006201267242431641, "ViewRequirementAgentConnector_ms": 0.17042338848114014}, "num_episodes": 9, "episode_return_max": 351.23922642405375, "episode_return_min": 118.55092419552915, "episode_return_mean": 294.1793731929721}, "env_runner_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 294.1793731929721, "episode_len_mean": 47.225, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 1889, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.47278796196555, "mean_inference_ms": 1.2686550158147518, "mean_action_processing_ms": 0.2093332895177115, "mean_env_wait_ms": 540.2658871415921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011806488037109375, "StateBufferConnector_ms": 0.006201267242431641, "ViewRequirementAgentConnector_ms": 0.17042338848114014}, "num_episodes": 9, "episode_return_max": 351.23922642405375, "episode_return_min": 118.55092419552915, "episode_return_mean": 294.1793731929721}, "episode_reward_max": 351.23922642405375, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 294.1793731929721, "episode_len_mean": 47.225, "episodes_this_iter": 9, "episodes_timesteps_total": 1889, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.47278796196555, "mean_inference_ms": 1.2686550158147518, "mean_action_processing_ms": 0.2093332895177115, "mean_env_wait_ms": 540.2658871415921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011806488037109375, "StateBufferConnector_ms": 0.006201267242431641, "ViewRequirementAgentConnector_ms": 0.17042338848114014}, "num_episodes": 9, "episode_return_max": 351.23922642405375, "episode_return_min": 118.55092419552915, "episode_return_mean": 294.1793731929721, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28380, "num_agent_steps_trained": 28380, "num_env_steps_sampled": 28380, "num_env_steps_trained": 28380, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.197069212349959, "num_env_steps_trained_throughput_per_sec": 10.197069212349959, "timesteps_total": 28380, "num_env_steps_sampled_lifetime": 28380, "num_agent_steps_sampled_lifetime": 28380, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 28380, "timers": {"training_iteration_time_ms": 52034.934, "restore_workers_time_ms": 0.02, "training_step_time_ms": 52034.873, "sample_time_ms": 51206.118, "load_time_ms": 0.449, "load_throughput": 1148606.005, "learn_time_ms": 814.567, "learn_throughput": 633.465, "synch_weights_time_ms": 13.408}, "counters": {"num_env_steps_sampled": 28380, "num_env_steps_trained": 28380, "num_agent_steps_sampled": 28380, "num_agent_steps_trained": 28380}, "done": false, "episodes_total": 861, "training_iteration": 55, "trial_id": "fe178_00005", "date": "2024-08-15_17-49-45", "timestamp": 1723765785, "time_this_iter_s": 50.606213092803955, "time_total_s": 3169.19833111763, "pid": 59435, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 208.1524784564972, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.873611111111114, "ram_util_percent": 11.502777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.697746002674103, "cur_kl_coeff": 0.375, "cur_lr": 1e-05, "total_loss": 9.175703016916911, "policy_loss": -0.007371332791323463, "vf_loss": 9.178218539555868, "vf_explained_var": -0.01685854544242223, "kl": 0.012949208439873749, "entropy": -0.6232218305269878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "sampler_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 299.31837228065615, "episode_len_mean": 47.8235294117647, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2439, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.508118531641288, "mean_inference_ms": 1.2678621125648648, "mean_action_processing_ms": 0.20922992883974167, "mean_env_wait_ms": 544.0357912138998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011863428003647748, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.1699985242357441}, "num_episodes": 11, "episode_return_max": 351.23922642405375, "episode_return_min": 118.55092419552915, "episode_return_mean": 299.31837228065615}, "env_runner_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 299.31837228065615, "episode_len_mean": 47.8235294117647, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2439, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.508118531641288, "mean_inference_ms": 1.2678621125648648, "mean_action_processing_ms": 0.20922992883974167, "mean_env_wait_ms": 544.0357912138998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011863428003647748, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.1699985242357441}, "num_episodes": 11, "episode_return_max": 351.23922642405375, "episode_return_min": 118.55092419552915, "episode_return_mean": 299.31837228065615}, "episode_reward_max": 351.23922642405375, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 299.31837228065615, "episode_len_mean": 47.8235294117647, "episodes_this_iter": 11, "episodes_timesteps_total": 2439, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.508118531641288, "mean_inference_ms": 1.2678621125648648, "mean_action_processing_ms": 0.20922992883974167, "mean_env_wait_ms": 544.0357912138998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011863428003647748, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.1699985242357441}, "num_episodes": 11, "episode_return_max": 351.23922642405375, "episode_return_min": 118.55092419552915, "episode_return_mean": 299.31837228065615, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896, "num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.220656882476558, "num_env_steps_trained_throughput_per_sec": 9.220656882476558, "timesteps_total": 28896, "num_env_steps_sampled_lifetime": 28896, "num_agent_steps_sampled_lifetime": 28896, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 28896, "timers": {"training_iteration_time_ms": 52820.211, "restore_workers_time_ms": 0.019, "training_step_time_ms": 52820.152, "sample_time_ms": 52022.064, "load_time_ms": 0.431, "load_throughput": 1197444.32, "learn_time_ms": 783.974, "learn_throughput": 658.185, "synch_weights_time_ms": 13.362}, "counters": {"num_env_steps_sampled": 28896, "num_env_steps_trained": 28896, "num_agent_steps_sampled": 28896, "num_agent_steps_trained": 28896}, "done": false, "episodes_total": 872, "training_iteration": 56, "trial_id": "fe178_00005", "date": "2024-08-15_17-50-41", "timestamp": 1723765841, "time_this_iter_s": 55.96459722518921, "time_total_s": 3225.162928342819, "pid": 59435, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 264.1170756816864, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.1873417721519, "ram_util_percent": 11.59367088607595}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.819244587421418, "cur_kl_coeff": 0.375, "cur_lr": 1e-05, "total_loss": 9.449009386698405, "policy_loss": -0.021776493079960345, "vf_loss": 9.466753101348877, "vf_explained_var": 0.0577418049176534, "kl": 0.010754045904589778, "entropy": -0.8093199878931046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29412, "num_env_steps_trained": 29412, "num_agent_steps_sampled": 29412, "num_agent_steps_trained": 29412}, "sampler_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 301.7232157178635, "episode_len_mean": 48.18032786885246, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2939, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594, 303.96061245796966, 327.3011166551484, 298.2297004286642, 336.86810842002524, 311.60640653411997, 272.7772343854309, 312.17096554665875, 339.13330697853235, 333.83042657076925, 304.00129449889675], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5271037481422125, "mean_inference_ms": 1.2674234343011783, "mean_action_processing_ms": 0.20915404793359624, "mean_env_wait_ms": 546.5961566067404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0120479552472224, "StateBufferConnector_ms": 0.006214907911957287, "ViewRequirementAgentConnector_ms": 0.17012103659207703}, "num_episodes": 10, "episode_return_max": 351.23922642405375, "episode_return_min": 118.55092419552915, "episode_return_mean": 301.7232157178635}, "env_runner_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 301.7232157178635, "episode_len_mean": 48.18032786885246, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2939, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594, 303.96061245796966, 327.3011166551484, 298.2297004286642, 336.86810842002524, 311.60640653411997, 272.7772343854309, 312.17096554665875, 339.13330697853235, 333.83042657076925, 304.00129449889675], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5271037481422125, "mean_inference_ms": 1.2674234343011783, "mean_action_processing_ms": 0.20915404793359624, "mean_env_wait_ms": 546.5961566067404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0120479552472224, "StateBufferConnector_ms": 0.006214907911957287, "ViewRequirementAgentConnector_ms": 0.17012103659207703}, "num_episodes": 10, "episode_return_max": 351.23922642405375, "episode_return_min": 118.55092419552915, "episode_return_mean": 301.7232157178635}, "episode_reward_max": 351.23922642405375, "episode_reward_min": 118.55092419552915, "episode_reward_mean": 301.7232157178635, "episode_len_mean": 48.18032786885246, "episodes_this_iter": 10, "episodes_timesteps_total": 2939, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594, 303.96061245796966, 327.3011166551484, 298.2297004286642, 336.86810842002524, 311.60640653411997, 272.7772343854309, 312.17096554665875, 339.13330697853235, 333.83042657076925, 304.00129449889675], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5271037481422125, "mean_inference_ms": 1.2674234343011783, "mean_action_processing_ms": 0.20915404793359624, "mean_env_wait_ms": 546.5961566067404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0120479552472224, "StateBufferConnector_ms": 0.006214907911957287, "ViewRequirementAgentConnector_ms": 0.17012103659207703}, "num_episodes": 10, "episode_return_max": 351.23922642405375, "episode_return_min": 118.55092419552915, "episode_return_mean": 301.7232157178635, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29412, "num_agent_steps_trained": 29412, "num_env_steps_sampled": 29412, "num_env_steps_trained": 29412, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.500858519034987, "num_env_steps_trained_throughput_per_sec": 9.500858519034987, "timesteps_total": 29412, "num_env_steps_sampled_lifetime": 29412, "num_agent_steps_sampled_lifetime": 29412, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 29412, "timers": {"training_iteration_time_ms": 53068.658, "restore_workers_time_ms": 0.019, "training_step_time_ms": 53068.601, "sample_time_ms": 52287.975, "load_time_ms": 0.417, "load_throughput": 1237545.524, "learn_time_ms": 766.579, "learn_throughput": 673.121, "synch_weights_time_ms": 13.317}, "counters": {"num_env_steps_sampled": 29412, "num_env_steps_trained": 29412, "num_agent_steps_sampled": 29412, "num_agent_steps_trained": 29412}, "done": false, "episodes_total": 882, "training_iteration": 57, "trial_id": "fe178_00005", "date": "2024-08-15_17-51-36", "timestamp": 1723765896, "time_this_iter_s": 54.314029693603516, "time_total_s": 3279.4769580364227, "pid": 59435, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 318.4311053752899, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 23.993589743589745, "ram_util_percent": 11.6474358974359}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.324340486526488, "cur_kl_coeff": 0.375, "cur_lr": 1e-05, "total_loss": 8.913264489173889, "policy_loss": 0.0018045241944491864, "vf_loss": 8.906918207804361, "vf_explained_var": 0.06734060098727544, "kl": 0.01211165356289868, "entropy": -0.513666832819581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29928, "num_env_steps_trained": 29928, "num_agent_steps_sampled": 29928, "num_agent_steps_trained": 29928}, "sampler_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 79.4428588867188, "episode_reward_mean": 297.3657234220289, "episode_len_mean": 48.067567567567565, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 3557, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594, 303.96061245796966, 327.3011166551484, 298.2297004286642, 336.86810842002524, 311.60640653411997, 272.7772343854309, 312.17096554665875, 339.13330697853235, 333.83042657076925, 304.00129449889675, 254.21291348338923, 336.46967512068005, 208.05563511276023, 327.644149682041, 305.14175153399805, 312.25434787357074, 288.57688342187873, 281.44477940474536, 308.20488096634546, 79.4428588867188, 294.1335585560013, 331.12402436445643, 273.241916033877], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.569858303391158, "mean_inference_ms": 1.2662782054222805, "mean_action_processing_ms": 0.20900560072282665, "mean_env_wait_ms": 544.2109802607989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011984722034351246, "StateBufferConnector_ms": 0.00624302271250132, "ViewRequirementAgentConnector_ms": 0.17068643827696103}, "num_episodes": 13, "episode_return_max": 351.23922642405375, "episode_return_min": 79.4428588867188, "episode_return_mean": 297.3657234220289}, "env_runner_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 79.4428588867188, "episode_reward_mean": 297.3657234220289, "episode_len_mean": 48.067567567567565, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 3557, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594, 303.96061245796966, 327.3011166551484, 298.2297004286642, 336.86810842002524, 311.60640653411997, 272.7772343854309, 312.17096554665875, 339.13330697853235, 333.83042657076925, 304.00129449889675, 254.21291348338923, 336.46967512068005, 208.05563511276023, 327.644149682041, 305.14175153399805, 312.25434787357074, 288.57688342187873, 281.44477940474536, 308.20488096634546, 79.4428588867188, 294.1335585560013, 331.12402436445643, 273.241916033877], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.569858303391158, "mean_inference_ms": 1.2662782054222805, "mean_action_processing_ms": 0.20900560072282665, "mean_env_wait_ms": 544.2109802607989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011984722034351246, "StateBufferConnector_ms": 0.00624302271250132, "ViewRequirementAgentConnector_ms": 0.17068643827696103}, "num_episodes": 13, "episode_return_max": 351.23922642405375, "episode_return_min": 79.4428588867188, "episode_return_mean": 297.3657234220289}, "episode_reward_max": 351.23922642405375, "episode_reward_min": 79.4428588867188, "episode_reward_mean": 297.3657234220289, "episode_len_mean": 48.067567567567565, "episodes_this_iter": 13, "episodes_timesteps_total": 3557, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594, 303.96061245796966, 327.3011166551484, 298.2297004286642, 336.86810842002524, 311.60640653411997, 272.7772343854309, 312.17096554665875, 339.13330697853235, 333.83042657076925, 304.00129449889675, 254.21291348338923, 336.46967512068005, 208.05563511276023, 327.644149682041, 305.14175153399805, 312.25434787357074, 288.57688342187873, 281.44477940474536, 308.20488096634546, 79.4428588867188, 294.1335585560013, 331.12402436445643, 273.241916033877], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.569858303391158, "mean_inference_ms": 1.2662782054222805, "mean_action_processing_ms": 0.20900560072282665, "mean_env_wait_ms": 544.2109802607989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011984722034351246, "StateBufferConnector_ms": 0.00624302271250132, "ViewRequirementAgentConnector_ms": 0.17068643827696103}, "num_episodes": 13, "episode_return_max": 351.23922642405375, "episode_return_min": 79.4428588867188, "episode_return_mean": 297.3657234220289, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29928, "num_agent_steps_trained": 29928, "num_env_steps_sampled": 29928, "num_env_steps_trained": 29928, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.0896878787022, "num_env_steps_trained_throughput_per_sec": 14.0896878787022, "timesteps_total": 29928, "num_env_steps_sampled_lifetime": 29928, "num_agent_steps_sampled_lifetime": 29928, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 29928, "timers": {"training_iteration_time_ms": 50719.212, "restore_workers_time_ms": 0.019, "training_step_time_ms": 50719.157, "sample_time_ms": 49953.881, "load_time_ms": 0.405, "load_throughput": 1274808.654, "learn_time_ms": 751.28, "learn_throughput": 686.828, "synch_weights_time_ms": 13.292}, "counters": {"num_env_steps_sampled": 29928, "num_env_steps_trained": 29928, "num_agent_steps_sampled": 29928, "num_agent_steps_trained": 29928}, "done": false, "episodes_total": 895, "training_iteration": 58, "trial_id": "fe178_00005", "date": "2024-08-15_17-52-12", "timestamp": 1723765932, "time_this_iter_s": 36.626099824905396, "time_total_s": 3316.103057861328, "pid": 59435, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 355.0572052001953, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 34.08461538461538, "ram_util_percent": 11.294230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.607162022590636, "cur_kl_coeff": 0.375, "cur_lr": 1e-05, "total_loss": 9.224106653531392, "policy_loss": -0.003247107840919246, "vf_loss": 9.218161996205648, "vf_explained_var": 0.019220584134260813, "kl": 0.024511290190278798, "entropy": -0.6431864475210508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30444, "num_env_steps_trained": 30444, "num_agent_steps_sampled": 30444, "num_agent_steps_trained": 30444}, "sampler_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 79.4428588867188, "episode_reward_mean": 298.5903349597935, "episode_len_mean": 48.23456790123457, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 3907, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594, 303.96061245796966, 327.3011166551484, 298.2297004286642, 336.86810842002524, 311.60640653411997, 272.7772343854309, 312.17096554665875, 339.13330697853235, 333.83042657076925, 304.00129449889675, 254.21291348338923, 336.46967512068005, 208.05563511276023, 327.644149682041, 305.14175153399805, 312.25434787357074, 288.57688342187873, 281.44477940474536, 308.20488096634546, 79.4428588867188, 294.1335585560013, 331.12402436445643, 273.241916033877, 245.82591258017402, 345.626172964763, 329.18874792480295, 311.33916584107146, 289.67571158572355, 340.8948219959344, 318.2030656206615], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.573873715741798, "mean_inference_ms": 1.2659020597569186, "mean_action_processing_ms": 0.20896094892087752, "mean_env_wait_ms": 543.6518821215896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011857645011242524, "StateBufferConnector_ms": 0.006252747994882089, "ViewRequirementAgentConnector_ms": 0.17089549406075183}, "num_episodes": 7, "episode_return_max": 351.23922642405375, "episode_return_min": 79.4428588867188, "episode_return_mean": 298.5903349597935}, "env_runner_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 79.4428588867188, "episode_reward_mean": 298.5903349597935, "episode_len_mean": 48.23456790123457, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 3907, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594, 303.96061245796966, 327.3011166551484, 298.2297004286642, 336.86810842002524, 311.60640653411997, 272.7772343854309, 312.17096554665875, 339.13330697853235, 333.83042657076925, 304.00129449889675, 254.21291348338923, 336.46967512068005, 208.05563511276023, 327.644149682041, 305.14175153399805, 312.25434787357074, 288.57688342187873, 281.44477940474536, 308.20488096634546, 79.4428588867188, 294.1335585560013, 331.12402436445643, 273.241916033877, 245.82591258017402, 345.626172964763, 329.18874792480295, 311.33916584107146, 289.67571158572355, 340.8948219959344, 318.2030656206615], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.573873715741798, "mean_inference_ms": 1.2659020597569186, "mean_action_processing_ms": 0.20896094892087752, "mean_env_wait_ms": 543.6518821215896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011857645011242524, "StateBufferConnector_ms": 0.006252747994882089, "ViewRequirementAgentConnector_ms": 0.17089549406075183}, "num_episodes": 7, "episode_return_max": 351.23922642405375, "episode_return_min": 79.4428588867188, "episode_return_mean": 298.5903349597935}, "episode_reward_max": 351.23922642405375, "episode_reward_min": 79.4428588867188, "episode_reward_mean": 298.5903349597935, "episode_len_mean": 48.23456790123457, "episodes_this_iter": 7, "episodes_timesteps_total": 3907, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594, 303.96061245796966, 327.3011166551484, 298.2297004286642, 336.86810842002524, 311.60640653411997, 272.7772343854309, 312.17096554665875, 339.13330697853235, 333.83042657076925, 304.00129449889675, 254.21291348338923, 336.46967512068005, 208.05563511276023, 327.644149682041, 305.14175153399805, 312.25434787357074, 288.57688342187873, 281.44477940474536, 308.20488096634546, 79.4428588867188, 294.1335585560013, 331.12402436445643, 273.241916033877, 245.82591258017402, 345.626172964763, 329.18874792480295, 311.33916584107146, 289.67571158572355, 340.8948219959344, 318.2030656206615], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.573873715741798, "mean_inference_ms": 1.2659020597569186, "mean_action_processing_ms": 0.20896094892087752, "mean_env_wait_ms": 543.6518821215896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011857645011242524, "StateBufferConnector_ms": 0.006252747994882089, "ViewRequirementAgentConnector_ms": 0.17089549406075183}, "num_episodes": 7, "episode_return_max": 351.23922642405375, "episode_return_min": 79.4428588867188, "episode_return_mean": 298.5903349597935, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30444, "num_agent_steps_trained": 30444, "num_env_steps_sampled": 30444, "num_env_steps_trained": 30444, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.506546888891464, "num_env_steps_trained_throughput_per_sec": 9.506546888891464, "timesteps_total": 30444, "num_env_steps_sampled_lifetime": 30444, "num_agent_steps_sampled_lifetime": 30444, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 30444, "timers": {"training_iteration_time_ms": 51164.111, "restore_workers_time_ms": 0.019, "training_step_time_ms": 51164.056, "sample_time_ms": 50408.159, "load_time_ms": 0.398, "load_throughput": 1296061.6, "learn_time_ms": 741.967, "learn_throughput": 695.448, "synch_weights_time_ms": 13.243}, "counters": {"num_env_steps_sampled": 30444, "num_env_steps_trained": 30444, "num_agent_steps_sampled": 30444, "num_agent_steps_trained": 30444}, "done": false, "episodes_total": 902, "training_iteration": 59, "trial_id": "fe178_00005", "date": "2024-08-15_17-53-06", "timestamp": 1723765986, "time_this_iter_s": 54.28162097930908, "time_total_s": 3370.384678840637, "pid": 59435, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 409.3388261795044, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.894871794871793, "ram_util_percent": 11.57948717948718}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.266572384039561, "cur_kl_coeff": 0.5625, "cur_lr": 1e-05, "total_loss": 9.338977487881978, "policy_loss": -0.004177669730658333, "vf_loss": 9.341242218017578, "vf_explained_var": 0.12579381316900254, "kl": 0.0034008261151049057, "entropy": -0.6979866554339726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30960, "num_env_steps_trained": 30960, "num_agent_steps_sampled": 30960, "num_agent_steps_trained": 30960}, "sampler_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 79.4428588867188, "episode_reward_mean": 298.401783299897, "episode_len_mean": 48.096774193548384, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4473, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594, 303.96061245796966, 327.3011166551484, 298.2297004286642, 336.86810842002524, 311.60640653411997, 272.7772343854309, 312.17096554665875, 339.13330697853235, 333.83042657076925, 304.00129449889675, 254.21291348338923, 336.46967512068005, 208.05563511276023, 327.644149682041, 305.14175153399805, 312.25434787357074, 288.57688342187873, 281.44477940474536, 308.20488096634546, 79.4428588867188, 294.1335585560013, 331.12402436445643, 273.241916033877, 245.82591258017402, 345.626172964763, 329.18874792480295, 311.33916584107146, 289.67571158572355, 340.8948219959344, 318.2030656206615, 330.4601135405466, 340.1392232068948, 285.3310036033555, 309.6537430724975, 345.3904226051498, 319.0009379710086, 313.2018814229051, 299.6129314968098, 294.621186676409, 283.24284207730904, 345.8190574629373, 99.07537201131944], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 49, 50, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5894381515038205, "mean_inference_ms": 1.2653647535026729, "mean_action_processing_ms": 0.20885220286331851, "mean_env_wait_ms": 542.5015590257022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011833252445344002, "StateBufferConnector_ms": 0.006279381372595346, "ViewRequirementAgentConnector_ms": 0.17128375268751575}, "num_episodes": 12, "episode_return_max": 351.23922642405375, "episode_return_min": 79.4428588867188, "episode_return_mean": 298.401783299897}, "env_runner_results": {"episode_reward_max": 351.23922642405375, "episode_reward_min": 79.4428588867188, "episode_reward_mean": 298.401783299897, "episode_len_mean": 48.096774193548384, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4473, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594, 303.96061245796966, 327.3011166551484, 298.2297004286642, 336.86810842002524, 311.60640653411997, 272.7772343854309, 312.17096554665875, 339.13330697853235, 333.83042657076925, 304.00129449889675, 254.21291348338923, 336.46967512068005, 208.05563511276023, 327.644149682041, 305.14175153399805, 312.25434787357074, 288.57688342187873, 281.44477940474536, 308.20488096634546, 79.4428588867188, 294.1335585560013, 331.12402436445643, 273.241916033877, 245.82591258017402, 345.626172964763, 329.18874792480295, 311.33916584107146, 289.67571158572355, 340.8948219959344, 318.2030656206615, 330.4601135405466, 340.1392232068948, 285.3310036033555, 309.6537430724975, 345.3904226051498, 319.0009379710086, 313.2018814229051, 299.6129314968098, 294.621186676409, 283.24284207730904, 345.8190574629373, 99.07537201131944], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 49, 50, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5894381515038205, "mean_inference_ms": 1.2653647535026729, "mean_action_processing_ms": 0.20885220286331851, "mean_env_wait_ms": 542.5015590257022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011833252445344002, "StateBufferConnector_ms": 0.006279381372595346, "ViewRequirementAgentConnector_ms": 0.17128375268751575}, "num_episodes": 12, "episode_return_max": 351.23922642405375, "episode_return_min": 79.4428588867188, "episode_return_mean": 298.401783299897}, "episode_reward_max": 351.23922642405375, "episode_reward_min": 79.4428588867188, "episode_reward_mean": 298.401783299897, "episode_len_mean": 48.096774193548384, "episodes_this_iter": 12, "episodes_timesteps_total": 4473, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [125.55145699091241, 307.9971308181696, 326.1262601891536, 303.3968078686888, 343.78152689438434, 337.52348711479266, 287.7279889374245, 118.55092419552915, 272.32316299544925, 254.88552996927967, 298.53331381171114, 288.8363378007767, 341.84271133861006, 335.79516796422377, 313.3764160345513, 332.2305561491529, 316.33844238688994, 122.91581161768244, 318.5273400999406, 327.6880781163382, 313.2632275358753, 320.4258691579811, 300.6622589813139, 351.23922642405375, 297.9607409004377, 304.87458164340063, 327.90069645467344, 174.40874199932313, 299.74926494285904, 324.4052466296135, 321.0204594977232, 314.74331537311133, 280.65397737844484, 309.5576498632604, 274.0072680279647, 337.28406184316776, 272.9593445646903, 340.5492675913612, 325.0685142395996, 302.4927633763651, 319.47194333711843, 297.01039426882323, 333.808894672558, 338.850486505872, 345.3142503049032, 302.14040552454236, 297.83885731669545, 297.6791447887555, 316.01786444465085, 349.12008162534573, 300.80973580531594, 303.96061245796966, 327.3011166551484, 298.2297004286642, 336.86810842002524, 311.60640653411997, 272.7772343854309, 312.17096554665875, 339.13330697853235, 333.83042657076925, 304.00129449889675, 254.21291348338923, 336.46967512068005, 208.05563511276023, 327.644149682041, 305.14175153399805, 312.25434787357074, 288.57688342187873, 281.44477940474536, 308.20488096634546, 79.4428588867188, 294.1335585560013, 331.12402436445643, 273.241916033877, 245.82591258017402, 345.626172964763, 329.18874792480295, 311.33916584107146, 289.67571158572355, 340.8948219959344, 318.2030656206615, 330.4601135405466, 340.1392232068948, 285.3310036033555, 309.6537430724975, 345.3904226051498, 319.0009379710086, 313.2018814229051, 299.6129314968098, 294.621186676409, 283.24284207730904, 345.8190574629373, 99.07537201131944], "episode_lengths": [23, 50, 50, 50, 50, 50, 50, 22, 50, 43, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 49, 50, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5894381515038205, "mean_inference_ms": 1.2653647535026729, "mean_action_processing_ms": 0.20885220286331851, "mean_env_wait_ms": 542.5015590257022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011833252445344002, "StateBufferConnector_ms": 0.006279381372595346, "ViewRequirementAgentConnector_ms": 0.17128375268751575}, "num_episodes": 12, "episode_return_max": 351.23922642405375, "episode_return_min": 79.4428588867188, "episode_return_mean": 298.401783299897, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30960, "num_agent_steps_trained": 30960, "num_env_steps_sampled": 30960, "num_env_steps_trained": 30960, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.411752466444824, "num_env_steps_trained_throughput_per_sec": 10.411752466444824, "timesteps_total": 30960, "num_env_steps_sampled_lifetime": 30960, "num_agent_steps_sampled_lifetime": 30960, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 30960, "timers": {"training_iteration_time_ms": 50985.808, "restore_workers_time_ms": 0.018, "training_step_time_ms": 50985.756, "sample_time_ms": 50236.492, "load_time_ms": 0.39, "load_throughput": 1323617.0, "learn_time_ms": 735.421, "learn_throughput": 701.639, "synch_weights_time_ms": 13.176}, "counters": {"num_env_steps_sampled": 30960, "num_env_steps_trained": 30960, "num_agent_steps_sampled": 30960, "num_agent_steps_trained": 30960}, "done": false, "episodes_total": 914, "training_iteration": 60, "trial_id": "fe178_00005", "date": "2024-08-15_17-53-56", "timestamp": 1723766036, "time_this_iter_s": 49.56287622451782, "time_total_s": 3419.947555065155, "pid": 59435, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9478916110629932, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 458.9017024040222, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 26.211267605633804, "ram_util_percent": 11.621126760563383}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.433892645935217, "cur_kl_coeff": 0.28125, "cur_lr": 1e-05, "total_loss": 5.851325245946645, "policy_loss": -0.011111643491312861, "vf_loss": 5.859508851915598, "vf_explained_var": -0.03054439810415109, "kl": 0.010410756500642226, "entropy": -0.396976256382186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 32436, "num_env_steps_trained": 32436, "num_agent_steps_sampled": 32436, "num_agent_steps_trained": 32436}, "sampler_results": {"episode_reward_max": 356.6016748950158, "episode_reward_min": 76.43369890925673, "episode_reward_mean": 279.85565200875766, "episode_len_mean": 47.58974358974359, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 1856, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [259.4195766932099, 271.68595764986856, 76.43369890925673, 276.1946177609867, 311.3717208240643, 310.770737673559, 213.11566480812172, 86.80838344231653, 302.3702742057208, 298.71223340385086, 254.30049193694322, 320.10148068407636, 292.87474279079464, 315.22524327691445, 282.6848044769288, 288.90365025075846, 284.5376667802351, 255.7461756978745, 291.2889812373603, 108.14011062147353, 238.0907973848411, 318.0197714753714, 337.9313555108041, 356.6016748950158, 334.50825085319894, 328.7799338002697, 325.1222912549124, 330.8644086239232, 284.9803983429919, 332.8328468203976, 337.3290097223791, 278.0622473459634, 276.39169595869123, 273.94835331279734, 241.82642719357239, 306.70356418849525, 297.7684326157344, 308.6533987913845, 305.26935712648765], "episode_lengths": [50, 50, 15, 50, 50, 50, 50, 16, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.518146308715847, "mean_inference_ms": 1.2539904721962933, "mean_action_processing_ms": 0.20709254865182247, "mean_env_wait_ms": 542.067346653436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012091489938589243, "StateBufferConnector_ms": 0.0061365274282602165, "ViewRequirementAgentConnector_ms": 0.16771768912290916}, "num_episodes": 39, "episode_return_max": 356.6016748950158, "episode_return_min": 76.43369890925673, "episode_return_mean": 279.85565200875766}, "env_runner_results": {"episode_reward_max": 356.6016748950158, "episode_reward_min": 76.43369890925673, "episode_reward_mean": 279.85565200875766, "episode_len_mean": 47.58974358974359, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 1856, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [259.4195766932099, 271.68595764986856, 76.43369890925673, 276.1946177609867, 311.3717208240643, 310.770737673559, 213.11566480812172, 86.80838344231653, 302.3702742057208, 298.71223340385086, 254.30049193694322, 320.10148068407636, 292.87474279079464, 315.22524327691445, 282.6848044769288, 288.90365025075846, 284.5376667802351, 255.7461756978745, 291.2889812373603, 108.14011062147353, 238.0907973848411, 318.0197714753714, 337.9313555108041, 356.6016748950158, 334.50825085319894, 328.7799338002697, 325.1222912549124, 330.8644086239232, 284.9803983429919, 332.8328468203976, 337.3290097223791, 278.0622473459634, 276.39169595869123, 273.94835331279734, 241.82642719357239, 306.70356418849525, 297.7684326157344, 308.6533987913845, 305.26935712648765], "episode_lengths": [50, 50, 15, 50, 50, 50, 50, 16, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.518146308715847, "mean_inference_ms": 1.2539904721962933, "mean_action_processing_ms": 0.20709254865182247, "mean_env_wait_ms": 542.067346653436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012091489938589243, "StateBufferConnector_ms": 0.0061365274282602165, "ViewRequirementAgentConnector_ms": 0.16771768912290916}, "num_episodes": 39, "episode_return_max": 356.6016748950158, "episode_return_min": 76.43369890925673, "episode_return_mean": 279.85565200875766}, "episode_reward_max": 356.6016748950158, "episode_reward_min": 76.43369890925673, "episode_reward_mean": 279.85565200875766, "episode_len_mean": 47.58974358974359, "episodes_this_iter": 39, "episodes_timesteps_total": 1856, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [259.4195766932099, 271.68595764986856, 76.43369890925673, 276.1946177609867, 311.3717208240643, 310.770737673559, 213.11566480812172, 86.80838344231653, 302.3702742057208, 298.71223340385086, 254.30049193694322, 320.10148068407636, 292.87474279079464, 315.22524327691445, 282.6848044769288, 288.90365025075846, 284.5376667802351, 255.7461756978745, 291.2889812373603, 108.14011062147353, 238.0907973848411, 318.0197714753714, 337.9313555108041, 356.6016748950158, 334.50825085319894, 328.7799338002697, 325.1222912549124, 330.8644086239232, 284.9803983429919, 332.8328468203976, 337.3290097223791, 278.0622473459634, 276.39169595869123, 273.94835331279734, 241.82642719357239, 306.70356418849525, 297.7684326157344, 308.6533987913845, 305.26935712648765], "episode_lengths": [50, 50, 15, 50, 50, 50, 50, 16, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.518146308715847, "mean_inference_ms": 1.2539904721962933, "mean_action_processing_ms": 0.20709254865182247, "mean_env_wait_ms": 542.067346653436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012091489938589243, "StateBufferConnector_ms": 0.0061365274282602165, "ViewRequirementAgentConnector_ms": 0.16771768912290916}, "num_episodes": 39, "episode_return_max": 356.6016748950158, "episode_return_min": 76.43369890925673, "episode_return_mean": 279.85565200875766, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32436, "num_agent_steps_trained": 32436, "num_env_steps_sampled": 32436, "num_env_steps_trained": 32436, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 9.951085819077928, "num_env_steps_trained_throughput_per_sec": 9.951085819077928, "timesteps_total": 32436, "num_env_steps_sampled_lifetime": 32436, "num_agent_steps_sampled_lifetime": 32436, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 32436, "timers": {"training_iteration_time_ms": 206208.667, "restore_workers_time_ms": 0.02, "training_step_time_ms": 206208.605, "sample_time_ms": 200792.262, "load_time_ms": 0.772, "load_throughput": 2657212.661, "learn_time_ms": 5402.196, "learn_throughput": 379.846, "synch_weights_time_ms": 12.726}, "counters": {"num_env_steps_sampled": 32436, "num_env_steps_trained": 32436, "num_agent_steps_sampled": 32436, "num_agent_steps_trained": 32436}, "done": false, "episodes_total": 942, "training_iteration": 50, "trial_id": "fe178_00005", "date": "2024-08-15_17-57-40", "timestamp": 1723766260, "time_this_iter_s": 206.21210932731628, "time_total_s": 3569.6199464797974, "pid": 16493, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2304, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.6066506310803157, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 206.21210932731628, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.21491525423729, "ram_util_percent": 11.61694915254237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.917455035448075, "cur_kl_coeff": 0.5625, "cur_lr": 1e-05, "total_loss": 9.065446497996648, "policy_loss": -0.007584066634687285, "vf_loss": 9.068312581380209, "vf_explained_var": 0.12952853838602701, "kl": 0.008387499858479834, "entropy": -0.4667828459603091, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 33462, "num_env_steps_trained": 33462, "num_agent_steps_sampled": 33462, "num_agent_steps_trained": 33462}, "sampler_results": {"episode_reward_max": 351.11778544758135, "episode_reward_min": 97.84692705395325, "episode_reward_mean": 278.22918442524616, "episode_len_mean": 47.1578947368421, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 896, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [284.0716283372259, 280.56832896781646, 338.3392396211739, 339.3455105612313, 298.9725838566451, 210.2730528945089, 275.20580938546397, 351.11778544758135, 291.19436878731875, 326.6060523881759, 267.72327509408314, 123.7542840030784, 287.63026882216644, 312.5391908851327, 336.3470520449516, 269.58849267991917, 97.84692705395325, 298.35076545001397, 296.8798877992367], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 20, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.433568099429296, "mean_inference_ms": 1.2472968644290396, "mean_action_processing_ms": 0.20605004694645665, "mean_env_wait_ms": 579.4255833439028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011600946125231291, "StateBufferConnector_ms": 0.005944151627390008, "ViewRequirementAgentConnector_ms": 0.1707064478020919}, "num_episodes": 19, "episode_return_max": 351.11778544758135, "episode_return_min": 97.84692705395325, "episode_return_mean": 278.22918442524616}, "env_runner_results": {"episode_reward_max": 351.11778544758135, "episode_reward_min": 97.84692705395325, "episode_reward_mean": 278.22918442524616, "episode_len_mean": 47.1578947368421, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 896, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [284.0716283372259, 280.56832896781646, 338.3392396211739, 339.3455105612313, 298.9725838566451, 210.2730528945089, 275.20580938546397, 351.11778544758135, 291.19436878731875, 326.6060523881759, 267.72327509408314, 123.7542840030784, 287.63026882216644, 312.5391908851327, 336.3470520449516, 269.58849267991917, 97.84692705395325, 298.35076545001397, 296.8798877992367], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 20, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.433568099429296, "mean_inference_ms": 1.2472968644290396, "mean_action_processing_ms": 0.20605004694645665, "mean_env_wait_ms": 579.4255833439028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011600946125231291, "StateBufferConnector_ms": 0.005944151627390008, "ViewRequirementAgentConnector_ms": 0.1707064478020919}, "num_episodes": 19, "episode_return_max": 351.11778544758135, "episode_return_min": 97.84692705395325, "episode_return_mean": 278.22918442524616}, "episode_reward_max": 351.11778544758135, "episode_reward_min": 97.84692705395325, "episode_reward_mean": 278.22918442524616, "episode_len_mean": 47.1578947368421, "episodes_this_iter": 19, "episodes_timesteps_total": 896, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [284.0716283372259, 280.56832896781646, 338.3392396211739, 339.3455105612313, 298.9725838566451, 210.2730528945089, 275.20580938546397, 351.11778544758135, 291.19436878731875, 326.6060523881759, 267.72327509408314, 123.7542840030784, 287.63026882216644, 312.5391908851327, 336.3470520449516, 269.58849267991917, 97.84692705395325, 298.35076545001397, 296.8798877992367], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 20, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.433568099429296, "mean_inference_ms": 1.2472968644290396, "mean_action_processing_ms": 0.20605004694645665, "mean_env_wait_ms": 579.4255833439028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011600946125231291, "StateBufferConnector_ms": 0.005944151627390008, "ViewRequirementAgentConnector_ms": 0.1707064478020919}, "num_episodes": 19, "episode_return_max": 351.11778544758135, "episode_return_min": 97.84692705395325, "episode_return_mean": 278.22918442524616, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33462, "num_agent_steps_trained": 33462, "num_env_steps_sampled": 33462, "num_env_steps_trained": 33462, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.098271991600665, "num_env_steps_trained_throughput_per_sec": 9.098271991600665, "timesteps_total": 33462, "num_env_steps_sampled_lifetime": 33462, "num_agent_steps_sampled_lifetime": 33462, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 33462, "timers": {"training_iteration_time_ms": 112768.676, "restore_workers_time_ms": 0.015, "training_step_time_ms": 112768.624, "sample_time_ms": 106965.069, "load_time_ms": 0.827, "load_throughput": 1240160.203, "learn_time_ms": 5789.145, "learn_throughput": 177.228, "synch_weights_time_ms": 12.985}, "counters": {"num_env_steps_sampled": 33462, "num_env_steps_trained": 33462, "num_agent_steps_sampled": 33462, "num_agent_steps_trained": 33462}, "done": false, "episodes_total": 964, "training_iteration": 49, "trial_id": "fe178_00005", "date": "2024-08-15_17-59-52", "timestamp": 1723766392, "time_this_iter_s": 112.7721700668335, "time_total_s": 3664.9086322784424, "pid": 42676, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.26465279297424, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1443586634647458, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 112.7721700668335, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 24.645061728395063, "ram_util_percent": 11.667283950617284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.543449859817823, "cur_kl_coeff": 0.5625, "cur_lr": 1e-05, "total_loss": 8.951960390806198, "policy_loss": -0.009094457731892665, "vf_loss": 8.957205557823182, "vf_explained_var": -0.02279326617717743, "kl": 0.006843204226424859, "entropy": -0.5506071986009677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 34488, "num_env_steps_trained": 34488, "num_agent_steps_sampled": 34488, "num_agent_steps_trained": 34488}, "sampler_results": {"episode_reward_max": 357.7756643585183, "episode_reward_min": 97.84692705395325, "episode_reward_mean": 292.93878885340825, "episode_len_mean": 48.578947368421055, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 1846, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [284.0716283372259, 280.56832896781646, 338.3392396211739, 339.3455105612313, 298.9725838566451, 210.2730528945089, 275.20580938546397, 351.11778544758135, 291.19436878731875, 326.6060523881759, 267.72327509408314, 123.7542840030784, 287.63026882216644, 312.5391908851327, 336.3470520449516, 269.58849267991917, 97.84692705395325, 298.35076545001397, 296.8798877992367, 320.7381880614078, 280.84388213256807, 280.9561697313377, 320.4448505323828, 243.78115601222805, 297.57025944599565, 341.54779628515143, 305.5415278270053, 277.5631437074295, 357.7756643585183, 334.7987325226856, 292.0069293330019, 263.1905839189445, 328.4057041218839, 310.5311511247131, 308.705518303296, 326.5315855550711, 319.82154065771056, 334.56508871850525], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.419651868028721, "mean_inference_ms": 1.2489096068354466, "mean_action_processing_ms": 0.20654459984869128, "mean_env_wait_ms": 556.5989379523462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012346317893580386, "StateBufferConnector_ms": 0.006082183436343544, "ViewRequirementAgentConnector_ms": 0.17034631026418587}, "num_episodes": 19, "episode_return_max": 357.7756643585183, "episode_return_min": 97.84692705395325, "episode_return_mean": 292.93878885340825}, "env_runner_results": {"episode_reward_max": 357.7756643585183, "episode_reward_min": 97.84692705395325, "episode_reward_mean": 292.93878885340825, "episode_len_mean": 48.578947368421055, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 1846, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [284.0716283372259, 280.56832896781646, 338.3392396211739, 339.3455105612313, 298.9725838566451, 210.2730528945089, 275.20580938546397, 351.11778544758135, 291.19436878731875, 326.6060523881759, 267.72327509408314, 123.7542840030784, 287.63026882216644, 312.5391908851327, 336.3470520449516, 269.58849267991917, 97.84692705395325, 298.35076545001397, 296.8798877992367, 320.7381880614078, 280.84388213256807, 280.9561697313377, 320.4448505323828, 243.78115601222805, 297.57025944599565, 341.54779628515143, 305.5415278270053, 277.5631437074295, 357.7756643585183, 334.7987325226856, 292.0069293330019, 263.1905839189445, 328.4057041218839, 310.5311511247131, 308.705518303296, 326.5315855550711, 319.82154065771056, 334.56508871850525], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.419651868028721, "mean_inference_ms": 1.2489096068354466, "mean_action_processing_ms": 0.20654459984869128, "mean_env_wait_ms": 556.5989379523462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012346317893580386, "StateBufferConnector_ms": 0.006082183436343544, "ViewRequirementAgentConnector_ms": 0.17034631026418587}, "num_episodes": 19, "episode_return_max": 357.7756643585183, "episode_return_min": 97.84692705395325, "episode_return_mean": 292.93878885340825}, "episode_reward_max": 357.7756643585183, "episode_reward_min": 97.84692705395325, "episode_reward_mean": 292.93878885340825, "episode_len_mean": 48.578947368421055, "episodes_this_iter": 19, "episodes_timesteps_total": 1846, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [284.0716283372259, 280.56832896781646, 338.3392396211739, 339.3455105612313, 298.9725838566451, 210.2730528945089, 275.20580938546397, 351.11778544758135, 291.19436878731875, 326.6060523881759, 267.72327509408314, 123.7542840030784, 287.63026882216644, 312.5391908851327, 336.3470520449516, 269.58849267991917, 97.84692705395325, 298.35076545001397, 296.8798877992367, 320.7381880614078, 280.84388213256807, 280.9561697313377, 320.4448505323828, 243.78115601222805, 297.57025944599565, 341.54779628515143, 305.5415278270053, 277.5631437074295, 357.7756643585183, 334.7987325226856, 292.0069293330019, 263.1905839189445, 328.4057041218839, 310.5311511247131, 308.705518303296, 326.5315855550711, 319.82154065771056, 334.56508871850525], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.419651868028721, "mean_inference_ms": 1.2489096068354466, "mean_action_processing_ms": 0.20654459984869128, "mean_env_wait_ms": 556.5989379523462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012346317893580386, "StateBufferConnector_ms": 0.006082183436343544, "ViewRequirementAgentConnector_ms": 0.17034631026418587}, "num_episodes": 19, "episode_return_max": 357.7756643585183, "episode_return_min": 97.84692705395325, "episode_return_mean": 292.93878885340825, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34488, "num_agent_steps_trained": 34488, "num_env_steps_sampled": 34488, "num_env_steps_trained": 34488, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.233285116689393, "num_env_steps_trained_throughput_per_sec": 11.233285116689393, "timesteps_total": 34488, "num_env_steps_sampled_lifetime": 34488, "num_agent_steps_sampled_lifetime": 34488, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 34488, "timers": {"training_iteration_time_ms": 102052.195, "restore_workers_time_ms": 0.016, "training_step_time_ms": 102052.142, "sample_time_ms": 98469.416, "load_time_ms": 0.6, "load_throughput": 1711416.148, "learn_time_ms": 3568.505, "learn_throughput": 287.515, "synch_weights_time_ms": 13.172}, "counters": {"num_env_steps_sampled": 34488, "num_env_steps_trained": 34488, "num_agent_steps_sampled": 34488, "num_agent_steps_trained": 34488}, "done": false, "episodes_total": 983, "training_iteration": 50, "trial_id": "fe178_00005", "date": "2024-08-15_18-01-23", "timestamp": 1723766483, "time_this_iter_s": 91.33917260169983, "time_total_s": 3756.247804880142, "pid": 42676, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.26465279297424, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1443586634647458, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 204.11134266853333, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.853846153846153, "ram_util_percent": 11.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.545589192708334, "cur_kl_coeff": 0.28125, "cur_lr": 0.00010000000000000003, "total_loss": 9.347127238909403, "policy_loss": 0.006449306127615273, "vf_loss": 9.326754117012024, "vf_explained_var": 0.10421031067768732, "kl": 0.049506994987195685, "entropy": -0.6957404043215016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 33996, "num_env_steps_trained": 33996, "num_agent_steps_sampled": 33996, "num_agent_steps_trained": 33996}, "sampler_results": {"episode_reward_max": 339.3417323910908, "episode_reward_min": 267.5703804496845, "episode_reward_mean": 313.53110872580004, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.131580221241918, "mean_inference_ms": 1.2542890862943568, "mean_action_processing_ms": 0.20700441923178017, "mean_env_wait_ms": 585.5705505129935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00985860824584961, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.16263723373413086}, "num_episodes": 6, "episode_return_max": 339.3417323910908, "episode_return_min": 267.5703804496845, "episode_return_mean": 313.53110872580004}, "env_runner_results": {"episode_reward_max": 339.3417323910908, "episode_reward_min": 267.5703804496845, "episode_reward_mean": 313.53110872580004, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.131580221241918, "mean_inference_ms": 1.2542890862943568, "mean_action_processing_ms": 0.20700441923178017, "mean_env_wait_ms": 585.5705505129935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00985860824584961, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.16263723373413086}, "num_episodes": 6, "episode_return_max": 339.3417323910908, "episode_return_min": 267.5703804496845, "episode_return_mean": 313.53110872580004}, "episode_reward_max": 339.3417323910908, "episode_reward_min": 267.5703804496845, "episode_reward_mean": 313.53110872580004, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.131580221241918, "mean_inference_ms": 1.2542890862943568, "mean_action_processing_ms": 0.20700441923178017, "mean_env_wait_ms": 585.5705505129935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00985860824584961, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.16263723373413086}, "num_episodes": 6, "episode_return_max": 339.3417323910908, "episode_return_min": 267.5703804496845, "episode_return_mean": 313.53110872580004, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33996, "num_agent_steps_trained": 33996, "num_env_steps_sampled": 33996, "num_env_steps_trained": 33996, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.972182390276057, "num_env_steps_trained_throughput_per_sec": 8.972182390276057, "timesteps_total": 33996, "num_env_steps_sampled_lifetime": 33996, "num_agent_steps_sampled_lifetime": 33996, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 33996, "timers": {"training_iteration_time_ms": 57511.104, "restore_workers_time_ms": 0.018, "training_step_time_ms": 57511.047, "sample_time_ms": 53955.336, "load_time_ms": 0.875, "load_throughput": 589877.586, "learn_time_ms": 3541.004, "learn_throughput": 145.721, "synch_weights_time_ms": 13.371}, "counters": {"num_env_steps_sampled": 33996, "num_env_steps_trained": 33996, "num_agent_steps_sampled": 33996, "num_agent_steps_trained": 33996}, "done": false, "episodes_total": 969, "training_iteration": 54, "trial_id": "fe178_00005", "date": "2024-08-15_18-02-38", "timestamp": 1723766558, "time_this_iter_s": 57.51384878158569, "time_total_s": 3720.387786626816, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 57.51384878158569, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.346987951807233, "ram_util_percent": 11.798795180722887}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.700679337978364, "cur_kl_coeff": 0.421875, "cur_lr": 0.00010000000000000003, "total_loss": 9.369377128283183, "policy_loss": -0.010702939579884212, "vf_loss": 9.361263426144918, "vf_explained_var": -0.004627430438995361, "kl": 0.04460275476740634, "entropy": -0.7614804849028587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 34512, "num_env_steps_trained": 34512, "num_agent_steps_sampled": 34512, "num_agent_steps_trained": 34512}, "sampler_results": {"episode_reward_max": 352.74072049644343, "episode_reward_min": 265.73446651270916, "episode_reward_mean": 316.3299632300967, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.850553209022929, "mean_inference_ms": 1.253149702493028, "mean_action_processing_ms": 0.20681751817318522, "mean_env_wait_ms": 529.4502127979231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012710359361436632, "StateBufferConnector_ms": 0.00612338383992513, "ViewRequirementAgentConnector_ms": 0.16433795293172201}, "num_episodes": 12, "episode_return_max": 352.74072049644343, "episode_return_min": 265.73446651270916, "episode_return_mean": 316.3299632300967}, "env_runner_results": {"episode_reward_max": 352.74072049644343, "episode_reward_min": 265.73446651270916, "episode_reward_mean": 316.3299632300967, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.850553209022929, "mean_inference_ms": 1.253149702493028, "mean_action_processing_ms": 0.20681751817318522, "mean_env_wait_ms": 529.4502127979231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012710359361436632, "StateBufferConnector_ms": 0.00612338383992513, "ViewRequirementAgentConnector_ms": 0.16433795293172201}, "num_episodes": 12, "episode_return_max": 352.74072049644343, "episode_return_min": 265.73446651270916, "episode_return_mean": 316.3299632300967}, "episode_reward_max": 352.74072049644343, "episode_reward_min": 265.73446651270916, "episode_reward_mean": 316.3299632300967, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.850553209022929, "mean_inference_ms": 1.253149702493028, "mean_action_processing_ms": 0.20681751817318522, "mean_env_wait_ms": 529.4502127979231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012710359361436632, "StateBufferConnector_ms": 0.00612338383992513, "ViewRequirementAgentConnector_ms": 0.16433795293172201}, "num_episodes": 12, "episode_return_max": 352.74072049644343, "episode_return_min": 265.73446651270916, "episode_return_mean": 316.3299632300967, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34512, "num_agent_steps_trained": 34512, "num_env_steps_sampled": 34512, "num_env_steps_trained": 34512, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.168677995552846, "num_env_steps_trained_throughput_per_sec": 13.168677995552846, "timesteps_total": 34512, "num_env_steps_sampled_lifetime": 34512, "num_agent_steps_sampled_lifetime": 34512, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 34512, "timers": {"training_iteration_time_ms": 48347.501, "restore_workers_time_ms": 0.017, "training_step_time_ms": 48347.446, "sample_time_ms": 46232.702, "load_time_ms": 0.622, "load_throughput": 830172.944, "learn_time_ms": 2100.613, "learn_throughput": 245.643, "synch_weights_time_ms": 13.148}, "counters": {"num_env_steps_sampled": 34512, "num_env_steps_trained": 34512, "num_agent_steps_sampled": 34512, "num_agent_steps_trained": 34512}, "done": false, "episodes_total": 981, "training_iteration": 55, "trial_id": "fe178_00005", "date": "2024-08-15_18-03-17", "timestamp": 1723766597, "time_this_iter_s": 39.1872820854187, "time_total_s": 3759.5750687122345, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 96.7011308670044, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.055357142857144, "ram_util_percent": 11.871428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.80243159532547, "cur_kl_coeff": 0.6328125, "cur_lr": 0.00010000000000000003, "total_loss": 9.12151969273885, "policy_loss": -0.00922064131203418, "vf_loss": 9.128102731704711, "vf_explained_var": 0.08259749760230382, "kl": 0.004167979338029287, "entropy": -0.7489198281119267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 35028, "num_env_steps_trained": 35028, "num_agent_steps_sampled": 35028, "num_agent_steps_trained": 35028}, "sampler_results": {"episode_reward_max": 352.74072049644343, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 304.971891870984, "episode_len_mean": 49.03333333333333, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1471, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.121136104935512, "mean_inference_ms": 1.2515016306359767, "mean_action_processing_ms": 0.20680850214736932, "mean_env_wait_ms": 525.632663907577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012965202331542969, "StateBufferConnector_ms": 0.006034374237060547, "ViewRequirementAgentConnector_ms": 0.16381104787190756}, "num_episodes": 12, "episode_return_max": 352.74072049644343, "episode_return_min": 119.90144042968757, "episode_return_mean": 304.971891870984}, "env_runner_results": {"episode_reward_max": 352.74072049644343, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 304.971891870984, "episode_len_mean": 49.03333333333333, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1471, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.121136104935512, "mean_inference_ms": 1.2515016306359767, "mean_action_processing_ms": 0.20680850214736932, "mean_env_wait_ms": 525.632663907577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012965202331542969, "StateBufferConnector_ms": 0.006034374237060547, "ViewRequirementAgentConnector_ms": 0.16381104787190756}, "num_episodes": 12, "episode_return_max": 352.74072049644343, "episode_return_min": 119.90144042968757, "episode_return_mean": 304.971891870984}, "episode_reward_max": 352.74072049644343, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 304.971891870984, "episode_len_mean": 49.03333333333333, "episodes_this_iter": 12, "episodes_timesteps_total": 1471, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.121136104935512, "mean_inference_ms": 1.2515016306359767, "mean_action_processing_ms": 0.20680850214736932, "mean_env_wait_ms": 525.632663907577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012965202331542969, "StateBufferConnector_ms": 0.006034374237060547, "ViewRequirementAgentConnector_ms": 0.16381104787190756}, "num_episodes": 12, "episode_return_max": 352.74072049644343, "episode_return_min": 119.90144042968757, "episode_return_mean": 304.971891870984, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35028, "num_agent_steps_trained": 35028, "num_env_steps_sampled": 35028, "num_env_steps_trained": 35028, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.030848157312201, "num_env_steps_trained_throughput_per_sec": 10.030848157312201, "timesteps_total": 35028, "num_env_steps_sampled_lifetime": 35028, "num_agent_steps_sampled_lifetime": 35028, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 35028, "timers": {"training_iteration_time_ms": 49378.778, "restore_workers_time_ms": 0.021, "training_step_time_ms": 49378.716, "sample_time_ms": 47746.49, "load_time_ms": 0.528, "load_throughput": 977975.989, "learn_time_ms": 1618.315, "learn_throughput": 318.85, "synch_weights_time_ms": 13.057}, "counters": {"num_env_steps_sampled": 35028, "num_env_steps_trained": 35028, "num_agent_steps_sampled": 35028, "num_agent_steps_trained": 35028}, "done": false, "episodes_total": 993, "training_iteration": 56, "trial_id": "fe178_00005", "date": "2024-08-15_18-04-09", "timestamp": 1723766649, "time_this_iter_s": 51.44447112083435, "time_total_s": 3811.019539833069, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 148.14560198783875, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.186301369863013, "ram_util_percent": 11.900000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.47134189605713, "cur_kl_coeff": 0.31640625, "cur_lr": 0.00010000000000000003, "total_loss": 8.905390079816183, "policy_loss": -0.021317525615449993, "vf_loss": 8.922447188695271, "vf_explained_var": 0.1716659297545751, "kl": 0.013465009945990498, "entropy": -0.5913463408748308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 35544, "num_env_steps_trained": 35544, "num_agent_steps_sampled": 35544, "num_agent_steps_trained": 35544}, "sampler_results": {"episode_reward_max": 352.74072049644343, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 304.1403552530092, "episode_len_mean": 49.21621621621622, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 1821, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.160684265664, "mean_inference_ms": 1.2505121966453154, "mean_action_processing_ms": 0.20693392521316098, "mean_env_wait_ms": 526.970270615719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013476449090081293, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.16506040418470228}, "num_episodes": 7, "episode_return_max": 352.74072049644343, "episode_return_min": 119.90144042968757, "episode_return_mean": 304.1403552530092}, "env_runner_results": {"episode_reward_max": 352.74072049644343, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 304.1403552530092, "episode_len_mean": 49.21621621621622, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 1821, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.160684265664, "mean_inference_ms": 1.2505121966453154, "mean_action_processing_ms": 0.20693392521316098, "mean_env_wait_ms": 526.970270615719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013476449090081293, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.16506040418470228}, "num_episodes": 7, "episode_return_max": 352.74072049644343, "episode_return_min": 119.90144042968757, "episode_return_mean": 304.1403552530092}, "episode_reward_max": 352.74072049644343, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 304.1403552530092, "episode_len_mean": 49.21621621621622, "episodes_this_iter": 7, "episodes_timesteps_total": 1821, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.160684265664, "mean_inference_ms": 1.2505121966453154, "mean_action_processing_ms": 0.20693392521316098, "mean_env_wait_ms": 526.970270615719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013476449090081293, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.16506040418470228}, "num_episodes": 7, "episode_return_max": 352.74072049644343, "episode_return_min": 119.90144042968757, "episode_return_mean": 304.1403552530092, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35544, "num_agent_steps_trained": 35544, "num_env_steps_sampled": 35544, "num_env_steps_trained": 35544, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.669700176863591, "num_env_steps_trained_throughput_per_sec": 9.669700176863591, "timesteps_total": 35544, "num_env_steps_sampled_lifetime": 35544, "num_agent_steps_sampled_lifetime": 35544, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 35544, "timers": {"training_iteration_time_ms": 50374.727, "restore_workers_time_ms": 0.02, "training_step_time_ms": 50374.667, "sample_time_ms": 48983.299, "load_time_ms": 0.472, "load_throughput": 1093889.747, "learn_time_ms": 1377.622, "learn_throughput": 374.559, "synch_weights_time_ms": 12.971}, "counters": {"num_env_steps_sampled": 35544, "num_env_steps_trained": 35544, "num_agent_steps_sampled": 35544, "num_agent_steps_trained": 35544}, "done": false, "episodes_total": 1000, "training_iteration": 57, "trial_id": "fe178_00005", "date": "2024-08-15_18-05-02", "timestamp": 1723766702, "time_this_iter_s": 53.36546802520752, "time_total_s": 3864.3850078582764, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 201.51107001304626, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.18026315789474, "ram_util_percent": 11.990789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.8946653842926, "cur_kl_coeff": 0.31640625, "cur_lr": 0.00010000000000000003, "total_loss": 9.605664388338726, "policy_loss": -0.007673618306095402, "vf_loss": 9.608305931091309, "vf_explained_var": 0.052431336045265196, "kl": 0.01590390064132958, "entropy": -1.0142698109149932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 36060, "num_env_steps_trained": 36060, "num_agent_steps_sampled": 36060, "num_agent_steps_trained": 36060}, "sampler_results": {"episode_reward_max": 356.6383388167721, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 307.67551004452406, "episode_len_mean": 49.40816326530612, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2421, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.234466370146995, "mean_inference_ms": 1.2502355591667336, "mean_action_processing_ms": 0.20712494814295496, "mean_env_wait_ms": 529.4991212229569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013253153586874202, "StateBufferConnector_ms": 0.006001822802485252, "ViewRequirementAgentConnector_ms": 0.16511459739840761}, "num_episodes": 12, "episode_return_max": 356.6383388167721, "episode_return_min": 119.90144042968757, "episode_return_mean": 307.67551004452406}, "env_runner_results": {"episode_reward_max": 356.6383388167721, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 307.67551004452406, "episode_len_mean": 49.40816326530612, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2421, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.234466370146995, "mean_inference_ms": 1.2502355591667336, "mean_action_processing_ms": 0.20712494814295496, "mean_env_wait_ms": 529.4991212229569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013253153586874202, "StateBufferConnector_ms": 0.006001822802485252, "ViewRequirementAgentConnector_ms": 0.16511459739840761}, "num_episodes": 12, "episode_return_max": 356.6383388167721, "episode_return_min": 119.90144042968757, "episode_return_mean": 307.67551004452406}, "episode_reward_max": 356.6383388167721, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 307.67551004452406, "episode_len_mean": 49.40816326530612, "episodes_this_iter": 12, "episodes_timesteps_total": 2421, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.234466370146995, "mean_inference_ms": 1.2502355591667336, "mean_action_processing_ms": 0.20712494814295496, "mean_env_wait_ms": 529.4991212229569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013253153586874202, "StateBufferConnector_ms": 0.006001822802485252, "ViewRequirementAgentConnector_ms": 0.16511459739840761}, "num_episodes": 12, "episode_return_max": 356.6383388167721, "episode_return_min": 119.90144042968757, "episode_return_mean": 307.67551004452406, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36060, "num_agent_steps_trained": 36060, "num_env_steps_sampled": 36060, "num_env_steps_trained": 36060, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.944309956665036, "num_env_steps_trained_throughput_per_sec": 9.944309956665036, "timesteps_total": 36060, "num_env_steps_sampled_lifetime": 36060, "num_agent_steps_sampled_lifetime": 36060, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 36060, "timers": {"training_iteration_time_ms": 50677.578, "restore_workers_time_ms": 0.019, "training_step_time_ms": 50677.52, "sample_time_ms": 49432.558, "load_time_ms": 0.442, "load_throughput": 1167094.944, "learn_time_ms": 1231.118, "learn_throughput": 419.131, "synch_weights_time_ms": 13.101}, "counters": {"num_env_steps_sampled": 36060, "num_env_steps_trained": 36060, "num_agent_steps_sampled": 36060, "num_agent_steps_trained": 36060}, "done": false, "episodes_total": 1012, "training_iteration": 58, "trial_id": "fe178_00005", "date": "2024-08-15_18-05-54", "timestamp": 1723766754, "time_this_iter_s": 51.89241027832031, "time_total_s": 3916.2774181365967, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 253.40348029136658, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.477027027027027, "ram_util_percent": 12.028378378378378}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.884702638785045, "cur_kl_coeff": 0.31640625, "cur_lr": 0.00010000000000000003, "total_loss": 8.956288115183513, "policy_loss": -0.011926950483272473, "vf_loss": 8.967152992884317, "vf_explained_var": 0.003315471609433492, "kl": 0.0033565708600993577, "entropy": -0.6781925583879153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 36576, "num_env_steps_trained": 36576, "num_agent_steps_sampled": 36576, "num_agent_steps_trained": 36576}, "sampler_results": {"episode_reward_max": 356.6765736990227, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 306.49260444757823, "episode_len_mean": 49.266666666666666, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2956, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.290104787564179, "mean_inference_ms": 1.2506060813576325, "mean_action_processing_ms": 0.20731520796416888, "mean_env_wait_ms": 530.5159226261792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013056596120198568, "StateBufferConnector_ms": 0.005987087885538737, "ViewRequirementAgentConnector_ms": 0.16448497772216797}, "num_episodes": 11, "episode_return_max": 356.6765736990227, "episode_return_min": 119.90144042968757, "episode_return_mean": 306.49260444757823}, "env_runner_results": {"episode_reward_max": 356.6765736990227, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 306.49260444757823, "episode_len_mean": 49.266666666666666, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2956, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.290104787564179, "mean_inference_ms": 1.2506060813576325, "mean_action_processing_ms": 0.20731520796416888, "mean_env_wait_ms": 530.5159226261792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013056596120198568, "StateBufferConnector_ms": 0.005987087885538737, "ViewRequirementAgentConnector_ms": 0.16448497772216797}, "num_episodes": 11, "episode_return_max": 356.6765736990227, "episode_return_min": 119.90144042968757, "episode_return_mean": 306.49260444757823}, "episode_reward_max": 356.6765736990227, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 306.49260444757823, "episode_len_mean": 49.266666666666666, "episodes_this_iter": 11, "episodes_timesteps_total": 2956, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.290104787564179, "mean_inference_ms": 1.2506060813576325, "mean_action_processing_ms": 0.20731520796416888, "mean_env_wait_ms": 530.5159226261792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013056596120198568, "StateBufferConnector_ms": 0.005987087885538737, "ViewRequirementAgentConnector_ms": 0.16448497772216797}, "num_episodes": 11, "episode_return_max": 356.6765736990227, "episode_return_min": 119.90144042968757, "episode_return_mean": 306.49260444757823, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36576, "num_agent_steps_trained": 36576, "num_env_steps_sampled": 36576, "num_env_steps_trained": 36576, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.583821464667565, "num_env_steps_trained_throughput_per_sec": 10.583821464667565, "timesteps_total": 36576, "num_env_steps_sampled_lifetime": 36576, "num_agent_steps_sampled_lifetime": 36576, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 36576, "timers": {"training_iteration_time_ms": 50356.928, "restore_workers_time_ms": 0.021, "training_step_time_ms": 50356.864, "sample_time_ms": 49202.542, "load_time_ms": 0.417, "load_throughput": 1238489.765, "learn_time_ms": 1140.388, "learn_throughput": 452.478, "synch_weights_time_ms": 13.221}, "counters": {"num_env_steps_sampled": 36576, "num_env_steps_trained": 36576, "num_agent_steps_sampled": 36576, "num_agent_steps_trained": 36576}, "done": false, "episodes_total": 1023, "training_iteration": 59, "trial_id": "fe178_00005", "date": "2024-08-15_18-06-43", "timestamp": 1723766803, "time_this_iter_s": 48.75701594352722, "time_total_s": 3965.034434080124, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 302.1604962348938, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.73142857142857, "ram_util_percent": 11.785714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.156051480770111, "cur_kl_coeff": 0.158203125, "cur_lr": 0.00010000000000000003, "total_loss": 9.060156679153442, "policy_loss": -0.01251499291198949, "vf_loss": 9.071293926239013, "vf_explained_var": 0.06180025537808736, "kl": 0.008708366447538274, "entropy": -1.081942117214203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 37092, "num_env_steps_trained": 37092, "num_agent_steps_sampled": 37092, "num_agent_steps_trained": 37092}, "sampler_results": {"episode_reward_max": 356.6765736990227, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 307.1407294898294, "episode_len_mean": 49.111111111111114, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3536, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3478725708031085, "mean_inference_ms": 1.2508090126066242, "mean_action_processing_ms": 0.20746687640566602, "mean_env_wait_ms": 531.8406975936452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012439820501539443, "StateBufferConnector_ms": 0.0059876177046034075, "ViewRequirementAgentConnector_ms": 0.16533037026723227}, "num_episodes": 12, "episode_return_max": 356.6765736990227, "episode_return_min": 119.90144042968757, "episode_return_mean": 307.1407294898294}, "env_runner_results": {"episode_reward_max": 356.6765736990227, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 307.1407294898294, "episode_len_mean": 49.111111111111114, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3536, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3478725708031085, "mean_inference_ms": 1.2508090126066242, "mean_action_processing_ms": 0.20746687640566602, "mean_env_wait_ms": 531.8406975936452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012439820501539443, "StateBufferConnector_ms": 0.0059876177046034075, "ViewRequirementAgentConnector_ms": 0.16533037026723227}, "num_episodes": 12, "episode_return_max": 356.6765736990227, "episode_return_min": 119.90144042968757, "episode_return_mean": 307.1407294898294}, "episode_reward_max": 356.6765736990227, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 307.1407294898294, "episode_len_mean": 49.111111111111114, "episodes_this_iter": 12, "episodes_timesteps_total": 3536, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3478725708031085, "mean_inference_ms": 1.2508090126066242, "mean_action_processing_ms": 0.20746687640566602, "mean_env_wait_ms": 531.8406975936452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012439820501539443, "StateBufferConnector_ms": 0.0059876177046034075, "ViewRequirementAgentConnector_ms": 0.16533037026723227}, "num_episodes": 12, "episode_return_max": 356.6765736990227, "episode_return_min": 119.90144042968757, "episode_return_mean": 307.1407294898294, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37092, "num_agent_steps_trained": 37092, "num_env_steps_sampled": 37092, "num_env_steps_trained": 37092, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.65682738798054, "num_env_steps_trained_throughput_per_sec": 9.65682738798054, "timesteps_total": 37092, "num_env_steps_sampled_lifetime": 37092, "num_agent_steps_sampled_lifetime": 37092, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 37092, "timers": {"training_iteration_time_ms": 50796.468, "restore_workers_time_ms": 0.021, "training_step_time_ms": 50796.405, "sample_time_ms": 49715.038, "load_time_ms": 0.405, "load_throughput": 1272666.839, "learn_time_ms": 1067.422, "learn_throughput": 483.408, "synch_weights_time_ms": 13.249}, "counters": {"num_env_steps_sampled": 37092, "num_env_steps_trained": 37092, "num_agent_steps_sampled": 37092, "num_agent_steps_trained": 37092}, "done": false, "episodes_total": 1035, "training_iteration": 60, "trial_id": "fe178_00005", "date": "2024-08-15_18-07-36", "timestamp": 1723766856, "time_this_iter_s": 53.43716239929199, "time_total_s": 4018.471596479416, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 355.5976586341858, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 25.25394736842105, "ram_util_percent": 11.531578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.073138892650604, "cur_kl_coeff": 0.158203125, "cur_lr": 0.00010000000000000003, "total_loss": 9.231093295415242, "policy_loss": 0.0028461482375860213, "vf_loss": 9.225435789426168, "vf_explained_var": 0.012504468858242034, "kl": 0.017770476189620348, "entropy": -1.0176295856634776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 37608, "num_env_steps_trained": 37608, "num_agent_steps_sampled": 37608, "num_agent_steps_trained": 37608}, "sampler_results": {"episode_reward_max": 356.6765736990227, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 308.31725862664763, "episode_len_mean": 49.20987654320987, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 3986, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3784226841521745, "mean_inference_ms": 1.2509580583262339, "mean_action_processing_ms": 0.2075217512275774, "mean_env_wait_ms": 530.6863110721139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01211225250620901, "StateBufferConnector_ms": 0.005997551812065972, "ViewRequirementAgentConnector_ms": 0.16603146070315514}, "num_episodes": 9, "episode_return_max": 356.6765736990227, "episode_return_min": 119.90144042968757, "episode_return_mean": 308.31725862664763}, "env_runner_results": {"episode_reward_max": 356.6765736990227, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 308.31725862664763, "episode_len_mean": 49.20987654320987, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 3986, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3784226841521745, "mean_inference_ms": 1.2509580583262339, "mean_action_processing_ms": 0.2075217512275774, "mean_env_wait_ms": 530.6863110721139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01211225250620901, "StateBufferConnector_ms": 0.005997551812065972, "ViewRequirementAgentConnector_ms": 0.16603146070315514}, "num_episodes": 9, "episode_return_max": 356.6765736990227, "episode_return_min": 119.90144042968757, "episode_return_mean": 308.31725862664763}, "episode_reward_max": 356.6765736990227, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 308.31725862664763, "episode_len_mean": 49.20987654320987, "episodes_this_iter": 9, "episodes_timesteps_total": 3986, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.3784226841521745, "mean_inference_ms": 1.2509580583262339, "mean_action_processing_ms": 0.2075217512275774, "mean_env_wait_ms": 530.6863110721139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01211225250620901, "StateBufferConnector_ms": 0.005997551812065972, "ViewRequirementAgentConnector_ms": 0.16603146070315514}, "num_episodes": 9, "episode_return_max": 356.6765736990227, "episode_return_min": 119.90144042968757, "episode_return_mean": 308.31725862664763, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37608, "num_agent_steps_trained": 37608, "num_env_steps_sampled": 37608, "num_env_steps_trained": 37608, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.262160701493054, "num_env_steps_trained_throughput_per_sec": 13.262160701493054, "timesteps_total": 37608, "num_env_steps_sampled_lifetime": 37608, "num_agent_steps_sampled_lifetime": 37608, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 37608, "timers": {"training_iteration_time_ms": 49310.373, "restore_workers_time_ms": 0.022, "training_step_time_ms": 49310.309, "sample_time_ms": 48276.59, "load_time_ms": 0.397, "load_throughput": 1298588.983, "learn_time_ms": 1019.829, "learn_throughput": 505.967, "synch_weights_time_ms": 13.209}, "counters": {"num_env_steps_sampled": 37608, "num_env_steps_trained": 37608, "num_agent_steps_sampled": 37608, "num_agent_steps_trained": 37608}, "done": false, "episodes_total": 1044, "training_iteration": 61, "trial_id": "fe178_00005", "date": "2024-08-15_18-08-15", "timestamp": 1723766895, "time_this_iter_s": 38.91118884086609, "time_total_s": 4057.382785320282, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 394.5088474750519, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 31.891071428571426, "ram_util_percent": 11.189285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.39845074812571, "cur_kl_coeff": 0.158203125, "cur_lr": 0.00010000000000000003, "total_loss": 9.090709964434305, "policy_loss": -0.008505341084674, "vf_loss": 9.095230849583944, "vf_explained_var": 0.01388184775908788, "kl": 0.02518566557458702, "entropy": -0.9664649367332458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 38124, "num_env_steps_trained": 38124, "num_agent_steps_sampled": 38124, "num_agent_steps_trained": 38124}, "sampler_results": {"episode_reward_max": 360.0253265090844, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 309.7990782400795, "episode_len_mean": 49.2967032967033, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4486, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.400070245037908, "mean_inference_ms": 1.2505146639807234, "mean_action_processing_ms": 0.2075788697192325, "mean_env_wait_ms": 528.8784891726195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0118255615234375, "StateBufferConnector_ms": 0.005995572268307864, "ViewRequirementAgentConnector_ms": 0.16607557024274552}, "num_episodes": 10, "episode_return_max": 360.0253265090844, "episode_return_min": 119.90144042968757, "episode_return_mean": 309.7990782400795}, "env_runner_results": {"episode_reward_max": 360.0253265090844, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 309.7990782400795, "episode_len_mean": 49.2967032967033, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4486, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.400070245037908, "mean_inference_ms": 1.2505146639807234, "mean_action_processing_ms": 0.2075788697192325, "mean_env_wait_ms": 528.8784891726195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0118255615234375, "StateBufferConnector_ms": 0.005995572268307864, "ViewRequirementAgentConnector_ms": 0.16607557024274552}, "num_episodes": 10, "episode_return_max": 360.0253265090844, "episode_return_min": 119.90144042968757, "episode_return_mean": 309.7990782400795}, "episode_reward_max": 360.0253265090844, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 309.7990782400795, "episode_len_mean": 49.2967032967033, "episodes_this_iter": 10, "episodes_timesteps_total": 4486, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [295.46679966683854, 329.6800129503171, 267.5703804496845, 339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.400070245037908, "mean_inference_ms": 1.2505146639807234, "mean_action_processing_ms": 0.2075788697192325, "mean_env_wait_ms": 528.8784891726195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0118255615234375, "StateBufferConnector_ms": 0.005995572268307864, "ViewRequirementAgentConnector_ms": 0.16607557024274552}, "num_episodes": 10, "episode_return_max": 360.0253265090844, "episode_return_min": 119.90144042968757, "episode_return_mean": 309.7990782400795, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38124, "num_agent_steps_trained": 38124, "num_env_steps_sampled": 38124, "num_env_steps_trained": 38124, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.71987675886266, "num_env_steps_trained_throughput_per_sec": 10.71987675886266, "timesteps_total": 38124, "num_env_steps_sampled_lifetime": 38124, "num_agent_steps_sampled_lifetime": 38124, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 38124, "timers": {"training_iteration_time_ms": 49179.764, "restore_workers_time_ms": 0.021, "training_step_time_ms": 49179.703, "sample_time_ms": 48189.586, "load_time_ms": 0.39, "load_throughput": 1322269.213, "learn_time_ms": 976.29, "learn_throughput": 528.531, "synch_weights_time_ms": 13.16}, "counters": {"num_env_steps_sampled": 38124, "num_env_steps_trained": 38124, "num_agent_steps_sampled": 38124, "num_agent_steps_trained": 38124}, "done": false, "episodes_total": 1054, "training_iteration": 62, "trial_id": "fe178_00005", "date": "2024-08-15_18-09-03", "timestamp": 1723766943, "time_this_iter_s": 48.138245820999146, "time_total_s": 4105.521031141281, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 442.647093296051, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 26.136231884057974, "ram_util_percent": 11.501449275362319}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.096174768606822, "cur_kl_coeff": 0.2373046875, "cur_lr": 0.00010000000000000003, "total_loss": 8.525161413351695, "policy_loss": -0.013795580179430545, "vf_loss": 8.537582723299662, "vf_explained_var": 0.03349593977133433, "kl": 0.005790815344762943, "entropy": -0.5947382435202598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "sampler_results": {"episode_reward_max": 360.0253265090844, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 306.9419136246913, "episode_len_mean": 49.15, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4915, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.466617310658905, "mean_inference_ms": 1.2499717568239876, "mean_action_processing_ms": 0.2075846532229911, "mean_env_wait_ms": 525.7575283209852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011691093444824219, "StateBufferConnector_ms": 0.0059795379638671875, "ViewRequirementAgentConnector_ms": 0.1658320426940918}, "num_episodes": 12, "episode_return_max": 360.0253265090844, "episode_return_min": 119.90144042968757, "episode_return_mean": 306.9419136246913}, "env_runner_results": {"episode_reward_max": 360.0253265090844, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 306.9419136246913, "episode_len_mean": 49.15, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4915, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.466617310658905, "mean_inference_ms": 1.2499717568239876, "mean_action_processing_ms": 0.2075846532229911, "mean_env_wait_ms": 525.7575283209852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011691093444824219, "StateBufferConnector_ms": 0.0059795379638671875, "ViewRequirementAgentConnector_ms": 0.1658320426940918}, "num_episodes": 12, "episode_return_max": 360.0253265090844, "episode_return_min": 119.90144042968757, "episode_return_mean": 306.9419136246913}, "episode_reward_max": 360.0253265090844, "episode_reward_min": 119.90144042968757, "episode_reward_mean": 306.9419136246913, "episode_len_mean": 49.15, "episodes_this_iter": 12, "episodes_timesteps_total": 4915, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [339.3417323910908, 334.07743113959, 315.0502957572796, 265.9720718967167, 265.73446651270916, 352.74072049644343, 332.45662918122326, 303.13852194138065, 328.5548458777413, 299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.466617310658905, "mean_inference_ms": 1.2499717568239876, "mean_action_processing_ms": 0.2075846532229911, "mean_env_wait_ms": 525.7575283209852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011691093444824219, "StateBufferConnector_ms": 0.0059795379638671875, "ViewRequirementAgentConnector_ms": 0.1658320426940918}, "num_episodes": 12, "episode_return_max": 360.0253265090844, "episode_return_min": 119.90144042968757, "episode_return_mean": 306.9419136246913, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640, "num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.048314514375162, "num_env_steps_trained_throughput_per_sec": 10.048314514375162, "timesteps_total": 38640, "num_env_steps_sampled_lifetime": 38640, "num_agent_steps_sampled_lifetime": 38640, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 38640, "timers": {"training_iteration_time_ms": 49396.978, "restore_workers_time_ms": 0.02, "training_step_time_ms": 49396.92, "sample_time_ms": 48437.595, "load_time_ms": 0.382, "load_throughput": 1352493.978, "learn_time_ms": 945.434, "learn_throughput": 545.781, "synch_weights_time_ms": 13.234}, "counters": {"num_env_steps_sampled": 38640, "num_env_steps_trained": 38640, "num_agent_steps_sampled": 38640, "num_agent_steps_trained": 38640}, "done": false, "episodes_total": 1066, "training_iteration": 63, "trial_id": "fe178_00005", "date": "2024-08-15_18-09-55", "timestamp": 1723766995, "time_this_iter_s": 51.3554253578186, "time_total_s": 4156.8764564991, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 494.00251865386963, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.476712328767125, "ram_util_percent": 11.494520547945204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.684598390261332, "cur_kl_coeff": 0.2373046875, "cur_lr": 0.00010000000000000003, "total_loss": 8.756285246213277, "policy_loss": -0.006440617012170454, "vf_loss": 8.761121900876363, "vf_explained_var": 0.09903073310852051, "kl": 0.006759121558815576, "entropy": -0.6704093712071578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 39156, "num_env_steps_trained": 39156, "num_agent_steps_sampled": 39156, "num_agent_steps_trained": 39156}, "sampler_results": {"episode_reward_max": 360.0253265090844, "episode_reward_min": 113.57988296948446, "episode_reward_mean": 303.63519958238857, "episode_len_mean": 48.87, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 4887, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.538654949065189, "mean_inference_ms": 1.2494116698617714, "mean_action_processing_ms": 0.20765233937442729, "mean_env_wait_ms": 525.0899801459994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01150965690612793, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.16679644584655762}, "num_episodes": 9, "episode_return_max": 360.0253265090844, "episode_return_min": 113.57988296948446, "episode_return_mean": 303.63519958238857}, "env_runner_results": {"episode_reward_max": 360.0253265090844, "episode_reward_min": 113.57988296948446, "episode_reward_mean": 303.63519958238857, "episode_len_mean": 48.87, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 4887, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.538654949065189, "mean_inference_ms": 1.2494116698617714, "mean_action_processing_ms": 0.20765233937442729, "mean_env_wait_ms": 525.0899801459994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01150965690612793, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.16679644584655762}, "num_episodes": 9, "episode_return_max": 360.0253265090844, "episode_return_min": 113.57988296948446, "episode_return_mean": 303.63519958238857}, "episode_reward_max": 360.0253265090844, "episode_reward_min": 113.57988296948446, "episode_reward_mean": 303.63519958238857, "episode_len_mean": 48.87, "episodes_this_iter": 9, "episodes_timesteps_total": 4887, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [299.52391119329326, 328.42481191850766, 318.13998713766506, 338.9568796972105, 330.1029873796746, 349.0068525543752, 323.6868989914221, 297.7006699414381, 340.23767153866737, 352.37589600267484, 271.07859967186835, 270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.538654949065189, "mean_inference_ms": 1.2494116698617714, "mean_action_processing_ms": 0.20765233937442729, "mean_env_wait_ms": 525.0899801459994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01150965690612793, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.16679644584655762}, "num_episodes": 9, "episode_return_max": 360.0253265090844, "episode_return_min": 113.57988296948446, "episode_return_mean": 303.63519958238857, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39156, "num_agent_steps_trained": 39156, "num_env_steps_sampled": 39156, "num_env_steps_trained": 39156, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.465415785757996, "num_env_steps_trained_throughput_per_sec": 9.465415785757996, "timesteps_total": 39156, "num_env_steps_sampled_lifetime": 39156, "num_agent_steps_sampled_lifetime": 39156, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 39156, "timers": {"training_iteration_time_ms": 49097.293, "restore_workers_time_ms": 0.02, "training_step_time_ms": 49097.236, "sample_time_ms": 48434.907, "load_time_ms": 0.324, "load_throughput": 1590666.518, "learn_time_ms": 648.558, "learn_throughput": 795.612, "synch_weights_time_ms": 13.197}, "counters": {"num_env_steps_sampled": 39156, "num_env_steps_trained": 39156, "num_agent_steps_sampled": 39156, "num_agent_steps_trained": 39156}, "done": false, "episodes_total": 1075, "training_iteration": 64, "trial_id": "fe178_00005", "date": "2024-08-15_18-10-49", "timestamp": 1723767049, "time_this_iter_s": 54.51790428161621, "time_total_s": 4211.394360780716, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 548.5204229354858, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 23.974358974358974, "ram_util_percent": 11.319230769230767}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.76842313806216, "cur_kl_coeff": 0.2373046875, "cur_lr": 0.00010000000000000003, "total_loss": 9.269854513804118, "policy_loss": -0.009197595862982173, "vf_loss": 9.278306380907695, "vf_explained_var": 0.03860585937897364, "kl": 0.0031425392981570136, "entropy": -0.9364496146639189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 39672, "num_env_steps_trained": 39672, "num_agent_steps_sampled": 39672, "num_agent_steps_trained": 39672}, "sampler_results": {"episode_reward_max": 360.0253265090844, "episode_reward_min": 113.57988296948446, "episode_reward_mean": 302.5993900876583, "episode_len_mean": 48.85, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4885, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506, 334.8284916264004, 286.1751772502207, 282.28092120280786, 298.4195406996352, 252.84905134433222, 358.64993100746017, 339.97989870078885, 300.8158444251178, 359.68259733658914, 312.72135965478134, 319.25140330563204], "episode_lengths": [50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.56833186294199, "mean_inference_ms": 1.2488370965667273, "mean_action_processing_ms": 0.20778995070304673, "mean_env_wait_ms": 526.1170834050805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011065244674682617, "StateBufferConnector_ms": 0.006019115447998047, "ViewRequirementAgentConnector_ms": 0.16695499420166016}, "num_episodes": 11, "episode_return_max": 360.0253265090844, "episode_return_min": 113.57988296948446, "episode_return_mean": 302.5993900876583}, "env_runner_results": {"episode_reward_max": 360.0253265090844, "episode_reward_min": 113.57988296948446, "episode_reward_mean": 302.5993900876583, "episode_len_mean": 48.85, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4885, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506, 334.8284916264004, 286.1751772502207, 282.28092120280786, 298.4195406996352, 252.84905134433222, 358.64993100746017, 339.97989870078885, 300.8158444251178, 359.68259733658914, 312.72135965478134, 319.25140330563204], "episode_lengths": [50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.56833186294199, "mean_inference_ms": 1.2488370965667273, "mean_action_processing_ms": 0.20778995070304673, "mean_env_wait_ms": 526.1170834050805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011065244674682617, "StateBufferConnector_ms": 0.006019115447998047, "ViewRequirementAgentConnector_ms": 0.16695499420166016}, "num_episodes": 11, "episode_return_max": 360.0253265090844, "episode_return_min": 113.57988296948446, "episode_return_mean": 302.5993900876583}, "episode_reward_max": 360.0253265090844, "episode_reward_min": 113.57988296948446, "episode_reward_mean": 302.5993900876583, "episode_len_mean": 48.85, "episodes_this_iter": 11, "episodes_timesteps_total": 4885, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [270.1714398893592, 319.120751438737, 288.27301529384243, 314.9918910954673, 322.25126450046616, 235.42787919414803, 119.90144042968757, 304.2971110191997, 296.73581872056326, 305.79732174849477, 334.18787869872176, 282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506, 334.8284916264004, 286.1751772502207, 282.28092120280786, 298.4195406996352, 252.84905134433222, 358.64993100746017, 339.97989870078885, 300.8158444251178, 359.68259733658914, 312.72135965478134, 319.25140330563204], "episode_lengths": [50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.56833186294199, "mean_inference_ms": 1.2488370965667273, "mean_action_processing_ms": 0.20778995070304673, "mean_env_wait_ms": 526.1170834050805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011065244674682617, "StateBufferConnector_ms": 0.006019115447998047, "ViewRequirementAgentConnector_ms": 0.16695499420166016}, "num_episodes": 11, "episode_return_max": 360.0253265090844, "episode_return_min": 113.57988296948446, "episode_return_mean": 302.5993900876583, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39672, "num_agent_steps_trained": 39672, "num_env_steps_sampled": 39672, "num_env_steps_trained": 39672, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.851758532368862, "num_env_steps_trained_throughput_per_sec": 10.851758532368862, "timesteps_total": 39672, "num_env_steps_sampled_lifetime": 39672, "num_agent_steps_sampled_lifetime": 39672, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 39672, "timers": {"training_iteration_time_ms": 49933.895, "restore_workers_time_ms": 0.019, "training_step_time_ms": 49933.839, "sample_time_ms": 49271.826, "load_time_ms": 0.317, "load_throughput": 1627019.143, "learn_time_ms": 648.205, "learn_throughput": 796.044, "synch_weights_time_ms": 13.241}, "counters": {"num_env_steps_sampled": 39672, "num_env_steps_trained": 39672, "num_agent_steps_sampled": 39672, "num_agent_steps_trained": 39672}, "done": false, "episodes_total": 1086, "training_iteration": 65, "trial_id": "fe178_00005", "date": "2024-08-15_18-11-37", "timestamp": 1723767097, "time_this_iter_s": 47.55493402481079, "time_total_s": 4258.949294805527, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 596.0753569602966, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.79705882352941, "ram_util_percent": 10.91764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.352008867263795, "cur_kl_coeff": 0.11865234375, "cur_lr": 0.00010000000000000003, "total_loss": 8.880692279338836, "policy_loss": 0.00018525608854057888, "vf_loss": 8.877924958864847, "vf_explained_var": 0.08152854094902674, "kl": 0.021762064879599714, "entropy": -0.9518346163133781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 40188, "num_env_steps_trained": 40188, "num_agent_steps_sampled": 40188, "num_agent_steps_trained": 40188}, "sampler_results": {"episode_reward_max": 368.7450449006847, "episode_reward_min": 113.57988296948446, "episode_reward_mean": 303.5963026763975, "episode_len_mean": 48.89, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4889, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506, 334.8284916264004, 286.1751772502207, 282.28092120280786, 298.4195406996352, 252.84905134433222, 358.64993100746017, 339.97989870078885, 300.8158444251178, 359.68259733658914, 312.72135965478134, 319.25140330563204, 291.0340444517919, 142.64143939119168, 287.9467998160716, 326.56827727114955, 282.3946417017666, 291.115092675337, 265.8310707915565, 326.3936755562044, 354.0866771018502, 274.0903072450031, 368.7450449006847], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.594685648800802, "mean_inference_ms": 1.2490756266311116, "mean_action_processing_ms": 0.20785736455582313, "mean_env_wait_ms": 524.8137395996737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010704994201660156, "StateBufferConnector_ms": 0.0060651302337646484, "ViewRequirementAgentConnector_ms": 0.16803860664367676}, "num_episodes": 11, "episode_return_max": 368.7450449006847, "episode_return_min": 113.57988296948446, "episode_return_mean": 303.5963026763975}, "env_runner_results": {"episode_reward_max": 368.7450449006847, "episode_reward_min": 113.57988296948446, "episode_reward_mean": 303.5963026763975, "episode_len_mean": 48.89, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4889, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506, 334.8284916264004, 286.1751772502207, 282.28092120280786, 298.4195406996352, 252.84905134433222, 358.64993100746017, 339.97989870078885, 300.8158444251178, 359.68259733658914, 312.72135965478134, 319.25140330563204, 291.0340444517919, 142.64143939119168, 287.9467998160716, 326.56827727114955, 282.3946417017666, 291.115092675337, 265.8310707915565, 326.3936755562044, 354.0866771018502, 274.0903072450031, 368.7450449006847], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.594685648800802, "mean_inference_ms": 1.2490756266311116, "mean_action_processing_ms": 0.20785736455582313, "mean_env_wait_ms": 524.8137395996737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010704994201660156, "StateBufferConnector_ms": 0.0060651302337646484, "ViewRequirementAgentConnector_ms": 0.16803860664367676}, "num_episodes": 11, "episode_return_max": 368.7450449006847, "episode_return_min": 113.57988296948446, "episode_return_mean": 303.5963026763975}, "episode_reward_max": 368.7450449006847, "episode_reward_min": 113.57988296948446, "episode_reward_mean": 303.5963026763975, "episode_len_mean": 48.89, "episodes_this_iter": 11, "episodes_timesteps_total": 4889, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [282.36075287474307, 323.4759266088397, 257.1815785612604, 337.41228182219044, 347.89152513484913, 313.8590508395847, 282.73704671737755, 295.8404199875144, 348.4591904344024, 264.1787922674511, 313.53183107498785, 318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506, 334.8284916264004, 286.1751772502207, 282.28092120280786, 298.4195406996352, 252.84905134433222, 358.64993100746017, 339.97989870078885, 300.8158444251178, 359.68259733658914, 312.72135965478134, 319.25140330563204, 291.0340444517919, 142.64143939119168, 287.9467998160716, 326.56827727114955, 282.3946417017666, 291.115092675337, 265.8310707915565, 326.3936755562044, 354.0866771018502, 274.0903072450031, 368.7450449006847], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.594685648800802, "mean_inference_ms": 1.2490756266311116, "mean_action_processing_ms": 0.20785736455582313, "mean_env_wait_ms": 524.8137395996737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010704994201660156, "StateBufferConnector_ms": 0.0060651302337646484, "ViewRequirementAgentConnector_ms": 0.16803860664367676}, "num_episodes": 11, "episode_return_max": 368.7450449006847, "episode_return_min": 113.57988296948446, "episode_return_mean": 303.5963026763975, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40188, "num_agent_steps_trained": 40188, "num_env_steps_sampled": 40188, "num_env_steps_trained": 40188, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 11.982671424978168, "num_env_steps_trained_throughput_per_sec": 11.982671424978168, "timesteps_total": 40188, "num_env_steps_sampled_lifetime": 40188, "num_agent_steps_sampled_lifetime": 40188, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 40188, "timers": {"training_iteration_time_ms": 49095.981, "restore_workers_time_ms": 0.017, "training_step_time_ms": 49095.93, "sample_time_ms": 48435.278, "load_time_ms": 0.316, "load_throughput": 1634514.662, "learn_time_ms": 646.927, "learn_throughput": 797.617, "synch_weights_time_ms": 13.167}, "counters": {"num_env_steps_sampled": 40188, "num_env_steps_trained": 40188, "num_agent_steps_sampled": 40188, "num_agent_steps_trained": 40188}, "done": false, "episodes_total": 1097, "training_iteration": 66, "trial_id": "fe178_00005", "date": "2024-08-15_18-12-20", "timestamp": 1723767140, "time_this_iter_s": 43.066144943237305, "time_total_s": 4302.015439748764, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 639.1415019035339, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 30.557377049180328, "ram_util_percent": 11.595081967213115}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.21341714859009, "cur_kl_coeff": 0.177978515625, "cur_lr": 0.00010000000000000003, "total_loss": 9.339522178967794, "policy_loss": 0.003769647687052687, "vf_loss": 9.32773305575053, "vf_explained_var": -0.01660472502311071, "kl": 0.04505888562319988, "entropy": -1.2836434195439022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 40704, "num_env_steps_trained": 40704, "num_agent_steps_sampled": 40704, "num_agent_steps_trained": 40704}, "sampler_results": {"episode_reward_max": 368.7450449006847, "episode_reward_min": 113.57988296948446, "episode_reward_mean": 306.4370878744865, "episode_len_mean": 48.89, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4889, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506, 334.8284916264004, 286.1751772502207, 282.28092120280786, 298.4195406996352, 252.84905134433222, 358.64993100746017, 339.97989870078885, 300.8158444251178, 359.68259733658914, 312.72135965478134, 319.25140330563204, 291.0340444517919, 142.64143939119168, 287.9467998160716, 326.56827727114955, 282.3946417017666, 291.115092675337, 265.8310707915565, 326.3936755562044, 354.0866771018502, 274.0903072450031, 368.7450449006847, 357.8996595935552, 346.7170730851048, 322.337471287554, 321.3189263333243, 340.0775621782363, 361.6534879296922, 351.43621519976443, 310.1021739232258, 272.02755085877413, 334.02779462098096, 333.4090011218856], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.619754980065693, "mean_inference_ms": 1.2487435054950347, "mean_action_processing_ms": 0.20786190663320972, "mean_env_wait_ms": 522.7219364262554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010373830795288086, "StateBufferConnector_ms": 0.006092071533203125, "ViewRequirementAgentConnector_ms": 0.1683194637298584}, "num_episodes": 11, "episode_return_max": 368.7450449006847, "episode_return_min": 113.57988296948446, "episode_return_mean": 306.4370878744865}, "env_runner_results": {"episode_reward_max": 368.7450449006847, "episode_reward_min": 113.57988296948446, "episode_reward_mean": 306.4370878744865, "episode_len_mean": 48.89, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4889, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506, 334.8284916264004, 286.1751772502207, 282.28092120280786, 298.4195406996352, 252.84905134433222, 358.64993100746017, 339.97989870078885, 300.8158444251178, 359.68259733658914, 312.72135965478134, 319.25140330563204, 291.0340444517919, 142.64143939119168, 287.9467998160716, 326.56827727114955, 282.3946417017666, 291.115092675337, 265.8310707915565, 326.3936755562044, 354.0866771018502, 274.0903072450031, 368.7450449006847, 357.8996595935552, 346.7170730851048, 322.337471287554, 321.3189263333243, 340.0775621782363, 361.6534879296922, 351.43621519976443, 310.1021739232258, 272.02755085877413, 334.02779462098096, 333.4090011218856], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.619754980065693, "mean_inference_ms": 1.2487435054950347, "mean_action_processing_ms": 0.20786190663320972, "mean_env_wait_ms": 522.7219364262554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010373830795288086, "StateBufferConnector_ms": 0.006092071533203125, "ViewRequirementAgentConnector_ms": 0.1683194637298584}, "num_episodes": 11, "episode_return_max": 368.7450449006847, "episode_return_min": 113.57988296948446, "episode_return_mean": 306.4370878744865}, "episode_reward_max": 368.7450449006847, "episode_reward_min": 113.57988296948446, "episode_reward_mean": 306.4370878744865, "episode_len_mean": 48.89, "episodes_this_iter": 11, "episodes_timesteps_total": 4889, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [318.03424354845674, 323.67323474883716, 356.6383388167721, 320.65089242791316, 356.4239039814611, 244.08348544037528, 335.73956130160667, 314.4029125525168, 295.422822074246, 342.28594585876726, 356.6765736990227, 326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506, 334.8284916264004, 286.1751772502207, 282.28092120280786, 298.4195406996352, 252.84905134433222, 358.64993100746017, 339.97989870078885, 300.8158444251178, 359.68259733658914, 312.72135965478134, 319.25140330563204, 291.0340444517919, 142.64143939119168, 287.9467998160716, 326.56827727114955, 282.3946417017666, 291.115092675337, 265.8310707915565, 326.3936755562044, 354.0866771018502, 274.0903072450031, 368.7450449006847, 357.8996595935552, 346.7170730851048, 322.337471287554, 321.3189263333243, 340.0775621782363, 361.6534879296922, 351.43621519976443, 310.1021739232258, 272.02755085877413, 334.02779462098096, 333.4090011218856], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.619754980065693, "mean_inference_ms": 1.2487435054950347, "mean_action_processing_ms": 0.20786190663320972, "mean_env_wait_ms": 522.7219364262554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010373830795288086, "StateBufferConnector_ms": 0.006092071533203125, "ViewRequirementAgentConnector_ms": 0.1683194637298584}, "num_episodes": 11, "episode_return_max": 368.7450449006847, "episode_return_min": 113.57988296948446, "episode_return_mean": 306.4370878744865, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40704, "num_agent_steps_trained": 40704, "num_env_steps_sampled": 40704, "num_env_steps_trained": 40704, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.569264440056987, "num_env_steps_trained_throughput_per_sec": 9.569264440056987, "timesteps_total": 40704, "num_env_steps_sampled_lifetime": 40704, "num_agent_steps_sampled_lifetime": 40704, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 40704, "timers": {"training_iteration_time_ms": 49151.988, "restore_workers_time_ms": 0.017, "training_step_time_ms": 49151.939, "sample_time_ms": 48472.492, "load_time_ms": 0.322, "load_throughput": 1603750.177, "learn_time_ms": 665.666, "learn_throughput": 775.164, "synch_weights_time_ms": 13.214}, "counters": {"num_env_steps_sampled": 40704, "num_env_steps_trained": 40704, "num_agent_steps_sampled": 40704, "num_agent_steps_trained": 40704}, "done": false, "episodes_total": 1108, "training_iteration": 67, "trial_id": "fe178_00005", "date": "2024-08-15_18-13-14", "timestamp": 1723767194, "time_this_iter_s": 53.92610239982605, "time_total_s": 4355.94154214859, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 693.06760430336, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.9051282051282, "ram_util_percent": 11.646153846153851}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.133792511622111, "cur_kl_coeff": 0.2669677734375, "cur_lr": 0.00010000000000000003, "total_loss": 9.332584110895793, "policy_loss": -0.0022017853489766518, "vf_loss": 9.33289573987325, "vf_explained_var": 0.06607663333415985, "kl": 0.007079937676707885, "entropy": -0.9387352700034778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 41220, "num_env_steps_trained": 41220, "num_agent_steps_sampled": 41220, "num_agent_steps_trained": 41220}, "sampler_results": {"episode_reward_max": 368.7450449006847, "episode_reward_min": 94.9578942865333, "episode_reward_mean": 301.34231517540456, "episode_len_mean": 48.29, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4829, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506, 334.8284916264004, 286.1751772502207, 282.28092120280786, 298.4195406996352, 252.84905134433222, 358.64993100746017, 339.97989870078885, 300.8158444251178, 359.68259733658914, 312.72135965478134, 319.25140330563204, 291.0340444517919, 142.64143939119168, 287.9467998160716, 326.56827727114955, 282.3946417017666, 291.115092675337, 265.8310707915565, 326.3936755562044, 354.0866771018502, 274.0903072450031, 368.7450449006847, 357.8996595935552, 346.7170730851048, 322.337471287554, 321.3189263333243, 340.0775621782363, 361.6534879296922, 351.43621519976443, 310.1021739232258, 272.02755085877413, 334.02779462098096, 333.4090011218856, 335.631070898093, 94.9578942865333, 302.7090111956152, 120.46177755009819, 300.29651682556295, 284.88946566768857, 328.6687948711085, 355.3162216127159, 315.06049381276205, 275.252322949646, 341.3110748719528], "episode_lengths": [50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 23, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.636349851023251, "mean_inference_ms": 1.2483533801781723, "mean_action_processing_ms": 0.20779033457224322, "mean_env_wait_ms": 520.6968172646853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010097026824951172, "StateBufferConnector_ms": 0.006129026412963867, "ViewRequirementAgentConnector_ms": 0.16884708404541016}, "num_episodes": 11, "episode_return_max": 368.7450449006847, "episode_return_min": 94.9578942865333, "episode_return_mean": 301.34231517540456}, "env_runner_results": {"episode_reward_max": 368.7450449006847, "episode_reward_min": 94.9578942865333, "episode_reward_mean": 301.34231517540456, "episode_len_mean": 48.29, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4829, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506, 334.8284916264004, 286.1751772502207, 282.28092120280786, 298.4195406996352, 252.84905134433222, 358.64993100746017, 339.97989870078885, 300.8158444251178, 359.68259733658914, 312.72135965478134, 319.25140330563204, 291.0340444517919, 142.64143939119168, 287.9467998160716, 326.56827727114955, 282.3946417017666, 291.115092675337, 265.8310707915565, 326.3936755562044, 354.0866771018502, 274.0903072450031, 368.7450449006847, 357.8996595935552, 346.7170730851048, 322.337471287554, 321.3189263333243, 340.0775621782363, 361.6534879296922, 351.43621519976443, 310.1021739232258, 272.02755085877413, 334.02779462098096, 333.4090011218856, 335.631070898093, 94.9578942865333, 302.7090111956152, 120.46177755009819, 300.29651682556295, 284.88946566768857, 328.6687948711085, 355.3162216127159, 315.06049381276205, 275.252322949646, 341.3110748719528], "episode_lengths": [50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 23, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.636349851023251, "mean_inference_ms": 1.2483533801781723, "mean_action_processing_ms": 0.20779033457224322, "mean_env_wait_ms": 520.6968172646853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010097026824951172, "StateBufferConnector_ms": 0.006129026412963867, "ViewRequirementAgentConnector_ms": 0.16884708404541016}, "num_episodes": 11, "episode_return_max": 368.7450449006847, "episode_return_min": 94.9578942865333, "episode_return_mean": 301.34231517540456}, "episode_reward_max": 368.7450449006847, "episode_reward_min": 94.9578942865333, "episode_reward_mean": 301.34231517540456, "episode_len_mean": 48.29, "episodes_this_iter": 11, "episodes_timesteps_total": 4829, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [326.8114131926399, 189.4594216335953, 284.64803920235414, 267.50219573643, 340.0665285766275, 173.05862542488984, 339.929523950587, 353.7672973632816, 335.7770810762424, 319.55721518911804, 324.22078320092515, 318.9277384679007, 348.4992957066908, 321.91845035926264, 241.0728246136514, 307.78089248384515, 299.5109880406594, 330.4604940500577, 329.1185653674778, 341.61411559822744, 337.9808243568049, 288.387076880001, 343.1402962839553, 268.10713856407637, 321.245926349481, 277.5568503532239, 267.72248796902875, 346.8241214845122, 295.7276684156129, 333.7113359034516, 347.3475357162694, 360.0253265090844, 314.2341761537759, 337.24491812906393, 337.62375045475545, 345.89330178254033, 277.23856431215944, 202.68507874404634, 278.82381995644937, 311.97718814407546, 346.7822220778063, 268.81877247678915, 291.3935010182998, 297.3683530244554, 296.1882080078126, 171.69821392735173, 306.32521221694935, 311.48174222829925, 263.6771696177618, 330.26822811499375, 281.8399968257865, 329.1780675115573, 260.5768914228265, 297.4806429059479, 113.57988296948446, 318.3126893672506, 334.8284916264004, 286.1751772502207, 282.28092120280786, 298.4195406996352, 252.84905134433222, 358.64993100746017, 339.97989870078885, 300.8158444251178, 359.68259733658914, 312.72135965478134, 319.25140330563204, 291.0340444517919, 142.64143939119168, 287.9467998160716, 326.56827727114955, 282.3946417017666, 291.115092675337, 265.8310707915565, 326.3936755562044, 354.0866771018502, 274.0903072450031, 368.7450449006847, 357.8996595935552, 346.7170730851048, 322.337471287554, 321.3189263333243, 340.0775621782363, 361.6534879296922, 351.43621519976443, 310.1021739232258, 272.02755085877413, 334.02779462098096, 333.4090011218856, 335.631070898093, 94.9578942865333, 302.7090111956152, 120.46177755009819, 300.29651682556295, 284.88946566768857, 328.6687948711085, 355.3162216127159, 315.06049381276205, 275.252322949646, 341.3110748719528], "episode_lengths": [50, 35, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 23, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.636349851023251, "mean_inference_ms": 1.2483533801781723, "mean_action_processing_ms": 0.20779033457224322, "mean_env_wait_ms": 520.6968172646853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010097026824951172, "StateBufferConnector_ms": 0.006129026412963867, "ViewRequirementAgentConnector_ms": 0.16884708404541016}, "num_episodes": 11, "episode_return_max": 368.7450449006847, "episode_return_min": 94.9578942865333, "episode_return_mean": 301.34231517540456, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41220, "num_agent_steps_trained": 41220, "num_env_steps_sampled": 41220, "num_env_steps_trained": 41220, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.18191771342144, "num_env_steps_trained_throughput_per_sec": 10.18191771342144, "timesteps_total": 41220, "num_env_steps_sampled_lifetime": 41220, "num_agent_steps_sampled_lifetime": 41220, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 41220, "timers": {"training_iteration_time_ms": 49030.898, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49030.851, "sample_time_ms": 48348.101, "load_time_ms": 0.322, "load_throughput": 1601613.901, "learn_time_ms": 669.03, "learn_throughput": 771.266, "synch_weights_time_ms": 13.16}, "counters": {"num_env_steps_sampled": 41220, "num_env_steps_trained": 41220, "num_agent_steps_sampled": 41220, "num_agent_steps_trained": 41220}, "done": false, "episodes_total": 1119, "training_iteration": 68, "trial_id": "fe178_00005", "date": "2024-08-15_18-14-05", "timestamp": 1723767245, "time_this_iter_s": 50.68158006668091, "time_total_s": 4406.623122215271, "pid": 70524, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.014179447736956619, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7815057201921056, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 743.7491843700409, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 26.072222222222223, "ram_util_percent": 11.711111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.386515989899635, "cur_kl_coeff": 0.2373046875, "cur_lr": 0.0005000000000000002, "total_loss": 8.599822177489598, "policy_loss": -0.006921076634898782, "vf_loss": 8.60231166680654, "vf_explained_var": 0.05279302994410197, "kl": 0.018674656366542204, "entropy": -0.8690902726724744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 39654, "num_env_steps_trained": 39654, "num_agent_steps_sampled": 39654, "num_agent_steps_trained": 39654}, "sampler_results": {"episode_reward_max": 359.69938226035833, "episode_reward_min": 112.85616455078139, "episode_reward_mean": 285.2277592239439, "episode_len_mean": 47.10526315789474, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 895, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.4124556098842, 323.690388707065, 297.6884802867252, 301.09829671316686, 228.73782137765016, 344.1694001148205, 359.69938226035833, 317.1748743172233, 286.44672488964216, 334.9285478180274, 266.3252798479179, 233.46469276535248, 134.04191894531243, 336.85215156230447, 262.50309670320286, 288.7803683490627, 357.48698904845577, 356.97039138798146, 112.85616455078139], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.42157392315065, "mean_inference_ms": 1.2491626284259623, "mean_action_processing_ms": 0.2060807612126139, "mean_env_wait_ms": 544.0681966311198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01129351164165296, "StateBufferConnector_ms": 0.005927838777240954, "ViewRequirementAgentConnector_ms": 0.16438459095201993}, "num_episodes": 19, "episode_return_max": 359.69938226035833, "episode_return_min": 112.85616455078139, "episode_return_mean": 285.2277592239439}, "env_runner_results": {"episode_reward_max": 359.69938226035833, "episode_reward_min": 112.85616455078139, "episode_reward_mean": 285.2277592239439, "episode_len_mean": 47.10526315789474, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 895, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.4124556098842, 323.690388707065, 297.6884802867252, 301.09829671316686, 228.73782137765016, 344.1694001148205, 359.69938226035833, 317.1748743172233, 286.44672488964216, 334.9285478180274, 266.3252798479179, 233.46469276535248, 134.04191894531243, 336.85215156230447, 262.50309670320286, 288.7803683490627, 357.48698904845577, 356.97039138798146, 112.85616455078139], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.42157392315065, "mean_inference_ms": 1.2491626284259623, "mean_action_processing_ms": 0.2060807612126139, "mean_env_wait_ms": 544.0681966311198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01129351164165296, "StateBufferConnector_ms": 0.005927838777240954, "ViewRequirementAgentConnector_ms": 0.16438459095201993}, "num_episodes": 19, "episode_return_max": 359.69938226035833, "episode_return_min": 112.85616455078139, "episode_return_mean": 285.2277592239439}, "episode_reward_max": 359.69938226035833, "episode_reward_min": 112.85616455078139, "episode_reward_mean": 285.2277592239439, "episode_len_mean": 47.10526315789474, "episodes_this_iter": 19, "episodes_timesteps_total": 895, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [276.4124556098842, 323.690388707065, 297.6884802867252, 301.09829671316686, 228.73782137765016, 344.1694001148205, 359.69938226035833, 317.1748743172233, 286.44672488964216, 334.9285478180274, 266.3252798479179, 233.46469276535248, 134.04191894531243, 336.85215156230447, 262.50309670320286, 288.7803683490627, 357.48698904845577, 356.97039138798146, 112.85616455078139], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.42157392315065, "mean_inference_ms": 1.2491626284259623, "mean_action_processing_ms": 0.2060807612126139, "mean_env_wait_ms": 544.0681966311198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01129351164165296, "StateBufferConnector_ms": 0.005927838777240954, "ViewRequirementAgentConnector_ms": 0.16438459095201993}, "num_episodes": 19, "episode_return_max": 359.69938226035833, "episode_return_min": 112.85616455078139, "episode_return_mean": 285.2277592239439, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39654, "num_agent_steps_trained": 39654, "num_env_steps_sampled": 39654, "num_env_steps_trained": 39654, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.484093783745998, "num_env_steps_trained_throughput_per_sec": 9.484093783745998, "timesteps_total": 39654, "num_env_steps_sampled_lifetime": 39654, "num_agent_steps_sampled_lifetime": 39654, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 39654, "timers": {"training_iteration_time_ms": 108181.147, "restore_workers_time_ms": 0.021, "training_step_time_ms": 108181.08, "sample_time_ms": 100356.172, "load_time_ms": 0.851, "load_throughput": 1205084.263, "learn_time_ms": 7810.132, "learn_throughput": 131.368, "synch_weights_time_ms": 13.377}, "counters": {"num_env_steps_sampled": 39654, "num_env_steps_trained": 39654, "num_agent_steps_sampled": 39654, "num_agent_steps_trained": 39654}, "done": false, "episodes_total": 1079, "training_iteration": 62, "trial_id": "fe178_00005", "date": "2024-08-15_18-16-11", "timestamp": 1723767371, "time_this_iter_s": 108.18462252616882, "time_total_s": 4275.48616361618, "pid": 59880, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3509230216596316, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7502454913844214, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 108.18462252616882, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.29612903225807, "ram_util_percent": 11.183225806451613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.437734426061313, "cur_kl_coeff": 0.2373046875, "cur_lr": 0.0005000000000000002, "total_loss": 9.058631032705307, "policy_loss": -0.011176120322973777, "vf_loss": 9.068100839853287, "vf_explained_var": 0.03211975420514743, "kl": 0.007190248685948886, "entropy": -1.061704043050607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 40680, "num_env_steps_trained": 40680, "num_agent_steps_sampled": 40680, "num_agent_steps_trained": 40680}, "sampler_results": {"episode_reward_max": 359.69938226035833, "episode_reward_min": 112.85616455078139, "episode_reward_mean": 299.29801263507784, "episode_len_mean": 47.97435897435897, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 1871, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.4124556098842, 323.690388707065, 297.6884802867252, 301.09829671316686, 228.73782137765016, 344.1694001148205, 359.69938226035833, 317.1748743172233, 286.44672488964216, 334.9285478180274, 266.3252798479179, 233.46469276535248, 134.04191894531243, 336.85215156230447, 262.50309670320286, 288.7803683490627, 357.48698904845577, 356.97039138798146, 112.85616455078139, 326.3172495797313, 279.6277679198577, 352.04797686108486, 301.2965542923934, 341.7451305852827, 349.389638779523, 150.47788947681482, 344.4141070461193, 339.699681879929, 326.7858812645594, 295.6043740512702, 294.3168261879068, 272.8495658390376, 337.57906556607134, 321.6684078725133, 311.7519179130896, 326.16528724656416, 352.36386112554817, 329.12701555425406, 300.06686847155026], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.45223149651856, "mean_inference_ms": 1.2494458510526532, "mean_action_processing_ms": 0.20576361162169582, "mean_env_wait_ms": 536.204817907747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01165927984775641, "StateBufferConnector_ms": 0.005974525060409155, "ViewRequirementAgentConnector_ms": 0.16577916267590645}, "num_episodes": 20, "episode_return_max": 359.69938226035833, "episode_return_min": 112.85616455078139, "episode_return_mean": 299.29801263507784}, "env_runner_results": {"episode_reward_max": 359.69938226035833, "episode_reward_min": 112.85616455078139, "episode_reward_mean": 299.29801263507784, "episode_len_mean": 47.97435897435897, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 1871, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.4124556098842, 323.690388707065, 297.6884802867252, 301.09829671316686, 228.73782137765016, 344.1694001148205, 359.69938226035833, 317.1748743172233, 286.44672488964216, 334.9285478180274, 266.3252798479179, 233.46469276535248, 134.04191894531243, 336.85215156230447, 262.50309670320286, 288.7803683490627, 357.48698904845577, 356.97039138798146, 112.85616455078139, 326.3172495797313, 279.6277679198577, 352.04797686108486, 301.2965542923934, 341.7451305852827, 349.389638779523, 150.47788947681482, 344.4141070461193, 339.699681879929, 326.7858812645594, 295.6043740512702, 294.3168261879068, 272.8495658390376, 337.57906556607134, 321.6684078725133, 311.7519179130896, 326.16528724656416, 352.36386112554817, 329.12701555425406, 300.06686847155026], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.45223149651856, "mean_inference_ms": 1.2494458510526532, "mean_action_processing_ms": 0.20576361162169582, "mean_env_wait_ms": 536.204817907747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01165927984775641, "StateBufferConnector_ms": 0.005974525060409155, "ViewRequirementAgentConnector_ms": 0.16577916267590645}, "num_episodes": 20, "episode_return_max": 359.69938226035833, "episode_return_min": 112.85616455078139, "episode_return_mean": 299.29801263507784}, "episode_reward_max": 359.69938226035833, "episode_reward_min": 112.85616455078139, "episode_reward_mean": 299.29801263507784, "episode_len_mean": 47.97435897435897, "episodes_this_iter": 20, "episodes_timesteps_total": 1871, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [276.4124556098842, 323.690388707065, 297.6884802867252, 301.09829671316686, 228.73782137765016, 344.1694001148205, 359.69938226035833, 317.1748743172233, 286.44672488964216, 334.9285478180274, 266.3252798479179, 233.46469276535248, 134.04191894531243, 336.85215156230447, 262.50309670320286, 288.7803683490627, 357.48698904845577, 356.97039138798146, 112.85616455078139, 326.3172495797313, 279.6277679198577, 352.04797686108486, 301.2965542923934, 341.7451305852827, 349.389638779523, 150.47788947681482, 344.4141070461193, 339.699681879929, 326.7858812645594, 295.6043740512702, 294.3168261879068, 272.8495658390376, 337.57906556607134, 321.6684078725133, 311.7519179130896, 326.16528724656416, 352.36386112554817, 329.12701555425406, 300.06686847155026], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.45223149651856, "mean_inference_ms": 1.2494458510526532, "mean_action_processing_ms": 0.20576361162169582, "mean_env_wait_ms": 536.204817907747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01165927984775641, "StateBufferConnector_ms": 0.005974525060409155, "ViewRequirementAgentConnector_ms": 0.16577916267590645}, "num_episodes": 20, "episode_return_max": 359.69938226035833, "episode_return_min": 112.85616455078139, "episode_return_mean": 299.29801263507784, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40680, "num_agent_steps_trained": 40680, "num_env_steps_sampled": 40680, "num_env_steps_trained": 40680, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.979513319930941, "num_env_steps_trained_throughput_per_sec": 9.979513319930941, "timesteps_total": 40680, "num_env_steps_sampled_lifetime": 40680, "num_agent_steps_sampled_lifetime": 40680, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 40680, "timers": {"training_iteration_time_ms": 105495.891, "restore_workers_time_ms": 0.019, "training_step_time_ms": 105495.828, "sample_time_ms": 100938.581, "load_time_ms": 0.625, "load_throughput": 1641875.583, "learn_time_ms": 4542.873, "learn_throughput": 225.848, "synch_weights_time_ms": 13.293}, "counters": {"num_env_steps_sampled": 40680, "num_env_steps_trained": 40680, "num_agent_steps_sampled": 40680, "num_agent_steps_trained": 40680}, "done": false, "episodes_total": 1099, "training_iteration": 63, "trial_id": "fe178_00005", "date": "2024-08-15_18-17-54", "timestamp": 1723767474, "time_this_iter_s": 102.81416773796082, "time_total_s": 4378.300331354141, "pid": 59880, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3509230216596316, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7502454913844214, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 210.99879026412964, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 24.894520547945206, "ram_util_percent": 11.58767123287671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.751330769062044, "cur_kl_coeff": 0.2373046875, "cur_lr": 0.0005000000000000002, "total_loss": 8.60614448984464, "policy_loss": -0.012327940482646228, "vf_loss": 8.616144498189291, "vf_explained_var": 0.0990560161570708, "kl": 0.009809564602680136, "entropy": -0.8769453931599855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 41706, "num_env_steps_trained": 41706, "num_agent_steps_sampled": 41706, "num_agent_steps_trained": 41706}, "sampler_results": {"episode_reward_max": 369.42732059046944, "episode_reward_min": 98.04035332082712, "episode_reward_mean": 295.4172844161346, "episode_len_mean": 47.62903225806452, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 2953, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.4124556098842, 323.690388707065, 297.6884802867252, 301.09829671316686, 228.73782137765016, 344.1694001148205, 359.69938226035833, 317.1748743172233, 286.44672488964216, 334.9285478180274, 266.3252798479179, 233.46469276535248, 134.04191894531243, 336.85215156230447, 262.50309670320286, 288.7803683490627, 357.48698904845577, 356.97039138798146, 112.85616455078139, 326.3172495797313, 279.6277679198577, 352.04797686108486, 301.2965542923934, 341.7451305852827, 349.389638779523, 150.47788947681482, 344.4141070461193, 339.699681879929, 326.7858812645594, 295.6043740512702, 294.3168261879068, 272.8495658390376, 337.57906556607134, 321.6684078725133, 311.7519179130896, 326.16528724656416, 352.36386112554817, 329.12701555425406, 300.06686847155026, 283.70403756918057, 279.12319911788944, 356.8263101845705, 248.64301532711028, 369.42732059046944, 271.79071064805197, 326.0807624603583, 322.8178799255138, 262.67903181943376, 350.07210460779083, 306.26084849140074, 354.4208779909484, 311.06443306504417, 291.40787448306355, 350.64927394977946, 134.54416273395844, 307.40797750525024, 359.7261272058424, 98.04035332082712, 220.70164078316378, 355.75656248606424, 328.1810216476214, 153.92361511896706], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 23, 46, 50, 50, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.534978857125958, "mean_inference_ms": 1.2509468388276899, "mean_action_processing_ms": 0.20605328244033977, "mean_env_wait_ms": 527.735906823457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011759035048946258, "StateBufferConnector_ms": 0.006029682774697581, "ViewRequirementAgentConnector_ms": 0.16656344936740014}, "num_episodes": 23, "episode_return_max": 369.42732059046944, "episode_return_min": 98.04035332082712, "episode_return_mean": 295.4172844161346}, "env_runner_results": {"episode_reward_max": 369.42732059046944, "episode_reward_min": 98.04035332082712, "episode_reward_mean": 295.4172844161346, "episode_len_mean": 47.62903225806452, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 2953, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.4124556098842, 323.690388707065, 297.6884802867252, 301.09829671316686, 228.73782137765016, 344.1694001148205, 359.69938226035833, 317.1748743172233, 286.44672488964216, 334.9285478180274, 266.3252798479179, 233.46469276535248, 134.04191894531243, 336.85215156230447, 262.50309670320286, 288.7803683490627, 357.48698904845577, 356.97039138798146, 112.85616455078139, 326.3172495797313, 279.6277679198577, 352.04797686108486, 301.2965542923934, 341.7451305852827, 349.389638779523, 150.47788947681482, 344.4141070461193, 339.699681879929, 326.7858812645594, 295.6043740512702, 294.3168261879068, 272.8495658390376, 337.57906556607134, 321.6684078725133, 311.7519179130896, 326.16528724656416, 352.36386112554817, 329.12701555425406, 300.06686847155026, 283.70403756918057, 279.12319911788944, 356.8263101845705, 248.64301532711028, 369.42732059046944, 271.79071064805197, 326.0807624603583, 322.8178799255138, 262.67903181943376, 350.07210460779083, 306.26084849140074, 354.4208779909484, 311.06443306504417, 291.40787448306355, 350.64927394977946, 134.54416273395844, 307.40797750525024, 359.7261272058424, 98.04035332082712, 220.70164078316378, 355.75656248606424, 328.1810216476214, 153.92361511896706], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 23, 46, 50, 50, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.534978857125958, "mean_inference_ms": 1.2509468388276899, "mean_action_processing_ms": 0.20605328244033977, "mean_env_wait_ms": 527.735906823457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011759035048946258, "StateBufferConnector_ms": 0.006029682774697581, "ViewRequirementAgentConnector_ms": 0.16656344936740014}, "num_episodes": 23, "episode_return_max": 369.42732059046944, "episode_return_min": 98.04035332082712, "episode_return_mean": 295.4172844161346}, "episode_reward_max": 369.42732059046944, "episode_reward_min": 98.04035332082712, "episode_reward_mean": 295.4172844161346, "episode_len_mean": 47.62903225806452, "episodes_this_iter": 23, "episodes_timesteps_total": 2953, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [276.4124556098842, 323.690388707065, 297.6884802867252, 301.09829671316686, 228.73782137765016, 344.1694001148205, 359.69938226035833, 317.1748743172233, 286.44672488964216, 334.9285478180274, 266.3252798479179, 233.46469276535248, 134.04191894531243, 336.85215156230447, 262.50309670320286, 288.7803683490627, 357.48698904845577, 356.97039138798146, 112.85616455078139, 326.3172495797313, 279.6277679198577, 352.04797686108486, 301.2965542923934, 341.7451305852827, 349.389638779523, 150.47788947681482, 344.4141070461193, 339.699681879929, 326.7858812645594, 295.6043740512702, 294.3168261879068, 272.8495658390376, 337.57906556607134, 321.6684078725133, 311.7519179130896, 326.16528724656416, 352.36386112554817, 329.12701555425406, 300.06686847155026, 283.70403756918057, 279.12319911788944, 356.8263101845705, 248.64301532711028, 369.42732059046944, 271.79071064805197, 326.0807624603583, 322.8178799255138, 262.67903181943376, 350.07210460779083, 306.26084849140074, 354.4208779909484, 311.06443306504417, 291.40787448306355, 350.64927394977946, 134.54416273395844, 307.40797750525024, 359.7261272058424, 98.04035332082712, 220.70164078316378, 355.75656248606424, 328.1810216476214, 153.92361511896706], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 23, 46, 50, 50, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.534978857125958, "mean_inference_ms": 1.2509468388276899, "mean_action_processing_ms": 0.20605328244033977, "mean_env_wait_ms": 527.735906823457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011759035048946258, "StateBufferConnector_ms": 0.006029682774697581, "ViewRequirementAgentConnector_ms": 0.16656344936740014}, "num_episodes": 23, "episode_return_max": 369.42732059046944, "episode_return_min": 98.04035332082712, "episode_return_mean": 295.4172844161346, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41706, "num_agent_steps_trained": 41706, "num_env_steps_sampled": 41706, "num_env_steps_trained": 41706, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.284212806019363, "num_env_steps_trained_throughput_per_sec": 11.284212806019363, "timesteps_total": 41706, "num_env_steps_sampled_lifetime": 41706, "num_agent_steps_sampled_lifetime": 41706, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 41706, "timers": {"training_iteration_time_ms": 100638.428, "restore_workers_time_ms": 0.018, "training_step_time_ms": 100638.369, "sample_time_ms": 97223.662, "load_time_ms": 0.538, "load_throughput": 1907515.915, "learn_time_ms": 3400.712, "learn_throughput": 301.702, "synch_weights_time_ms": 13.067}, "counters": {"num_env_steps_sampled": 41706, "num_env_steps_trained": 41706, "num_agent_steps_sampled": 41706, "num_agent_steps_trained": 41706}, "done": false, "episodes_total": 1122, "training_iteration": 64, "trial_id": "fe178_00005", "date": "2024-08-15_18-19-25", "timestamp": 1723767565, "time_this_iter_s": 90.92675995826721, "time_total_s": 4469.227091312408, "pid": 59880, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3509230216596316, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7502454913844214, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 301.92555022239685, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.611538461538466, "ram_util_percent": 11.574615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.88689372142156, "cur_kl_coeff": 0.2373046875, "cur_lr": 0.0005000000000000002, "total_loss": 8.662671236197154, "policy_loss": -0.006199524375066782, "vf_loss": 8.666142702102661, "vf_explained_var": 0.10828958377242089, "kl": 0.011495754327674834, "entropy": -0.9453199451168378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 42732, "num_env_steps_trained": 42732, "num_agent_steps_sampled": 42732, "num_agent_steps_trained": 42732}, "sampler_results": {"episode_reward_max": 369.42732059046944, "episode_reward_min": 98.04035332082712, "episode_reward_mean": 295.4325567644131, "episode_len_mean": 47.63855421686747, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 3954, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.4124556098842, 323.690388707065, 297.6884802867252, 301.09829671316686, 228.73782137765016, 344.1694001148205, 359.69938226035833, 317.1748743172233, 286.44672488964216, 334.9285478180274, 266.3252798479179, 233.46469276535248, 134.04191894531243, 336.85215156230447, 262.50309670320286, 288.7803683490627, 357.48698904845577, 356.97039138798146, 112.85616455078139, 326.3172495797313, 279.6277679198577, 352.04797686108486, 301.2965542923934, 341.7451305852827, 349.389638779523, 150.47788947681482, 344.4141070461193, 339.699681879929, 326.7858812645594, 295.6043740512702, 294.3168261879068, 272.8495658390376, 337.57906556607134, 321.6684078725133, 311.7519179130896, 326.16528724656416, 352.36386112554817, 329.12701555425406, 300.06686847155026, 283.70403756918057, 279.12319911788944, 356.8263101845705, 248.64301532711028, 369.42732059046944, 271.79071064805197, 326.0807624603583, 322.8178799255138, 262.67903181943376, 350.07210460779083, 306.26084849140074, 354.4208779909484, 311.06443306504417, 291.40787448306355, 350.64927394977946, 134.54416273395844, 307.40797750525024, 359.7261272058424, 98.04035332082712, 220.70164078316378, 355.75656248606424, 328.1810216476214, 153.92361511896706, 259.8408854346943, 300.33495652364644, 119.79957719165384, 251.54918474778515, 341.5883509334422, 357.71755654190684, 302.9236741535387, 308.00241605970456, 318.7847445277266, 153.68474121093732, 328.2143147984698, 314.0362564458577, 320.1100111220632, 318.38659876488686, 316.0772873254288, 292.04874474107254, 342.88711775369967, 263.0201331168964, 359.5531125846205, 319.434791750633, 317.0361219172829], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 23, 46, 50, 50, 28, 50, 50, 23, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.576066921327557, "mean_inference_ms": 1.250938051955691, "mean_action_processing_ms": 0.2060489263450883, "mean_env_wait_ms": 524.7682449210457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011283231068806476, "StateBufferConnector_ms": 0.006000105156955949, "ViewRequirementAgentConnector_ms": 0.1665698476584561}, "num_episodes": 21, "episode_return_max": 369.42732059046944, "episode_return_min": 98.04035332082712, "episode_return_mean": 295.4325567644131}, "env_runner_results": {"episode_reward_max": 369.42732059046944, "episode_reward_min": 98.04035332082712, "episode_reward_mean": 295.4325567644131, "episode_len_mean": 47.63855421686747, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 3954, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.4124556098842, 323.690388707065, 297.6884802867252, 301.09829671316686, 228.73782137765016, 344.1694001148205, 359.69938226035833, 317.1748743172233, 286.44672488964216, 334.9285478180274, 266.3252798479179, 233.46469276535248, 134.04191894531243, 336.85215156230447, 262.50309670320286, 288.7803683490627, 357.48698904845577, 356.97039138798146, 112.85616455078139, 326.3172495797313, 279.6277679198577, 352.04797686108486, 301.2965542923934, 341.7451305852827, 349.389638779523, 150.47788947681482, 344.4141070461193, 339.699681879929, 326.7858812645594, 295.6043740512702, 294.3168261879068, 272.8495658390376, 337.57906556607134, 321.6684078725133, 311.7519179130896, 326.16528724656416, 352.36386112554817, 329.12701555425406, 300.06686847155026, 283.70403756918057, 279.12319911788944, 356.8263101845705, 248.64301532711028, 369.42732059046944, 271.79071064805197, 326.0807624603583, 322.8178799255138, 262.67903181943376, 350.07210460779083, 306.26084849140074, 354.4208779909484, 311.06443306504417, 291.40787448306355, 350.64927394977946, 134.54416273395844, 307.40797750525024, 359.7261272058424, 98.04035332082712, 220.70164078316378, 355.75656248606424, 328.1810216476214, 153.92361511896706, 259.8408854346943, 300.33495652364644, 119.79957719165384, 251.54918474778515, 341.5883509334422, 357.71755654190684, 302.9236741535387, 308.00241605970456, 318.7847445277266, 153.68474121093732, 328.2143147984698, 314.0362564458577, 320.1100111220632, 318.38659876488686, 316.0772873254288, 292.04874474107254, 342.88711775369967, 263.0201331168964, 359.5531125846205, 319.434791750633, 317.0361219172829], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 23, 46, 50, 50, 28, 50, 50, 23, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.576066921327557, "mean_inference_ms": 1.250938051955691, "mean_action_processing_ms": 0.2060489263450883, "mean_env_wait_ms": 524.7682449210457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011283231068806476, "StateBufferConnector_ms": 0.006000105156955949, "ViewRequirementAgentConnector_ms": 0.1665698476584561}, "num_episodes": 21, "episode_return_max": 369.42732059046944, "episode_return_min": 98.04035332082712, "episode_return_mean": 295.4325567644131}, "episode_reward_max": 369.42732059046944, "episode_reward_min": 98.04035332082712, "episode_reward_mean": 295.4325567644131, "episode_len_mean": 47.63855421686747, "episodes_this_iter": 21, "episodes_timesteps_total": 3954, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [276.4124556098842, 323.690388707065, 297.6884802867252, 301.09829671316686, 228.73782137765016, 344.1694001148205, 359.69938226035833, 317.1748743172233, 286.44672488964216, 334.9285478180274, 266.3252798479179, 233.46469276535248, 134.04191894531243, 336.85215156230447, 262.50309670320286, 288.7803683490627, 357.48698904845577, 356.97039138798146, 112.85616455078139, 326.3172495797313, 279.6277679198577, 352.04797686108486, 301.2965542923934, 341.7451305852827, 349.389638779523, 150.47788947681482, 344.4141070461193, 339.699681879929, 326.7858812645594, 295.6043740512702, 294.3168261879068, 272.8495658390376, 337.57906556607134, 321.6684078725133, 311.7519179130896, 326.16528724656416, 352.36386112554817, 329.12701555425406, 300.06686847155026, 283.70403756918057, 279.12319911788944, 356.8263101845705, 248.64301532711028, 369.42732059046944, 271.79071064805197, 326.0807624603583, 322.8178799255138, 262.67903181943376, 350.07210460779083, 306.26084849140074, 354.4208779909484, 311.06443306504417, 291.40787448306355, 350.64927394977946, 134.54416273395844, 307.40797750525024, 359.7261272058424, 98.04035332082712, 220.70164078316378, 355.75656248606424, 328.1810216476214, 153.92361511896706, 259.8408854346943, 300.33495652364644, 119.79957719165384, 251.54918474778515, 341.5883509334422, 357.71755654190684, 302.9236741535387, 308.00241605970456, 318.7847445277266, 153.68474121093732, 328.2143147984698, 314.0362564458577, 320.1100111220632, 318.38659876488686, 316.0772873254288, 292.04874474107254, 342.88711775369967, 263.0201331168964, 359.5531125846205, 319.434791750633, 317.0361219172829], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 23, 46, 50, 50, 28, 50, 50, 23, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.576066921327557, "mean_inference_ms": 1.250938051955691, "mean_action_processing_ms": 0.2060489263450883, "mean_env_wait_ms": 524.7682449210457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011283231068806476, "StateBufferConnector_ms": 0.006000105156955949, "ViewRequirementAgentConnector_ms": 0.1665698476584561}, "num_episodes": 21, "episode_return_max": 369.42732059046944, "episode_return_min": 98.04035332082712, "episode_return_mean": 295.4325567644131, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42732, "num_agent_steps_trained": 42732, "num_env_steps_sampled": 42732, "num_env_steps_trained": 42732, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.308907279414553, "num_env_steps_trained_throughput_per_sec": 10.308907279414553, "timesteps_total": 42732, "num_env_steps_sampled_lifetime": 42732, "num_agent_steps_sampled_lifetime": 42732, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 42732, "timers": {"training_iteration_time_ms": 100360.22, "restore_workers_time_ms": 0.018, "training_step_time_ms": 100360.161, "sample_time_ms": 97461.744, "load_time_ms": 0.512, "load_throughput": 2002958.298, "learn_time_ms": 2884.398, "learn_throughput": 355.707, "synch_weights_time_ms": 13.123}, "counters": {"num_env_steps_sampled": 42732, "num_env_steps_trained": 42732, "num_agent_steps_sampled": 42732, "num_agent_steps_trained": 42732}, "done": false, "episodes_total": 1143, "training_iteration": 65, "trial_id": "fe178_00005", "date": "2024-08-15_18-21-04", "timestamp": 1723767664, "time_this_iter_s": 99.5288987159729, "time_total_s": 4568.755990028381, "pid": 59880, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3509230216596316, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7502454913844214, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 401.45444893836975, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.760563380281692, "ram_util_percent": 11.802816901408448}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.942048234244186, "cur_kl_coeff": 0.35595703125, "cur_lr": 0.0005000000000000002, "total_loss": 7.087558056910833, "policy_loss": -0.00440950485256811, "vf_loss": 7.09000834946831, "vf_explained_var": 0.14821276925504207, "kl": 0.005504114384470442, "entropy": -1.1152568262070417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 44280, "num_env_steps_trained": 44280, "num_agent_steps_sampled": 44280, "num_agent_steps_trained": 44280}, "sampler_results": {"episode_reward_max": 365.94162386926564, "episode_reward_min": 114.06584472656255, "episode_reward_mean": 299.9937632837032, "episode_len_mean": 46.73170731707317, "episode_media": {}, "episodes_this_iter": 41, "episodes_timesteps_total": 1916, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.1279952375375, 322.3006028924777, 330.5693363050687, 350.4041274841164, 336.96669807703984, 365.5748096828703, 156.8136962890626, 320.09461536770624, 171.02626953125002, 291.86893483955583, 321.5334247736873, 287.35095329893653, 253.1443047847664, 197.16742306259158, 355.4356933123034, 306.5010200397006, 316.3221140643631, 345.97217354061877, 319.95139011775444, 170.81104096616622, 352.3057509505561, 289.8363040486341, 353.43535427039717, 121.98265662122338, 304.4327278163581, 290.67683550980774, 365.94162386926564, 356.0017438893416, 354.0942103221043, 344.1456093436696, 114.06584472656255, 326.61305284362743, 350.45866738237385, 317.8747414680711, 326.6806279792254, 302.633663669766, 289.6261236485753, 334.9004149141909, 322.4049635343163, 307.90812116243006, 316.7886329937586], "episode_lengths": [50, 50, 50, 50, 50, 50, 26, 50, 31, 50, 50, 50, 50, 33, 50, 50, 50, 50, 50, 32, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.7005612870363995, "mean_inference_ms": 1.2532401829163262, "mean_action_processing_ms": 0.20845006050175507, "mean_env_wait_ms": 516.609953755735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011907554254299256, "StateBufferConnector_ms": 0.006133172570205316, "ViewRequirementAgentConnector_ms": 0.17085598736274532}, "num_episodes": 41, "episode_return_max": 365.94162386926564, "episode_return_min": 114.06584472656255, "episode_return_mean": 299.9937632837032}, "env_runner_results": {"episode_reward_max": 365.94162386926564, "episode_reward_min": 114.06584472656255, "episode_reward_mean": 299.9937632837032, "episode_len_mean": 46.73170731707317, "episode_media": {}, "episodes_this_iter": 41, "episodes_timesteps_total": 1916, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.1279952375375, 322.3006028924777, 330.5693363050687, 350.4041274841164, 336.96669807703984, 365.5748096828703, 156.8136962890626, 320.09461536770624, 171.02626953125002, 291.86893483955583, 321.5334247736873, 287.35095329893653, 253.1443047847664, 197.16742306259158, 355.4356933123034, 306.5010200397006, 316.3221140643631, 345.97217354061877, 319.95139011775444, 170.81104096616622, 352.3057509505561, 289.8363040486341, 353.43535427039717, 121.98265662122338, 304.4327278163581, 290.67683550980774, 365.94162386926564, 356.0017438893416, 354.0942103221043, 344.1456093436696, 114.06584472656255, 326.61305284362743, 350.45866738237385, 317.8747414680711, 326.6806279792254, 302.633663669766, 289.6261236485753, 334.9004149141909, 322.4049635343163, 307.90812116243006, 316.7886329937586], "episode_lengths": [50, 50, 50, 50, 50, 50, 26, 50, 31, 50, 50, 50, 50, 33, 50, 50, 50, 50, 50, 32, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.7005612870363995, "mean_inference_ms": 1.2532401829163262, "mean_action_processing_ms": 0.20845006050175507, "mean_env_wait_ms": 516.609953755735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011907554254299256, "StateBufferConnector_ms": 0.006133172570205316, "ViewRequirementAgentConnector_ms": 0.17085598736274532}, "num_episodes": 41, "episode_return_max": 365.94162386926564, "episode_return_min": 114.06584472656255, "episode_return_mean": 299.9937632837032}, "episode_reward_max": 365.94162386926564, "episode_reward_min": 114.06584472656255, "episode_reward_mean": 299.9937632837032, "episode_len_mean": 46.73170731707317, "episodes_this_iter": 41, "episodes_timesteps_total": 1916, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [337.1279952375375, 322.3006028924777, 330.5693363050687, 350.4041274841164, 336.96669807703984, 365.5748096828703, 156.8136962890626, 320.09461536770624, 171.02626953125002, 291.86893483955583, 321.5334247736873, 287.35095329893653, 253.1443047847664, 197.16742306259158, 355.4356933123034, 306.5010200397006, 316.3221140643631, 345.97217354061877, 319.95139011775444, 170.81104096616622, 352.3057509505561, 289.8363040486341, 353.43535427039717, 121.98265662122338, 304.4327278163581, 290.67683550980774, 365.94162386926564, 356.0017438893416, 354.0942103221043, 344.1456093436696, 114.06584472656255, 326.61305284362743, 350.45866738237385, 317.8747414680711, 326.6806279792254, 302.633663669766, 289.6261236485753, 334.9004149141909, 322.4049635343163, 307.90812116243006, 316.7886329937586], "episode_lengths": [50, 50, 50, 50, 50, 50, 26, 50, 31, 50, 50, 50, 50, 33, 50, 50, 50, 50, 50, 32, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.7005612870363995, "mean_inference_ms": 1.2532401829163262, "mean_action_processing_ms": 0.20845006050175507, "mean_env_wait_ms": 516.609953755735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011907554254299256, "StateBufferConnector_ms": 0.006133172570205316, "ViewRequirementAgentConnector_ms": 0.17085598736274532}, "num_episodes": 41, "episode_return_max": 365.94162386926564, "episode_return_min": 114.06584472656255, "episode_return_mean": 299.9937632837032, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44280, "num_agent_steps_trained": 44280, "num_env_steps_sampled": 44280, "num_env_steps_trained": 44280, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 10.49237735627651, "num_env_steps_trained_throughput_per_sec": 10.49237735627651, "timesteps_total": 44280, "num_env_steps_sampled_lifetime": 44280, "num_agent_steps_sampled_lifetime": 44280, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 44280, "timers": {"training_iteration_time_ms": 195570.562, "restore_workers_time_ms": 0.018, "training_step_time_ms": 195570.504, "sample_time_ms": 191666.586, "load_time_ms": 0.786, "load_throughput": 2610467.64, "learn_time_ms": 3890.064, "learn_throughput": 527.498, "synch_weights_time_ms": 12.508}, "counters": {"num_env_steps_sampled": 44280, "num_env_steps_trained": 44280, "num_agent_steps_sampled": 44280, "num_agent_steps_trained": 44280}, "done": false, "episodes_total": 1172, "training_iteration": 66, "trial_id": "fe178_00005", "date": "2024-08-15_18-24-47", "timestamp": 1723767887, "time_this_iter_s": 195.5744059085846, "time_total_s": 4688.37708902359, "pid": 11057, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2758787622363351, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.577343190244505, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 195.5744059085846, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.95357142857143, "ram_util_percent": 11.539285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.49196146776279, "cur_kl_coeff": 0.35595703125, "cur_lr": 0.0005000000000000002, "total_loss": 7.399414494882027, "policy_loss": -0.00679940410918789, "vf_loss": 7.403383776297172, "vf_explained_var": 0.10927099585533143, "kl": 0.007950773033130314, "entropy": -1.1514845301707586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 720.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 46332, "num_env_steps_trained": 46332, "num_agent_steps_sampled": 46332, "num_agent_steps_trained": 46332}, "sampler_results": {"episode_reward_max": 365.94162386926564, "episode_reward_min": 112.3343627929687, "episode_reward_mean": 308.9382267358628, "episode_len_mean": 47.80722891566265, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 3968, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.1279952375375, 322.3006028924777, 330.5693363050687, 350.4041274841164, 336.96669807703984, 365.5748096828703, 156.8136962890626, 320.09461536770624, 171.02626953125002, 291.86893483955583, 321.5334247736873, 287.35095329893653, 253.1443047847664, 197.16742306259158, 355.4356933123034, 306.5010200397006, 316.3221140643631, 345.97217354061877, 319.95139011775444, 170.81104096616622, 352.3057509505561, 289.8363040486341, 353.43535427039717, 121.98265662122338, 304.4327278163581, 290.67683550980774, 365.94162386926564, 356.0017438893416, 354.0942103221043, 344.1456093436696, 114.06584472656255, 326.61305284362743, 350.45866738237385, 317.8747414680711, 326.6806279792254, 302.633663669766, 289.6261236485753, 334.9004149141909, 322.4049635343163, 307.90812116243006, 316.7886329937586, 317.5023110538197, 355.2150269568736, 345.721394120877, 250.02096966759365, 325.9049223579613, 321.11647402827583, 312.98730545978134, 348.12387892249717, 364.05326323821544, 339.22190071813765, 325.00170733759114, 272.6536679963425, 279.93427816260953, 299.82823061117506, 329.26850128215085, 112.3343627929687, 351.5712541187687, 142.9787475585938, 319.26518599438185, 291.8416058059841, 345.35814983268114, 310.51305972172605, 344.4248779296879, 244.94072625503185, 347.0198446075542, 305.9998002003799, 301.7466554921465, 356.8393446617824, 352.68777287043076, 350.36353381721773, 328.7702554409726, 357.0832565750809, 327.5995808555084, 335.46956138098375, 335.1553506960166, 320.5112993993038, 323.4446010507184, 337.70562758993583, 358.1110256028782, 353.9725830078128, 353.3006287595366, 346.56600051279327], "episode_lengths": [50, 50, 50, 50, 50, 50, 26, 50, 31, 50, 50, 50, 50, 33, 50, 50, 50, 50, 50, 32, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.703518058042218, "mean_inference_ms": 1.2509307332836102, "mean_action_processing_ms": 0.20861927423709034, "mean_env_wait_ms": 517.4924745333474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01142714397016778, "StateBufferConnector_ms": 0.0061319535037121144, "ViewRequirementAgentConnector_ms": 0.17179695956678276}, "num_episodes": 42, "episode_return_max": 365.94162386926564, "episode_return_min": 112.3343627929687, "episode_return_mean": 308.9382267358628}, "env_runner_results": {"episode_reward_max": 365.94162386926564, "episode_reward_min": 112.3343627929687, "episode_reward_mean": 308.9382267358628, "episode_len_mean": 47.80722891566265, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 3968, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.1279952375375, 322.3006028924777, 330.5693363050687, 350.4041274841164, 336.96669807703984, 365.5748096828703, 156.8136962890626, 320.09461536770624, 171.02626953125002, 291.86893483955583, 321.5334247736873, 287.35095329893653, 253.1443047847664, 197.16742306259158, 355.4356933123034, 306.5010200397006, 316.3221140643631, 345.97217354061877, 319.95139011775444, 170.81104096616622, 352.3057509505561, 289.8363040486341, 353.43535427039717, 121.98265662122338, 304.4327278163581, 290.67683550980774, 365.94162386926564, 356.0017438893416, 354.0942103221043, 344.1456093436696, 114.06584472656255, 326.61305284362743, 350.45866738237385, 317.8747414680711, 326.6806279792254, 302.633663669766, 289.6261236485753, 334.9004149141909, 322.4049635343163, 307.90812116243006, 316.7886329937586, 317.5023110538197, 355.2150269568736, 345.721394120877, 250.02096966759365, 325.9049223579613, 321.11647402827583, 312.98730545978134, 348.12387892249717, 364.05326323821544, 339.22190071813765, 325.00170733759114, 272.6536679963425, 279.93427816260953, 299.82823061117506, 329.26850128215085, 112.3343627929687, 351.5712541187687, 142.9787475585938, 319.26518599438185, 291.8416058059841, 345.35814983268114, 310.51305972172605, 344.4248779296879, 244.94072625503185, 347.0198446075542, 305.9998002003799, 301.7466554921465, 356.8393446617824, 352.68777287043076, 350.36353381721773, 328.7702554409726, 357.0832565750809, 327.5995808555084, 335.46956138098375, 335.1553506960166, 320.5112993993038, 323.4446010507184, 337.70562758993583, 358.1110256028782, 353.9725830078128, 353.3006287595366, 346.56600051279327], "episode_lengths": [50, 50, 50, 50, 50, 50, 26, 50, 31, 50, 50, 50, 50, 33, 50, 50, 50, 50, 50, 32, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.703518058042218, "mean_inference_ms": 1.2509307332836102, "mean_action_processing_ms": 0.20861927423709034, "mean_env_wait_ms": 517.4924745333474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01142714397016778, "StateBufferConnector_ms": 0.0061319535037121144, "ViewRequirementAgentConnector_ms": 0.17179695956678276}, "num_episodes": 42, "episode_return_max": 365.94162386926564, "episode_return_min": 112.3343627929687, "episode_return_mean": 308.9382267358628}, "episode_reward_max": 365.94162386926564, "episode_reward_min": 112.3343627929687, "episode_reward_mean": 308.9382267358628, "episode_len_mean": 47.80722891566265, "episodes_this_iter": 42, "episodes_timesteps_total": 3968, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [337.1279952375375, 322.3006028924777, 330.5693363050687, 350.4041274841164, 336.96669807703984, 365.5748096828703, 156.8136962890626, 320.09461536770624, 171.02626953125002, 291.86893483955583, 321.5334247736873, 287.35095329893653, 253.1443047847664, 197.16742306259158, 355.4356933123034, 306.5010200397006, 316.3221140643631, 345.97217354061877, 319.95139011775444, 170.81104096616622, 352.3057509505561, 289.8363040486341, 353.43535427039717, 121.98265662122338, 304.4327278163581, 290.67683550980774, 365.94162386926564, 356.0017438893416, 354.0942103221043, 344.1456093436696, 114.06584472656255, 326.61305284362743, 350.45866738237385, 317.8747414680711, 326.6806279792254, 302.633663669766, 289.6261236485753, 334.9004149141909, 322.4049635343163, 307.90812116243006, 316.7886329937586, 317.5023110538197, 355.2150269568736, 345.721394120877, 250.02096966759365, 325.9049223579613, 321.11647402827583, 312.98730545978134, 348.12387892249717, 364.05326323821544, 339.22190071813765, 325.00170733759114, 272.6536679963425, 279.93427816260953, 299.82823061117506, 329.26850128215085, 112.3343627929687, 351.5712541187687, 142.9787475585938, 319.26518599438185, 291.8416058059841, 345.35814983268114, 310.51305972172605, 344.4248779296879, 244.94072625503185, 347.0198446075542, 305.9998002003799, 301.7466554921465, 356.8393446617824, 352.68777287043076, 350.36353381721773, 328.7702554409726, 357.0832565750809, 327.5995808555084, 335.46956138098375, 335.1553506960166, 320.5112993993038, 323.4446010507184, 337.70562758993583, 358.1110256028782, 353.9725830078128, 353.3006287595366, 346.56600051279327], "episode_lengths": [50, 50, 50, 50, 50, 50, 26, 50, 31, 50, 50, 50, 50, 33, 50, 50, 50, 50, 50, 32, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.703518058042218, "mean_inference_ms": 1.2509307332836102, "mean_action_processing_ms": 0.20861927423709034, "mean_env_wait_ms": 517.4924745333474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01142714397016778, "StateBufferConnector_ms": 0.0061319535037121144, "ViewRequirementAgentConnector_ms": 0.17179695956678276}, "num_episodes": 42, "episode_return_max": 365.94162386926564, "episode_return_min": 112.3343627929687, "episode_return_mean": 308.9382267358628, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46332, "num_agent_steps_trained": 46332, "num_env_steps_sampled": 46332, "num_env_steps_trained": 46332, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 10.361968436365613, "num_env_steps_trained_throughput_per_sec": 10.361968436365613, "timesteps_total": 46332, "num_env_steps_sampled_lifetime": 46332, "num_agent_steps_sampled_lifetime": 46332, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 46332, "timers": {"training_iteration_time_ms": 196801.221, "restore_workers_time_ms": 0.016, "training_step_time_ms": 196801.168, "sample_time_ms": 193550.487, "load_time_ms": 0.669, "load_throughput": 3068346.456, "learn_time_ms": 3236.57, "learn_throughput": 634.004, "synch_weights_time_ms": 12.962}, "counters": {"num_env_steps_sampled": 46332, "num_env_steps_trained": 46332, "num_agent_steps_sampled": 46332, "num_agent_steps_trained": 46332}, "done": false, "episodes_total": 1214, "training_iteration": 67, "trial_id": "fe178_00005", "date": "2024-08-15_18-28-05", "timestamp": 1723768085, "time_this_iter_s": 198.03557920455933, "time_total_s": 4886.412668228149, "pid": 11057, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2758787622363351, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.577343190244505, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 393.6099851131439, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.824468085106382, "ram_util_percent": 11.647517730496453}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.4868300229311, "cur_kl_coeff": 0.35595703125, "cur_lr": 0.0005000000000000002, "total_loss": 7.463469857225816, "policy_loss": -0.0057765728250766795, "vf_loss": 7.465433726211389, "vf_explained_var": 0.0901389081031084, "kl": 0.010711085197546053, "entropy": -1.0866140571733316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1200.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384}, "sampler_results": {"episode_reward_max": 365.94162386926564, "episode_reward_min": 112.3343627929687, "episode_reward_mean": 315.70263497333644, "episode_len_mean": 49.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 4900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.67683550980774, 365.94162386926564, 356.0017438893416, 354.0942103221043, 344.1456093436696, 114.06584472656255, 326.61305284362743, 350.45866738237385, 317.8747414680711, 326.6806279792254, 302.633663669766, 289.6261236485753, 334.9004149141909, 322.4049635343163, 307.90812116243006, 316.7886329937586, 317.5023110538197, 355.2150269568736, 345.721394120877, 250.02096966759365, 325.9049223579613, 321.11647402827583, 312.98730545978134, 348.12387892249717, 364.05326323821544, 339.22190071813765, 325.00170733759114, 272.6536679963425, 279.93427816260953, 299.82823061117506, 329.26850128215085, 112.3343627929687, 351.5712541187687, 142.9787475585938, 319.26518599438185, 291.8416058059841, 345.35814983268114, 310.51305972172605, 344.4248779296879, 244.94072625503185, 347.0198446075542, 305.9998002003799, 301.7466554921465, 356.8393446617824, 352.68777287043076, 350.36353381721773, 328.7702554409726, 357.0832565750809, 327.5995808555084, 335.46956138098375, 335.1553506960166, 320.5112993993038, 323.4446010507184, 337.70562758993583, 358.1110256028782, 353.9725830078128, 353.3006287595366, 346.56600051279327, 311.70903769897734, 308.98804295618834, 337.3685800479638, 356.5000417865662, 309.1931475629044, 319.4403581579858, 320.58837621036497, 299.3572180750372, 349.625936574828, 336.6136385444723, 345.54452977950365, 335.592370152078, 331.68217884887946, 323.8280746154771, 281.37154198032545, 319.05785972380875, 314.74684839079487, 204.72438154812102, 319.1853849725893, 362.6495996299786, 305.1389653448916, 345.73472743259447, 273.349414659939, 350.4024507258065, 274.5005215867536, 345.9072665077483, 288.5516423953026, 259.8826421439988, 327.3488930077173, 317.57373851409255, 326.24814768342344, 306.36078919538346, 339.493243889285, 328.87538430243944, 339.829760742188, 305.9470388653464, 353.3407588112456, 288.02361357470346, 153.6294749754956, 343.74773188608515, 326.7275836910697, 318.93915843942176], "episode_lengths": [50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.674244373664644, "mean_inference_ms": 1.2464352600523432, "mean_action_processing_ms": 0.20855966201789827, "mean_env_wait_ms": 529.8661221968033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01098322868347168, "StateBufferConnector_ms": 0.0061032772064208984, "ViewRequirementAgentConnector_ms": 0.1722872257232666}, "num_episodes": 42, "episode_return_max": 365.94162386926564, "episode_return_min": 112.3343627929687, "episode_return_mean": 315.70263497333644}, "env_runner_results": {"episode_reward_max": 365.94162386926564, "episode_reward_min": 112.3343627929687, "episode_reward_mean": 315.70263497333644, "episode_len_mean": 49.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 4900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.67683550980774, 365.94162386926564, 356.0017438893416, 354.0942103221043, 344.1456093436696, 114.06584472656255, 326.61305284362743, 350.45866738237385, 317.8747414680711, 326.6806279792254, 302.633663669766, 289.6261236485753, 334.9004149141909, 322.4049635343163, 307.90812116243006, 316.7886329937586, 317.5023110538197, 355.2150269568736, 345.721394120877, 250.02096966759365, 325.9049223579613, 321.11647402827583, 312.98730545978134, 348.12387892249717, 364.05326323821544, 339.22190071813765, 325.00170733759114, 272.6536679963425, 279.93427816260953, 299.82823061117506, 329.26850128215085, 112.3343627929687, 351.5712541187687, 142.9787475585938, 319.26518599438185, 291.8416058059841, 345.35814983268114, 310.51305972172605, 344.4248779296879, 244.94072625503185, 347.0198446075542, 305.9998002003799, 301.7466554921465, 356.8393446617824, 352.68777287043076, 350.36353381721773, 328.7702554409726, 357.0832565750809, 327.5995808555084, 335.46956138098375, 335.1553506960166, 320.5112993993038, 323.4446010507184, 337.70562758993583, 358.1110256028782, 353.9725830078128, 353.3006287595366, 346.56600051279327, 311.70903769897734, 308.98804295618834, 337.3685800479638, 356.5000417865662, 309.1931475629044, 319.4403581579858, 320.58837621036497, 299.3572180750372, 349.625936574828, 336.6136385444723, 345.54452977950365, 335.592370152078, 331.68217884887946, 323.8280746154771, 281.37154198032545, 319.05785972380875, 314.74684839079487, 204.72438154812102, 319.1853849725893, 362.6495996299786, 305.1389653448916, 345.73472743259447, 273.349414659939, 350.4024507258065, 274.5005215867536, 345.9072665077483, 288.5516423953026, 259.8826421439988, 327.3488930077173, 317.57373851409255, 326.24814768342344, 306.36078919538346, 339.493243889285, 328.87538430243944, 339.829760742188, 305.9470388653464, 353.3407588112456, 288.02361357470346, 153.6294749754956, 343.74773188608515, 326.7275836910697, 318.93915843942176], "episode_lengths": [50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.674244373664644, "mean_inference_ms": 1.2464352600523432, "mean_action_processing_ms": 0.20855966201789827, "mean_env_wait_ms": 529.8661221968033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01098322868347168, "StateBufferConnector_ms": 0.0061032772064208984, "ViewRequirementAgentConnector_ms": 0.1722872257232666}, "num_episodes": 42, "episode_return_max": 365.94162386926564, "episode_return_min": 112.3343627929687, "episode_return_mean": 315.70263497333644}, "episode_reward_max": 365.94162386926564, "episode_reward_min": 112.3343627929687, "episode_reward_mean": 315.70263497333644, "episode_len_mean": 49.0, "episodes_this_iter": 42, "episodes_timesteps_total": 4900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [290.67683550980774, 365.94162386926564, 356.0017438893416, 354.0942103221043, 344.1456093436696, 114.06584472656255, 326.61305284362743, 350.45866738237385, 317.8747414680711, 326.6806279792254, 302.633663669766, 289.6261236485753, 334.9004149141909, 322.4049635343163, 307.90812116243006, 316.7886329937586, 317.5023110538197, 355.2150269568736, 345.721394120877, 250.02096966759365, 325.9049223579613, 321.11647402827583, 312.98730545978134, 348.12387892249717, 364.05326323821544, 339.22190071813765, 325.00170733759114, 272.6536679963425, 279.93427816260953, 299.82823061117506, 329.26850128215085, 112.3343627929687, 351.5712541187687, 142.9787475585938, 319.26518599438185, 291.8416058059841, 345.35814983268114, 310.51305972172605, 344.4248779296879, 244.94072625503185, 347.0198446075542, 305.9998002003799, 301.7466554921465, 356.8393446617824, 352.68777287043076, 350.36353381721773, 328.7702554409726, 357.0832565750809, 327.5995808555084, 335.46956138098375, 335.1553506960166, 320.5112993993038, 323.4446010507184, 337.70562758993583, 358.1110256028782, 353.9725830078128, 353.3006287595366, 346.56600051279327, 311.70903769897734, 308.98804295618834, 337.3685800479638, 356.5000417865662, 309.1931475629044, 319.4403581579858, 320.58837621036497, 299.3572180750372, 349.625936574828, 336.6136385444723, 345.54452977950365, 335.592370152078, 331.68217884887946, 323.8280746154771, 281.37154198032545, 319.05785972380875, 314.74684839079487, 204.72438154812102, 319.1853849725893, 362.6495996299786, 305.1389653448916, 345.73472743259447, 273.349414659939, 350.4024507258065, 274.5005215867536, 345.9072665077483, 288.5516423953026, 259.8826421439988, 327.3488930077173, 317.57373851409255, 326.24814768342344, 306.36078919538346, 339.493243889285, 328.87538430243944, 339.829760742188, 305.9470388653464, 353.3407588112456, 288.02361357470346, 153.6294749754956, 343.74773188608515, 326.7275836910697, 318.93915843942176], "episode_lengths": [50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.674244373664644, "mean_inference_ms": 1.2464352600523432, "mean_action_processing_ms": 0.20855966201789827, "mean_env_wait_ms": 529.8661221968033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01098322868347168, "StateBufferConnector_ms": 0.0061032772064208984, "ViewRequirementAgentConnector_ms": 0.1722872257232666}, "num_episodes": 42, "episode_return_max": 365.94162386926564, "episode_return_min": 112.3343627929687, "episode_return_mean": 315.70263497333644, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384, "num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 8.954665446086274, "num_env_steps_trained_throughput_per_sec": 8.954665446086274, "timesteps_total": 48384, "num_env_steps_sampled_lifetime": 48384, "num_agent_steps_sampled_lifetime": 48384, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 48384, "timers": {"training_iteration_time_ms": 207585.583, "restore_workers_time_ms": 0.017, "training_step_time_ms": 207585.526, "sample_time_ms": 204541.091, "load_time_ms": 0.643, "load_throughput": 3189639.954, "learn_time_ms": 3030.273, "learn_throughput": 677.167, "synch_weights_time_ms": 13.064}, "counters": {"num_env_steps_sampled": 48384, "num_env_steps_trained": 48384, "num_agent_steps_sampled": 48384, "num_agent_steps_trained": 48384}, "done": false, "episodes_total": 1256, "training_iteration": 68, "trial_id": "fe178_00005", "date": "2024-08-15_18-31-54", "timestamp": 1723768314, "time_this_iter_s": 229.1579885482788, "time_total_s": 5115.570656776428, "pid": 11057, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2758787622363351, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.577343190244505, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 622.7679736614227, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.602752293577982, "ram_util_percent": 11.796330275229359}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.38335850139459, "cur_kl_coeff": 0.35595703125, "cur_lr": 0.0005000000000000002, "total_loss": 7.601480080932379, "policy_loss": -0.007137994087922077, "vf_loss": 7.606631097694238, "vf_explained_var": 0.08433393935362497, "kl": 0.005581959733900668, "entropy": -1.2205236781388522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1680.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 50436, "num_env_steps_trained": 50436, "num_agent_steps_sampled": 50436, "num_agent_steps_trained": 50436}, "sampler_results": {"episode_reward_max": 365.0518579218615, "episode_reward_min": 106.89534856974461, "episode_reward_mean": 315.8066595212234, "episode_len_mean": 48.69, "episode_media": {}, "episodes_this_iter": 41, "episodes_timesteps_total": 4869, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [305.9998002003799, 301.7466554921465, 356.8393446617824, 352.68777287043076, 350.36353381721773, 328.7702554409726, 357.0832565750809, 327.5995808555084, 335.46956138098375, 335.1553506960166, 320.5112993993038, 323.4446010507184, 337.70562758993583, 358.1110256028782, 353.9725830078128, 353.3006287595366, 346.56600051279327, 311.70903769897734, 308.98804295618834, 337.3685800479638, 356.5000417865662, 309.1931475629044, 319.4403581579858, 320.58837621036497, 299.3572180750372, 349.625936574828, 336.6136385444723, 345.54452977950365, 335.592370152078, 331.68217884887946, 323.8280746154771, 281.37154198032545, 319.05785972380875, 314.74684839079487, 204.72438154812102, 319.1853849725893, 362.6495996299786, 305.1389653448916, 345.73472743259447, 273.349414659939, 350.4024507258065, 274.5005215867536, 345.9072665077483, 288.5516423953026, 259.8826421439988, 327.3488930077173, 317.57373851409255, 326.24814768342344, 306.36078919538346, 339.493243889285, 328.87538430243944, 339.829760742188, 305.9470388653464, 353.3407588112456, 288.02361357470346, 153.6294749754956, 343.74773188608515, 326.7275836910697, 318.93915843942176, 328.0967907009451, 310.0136900077616, 338.53190888124993, 292.7818501998989, 337.04639040800305, 106.89534856974461, 278.56342447107926, 348.25105376729385, 351.0434405813536, 301.8353704464555, 339.6714236230453, 287.8717820016045, 149.0163208007814, 224.9233928233229, 356.2642596982885, 346.0953865708866, 329.2988254119352, 313.42177582801844, 336.48743944783706, 238.65932603450148, 356.97834431963435, 365.0518579218615, 327.3116528639566, 328.71602761984684, 342.73348839867447, 288.63641795399144, 356.6285771052452, 352.2718655309231, 354.2867304457186, 309.99797896558584, 350.75287708256025, 335.8080524165066, 349.15017425894877, 312.9548846942613, 341.4761469466516, 107.93735447480191, 341.7396720009725, 154.77849533107184, 345.1744330256382, 338.346762351544, 352.5179845946653], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 27, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.681900228196856, "mean_inference_ms": 1.2431465975903908, "mean_action_processing_ms": 0.20821455116163787, "mean_env_wait_ms": 536.643448180708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010704755783081055, "StateBufferConnector_ms": 0.006070137023925781, "ViewRequirementAgentConnector_ms": 0.17223501205444336}, "num_episodes": 41, "episode_return_max": 365.0518579218615, "episode_return_min": 106.89534856974461, "episode_return_mean": 315.8066595212234}, "env_runner_results": {"episode_reward_max": 365.0518579218615, "episode_reward_min": 106.89534856974461, "episode_reward_mean": 315.8066595212234, "episode_len_mean": 48.69, "episode_media": {}, "episodes_this_iter": 41, "episodes_timesteps_total": 4869, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [305.9998002003799, 301.7466554921465, 356.8393446617824, 352.68777287043076, 350.36353381721773, 328.7702554409726, 357.0832565750809, 327.5995808555084, 335.46956138098375, 335.1553506960166, 320.5112993993038, 323.4446010507184, 337.70562758993583, 358.1110256028782, 353.9725830078128, 353.3006287595366, 346.56600051279327, 311.70903769897734, 308.98804295618834, 337.3685800479638, 356.5000417865662, 309.1931475629044, 319.4403581579858, 320.58837621036497, 299.3572180750372, 349.625936574828, 336.6136385444723, 345.54452977950365, 335.592370152078, 331.68217884887946, 323.8280746154771, 281.37154198032545, 319.05785972380875, 314.74684839079487, 204.72438154812102, 319.1853849725893, 362.6495996299786, 305.1389653448916, 345.73472743259447, 273.349414659939, 350.4024507258065, 274.5005215867536, 345.9072665077483, 288.5516423953026, 259.8826421439988, 327.3488930077173, 317.57373851409255, 326.24814768342344, 306.36078919538346, 339.493243889285, 328.87538430243944, 339.829760742188, 305.9470388653464, 353.3407588112456, 288.02361357470346, 153.6294749754956, 343.74773188608515, 326.7275836910697, 318.93915843942176, 328.0967907009451, 310.0136900077616, 338.53190888124993, 292.7818501998989, 337.04639040800305, 106.89534856974461, 278.56342447107926, 348.25105376729385, 351.0434405813536, 301.8353704464555, 339.6714236230453, 287.8717820016045, 149.0163208007814, 224.9233928233229, 356.2642596982885, 346.0953865708866, 329.2988254119352, 313.42177582801844, 336.48743944783706, 238.65932603450148, 356.97834431963435, 365.0518579218615, 327.3116528639566, 328.71602761984684, 342.73348839867447, 288.63641795399144, 356.6285771052452, 352.2718655309231, 354.2867304457186, 309.99797896558584, 350.75287708256025, 335.8080524165066, 349.15017425894877, 312.9548846942613, 341.4761469466516, 107.93735447480191, 341.7396720009725, 154.77849533107184, 345.1744330256382, 338.346762351544, 352.5179845946653], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 27, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.681900228196856, "mean_inference_ms": 1.2431465975903908, "mean_action_processing_ms": 0.20821455116163787, "mean_env_wait_ms": 536.643448180708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010704755783081055, "StateBufferConnector_ms": 0.006070137023925781, "ViewRequirementAgentConnector_ms": 0.17223501205444336}, "num_episodes": 41, "episode_return_max": 365.0518579218615, "episode_return_min": 106.89534856974461, "episode_return_mean": 315.8066595212234}, "episode_reward_max": 365.0518579218615, "episode_reward_min": 106.89534856974461, "episode_reward_mean": 315.8066595212234, "episode_len_mean": 48.69, "episodes_this_iter": 41, "episodes_timesteps_total": 4869, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [305.9998002003799, 301.7466554921465, 356.8393446617824, 352.68777287043076, 350.36353381721773, 328.7702554409726, 357.0832565750809, 327.5995808555084, 335.46956138098375, 335.1553506960166, 320.5112993993038, 323.4446010507184, 337.70562758993583, 358.1110256028782, 353.9725830078128, 353.3006287595366, 346.56600051279327, 311.70903769897734, 308.98804295618834, 337.3685800479638, 356.5000417865662, 309.1931475629044, 319.4403581579858, 320.58837621036497, 299.3572180750372, 349.625936574828, 336.6136385444723, 345.54452977950365, 335.592370152078, 331.68217884887946, 323.8280746154771, 281.37154198032545, 319.05785972380875, 314.74684839079487, 204.72438154812102, 319.1853849725893, 362.6495996299786, 305.1389653448916, 345.73472743259447, 273.349414659939, 350.4024507258065, 274.5005215867536, 345.9072665077483, 288.5516423953026, 259.8826421439988, 327.3488930077173, 317.57373851409255, 326.24814768342344, 306.36078919538346, 339.493243889285, 328.87538430243944, 339.829760742188, 305.9470388653464, 353.3407588112456, 288.02361357470346, 153.6294749754956, 343.74773188608515, 326.7275836910697, 318.93915843942176, 328.0967907009451, 310.0136900077616, 338.53190888124993, 292.7818501998989, 337.04639040800305, 106.89534856974461, 278.56342447107926, 348.25105376729385, 351.0434405813536, 301.8353704464555, 339.6714236230453, 287.8717820016045, 149.0163208007814, 224.9233928233229, 356.2642596982885, 346.0953865708866, 329.2988254119352, 313.42177582801844, 336.48743944783706, 238.65932603450148, 356.97834431963435, 365.0518579218615, 327.3116528639566, 328.71602761984684, 342.73348839867447, 288.63641795399144, 356.6285771052452, 352.2718655309231, 354.2867304457186, 309.99797896558584, 350.75287708256025, 335.8080524165066, 349.15017425894877, 312.9548846942613, 341.4761469466516, 107.93735447480191, 341.7396720009725, 154.77849533107184, 345.1744330256382, 338.346762351544, 352.5179845946653], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 27, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.681900228196856, "mean_inference_ms": 1.2431465975903908, "mean_action_processing_ms": 0.20821455116163787, "mean_env_wait_ms": 536.643448180708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010704755783081055, "StateBufferConnector_ms": 0.006070137023925781, "ViewRequirementAgentConnector_ms": 0.17223501205444336}, "num_episodes": 41, "episode_return_max": 365.0518579218615, "episode_return_min": 106.89534856974461, "episode_return_mean": 315.8066595212234, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50436, "num_agent_steps_trained": 50436, "num_env_steps_sampled": 50436, "num_env_steps_trained": 50436, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 10.7969858939336, "num_env_steps_trained_throughput_per_sec": 10.7969858939336, "timesteps_total": 50436, "num_env_steps_sampled_lifetime": 50436, "num_agent_steps_sampled_lifetime": 50436, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 50436, "timers": {"training_iteration_time_ms": 203202.45, "restore_workers_time_ms": 0.017, "training_step_time_ms": 203202.394, "sample_time_ms": 200253.005, "load_time_ms": 0.62, "load_throughput": 3311866.016, "learn_time_ms": 2935.303, "learn_throughput": 699.076, "synch_weights_time_ms": 13.034}, "counters": {"num_env_steps_sampled": 50436, "num_env_steps_trained": 50436, "num_agent_steps_sampled": 50436, "num_agent_steps_trained": 50436}, "done": false, "episodes_total": 1297, "training_iteration": 69, "trial_id": "fe178_00005", "date": "2024-08-15_18-35-04", "timestamp": 1723768504, "time_this_iter_s": 190.05677318572998, "time_total_s": 5305.627429962158, "pid": 11057, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2758787622363351, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.577343190244505, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 812.8247468471527, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 27.180442804428044, "ram_util_percent": 11.65793357933579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.47047893802325, "cur_kl_coeff": 0.19005811214447021, "cur_lr": 1e-05, "total_loss": 9.415574471155802, "policy_loss": -0.009032011652986208, "vf_loss": 9.423161021868388, "vf_explained_var": 0.029118731121222177, "kl": 0.007605314367907554, "entropy": -1.2879065617918968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52032, "num_env_steps_trained": 52032, "num_agent_steps_sampled": 52032, "num_agent_steps_trained": 52032}, "sampler_results": {"episode_reward_max": 349.749017081596, "episode_reward_min": 233.85739005055422, "episode_reward_mean": 323.65736793039326, "episode_len_mean": 49.666666666666664, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 298, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724], "episode_lengths": [50, 48, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.140747004541857, "mean_inference_ms": 1.265608944655378, "mean_action_processing_ms": 0.21128544862242948, "mean_env_wait_ms": 523.201822321077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009802977244059244, "StateBufferConnector_ms": 0.006496906280517578, "ViewRequirementAgentConnector_ms": 0.1711726188659668}, "num_episodes": 6, "episode_return_max": 349.749017081596, "episode_return_min": 233.85739005055422, "episode_return_mean": 323.65736793039326}, "env_runner_results": {"episode_reward_max": 349.749017081596, "episode_reward_min": 233.85739005055422, "episode_reward_mean": 323.65736793039326, "episode_len_mean": 49.666666666666664, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 298, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724], "episode_lengths": [50, 48, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.140747004541857, "mean_inference_ms": 1.265608944655378, "mean_action_processing_ms": 0.21128544862242948, "mean_env_wait_ms": 523.201822321077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009802977244059244, "StateBufferConnector_ms": 0.006496906280517578, "ViewRequirementAgentConnector_ms": 0.1711726188659668}, "num_episodes": 6, "episode_return_max": 349.749017081596, "episode_return_min": 233.85739005055422, "episode_return_mean": 323.65736793039326}, "episode_reward_max": 349.749017081596, "episode_reward_min": 233.85739005055422, "episode_reward_mean": 323.65736793039326, "episode_len_mean": 49.666666666666664, "episodes_this_iter": 6, "episodes_timesteps_total": 298, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724], "episode_lengths": [50, 48, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.140747004541857, "mean_inference_ms": 1.265608944655378, "mean_action_processing_ms": 0.21128544862242948, "mean_env_wait_ms": 523.201822321077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009802977244059244, "StateBufferConnector_ms": 0.006496906280517578, "ViewRequirementAgentConnector_ms": 0.1711726188659668}, "num_episodes": 6, "episode_return_max": 349.749017081596, "episode_return_min": 233.85739005055422, "episode_return_mean": 323.65736793039326, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52032, "num_agent_steps_trained": 52032, "num_env_steps_sampled": 52032, "num_env_steps_trained": 52032, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.232539789770577, "num_env_steps_trained_throughput_per_sec": 10.232539789770577, "timesteps_total": 52032, "num_env_steps_sampled_lifetime": 52032, "num_agent_steps_sampled_lifetime": 52032, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 52032, "timers": {"training_iteration_time_ms": 50427.375, "restore_workers_time_ms": 0.017, "training_step_time_ms": 50427.316, "sample_time_ms": 48226.592, "load_time_ms": 0.789, "load_throughput": 653657.766, "learn_time_ms": 2185.395, "learn_throughput": 236.113, "synch_weights_time_ms": 14.018}, "counters": {"num_env_steps_sampled": 52032, "num_env_steps_trained": 52032, "num_agent_steps_sampled": 52032, "num_agent_steps_trained": 52032}, "done": false, "episodes_total": 1317, "training_iteration": 85, "trial_id": "fe178_00005", "date": "2024-08-15_18-36-13", "timestamp": 1723768573, "time_this_iter_s": 50.43038606643677, "time_total_s": 5454.893051624298, "pid": 7923, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 50.43038606643677, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.02876712328767, "ram_util_percent": 11.242465753424659}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.85711948076884, "cur_kl_coeff": 0.19005811214447021, "cur_lr": 1e-05, "total_loss": 8.726852059364319, "policy_loss": -0.00795629775772492, "vf_loss": 8.727734565734863, "vf_explained_var": 0.01673898349205653, "kl": 0.03721902945593371, "entropy": -0.9383055341740449, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52548, "num_env_steps_trained": 52548, "num_agent_steps_sampled": 52548, "num_agent_steps_trained": 52548}, "sampler_results": {"episode_reward_max": 349.749017081596, "episode_reward_min": 233.85739005055422, "episode_reward_mean": 313.93133702011045, "episode_len_mean": 49.888888888888886, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 898, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.872779372237257, "mean_inference_ms": 1.262131140644455, "mean_action_processing_ms": 0.21016274861258935, "mean_env_wait_ms": 528.4646251851646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01259115007188585, "StateBufferConnector_ms": 0.006417433420817058, "ViewRequirementAgentConnector_ms": 0.16897122065226236}, "num_episodes": 12, "episode_return_max": 349.749017081596, "episode_return_min": 233.85739005055422, "episode_return_mean": 313.93133702011045}, "env_runner_results": {"episode_reward_max": 349.749017081596, "episode_reward_min": 233.85739005055422, "episode_reward_mean": 313.93133702011045, "episode_len_mean": 49.888888888888886, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 898, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.872779372237257, "mean_inference_ms": 1.262131140644455, "mean_action_processing_ms": 0.21016274861258935, "mean_env_wait_ms": 528.4646251851646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01259115007188585, "StateBufferConnector_ms": 0.006417433420817058, "ViewRequirementAgentConnector_ms": 0.16897122065226236}, "num_episodes": 12, "episode_return_max": 349.749017081596, "episode_return_min": 233.85739005055422, "episode_return_mean": 313.93133702011045}, "episode_reward_max": 349.749017081596, "episode_reward_min": 233.85739005055422, "episode_reward_mean": 313.93133702011045, "episode_len_mean": 49.888888888888886, "episodes_this_iter": 12, "episodes_timesteps_total": 898, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.872779372237257, "mean_inference_ms": 1.262131140644455, "mean_action_processing_ms": 0.21016274861258935, "mean_env_wait_ms": 528.4646251851646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01259115007188585, "StateBufferConnector_ms": 0.006417433420817058, "ViewRequirementAgentConnector_ms": 0.16897122065226236}, "num_episodes": 12, "episode_return_max": 349.749017081596, "episode_return_min": 233.85739005055422, "episode_return_mean": 313.93133702011045, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52548, "num_agent_steps_trained": 52548, "num_env_steps_sampled": 52548, "num_env_steps_trained": 52548, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.24369547075876, "num_env_steps_trained_throughput_per_sec": 10.24369547075876, "timesteps_total": 52548, "num_env_steps_sampled_lifetime": 52548, "num_agent_steps_sampled_lifetime": 52548, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 52548, "timers": {"training_iteration_time_ms": 50399.92, "restore_workers_time_ms": 0.023, "training_step_time_ms": 50399.852, "sample_time_ms": 48954.753, "load_time_ms": 0.567, "load_throughput": 909735.546, "learn_time_ms": 1430.64, "learn_throughput": 360.678, "synch_weights_time_ms": 13.512}, "counters": {"num_env_steps_sampled": 52548, "num_env_steps_trained": 52548, "num_agent_steps_sampled": 52548, "num_agent_steps_trained": 52548}, "done": false, "episodes_total": 1329, "training_iteration": 86, "trial_id": "fe178_00005", "date": "2024-08-15_18-37-03", "timestamp": 1723768623, "time_this_iter_s": 50.37525653839111, "time_total_s": 5505.268308162689, "pid": 7923, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 100.80564260482788, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.616666666666667, "ram_util_percent": 11.429166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.602887425820033, "cur_kl_coeff": 0.2850871682167053, "cur_lr": 1e-05, "total_loss": 9.437365929285685, "policy_loss": -0.0030526084417942913, "vf_loss": 9.431564927101135, "vf_explained_var": 0.04539294193188349, "kl": 0.03105583635528043, "entropy": -1.2892417992154757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53064, "num_env_steps_trained": 53064, "num_agent_steps_sampled": 53064, "num_agent_steps_trained": 53064}, "sampler_results": {"episode_reward_max": 351.47650069638956, "episode_reward_min": 229.10879723534174, "episode_reward_mean": 317.6506211371195, "episode_len_mean": 49.666666666666664, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1490, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.15295516485333, "mean_inference_ms": 1.2601027312838247, "mean_action_processing_ms": 0.20977078758350523, "mean_env_wait_ms": 535.5011414043394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012865066528320312, "StateBufferConnector_ms": 0.006516774495442708, "ViewRequirementAgentConnector_ms": 0.167845090230306}, "num_episodes": 12, "episode_return_max": 351.47650069638956, "episode_return_min": 229.10879723534174, "episode_return_mean": 317.6506211371195}, "env_runner_results": {"episode_reward_max": 351.47650069638956, "episode_reward_min": 229.10879723534174, "episode_reward_mean": 317.6506211371195, "episode_len_mean": 49.666666666666664, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1490, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.15295516485333, "mean_inference_ms": 1.2601027312838247, "mean_action_processing_ms": 0.20977078758350523, "mean_env_wait_ms": 535.5011414043394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012865066528320312, "StateBufferConnector_ms": 0.006516774495442708, "ViewRequirementAgentConnector_ms": 0.167845090230306}, "num_episodes": 12, "episode_return_max": 351.47650069638956, "episode_return_min": 229.10879723534174, "episode_return_mean": 317.6506211371195}, "episode_reward_max": 351.47650069638956, "episode_reward_min": 229.10879723534174, "episode_reward_mean": 317.6506211371195, "episode_len_mean": 49.666666666666664, "episodes_this_iter": 12, "episodes_timesteps_total": 1490, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.15295516485333, "mean_inference_ms": 1.2601027312838247, "mean_action_processing_ms": 0.20977078758350523, "mean_env_wait_ms": 535.5011414043394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012865066528320312, "StateBufferConnector_ms": 0.006516774495442708, "ViewRequirementAgentConnector_ms": 0.167845090230306}, "num_episodes": 12, "episode_return_max": 351.47650069638956, "episode_return_min": 229.10879723534174, "episode_return_mean": 317.6506211371195, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53064, "num_agent_steps_trained": 53064, "num_env_steps_sampled": 53064, "num_env_steps_trained": 53064, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.527133670937365, "num_env_steps_trained_throughput_per_sec": 9.527133670937365, "timesteps_total": 53064, "num_env_steps_sampled_lifetime": 53064, "num_agent_steps_sampled_lifetime": 53064, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 53064, "timers": {"training_iteration_time_ms": 51653.649, "restore_workers_time_ms": 0.022, "training_step_time_ms": 51653.584, "sample_time_ms": 50467.561, "load_time_ms": 0.481, "load_throughput": 1073364.621, "learn_time_ms": 1172.068, "learn_throughput": 440.247, "synch_weights_time_ms": 13.154}, "counters": {"num_env_steps_sampled": 53064, "num_env_steps_trained": 53064, "num_agent_steps_sampled": 53064, "num_agent_steps_trained": 53064}, "done": false, "episodes_total": 1341, "training_iteration": 87, "trial_id": "fe178_00005", "date": "2024-08-15_18-37-57", "timestamp": 1723768677, "time_this_iter_s": 54.16451144218445, "time_total_s": 5559.432819604874, "pid": 7923, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 154.97015404701233, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.97012987012987, "ram_util_percent": 11.276623376623377}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.06891352335612, "cur_kl_coeff": 0.427630752325058, "cur_lr": 1e-05, "total_loss": 9.386495200792949, "policy_loss": 0.005515948745111624, "vf_loss": 9.362737592061361, "vf_explained_var": 0.1600340614716212, "kl": 0.042657358302923845, "entropy": -1.5206490536530812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53580, "num_env_steps_trained": 53580, "num_agent_steps_sampled": 53580, "num_agent_steps_trained": 53580}, "sampler_results": {"episode_reward_max": 371.40796160198784, "episode_reward_min": 229.10879723534174, "episode_reward_mean": 323.9245773447008, "episode_len_mean": 49.729729729729726, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 1840, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1900773389932, "mean_inference_ms": 1.2582793711407314, "mean_action_processing_ms": 0.20954397661662758, "mean_env_wait_ms": 538.9552835433237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013214833027607686, "StateBufferConnector_ms": 0.006462432242728569, "ViewRequirementAgentConnector_ms": 0.16783959156758077}, "num_episodes": 7, "episode_return_max": 371.40796160198784, "episode_return_min": 229.10879723534174, "episode_return_mean": 323.9245773447008}, "env_runner_results": {"episode_reward_max": 371.40796160198784, "episode_reward_min": 229.10879723534174, "episode_reward_mean": 323.9245773447008, "episode_len_mean": 49.729729729729726, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 1840, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1900773389932, "mean_inference_ms": 1.2582793711407314, "mean_action_processing_ms": 0.20954397661662758, "mean_env_wait_ms": 538.9552835433237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013214833027607686, "StateBufferConnector_ms": 0.006462432242728569, "ViewRequirementAgentConnector_ms": 0.16783959156758077}, "num_episodes": 7, "episode_return_max": 371.40796160198784, "episode_return_min": 229.10879723534174, "episode_return_mean": 323.9245773447008}, "episode_reward_max": 371.40796160198784, "episode_reward_min": 229.10879723534174, "episode_reward_mean": 323.9245773447008, "episode_len_mean": 49.729729729729726, "episodes_this_iter": 7, "episodes_timesteps_total": 1840, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1900773389932, "mean_inference_ms": 1.2582793711407314, "mean_action_processing_ms": 0.20954397661662758, "mean_env_wait_ms": 538.9552835433237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013214833027607686, "StateBufferConnector_ms": 0.006462432242728569, "ViewRequirementAgentConnector_ms": 0.16783959156758077}, "num_episodes": 7, "episode_return_max": 371.40796160198784, "episode_return_min": 229.10879723534174, "episode_return_mean": 323.9245773447008, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53580, "num_agent_steps_trained": 53580, "num_env_steps_sampled": 53580, "num_env_steps_trained": 53580, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.511722516726078, "num_env_steps_trained_throughput_per_sec": 9.511722516726078, "timesteps_total": 53580, "num_env_steps_sampled_lifetime": 53580, "num_agent_steps_sampled_lifetime": 53580, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 53580, "timers": {"training_iteration_time_ms": 52302.452, "restore_workers_time_ms": 0.02, "training_step_time_ms": 52302.39, "sample_time_ms": 51241.933, "load_time_ms": 0.452, "load_throughput": 1141939.514, "learn_time_ms": 1046.36, "learn_throughput": 493.138, "synch_weights_time_ms": 13.332}, "counters": {"num_env_steps_sampled": 53580, "num_env_steps_trained": 53580, "num_agent_steps_sampled": 53580, "num_agent_steps_trained": 53580}, "done": false, "episodes_total": 1348, "training_iteration": 88, "trial_id": "fe178_00005", "date": "2024-08-15_18-38-52", "timestamp": 1723768732, "time_this_iter_s": 54.2519965171814, "time_total_s": 5613.684816122055, "pid": 7923, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 209.22215056419373, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 23.93896103896104, "ram_util_percent": 11.506493506493507}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 83.19492479165395, "cur_kl_coeff": 0.641446128487587, "cur_lr": 1e-05, "total_loss": 9.535575437545777, "policy_loss": 0.015056406039123733, "vf_loss": 9.467412749926249, "vf_explained_var": 0.05178209791580836, "kl": 0.08279148225750639, "entropy": -1.2149061739444733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "sampler_results": {"episode_reward_max": 371.40796160198784, "episode_reward_min": 229.10879723534174, "episode_reward_mean": 324.6983393503549, "episode_len_mean": 49.791666666666664, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2390, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.241694439065802, "mean_inference_ms": 1.2566704030854214, "mean_action_processing_ms": 0.20933181206940307, "mean_env_wait_ms": 540.6729382410938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013379255930582682, "StateBufferConnector_ms": 0.006447732448577881, "ViewRequirementAgentConnector_ms": 0.16871988773345947}, "num_episodes": 11, "episode_return_max": 371.40796160198784, "episode_return_min": 229.10879723534174, "episode_return_mean": 324.6983393503549}, "env_runner_results": {"episode_reward_max": 371.40796160198784, "episode_reward_min": 229.10879723534174, "episode_reward_mean": 324.6983393503549, "episode_len_mean": 49.791666666666664, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2390, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.241694439065802, "mean_inference_ms": 1.2566704030854214, "mean_action_processing_ms": 0.20933181206940307, "mean_env_wait_ms": 540.6729382410938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013379255930582682, "StateBufferConnector_ms": 0.006447732448577881, "ViewRequirementAgentConnector_ms": 0.16871988773345947}, "num_episodes": 11, "episode_return_max": 371.40796160198784, "episode_return_min": 229.10879723534174, "episode_return_mean": 324.6983393503549}, "episode_reward_max": 371.40796160198784, "episode_reward_min": 229.10879723534174, "episode_reward_mean": 324.6983393503549, "episode_len_mean": 49.791666666666664, "episodes_this_iter": 11, "episodes_timesteps_total": 2390, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.241694439065802, "mean_inference_ms": 1.2566704030854214, "mean_action_processing_ms": 0.20933181206940307, "mean_env_wait_ms": 540.6729382410938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013379255930582682, "StateBufferConnector_ms": 0.006447732448577881, "ViewRequirementAgentConnector_ms": 0.16871988773345947}, "num_episodes": 11, "episode_return_max": 371.40796160198784, "episode_return_min": 229.10879723534174, "episode_return_mean": 324.6983393503549, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096, "num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.497124688351724, "num_env_steps_trained_throughput_per_sec": 9.497124688351724, "timesteps_total": 54096, "num_env_steps_sampled_lifetime": 54096, "num_agent_steps_sampled_lifetime": 54096, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 54096, "timers": {"training_iteration_time_ms": 52708.411, "restore_workers_time_ms": 0.02, "training_step_time_ms": 52708.351, "sample_time_ms": 51721.76, "load_time_ms": 0.432, "load_throughput": 1195460.044, "learn_time_ms": 972.471, "learn_throughput": 530.607, "synch_weights_time_ms": 13.38}, "counters": {"num_env_steps_sampled": 54096, "num_env_steps_trained": 54096, "num_agent_steps_sampled": 54096, "num_agent_steps_trained": 54096}, "done": false, "episodes_total": 1359, "training_iteration": 89, "trial_id": "fe178_00005", "date": "2024-08-15_18-39-46", "timestamp": 1723768786, "time_this_iter_s": 54.335622787475586, "time_total_s": 5668.020438909531, "pid": 7923, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 263.5577733516693, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.03205128205128, "ram_util_percent": 10.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.10679492950439, "cur_kl_coeff": 0.9621691927313805, "cur_lr": 1e-05, "total_loss": 9.368121147155762, "policy_loss": 0.005385007165993254, "vf_loss": 9.318359402815501, "vf_explained_var": -0.01165311485528946, "kl": 0.046121664257957704, "entropy": -1.2929736346006393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 54612, "num_env_steps_trained": 54612, "num_agent_steps_sampled": 54612, "num_agent_steps_trained": 54612}, "sampler_results": {"episode_reward_max": 371.40796160198784, "episode_reward_min": 229.10879723534174, "episode_reward_mean": 324.9614920157695, "episode_len_mean": 49.833333333333336, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2990, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.304339722019997, "mean_inference_ms": 1.2554236848155644, "mean_action_processing_ms": 0.20917380560157445, "mean_env_wait_ms": 543.7874371899317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013355414072672525, "StateBufferConnector_ms": 0.006421407063802083, "ViewRequirementAgentConnector_ms": 0.16862193743387857}, "num_episodes": 12, "episode_return_max": 371.40796160198784, "episode_return_min": 229.10879723534174, "episode_return_mean": 324.9614920157695}, "env_runner_results": {"episode_reward_max": 371.40796160198784, "episode_reward_min": 229.10879723534174, "episode_reward_mean": 324.9614920157695, "episode_len_mean": 49.833333333333336, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2990, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.304339722019997, "mean_inference_ms": 1.2554236848155644, "mean_action_processing_ms": 0.20917380560157445, "mean_env_wait_ms": 543.7874371899317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013355414072672525, "StateBufferConnector_ms": 0.006421407063802083, "ViewRequirementAgentConnector_ms": 0.16862193743387857}, "num_episodes": 12, "episode_return_max": 371.40796160198784, "episode_return_min": 229.10879723534174, "episode_return_mean": 324.9614920157695}, "episode_reward_max": 371.40796160198784, "episode_reward_min": 229.10879723534174, "episode_reward_mean": 324.9614920157695, "episode_len_mean": 49.833333333333336, "episodes_this_iter": 12, "episodes_timesteps_total": 2990, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.304339722019997, "mean_inference_ms": 1.2554236848155644, "mean_action_processing_ms": 0.20917380560157445, "mean_env_wait_ms": 543.7874371899317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013355414072672525, "StateBufferConnector_ms": 0.006421407063802083, "ViewRequirementAgentConnector_ms": 0.16862193743387857}, "num_episodes": 12, "episode_return_max": 371.40796160198784, "episode_return_min": 229.10879723534174, "episode_return_mean": 324.9614920157695, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54612, "num_agent_steps_trained": 54612, "num_env_steps_sampled": 54612, "num_env_steps_trained": 54612, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.22444017316637, "num_env_steps_trained_throughput_per_sec": 9.22444017316637, "timesteps_total": 54612, "num_env_steps_sampled_lifetime": 54612, "num_agent_steps_sampled_lifetime": 54612, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 54612, "timers": {"training_iteration_time_ms": 53246.737, "restore_workers_time_ms": 0.019, "training_step_time_ms": 53246.679, "sample_time_ms": 52307.179, "load_time_ms": 0.416, "load_throughput": 1240856.683, "learn_time_ms": 925.384, "learn_throughput": 557.606, "synch_weights_time_ms": 13.394}, "counters": {"num_env_steps_sampled": 54612, "num_env_steps_trained": 54612, "num_agent_steps_sampled": 54612, "num_agent_steps_trained": 54612}, "done": false, "episodes_total": 1371, "training_iteration": 90, "trial_id": "fe178_00005", "date": "2024-08-15_18-40-42", "timestamp": 1723768842, "time_this_iter_s": 55.941731214523315, "time_total_s": 5723.962170124054, "pid": 7923, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 319.4995045661926, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.79375, "ram_util_percent": 11.401250000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.041781357924144, "cur_kl_coeff": 1.4432537890970707, "cur_lr": 1e-05, "total_loss": 8.851238695780436, "policy_loss": -0.005545688855151335, "vf_loss": 8.842795817057292, "vf_explained_var": 0.06905097862084707, "kl": 0.009692372824069949, "entropy": -0.946407425403595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 55128, "num_env_steps_trained": 55128, "num_agent_steps_sampled": 55128, "num_agent_steps_trained": 55128}, "sampler_results": {"episode_reward_max": 371.40796160198784, "episode_reward_min": 143.3994522522592, "episode_reward_mean": 319.7920175552297, "episode_len_mean": 49.25, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3546, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.363074304078075, "mean_inference_ms": 1.2546490527368193, "mean_action_processing_ms": 0.20910928277910493, "mean_env_wait_ms": 542.3666860780137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012858708699544271, "StateBufferConnector_ms": 0.006401538848876953, "ViewRequirementAgentConnector_ms": 0.16917818122439915}, "num_episodes": 12, "episode_return_max": 371.40796160198784, "episode_return_min": 143.3994522522592, "episode_return_mean": 319.7920175552297}, "env_runner_results": {"episode_reward_max": 371.40796160198784, "episode_reward_min": 143.3994522522592, "episode_reward_mean": 319.7920175552297, "episode_len_mean": 49.25, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3546, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.363074304078075, "mean_inference_ms": 1.2546490527368193, "mean_action_processing_ms": 0.20910928277910493, "mean_env_wait_ms": 542.3666860780137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012858708699544271, "StateBufferConnector_ms": 0.006401538848876953, "ViewRequirementAgentConnector_ms": 0.16917818122439915}, "num_episodes": 12, "episode_return_max": 371.40796160198784, "episode_return_min": 143.3994522522592, "episode_return_mean": 319.7920175552297}, "episode_reward_max": 371.40796160198784, "episode_reward_min": 143.3994522522592, "episode_reward_mean": 319.7920175552297, "episode_len_mean": 49.25, "episodes_this_iter": 12, "episodes_timesteps_total": 3546, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.363074304078075, "mean_inference_ms": 1.2546490527368193, "mean_action_processing_ms": 0.20910928277910493, "mean_env_wait_ms": 542.3666860780137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012858708699544271, "StateBufferConnector_ms": 0.006401538848876953, "ViewRequirementAgentConnector_ms": 0.16917818122439915}, "num_episodes": 12, "episode_return_max": 371.40796160198784, "episode_return_min": 143.3994522522592, "episode_return_mean": 319.7920175552297, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55128, "num_agent_steps_trained": 55128, "num_env_steps_sampled": 55128, "num_env_steps_trained": 55128, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 12.963558868715294, "num_env_steps_trained_throughput_per_sec": 12.963558868715294, "timesteps_total": 55128, "num_env_steps_sampled_lifetime": 55128, "num_agent_steps_sampled_lifetime": 55128, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 55128, "timers": {"training_iteration_time_ms": 51326.332, "restore_workers_time_ms": 0.02, "training_step_time_ms": 51326.274, "sample_time_ms": 50399.848, "load_time_ms": 0.405, "load_throughput": 1274165.353, "learn_time_ms": 912.35, "learn_throughput": 565.572, "synch_weights_time_ms": 13.371}, "counters": {"num_env_steps_sampled": 55128, "num_env_steps_trained": 55128, "num_agent_steps_sampled": 55128, "num_agent_steps_trained": 55128}, "done": false, "episodes_total": 1383, "training_iteration": 91, "trial_id": "fe178_00005", "date": "2024-08-15_18-41-22", "timestamp": 1723768882, "time_this_iter_s": 39.80702018737793, "time_total_s": 5763.769190311432, "pid": 7923, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 359.30652475357056, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 30.62982456140351, "ram_util_percent": 10.649122807017541}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.071011555194854, "cur_kl_coeff": 1.4432537890970707, "cur_lr": 1e-05, "total_loss": 9.358012588818868, "policy_loss": -0.013123759487643837, "vf_loss": 9.366871666908263, "vf_explained_var": 0.05795779724915822, "kl": 0.0029548527120065653, "entropy": -1.1355657979846001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 55644, "num_env_steps_trained": 55644, "num_agent_steps_sampled": 55644, "num_agent_steps_trained": 55644}, "sampler_results": {"episode_reward_max": 371.40796160198784, "episode_reward_min": 143.3994522522592, "episode_reward_mean": 320.51586496086696, "episode_len_mean": 49.325, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 3946, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.384983477486428, "mean_inference_ms": 1.2536991068372205, "mean_action_processing_ms": 0.20898514995816794, "mean_env_wait_ms": 541.5259133874999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012572705745697021, "StateBufferConnector_ms": 0.006386935710906982, "ViewRequirementAgentConnector_ms": 0.16905725002288818}, "num_episodes": 8, "episode_return_max": 371.40796160198784, "episode_return_min": 143.3994522522592, "episode_return_mean": 320.51586496086696}, "env_runner_results": {"episode_reward_max": 371.40796160198784, "episode_reward_min": 143.3994522522592, "episode_reward_mean": 320.51586496086696, "episode_len_mean": 49.325, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 3946, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.384983477486428, "mean_inference_ms": 1.2536991068372205, "mean_action_processing_ms": 0.20898514995816794, "mean_env_wait_ms": 541.5259133874999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012572705745697021, "StateBufferConnector_ms": 0.006386935710906982, "ViewRequirementAgentConnector_ms": 0.16905725002288818}, "num_episodes": 8, "episode_return_max": 371.40796160198784, "episode_return_min": 143.3994522522592, "episode_return_mean": 320.51586496086696}, "episode_reward_max": 371.40796160198784, "episode_reward_min": 143.3994522522592, "episode_reward_mean": 320.51586496086696, "episode_len_mean": 49.325, "episodes_this_iter": 8, "episodes_timesteps_total": 3946, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.384983477486428, "mean_inference_ms": 1.2536991068372205, "mean_action_processing_ms": 0.20898514995816794, "mean_env_wait_ms": 541.5259133874999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012572705745697021, "StateBufferConnector_ms": 0.006386935710906982, "ViewRequirementAgentConnector_ms": 0.16905725002288818}, "num_episodes": 8, "episode_return_max": 371.40796160198784, "episode_return_min": 143.3994522522592, "episode_return_mean": 320.51586496086696, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55644, "num_agent_steps_trained": 55644, "num_env_steps_sampled": 55644, "num_env_steps_trained": 55644, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.402897744164639, "num_env_steps_trained_throughput_per_sec": 10.402897744164639, "timesteps_total": 55644, "num_env_steps_sampled_lifetime": 55644, "num_agent_steps_sampled_lifetime": 55644, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 55644, "timers": {"training_iteration_time_ms": 51110.737, "restore_workers_time_ms": 0.02, "training_step_time_ms": 51110.681, "sample_time_ms": 50213.279, "load_time_ms": 0.399, "load_throughput": 1291903.217, "learn_time_ms": 883.455, "learn_throughput": 584.071, "synch_weights_time_ms": 13.256}, "counters": {"num_env_steps_sampled": 55644, "num_env_steps_trained": 55644, "num_agent_steps_sampled": 55644, "num_agent_steps_trained": 55644}, "done": false, "episodes_total": 1391, "training_iteration": 92, "trial_id": "fe178_00005", "date": "2024-08-15_18-42-11", "timestamp": 1723768931, "time_this_iter_s": 49.605220079422, "time_total_s": 5813.374410390854, "pid": 7923, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 408.91174483299255, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.895774647887325, "ram_util_percent": 10.95211267605634}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.950326232115428, "cur_kl_coeff": 0.7216268945485353, "cur_lr": 1e-05, "total_loss": 9.514432350794474, "policy_loss": -0.009004139325891931, "vf_loss": 9.522134160995483, "vf_explained_var": 0.045840670665105186, "kl": 0.0018048196020623644, "entropy": -1.2433829834063848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 56160, "num_env_steps_trained": 56160, "num_agent_steps_sampled": 56160, "num_agent_steps_trained": 56160}, "sampler_results": {"episode_reward_max": 377.0878178387562, "episode_reward_min": 117.98357481659332, "episode_reward_mean": 320.54969434574343, "episode_len_mean": 49.15217391304348, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4522, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568, 359.28574613143934, 367.9171939206945, 332.339931250848, 117.98357481659332, 377.0878178387562, 313.43268677998657, 357.432755068884, 345.7492131915316, 349.3618995853517, 321.2887570089435, 274.91689453125014, 332.5062128147595], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.419004805634515, "mean_inference_ms": 1.2534797043600872, "mean_action_processing_ms": 0.20895050928077352, "mean_env_wait_ms": 540.8634076805314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012221284534620203, "StateBufferConnector_ms": 0.006372773129007091, "ViewRequirementAgentConnector_ms": 0.16852798669234567}, "num_episodes": 12, "episode_return_max": 377.0878178387562, "episode_return_min": 117.98357481659332, "episode_return_mean": 320.54969434574343}, "env_runner_results": {"episode_reward_max": 377.0878178387562, "episode_reward_min": 117.98357481659332, "episode_reward_mean": 320.54969434574343, "episode_len_mean": 49.15217391304348, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4522, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568, 359.28574613143934, 367.9171939206945, 332.339931250848, 117.98357481659332, 377.0878178387562, 313.43268677998657, 357.432755068884, 345.7492131915316, 349.3618995853517, 321.2887570089435, 274.91689453125014, 332.5062128147595], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.419004805634515, "mean_inference_ms": 1.2534797043600872, "mean_action_processing_ms": 0.20895050928077352, "mean_env_wait_ms": 540.8634076805314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012221284534620203, "StateBufferConnector_ms": 0.006372773129007091, "ViewRequirementAgentConnector_ms": 0.16852798669234567}, "num_episodes": 12, "episode_return_max": 377.0878178387562, "episode_return_min": 117.98357481659332, "episode_return_mean": 320.54969434574343}, "episode_reward_max": 377.0878178387562, "episode_reward_min": 117.98357481659332, "episode_reward_mean": 320.54969434574343, "episode_len_mean": 49.15217391304348, "episodes_this_iter": 12, "episodes_timesteps_total": 4522, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [347.2367815689105, 233.85739005055422, 349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568, 359.28574613143934, 367.9171939206945, 332.339931250848, 117.98357481659332, 377.0878178387562, 313.43268677998657, 357.432755068884, 345.7492131915316, 349.3618995853517, 321.2887570089435, 274.91689453125014, 332.5062128147595], "episode_lengths": [50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.419004805634515, "mean_inference_ms": 1.2534797043600872, "mean_action_processing_ms": 0.20895050928077352, "mean_env_wait_ms": 540.8634076805314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012221284534620203, "StateBufferConnector_ms": 0.006372773129007091, "ViewRequirementAgentConnector_ms": 0.16852798669234567}, "num_episodes": 12, "episode_return_max": 377.0878178387562, "episode_return_min": 117.98357481659332, "episode_return_mean": 320.54969434574343, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56160, "num_agent_steps_trained": 56160, "num_env_steps_sampled": 56160, "num_env_steps_trained": 56160, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.979842658892489, "num_env_steps_trained_throughput_per_sec": 9.979842658892489, "timesteps_total": 56160, "num_env_steps_sampled_lifetime": 56160, "num_agent_steps_sampled_lifetime": 56160, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 56160, "timers": {"training_iteration_time_ms": 51176.681, "restore_workers_time_ms": 0.019, "training_step_time_ms": 51176.627, "sample_time_ms": 50304.687, "load_time_ms": 0.391, "load_throughput": 1321282.579, "learn_time_ms": 858.082, "learn_throughput": 601.341, "synch_weights_time_ms": 13.187}, "counters": {"num_env_steps_sampled": 56160, "num_env_steps_trained": 56160, "num_agent_steps_sampled": 56160, "num_agent_steps_trained": 56160}, "done": false, "episodes_total": 1403, "training_iteration": 93, "trial_id": "fe178_00005", "date": "2024-08-15_18-43-03", "timestamp": 1723768983, "time_this_iter_s": 51.70777606964111, "time_total_s": 5865.082186460495, "pid": 7923, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 460.61952090263367, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.057534246575344, "ram_util_percent": 11.14246575342466}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.498840506871542, "cur_kl_coeff": 0.3608134472742677, "cur_lr": 1e-05, "total_loss": 9.407126092910767, "policy_loss": -0.005166635445008675, "vf_loss": 9.411533935864766, "vf_explained_var": 0.022419968744119008, "kl": 0.002102792809944169, "entropy": -1.0313729832569758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 56676, "num_env_steps_trained": 56676, "num_agent_steps_sampled": 56676, "num_agent_steps_trained": 56676}, "sampler_results": {"episode_reward_max": 377.0878178387562, "episode_reward_min": 113.0224365234377, "episode_reward_mean": 317.63636023628544, "episode_len_mean": 48.74, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4874, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568, 359.28574613143934, 367.9171939206945, 332.339931250848, 117.98357481659332, 377.0878178387562, 313.43268677998657, 357.432755068884, 345.7492131915316, 349.3618995853517, 321.2887570089435, 274.91689453125014, 332.5062128147595, 348.91904924166715, 297.01688802403476, 330.22571577703775, 338.8415047674474, 113.0224365234377, 333.84314673076364, 152.95821758216044, 335.87110695649085, 330.4448011314951, 273.0154487050753], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 29, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.464669630282733, "mean_inference_ms": 1.252230441632312, "mean_action_processing_ms": 0.20886113466513045, "mean_env_wait_ms": 540.865016006953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012024164199829102, "StateBufferConnector_ms": 0.0063440799713134766, "ViewRequirementAgentConnector_ms": 0.16822552680969238}, "num_episodes": 10, "episode_return_max": 377.0878178387562, "episode_return_min": 113.0224365234377, "episode_return_mean": 317.63636023628544}, "env_runner_results": {"episode_reward_max": 377.0878178387562, "episode_reward_min": 113.0224365234377, "episode_reward_mean": 317.63636023628544, "episode_len_mean": 48.74, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4874, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568, 359.28574613143934, 367.9171939206945, 332.339931250848, 117.98357481659332, 377.0878178387562, 313.43268677998657, 357.432755068884, 345.7492131915316, 349.3618995853517, 321.2887570089435, 274.91689453125014, 332.5062128147595, 348.91904924166715, 297.01688802403476, 330.22571577703775, 338.8415047674474, 113.0224365234377, 333.84314673076364, 152.95821758216044, 335.87110695649085, 330.4448011314951, 273.0154487050753], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 29, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.464669630282733, "mean_inference_ms": 1.252230441632312, "mean_action_processing_ms": 0.20886113466513045, "mean_env_wait_ms": 540.865016006953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012024164199829102, "StateBufferConnector_ms": 0.0063440799713134766, "ViewRequirementAgentConnector_ms": 0.16822552680969238}, "num_episodes": 10, "episode_return_max": 377.0878178387562, "episode_return_min": 113.0224365234377, "episode_return_mean": 317.63636023628544}, "episode_reward_max": 377.0878178387562, "episode_reward_min": 113.0224365234377, "episode_reward_mean": 317.63636023628544, "episode_len_mean": 48.74, "episodes_this_iter": 10, "episodes_timesteps_total": 4874, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [349.749017081596, 345.17378411766896, 336.9761084059724, 328.95112635765724, 344.9017562269557, 310.1120366426078, 312.98433931369436, 315.03300591877405, 277.9977340926033, 335.4315854728819, 348.23147048768493, 345.0992920764176, 278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568, 359.28574613143934, 367.9171939206945, 332.339931250848, 117.98357481659332, 377.0878178387562, 313.43268677998657, 357.432755068884, 345.7492131915316, 349.3618995853517, 321.2887570089435, 274.91689453125014, 332.5062128147595, 348.91904924166715, 297.01688802403476, 330.22571577703775, 338.8415047674474, 113.0224365234377, 333.84314673076364, 152.95821758216044, 335.87110695649085, 330.4448011314951, 273.0154487050753], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 29, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.464669630282733, "mean_inference_ms": 1.252230441632312, "mean_action_processing_ms": 0.20886113466513045, "mean_env_wait_ms": 540.865016006953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012024164199829102, "StateBufferConnector_ms": 0.0063440799713134766, "ViewRequirementAgentConnector_ms": 0.16822552680969238}, "num_episodes": 10, "episode_return_max": 377.0878178387562, "episode_return_min": 113.0224365234377, "episode_return_mean": 317.63636023628544, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56676, "num_agent_steps_trained": 56676, "num_env_steps_sampled": 56676, "num_env_steps_trained": 56676, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.797085370755475, "num_env_steps_trained_throughput_per_sec": 9.797085370755475, "timesteps_total": 56676, "num_env_steps_sampled_lifetime": 56676, "num_agent_steps_sampled_lifetime": 56676, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 56676, "timers": {"training_iteration_time_ms": 51325.887, "restore_workers_time_ms": 0.018, "training_step_time_ms": 51325.834, "sample_time_ms": 50477.426, "load_time_ms": 0.379, "load_throughput": 1361855.565, "learn_time_ms": 834.613, "learn_throughput": 618.25, "synch_weights_time_ms": 13.14}, "counters": {"num_env_steps_sampled": 56676, "num_env_steps_trained": 56676, "num_agent_steps_sampled": 56676, "num_agent_steps_trained": 56676}, "done": false, "episodes_total": 1413, "training_iteration": 94, "trial_id": "fe178_00005", "date": "2024-08-15_18-43-56", "timestamp": 1723769036, "time_this_iter_s": 52.67270541191101, "time_total_s": 5917.754891872406, "pid": 7923, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 513.2922263145447, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.205263157894738, "ram_util_percent": 11.443421052631582}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.357586765289307, "cur_kl_coeff": 0.18040672363713384, "cur_lr": 1e-05, "total_loss": 9.126597416400909, "policy_loss": -0.006693259603343904, "vf_loss": 9.132549591859181, "vf_explained_var": 0.04312401463588079, "kl": 0.004108131013351817, "entropy": -1.0249339620272317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 57192, "num_env_steps_trained": 57192, "num_agent_steps_sampled": 57192, "num_agent_steps_trained": 57192}, "sampler_results": {"episode_reward_max": 377.0878178387562, "episode_reward_min": 113.0224365234377, "episode_reward_mean": 316.05777022701926, "episode_len_mean": 48.54, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4854, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568, 359.28574613143934, 367.9171939206945, 332.339931250848, 117.98357481659332, 377.0878178387562, 313.43268677998657, 357.432755068884, 345.7492131915316, 349.3618995853517, 321.2887570089435, 274.91689453125014, 332.5062128147595, 348.91904924166715, 297.01688802403476, 330.22571577703775, 338.8415047674474, 113.0224365234377, 333.84314673076364, 152.95821758216044, 335.87110695649085, 330.4448011314951, 273.0154487050753, 328.83080317045165, 168.30657958984375, 346.1566714659191, 338.3490656515839, 332.0469606543048, 328.1868542487085, 327.8835511015208, 320.76578161202224, 341.09340385299424, 284.98280429184604, 331.48918973453925, 344.69058989416095], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 29, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.558782128032802, "mean_inference_ms": 1.2499720892246209, "mean_action_processing_ms": 0.20853516740609912, "mean_env_wait_ms": 542.2322364804692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011717796325683594, "StateBufferConnector_ms": 0.006342172622680664, "ViewRequirementAgentConnector_ms": 0.16868972778320312}, "num_episodes": 12, "episode_return_max": 377.0878178387562, "episode_return_min": 113.0224365234377, "episode_return_mean": 316.05777022701926}, "env_runner_results": {"episode_reward_max": 377.0878178387562, "episode_reward_min": 113.0224365234377, "episode_reward_mean": 316.05777022701926, "episode_len_mean": 48.54, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4854, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568, 359.28574613143934, 367.9171939206945, 332.339931250848, 117.98357481659332, 377.0878178387562, 313.43268677998657, 357.432755068884, 345.7492131915316, 349.3618995853517, 321.2887570089435, 274.91689453125014, 332.5062128147595, 348.91904924166715, 297.01688802403476, 330.22571577703775, 338.8415047674474, 113.0224365234377, 333.84314673076364, 152.95821758216044, 335.87110695649085, 330.4448011314951, 273.0154487050753, 328.83080317045165, 168.30657958984375, 346.1566714659191, 338.3490656515839, 332.0469606543048, 328.1868542487085, 327.8835511015208, 320.76578161202224, 341.09340385299424, 284.98280429184604, 331.48918973453925, 344.69058989416095], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 29, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.558782128032802, "mean_inference_ms": 1.2499720892246209, "mean_action_processing_ms": 0.20853516740609912, "mean_env_wait_ms": 542.2322364804692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011717796325683594, "StateBufferConnector_ms": 0.006342172622680664, "ViewRequirementAgentConnector_ms": 0.16868972778320312}, "num_episodes": 12, "episode_return_max": 377.0878178387562, "episode_return_min": 113.0224365234377, "episode_return_mean": 316.05777022701926}, "episode_reward_max": 377.0878178387562, "episode_reward_min": 113.0224365234377, "episode_reward_mean": 316.05777022701926, "episode_len_mean": 48.54, "episodes_this_iter": 12, "episodes_timesteps_total": 4854, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [278.6373115144069, 265.28832710971557, 319.62096704144795, 255.48203288243803, 319.27991587874646, 339.18254054700503, 327.24815439091554, 336.6216944953373, 334.0796397798675, 330.73017598928277, 322.98507367349583, 346.52342757734124, 229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568, 359.28574613143934, 367.9171939206945, 332.339931250848, 117.98357481659332, 377.0878178387562, 313.43268677998657, 357.432755068884, 345.7492131915316, 349.3618995853517, 321.2887570089435, 274.91689453125014, 332.5062128147595, 348.91904924166715, 297.01688802403476, 330.22571577703775, 338.8415047674474, 113.0224365234377, 333.84314673076364, 152.95821758216044, 335.87110695649085, 330.4448011314951, 273.0154487050753, 328.83080317045165, 168.30657958984375, 346.1566714659191, 338.3490656515839, 332.0469606543048, 328.1868542487085, 327.8835511015208, 320.76578161202224, 341.09340385299424, 284.98280429184604, 331.48918973453925, 344.69058989416095], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 29, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.558782128032802, "mean_inference_ms": 1.2499720892246209, "mean_action_processing_ms": 0.20853516740609912, "mean_env_wait_ms": 542.2322364804692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011717796325683594, "StateBufferConnector_ms": 0.006342172622680664, "ViewRequirementAgentConnector_ms": 0.16868972778320312}, "num_episodes": 12, "episode_return_max": 377.0878178387562, "episode_return_min": 113.0224365234377, "episode_return_mean": 316.05777022701926, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57192, "num_agent_steps_trained": 57192, "num_env_steps_sampled": 57192, "num_env_steps_trained": 57192, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.361566490946501, "num_env_steps_trained_throughput_per_sec": 9.361566490946501, "timesteps_total": 57192, "num_env_steps_sampled_lifetime": 57192, "num_agent_steps_sampled_lifetime": 57192, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 57192, "timers": {"training_iteration_time_ms": 51795.048, "restore_workers_time_ms": 0.018, "training_step_time_ms": 51794.997, "sample_time_ms": 51101.322, "load_time_ms": 0.333, "load_throughput": 1550996.749, "learn_time_ms": 680.118, "learn_throughput": 758.692, "synch_weights_time_ms": 12.981}, "counters": {"num_env_steps_sampled": 57192, "num_env_steps_trained": 57192, "num_agent_steps_sampled": 57192, "num_agent_steps_trained": 57192}, "done": false, "episodes_total": 1425, "training_iteration": 95, "trial_id": "fe178_00005", "date": "2024-08-15_18-44-51", "timestamp": 1723769091, "time_this_iter_s": 55.12239646911621, "time_total_s": 5972.877288341522, "pid": 7923, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 568.4146227836609, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.183333333333334, "ram_util_percent": 11.475641025641027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.942201803127924, "cur_kl_coeff": 0.09020336181856692, "cur_lr": 1e-05, "total_loss": 9.400849596659343, "policy_loss": -0.006851708811397354, "vf_loss": 9.407238976160686, "vf_explained_var": 0.04643116941054662, "kl": 0.005124285047354086, "entropy": -1.0229233612616857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 57708, "num_env_steps_trained": 57708, "num_agent_steps_sampled": 57708, "num_agent_steps_trained": 57708}, "sampler_results": {"episode_reward_max": 377.0878178387562, "episode_reward_min": 113.0224365234377, "episode_reward_mean": 316.385525147339, "episode_len_mean": 48.43, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4843, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568, 359.28574613143934, 367.9171939206945, 332.339931250848, 117.98357481659332, 377.0878178387562, 313.43268677998657, 357.432755068884, 345.7492131915316, 349.3618995853517, 321.2887570089435, 274.91689453125014, 332.5062128147595, 348.91904924166715, 297.01688802403476, 330.22571577703775, 338.8415047674474, 113.0224365234377, 333.84314673076364, 152.95821758216044, 335.87110695649085, 330.4448011314951, 273.0154487050753, 328.83080317045165, 168.30657958984375, 346.1566714659191, 338.3490656515839, 332.0469606543048, 328.1868542487085, 327.8835511015208, 320.76578161202224, 341.09340385299424, 284.98280429184604, 331.48918973453925, 344.69058989416095, 337.19971165419105, 359.50047082123615, 319.68179385091986, 320.74964160613376, 348.6022346535276, 331.0746810850574, 333.7645139448213, 334.9055259178236, 186.2095535351782, 287.4733639872848, 318.25270580838475, 331.0405560474242], "episode_lengths": [42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 29, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 39, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.589202743545831, "mean_inference_ms": 1.2489169199878258, "mean_action_processing_ms": 0.20843863025677842, "mean_env_wait_ms": 541.5559724703027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011336803436279297, "StateBufferConnector_ms": 0.006362438201904297, "ViewRequirementAgentConnector_ms": 0.16965174674987793}, "num_episodes": 12, "episode_return_max": 377.0878178387562, "episode_return_min": 113.0224365234377, "episode_return_mean": 316.385525147339}, "env_runner_results": {"episode_reward_max": 377.0878178387562, "episode_reward_min": 113.0224365234377, "episode_reward_mean": 316.385525147339, "episode_len_mean": 48.43, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4843, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568, 359.28574613143934, 367.9171939206945, 332.339931250848, 117.98357481659332, 377.0878178387562, 313.43268677998657, 357.432755068884, 345.7492131915316, 349.3618995853517, 321.2887570089435, 274.91689453125014, 332.5062128147595, 348.91904924166715, 297.01688802403476, 330.22571577703775, 338.8415047674474, 113.0224365234377, 333.84314673076364, 152.95821758216044, 335.87110695649085, 330.4448011314951, 273.0154487050753, 328.83080317045165, 168.30657958984375, 346.1566714659191, 338.3490656515839, 332.0469606543048, 328.1868542487085, 327.8835511015208, 320.76578161202224, 341.09340385299424, 284.98280429184604, 331.48918973453925, 344.69058989416095, 337.19971165419105, 359.50047082123615, 319.68179385091986, 320.74964160613376, 348.6022346535276, 331.0746810850574, 333.7645139448213, 334.9055259178236, 186.2095535351782, 287.4733639872848, 318.25270580838475, 331.0405560474242], "episode_lengths": [42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 29, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 39, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.589202743545831, "mean_inference_ms": 1.2489169199878258, "mean_action_processing_ms": 0.20843863025677842, "mean_env_wait_ms": 541.5559724703027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011336803436279297, "StateBufferConnector_ms": 0.006362438201904297, "ViewRequirementAgentConnector_ms": 0.16965174674987793}, "num_episodes": 12, "episode_return_max": 377.0878178387562, "episode_return_min": 113.0224365234377, "episode_return_mean": 316.385525147339}, "episode_reward_max": 377.0878178387562, "episode_reward_min": 113.0224365234377, "episode_reward_mean": 316.385525147339, "episode_len_mean": 48.43, "episodes_this_iter": 12, "episodes_timesteps_total": 4843, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [229.10879723534174, 311.9713751247669, 329.54727236310663, 351.47650069638956, 366.0174506565123, 325.2879272460941, 371.40796160198784, 352.37902718982474, 348.7591417328628, 346.1327148437499, 345.7065043693142, 355.92154483018663, 348.73898925781236, 329.02940668721493, 297.5247863350507, 307.22663873269, 330.06772552310656, 311.4643310374425, 316.3603227535478, 331.09372782585825, 325.07919192320827, 347.8042621569884, 343.60421142578116, 327.97904265789805, 348.6225576548348, 305.27300233819, 351.85585743196646, 349.34406355996254, 312.00109955450785, 337.2281142880656, 294.9216187139794, 332.1015875947932, 300.7332082640654, 308.50486864509406, 341.3759172968888, 280.01492585089585, 347.15776532985745, 328.6162537098552, 313.1332878743403, 336.04359077174036, 301.42903008264454, 337.4838513952421, 329.14262523596847, 143.57413170771713, 143.3994522522592, 325.96491152294897, 349.0051682475001, 356.95278309343917, 300.66990582408573, 282.8791220605157, 283.2982063979661, 354.64100706599646, 353.41727897776536, 335.3804612255568, 359.28574613143934, 367.9171939206945, 332.339931250848, 117.98357481659332, 377.0878178387562, 313.43268677998657, 357.432755068884, 345.7492131915316, 349.3618995853517, 321.2887570089435, 274.91689453125014, 332.5062128147595, 348.91904924166715, 297.01688802403476, 330.22571577703775, 338.8415047674474, 113.0224365234377, 333.84314673076364, 152.95821758216044, 335.87110695649085, 330.4448011314951, 273.0154487050753, 328.83080317045165, 168.30657958984375, 346.1566714659191, 338.3490656515839, 332.0469606543048, 328.1868542487085, 327.8835511015208, 320.76578161202224, 341.09340385299424, 284.98280429184604, 331.48918973453925, 344.69058989416095, 337.19971165419105, 359.50047082123615, 319.68179385091986, 320.74964160613376, 348.6022346535276, 331.0746810850574, 333.7645139448213, 334.9055259178236, 186.2095535351782, 287.4733639872848, 318.25270580838475, 331.0405560474242], "episode_lengths": [42, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 29, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 39, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.589202743545831, "mean_inference_ms": 1.2489169199878258, "mean_action_processing_ms": 0.20843863025677842, "mean_env_wait_ms": 541.5559724703027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011336803436279297, "StateBufferConnector_ms": 0.006362438201904297, "ViewRequirementAgentConnector_ms": 0.16965174674987793}, "num_episodes": 12, "episode_return_max": 377.0878178387562, "episode_return_min": 113.0224365234377, "episode_return_mean": 316.385525147339, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57708, "num_agent_steps_trained": 57708, "num_env_steps_sampled": 57708, "num_env_steps_trained": 57708, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.947726918822253, "num_env_steps_trained_throughput_per_sec": 10.947726918822253, "timesteps_total": 57708, "num_env_steps_sampled_lifetime": 57708, "num_agent_steps_sampled_lifetime": 57708, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 57708, "timers": {"training_iteration_time_ms": 51471.11, "restore_workers_time_ms": 0.017, "training_step_time_ms": 51471.063, "sample_time_ms": 50787.176, "load_time_ms": 0.326, "load_throughput": 1583682.763, "learn_time_ms": 670.366, "learn_throughput": 769.729, "synch_weights_time_ms": 12.951}, "counters": {"num_env_steps_sampled": 57708, "num_env_steps_trained": 57708, "num_agent_steps_sampled": 57708, "num_agent_steps_trained": 57708}, "done": false, "episodes_total": 1437, "training_iteration": 96, "trial_id": "fe178_00005", "date": "2024-08-15_18-45-38", "timestamp": 1723769138, "time_this_iter_s": 47.13709902763367, "time_total_s": 6020.014387369156, "pid": 7923, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 615.5517218112946, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 27.2764705882353, "ram_util_percent": 10.623529411764704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.038336656490962, "cur_kl_coeff": 0.09020336181856692, "cur_lr": 1e-05, "total_loss": 9.285490655899048, "policy_loss": -0.010102772278090318, "vf_loss": 9.295035489400227, "vf_explained_var": 0.10680774251619975, "kl": 0.006186053111229784, "entropy": -1.256486529111862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 58224, "num_env_steps_trained": 58224, "num_agent_steps_sampled": 58224, "num_agent_steps_trained": 58224}, "sampler_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 122.48404541015623, "episode_reward_mean": 304.6735492505221, "episode_len_mean": 45.857142857142854, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 321, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933], "episode_lengths": [50, 50, 50, 21, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.756002394828108, "mean_inference_ms": 1.2692328548587992, "mean_action_processing_ms": 0.20779764710975984, "mean_env_wait_ms": 489.9205860050245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009352820260184152, "StateBufferConnector_ms": 0.006106921604701451, "ViewRequirementAgentConnector_ms": 0.16680785587855748}, "num_episodes": 7, "episode_return_max": 365.38519840808345, "episode_return_min": 122.48404541015623, "episode_return_mean": 304.6735492505221}, "env_runner_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 122.48404541015623, "episode_reward_mean": 304.6735492505221, "episode_len_mean": 45.857142857142854, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 321, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933], "episode_lengths": [50, 50, 50, 21, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.756002394828108, "mean_inference_ms": 1.2692328548587992, "mean_action_processing_ms": 0.20779764710975984, "mean_env_wait_ms": 489.9205860050245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009352820260184152, "StateBufferConnector_ms": 0.006106921604701451, "ViewRequirementAgentConnector_ms": 0.16680785587855748}, "num_episodes": 7, "episode_return_max": 365.38519840808345, "episode_return_min": 122.48404541015623, "episode_return_mean": 304.6735492505221}, "episode_reward_max": 365.38519840808345, "episode_reward_min": 122.48404541015623, "episode_reward_mean": 304.6735492505221, "episode_len_mean": 45.857142857142854, "episodes_this_iter": 7, "episodes_timesteps_total": 321, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933], "episode_lengths": [50, 50, 50, 21, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.756002394828108, "mean_inference_ms": 1.2692328548587992, "mean_action_processing_ms": 0.20779764710975984, "mean_env_wait_ms": 489.9205860050245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009352820260184152, "StateBufferConnector_ms": 0.006106921604701451, "ViewRequirementAgentConnector_ms": 0.16680785587855748}, "num_episodes": 7, "episode_return_max": 365.38519840808345, "episode_return_min": 122.48404541015623, "episode_return_mean": 304.6735492505221, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58224, "num_agent_steps_trained": 58224, "num_env_steps_sampled": 58224, "num_env_steps_trained": 58224, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.437675389322012, "num_env_steps_trained_throughput_per_sec": 10.437675389322012, "timesteps_total": 58224, "num_env_steps_sampled_lifetime": 58224, "num_agent_steps_sampled_lifetime": 58224, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 58224, "timers": {"training_iteration_time_ms": 49436.309, "restore_workers_time_ms": 0.02, "training_step_time_ms": 49436.245, "sample_time_ms": 45901.786, "load_time_ms": 0.813, "load_throughput": 634308.577, "learn_time_ms": 3519.663, "learn_throughput": 146.605, "synch_weights_time_ms": 13.495}, "counters": {"num_env_steps_sampled": 58224, "num_env_steps_trained": 58224, "num_agent_steps_sampled": 58224, "num_agent_steps_trained": 58224}, "done": false, "episodes_total": 1444, "training_iteration": 97, "trial_id": "fe178_00005", "date": "2024-08-15_18-46-46", "timestamp": 1723769206, "time_this_iter_s": 49.43941688537598, "time_total_s": 6069.453804254532, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 49.43941688537598, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 22.498591549295778, "ram_util_percent": 10.299999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.918760788440704, "cur_kl_coeff": 0.09020336181856692, "cur_lr": 1e-05, "total_loss": 9.217652503649393, "policy_loss": -0.012865735016142328, "vf_loss": 9.22902573744456, "vf_explained_var": 0.07483782966931661, "kl": 0.01654565319812112, "entropy": -1.138959409793218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 58740, "num_env_steps_trained": 58740, "num_agent_steps_sampled": 58740, "num_agent_steps_trained": 58740}, "sampler_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 122.48404541015623, "episode_reward_mean": 318.0453608173858, "episode_len_mean": 48.473684210526315, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 921, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.161948298401156, "mean_inference_ms": 1.2640051585633187, "mean_action_processing_ms": 0.20675025484449194, "mean_env_wait_ms": 499.5499391910518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01178540681537829, "StateBufferConnector_ms": 0.006108534963507401, "ViewRequirementAgentConnector_ms": 0.1668616345054225}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 122.48404541015623, "episode_return_mean": 318.0453608173858}, "env_runner_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 122.48404541015623, "episode_reward_mean": 318.0453608173858, "episode_len_mean": 48.473684210526315, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 921, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.161948298401156, "mean_inference_ms": 1.2640051585633187, "mean_action_processing_ms": 0.20675025484449194, "mean_env_wait_ms": 499.5499391910518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01178540681537829, "StateBufferConnector_ms": 0.006108534963507401, "ViewRequirementAgentConnector_ms": 0.1668616345054225}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 122.48404541015623, "episode_return_mean": 318.0453608173858}, "episode_reward_max": 365.38519840808345, "episode_reward_min": 122.48404541015623, "episode_reward_mean": 318.0453608173858, "episode_len_mean": 48.473684210526315, "episodes_this_iter": 12, "episodes_timesteps_total": 921, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.161948298401156, "mean_inference_ms": 1.2640051585633187, "mean_action_processing_ms": 0.20675025484449194, "mean_env_wait_ms": 499.5499391910518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01178540681537829, "StateBufferConnector_ms": 0.006108534963507401, "ViewRequirementAgentConnector_ms": 0.1668616345054225}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 122.48404541015623, "episode_return_mean": 318.0453608173858, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58740, "num_agent_steps_trained": 58740, "num_env_steps_sampled": 58740, "num_env_steps_trained": 58740, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.524621297286734, "num_env_steps_trained_throughput_per_sec": 10.524621297286734, "timesteps_total": 58740, "num_env_steps_sampled_lifetime": 58740, "num_agent_steps_sampled_lifetime": 58740, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 58740, "timers": {"training_iteration_time_ms": 49232.108, "restore_workers_time_ms": 0.021, "training_step_time_ms": 49232.044, "sample_time_ms": 47181.074, "load_time_ms": 0.589, "load_throughput": 875510.058, "learn_time_ms": 2036.666, "learn_throughput": 253.355, "synch_weights_time_ms": 13.327}, "counters": {"num_env_steps_sampled": 58740, "num_env_steps_trained": 58740, "num_agent_steps_sampled": 58740, "num_agent_steps_trained": 58740}, "done": false, "episodes_total": 1456, "training_iteration": 98, "trial_id": "fe178_00005", "date": "2024-08-15_18-47-35", "timestamp": 1723769255, "time_this_iter_s": 49.03153872489929, "time_total_s": 6118.485342979431, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 98.47095561027527, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 21.91571428571429, "ram_util_percent": 10.144285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.3150787572066, "cur_kl_coeff": 0.09020336181856692, "cur_lr": 1e-05, "total_loss": 9.519380036989848, "policy_loss": -0.0021381714226057134, "vf_loss": 9.52062418460846, "vf_explained_var": 0.017751688261826833, "kl": 0.009910430610766867, "entropy": -1.6576506704092027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 59256, "num_env_steps_trained": 59256, "num_agent_steps_sampled": 59256, "num_agent_steps_trained": 59256}, "sampler_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 122.48404541015623, "episode_reward_mean": 324.91685376460583, "episode_len_mean": 49.03333333333333, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1471, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.307434004940104, "mean_inference_ms": 1.2600958066066346, "mean_action_processing_ms": 0.2062315003207792, "mean_env_wait_ms": 490.35578484087756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011940797170003256, "StateBufferConnector_ms": 0.006006558736165364, "ViewRequirementAgentConnector_ms": 0.16493717829386392}, "num_episodes": 11, "episode_return_max": 365.38519840808345, "episode_return_min": 122.48404541015623, "episode_return_mean": 324.91685376460583}, "env_runner_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 122.48404541015623, "episode_reward_mean": 324.91685376460583, "episode_len_mean": 49.03333333333333, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1471, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.307434004940104, "mean_inference_ms": 1.2600958066066346, "mean_action_processing_ms": 0.2062315003207792, "mean_env_wait_ms": 490.35578484087756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011940797170003256, "StateBufferConnector_ms": 0.006006558736165364, "ViewRequirementAgentConnector_ms": 0.16493717829386392}, "num_episodes": 11, "episode_return_max": 365.38519840808345, "episode_return_min": 122.48404541015623, "episode_return_mean": 324.91685376460583}, "episode_reward_max": 365.38519840808345, "episode_reward_min": 122.48404541015623, "episode_reward_mean": 324.91685376460583, "episode_len_mean": 49.03333333333333, "episodes_this_iter": 11, "episodes_timesteps_total": 1471, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.307434004940104, "mean_inference_ms": 1.2600958066066346, "mean_action_processing_ms": 0.2062315003207792, "mean_env_wait_ms": 490.35578484087756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011940797170003256, "StateBufferConnector_ms": 0.006006558736165364, "ViewRequirementAgentConnector_ms": 0.16493717829386392}, "num_episodes": 11, "episode_return_max": 365.38519840808345, "episode_return_min": 122.48404541015623, "episode_return_mean": 324.91685376460583, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59256, "num_agent_steps_trained": 59256, "num_env_steps_sampled": 59256, "num_env_steps_trained": 59256, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.162802797529638, "num_env_steps_trained_throughput_per_sec": 13.162802797529638, "timesteps_total": 59256, "num_env_steps_sampled_lifetime": 59256, "num_agent_steps_sampled_lifetime": 59256, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 59256, "timers": {"training_iteration_time_ms": 45888.535, "restore_workers_time_ms": 0.019, "training_step_time_ms": 45888.475, "sample_time_ms": 44271.606, "load_time_ms": 0.5, "load_throughput": 1032895.735, "learn_time_ms": 1602.738, "learn_throughput": 321.949, "synch_weights_time_ms": 13.296}, "counters": {"num_env_steps_sampled": 59256, "num_env_steps_trained": 59256, "num_agent_steps_sampled": 59256, "num_agent_steps_trained": 59256}, "done": false, "episodes_total": 1467, "training_iteration": 99, "trial_id": "fe178_00005", "date": "2024-08-15_18-48-14", "timestamp": 1723769294, "time_this_iter_s": 39.20447850227356, "time_total_s": 6157.689821481705, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 137.67543411254883, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.79642857142857, "ram_util_percent": 10.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.682000462214152, "cur_kl_coeff": 0.09020336181856692, "cur_lr": 1e-05, "total_loss": 9.168038082122802, "policy_loss": -0.003927705343812704, "vf_loss": 9.171714369455973, "vf_explained_var": 0.06353003382682801, "kl": 0.00278859267758621, "entropy": -1.160874180495739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 59772, "num_env_steps_trained": 59772, "num_agent_steps_sampled": 59772, "num_agent_steps_trained": 59772}, "sampler_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 122.48404541015623, "episode_reward_mean": 323.75539034779393, "episode_len_mean": 48.76315789473684, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 1853, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.334968313261403, "mean_inference_ms": 1.2574461837481585, "mean_action_processing_ms": 0.20589290602832713, "mean_env_wait_ms": 489.48941334862906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012262871390894839, "StateBufferConnector_ms": 0.005967993485300164, "ViewRequirementAgentConnector_ms": 0.16477108001708984}, "num_episodes": 8, "episode_return_max": 365.38519840808345, "episode_return_min": 122.48404541015623, "episode_return_mean": 323.75539034779393}, "env_runner_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 122.48404541015623, "episode_reward_mean": 323.75539034779393, "episode_len_mean": 48.76315789473684, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 1853, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.334968313261403, "mean_inference_ms": 1.2574461837481585, "mean_action_processing_ms": 0.20589290602832713, "mean_env_wait_ms": 489.48941334862906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012262871390894839, "StateBufferConnector_ms": 0.005967993485300164, "ViewRequirementAgentConnector_ms": 0.16477108001708984}, "num_episodes": 8, "episode_return_max": 365.38519840808345, "episode_return_min": 122.48404541015623, "episode_return_mean": 323.75539034779393}, "episode_reward_max": 365.38519840808345, "episode_reward_min": 122.48404541015623, "episode_reward_mean": 323.75539034779393, "episode_len_mean": 48.76315789473684, "episodes_this_iter": 8, "episodes_timesteps_total": 1853, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.334968313261403, "mean_inference_ms": 1.2574461837481585, "mean_action_processing_ms": 0.20589290602832713, "mean_env_wait_ms": 489.48941334862906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012262871390894839, "StateBufferConnector_ms": 0.005967993485300164, "ViewRequirementAgentConnector_ms": 0.16477108001708984}, "num_episodes": 8, "episode_return_max": 365.38519840808345, "episode_return_min": 122.48404541015623, "episode_return_mean": 323.75539034779393, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59772, "num_agent_steps_trained": 59772, "num_env_steps_sampled": 59772, "num_env_steps_trained": 59772, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.403273282837747, "num_env_steps_trained_throughput_per_sec": 10.403273282837747, "timesteps_total": 59772, "num_env_steps_sampled_lifetime": 59772, "num_agent_steps_sampled_lifetime": 59772, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 59772, "timers": {"training_iteration_time_ms": 46816.347, "restore_workers_time_ms": 0.018, "training_step_time_ms": 46816.288, "sample_time_ms": 45433.822, "load_time_ms": 0.448, "load_throughput": 1150743.514, "learn_time_ms": 1368.334, "learn_throughput": 377.101, "synch_weights_time_ms": 13.356}, "counters": {"num_env_steps_sampled": 59772, "num_env_steps_trained": 59772, "num_agent_steps_sampled": 59772, "num_agent_steps_trained": 59772}, "done": false, "episodes_total": 1475, "training_iteration": 100, "trial_id": "fe178_00005", "date": "2024-08-15_18-49-04", "timestamp": 1723769344, "time_this_iter_s": 49.60271406173706, "time_total_s": 6207.292535543442, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 187.2781481742859, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 20.374647887323945, "ram_util_percent": 10.402816901408448}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.436262953281403, "cur_kl_coeff": 0.04510168090928346, "cur_lr": 1e-05, "total_loss": 9.318826619784037, "policy_loss": -0.0007476815953850746, "vf_loss": 9.319246395428975, "vf_explained_var": 0.014879879852135977, "kl": 0.007271571569927042, "entropy": -1.5474976708491643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 60288, "num_env_steps_trained": 60288, "num_agent_steps_sampled": 60288, "num_agent_steps_trained": 60288}, "sampler_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 116.7049180409162, "episode_reward_mean": 321.5635697071319, "episode_len_mean": 48.5, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2425, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.387902879569449, "mean_inference_ms": 1.2546623621795003, "mean_action_processing_ms": 0.20562214310689317, "mean_env_wait_ms": 488.908737747998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011951923370361328, "StateBufferConnector_ms": 0.005935192108154297, "ViewRequirementAgentConnector_ms": 0.16461515426635742}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 116.7049180409162, "episode_return_mean": 321.5635697071319}, "env_runner_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 116.7049180409162, "episode_reward_mean": 321.5635697071319, "episode_len_mean": 48.5, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2425, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.387902879569449, "mean_inference_ms": 1.2546623621795003, "mean_action_processing_ms": 0.20562214310689317, "mean_env_wait_ms": 488.908737747998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011951923370361328, "StateBufferConnector_ms": 0.005935192108154297, "ViewRequirementAgentConnector_ms": 0.16461515426635742}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 116.7049180409162, "episode_return_mean": 321.5635697071319}, "episode_reward_max": 365.38519840808345, "episode_reward_min": 116.7049180409162, "episode_reward_mean": 321.5635697071319, "episode_len_mean": 48.5, "episodes_this_iter": 12, "episodes_timesteps_total": 2425, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.387902879569449, "mean_inference_ms": 1.2546623621795003, "mean_action_processing_ms": 0.20562214310689317, "mean_env_wait_ms": 488.908737747998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011951923370361328, "StateBufferConnector_ms": 0.005935192108154297, "ViewRequirementAgentConnector_ms": 0.16461515426635742}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 116.7049180409162, "episode_return_mean": 321.5635697071319, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60288, "num_agent_steps_trained": 60288, "num_env_steps_sampled": 60288, "num_env_steps_trained": 60288, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 11.191957034891194, "num_env_steps_trained_throughput_per_sec": 11.191957034891194, "timesteps_total": 60288, "num_env_steps_sampled_lifetime": 60288, "num_agent_steps_sampled_lifetime": 60288, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 60288, "timers": {"training_iteration_time_ms": 46673.988, "restore_workers_time_ms": 0.019, "training_step_time_ms": 46673.93, "sample_time_ms": 45405.577, "load_time_ms": 0.431, "load_throughput": 1196782.163, "learn_time_ms": 1254.26, "learn_throughput": 411.398, "synch_weights_time_ms": 13.343}, "counters": {"num_env_steps_sampled": 60288, "num_env_steps_trained": 60288, "num_agent_steps_sampled": 60288, "num_agent_steps_trained": 60288}, "done": false, "episodes_total": 1487, "training_iteration": 101, "trial_id": "fe178_00005", "date": "2024-08-15_18-49-50", "timestamp": 1723769390, "time_this_iter_s": 46.10799264907837, "time_total_s": 6253.40052819252, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 233.38614082336426, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 22.78181818181818, "ram_util_percent": 10.489393939393938}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.15061091979344, "cur_kl_coeff": 0.04510168090928346, "cur_lr": 1e-05, "total_loss": 9.432486852010092, "policy_loss": -0.026083180370430153, "vf_loss": 9.457062617937725, "vf_explained_var": 0.0647112359603246, "kl": 0.03342541419454695, "entropy": -1.7355743835369746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 60804, "num_env_steps_trained": 60804, "num_agent_steps_sampled": 60804, "num_agent_steps_trained": 60804}, "sampler_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 116.7049180409162, "episode_reward_mean": 325.21511586326574, "episode_len_mean": 48.75, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2925, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.411902941973593, "mean_inference_ms": 1.253164031044129, "mean_action_processing_ms": 0.2054446051288997, "mean_env_wait_ms": 489.3897082750305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011931657791137695, "StateBufferConnector_ms": 0.005927085876464844, "ViewRequirementAgentConnector_ms": 0.16460776329040527}, "num_episodes": 10, "episode_return_max": 365.38519840808345, "episode_return_min": 116.7049180409162, "episode_return_mean": 325.21511586326574}, "env_runner_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 116.7049180409162, "episode_reward_mean": 325.21511586326574, "episode_len_mean": 48.75, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 2925, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.411902941973593, "mean_inference_ms": 1.253164031044129, "mean_action_processing_ms": 0.2054446051288997, "mean_env_wait_ms": 489.3897082750305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011931657791137695, "StateBufferConnector_ms": 0.005927085876464844, "ViewRequirementAgentConnector_ms": 0.16460776329040527}, "num_episodes": 10, "episode_return_max": 365.38519840808345, "episode_return_min": 116.7049180409162, "episode_return_mean": 325.21511586326574}, "episode_reward_max": 365.38519840808345, "episode_reward_min": 116.7049180409162, "episode_reward_mean": 325.21511586326574, "episode_len_mean": 48.75, "episodes_this_iter": 10, "episodes_timesteps_total": 2925, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.411902941973593, "mean_inference_ms": 1.253164031044129, "mean_action_processing_ms": 0.2054446051288997, "mean_env_wait_ms": 489.3897082750305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011931657791137695, "StateBufferConnector_ms": 0.005927085876464844, "ViewRequirementAgentConnector_ms": 0.16460776329040527}, "num_episodes": 10, "episode_return_max": 365.38519840808345, "episode_return_min": 116.7049180409162, "episode_return_mean": 325.21511586326574, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60804, "num_agent_steps_trained": 60804, "num_env_steps_sampled": 60804, "num_env_steps_trained": 60804, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.47242734167913, "num_env_steps_trained_throughput_per_sec": 10.47242734167913, "timesteps_total": 60804, "num_env_steps_sampled_lifetime": 60804, "num_agent_steps_sampled_lifetime": 60804, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 60804, "timers": {"training_iteration_time_ms": 47107.034, "restore_workers_time_ms": 0.019, "training_step_time_ms": 47106.976, "sample_time_ms": 45935.924, "load_time_ms": 0.419, "load_throughput": 1230509.351, "learn_time_ms": 1156.966, "learn_throughput": 445.994, "synch_weights_time_ms": 13.357}, "counters": {"num_env_steps_sampled": 60804, "num_env_steps_trained": 60804, "num_agent_steps_sampled": 60804, "num_agent_steps_trained": 60804}, "done": false, "episodes_total": 1497, "training_iteration": 102, "trial_id": "fe178_00005", "date": "2024-08-15_18-50-39", "timestamp": 1723769439, "time_this_iter_s": 49.27540135383606, "time_total_s": 6302.675929546356, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 282.6615421772003, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.31714285714285, "ram_util_percent": 10.505714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.810589395960172, "cur_kl_coeff": 0.06765252136392519, "cur_lr": 1e-05, "total_loss": 9.210454718271892, "policy_loss": -0.006691539303089181, "vf_loss": 9.216455813248952, "vf_explained_var": 0.028682540357112884, "kl": 0.0102054854175852, "entropy": -1.3076611071825028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 61320, "num_env_steps_trained": 61320, "num_agent_steps_sampled": 61320, "num_agent_steps_trained": 61320}, "sampler_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 320.5330231240698, "episode_len_mean": 48.125, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3465, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.446334798345593, "mean_inference_ms": 1.2518694670846484, "mean_action_processing_ms": 0.20526039621115333, "mean_env_wait_ms": 486.81787205605906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011537141270107694, "StateBufferConnector_ms": 0.005926688512166341, "ViewRequirementAgentConnector_ms": 0.16509294509887695}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 89.61329345703132, "episode_return_mean": 320.5330231240698}, "env_runner_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 320.5330231240698, "episode_len_mean": 48.125, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3465, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.446334798345593, "mean_inference_ms": 1.2518694670846484, "mean_action_processing_ms": 0.20526039621115333, "mean_env_wait_ms": 486.81787205605906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011537141270107694, "StateBufferConnector_ms": 0.005926688512166341, "ViewRequirementAgentConnector_ms": 0.16509294509887695}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 89.61329345703132, "episode_return_mean": 320.5330231240698}, "episode_reward_max": 365.38519840808345, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 320.5330231240698, "episode_len_mean": 48.125, "episodes_this_iter": 12, "episodes_timesteps_total": 3465, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.446334798345593, "mean_inference_ms": 1.2518694670846484, "mean_action_processing_ms": 0.20526039621115333, "mean_env_wait_ms": 486.81787205605906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011537141270107694, "StateBufferConnector_ms": 0.005926688512166341, "ViewRequirementAgentConnector_ms": 0.16509294509887695}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 89.61329345703132, "episode_return_mean": 320.5330231240698, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61320, "num_agent_steps_trained": 61320, "num_env_steps_sampled": 61320, "num_env_steps_trained": 61320, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.997134813659345, "num_env_steps_trained_throughput_per_sec": 13.997134813659345, "timesteps_total": 61320, "num_env_steps_sampled_lifetime": 61320, "num_agent_steps_sampled_lifetime": 61320, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 61320, "timers": {"training_iteration_time_ms": 45643.843, "restore_workers_time_ms": 0.019, "training_step_time_ms": 45643.784, "sample_time_ms": 44553.072, "load_time_ms": 0.402, "load_throughput": 1283122.389, "learn_time_ms": 1076.698, "learn_throughput": 479.243, "synch_weights_time_ms": 13.312}, "counters": {"num_env_steps_sampled": 61320, "num_env_steps_trained": 61320, "num_agent_steps_sampled": 61320, "num_agent_steps_trained": 61320}, "done": false, "episodes_total": 1509, "training_iteration": 103, "trial_id": "fe178_00005", "date": "2024-08-15_18-51-16", "timestamp": 1723769476, "time_this_iter_s": 36.86779737472534, "time_total_s": 6339.5437269210815, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 319.52933955192566, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 25.626415094339627, "ram_util_percent": 10.152830188679243}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.564671258131662, "cur_kl_coeff": 0.06765252136392519, "cur_lr": 1e-05, "total_loss": 9.101040546099345, "policy_loss": -0.004120560859640439, "vf_loss": 9.104769198099772, "vf_explained_var": 0.04395090490579605, "kl": 0.00579330834201149, "entropy": -1.2667672341068585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 61836, "num_env_steps_trained": 61836, "num_agent_steps_sampled": 61836, "num_agent_steps_trained": 61836}, "sampler_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 318.56985233975405, "episode_len_mean": 48.04761904761905, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4036, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.488307153738783, "mean_inference_ms": 1.251085267181099, "mean_action_processing_ms": 0.20516162043855712, "mean_env_wait_ms": 485.26882928715975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011343899227323987, "StateBufferConnector_ms": 0.005940028599330357, "ViewRequirementAgentConnector_ms": 0.165338743300665}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 89.61329345703132, "episode_return_mean": 318.56985233975405}, "env_runner_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 318.56985233975405, "episode_len_mean": 48.04761904761905, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4036, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.488307153738783, "mean_inference_ms": 1.251085267181099, "mean_action_processing_ms": 0.20516162043855712, "mean_env_wait_ms": 485.26882928715975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011343899227323987, "StateBufferConnector_ms": 0.005940028599330357, "ViewRequirementAgentConnector_ms": 0.165338743300665}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 89.61329345703132, "episode_return_mean": 318.56985233975405}, "episode_reward_max": 365.38519840808345, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 318.56985233975405, "episode_len_mean": 48.04761904761905, "episodes_this_iter": 12, "episodes_timesteps_total": 4036, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.488307153738783, "mean_inference_ms": 1.251085267181099, "mean_action_processing_ms": 0.20516162043855712, "mean_env_wait_ms": 485.26882928715975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011343899227323987, "StateBufferConnector_ms": 0.005940028599330357, "ViewRequirementAgentConnector_ms": 0.165338743300665}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 89.61329345703132, "episode_return_mean": 318.56985233975405, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61836, "num_agent_steps_trained": 61836, "num_env_steps_sampled": 61836, "num_env_steps_trained": 61836, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.857048328789975, "num_env_steps_trained_throughput_per_sec": 10.857048328789975, "timesteps_total": 61836, "num_env_steps_sampled_lifetime": 61836, "num_agent_steps_sampled_lifetime": 61836, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 61836, "timers": {"training_iteration_time_ms": 45879.206, "restore_workers_time_ms": 0.019, "training_step_time_ms": 45879.147, "sample_time_ms": 44839.052, "load_time_ms": 0.395, "load_throughput": 1305639.613, "learn_time_ms": 1026.021, "learn_throughput": 502.914, "synch_weights_time_ms": 13.382}, "counters": {"num_env_steps_sampled": 61836, "num_env_steps_trained": 61836, "num_agent_steps_sampled": 61836, "num_agent_steps_trained": 61836}, "done": false, "episodes_total": 1521, "training_iteration": 104, "trial_id": "fe178_00005", "date": "2024-08-15_18-52-04", "timestamp": 1723769524, "time_this_iter_s": 47.53028893470764, "time_total_s": 6387.074015855789, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 367.0596284866333, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.51323529411765, "ram_util_percent": 10.466176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.313625373442967, "cur_kl_coeff": 0.06765252136392519, "cur_lr": 1e-05, "total_loss": 9.23789199590683, "policy_loss": -0.0065338197707509, "vf_loss": 9.243996985753377, "vf_explained_var": 0.03829449266195297, "kl": 0.006338483491807286, "entropy": -1.4279527386029562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 62352, "num_env_steps_trained": 62352, "num_agent_steps_sampled": 62352, "num_agent_steps_trained": 62352}, "sampler_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 316.2650070496952, "episode_len_mean": 47.729166666666664, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4582, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.524863498168937, "mean_inference_ms": 1.250709116859996, "mean_action_processing_ms": 0.20513304254669049, "mean_env_wait_ms": 484.95817708461135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011118749777475992, "StateBufferConnector_ms": 0.005957732597986857, "ViewRequirementAgentConnector_ms": 0.16615912318229675}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 89.61329345703132, "episode_return_mean": 316.2650070496952}, "env_runner_results": {"episode_reward_max": 365.38519840808345, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 316.2650070496952, "episode_len_mean": 47.729166666666664, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4582, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.524863498168937, "mean_inference_ms": 1.250709116859996, "mean_action_processing_ms": 0.20513304254669049, "mean_env_wait_ms": 484.95817708461135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011118749777475992, "StateBufferConnector_ms": 0.005957732597986857, "ViewRequirementAgentConnector_ms": 0.16615912318229675}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 89.61329345703132, "episode_return_mean": 316.2650070496952}, "episode_reward_max": 365.38519840808345, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 316.2650070496952, "episode_len_mean": 47.729166666666664, "episodes_this_iter": 12, "episodes_timesteps_total": 4582, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.10667449425443, 343.99247111761656, 365.38519840808345, 122.48404541015623, 332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067], "episode_lengths": [50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.524863498168937, "mean_inference_ms": 1.250709116859996, "mean_action_processing_ms": 0.20513304254669049, "mean_env_wait_ms": 484.95817708461135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011118749777475992, "StateBufferConnector_ms": 0.005957732597986857, "ViewRequirementAgentConnector_ms": 0.16615912318229675}, "num_episodes": 12, "episode_return_max": 365.38519840808345, "episode_return_min": 89.61329345703132, "episode_return_mean": 316.2650070496952, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62352, "num_agent_steps_trained": 62352, "num_env_steps_sampled": 62352, "num_env_steps_trained": 62352, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.87452156546359, "num_env_steps_trained_throughput_per_sec": 9.87452156546359, "timesteps_total": 62352, "num_env_steps_sampled_lifetime": 62352, "num_agent_steps_sampled_lifetime": 62352, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 62352, "timers": {"training_iteration_time_ms": 46587.706, "restore_workers_time_ms": 0.018, "training_step_time_ms": 46587.649, "sample_time_ms": 45593.398, "load_time_ms": 0.389, "load_throughput": 1325869.429, "learn_time_ms": 980.231, "learn_throughput": 526.407, "synch_weights_time_ms": 13.343}, "counters": {"num_env_steps_sampled": 62352, "num_env_steps_trained": 62352, "num_agent_steps_sampled": 62352, "num_agent_steps_trained": 62352}, "done": false, "episodes_total": 1533, "training_iteration": 105, "trial_id": "fe178_00005", "date": "2024-08-15_18-52-56", "timestamp": 1723769576, "time_this_iter_s": 52.25970530509949, "time_total_s": 6439.333721160889, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 419.3193337917328, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 20.321621621621624, "ram_util_percent": 10.502702702702702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.797604578733445, "cur_kl_coeff": 0.06765252136392519, "cur_lr": 1e-05, "total_loss": 9.59306796391805, "policy_loss": -0.0067006699740886685, "vf_loss": 9.599153137207031, "vf_explained_var": 0.012856602668762207, "kl": 0.009100356477574678, "entropy": -1.5969725539286932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 62868, "num_env_steps_trained": 62868, "num_agent_steps_sampled": 62868, "num_agent_steps_trained": 62868}, "sampler_results": {"episode_reward_max": 363.0122802734372, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 316.55140669169344, "episode_len_mean": 47.83, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 4783, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.569912100277275, "mean_inference_ms": 1.2494104426534793, "mean_action_processing_ms": 0.20491751204745584, "mean_env_wait_ms": 485.017477003712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011150360107421875, "StateBufferConnector_ms": 0.005971670150756836, "ViewRequirementAgentConnector_ms": 0.16632580757141113}, "num_episodes": 8, "episode_return_max": 363.0122802734372, "episode_return_min": 89.61329345703132, "episode_return_mean": 316.55140669169344}, "env_runner_results": {"episode_reward_max": 363.0122802734372, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 316.55140669169344, "episode_len_mean": 47.83, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 4783, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.569912100277275, "mean_inference_ms": 1.2494104426534793, "mean_action_processing_ms": 0.20491751204745584, "mean_env_wait_ms": 485.017477003712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011150360107421875, "StateBufferConnector_ms": 0.005971670150756836, "ViewRequirementAgentConnector_ms": 0.16632580757141113}, "num_episodes": 8, "episode_return_max": 363.0122802734372, "episode_return_min": 89.61329345703132, "episode_return_mean": 316.55140669169344}, "episode_reward_max": 363.0122802734372, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 316.55140669169344, "episode_len_mean": 47.83, "episodes_this_iter": 8, "episodes_timesteps_total": 4783, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [332.7695026962492, 320.39348523715535, 297.58346739013933, 339.6901004323512, 326.5529866104372, 311.10004133627183, 306.53938057356436, 332.58624934285336, 333.4233199316064, 336.3090181787136, 270.2006689626942, 362.24282314412545, 322.28495438360414, 318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.569912100277275, "mean_inference_ms": 1.2494104426534793, "mean_action_processing_ms": 0.20491751204745584, "mean_env_wait_ms": 485.017477003712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011150360107421875, "StateBufferConnector_ms": 0.005971670150756836, "ViewRequirementAgentConnector_ms": 0.16632580757141113}, "num_episodes": 8, "episode_return_max": 363.0122802734372, "episode_return_min": 89.61329345703132, "episode_return_mean": 316.55140669169344, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62868, "num_agent_steps_trained": 62868, "num_env_steps_sampled": 62868, "num_env_steps_trained": 62868, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.213041701637241, "num_env_steps_trained_throughput_per_sec": 10.213041701637241, "timesteps_total": 62868, "num_env_steps_sampled_lifetime": 62868, "num_agent_steps_sampled_lifetime": 62868, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 62868, "timers": {"training_iteration_time_ms": 46981.3, "restore_workers_time_ms": 0.018, "training_step_time_ms": 46981.245, "sample_time_ms": 46025.744, "load_time_ms": 0.381, "load_throughput": 1355968.213, "learn_time_ms": 941.493, "learn_throughput": 548.066, "synch_weights_time_ms": 13.343}, "counters": {"num_env_steps_sampled": 62868, "num_env_steps_trained": 62868, "num_agent_steps_sampled": 62868, "num_agent_steps_trained": 62868}, "done": false, "episodes_total": 1541, "training_iteration": 106, "trial_id": "fe178_00005", "date": "2024-08-15_18-53-47", "timestamp": 1723769627, "time_this_iter_s": 50.52767062187195, "time_total_s": 6489.861391782761, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 469.84700441360474, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.424657534246577, "ram_util_percent": 10.593150684931507}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.637034249305724, "cur_kl_coeff": 0.06765252136392519, "cur_lr": 1e-05, "total_loss": 9.05919337272644, "policy_loss": -0.00752268610522151, "vf_loss": 9.066193628311158, "vf_explained_var": 0.0558128555615743, "kl": 0.007722251237889092, "entropy": -1.3892398655414582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 63384, "num_env_steps_trained": 63384, "num_agent_steps_sampled": 63384, "num_agent_steps_trained": 63384}, "sampler_results": {"episode_reward_max": 363.0122802734372, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 316.11933610138584, "episode_len_mean": 47.54, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 4754, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.626079960341878, "mean_inference_ms": 1.2465499443187502, "mean_action_processing_ms": 0.20451921364750278, "mean_env_wait_ms": 483.5281304173326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01075887680053711, "StateBufferConnector_ms": 0.005942583084106445, "ViewRequirementAgentConnector_ms": 0.1654348373413086}, "num_episodes": 13, "episode_return_max": 363.0122802734372, "episode_return_min": 89.61329345703132, "episode_return_mean": 316.11933610138584}, "env_runner_results": {"episode_reward_max": 363.0122802734372, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 316.11933610138584, "episode_len_mean": 47.54, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 4754, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.626079960341878, "mean_inference_ms": 1.2465499443187502, "mean_action_processing_ms": 0.20451921364750278, "mean_env_wait_ms": 483.5281304173326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01075887680053711, "StateBufferConnector_ms": 0.005942583084106445, "ViewRequirementAgentConnector_ms": 0.1654348373413086}, "num_episodes": 13, "episode_return_max": 363.0122802734372, "episode_return_min": 89.61329345703132, "episode_return_mean": 316.11933610138584}, "episode_reward_max": 363.0122802734372, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 316.11933610138584, "episode_len_mean": 47.54, "episodes_this_iter": 13, "episodes_timesteps_total": 4754, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [318.1587520601419, 351.0587158203123, 285.39785092063687, 359.37961288078776, 359.65086310830145, 349.9728950962526, 331.24838867187555, 356.4306750727575, 330.8405198227278, 356.12810886829885, 320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.626079960341878, "mean_inference_ms": 1.2465499443187502, "mean_action_processing_ms": 0.20451921364750278, "mean_env_wait_ms": 483.5281304173326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01075887680053711, "StateBufferConnector_ms": 0.005942583084106445, "ViewRequirementAgentConnector_ms": 0.1654348373413086}, "num_episodes": 13, "episode_return_max": 363.0122802734372, "episode_return_min": 89.61329345703132, "episode_return_mean": 316.11933610138584, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63384, "num_agent_steps_trained": 63384, "num_env_steps_sampled": 63384, "num_env_steps_trained": 63384, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.983418792829742, "num_env_steps_trained_throughput_per_sec": 9.983418792829742, "timesteps_total": 63384, "num_env_steps_sampled_lifetime": 63384, "num_agent_steps_sampled_lifetime": 63384, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 63384, "timers": {"training_iteration_time_ms": 47206.241, "restore_workers_time_ms": 0.018, "training_step_time_ms": 47206.186, "sample_time_ms": 46535.248, "load_time_ms": 0.329, "load_throughput": 1567623.399, "learn_time_ms": 657.052, "learn_throughput": 785.327, "synch_weights_time_ms": 13.296}, "counters": {"num_env_steps_sampled": 63384, "num_env_steps_trained": 63384, "num_agent_steps_sampled": 63384, "num_agent_steps_trained": 63384}, "done": false, "episodes_total": 1554, "training_iteration": 107, "trial_id": "fe178_00005", "date": "2024-08-15_18-54-38", "timestamp": 1723769678, "time_this_iter_s": 51.68962621688843, "time_total_s": 6541.551017999649, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 521.5366306304932, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 21.542465753424658, "ram_util_percent": 10.372602739726027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.7147629459699, "cur_kl_coeff": 0.06765252136392519, "cur_lr": 1e-05, "total_loss": 8.94026871919632, "policy_loss": -0.002072630108644565, "vf_loss": 8.941927830378214, "vf_explained_var": 0.07296541631221772, "kl": 0.006111830432932317, "entropy": -1.249438831706842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 63900, "num_env_steps_trained": 63900, "num_agent_steps_sampled": 63900, "num_agent_steps_trained": 63900}, "sampler_results": {"episode_reward_max": 365.5323569977681, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 310.19925704261556, "episode_len_mean": 46.91, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4691, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723, 164.85393066406255, 347.26423696291, 351.5889892578127, 365.5323569977681, 113.5464795825719, 312.2727224412437, 162.97901611328132, 322.35767554556276, 348.5031333092902, 317.3599355705539], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 24, 50, 31, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.650438221174202, "mean_inference_ms": 1.2452546005991716, "mean_action_processing_ms": 0.20440577106576616, "mean_env_wait_ms": 483.93432751891015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010579586029052734, "StateBufferConnector_ms": 0.005925655364990234, "ViewRequirementAgentConnector_ms": 0.16553330421447754}, "num_episodes": 10, "episode_return_max": 365.5323569977681, "episode_return_min": 89.61329345703132, "episode_return_mean": 310.19925704261556}, "env_runner_results": {"episode_reward_max": 365.5323569977681, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 310.19925704261556, "episode_len_mean": 46.91, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4691, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723, 164.85393066406255, 347.26423696291, 351.5889892578127, 365.5323569977681, 113.5464795825719, 312.2727224412437, 162.97901611328132, 322.35767554556276, 348.5031333092902, 317.3599355705539], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 24, 50, 31, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.650438221174202, "mean_inference_ms": 1.2452546005991716, "mean_action_processing_ms": 0.20440577106576616, "mean_env_wait_ms": 483.93432751891015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010579586029052734, "StateBufferConnector_ms": 0.005925655364990234, "ViewRequirementAgentConnector_ms": 0.16553330421447754}, "num_episodes": 10, "episode_return_max": 365.5323569977681, "episode_return_min": 89.61329345703132, "episode_return_mean": 310.19925704261556}, "episode_reward_max": 365.5323569977681, "episode_reward_min": 89.61329345703132, "episode_reward_mean": 310.19925704261556, "episode_len_mean": 46.91, "episodes_this_iter": 10, "episodes_timesteps_total": 4691, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [320.4214099476641, 344.448307449777, 310.7251255687657, 319.7184767900563, 319.4949150300054, 340.0533961958443, 338.22554546856543, 362.9107441198194, 342.89476068060026, 189.2925563892377, 342.6088256038663, 286.4525432359364, 338.88230273055865, 322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723, 164.85393066406255, 347.26423696291, 351.5889892578127, 365.5323569977681, 113.5464795825719, 312.2727224412437, 162.97901611328132, 322.35767554556276, 348.5031333092902, 317.3599355705539], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 24, 50, 31, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.650438221174202, "mean_inference_ms": 1.2452546005991716, "mean_action_processing_ms": 0.20440577106576616, "mean_env_wait_ms": 483.93432751891015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010579586029052734, "StateBufferConnector_ms": 0.005925655364990234, "ViewRequirementAgentConnector_ms": 0.16553330421447754}, "num_episodes": 10, "episode_return_max": 365.5323569977681, "episode_return_min": 89.61329345703132, "episode_return_mean": 310.19925704261556, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63900, "num_agent_steps_trained": 63900, "num_env_steps_sampled": 63900, "num_env_steps_trained": 63900, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.233486507763146, "num_env_steps_trained_throughput_per_sec": 13.233486507763146, "timesteps_total": 63900, "num_env_steps_sampled_lifetime": 63900, "num_agent_steps_sampled_lifetime": 63900, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 63900, "timers": {"training_iteration_time_ms": 46202.65, "restore_workers_time_ms": 0.017, "training_step_time_ms": 46202.599, "sample_time_ms": 45525.04, "load_time_ms": 0.322, "load_throughput": 1600547.895, "learn_time_ms": 663.709, "learn_throughput": 777.449, "synch_weights_time_ms": 13.273}, "counters": {"num_env_steps_sampled": 63900, "num_env_steps_trained": 63900, "num_agent_steps_sampled": 63900, "num_agent_steps_trained": 63900}, "done": false, "episodes_total": 1564, "training_iteration": 108, "trial_id": "fe178_00005", "date": "2024-08-15_18-55-17", "timestamp": 1723769717, "time_this_iter_s": 38.99585819244385, "time_total_s": 6580.546876192093, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 560.532488822937, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 26.94107142857143, "ram_util_percent": 10.601785714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.056456126769383, "cur_kl_coeff": 0.06765252136392519, "cur_lr": 1e-05, "total_loss": 9.462812487284342, "policy_loss": -0.01093045858045419, "vf_loss": 9.4731094678243, "vf_explained_var": 0.06953441301981608, "kl": 0.009364663348732195, "entropy": -1.5244236270586649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 64416, "num_env_steps_trained": 64416, "num_agent_steps_sampled": 64416, "num_agent_steps_trained": 64416}, "sampler_results": {"episode_reward_max": 365.5323569977681, "episode_reward_min": 88.37204870476694, "episode_reward_mean": 304.74148093511127, "episode_len_mean": 46.2, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 4620, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723, 164.85393066406255, 347.26423696291, 351.5889892578127, 365.5323569977681, 113.5464795825719, 312.2727224412437, 162.97901611328132, 322.35767554556276, 348.5031333092902, 317.3599355705539, 352.48242482112755, 339.02067827381455, 300.34063618218283, 113.91911201909346, 88.37204870476694, 306.539497965425, 336.2516995772303, 118.31453857421877, 338.42007845583043, 352.5678408498092, 315.72515229926796, 307.56415468170457, 340.83343605579745], "episode_lengths": [50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 24, 50, 31, 50, 50, 50, 50, 50, 50, 20, 18, 50, 50, 23, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.696805985347522, "mean_inference_ms": 1.2442293034121596, "mean_action_processing_ms": 0.20434941572208737, "mean_env_wait_ms": 484.2481505123504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010356903076171875, "StateBufferConnector_ms": 0.005976438522338867, "ViewRequirementAgentConnector_ms": 0.16592931747436523}, "num_episodes": 13, "episode_return_max": 365.5323569977681, "episode_return_min": 88.37204870476694, "episode_return_mean": 304.74148093511127}, "env_runner_results": {"episode_reward_max": 365.5323569977681, "episode_reward_min": 88.37204870476694, "episode_reward_mean": 304.74148093511127, "episode_len_mean": 46.2, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 4620, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723, 164.85393066406255, 347.26423696291, 351.5889892578127, 365.5323569977681, 113.5464795825719, 312.2727224412437, 162.97901611328132, 322.35767554556276, 348.5031333092902, 317.3599355705539, 352.48242482112755, 339.02067827381455, 300.34063618218283, 113.91911201909346, 88.37204870476694, 306.539497965425, 336.2516995772303, 118.31453857421877, 338.42007845583043, 352.5678408498092, 315.72515229926796, 307.56415468170457, 340.83343605579745], "episode_lengths": [50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 24, 50, 31, 50, 50, 50, 50, 50, 50, 20, 18, 50, 50, 23, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.696805985347522, "mean_inference_ms": 1.2442293034121596, "mean_action_processing_ms": 0.20434941572208737, "mean_env_wait_ms": 484.2481505123504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010356903076171875, "StateBufferConnector_ms": 0.005976438522338867, "ViewRequirementAgentConnector_ms": 0.16592931747436523}, "num_episodes": 13, "episode_return_max": 365.5323569977681, "episode_return_min": 88.37204870476694, "episode_return_mean": 304.74148093511127}, "episode_reward_max": 365.5323569977681, "episode_reward_min": 88.37204870476694, "episode_reward_mean": 304.74148093511127, "episode_len_mean": 46.2, "episodes_this_iter": 13, "episodes_timesteps_total": 4620, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [322.17898306170406, 116.7049180409162, 355.8551287568623, 343.2867466004559, 330.507367746003, 331.55110681194924, 359.4138427063046, 315.2843262019394, 353.40218600655373, 321.9542002412417, 342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723, 164.85393066406255, 347.26423696291, 351.5889892578127, 365.5323569977681, 113.5464795825719, 312.2727224412437, 162.97901611328132, 322.35767554556276, 348.5031333092902, 317.3599355705539, 352.48242482112755, 339.02067827381455, 300.34063618218283, 113.91911201909346, 88.37204870476694, 306.539497965425, 336.2516995772303, 118.31453857421877, 338.42007845583043, 352.5678408498092, 315.72515229926796, 307.56415468170457, 340.83343605579745], "episode_lengths": [50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 24, 50, 31, 50, 50, 50, 50, 50, 50, 20, 18, 50, 50, 23, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.696805985347522, "mean_inference_ms": 1.2442293034121596, "mean_action_processing_ms": 0.20434941572208737, "mean_env_wait_ms": 484.2481505123504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010356903076171875, "StateBufferConnector_ms": 0.005976438522338867, "ViewRequirementAgentConnector_ms": 0.16592931747436523}, "num_episodes": 13, "episode_return_max": 365.5323569977681, "episode_return_min": 88.37204870476694, "episode_return_mean": 304.74148093511127, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64416, "num_agent_steps_trained": 64416, "num_env_steps_sampled": 64416, "num_env_steps_trained": 64416, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.052788960841326, "num_env_steps_trained_throughput_per_sec": 10.052788960841326, "timesteps_total": 64416, "num_env_steps_sampled_lifetime": 64416, "num_agent_steps_sampled_lifetime": 64416, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 64416, "timers": {"training_iteration_time_ms": 47415.417, "restore_workers_time_ms": 0.017, "training_step_time_ms": 47415.366, "sample_time_ms": 46752.03, "load_time_ms": 0.321, "load_throughput": 1606965.298, "learn_time_ms": 649.498, "learn_throughput": 794.46, "synch_weights_time_ms": 13.263}, "counters": {"num_env_steps_sampled": 64416, "num_env_steps_trained": 64416, "num_agent_steps_sampled": 64416, "num_agent_steps_trained": 64416}, "done": false, "episodes_total": 1577, "training_iteration": 109, "trial_id": "fe178_00005", "date": "2024-08-15_18-56-09", "timestamp": 1723769769, "time_this_iter_s": 51.332672357559204, "time_total_s": 6631.879548549652, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 611.8651611804962, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 20.864383561643837, "ram_util_percent": 10.675342465753426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.459170683224995, "cur_kl_coeff": 0.06765252136392519, "cur_lr": 1e-05, "total_loss": 9.044805828730265, "policy_loss": -0.009193846366057794, "vf_loss": 9.053487380345663, "vf_explained_var": 0.027469304203987122, "kl": 0.007571490336219237, "entropy": -1.5574442148208618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 64932, "num_env_steps_trained": 64932, "num_agent_steps_sampled": 64932, "num_agent_steps_trained": 64932}, "sampler_results": {"episode_reward_max": 365.5323569977681, "episode_reward_min": 88.37204870476694, "episode_reward_mean": 305.22305591514834, "episode_len_mean": 46.32, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4632, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723, 164.85393066406255, 347.26423696291, 351.5889892578127, 365.5323569977681, 113.5464795825719, 312.2727224412437, 162.97901611328132, 322.35767554556276, 348.5031333092902, 317.3599355705539, 352.48242482112755, 339.02067827381455, 300.34063618218283, 113.91911201909346, 88.37204870476694, 306.539497965425, 336.2516995772303, 118.31453857421877, 338.42007845583043, 352.5678408498092, 315.72515229926796, 307.56415468170457, 340.83343605579745, 322.3569560875364, 340.7047149529077, 350.35380099458774, 330.96412924596785, 183.03158635334103, 351.4595805881761, 344.58159502897666, 321.2347371852554, 348.75189637546725, 304.85730736542746], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 24, 50, 31, 50, 50, 50, 50, 50, 50, 20, 18, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.713537749282309, "mean_inference_ms": 1.243367575245688, "mean_action_processing_ms": 0.204211343487963, "mean_env_wait_ms": 484.5584965637118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010484457015991211, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.1664414405822754}, "num_episodes": 10, "episode_return_max": 365.5323569977681, "episode_return_min": 88.37204870476694, "episode_return_mean": 305.22305591514834}, "env_runner_results": {"episode_reward_max": 365.5323569977681, "episode_reward_min": 88.37204870476694, "episode_reward_mean": 305.22305591514834, "episode_len_mean": 46.32, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4632, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723, 164.85393066406255, 347.26423696291, 351.5889892578127, 365.5323569977681, 113.5464795825719, 312.2727224412437, 162.97901611328132, 322.35767554556276, 348.5031333092902, 317.3599355705539, 352.48242482112755, 339.02067827381455, 300.34063618218283, 113.91911201909346, 88.37204870476694, 306.539497965425, 336.2516995772303, 118.31453857421877, 338.42007845583043, 352.5678408498092, 315.72515229926796, 307.56415468170457, 340.83343605579745, 322.3569560875364, 340.7047149529077, 350.35380099458774, 330.96412924596785, 183.03158635334103, 351.4595805881761, 344.58159502897666, 321.2347371852554, 348.75189637546725, 304.85730736542746], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 24, 50, 31, 50, 50, 50, 50, 50, 50, 20, 18, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.713537749282309, "mean_inference_ms": 1.243367575245688, "mean_action_processing_ms": 0.204211343487963, "mean_env_wait_ms": 484.5584965637118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010484457015991211, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.1664414405822754}, "num_episodes": 10, "episode_return_max": 365.5323569977681, "episode_return_min": 88.37204870476694, "episode_return_mean": 305.22305591514834}, "episode_reward_max": 365.5323569977681, "episode_reward_min": 88.37204870476694, "episode_reward_mean": 305.22305591514834, "episode_len_mean": 46.32, "episodes_this_iter": 10, "episodes_timesteps_total": 4632, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [342.7714578131559, 291.6827856728512, 357.349323119768, 356.4730467267221, 362.2174124213943, 336.9719694040283, 340.77865887267376, 333.34177765354656, 362.3970396380213, 350.7449951171873, 353.44727027550016, 324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723, 164.85393066406255, 347.26423696291, 351.5889892578127, 365.5323569977681, 113.5464795825719, 312.2727224412437, 162.97901611328132, 322.35767554556276, 348.5031333092902, 317.3599355705539, 352.48242482112755, 339.02067827381455, 300.34063618218283, 113.91911201909346, 88.37204870476694, 306.539497965425, 336.2516995772303, 118.31453857421877, 338.42007845583043, 352.5678408498092, 315.72515229926796, 307.56415468170457, 340.83343605579745, 322.3569560875364, 340.7047149529077, 350.35380099458774, 330.96412924596785, 183.03158635334103, 351.4595805881761, 344.58159502897666, 321.2347371852554, 348.75189637546725, 304.85730736542746], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 24, 50, 31, 50, 50, 50, 50, 50, 50, 20, 18, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.713537749282309, "mean_inference_ms": 1.243367575245688, "mean_action_processing_ms": 0.204211343487963, "mean_env_wait_ms": 484.5584965637118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010484457015991211, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.1664414405822754}, "num_episodes": 10, "episode_return_max": 365.5323569977681, "episode_return_min": 88.37204870476694, "episode_return_mean": 305.22305591514834, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64932, "num_agent_steps_trained": 64932, "num_env_steps_sampled": 64932, "num_env_steps_trained": 64932, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.0401330715828, "num_env_steps_trained_throughput_per_sec": 10.0401330715828, "timesteps_total": 64932, "num_env_steps_sampled_lifetime": 64932, "num_agent_steps_sampled_lifetime": 64932, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 64932, "timers": {"training_iteration_time_ms": 47594.813, "restore_workers_time_ms": 0.017, "training_step_time_ms": 47594.765, "sample_time_ms": 46932.833, "load_time_ms": 0.322, "load_throughput": 1603512.532, "learn_time_ms": 648.14, "learn_throughput": 796.124, "synch_weights_time_ms": 13.222}, "counters": {"num_env_steps_sampled": 64932, "num_env_steps_trained": 64932, "num_agent_steps_sampled": 64932, "num_agent_steps_trained": 64932}, "done": false, "episodes_total": 1587, "training_iteration": 110, "trial_id": "fe178_00005", "date": "2024-08-15_18-57-00", "timestamp": 1723769820, "time_this_iter_s": 51.39743208885193, "time_total_s": 6683.276980638504, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 663.2625932693481, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 20.464864864864865, "ram_util_percent": 10.709459459459461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.35125001271566, "cur_kl_coeff": 0.06765252136392519, "cur_lr": 1e-05, "total_loss": 9.044512291749319, "policy_loss": 0.024288152034084003, "vf_loss": 9.011235777537028, "vf_explained_var": 0.004051463802655538, "kl": 0.13286034841246147, "entropy": -1.315676470597585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 65448, "num_env_steps_trained": 65448, "num_agent_steps_sampled": 65448, "num_agent_steps_trained": 65448}, "sampler_results": {"episode_reward_max": 365.5323569977681, "episode_reward_min": 88.37204870476694, "episode_reward_mean": 303.02832639081845, "episode_len_mean": 46.32, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4632, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723, 164.85393066406255, 347.26423696291, 351.5889892578127, 365.5323569977681, 113.5464795825719, 312.2727224412437, 162.97901611328132, 322.35767554556276, 348.5031333092902, 317.3599355705539, 352.48242482112755, 339.02067827381455, 300.34063618218283, 113.91911201909346, 88.37204870476694, 306.539497965425, 336.2516995772303, 118.31453857421877, 338.42007845583043, 352.5678408498092, 315.72515229926796, 307.56415468170457, 340.83343605579745, 322.3569560875364, 340.7047149529077, 350.35380099458774, 330.96412924596785, 183.03158635334103, 351.4595805881761, 344.58159502897666, 321.2347371852554, 348.75189637546725, 304.85730736542746, 346.73915024053633, 284.8851709559505, 339.9551992247729, 252.21290471232794, 343.8263882462626, 321.19351098894765, 328.18022327943135, 357.2691807771093, 355.2645700394582, 317.9178607184076, 321.2586250986548], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 24, 50, 31, 50, 50, 50, 50, 50, 50, 20, 18, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.738056568038412, "mean_inference_ms": 1.2424340116747796, "mean_action_processing_ms": 0.2041155555103045, "mean_env_wait_ms": 484.40382900077174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010466575622558594, "StateBufferConnector_ms": 0.006044626235961914, "ViewRequirementAgentConnector_ms": 0.16657543182373047}, "num_episodes": 11, "episode_return_max": 365.5323569977681, "episode_return_min": 88.37204870476694, "episode_return_mean": 303.02832639081845}, "env_runner_results": {"episode_reward_max": 365.5323569977681, "episode_reward_min": 88.37204870476694, "episode_reward_mean": 303.02832639081845, "episode_len_mean": 46.32, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4632, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723, 164.85393066406255, 347.26423696291, 351.5889892578127, 365.5323569977681, 113.5464795825719, 312.2727224412437, 162.97901611328132, 322.35767554556276, 348.5031333092902, 317.3599355705539, 352.48242482112755, 339.02067827381455, 300.34063618218283, 113.91911201909346, 88.37204870476694, 306.539497965425, 336.2516995772303, 118.31453857421877, 338.42007845583043, 352.5678408498092, 315.72515229926796, 307.56415468170457, 340.83343605579745, 322.3569560875364, 340.7047149529077, 350.35380099458774, 330.96412924596785, 183.03158635334103, 351.4595805881761, 344.58159502897666, 321.2347371852554, 348.75189637546725, 304.85730736542746, 346.73915024053633, 284.8851709559505, 339.9551992247729, 252.21290471232794, 343.8263882462626, 321.19351098894765, 328.18022327943135, 357.2691807771093, 355.2645700394582, 317.9178607184076, 321.2586250986548], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 24, 50, 31, 50, 50, 50, 50, 50, 50, 20, 18, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.738056568038412, "mean_inference_ms": 1.2424340116747796, "mean_action_processing_ms": 0.2041155555103045, "mean_env_wait_ms": 484.40382900077174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010466575622558594, "StateBufferConnector_ms": 0.006044626235961914, "ViewRequirementAgentConnector_ms": 0.16657543182373047}, "num_episodes": 11, "episode_return_max": 365.5323569977681, "episode_return_min": 88.37204870476694, "episode_return_mean": 303.02832639081845}, "episode_reward_max": 365.5323569977681, "episode_reward_min": 88.37204870476694, "episode_reward_mean": 303.02832639081845, "episode_len_mean": 46.32, "episodes_this_iter": 11, "episodes_timesteps_total": 4632, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [324.1842307576273, 338.1200632081888, 346.5375638793602, 89.61329345703132, 344.24737397492055, 340.9987153723048, 316.9903202761247, 124.53786621093752, 318.70642599082197, 342.2260053411635, 325.86158439310356, 314.7460778182774, 363.0122802734372, 317.8616638725874, 344.0829049679415, 102.15618185126452, 339.9115584743443, 275.3145034019119, 354.8076009410871, 319.32491785315216, 343.51467424727355, 289.402506758797, 317.35506114623803, 323.21501180546596, 125.77137451171882, 347.4836178543373, 293.5555452513043, 335.6925507250202, 313.21295042076156, 122.22360331279816, 359.7496161828284, 342.54499194204635, 352.04456766279634, 347.3699320539167, 338.7093185084067, 318.29538866704956, 314.13118575796227, 338.92786681943704, 116.67704258584894, 349.5260269919705, 357.8187791031708, 324.529644007967, 355.7624478953087, 360.6116479844244, 298.574912792932, 358.6405615253788, 115.28400878906257, 343.2958112233825, 347.3411223716066, 347.0683429092556, 311.0988638011743, 303.80177357928824, 347.16839142891195, 357.5983732075231, 317.6745189242942, 340.3106106517723, 164.85393066406255, 347.26423696291, 351.5889892578127, 365.5323569977681, 113.5464795825719, 312.2727224412437, 162.97901611328132, 322.35767554556276, 348.5031333092902, 317.3599355705539, 352.48242482112755, 339.02067827381455, 300.34063618218283, 113.91911201909346, 88.37204870476694, 306.539497965425, 336.2516995772303, 118.31453857421877, 338.42007845583043, 352.5678408498092, 315.72515229926796, 307.56415468170457, 340.83343605579745, 322.3569560875364, 340.7047149529077, 350.35380099458774, 330.96412924596785, 183.03158635334103, 351.4595805881761, 344.58159502897666, 321.2347371852554, 348.75189637546725, 304.85730736542746, 346.73915024053633, 284.8851709559505, 339.9551992247729, 252.21290471232794, 343.8263882462626, 321.19351098894765, 328.18022327943135, 357.2691807771093, 355.2645700394582, 317.9178607184076, 321.2586250986548], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 24, 50, 31, 50, 50, 50, 50, 50, 50, 20, 18, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.738056568038412, "mean_inference_ms": 1.2424340116747796, "mean_action_processing_ms": 0.2041155555103045, "mean_env_wait_ms": 484.40382900077174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010466575622558594, "StateBufferConnector_ms": 0.006044626235961914, "ViewRequirementAgentConnector_ms": 0.16657543182373047}, "num_episodes": 11, "episode_return_max": 365.5323569977681, "episode_return_min": 88.37204870476694, "episode_return_mean": 303.02832639081845, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65448, "num_agent_steps_trained": 65448, "num_env_steps_sampled": 65448, "num_env_steps_trained": 65448, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 11.349444357486808, "num_env_steps_trained_throughput_per_sec": 11.349444357486808, "timesteps_total": 65448, "num_env_steps_sampled_lifetime": 65448, "num_agent_steps_sampled_lifetime": 65448, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 65448, "timers": {"training_iteration_time_ms": 47530.837, "restore_workers_time_ms": 0.016, "training_step_time_ms": 47530.791, "sample_time_ms": 46887.608, "load_time_ms": 0.316, "load_throughput": 1635379.223, "learn_time_ms": 629.425, "learn_throughput": 819.796, "synch_weights_time_ms": 13.198}, "counters": {"num_env_steps_sampled": 65448, "num_env_steps_trained": 65448, "num_agent_steps_sampled": 65448, "num_agent_steps_trained": 65448}, "done": false, "episodes_total": 1598, "training_iteration": 111, "trial_id": "fe178_00005", "date": "2024-08-15_18-57-46", "timestamp": 1723769866, "time_this_iter_s": 45.468223333358765, "time_total_s": 6728.745203971863, "pid": 81723, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24749545110710894, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.039217742440109, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 708.7308166027069, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 23.243076923076924, "ram_util_percent": 10.796923076923076}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.006184703856707, "cur_kl_coeff": 0.18040672363713384, "cur_lr": 0.00010000000000000003, "total_loss": 6.8201797393461066, "policy_loss": -0.005055093923389601, "vf_loss": 6.823654909183582, "vf_explained_var": 0.07807394961516062, "kl": 0.008757497661160789, "entropy": -1.2026122358317177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 64872, "num_env_steps_trained": 64872, "num_agent_steps_sampled": 64872, "num_agent_steps_trained": 64872}, "sampler_results": {"episode_reward_max": 363.8241850655926, "episode_reward_min": 78.08794040190992, "episode_reward_mean": 305.4989596553326, "episode_len_mean": 47.205128205128204, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 1841, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.86378452594363, 265.9430880560539, 346.8062031350718, 313.29648247938593, 348.0490722656252, 317.2705160102784, 329.20489618576886, 353.19022216796907, 336.1546050946468, 328.4035270404563, 341.80807188250253, 338.32480889862126, 324.93754123386634, 282.5204441323187, 340.29915787733, 306.95410362587916, 332.5193484487639, 353.43862504935595, 341.4122626649825, 336.08868799268913, 348.13869063994105, 352.62392614399573, 303.11193908157566, 363.8241850655926, 323.45368734233256, 80.0624755859377, 78.08794040190992, 359.0984745405185, 91.54603759671579, 342.4176956740722, 332.5739233929456, 330.56035122407565, 273.882151091032, 218.7010583692836, 326.11621242912065, 293.77507716829894, 317.714133399745, 283.9444084722045, 304.34161017116423], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 18, 50, 17, 50, 50, 50, 50, 39, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.444099721846544, "mean_inference_ms": 1.2348851004799644, "mean_action_processing_ms": 0.20256935057462203, "mean_env_wait_ms": 483.08094772084496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01189097380026793, "StateBufferConnector_ms": 0.00550991449600611, "ViewRequirementAgentConnector_ms": 0.15966403178679636}, "num_episodes": 39, "episode_return_max": 363.8241850655926, "episode_return_min": 78.08794040190992, "episode_return_mean": 305.4989596553326}, "env_runner_results": {"episode_reward_max": 363.8241850655926, "episode_reward_min": 78.08794040190992, "episode_reward_mean": 305.4989596553326, "episode_len_mean": 47.205128205128204, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 1841, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.86378452594363, 265.9430880560539, 346.8062031350718, 313.29648247938593, 348.0490722656252, 317.2705160102784, 329.20489618576886, 353.19022216796907, 336.1546050946468, 328.4035270404563, 341.80807188250253, 338.32480889862126, 324.93754123386634, 282.5204441323187, 340.29915787733, 306.95410362587916, 332.5193484487639, 353.43862504935595, 341.4122626649825, 336.08868799268913, 348.13869063994105, 352.62392614399573, 303.11193908157566, 363.8241850655926, 323.45368734233256, 80.0624755859377, 78.08794040190992, 359.0984745405185, 91.54603759671579, 342.4176956740722, 332.5739233929456, 330.56035122407565, 273.882151091032, 218.7010583692836, 326.11621242912065, 293.77507716829894, 317.714133399745, 283.9444084722045, 304.34161017116423], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 18, 50, 17, 50, 50, 50, 50, 39, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.444099721846544, "mean_inference_ms": 1.2348851004799644, "mean_action_processing_ms": 0.20256935057462203, "mean_env_wait_ms": 483.08094772084496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01189097380026793, "StateBufferConnector_ms": 0.00550991449600611, "ViewRequirementAgentConnector_ms": 0.15966403178679636}, "num_episodes": 39, "episode_return_max": 363.8241850655926, "episode_return_min": 78.08794040190992, "episode_return_mean": 305.4989596553326}, "episode_reward_max": 363.8241850655926, "episode_reward_min": 78.08794040190992, "episode_reward_mean": 305.4989596553326, "episode_len_mean": 47.205128205128204, "episodes_this_iter": 39, "episodes_timesteps_total": 1841, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [353.86378452594363, 265.9430880560539, 346.8062031350718, 313.29648247938593, 348.0490722656252, 317.2705160102784, 329.20489618576886, 353.19022216796907, 336.1546050946468, 328.4035270404563, 341.80807188250253, 338.32480889862126, 324.93754123386634, 282.5204441323187, 340.29915787733, 306.95410362587916, 332.5193484487639, 353.43862504935595, 341.4122626649825, 336.08868799268913, 348.13869063994105, 352.62392614399573, 303.11193908157566, 363.8241850655926, 323.45368734233256, 80.0624755859377, 78.08794040190992, 359.0984745405185, 91.54603759671579, 342.4176956740722, 332.5739233929456, 330.56035122407565, 273.882151091032, 218.7010583692836, 326.11621242912065, 293.77507716829894, 317.714133399745, 283.9444084722045, 304.34161017116423], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 18, 50, 17, 50, 50, 50, 50, 39, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.444099721846544, "mean_inference_ms": 1.2348851004799644, "mean_action_processing_ms": 0.20256935057462203, "mean_env_wait_ms": 483.08094772084496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01189097380026793, "StateBufferConnector_ms": 0.00550991449600611, "ViewRequirementAgentConnector_ms": 0.15966403178679636}, "num_episodes": 39, "episode_return_max": 363.8241850655926, "episode_return_min": 78.08794040190992, "episode_return_mean": 305.4989596553326, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64872, "num_agent_steps_trained": 64872, "num_env_steps_sampled": 64872, "num_env_steps_trained": 64872, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 11.101190097487345, "num_env_steps_trained_throughput_per_sec": 11.101190097487345, "timesteps_total": 64872, "num_env_steps_sampled_lifetime": 64872, "num_agent_steps_sampled_lifetime": 64872, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 64872, "timers": {"training_iteration_time_ms": 184845.064, "restore_workers_time_ms": 0.026, "training_step_time_ms": 184844.991, "sample_time_ms": 179541.066, "load_time_ms": 0.867, "load_throughput": 2366431.622, "learn_time_ms": 5289.656, "learn_throughput": 387.927, "synch_weights_time_ms": 12.786}, "counters": {"num_env_steps_sampled": 64872, "num_env_steps_trained": 64872, "num_agent_steps_sampled": 64872, "num_agent_steps_trained": 64872}, "done": false, "episodes_total": 1573, "training_iteration": 96, "trial_id": "fe178_00005", "date": "2024-08-15_19-01-09", "timestamp": 1723770069, "time_this_iter_s": 184.84865069389343, "time_total_s": 6649.070369005203, "pid": 56584, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23759563306282458, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.439931649153264, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 184.84865069389343, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 22.31477272727273, "ram_util_percent": 10.469318181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.6979725604256, "cur_kl_coeff": 0.18040672363713384, "cur_lr": 0.00010000000000000003, "total_loss": 7.073234965155522, "policy_loss": -0.005075319133660135, "vf_loss": 7.075412516171734, "vf_explained_var": 0.08058414484063785, "kl": 0.016062258086216388, "entropy": -1.2154340815419953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 66924, "num_env_steps_trained": 66924, "num_agent_steps_sampled": 66924, "num_agent_steps_trained": 66924}, "sampler_results": {"episode_reward_max": 371.4467041015623, "episode_reward_min": 97.06973876953145, "episode_reward_mean": 309.20060698061974, "episode_len_mean": 47.794871794871796, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 1864, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.4091209488859, 289.29386518462354, 322.74055885129883, 348.06252894664084, 340.99026540197775, 355.71854949488494, 333.2696002621652, 330.5357890130351, 359.90564568072796, 175.96610107421895, 279.7525674574649, 339.50611430955337, 333.4509628838135, 298.46338911103607, 352.11764799264466, 344.0450435877027, 288.65027358944786, 303.4764853134288, 337.5979299684405, 143.71992187500007, 340.0833612513573, 371.4467041015623, 334.8250922171236, 360.3286253191195, 342.6920731380228, 307.6693222416579, 339.4248699593599, 175.719171397931, 306.4503090069431, 97.06973876953145, 292.6596018677808, 259.90182726658117, 309.83755478705336, 353.71602833280815, 343.6909230060803, 331.00607156234685, 358.00487189127716, 323.65979665463936, 347.965368526001], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 39, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.416636100895087, "mean_inference_ms": 1.2389574473665428, "mean_action_processing_ms": 0.2054584804311625, "mean_env_wait_ms": 511.7718230593478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012111052488669371, "StateBufferConnector_ms": 0.006060111217009716, "ViewRequirementAgentConnector_ms": 0.1644574678861178}, "num_episodes": 39, "episode_return_max": 371.4467041015623, "episode_return_min": 97.06973876953145, "episode_return_mean": 309.20060698061974}, "env_runner_results": {"episode_reward_max": 371.4467041015623, "episode_reward_min": 97.06973876953145, "episode_reward_mean": 309.20060698061974, "episode_len_mean": 47.794871794871796, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 1864, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.4091209488859, 289.29386518462354, 322.74055885129883, 348.06252894664084, 340.99026540197775, 355.71854949488494, 333.2696002621652, 330.5357890130351, 359.90564568072796, 175.96610107421895, 279.7525674574649, 339.50611430955337, 333.4509628838135, 298.46338911103607, 352.11764799264466, 344.0450435877027, 288.65027358944786, 303.4764853134288, 337.5979299684405, 143.71992187500007, 340.0833612513573, 371.4467041015623, 334.8250922171236, 360.3286253191195, 342.6920731380228, 307.6693222416579, 339.4248699593599, 175.719171397931, 306.4503090069431, 97.06973876953145, 292.6596018677808, 259.90182726658117, 309.83755478705336, 353.71602833280815, 343.6909230060803, 331.00607156234685, 358.00487189127716, 323.65979665463936, 347.965368526001], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 39, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.416636100895087, "mean_inference_ms": 1.2389574473665428, "mean_action_processing_ms": 0.2054584804311625, "mean_env_wait_ms": 511.7718230593478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012111052488669371, "StateBufferConnector_ms": 0.006060111217009716, "ViewRequirementAgentConnector_ms": 0.1644574678861178}, "num_episodes": 39, "episode_return_max": 371.4467041015623, "episode_return_min": 97.06973876953145, "episode_return_mean": 309.20060698061974}, "episode_reward_max": 371.4467041015623, "episode_reward_min": 97.06973876953145, "episode_reward_mean": 309.20060698061974, "episode_len_mean": 47.794871794871796, "episodes_this_iter": 39, "episodes_timesteps_total": 1864, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [285.4091209488859, 289.29386518462354, 322.74055885129883, 348.06252894664084, 340.99026540197775, 355.71854949488494, 333.2696002621652, 330.5357890130351, 359.90564568072796, 175.96610107421895, 279.7525674574649, 339.50611430955337, 333.4509628838135, 298.46338911103607, 352.11764799264466, 344.0450435877027, 288.65027358944786, 303.4764853134288, 337.5979299684405, 143.71992187500007, 340.0833612513573, 371.4467041015623, 334.8250922171236, 360.3286253191195, 342.6920731380228, 307.6693222416579, 339.4248699593599, 175.719171397931, 306.4503090069431, 97.06973876953145, 292.6596018677808, 259.90182726658117, 309.83755478705336, 353.71602833280815, 343.6909230060803, 331.00607156234685, 358.00487189127716, 323.65979665463936, 347.965368526001], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 39, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.416636100895087, "mean_inference_ms": 1.2389574473665428, "mean_action_processing_ms": 0.2054584804311625, "mean_env_wait_ms": 511.7718230593478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012111052488669371, "StateBufferConnector_ms": 0.006060111217009716, "ViewRequirementAgentConnector_ms": 0.1644574678861178}, "num_episodes": 39, "episode_return_max": 371.4467041015623, "episode_return_min": 97.06973876953145, "episode_return_mean": 309.20060698061974, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66924, "num_agent_steps_trained": 66924, "num_env_steps_sampled": 66924, "num_env_steps_trained": 66924, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 10.556594815518874, "num_env_steps_trained_throughput_per_sec": 10.556594815518874, "timesteps_total": 66924, "num_env_steps_sampled_lifetime": 66924, "num_agent_steps_sampled_lifetime": 66924, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 66924, "timers": {"training_iteration_time_ms": 194380.877, "restore_workers_time_ms": 0.028, "training_step_time_ms": 194380.8, "sample_time_ms": 191831.673, "load_time_ms": 0.651, "load_throughput": 3153796.925, "learn_time_ms": 2535.976, "learn_throughput": 809.156, "synch_weights_time_ms": 11.987}, "counters": {"num_env_steps_sampled": 66924, "num_env_steps_trained": 66924, "num_agent_steps_sampled": 66924, "num_agent_steps_trained": 66924}, "done": false, "episodes_total": 1615, "training_iteration": 97, "trial_id": "fe178_00005", "date": "2024-08-15_19-04-42", "timestamp": 1723770282, "time_this_iter_s": 194.38415360450745, "time_total_s": 6831.062769412994, "pid": 78406, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.35639344959423686, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9599544327688427, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 194.38415360450745, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 20.72410071942446, "ram_util_percent": 10.593165467625901}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.913134621580443, "cur_kl_coeff": 0.18040672363713384, "cur_lr": 0.00010000000000000003, "total_loss": 7.031260459000865, "policy_loss": -0.005215514063699326, "vf_loss": 7.033547105267644, "vf_explained_var": 0.10910434474547705, "kl": 0.01623478377356841, "entropy": -1.2865697257220745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 720.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 68976, "num_env_steps_trained": 68976, "num_agent_steps_sampled": 68976, "num_agent_steps_trained": 68976}, "sampler_results": {"episode_reward_max": 377.63052189544186, "episode_reward_min": 97.06973876953145, "episode_reward_mean": 317.5463513095968, "episode_len_mean": 48.47560975609756, "episode_media": {}, "episodes_this_iter": 43, "episodes_timesteps_total": 3975, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.4091209488859, 289.29386518462354, 322.74055885129883, 348.06252894664084, 340.99026540197775, 355.71854949488494, 333.2696002621652, 330.5357890130351, 359.90564568072796, 175.96610107421895, 279.7525674574649, 339.50611430955337, 333.4509628838135, 298.46338911103607, 352.11764799264466, 344.0450435877027, 288.65027358944786, 303.4764853134288, 337.5979299684405, 143.71992187500007, 340.0833612513573, 371.4467041015623, 334.8250922171236, 360.3286253191195, 342.6920731380228, 307.6693222416579, 339.4248699593599, 175.719171397931, 306.4503090069431, 97.06973876953145, 292.6596018677808, 259.90182726658117, 309.83755478705336, 353.71602833280815, 343.6909230060803, 331.00607156234685, 358.00487189127716, 323.65979665463936, 347.965368526001, 365.9624163687963, 325.2432108713432, 336.0343290724375, 348.636925545722, 367.0458844586403, 312.3908721652128, 292.0519237500429, 362.21821869306393, 354.56522523118576, 317.0758692146035, 317.7499845345518, 298.5378361843472, 359.48486527918, 355.0740593933366, 338.9496775998907, 231.0203435198755, 345.9856890555043, 281.482847228678, 348.2030370968971, 323.0942138671878, 353.8142931360962, 357.51548247309154, 305.5770769212906, 345.3658068678848, 341.68891383225, 335.621451921636, 255.34502035731606, 326.3838353861043, 326.1531012866734, 377.63052189544186, 359.21589877288824, 343.47963989668864, 344.84914876953326, 350.08749952729676, 264.3034970337425, 365.62436116130414, 333.2700544936885, 344.2368097084309, 144.3443750348302, 353.1506489834819, 329.8364952622767, 197.80821139280147, 343.86756189752305], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 39, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 36, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.508891935044104, "mean_inference_ms": 1.238692016888007, "mean_action_processing_ms": 0.20587703879997168, "mean_env_wait_ms": 503.8983017155162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01141647013222299, "StateBufferConnector_ms": 0.006089268661126858, "ViewRequirementAgentConnector_ms": 0.1659774198764708}, "num_episodes": 43, "episode_return_max": 377.63052189544186, "episode_return_min": 97.06973876953145, "episode_return_mean": 317.5463513095968}, "env_runner_results": {"episode_reward_max": 377.63052189544186, "episode_reward_min": 97.06973876953145, "episode_reward_mean": 317.5463513095968, "episode_len_mean": 48.47560975609756, "episode_media": {}, "episodes_this_iter": 43, "episodes_timesteps_total": 3975, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.4091209488859, 289.29386518462354, 322.74055885129883, 348.06252894664084, 340.99026540197775, 355.71854949488494, 333.2696002621652, 330.5357890130351, 359.90564568072796, 175.96610107421895, 279.7525674574649, 339.50611430955337, 333.4509628838135, 298.46338911103607, 352.11764799264466, 344.0450435877027, 288.65027358944786, 303.4764853134288, 337.5979299684405, 143.71992187500007, 340.0833612513573, 371.4467041015623, 334.8250922171236, 360.3286253191195, 342.6920731380228, 307.6693222416579, 339.4248699593599, 175.719171397931, 306.4503090069431, 97.06973876953145, 292.6596018677808, 259.90182726658117, 309.83755478705336, 353.71602833280815, 343.6909230060803, 331.00607156234685, 358.00487189127716, 323.65979665463936, 347.965368526001, 365.9624163687963, 325.2432108713432, 336.0343290724375, 348.636925545722, 367.0458844586403, 312.3908721652128, 292.0519237500429, 362.21821869306393, 354.56522523118576, 317.0758692146035, 317.7499845345518, 298.5378361843472, 359.48486527918, 355.0740593933366, 338.9496775998907, 231.0203435198755, 345.9856890555043, 281.482847228678, 348.2030370968971, 323.0942138671878, 353.8142931360962, 357.51548247309154, 305.5770769212906, 345.3658068678848, 341.68891383225, 335.621451921636, 255.34502035731606, 326.3838353861043, 326.1531012866734, 377.63052189544186, 359.21589877288824, 343.47963989668864, 344.84914876953326, 350.08749952729676, 264.3034970337425, 365.62436116130414, 333.2700544936885, 344.2368097084309, 144.3443750348302, 353.1506489834819, 329.8364952622767, 197.80821139280147, 343.86756189752305], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 39, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 36, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.508891935044104, "mean_inference_ms": 1.238692016888007, "mean_action_processing_ms": 0.20587703879997168, "mean_env_wait_ms": 503.8983017155162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01141647013222299, "StateBufferConnector_ms": 0.006089268661126858, "ViewRequirementAgentConnector_ms": 0.1659774198764708}, "num_episodes": 43, "episode_return_max": 377.63052189544186, "episode_return_min": 97.06973876953145, "episode_return_mean": 317.5463513095968}, "episode_reward_max": 377.63052189544186, "episode_reward_min": 97.06973876953145, "episode_reward_mean": 317.5463513095968, "episode_len_mean": 48.47560975609756, "episodes_this_iter": 43, "episodes_timesteps_total": 3975, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [285.4091209488859, 289.29386518462354, 322.74055885129883, 348.06252894664084, 340.99026540197775, 355.71854949488494, 333.2696002621652, 330.5357890130351, 359.90564568072796, 175.96610107421895, 279.7525674574649, 339.50611430955337, 333.4509628838135, 298.46338911103607, 352.11764799264466, 344.0450435877027, 288.65027358944786, 303.4764853134288, 337.5979299684405, 143.71992187500007, 340.0833612513573, 371.4467041015623, 334.8250922171236, 360.3286253191195, 342.6920731380228, 307.6693222416579, 339.4248699593599, 175.719171397931, 306.4503090069431, 97.06973876953145, 292.6596018677808, 259.90182726658117, 309.83755478705336, 353.71602833280815, 343.6909230060803, 331.00607156234685, 358.00487189127716, 323.65979665463936, 347.965368526001, 365.9624163687963, 325.2432108713432, 336.0343290724375, 348.636925545722, 367.0458844586403, 312.3908721652128, 292.0519237500429, 362.21821869306393, 354.56522523118576, 317.0758692146035, 317.7499845345518, 298.5378361843472, 359.48486527918, 355.0740593933366, 338.9496775998907, 231.0203435198755, 345.9856890555043, 281.482847228678, 348.2030370968971, 323.0942138671878, 353.8142931360962, 357.51548247309154, 305.5770769212906, 345.3658068678848, 341.68891383225, 335.621451921636, 255.34502035731606, 326.3838353861043, 326.1531012866734, 377.63052189544186, 359.21589877288824, 343.47963989668864, 344.84914876953326, 350.08749952729676, 264.3034970337425, 365.62436116130414, 333.2700544936885, 344.2368097084309, 144.3443750348302, 353.1506489834819, 329.8364952622767, 197.80821139280147, 343.86756189752305], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 31, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 39, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 36, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.508891935044104, "mean_inference_ms": 1.238692016888007, "mean_action_processing_ms": 0.20587703879997168, "mean_env_wait_ms": 503.8983017155162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01141647013222299, "StateBufferConnector_ms": 0.006089268661126858, "ViewRequirementAgentConnector_ms": 0.1659774198764708}, "num_episodes": 43, "episode_return_max": 377.63052189544186, "episode_return_min": 97.06973876953145, "episode_return_mean": 317.5463513095968, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68976, "num_agent_steps_trained": 68976, "num_env_steps_sampled": 68976, "num_env_steps_trained": 68976, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 11.281938894550853, "num_env_steps_trained_throughput_per_sec": 11.281938894550853, "timesteps_total": 68976, "num_env_steps_sampled_lifetime": 68976, "num_agent_steps_sampled_lifetime": 68976, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 68976, "timers": {"training_iteration_time_ms": 188132.258, "restore_workers_time_ms": 0.022, "training_step_time_ms": 188132.197, "sample_time_ms": 185552.106, "load_time_ms": 0.598, "load_throughput": 3431703.273, "learn_time_ms": 2567.039, "learn_throughput": 799.365, "synch_weights_time_ms": 12.033}, "counters": {"num_env_steps_sampled": 68976, "num_env_steps_trained": 68976, "num_agent_steps_sampled": 68976, "num_agent_steps_trained": 68976}, "done": false, "episodes_total": 1658, "training_iteration": 98, "trial_id": "fe178_00005", "date": "2024-08-15_19-07-43", "timestamp": 1723770463, "time_this_iter_s": 181.88712453842163, "time_total_s": 7012.949893951416, "pid": 78406, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.35639344959423686, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9599544327688427, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 376.2712781429291, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 22.42923076923077, "ram_util_percent": 10.728461538461541}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.633551607529323, "cur_kl_coeff": 0.18040672363713384, "cur_lr": 0.00010000000000000003, "total_loss": 6.883590838188926, "policy_loss": -0.005634090313105844, "vf_loss": 6.887468185399969, "vf_explained_var": 0.10568661031623681, "kl": 0.009737482231382688, "entropy": -1.2675705244143805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1200.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 71028, "num_env_steps_trained": 71028, "num_agent_steps_sampled": 71028, "num_agent_steps_trained": 71028}, "sampler_results": {"episode_reward_max": 377.63052189544186, "episode_reward_min": 92.18082275390634, "episode_reward_mean": 315.9752871446763, "episode_len_mean": 48.29, "episode_media": {}, "episodes_this_iter": 44, "episodes_timesteps_total": 4829, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [339.4248699593599, 175.719171397931, 306.4503090069431, 97.06973876953145, 292.6596018677808, 259.90182726658117, 309.83755478705336, 353.71602833280815, 343.6909230060803, 331.00607156234685, 358.00487189127716, 323.65979665463936, 347.965368526001, 365.9624163687963, 325.2432108713432, 336.0343290724375, 348.636925545722, 367.0458844586403, 312.3908721652128, 292.0519237500429, 362.21821869306393, 354.56522523118576, 317.0758692146035, 317.7499845345518, 298.5378361843472, 359.48486527918, 355.0740593933366, 338.9496775998907, 231.0203435198755, 345.9856890555043, 281.482847228678, 348.2030370968971, 323.0942138671878, 353.8142931360962, 357.51548247309154, 305.5770769212906, 345.3658068678848, 341.68891383225, 335.621451921636, 255.34502035731606, 326.3838353861043, 326.1531012866734, 377.63052189544186, 359.21589877288824, 343.47963989668864, 344.84914876953326, 350.08749952729676, 264.3034970337425, 365.62436116130414, 333.2700544936885, 344.2368097084309, 144.3443750348302, 353.1506489834819, 329.8364952622767, 197.80821139280147, 343.86756189752305, 352.4530503478346, 335.7554757039563, 292.49502970615913, 325.17556529400457, 348.6179328512073, 329.9345640950925, 339.349516396874, 357.3915322810943, 346.40639648437536, 92.18082275390634, 115.73326886504094, 337.06724455493435, 335.7847097381024, 318.4604891905682, 334.6096157914444, 314.93613062077503, 276.08931652578644, 362.4218378706023, 343.61758948073634, 354.58712959615576, 287.86754397579455, 291.3657662308979, 318.6376614490335, 348.3720637884095, 335.4877398727457, 295.98009266155304, 319.40314056151095, 339.911469227789, 116.29429718943418, 313.54587104970983, 349.1442826696938, 337.9447471350333, 354.54978960475364, 349.81264037179716, 325.75089884565404, 342.0830195091604, 323.9455201885547, 312.24494723545797, 289.7805747454718, 300.8483068618918, 335.7900832056815, 358.4378746230966, 294.75368825073315, 323.426208894023], "episode_lengths": [50, 39, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 36, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 16, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.602478884806545, "mean_inference_ms": 1.2362141213111824, "mean_action_processing_ms": 0.20629314339097696, "mean_env_wait_ms": 498.16415385433817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010343074798583984, "StateBufferConnector_ms": 0.006097316741943359, "ViewRequirementAgentConnector_ms": 0.16676044464111328}, "num_episodes": 44, "episode_return_max": 377.63052189544186, "episode_return_min": 92.18082275390634, "episode_return_mean": 315.9752871446763}, "env_runner_results": {"episode_reward_max": 377.63052189544186, "episode_reward_min": 92.18082275390634, "episode_reward_mean": 315.9752871446763, "episode_len_mean": 48.29, "episode_media": {}, "episodes_this_iter": 44, "episodes_timesteps_total": 4829, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [339.4248699593599, 175.719171397931, 306.4503090069431, 97.06973876953145, 292.6596018677808, 259.90182726658117, 309.83755478705336, 353.71602833280815, 343.6909230060803, 331.00607156234685, 358.00487189127716, 323.65979665463936, 347.965368526001, 365.9624163687963, 325.2432108713432, 336.0343290724375, 348.636925545722, 367.0458844586403, 312.3908721652128, 292.0519237500429, 362.21821869306393, 354.56522523118576, 317.0758692146035, 317.7499845345518, 298.5378361843472, 359.48486527918, 355.0740593933366, 338.9496775998907, 231.0203435198755, 345.9856890555043, 281.482847228678, 348.2030370968971, 323.0942138671878, 353.8142931360962, 357.51548247309154, 305.5770769212906, 345.3658068678848, 341.68891383225, 335.621451921636, 255.34502035731606, 326.3838353861043, 326.1531012866734, 377.63052189544186, 359.21589877288824, 343.47963989668864, 344.84914876953326, 350.08749952729676, 264.3034970337425, 365.62436116130414, 333.2700544936885, 344.2368097084309, 144.3443750348302, 353.1506489834819, 329.8364952622767, 197.80821139280147, 343.86756189752305, 352.4530503478346, 335.7554757039563, 292.49502970615913, 325.17556529400457, 348.6179328512073, 329.9345640950925, 339.349516396874, 357.3915322810943, 346.40639648437536, 92.18082275390634, 115.73326886504094, 337.06724455493435, 335.7847097381024, 318.4604891905682, 334.6096157914444, 314.93613062077503, 276.08931652578644, 362.4218378706023, 343.61758948073634, 354.58712959615576, 287.86754397579455, 291.3657662308979, 318.6376614490335, 348.3720637884095, 335.4877398727457, 295.98009266155304, 319.40314056151095, 339.911469227789, 116.29429718943418, 313.54587104970983, 349.1442826696938, 337.9447471350333, 354.54978960475364, 349.81264037179716, 325.75089884565404, 342.0830195091604, 323.9455201885547, 312.24494723545797, 289.7805747454718, 300.8483068618918, 335.7900832056815, 358.4378746230966, 294.75368825073315, 323.426208894023], "episode_lengths": [50, 39, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 36, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 16, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.602478884806545, "mean_inference_ms": 1.2362141213111824, "mean_action_processing_ms": 0.20629314339097696, "mean_env_wait_ms": 498.16415385433817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010343074798583984, "StateBufferConnector_ms": 0.006097316741943359, "ViewRequirementAgentConnector_ms": 0.16676044464111328}, "num_episodes": 44, "episode_return_max": 377.63052189544186, "episode_return_min": 92.18082275390634, "episode_return_mean": 315.9752871446763}, "episode_reward_max": 377.63052189544186, "episode_reward_min": 92.18082275390634, "episode_reward_mean": 315.9752871446763, "episode_len_mean": 48.29, "episodes_this_iter": 44, "episodes_timesteps_total": 4829, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [339.4248699593599, 175.719171397931, 306.4503090069431, 97.06973876953145, 292.6596018677808, 259.90182726658117, 309.83755478705336, 353.71602833280815, 343.6909230060803, 331.00607156234685, 358.00487189127716, 323.65979665463936, 347.965368526001, 365.9624163687963, 325.2432108713432, 336.0343290724375, 348.636925545722, 367.0458844586403, 312.3908721652128, 292.0519237500429, 362.21821869306393, 354.56522523118576, 317.0758692146035, 317.7499845345518, 298.5378361843472, 359.48486527918, 355.0740593933366, 338.9496775998907, 231.0203435198755, 345.9856890555043, 281.482847228678, 348.2030370968971, 323.0942138671878, 353.8142931360962, 357.51548247309154, 305.5770769212906, 345.3658068678848, 341.68891383225, 335.621451921636, 255.34502035731606, 326.3838353861043, 326.1531012866734, 377.63052189544186, 359.21589877288824, 343.47963989668864, 344.84914876953326, 350.08749952729676, 264.3034970337425, 365.62436116130414, 333.2700544936885, 344.2368097084309, 144.3443750348302, 353.1506489834819, 329.8364952622767, 197.80821139280147, 343.86756189752305, 352.4530503478346, 335.7554757039563, 292.49502970615913, 325.17556529400457, 348.6179328512073, 329.9345640950925, 339.349516396874, 357.3915322810943, 346.40639648437536, 92.18082275390634, 115.73326886504094, 337.06724455493435, 335.7847097381024, 318.4604891905682, 334.6096157914444, 314.93613062077503, 276.08931652578644, 362.4218378706023, 343.61758948073634, 354.58712959615576, 287.86754397579455, 291.3657662308979, 318.6376614490335, 348.3720637884095, 335.4877398727457, 295.98009266155304, 319.40314056151095, 339.911469227789, 116.29429718943418, 313.54587104970983, 349.1442826696938, 337.9447471350333, 354.54978960475364, 349.81264037179716, 325.75089884565404, 342.0830195091604, 323.9455201885547, 312.24494723545797, 289.7805747454718, 300.8483068618918, 335.7900832056815, 358.4378746230966, 294.75368825073315, 323.426208894023], "episode_lengths": [50, 39, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 36, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 16, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.602478884806545, "mean_inference_ms": 1.2362141213111824, "mean_action_processing_ms": 0.20629314339097696, "mean_env_wait_ms": 498.16415385433817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010343074798583984, "StateBufferConnector_ms": 0.006097316741943359, "ViewRequirementAgentConnector_ms": 0.16676044464111328}, "num_episodes": 44, "episode_return_max": 377.63052189544186, "episode_return_min": 92.18082275390634, "episode_return_mean": 315.9752871446763, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71028, "num_agent_steps_trained": 71028, "num_env_steps_sampled": 71028, "num_env_steps_trained": 71028, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 10.998848075213365, "num_env_steps_trained_throughput_per_sec": 10.998848075213365, "timesteps_total": 71028, "num_env_steps_sampled_lifetime": 71028, "num_agent_steps_sampled_lifetime": 71028, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 71028, "timers": {"training_iteration_time_ms": 187609.839, "restore_workers_time_ms": 0.019, "training_step_time_ms": 187609.784, "sample_time_ms": 185048.172, "load_time_ms": 0.607, "load_throughput": 3379156.58, "learn_time_ms": 2548.163, "learn_throughput": 805.286, "synch_weights_time_ms": 12.443}, "counters": {"num_env_steps_sampled": 71028, "num_env_steps_trained": 71028, "num_agent_steps_sampled": 71028, "num_agent_steps_trained": 71028}, "done": false, "episodes_total": 1702, "training_iteration": 99, "trial_id": "fe178_00005", "date": "2024-08-15_19-10-50", "timestamp": 1723770650, "time_this_iter_s": 186.56907391548157, "time_total_s": 7199.518967866898, "pid": 78406, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.35639344959423686, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9599544327688427, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 562.8403520584106, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.232706766917293, "ram_util_percent": 10.96842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.497361743450163, "cur_kl_coeff": 0.18040672363713384, "cur_lr": 0.00010000000000000003, "total_loss": 7.102194087083141, "policy_loss": -0.004859397620748496, "vf_loss": 7.104985406622291, "vf_explained_var": 0.1047082948187987, "kl": 0.011463546711488042, "entropy": -1.3001800095041594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1680.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 73080, "num_env_steps_trained": 73080, "num_agent_steps_sampled": 73080, "num_agent_steps_trained": 73080}, "sampler_results": {"episode_reward_max": 377.63052189544186, "episode_reward_min": 92.18082275390634, "episode_reward_mean": 317.3031794875443, "episode_len_mean": 48.16, "episode_media": {}, "episodes_this_iter": 41, "episodes_timesteps_total": 4816, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.1531012866734, 377.63052189544186, 359.21589877288824, 343.47963989668864, 344.84914876953326, 350.08749952729676, 264.3034970337425, 365.62436116130414, 333.2700544936885, 344.2368097084309, 144.3443750348302, 353.1506489834819, 329.8364952622767, 197.80821139280147, 343.86756189752305, 352.4530503478346, 335.7554757039563, 292.49502970615913, 325.17556529400457, 348.6179328512073, 329.9345640950925, 339.349516396874, 357.3915322810943, 346.40639648437536, 92.18082275390634, 115.73326886504094, 337.06724455493435, 335.7847097381024, 318.4604891905682, 334.6096157914444, 314.93613062077503, 276.08931652578644, 362.4218378706023, 343.61758948073634, 354.58712959615576, 287.86754397579455, 291.3657662308979, 318.6376614490335, 348.3720637884095, 335.4877398727457, 295.98009266155304, 319.40314056151095, 339.911469227789, 116.29429718943418, 313.54587104970983, 349.1442826696938, 337.9447471350333, 354.54978960475364, 349.81264037179716, 325.75089884565404, 342.0830195091604, 323.9455201885547, 312.24494723545797, 289.7805747454718, 300.8483068618918, 335.7900832056815, 358.4378746230966, 294.75368825073315, 323.426208894023, 336.38900873917447, 332.5899471129911, 349.0312643279951, 312.0886679037155, 273.24789609813905, 344.61456775656035, 360.3574036353339, 275.56481530987764, 353.85484644967136, 111.02822265625014, 323.269136543026, 350.1823973979984, 321.2474930106267, 340.74139694283616, 330.39987939405336, 351.0515710189658, 349.7091963932819, 308.00701591695224, 350.574266379641, 327.8320342778015, 129.4776339231534, 364.7791563529184, 334.1044576986181, 338.2744493269162, 348.27598378720444, 358.0971550013295, 321.71286904575317, 321.46777453045814, 304.5528570848205, 259.31252092929003, 334.694386754725, 306.61121874485053, 351.1658259490118, 344.9613095948605, 343.9268247981693, 333.5386628425899, 322.6658557431621, 339.2315542642556, 332.3044635946854, 325.80413170000605, 357.27455840962216], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 36, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 16, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.666798413206792, "mean_inference_ms": 1.2344734573636051, "mean_action_processing_ms": 0.20646830468838573, "mean_env_wait_ms": 494.91183898619755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009737968444824219, "StateBufferConnector_ms": 0.006018161773681641, "ViewRequirementAgentConnector_ms": 0.16697907447814941}, "num_episodes": 41, "episode_return_max": 377.63052189544186, "episode_return_min": 92.18082275390634, "episode_return_mean": 317.3031794875443}, "env_runner_results": {"episode_reward_max": 377.63052189544186, "episode_reward_min": 92.18082275390634, "episode_reward_mean": 317.3031794875443, "episode_len_mean": 48.16, "episode_media": {}, "episodes_this_iter": 41, "episodes_timesteps_total": 4816, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.1531012866734, 377.63052189544186, 359.21589877288824, 343.47963989668864, 344.84914876953326, 350.08749952729676, 264.3034970337425, 365.62436116130414, 333.2700544936885, 344.2368097084309, 144.3443750348302, 353.1506489834819, 329.8364952622767, 197.80821139280147, 343.86756189752305, 352.4530503478346, 335.7554757039563, 292.49502970615913, 325.17556529400457, 348.6179328512073, 329.9345640950925, 339.349516396874, 357.3915322810943, 346.40639648437536, 92.18082275390634, 115.73326886504094, 337.06724455493435, 335.7847097381024, 318.4604891905682, 334.6096157914444, 314.93613062077503, 276.08931652578644, 362.4218378706023, 343.61758948073634, 354.58712959615576, 287.86754397579455, 291.3657662308979, 318.6376614490335, 348.3720637884095, 335.4877398727457, 295.98009266155304, 319.40314056151095, 339.911469227789, 116.29429718943418, 313.54587104970983, 349.1442826696938, 337.9447471350333, 354.54978960475364, 349.81264037179716, 325.75089884565404, 342.0830195091604, 323.9455201885547, 312.24494723545797, 289.7805747454718, 300.8483068618918, 335.7900832056815, 358.4378746230966, 294.75368825073315, 323.426208894023, 336.38900873917447, 332.5899471129911, 349.0312643279951, 312.0886679037155, 273.24789609813905, 344.61456775656035, 360.3574036353339, 275.56481530987764, 353.85484644967136, 111.02822265625014, 323.269136543026, 350.1823973979984, 321.2474930106267, 340.74139694283616, 330.39987939405336, 351.0515710189658, 349.7091963932819, 308.00701591695224, 350.574266379641, 327.8320342778015, 129.4776339231534, 364.7791563529184, 334.1044576986181, 338.2744493269162, 348.27598378720444, 358.0971550013295, 321.71286904575317, 321.46777453045814, 304.5528570848205, 259.31252092929003, 334.694386754725, 306.61121874485053, 351.1658259490118, 344.9613095948605, 343.9268247981693, 333.5386628425899, 322.6658557431621, 339.2315542642556, 332.3044635946854, 325.80413170000605, 357.27455840962216], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 36, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 16, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.666798413206792, "mean_inference_ms": 1.2344734573636051, "mean_action_processing_ms": 0.20646830468838573, "mean_env_wait_ms": 494.91183898619755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009737968444824219, "StateBufferConnector_ms": 0.006018161773681641, "ViewRequirementAgentConnector_ms": 0.16697907447814941}, "num_episodes": 41, "episode_return_max": 377.63052189544186, "episode_return_min": 92.18082275390634, "episode_return_mean": 317.3031794875443}, "episode_reward_max": 377.63052189544186, "episode_reward_min": 92.18082275390634, "episode_reward_mean": 317.3031794875443, "episode_len_mean": 48.16, "episodes_this_iter": 41, "episodes_timesteps_total": 4816, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [326.1531012866734, 377.63052189544186, 359.21589877288824, 343.47963989668864, 344.84914876953326, 350.08749952729676, 264.3034970337425, 365.62436116130414, 333.2700544936885, 344.2368097084309, 144.3443750348302, 353.1506489834819, 329.8364952622767, 197.80821139280147, 343.86756189752305, 352.4530503478346, 335.7554757039563, 292.49502970615913, 325.17556529400457, 348.6179328512073, 329.9345640950925, 339.349516396874, 357.3915322810943, 346.40639648437536, 92.18082275390634, 115.73326886504094, 337.06724455493435, 335.7847097381024, 318.4604891905682, 334.6096157914444, 314.93613062077503, 276.08931652578644, 362.4218378706023, 343.61758948073634, 354.58712959615576, 287.86754397579455, 291.3657662308979, 318.6376614490335, 348.3720637884095, 335.4877398727457, 295.98009266155304, 319.40314056151095, 339.911469227789, 116.29429718943418, 313.54587104970983, 349.1442826696938, 337.9447471350333, 354.54978960475364, 349.81264037179716, 325.75089884565404, 342.0830195091604, 323.9455201885547, 312.24494723545797, 289.7805747454718, 300.8483068618918, 335.7900832056815, 358.4378746230966, 294.75368825073315, 323.426208894023, 336.38900873917447, 332.5899471129911, 349.0312643279951, 312.0886679037155, 273.24789609813905, 344.61456775656035, 360.3574036353339, 275.56481530987764, 353.85484644967136, 111.02822265625014, 323.269136543026, 350.1823973979984, 321.2474930106267, 340.74139694283616, 330.39987939405336, 351.0515710189658, 349.7091963932819, 308.00701591695224, 350.574266379641, 327.8320342778015, 129.4776339231534, 364.7791563529184, 334.1044576986181, 338.2744493269162, 348.27598378720444, 358.0971550013295, 321.71286904575317, 321.46777453045814, 304.5528570848205, 259.31252092929003, 334.694386754725, 306.61121874485053, 351.1658259490118, 344.9613095948605, 343.9268247981693, 333.5386628425899, 322.6658557431621, 339.2315542642556, 332.3044635946854, 325.80413170000605, 357.27455840962216], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 36, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 16, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.666798413206792, "mean_inference_ms": 1.2344734573636051, "mean_action_processing_ms": 0.20646830468838573, "mean_env_wait_ms": 494.91183898619755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009737968444824219, "StateBufferConnector_ms": 0.006018161773681641, "ViewRequirementAgentConnector_ms": 0.16697907447814941}, "num_episodes": 41, "episode_return_max": 377.63052189544186, "episode_return_min": 92.18082275390634, "episode_return_mean": 317.3031794875443, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73080, "num_agent_steps_trained": 73080, "num_env_steps_sampled": 73080, "num_env_steps_trained": 73080, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 10.73801101504799, "num_env_steps_trained_throughput_per_sec": 10.73801101504799, "timesteps_total": 73080, "num_env_steps_sampled_lifetime": 73080, "num_agent_steps_sampled_lifetime": 73080, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 73080, "timers": {"training_iteration_time_ms": 188481.593, "restore_workers_time_ms": 0.019, "training_step_time_ms": 188481.537, "sample_time_ms": 185934.199, "load_time_ms": 0.598, "load_throughput": 3432045.383, "learn_time_ms": 2533.803, "learn_throughput": 809.85, "synch_weights_time_ms": 12.551}, "counters": {"num_env_steps_sampled": 73080, "num_env_steps_trained": 73080, "num_agent_steps_sampled": 73080, "num_agent_steps_trained": 73080}, "done": false, "episodes_total": 1743, "training_iteration": 100, "trial_id": "fe178_00005", "date": "2024-08-15_19-14-01", "timestamp": 1723770841, "time_this_iter_s": 191.10054302215576, "time_total_s": 7390.619510889053, "pid": 78406, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.35639344959423686, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9599544327688427, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 753.9408950805664, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.774725274725274, "ram_util_percent": 11.053113553113551}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.924904063840707, "cur_kl_coeff": 0.18040672363713384, "cur_lr": 0.00010000000000000003, "total_loss": 6.545128608619174, "policy_loss": -0.00246195681199121, "vf_loss": 6.5436198268085715, "vf_explained_var": 0.1334733379383882, "kl": 0.022010023003047777, "entropy": -1.3840762221564848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2160.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 75132, "num_env_steps_trained": 75132, "num_agent_steps_sampled": 75132, "num_agent_steps_trained": 75132}, "sampler_results": {"episode_reward_max": 371.3172485641833, "episode_reward_min": 75.50835177305036, "episode_reward_mean": 322.02270896480803, "episode_len_mean": 48.53, "episode_media": {}, "episodes_this_iter": 43, "episodes_timesteps_total": 4853, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.29429718943418, 313.54587104970983, 349.1442826696938, 337.9447471350333, 354.54978960475364, 349.81264037179716, 325.75089884565404, 342.0830195091604, 323.9455201885547, 312.24494723545797, 289.7805747454718, 300.8483068618918, 335.7900832056815, 358.4378746230966, 294.75368825073315, 323.426208894023, 336.38900873917447, 332.5899471129911, 349.0312643279951, 312.0886679037155, 273.24789609813905, 344.61456775656035, 360.3574036353339, 275.56481530987764, 353.85484644967136, 111.02822265625014, 323.269136543026, 350.1823973979984, 321.2474930106267, 340.74139694283616, 330.39987939405336, 351.0515710189658, 349.7091963932819, 308.00701591695224, 350.574266379641, 327.8320342778015, 129.4776339231534, 364.7791563529184, 334.1044576986181, 338.2744493269162, 348.27598378720444, 358.0971550013295, 321.71286904575317, 321.46777453045814, 304.5528570848205, 259.31252092929003, 334.694386754725, 306.61121874485053, 351.1658259490118, 344.9613095948605, 343.9268247981693, 333.5386628425899, 322.6658557431621, 339.2315542642556, 332.3044635946854, 325.80413170000605, 357.27455840962216, 359.78477853217953, 352.83720866538164, 357.6219398102832, 322.60723188209465, 348.4677833156169, 343.76935174705045, 361.3832129843625, 310.8422595854819, 286.8566607823262, 336.70716722778633, 357.9573852539065, 311.06415414207964, 367.860763619933, 322.05421993403934, 371.3172485641833, 354.94578744585914, 352.0847608391671, 351.6308227539066, 325.24928931956816, 349.72575484492035, 335.70189725148333, 340.87873941686354, 124.57148197665992, 75.50835177305036, 355.1970810507277, 313.7502056273355, 293.6520781823102, 328.8598069093514, 333.8986596772172, 331.2949029191419, 347.03748679190255, 341.70460271403533, 359.08959049680936, 332.20279242421344, 333.13957940014757, 309.81792533067716, 336.9449978750209, 349.32021597406134, 300.8930860995844, 336.9097086376892, 315.51792859227186, 303.98579565788975, 355.2587727307984], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.664935709580883, "mean_inference_ms": 1.2331902633891114, "mean_action_processing_ms": 0.20655532275173755, "mean_env_wait_ms": 496.0595852840161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009563684463500977, "StateBufferConnector_ms": 0.005992412567138672, "ViewRequirementAgentConnector_ms": 0.16745924949645996}, "num_episodes": 43, "episode_return_max": 371.3172485641833, "episode_return_min": 75.50835177305036, "episode_return_mean": 322.02270896480803}, "env_runner_results": {"episode_reward_max": 371.3172485641833, "episode_reward_min": 75.50835177305036, "episode_reward_mean": 322.02270896480803, "episode_len_mean": 48.53, "episode_media": {}, "episodes_this_iter": 43, "episodes_timesteps_total": 4853, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.29429718943418, 313.54587104970983, 349.1442826696938, 337.9447471350333, 354.54978960475364, 349.81264037179716, 325.75089884565404, 342.0830195091604, 323.9455201885547, 312.24494723545797, 289.7805747454718, 300.8483068618918, 335.7900832056815, 358.4378746230966, 294.75368825073315, 323.426208894023, 336.38900873917447, 332.5899471129911, 349.0312643279951, 312.0886679037155, 273.24789609813905, 344.61456775656035, 360.3574036353339, 275.56481530987764, 353.85484644967136, 111.02822265625014, 323.269136543026, 350.1823973979984, 321.2474930106267, 340.74139694283616, 330.39987939405336, 351.0515710189658, 349.7091963932819, 308.00701591695224, 350.574266379641, 327.8320342778015, 129.4776339231534, 364.7791563529184, 334.1044576986181, 338.2744493269162, 348.27598378720444, 358.0971550013295, 321.71286904575317, 321.46777453045814, 304.5528570848205, 259.31252092929003, 334.694386754725, 306.61121874485053, 351.1658259490118, 344.9613095948605, 343.9268247981693, 333.5386628425899, 322.6658557431621, 339.2315542642556, 332.3044635946854, 325.80413170000605, 357.27455840962216, 359.78477853217953, 352.83720866538164, 357.6219398102832, 322.60723188209465, 348.4677833156169, 343.76935174705045, 361.3832129843625, 310.8422595854819, 286.8566607823262, 336.70716722778633, 357.9573852539065, 311.06415414207964, 367.860763619933, 322.05421993403934, 371.3172485641833, 354.94578744585914, 352.0847608391671, 351.6308227539066, 325.24928931956816, 349.72575484492035, 335.70189725148333, 340.87873941686354, 124.57148197665992, 75.50835177305036, 355.1970810507277, 313.7502056273355, 293.6520781823102, 328.8598069093514, 333.8986596772172, 331.2949029191419, 347.03748679190255, 341.70460271403533, 359.08959049680936, 332.20279242421344, 333.13957940014757, 309.81792533067716, 336.9449978750209, 349.32021597406134, 300.8930860995844, 336.9097086376892, 315.51792859227186, 303.98579565788975, 355.2587727307984], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.664935709580883, "mean_inference_ms": 1.2331902633891114, "mean_action_processing_ms": 0.20655532275173755, "mean_env_wait_ms": 496.0595852840161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009563684463500977, "StateBufferConnector_ms": 0.005992412567138672, "ViewRequirementAgentConnector_ms": 0.16745924949645996}, "num_episodes": 43, "episode_return_max": 371.3172485641833, "episode_return_min": 75.50835177305036, "episode_return_mean": 322.02270896480803}, "episode_reward_max": 371.3172485641833, "episode_reward_min": 75.50835177305036, "episode_reward_mean": 322.02270896480803, "episode_len_mean": 48.53, "episodes_this_iter": 43, "episodes_timesteps_total": 4853, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [116.29429718943418, 313.54587104970983, 349.1442826696938, 337.9447471350333, 354.54978960475364, 349.81264037179716, 325.75089884565404, 342.0830195091604, 323.9455201885547, 312.24494723545797, 289.7805747454718, 300.8483068618918, 335.7900832056815, 358.4378746230966, 294.75368825073315, 323.426208894023, 336.38900873917447, 332.5899471129911, 349.0312643279951, 312.0886679037155, 273.24789609813905, 344.61456775656035, 360.3574036353339, 275.56481530987764, 353.85484644967136, 111.02822265625014, 323.269136543026, 350.1823973979984, 321.2474930106267, 340.74139694283616, 330.39987939405336, 351.0515710189658, 349.7091963932819, 308.00701591695224, 350.574266379641, 327.8320342778015, 129.4776339231534, 364.7791563529184, 334.1044576986181, 338.2744493269162, 348.27598378720444, 358.0971550013295, 321.71286904575317, 321.46777453045814, 304.5528570848205, 259.31252092929003, 334.694386754725, 306.61121874485053, 351.1658259490118, 344.9613095948605, 343.9268247981693, 333.5386628425899, 322.6658557431621, 339.2315542642556, 332.3044635946854, 325.80413170000605, 357.27455840962216, 359.78477853217953, 352.83720866538164, 357.6219398102832, 322.60723188209465, 348.4677833156169, 343.76935174705045, 361.3832129843625, 310.8422595854819, 286.8566607823262, 336.70716722778633, 357.9573852539065, 311.06415414207964, 367.860763619933, 322.05421993403934, 371.3172485641833, 354.94578744585914, 352.0847608391671, 351.6308227539066, 325.24928931956816, 349.72575484492035, 335.70189725148333, 340.87873941686354, 124.57148197665992, 75.50835177305036, 355.1970810507277, 313.7502056273355, 293.6520781823102, 328.8598069093514, 333.8986596772172, 331.2949029191419, 347.03748679190255, 341.70460271403533, 359.08959049680936, 332.20279242421344, 333.13957940014757, 309.81792533067716, 336.9449978750209, 349.32021597406134, 300.8930860995844, 336.9097086376892, 315.51792859227186, 303.98579565788975, 355.2587727307984], "episode_lengths": [21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.664935709580883, "mean_inference_ms": 1.2331902633891114, "mean_action_processing_ms": 0.20655532275173755, "mean_env_wait_ms": 496.0595852840161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009563684463500977, "StateBufferConnector_ms": 0.005992412567138672, "ViewRequirementAgentConnector_ms": 0.16745924949645996}, "num_episodes": 43, "episode_return_max": 371.3172485641833, "episode_return_min": 75.50835177305036, "episode_return_mean": 322.02270896480803, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75132, "num_agent_steps_trained": 75132, "num_env_steps_sampled": 75132, "num_env_steps_trained": 75132, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 10.546396873734983, "num_env_steps_trained_throughput_per_sec": 10.546396873734983, "timesteps_total": 75132, "num_env_steps_sampled_lifetime": 75132, "num_agent_steps_sampled_lifetime": 75132, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 75132, "timers": {"training_iteration_time_ms": 189699.041, "restore_workers_time_ms": 0.019, "training_step_time_ms": 189698.986, "sample_time_ms": 187188.193, "load_time_ms": 0.576, "load_throughput": 3563855.821, "learn_time_ms": 2497.241, "learn_throughput": 821.707, "synch_weights_time_ms": 12.592}, "counters": {"num_env_steps_sampled": 75132, "num_env_steps_trained": 75132, "num_agent_steps_sampled": 75132, "num_agent_steps_trained": 75132}, "done": false, "episodes_total": 1786, "training_iteration": 101, "trial_id": "fe178_00005", "date": "2024-08-15_19-17-16", "timestamp": 1723771036, "time_this_iter_s": 194.57284665107727, "time_total_s": 7585.192357540131, "pid": 78406, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.35639344959423686, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9599544327688427, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 948.5137417316437, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.098920863309353, "ram_util_percent": 11.248920863309351}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.846140787998834, "cur_kl_coeff": 0.27061008545570076, "cur_lr": 0.00010000000000000003, "total_loss": 6.739147531986236, "policy_loss": -0.009311087138485163, "vf_loss": 6.746509466071924, "vf_explained_var": 0.09147526348630587, "kl": 0.0072026347204295765, "entropy": -1.3755406152457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2640.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 77184, "num_env_steps_trained": 77184, "num_agent_steps_sampled": 77184, "num_agent_steps_trained": 77184}, "sampler_results": {"episode_reward_max": 371.3172485641833, "episode_reward_min": 75.50835177305036, "episode_reward_mean": 318.8638876940518, "episode_len_mean": 47.92, "episode_media": {}, "episodes_this_iter": 43, "episodes_timesteps_total": 4792, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [321.46777453045814, 304.5528570848205, 259.31252092929003, 334.694386754725, 306.61121874485053, 351.1658259490118, 344.9613095948605, 343.9268247981693, 333.5386628425899, 322.6658557431621, 339.2315542642556, 332.3044635946854, 325.80413170000605, 357.27455840962216, 359.78477853217953, 352.83720866538164, 357.6219398102832, 322.60723188209465, 348.4677833156169, 343.76935174705045, 361.3832129843625, 310.8422595854819, 286.8566607823262, 336.70716722778633, 357.9573852539065, 311.06415414207964, 367.860763619933, 322.05421993403934, 371.3172485641833, 354.94578744585914, 352.0847608391671, 351.6308227539066, 325.24928931956816, 349.72575484492035, 335.70189725148333, 340.87873941686354, 124.57148197665992, 75.50835177305036, 355.1970810507277, 313.7502056273355, 293.6520781823102, 328.8598069093514, 333.8986596772172, 331.2949029191419, 347.03748679190255, 341.70460271403533, 359.08959049680936, 332.20279242421344, 333.13957940014757, 309.81792533067716, 336.9449978750209, 349.32021597406134, 300.8930860995844, 336.9097086376892, 315.51792859227186, 303.98579565788975, 355.2587727307984, 143.72550048828134, 82.18214199064437, 350.1823831186636, 310.1900946056011, 361.35181190900505, 345.45434883780155, 315.19600829057254, 305.4779591914906, 358.41369605740414, 115.08154296875023, 107.9057440211954, 351.49809562711, 342.2335218476451, 349.8443239325523, 284.5821702630905, 307.5724533483837, 321.056961405843, 308.2375941577615, 315.9086093316586, 327.48443941703823, 345.94121561857145, 357.0493027364572, 351.94746093749995, 351.8994750976565, 342.19415861139913, 346.92232513043035, 290.158980794686, 353.0938200645864, 354.65259324929156, 345.94035154930503, 330.18148847404154, 357.34905674712405, 359.9254151299967, 355.94264654178096, 337.3486906803536, 350.600995297075, 292.96326010562706, 317.19314648671866, 349.10731536466125, 350.2916060942589, 85.77754474808978, 349.59131460059405, 329.3217908346093], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 16, 50, 50, 50, 50, 50, 50, 50, 22, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.680867751350863, "mean_inference_ms": 1.2324645897154485, "mean_action_processing_ms": 0.20641467023426557, "mean_env_wait_ms": 500.3776898575532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009693622589111328, "StateBufferConnector_ms": 0.006017923355102539, "ViewRequirementAgentConnector_ms": 0.16737675666809082}, "num_episodes": 43, "episode_return_max": 371.3172485641833, "episode_return_min": 75.50835177305036, "episode_return_mean": 318.8638876940518}, "env_runner_results": {"episode_reward_max": 371.3172485641833, "episode_reward_min": 75.50835177305036, "episode_reward_mean": 318.8638876940518, "episode_len_mean": 47.92, "episode_media": {}, "episodes_this_iter": 43, "episodes_timesteps_total": 4792, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [321.46777453045814, 304.5528570848205, 259.31252092929003, 334.694386754725, 306.61121874485053, 351.1658259490118, 344.9613095948605, 343.9268247981693, 333.5386628425899, 322.6658557431621, 339.2315542642556, 332.3044635946854, 325.80413170000605, 357.27455840962216, 359.78477853217953, 352.83720866538164, 357.6219398102832, 322.60723188209465, 348.4677833156169, 343.76935174705045, 361.3832129843625, 310.8422595854819, 286.8566607823262, 336.70716722778633, 357.9573852539065, 311.06415414207964, 367.860763619933, 322.05421993403934, 371.3172485641833, 354.94578744585914, 352.0847608391671, 351.6308227539066, 325.24928931956816, 349.72575484492035, 335.70189725148333, 340.87873941686354, 124.57148197665992, 75.50835177305036, 355.1970810507277, 313.7502056273355, 293.6520781823102, 328.8598069093514, 333.8986596772172, 331.2949029191419, 347.03748679190255, 341.70460271403533, 359.08959049680936, 332.20279242421344, 333.13957940014757, 309.81792533067716, 336.9449978750209, 349.32021597406134, 300.8930860995844, 336.9097086376892, 315.51792859227186, 303.98579565788975, 355.2587727307984, 143.72550048828134, 82.18214199064437, 350.1823831186636, 310.1900946056011, 361.35181190900505, 345.45434883780155, 315.19600829057254, 305.4779591914906, 358.41369605740414, 115.08154296875023, 107.9057440211954, 351.49809562711, 342.2335218476451, 349.8443239325523, 284.5821702630905, 307.5724533483837, 321.056961405843, 308.2375941577615, 315.9086093316586, 327.48443941703823, 345.94121561857145, 357.0493027364572, 351.94746093749995, 351.8994750976565, 342.19415861139913, 346.92232513043035, 290.158980794686, 353.0938200645864, 354.65259324929156, 345.94035154930503, 330.18148847404154, 357.34905674712405, 359.9254151299967, 355.94264654178096, 337.3486906803536, 350.600995297075, 292.96326010562706, 317.19314648671866, 349.10731536466125, 350.2916060942589, 85.77754474808978, 349.59131460059405, 329.3217908346093], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 16, 50, 50, 50, 50, 50, 50, 50, 22, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.680867751350863, "mean_inference_ms": 1.2324645897154485, "mean_action_processing_ms": 0.20641467023426557, "mean_env_wait_ms": 500.3776898575532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009693622589111328, "StateBufferConnector_ms": 0.006017923355102539, "ViewRequirementAgentConnector_ms": 0.16737675666809082}, "num_episodes": 43, "episode_return_max": 371.3172485641833, "episode_return_min": 75.50835177305036, "episode_return_mean": 318.8638876940518}, "episode_reward_max": 371.3172485641833, "episode_reward_min": 75.50835177305036, "episode_reward_mean": 318.8638876940518, "episode_len_mean": 47.92, "episodes_this_iter": 43, "episodes_timesteps_total": 4792, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [321.46777453045814, 304.5528570848205, 259.31252092929003, 334.694386754725, 306.61121874485053, 351.1658259490118, 344.9613095948605, 343.9268247981693, 333.5386628425899, 322.6658557431621, 339.2315542642556, 332.3044635946854, 325.80413170000605, 357.27455840962216, 359.78477853217953, 352.83720866538164, 357.6219398102832, 322.60723188209465, 348.4677833156169, 343.76935174705045, 361.3832129843625, 310.8422595854819, 286.8566607823262, 336.70716722778633, 357.9573852539065, 311.06415414207964, 367.860763619933, 322.05421993403934, 371.3172485641833, 354.94578744585914, 352.0847608391671, 351.6308227539066, 325.24928931956816, 349.72575484492035, 335.70189725148333, 340.87873941686354, 124.57148197665992, 75.50835177305036, 355.1970810507277, 313.7502056273355, 293.6520781823102, 328.8598069093514, 333.8986596772172, 331.2949029191419, 347.03748679190255, 341.70460271403533, 359.08959049680936, 332.20279242421344, 333.13957940014757, 309.81792533067716, 336.9449978750209, 349.32021597406134, 300.8930860995844, 336.9097086376892, 315.51792859227186, 303.98579565788975, 355.2587727307984, 143.72550048828134, 82.18214199064437, 350.1823831186636, 310.1900946056011, 361.35181190900505, 345.45434883780155, 315.19600829057254, 305.4779591914906, 358.41369605740414, 115.08154296875023, 107.9057440211954, 351.49809562711, 342.2335218476451, 349.8443239325523, 284.5821702630905, 307.5724533483837, 321.056961405843, 308.2375941577615, 315.9086093316586, 327.48443941703823, 345.94121561857145, 357.0493027364572, 351.94746093749995, 351.8994750976565, 342.19415861139913, 346.92232513043035, 290.158980794686, 353.0938200645864, 354.65259324929156, 345.94035154930503, 330.18148847404154, 357.34905674712405, 359.9254151299967, 355.94264654178096, 337.3486906803536, 350.600995297075, 292.96326010562706, 317.19314648671866, 349.10731536466125, 350.2916060942589, 85.77754474808978, 349.59131460059405, 329.3217908346093], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 16, 50, 50, 50, 50, 50, 50, 50, 22, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.680867751350863, "mean_inference_ms": 1.2324645897154485, "mean_action_processing_ms": 0.20641467023426557, "mean_env_wait_ms": 500.3776898575532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009693622589111328, "StateBufferConnector_ms": 0.006017923355102539, "ViewRequirementAgentConnector_ms": 0.16737675666809082}, "num_episodes": 43, "episode_return_max": 371.3172485641833, "episode_return_min": 75.50835177305036, "episode_return_mean": 318.8638876940518, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77184, "num_agent_steps_trained": 77184, "num_env_steps_sampled": 77184, "num_env_steps_trained": 77184, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 10.195647351238849, "num_env_steps_trained_throughput_per_sec": 10.195647351238849, "timesteps_total": 77184, "num_env_steps_sampled_lifetime": 77184, "num_agent_steps_sampled_lifetime": 77184, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 77184, "timers": {"training_iteration_time_ms": 191626.262, "restore_workers_time_ms": 0.019, "training_step_time_ms": 191626.207, "sample_time_ms": 189085.603, "load_time_ms": 0.59, "load_throughput": 3478161.975, "learn_time_ms": 2526.908, "learn_throughput": 812.06, "synch_weights_time_ms": 12.719}, "counters": {"num_env_steps_sampled": 77184, "num_env_steps_trained": 77184, "num_agent_steps_sampled": 77184, "num_agent_steps_trained": 77184}, "done": false, "episodes_total": 1829, "training_iteration": 102, "trial_id": "fe178_00005", "date": "2024-08-15_19-20-37", "timestamp": 1723771237, "time_this_iter_s": 201.26626920700073, "time_total_s": 7786.458626747131, "pid": 78406, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.35639344959423686, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9599544327688427, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1149.7800109386444, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.578745644599305, "ram_util_percent": 11.296864111498259}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.55487678050995, "cur_kl_coeff": 0.27061008545570076, "cur_lr": 0.00010000000000000003, "total_loss": 6.304780175412694, "policy_loss": -0.005461114856492107, "vf_loss": 6.303363974640766, "vf_explained_var": 0.17889408891399702, "kl": 0.025414050589461903, "entropy": -1.1929450355470181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3120.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 79236, "num_env_steps_trained": 79236, "num_agent_steps_sampled": 79236, "num_agent_steps_trained": 79236}, "sampler_results": {"episode_reward_max": 364.5912822280599, "episode_reward_min": 82.18214199064437, "episode_reward_mean": 314.4447203780124, "episode_len_mean": 47.81, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 4781, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.8986596772172, 331.2949029191419, 347.03748679190255, 341.70460271403533, 359.08959049680936, 332.20279242421344, 333.13957940014757, 309.81792533067716, 336.9449978750209, 349.32021597406134, 300.8930860995844, 336.9097086376892, 315.51792859227186, 303.98579565788975, 355.2587727307984, 143.72550048828134, 82.18214199064437, 350.1823831186636, 310.1900946056011, 361.35181190900505, 345.45434883780155, 315.19600829057254, 305.4779591914906, 358.41369605740414, 115.08154296875023, 107.9057440211954, 351.49809562711, 342.2335218476451, 349.8443239325523, 284.5821702630905, 307.5724533483837, 321.056961405843, 308.2375941577615, 315.9086093316586, 327.48443941703823, 345.94121561857145, 357.0493027364572, 351.94746093749995, 351.8994750976565, 342.19415861139913, 346.92232513043035, 290.158980794686, 353.0938200645864, 354.65259324929156, 345.94035154930503, 330.18148847404154, 357.34905674712405, 359.9254151299967, 355.94264654178096, 337.3486906803536, 350.600995297075, 292.96326010562706, 317.19314648671866, 349.10731536466125, 350.2916060942589, 85.77754474808978, 349.59131460059405, 329.3217908346093, 352.42826768526237, 311.67985108721695, 108.53170025179429, 318.5552862253791, 333.0024275360371, 317.55574024963204, 311.1203636623651, 358.52952105211915, 344.04188141564555, 364.5912822280599, 353.26613771932193, 326.80361841715404, 227.91243564330307, 309.56809861825457, 293.5801544838052, 291.10017060767166, 359.84989586380306, 339.34271621649475, 335.7233400464247, 323.1361596331622, 122.15396233192808, 345.2725754115805, 342.92291106797825, 269.16295364790875, 343.84314709954896, 328.6120322322144, 346.9909219012774, 361.8973845413976, 350.8097436991686, 327.32739530328695, 318.6122692089357, 293.0652886556555, 343.5706493532232, 352.7144052706375, 337.5526939492139, 324.6782321373293, 303.7840676742741, 352.9829672617652, 308.39728370408307, 318.76569760423826, 337.55149204833555, 137.495514027586], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 16, 50, 50, 50, 50, 50, 50, 50, 22, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.678970122005431, "mean_inference_ms": 1.2318428040535425, "mean_action_processing_ms": 0.20637236892753144, "mean_env_wait_ms": 501.7514761789065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010210275650024414, "StateBufferConnector_ms": 0.006056785583496094, "ViewRequirementAgentConnector_ms": 0.16709280014038086}, "num_episodes": 42, "episode_return_max": 364.5912822280599, "episode_return_min": 82.18214199064437, "episode_return_mean": 314.4447203780124}, "env_runner_results": {"episode_reward_max": 364.5912822280599, "episode_reward_min": 82.18214199064437, "episode_reward_mean": 314.4447203780124, "episode_len_mean": 47.81, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 4781, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.8986596772172, 331.2949029191419, 347.03748679190255, 341.70460271403533, 359.08959049680936, 332.20279242421344, 333.13957940014757, 309.81792533067716, 336.9449978750209, 349.32021597406134, 300.8930860995844, 336.9097086376892, 315.51792859227186, 303.98579565788975, 355.2587727307984, 143.72550048828134, 82.18214199064437, 350.1823831186636, 310.1900946056011, 361.35181190900505, 345.45434883780155, 315.19600829057254, 305.4779591914906, 358.41369605740414, 115.08154296875023, 107.9057440211954, 351.49809562711, 342.2335218476451, 349.8443239325523, 284.5821702630905, 307.5724533483837, 321.056961405843, 308.2375941577615, 315.9086093316586, 327.48443941703823, 345.94121561857145, 357.0493027364572, 351.94746093749995, 351.8994750976565, 342.19415861139913, 346.92232513043035, 290.158980794686, 353.0938200645864, 354.65259324929156, 345.94035154930503, 330.18148847404154, 357.34905674712405, 359.9254151299967, 355.94264654178096, 337.3486906803536, 350.600995297075, 292.96326010562706, 317.19314648671866, 349.10731536466125, 350.2916060942589, 85.77754474808978, 349.59131460059405, 329.3217908346093, 352.42826768526237, 311.67985108721695, 108.53170025179429, 318.5552862253791, 333.0024275360371, 317.55574024963204, 311.1203636623651, 358.52952105211915, 344.04188141564555, 364.5912822280599, 353.26613771932193, 326.80361841715404, 227.91243564330307, 309.56809861825457, 293.5801544838052, 291.10017060767166, 359.84989586380306, 339.34271621649475, 335.7233400464247, 323.1361596331622, 122.15396233192808, 345.2725754115805, 342.92291106797825, 269.16295364790875, 343.84314709954896, 328.6120322322144, 346.9909219012774, 361.8973845413976, 350.8097436991686, 327.32739530328695, 318.6122692089357, 293.0652886556555, 343.5706493532232, 352.7144052706375, 337.5526939492139, 324.6782321373293, 303.7840676742741, 352.9829672617652, 308.39728370408307, 318.76569760423826, 337.55149204833555, 137.495514027586], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 16, 50, 50, 50, 50, 50, 50, 50, 22, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.678970122005431, "mean_inference_ms": 1.2318428040535425, "mean_action_processing_ms": 0.20637236892753144, "mean_env_wait_ms": 501.7514761789065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010210275650024414, "StateBufferConnector_ms": 0.006056785583496094, "ViewRequirementAgentConnector_ms": 0.16709280014038086}, "num_episodes": 42, "episode_return_max": 364.5912822280599, "episode_return_min": 82.18214199064437, "episode_return_mean": 314.4447203780124}, "episode_reward_max": 364.5912822280599, "episode_reward_min": 82.18214199064437, "episode_reward_mean": 314.4447203780124, "episode_len_mean": 47.81, "episodes_this_iter": 42, "episodes_timesteps_total": 4781, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [333.8986596772172, 331.2949029191419, 347.03748679190255, 341.70460271403533, 359.08959049680936, 332.20279242421344, 333.13957940014757, 309.81792533067716, 336.9449978750209, 349.32021597406134, 300.8930860995844, 336.9097086376892, 315.51792859227186, 303.98579565788975, 355.2587727307984, 143.72550048828134, 82.18214199064437, 350.1823831186636, 310.1900946056011, 361.35181190900505, 345.45434883780155, 315.19600829057254, 305.4779591914906, 358.41369605740414, 115.08154296875023, 107.9057440211954, 351.49809562711, 342.2335218476451, 349.8443239325523, 284.5821702630905, 307.5724533483837, 321.056961405843, 308.2375941577615, 315.9086093316586, 327.48443941703823, 345.94121561857145, 357.0493027364572, 351.94746093749995, 351.8994750976565, 342.19415861139913, 346.92232513043035, 290.158980794686, 353.0938200645864, 354.65259324929156, 345.94035154930503, 330.18148847404154, 357.34905674712405, 359.9254151299967, 355.94264654178096, 337.3486906803536, 350.600995297075, 292.96326010562706, 317.19314648671866, 349.10731536466125, 350.2916060942589, 85.77754474808978, 349.59131460059405, 329.3217908346093, 352.42826768526237, 311.67985108721695, 108.53170025179429, 318.5552862253791, 333.0024275360371, 317.55574024963204, 311.1203636623651, 358.52952105211915, 344.04188141564555, 364.5912822280599, 353.26613771932193, 326.80361841715404, 227.91243564330307, 309.56809861825457, 293.5801544838052, 291.10017060767166, 359.84989586380306, 339.34271621649475, 335.7233400464247, 323.1361596331622, 122.15396233192808, 345.2725754115805, 342.92291106797825, 269.16295364790875, 343.84314709954896, 328.6120322322144, 346.9909219012774, 361.8973845413976, 350.8097436991686, 327.32739530328695, 318.6122692089357, 293.0652886556555, 343.5706493532232, 352.7144052706375, 337.5526939492139, 324.6782321373293, 303.7840676742741, 352.9829672617652, 308.39728370408307, 318.76569760423826, 337.55149204833555, 137.495514027586], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 16, 50, 50, 50, 50, 50, 50, 50, 22, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.678970122005431, "mean_inference_ms": 1.2318428040535425, "mean_action_processing_ms": 0.20637236892753144, "mean_env_wait_ms": 501.7514761789065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010210275650024414, "StateBufferConnector_ms": 0.006056785583496094, "ViewRequirementAgentConnector_ms": 0.16709280014038086}, "num_episodes": 42, "episode_return_max": 364.5912822280599, "episode_return_min": 82.18214199064437, "episode_return_mean": 314.4447203780124, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79236, "num_agent_steps_trained": 79236, "num_env_steps_sampled": 79236, "num_env_steps_trained": 79236, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 11.143227342553358, "num_env_steps_trained_throughput_per_sec": 11.143227342553358, "timesteps_total": 79236, "num_env_steps_sampled_lifetime": 79236, "num_agent_steps_sampled_lifetime": 79236, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 79236, "timers": {"training_iteration_time_ms": 190557.902, "restore_workers_time_ms": 0.019, "training_step_time_ms": 190557.847, "sample_time_ms": 187995.816, "load_time_ms": 0.593, "load_throughput": 3459686.612, "learn_time_ms": 2548.295, "learn_throughput": 805.244, "synch_weights_time_ms": 12.756}, "counters": {"num_env_steps_sampled": 79236, "num_env_steps_trained": 79236, "num_agent_steps_sampled": 79236, "num_agent_steps_trained": 79236}, "done": false, "episodes_total": 1871, "training_iteration": 103, "trial_id": "fe178_00005", "date": "2024-08-15_19-23-41", "timestamp": 1723771421, "time_this_iter_s": 184.15181756019592, "time_total_s": 7970.610444307327, "pid": 78406, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.35639344959423686, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9599544327688427, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1333.9318284988403, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 22.712167300380234, "ram_util_percent": 11.266920152091254}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.424770122766496, "cur_kl_coeff": 0.6088726922753267, "cur_lr": 0.0005000000000000002, "total_loss": 9.201813761393229, "policy_loss": 0.0003965897049056366, "vf_loss": 9.155745379130046, "vf_explained_var": 0.14476570213834444, "kl": 0.0750103137203662, "entropy": -1.1053237086782852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 80262, "num_env_steps_trained": 80262, "num_agent_steps_sampled": 80262, "num_agent_steps_trained": 80262}, "sampler_results": {"episode_reward_max": 353.4306119845548, "episode_reward_min": 116.47036879113995, "episode_reward_mean": 295.9534648326209, "episode_len_mean": 46.421052631578945, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 882, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.4065718043916, 350.85612635172, 347.6646458107893, 311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.410933946891982, "mean_inference_ms": 1.255350714068372, "mean_action_processing_ms": 0.2042453467043406, "mean_env_wait_ms": 510.6184042652789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010868122703150698, "StateBufferConnector_ms": 0.005872626053659539, "ViewRequirementAgentConnector_ms": 0.16387136358963816}, "num_episodes": 19, "episode_return_max": 353.4306119845548, "episode_return_min": 116.47036879113995, "episode_return_mean": 295.9534648326209}, "env_runner_results": {"episode_reward_max": 353.4306119845548, "episode_reward_min": 116.47036879113995, "episode_reward_mean": 295.9534648326209, "episode_len_mean": 46.421052631578945, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 882, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.4065718043916, 350.85612635172, 347.6646458107893, 311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.410933946891982, "mean_inference_ms": 1.255350714068372, "mean_action_processing_ms": 0.2042453467043406, "mean_env_wait_ms": 510.6184042652789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010868122703150698, "StateBufferConnector_ms": 0.005872626053659539, "ViewRequirementAgentConnector_ms": 0.16387136358963816}, "num_episodes": 19, "episode_return_max": 353.4306119845548, "episode_return_min": 116.47036879113995, "episode_return_mean": 295.9534648326209}, "episode_reward_max": 353.4306119845548, "episode_reward_min": 116.47036879113995, "episode_reward_mean": 295.9534648326209, "episode_len_mean": 46.421052631578945, "episodes_this_iter": 19, "episodes_timesteps_total": 882, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [347.4065718043916, 350.85612635172, 347.6646458107893, 311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.410933946891982, "mean_inference_ms": 1.255350714068372, "mean_action_processing_ms": 0.2042453467043406, "mean_env_wait_ms": 510.6184042652789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010868122703150698, "StateBufferConnector_ms": 0.005872626053659539, "ViewRequirementAgentConnector_ms": 0.16387136358963816}, "num_episodes": 19, "episode_return_max": 353.4306119845548, "episode_return_min": 116.47036879113995, "episode_return_mean": 295.9534648326209, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80262, "num_agent_steps_trained": 80262, "num_env_steps_sampled": 80262, "num_env_steps_trained": 80262, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.257904472282174, "num_env_steps_trained_throughput_per_sec": 10.257904472282174, "timesteps_total": 80262, "num_env_steps_sampled_lifetime": 80262, "num_agent_steps_sampled_lifetime": 80262, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 80262, "timers": {"training_iteration_time_ms": 100020.439, "restore_workers_time_ms": 0.014, "training_step_time_ms": 100020.389, "sample_time_ms": 95825.032, "load_time_ms": 0.883, "load_throughput": 1161499.569, "learn_time_ms": 4180.603, "learn_throughput": 245.419, "synch_weights_time_ms": 13.346}, "counters": {"num_env_steps_sampled": 80262, "num_env_steps_trained": 80262, "num_agent_steps_sampled": 80262, "num_agent_steps_trained": 80262}, "done": false, "episodes_total": 1885, "training_iteration": 104, "trial_id": "fe178_00005", "date": "2024-08-15_19-25-39", "timestamp": 1723771539, "time_this_iter_s": 100.0239200592041, "time_total_s": 8064.895773887634, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 100.0239200592041, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 20.962237762237766, "ram_util_percent": 11.075524475524475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67.52332866986593, "cur_kl_coeff": 0.91330903841299, "cur_lr": 0.0005000000000000002, "total_loss": 8.45865826010704, "policy_loss": 0.00426019742541636, "vf_loss": 8.394338621695836, "vf_explained_var": 0.11939402148127556, "kl": 0.06576022439112669, "entropy": -1.1928273173669974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 81288, "num_env_steps_trained": 81288, "num_agent_steps_sampled": 81288, "num_agent_steps_trained": 81288}, "sampler_results": {"episode_reward_max": 362.69525186085474, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 304.6020804073487, "episode_len_mean": 47.35897435897436, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 1847, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.4065718043916, 350.85612635172, 347.6646458107893, 311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235, 305.2920643430028, 324.4783293440853, 346.47059661175695, 318.03789700004177, 350.4547134730892, 330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.665018463932408, "mean_inference_ms": 1.2494069409064401, "mean_action_processing_ms": 0.20385473497552498, "mean_env_wait_ms": 505.38910987667896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011763205895057091, "StateBufferConnector_ms": 0.0057428311078976365, "ViewRequirementAgentConnector_ms": 0.16320668734036958}, "num_episodes": 20, "episode_return_max": 362.69525186085474, "episode_return_min": 75.51355590043192, "episode_return_mean": 304.6020804073487}, "env_runner_results": {"episode_reward_max": 362.69525186085474, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 304.6020804073487, "episode_len_mean": 47.35897435897436, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 1847, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.4065718043916, 350.85612635172, 347.6646458107893, 311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235, 305.2920643430028, 324.4783293440853, 346.47059661175695, 318.03789700004177, 350.4547134730892, 330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.665018463932408, "mean_inference_ms": 1.2494069409064401, "mean_action_processing_ms": 0.20385473497552498, "mean_env_wait_ms": 505.38910987667896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011763205895057091, "StateBufferConnector_ms": 0.0057428311078976365, "ViewRequirementAgentConnector_ms": 0.16320668734036958}, "num_episodes": 20, "episode_return_max": 362.69525186085474, "episode_return_min": 75.51355590043192, "episode_return_mean": 304.6020804073487}, "episode_reward_max": 362.69525186085474, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 304.6020804073487, "episode_len_mean": 47.35897435897436, "episodes_this_iter": 20, "episodes_timesteps_total": 1847, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [347.4065718043916, 350.85612635172, 347.6646458107893, 311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235, 305.2920643430028, 324.4783293440853, 346.47059661175695, 318.03789700004177, 350.4547134730892, 330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.665018463932408, "mean_inference_ms": 1.2494069409064401, "mean_action_processing_ms": 0.20385473497552498, "mean_env_wait_ms": 505.38910987667896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011763205895057091, "StateBufferConnector_ms": 0.0057428311078976365, "ViewRequirementAgentConnector_ms": 0.16320668734036958}, "num_episodes": 20, "episode_return_max": 362.69525186085474, "episode_return_min": 75.51355590043192, "episode_return_mean": 304.6020804073487, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81288, "num_agent_steps_trained": 81288, "num_env_steps_sampled": 81288, "num_env_steps_trained": 81288, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.982747406895985, "num_env_steps_trained_throughput_per_sec": 9.982747406895985, "timesteps_total": 81288, "num_env_steps_sampled_lifetime": 81288, "num_agent_steps_sampled_lifetime": 81288, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 81288, "timers": {"training_iteration_time_ms": 101398.884, "restore_workers_time_ms": 0.016, "training_step_time_ms": 101398.831, "sample_time_ms": 98694.275, "load_time_ms": 0.641, "load_throughput": 1600950.857, "learn_time_ms": 2690.385, "learn_throughput": 381.358, "synch_weights_time_ms": 13.134}, "counters": {"num_env_steps_sampled": 81288, "num_env_steps_trained": 81288, "num_agent_steps_sampled": 81288, "num_agent_steps_trained": 81288}, "done": false, "episodes_total": 1905, "training_iteration": 105, "trial_id": "fe178_00005", "date": "2024-08-15_19-27-22", "timestamp": 1723771642, "time_this_iter_s": 102.78075289726257, "time_total_s": 8167.676526784897, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 202.80467295646667, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.259863945578232, "ram_util_percent": 11.1843537414966}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.073838631312054, "cur_kl_coeff": 1.369963557619485, "cur_lr": 0.0005000000000000002, "total_loss": 8.681799187262852, "policy_loss": -0.0024728217783073583, "vf_loss": 8.682711986700694, "vf_explained_var": 0.1647576240201791, "kl": 0.0011387580546118254, "entropy": -1.2738041569789251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 82314, "num_env_steps_trained": 82314, "num_agent_steps_sampled": 82314, "num_agent_steps_trained": 82314}, "sampler_results": {"episode_reward_max": 363.69414774705126, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 310.66713757270765, "episode_len_mean": 47.88709677419355, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 2969, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.4065718043916, 350.85612635172, 347.6646458107893, 311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235, 305.2920643430028, 324.4783293440853, 346.47059661175695, 318.03789700004177, 350.4547134730892, 330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955, 355.7682431113159, 306.8894865066745, 316.8527786800158, 347.39898527988805, 341.3149414062502, 333.8255461756539, 335.7186350296796, 339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.100745301875868, "mean_inference_ms": 1.2488134719040085, "mean_action_processing_ms": 0.20389596033750726, "mean_env_wait_ms": 496.3800664829001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011939002621558404, "StateBufferConnector_ms": 0.005900475286668347, "ViewRequirementAgentConnector_ms": 0.16553901856945408}, "num_episodes": 23, "episode_return_max": 363.69414774705126, "episode_return_min": 75.51355590043192, "episode_return_mean": 310.66713757270765}, "env_runner_results": {"episode_reward_max": 363.69414774705126, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 310.66713757270765, "episode_len_mean": 47.88709677419355, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 2969, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.4065718043916, 350.85612635172, 347.6646458107893, 311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235, 305.2920643430028, 324.4783293440853, 346.47059661175695, 318.03789700004177, 350.4547134730892, 330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955, 355.7682431113159, 306.8894865066745, 316.8527786800158, 347.39898527988805, 341.3149414062502, 333.8255461756539, 335.7186350296796, 339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.100745301875868, "mean_inference_ms": 1.2488134719040085, "mean_action_processing_ms": 0.20389596033750726, "mean_env_wait_ms": 496.3800664829001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011939002621558404, "StateBufferConnector_ms": 0.005900475286668347, "ViewRequirementAgentConnector_ms": 0.16553901856945408}, "num_episodes": 23, "episode_return_max": 363.69414774705126, "episode_return_min": 75.51355590043192, "episode_return_mean": 310.66713757270765}, "episode_reward_max": 363.69414774705126, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 310.66713757270765, "episode_len_mean": 47.88709677419355, "episodes_this_iter": 23, "episodes_timesteps_total": 2969, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [347.4065718043916, 350.85612635172, 347.6646458107893, 311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235, 305.2920643430028, 324.4783293440853, 346.47059661175695, 318.03789700004177, 350.4547134730892, 330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955, 355.7682431113159, 306.8894865066745, 316.8527786800158, 347.39898527988805, 341.3149414062502, 333.8255461756539, 335.7186350296796, 339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.100745301875868, "mean_inference_ms": 1.2488134719040085, "mean_action_processing_ms": 0.20389596033750726, "mean_env_wait_ms": 496.3800664829001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011939002621558404, "StateBufferConnector_ms": 0.005900475286668347, "ViewRequirementAgentConnector_ms": 0.16553901856945408}, "num_episodes": 23, "episode_return_max": 363.69414774705126, "episode_return_min": 75.51355590043192, "episode_return_mean": 310.66713757270765, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82314, "num_agent_steps_trained": 82314, "num_env_steps_sampled": 82314, "num_env_steps_trained": 82314, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.936672113543064, "num_env_steps_trained_throughput_per_sec": 9.936672113543064, "timesteps_total": 82314, "num_env_steps_sampled_lifetime": 82314, "num_agent_steps_sampled_lifetime": 82314, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 82314, "timers": {"training_iteration_time_ms": 102017.221, "restore_workers_time_ms": 0.016, "training_step_time_ms": 102017.169, "sample_time_ms": 99783.198, "load_time_ms": 0.589, "load_throughput": 1742014.264, "learn_time_ms": 2219.847, "learn_throughput": 462.194, "synch_weights_time_ms": 13.171}, "counters": {"num_env_steps_sampled": 82314, "num_env_steps_trained": 82314, "num_agent_steps_sampled": 82314, "num_agent_steps_trained": 82314}, "done": false, "episodes_total": 1928, "training_iteration": 106, "trial_id": "fe178_00005", "date": "2024-08-15_19-29-05", "timestamp": 1723771745, "time_this_iter_s": 103.25687408447266, "time_total_s": 8270.93340086937, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 306.06154704093933, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 20.110135135135135, "ram_util_percent": 11.245270270270268}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.85558876991272, "cur_kl_coeff": 0.6849817788097425, "cur_lr": 0.0005000000000000002, "total_loss": 7.58521676659584, "policy_loss": -0.004817576768497626, "vf_loss": 7.585447579622269, "vf_explained_var": 0.05758704170584679, "kl": 0.006696270742396328, "entropy": -1.2386608986804883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 83340, "num_env_steps_trained": 83340, "num_agent_steps_sampled": 83340, "num_agent_steps_trained": 83340}, "sampler_results": {"episode_reward_max": 363.69414774705126, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 316.2746562681865, "episode_len_mean": 48.382716049382715, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 3919, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.4065718043916, 350.85612635172, 347.6646458107893, 311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235, 305.2920643430028, 324.4783293440853, 346.47059661175695, 318.03789700004177, 350.4547134730892, 330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955, 355.7682431113159, 306.8894865066745, 316.8527786800158, 347.39898527988805, 341.3149414062502, 333.8255461756539, 335.7186350296796, 339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198, 348.9636037436146, 311.1568464345147, 324.93575116760394, 347.53648340566355, 324.9874026931466, 350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.168181569636144, "mean_inference_ms": 1.2479877277243172, "mean_action_processing_ms": 0.20389770761896076, "mean_env_wait_ms": 487.640225874418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0115038436136128, "StateBufferConnector_ms": 0.005896591845853829, "ViewRequirementAgentConnector_ms": 0.16548780747401862}, "num_episodes": 19, "episode_return_max": 363.69414774705126, "episode_return_min": 75.51355590043192, "episode_return_mean": 316.2746562681865}, "env_runner_results": {"episode_reward_max": 363.69414774705126, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 316.2746562681865, "episode_len_mean": 48.382716049382715, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 3919, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.4065718043916, 350.85612635172, 347.6646458107893, 311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235, 305.2920643430028, 324.4783293440853, 346.47059661175695, 318.03789700004177, 350.4547134730892, 330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955, 355.7682431113159, 306.8894865066745, 316.8527786800158, 347.39898527988805, 341.3149414062502, 333.8255461756539, 335.7186350296796, 339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198, 348.9636037436146, 311.1568464345147, 324.93575116760394, 347.53648340566355, 324.9874026931466, 350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.168181569636144, "mean_inference_ms": 1.2479877277243172, "mean_action_processing_ms": 0.20389770761896076, "mean_env_wait_ms": 487.640225874418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0115038436136128, "StateBufferConnector_ms": 0.005896591845853829, "ViewRequirementAgentConnector_ms": 0.16548780747401862}, "num_episodes": 19, "episode_return_max": 363.69414774705126, "episode_return_min": 75.51355590043192, "episode_return_mean": 316.2746562681865}, "episode_reward_max": 363.69414774705126, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 316.2746562681865, "episode_len_mean": 48.382716049382715, "episodes_this_iter": 19, "episodes_timesteps_total": 3919, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [347.4065718043916, 350.85612635172, 347.6646458107893, 311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235, 305.2920643430028, 324.4783293440853, 346.47059661175695, 318.03789700004177, 350.4547134730892, 330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955, 355.7682431113159, 306.8894865066745, 316.8527786800158, 347.39898527988805, 341.3149414062502, 333.8255461756539, 335.7186350296796, 339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198, 348.9636037436146, 311.1568464345147, 324.93575116760394, 347.53648340566355, 324.9874026931466, 350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.168181569636144, "mean_inference_ms": 1.2479877277243172, "mean_action_processing_ms": 0.20389770761896076, "mean_env_wait_ms": 487.640225874418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0115038436136128, "StateBufferConnector_ms": 0.005896591845853829, "ViewRequirementAgentConnector_ms": 0.16548780747401862}, "num_episodes": 19, "episode_return_max": 363.69414774705126, "episode_return_min": 75.51355590043192, "episode_return_mean": 316.2746562681865, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83340, "num_agent_steps_trained": 83340, "num_env_steps_sampled": 83340, "num_env_steps_trained": 83340, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 13.511005654794017, "num_env_steps_trained_throughput_per_sec": 13.511005654794017, "timesteps_total": 83340, "num_env_steps_sampled_lifetime": 83340, "num_agent_steps_sampled_lifetime": 83340, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 83340, "timers": {"training_iteration_time_ms": 95497.444, "restore_workers_time_ms": 0.016, "training_step_time_ms": 95497.389, "sample_time_ms": 93479.094, "load_time_ms": 0.551, "load_throughput": 1862118.522, "learn_time_ms": 2004.104, "learn_throughput": 511.95, "synch_weights_time_ms": 13.277}, "counters": {"num_env_steps_sampled": 83340, "num_env_steps_trained": 83340, "num_agent_steps_sampled": 83340, "num_agent_steps_trained": 83340}, "done": false, "episodes_total": 1947, "training_iteration": 107, "trial_id": "fe178_00005", "date": "2024-08-15_19-30-21", "timestamp": 1723771821, "time_this_iter_s": 75.94164371490479, "time_total_s": 8346.875044584274, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 382.0031907558441, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.435185185185187, "ram_util_percent": 11.369444444444449}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.25466183026632, "cur_kl_coeff": 0.6849817788097425, "cur_lr": 0.0005000000000000002, "total_loss": 7.638575770457586, "policy_loss": -0.005637192504946142, "vf_loss": 7.643198361992836, "vf_explained_var": 0.14416018923123677, "kl": 0.0014812670654180437, "entropy": -1.0010740394393602, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 84366, "num_env_steps_trained": 84366, "num_agent_steps_sampled": 84366, "num_agent_steps_trained": 84366}, "sampler_results": {"episode_reward_max": 363.69414774705126, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 314.52242527465097, "episode_len_mean": 48.4, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4840, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235, 305.2920643430028, 324.4783293440853, 346.47059661175695, 318.03789700004177, 350.4547134730892, 330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955, 355.7682431113159, 306.8894865066745, 316.8527786800158, 347.39898527988805, 341.3149414062502, 333.8255461756539, 335.7186350296796, 339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198, 348.9636037436146, 311.1568464345147, 324.93575116760394, 347.53648340566355, 324.9874026931466, 350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923, 332.84609997062154, 306.14116472596726, 100.34346799264182, 345.8511851474534, 286.25734464057126, 280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126], "episode_lengths": [50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.229740803966484, "mean_inference_ms": 1.247122623061667, "mean_action_processing_ms": 0.2038383145864181, "mean_env_wait_ms": 486.02299133794446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011120080947875977, "StateBufferConnector_ms": 0.005850553512573242, "ViewRequirementAgentConnector_ms": 0.16490983963012695}, "num_episodes": 22, "episode_return_max": 363.69414774705126, "episode_return_min": 75.51355590043192, "episode_return_mean": 314.52242527465097}, "env_runner_results": {"episode_reward_max": 363.69414774705126, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 314.52242527465097, "episode_len_mean": 48.4, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4840, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235, 305.2920643430028, 324.4783293440853, 346.47059661175695, 318.03789700004177, 350.4547134730892, 330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955, 355.7682431113159, 306.8894865066745, 316.8527786800158, 347.39898527988805, 341.3149414062502, 333.8255461756539, 335.7186350296796, 339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198, 348.9636037436146, 311.1568464345147, 324.93575116760394, 347.53648340566355, 324.9874026931466, 350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923, 332.84609997062154, 306.14116472596726, 100.34346799264182, 345.8511851474534, 286.25734464057126, 280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126], "episode_lengths": [50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.229740803966484, "mean_inference_ms": 1.247122623061667, "mean_action_processing_ms": 0.2038383145864181, "mean_env_wait_ms": 486.02299133794446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011120080947875977, "StateBufferConnector_ms": 0.005850553512573242, "ViewRequirementAgentConnector_ms": 0.16490983963012695}, "num_episodes": 22, "episode_return_max": 363.69414774705126, "episode_return_min": 75.51355590043192, "episode_return_mean": 314.52242527465097}, "episode_reward_max": 363.69414774705126, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 314.52242527465097, "episode_len_mean": 48.4, "episodes_this_iter": 22, "episodes_timesteps_total": 4840, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [311.60931273138954, 292.54465135479956, 315.4979652531882, 211.04269079088698, 199.48740092089906, 328.5007586625708, 116.47036879113995, 323.3611172463991, 332.4173594023697, 117.99940185546882, 327.6158834285858, 353.4306119845548, 332.8817871093754, 326.9635809990519, 348.00803234799235, 339.3575649742235, 305.2920643430028, 324.4783293440853, 346.47059661175695, 318.03789700004177, 350.4547134730892, 330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955, 355.7682431113159, 306.8894865066745, 316.8527786800158, 347.39898527988805, 341.3149414062502, 333.8255461756539, 335.7186350296796, 339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198, 348.9636037436146, 311.1568464345147, 324.93575116760394, 347.53648340566355, 324.9874026931466, 350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923, 332.84609997062154, 306.14116472596726, 100.34346799264182, 345.8511851474534, 286.25734464057126, 280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126], "episode_lengths": [50, 50, 50, 44, 44, 50, 23, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.229740803966484, "mean_inference_ms": 1.247122623061667, "mean_action_processing_ms": 0.2038383145864181, "mean_env_wait_ms": 486.02299133794446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011120080947875977, "StateBufferConnector_ms": 0.005850553512573242, "ViewRequirementAgentConnector_ms": 0.16490983963012695}, "num_episodes": 22, "episode_return_max": 363.69414774705126, "episode_return_min": 75.51355590043192, "episode_return_mean": 314.52242527465097, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84366, "num_agent_steps_trained": 84366, "num_env_steps_sampled": 84366, "num_env_steps_trained": 84366, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.378230489345952, "num_env_steps_trained_throughput_per_sec": 9.378230489345952, "timesteps_total": 84366, "num_env_steps_sampled_lifetime": 84366, "num_agent_steps_sampled_lifetime": 84366, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 84366, "timers": {"training_iteration_time_ms": 98278.418, "restore_workers_time_ms": 0.017, "training_step_time_ms": 98278.363, "sample_time_ms": 96418.619, "load_time_ms": 0.523, "load_throughput": 1961062.661, "learn_time_ms": 1845.561, "learn_throughput": 555.928, "synch_weights_time_ms": 13.305}, "counters": {"num_env_steps_sampled": 84366, "num_env_steps_trained": 84366, "num_agent_steps_sampled": 84366, "num_agent_steps_trained": 84366}, "done": false, "episodes_total": 1969, "training_iteration": 108, "trial_id": "fe178_00005", "date": "2024-08-15_19-32-10", "timestamp": 1723771930, "time_this_iter_s": 109.40632176399231, "time_total_s": 8456.281366348267, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 491.4095125198364, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.755769230769236, "ram_util_percent": 11.471153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.426080681880315, "cur_kl_coeff": 0.34249088940487127, "cur_lr": 0.0005000000000000002, "total_loss": 7.528365576267243, "policy_loss": -0.009762426624850681, "vf_loss": 7.536933485666911, "vf_explained_var": 0.14236177826921145, "kl": 0.0034876479873079194, "entropy": -0.9576815278579791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 85392, "num_env_steps_trained": 85392, "num_agent_steps_sampled": 85392, "num_agent_steps_trained": 85392}, "sampler_results": {"episode_reward_max": 363.69414774705126, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 314.9165027136403, "episode_len_mean": 48.77, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4877, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955, 355.7682431113159, 306.8894865066745, 316.8527786800158, 347.39898527988805, 341.3149414062502, 333.8255461756539, 335.7186350296796, 339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198, 348.9636037436146, 311.1568464345147, 324.93575116760394, 347.53648340566355, 324.9874026931466, 350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923, 332.84609997062154, 306.14116472596726, 100.34346799264182, 345.8511851474534, 286.25734464057126, 280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126, 307.96337144777, 317.3956987431139, 103.38382568359395, 263.9461319860225, 344.6094482421879, 330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.392227431384865, "mean_inference_ms": 1.2449988225736166, "mean_action_processing_ms": 0.20374661379937808, "mean_env_wait_ms": 482.24799159497184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010740995407104492, "StateBufferConnector_ms": 0.005890846252441406, "ViewRequirementAgentConnector_ms": 0.16546201705932617}, "num_episodes": 21, "episode_return_max": 363.69414774705126, "episode_return_min": 75.51355590043192, "episode_return_mean": 314.9165027136403}, "env_runner_results": {"episode_reward_max": 363.69414774705126, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 314.9165027136403, "episode_len_mean": 48.77, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4877, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955, 355.7682431113159, 306.8894865066745, 316.8527786800158, 347.39898527988805, 341.3149414062502, 333.8255461756539, 335.7186350296796, 339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198, 348.9636037436146, 311.1568464345147, 324.93575116760394, 347.53648340566355, 324.9874026931466, 350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923, 332.84609997062154, 306.14116472596726, 100.34346799264182, 345.8511851474534, 286.25734464057126, 280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126, 307.96337144777, 317.3956987431139, 103.38382568359395, 263.9461319860225, 344.6094482421879, 330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.392227431384865, "mean_inference_ms": 1.2449988225736166, "mean_action_processing_ms": 0.20374661379937808, "mean_env_wait_ms": 482.24799159497184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010740995407104492, "StateBufferConnector_ms": 0.005890846252441406, "ViewRequirementAgentConnector_ms": 0.16546201705932617}, "num_episodes": 21, "episode_return_max": 363.69414774705126, "episode_return_min": 75.51355590043192, "episode_return_mean": 314.9165027136403}, "episode_reward_max": 363.69414774705126, "episode_reward_min": 75.51355590043192, "episode_reward_mean": 314.9165027136403, "episode_len_mean": 48.77, "episodes_this_iter": 21, "episodes_timesteps_total": 4877, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.2049116852018, 323.33566395510786, 292.0205932050372, 318.7994190780498, 308.8896550848912, 298.98262162648393, 362.69525186085474, 322.97791222548034, 329.8382658604096, 329.1236269605791, 305.63407857022025, 335.02510276749325, 75.51355590043192, 336.43594054719586, 342.15510396738955, 355.7682431113159, 306.8894865066745, 316.8527786800158, 347.39898527988805, 341.3149414062502, 333.8255461756539, 335.7186350296796, 339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198, 348.9636037436146, 311.1568464345147, 324.93575116760394, 347.53648340566355, 324.9874026931466, 350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923, 332.84609997062154, 306.14116472596726, 100.34346799264182, 345.8511851474534, 286.25734464057126, 280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126, 307.96337144777, 317.3956987431139, 103.38382568359395, 263.9461319860225, 344.6094482421879, 330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.392227431384865, "mean_inference_ms": 1.2449988225736166, "mean_action_processing_ms": 0.20374661379937808, "mean_env_wait_ms": 482.24799159497184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010740995407104492, "StateBufferConnector_ms": 0.005890846252441406, "ViewRequirementAgentConnector_ms": 0.16546201705932617}, "num_episodes": 21, "episode_return_max": 363.69414774705126, "episode_return_min": 75.51355590043192, "episode_return_mean": 314.9165027136403, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85392, "num_agent_steps_trained": 85392, "num_env_steps_sampled": 85392, "num_env_steps_trained": 85392, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.438267789137601, "num_env_steps_trained_throughput_per_sec": 10.438267789137601, "timesteps_total": 85392, "num_env_steps_sampled_lifetime": 85392, "num_agent_steps_sampled_lifetime": 85392, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 85392, "timers": {"training_iteration_time_ms": 98280.712, "restore_workers_time_ms": 0.017, "training_step_time_ms": 98280.658, "sample_time_ms": 96512.416, "load_time_ms": 0.5, "load_throughput": 2050844.752, "learn_time_ms": 1754.117, "learn_throughput": 584.91, "synch_weights_time_ms": 13.279}, "counters": {"num_env_steps_sampled": 85392, "num_env_steps_trained": 85392, "num_agent_steps_sampled": 85392, "num_agent_steps_trained": 85392}, "done": false, "episodes_total": 1990, "training_iteration": 109, "trial_id": "fe178_00005", "date": "2024-08-15_19-33-49", "timestamp": 1723772029, "time_this_iter_s": 98.29625916481018, "time_total_s": 8554.577625513077, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 589.7057716846466, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.931428571428572, "ram_util_percent": 11.560714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.75436315735181, "cur_kl_coeff": 0.17124544470243563, "cur_lr": 0.0005000000000000002, "total_loss": 7.978922476371129, "policy_loss": -0.009908648238827785, "vf_loss": 7.988010453184446, "vf_explained_var": 0.0684377409517765, "kl": 0.004792629065925216, "entropy": -1.1617854004104933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 86418, "num_env_steps_trained": 86418, "num_agent_steps_sampled": 86418, "num_agent_steps_trained": 86418}, "sampler_results": {"episode_reward_max": 363.69414774705126, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 312.01520248553754, "episode_len_mean": 48.47, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4847, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198, 348.9636037436146, 311.1568464345147, 324.93575116760394, 347.53648340566355, 324.9874026931466, 350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923, 332.84609997062154, 306.14116472596726, 100.34346799264182, 345.8511851474534, 286.25734464057126, 280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126, 307.96337144777, 317.3956987431139, 103.38382568359395, 263.9461319860225, 344.6094482421879, 330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565, 360.53132360637835, 279.14717442757393, 325.78383998415404, 346.55508166507315, 316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515], "episode_lengths": [50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.436389608261299, "mean_inference_ms": 1.244869673399428, "mean_action_processing_ms": 0.20371566816742123, "mean_env_wait_ms": 480.1994599078143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010311603546142578, "StateBufferConnector_ms": 0.005933046340942383, "ViewRequirementAgentConnector_ms": 0.16638922691345215}, "num_episodes": 22, "episode_return_max": 363.69414774705126, "episode_return_min": 77.89480923064485, "episode_return_mean": 312.01520248553754}, "env_runner_results": {"episode_reward_max": 363.69414774705126, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 312.01520248553754, "episode_len_mean": 48.47, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4847, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198, 348.9636037436146, 311.1568464345147, 324.93575116760394, 347.53648340566355, 324.9874026931466, 350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923, 332.84609997062154, 306.14116472596726, 100.34346799264182, 345.8511851474534, 286.25734464057126, 280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126, 307.96337144777, 317.3956987431139, 103.38382568359395, 263.9461319860225, 344.6094482421879, 330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565, 360.53132360637835, 279.14717442757393, 325.78383998415404, 346.55508166507315, 316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515], "episode_lengths": [50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.436389608261299, "mean_inference_ms": 1.244869673399428, "mean_action_processing_ms": 0.20371566816742123, "mean_env_wait_ms": 480.1994599078143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010311603546142578, "StateBufferConnector_ms": 0.005933046340942383, "ViewRequirementAgentConnector_ms": 0.16638922691345215}, "num_episodes": 22, "episode_return_max": 363.69414774705126, "episode_return_min": 77.89480923064485, "episode_return_mean": 312.01520248553754}, "episode_reward_max": 363.69414774705126, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 312.01520248553754, "episode_len_mean": 48.47, "episodes_this_iter": 22, "episodes_timesteps_total": 4847, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [339.97738036849074, 304.82136499941777, 349.6770622382535, 309.5903808593755, 123.5906860351563, 349.9218269639443, 282.0662631215057, 363.69414774705126, 353.5634737422002, 293.9864534939798, 353.3762064814982, 322.11651181037627, 333.87609061173373, 315.43549514077483, 295.65925258621934, 352.7601812318198, 348.9636037436146, 311.1568464345147, 324.93575116760394, 347.53648340566355, 324.9874026931466, 350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923, 332.84609997062154, 306.14116472596726, 100.34346799264182, 345.8511851474534, 286.25734464057126, 280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126, 307.96337144777, 317.3956987431139, 103.38382568359395, 263.9461319860225, 344.6094482421879, 330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565, 360.53132360637835, 279.14717442757393, 325.78383998415404, 346.55508166507315, 316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515], "episode_lengths": [50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.436389608261299, "mean_inference_ms": 1.244869673399428, "mean_action_processing_ms": 0.20371566816742123, "mean_env_wait_ms": 480.1994599078143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010311603546142578, "StateBufferConnector_ms": 0.005933046340942383, "ViewRequirementAgentConnector_ms": 0.16638922691345215}, "num_episodes": 22, "episode_return_max": 363.69414774705126, "episode_return_min": 77.89480923064485, "episode_return_mean": 312.01520248553754, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86418, "num_agent_steps_trained": 86418, "num_env_steps_sampled": 86418, "num_env_steps_trained": 86418, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.321981169474398, "num_env_steps_trained_throughput_per_sec": 11.321981169474398, "timesteps_total": 86418, "num_env_steps_sampled_lifetime": 86418, "num_agent_steps_sampled_lifetime": 86418, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 86418, "timers": {"training_iteration_time_ms": 97186.352, "restore_workers_time_ms": 0.018, "training_step_time_ms": 97186.299, "sample_time_ms": 95476.485, "load_time_ms": 0.495, "load_throughput": 2071766.941, "learn_time_ms": 1695.723, "learn_throughput": 605.052, "synch_weights_time_ms": 13.256}, "counters": {"num_env_steps_sampled": 86418, "num_env_steps_trained": 86418, "num_agent_steps_sampled": 86418, "num_agent_steps_trained": 86418}, "done": false, "episodes_total": 2012, "training_iteration": 110, "trial_id": "fe178_00005", "date": "2024-08-15_19-35-19", "timestamp": 1723772119, "time_this_iter_s": 90.62390995025635, "time_total_s": 8645.201535463333, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 680.329681634903, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 22.954615384615384, "ram_util_percent": 11.652307692307694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.93469813466072, "cur_kl_coeff": 0.08562272235121782, "cur_lr": 0.0005000000000000002, "total_loss": 7.93161314924558, "policy_loss": -0.006578880412659297, "vf_loss": 7.936798218886057, "vf_explained_var": 0.02703332304954529, "kl": 0.01627886438461149, "entropy": -1.2522360876202583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 87444, "num_env_steps_trained": 87444, "num_agent_steps_sampled": 87444, "num_agent_steps_trained": 87444}, "sampler_results": {"episode_reward_max": 369.2587757841182, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 314.1751245184056, "episode_len_mean": 48.75, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4875, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923, 332.84609997062154, 306.14116472596726, 100.34346799264182, 345.8511851474534, 286.25734464057126, 280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126, 307.96337144777, 317.3956987431139, 103.38382568359395, 263.9461319860225, 344.6094482421879, 330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565, 360.53132360637835, 279.14717442757393, 325.78383998415404, 346.55508166507315, 316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515, 335.15668654917755, 323.97122850187884, 346.87104353402765, 299.7760705742698, 322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.264163840507197, "mean_inference_ms": 1.2443706945109454, "mean_action_processing_ms": 0.20364144247095983, "mean_env_wait_ms": 482.93117825912486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009917974472045898, "StateBufferConnector_ms": 0.005888462066650391, "ViewRequirementAgentConnector_ms": 0.16620922088623047}, "num_episodes": 21, "episode_return_max": 369.2587757841182, "episode_return_min": 77.89480923064485, "episode_return_mean": 314.1751245184056}, "env_runner_results": {"episode_reward_max": 369.2587757841182, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 314.1751245184056, "episode_len_mean": 48.75, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4875, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923, 332.84609997062154, 306.14116472596726, 100.34346799264182, 345.8511851474534, 286.25734464057126, 280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126, 307.96337144777, 317.3956987431139, 103.38382568359395, 263.9461319860225, 344.6094482421879, 330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565, 360.53132360637835, 279.14717442757393, 325.78383998415404, 346.55508166507315, 316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515, 335.15668654917755, 323.97122850187884, 346.87104353402765, 299.7760705742698, 322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.264163840507197, "mean_inference_ms": 1.2443706945109454, "mean_action_processing_ms": 0.20364144247095983, "mean_env_wait_ms": 482.93117825912486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009917974472045898, "StateBufferConnector_ms": 0.005888462066650391, "ViewRequirementAgentConnector_ms": 0.16620922088623047}, "num_episodes": 21, "episode_return_max": 369.2587757841182, "episode_return_min": 77.89480923064485, "episode_return_mean": 314.1751245184056}, "episode_reward_max": 369.2587757841182, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 314.1751245184056, "episode_len_mean": 48.75, "episodes_this_iter": 21, "episodes_timesteps_total": 4875, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.7787698370843, 348.8552720814926, 285.43888535155247, 349.6853215748388, 357.82048172161075, 323.13553569686286, 320.29470846485265, 344.43038106301395, 309.1357084422937, 344.1179144242165, 348.14796874868466, 334.67160403347924, 351.91089737229044, 330.88109195841923, 332.84609997062154, 306.14116472596726, 100.34346799264182, 345.8511851474534, 286.25734464057126, 280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126, 307.96337144777, 317.3956987431139, 103.38382568359395, 263.9461319860225, 344.6094482421879, 330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565, 360.53132360637835, 279.14717442757393, 325.78383998415404, 346.55508166507315, 316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515, 335.15668654917755, 323.97122850187884, 346.87104353402765, 299.7760705742698, 322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.264163840507197, "mean_inference_ms": 1.2443706945109454, "mean_action_processing_ms": 0.20364144247095983, "mean_env_wait_ms": 482.93117825912486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009917974472045898, "StateBufferConnector_ms": 0.005888462066650391, "ViewRequirementAgentConnector_ms": 0.16620922088623047}, "num_episodes": 21, "episode_return_max": 369.2587757841182, "episode_return_min": 77.89480923064485, "episode_return_mean": 314.1751245184056, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87444, "num_agent_steps_trained": 87444, "num_env_steps_sampled": 87444, "num_env_steps_trained": 87444, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.970356352558612, "num_env_steps_trained_throughput_per_sec": 10.970356352558612, "timesteps_total": 87444, "num_env_steps_sampled_lifetime": 87444, "num_agent_steps_sampled_lifetime": 87444, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 87444, "timers": {"training_iteration_time_ms": 96728.656, "restore_workers_time_ms": 0.019, "training_step_time_ms": 96728.601, "sample_time_ms": 95061.987, "load_time_ms": 0.482, "load_throughput": 2127214.98, "learn_time_ms": 1652.614, "learn_throughput": 620.835, "synch_weights_time_ms": 13.187}, "counters": {"num_env_steps_sampled": 87444, "num_env_steps_trained": 87444, "num_agent_steps_sampled": 87444, "num_agent_steps_trained": 87444}, "done": false, "episodes_total": 2033, "training_iteration": 111, "trial_id": "fe178_00005", "date": "2024-08-15_19-36-53", "timestamp": 1723772213, "time_this_iter_s": 93.52845907211304, "time_total_s": 8738.729994535446, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 773.858140707016, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.696240601503764, "ram_util_percent": 11.476691729323308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.09011497100194, "cur_kl_coeff": 0.08562272235121782, "cur_lr": 0.0005000000000000002, "total_loss": 7.6965907394886015, "policy_loss": -0.007113105627164866, "vf_loss": 7.703195648392041, "vf_explained_var": 0.06741429939866066, "kl": 0.00593492216721822, "entropy": -1.1781230568885803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2040.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 88470, "num_env_steps_trained": 88470, "num_agent_steps_sampled": 88470, "num_agent_steps_trained": 88470}, "sampler_results": {"episode_reward_max": 369.2587757841182, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 314.930926638797, "episode_len_mean": 49.01, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4901, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126, 307.96337144777, 317.3956987431139, 103.38382568359395, 263.9461319860225, 344.6094482421879, 330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565, 360.53132360637835, 279.14717442757393, 325.78383998415404, 346.55508166507315, 316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515, 335.15668654917755, 323.97122850187884, 346.87104353402765, 299.7760705742698, 322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488, 329.28800026709763, 339.05050143858494, 326.12847201746047, 341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.182979133066857, "mean_inference_ms": 1.2439150292330885, "mean_action_processing_ms": 0.20357651438218605, "mean_env_wait_ms": 486.28141765092863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009847640991210938, "StateBufferConnector_ms": 0.005882740020751953, "ViewRequirementAgentConnector_ms": 0.16572833061218262}, "num_episodes": 19, "episode_return_max": 369.2587757841182, "episode_return_min": 77.89480923064485, "episode_return_mean": 314.930926638797}, "env_runner_results": {"episode_reward_max": 369.2587757841182, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 314.930926638797, "episode_len_mean": 49.01, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4901, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126, 307.96337144777, 317.3956987431139, 103.38382568359395, 263.9461319860225, 344.6094482421879, 330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565, 360.53132360637835, 279.14717442757393, 325.78383998415404, 346.55508166507315, 316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515, 335.15668654917755, 323.97122850187884, 346.87104353402765, 299.7760705742698, 322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488, 329.28800026709763, 339.05050143858494, 326.12847201746047, 341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.182979133066857, "mean_inference_ms": 1.2439150292330885, "mean_action_processing_ms": 0.20357651438218605, "mean_env_wait_ms": 486.28141765092863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009847640991210938, "StateBufferConnector_ms": 0.005882740020751953, "ViewRequirementAgentConnector_ms": 0.16572833061218262}, "num_episodes": 19, "episode_return_max": 369.2587757841182, "episode_return_min": 77.89480923064485, "episode_return_mean": 314.930926638797}, "episode_reward_max": 369.2587757841182, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 314.930926638797, "episode_len_mean": 49.01, "episodes_this_iter": 19, "episodes_timesteps_total": 4901, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [280.4670457318332, 332.4044007616279, 292.87439869458683, 321.24621329035443, 324.17338925642207, 340.8211769796486, 331.11781390828367, 331.6657253566922, 361.43811701740725, 328.3058258100531, 339.30433973945475, 346.90682579020597, 271.918947137921, 338.8658528630225, 318.54772248361616, 334.2461118596006, 314.17954455090126, 307.96337144777, 317.3956987431139, 103.38382568359395, 263.9461319860225, 344.6094482421879, 330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565, 360.53132360637835, 279.14717442757393, 325.78383998415404, 346.55508166507315, 316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515, 335.15668654917755, 323.97122850187884, 346.87104353402765, 299.7760705742698, 322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488, 329.28800026709763, 339.05050143858494, 326.12847201746047, 341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.182979133066857, "mean_inference_ms": 1.2439150292330885, "mean_action_processing_ms": 0.20357651438218605, "mean_env_wait_ms": 486.28141765092863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009847640991210938, "StateBufferConnector_ms": 0.005882740020751953, "ViewRequirementAgentConnector_ms": 0.16572833061218262}, "num_episodes": 19, "episode_return_max": 369.2587757841182, "episode_return_min": 77.89480923064485, "episode_return_mean": 314.930926638797, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88470, "num_agent_steps_trained": 88470, "num_env_steps_sampled": 88470, "num_env_steps_trained": 88470, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.806523700968116, "num_env_steps_trained_throughput_per_sec": 11.806523700968116, "timesteps_total": 88470, "num_env_steps_sampled_lifetime": 88470, "num_agent_steps_sampled_lifetime": 88470, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 88470, "timers": {"training_iteration_time_ms": 95636.707, "restore_workers_time_ms": 0.018, "training_step_time_ms": 95636.655, "sample_time_ms": 94003.941, "load_time_ms": 0.475, "load_throughput": 2160921.896, "learn_time_ms": 1618.702, "learn_throughput": 633.841, "synch_weights_time_ms": 13.211}, "counters": {"num_env_steps_sampled": 88470, "num_env_steps_trained": 88470, "num_agent_steps_sampled": 88470, "num_agent_steps_trained": 88470}, "done": false, "episodes_total": 2052, "training_iteration": 112, "trial_id": "fe178_00005", "date": "2024-08-15_19-38-20", "timestamp": 1723772300, "time_this_iter_s": 86.90525460243225, "time_total_s": 8825.635249137878, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 860.7633953094482, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.1, "ram_util_percent": 11.602419354838707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.80931797822316, "cur_kl_coeff": 0.08562272235121782, "cur_lr": 0.0005000000000000002, "total_loss": 7.945056957006455, "policy_loss": 0.0029136575215185684, "vf_loss": 7.939452442526817, "vf_explained_var": 0.017008461554845176, "kl": 0.03142654710318627, "entropy": -1.2958988040685653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2280.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 89496, "num_env_steps_trained": 89496, "num_agent_steps_sampled": 89496, "num_agent_steps_trained": 89496}, "sampler_results": {"episode_reward_max": 369.2587757841182, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 318.5743193411841, "episode_len_mean": 49.32, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4932, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565, 360.53132360637835, 279.14717442757393, 325.78383998415404, 346.55508166507315, 316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515, 335.15668654917755, 323.97122850187884, 346.87104353402765, 299.7760705742698, 322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488, 329.28800026709763, 339.05050143858494, 326.12847201746047, 341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757, 357.2735364013091, 339.24631003121107, 359.0524455398952, 332.48733217269813, 319.3602734109712, 335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.106969206011389, "mean_inference_ms": 1.243051944596664, "mean_action_processing_ms": 0.20351801411040896, "mean_env_wait_ms": 486.67093267744394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009758234024047852, "StateBufferConnector_ms": 0.005906105041503906, "ViewRequirementAgentConnector_ms": 0.16699600219726562}, "num_episodes": 22, "episode_return_max": 369.2587757841182, "episode_return_min": 77.89480923064485, "episode_return_mean": 318.5743193411841}, "env_runner_results": {"episode_reward_max": 369.2587757841182, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 318.5743193411841, "episode_len_mean": 49.32, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4932, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565, 360.53132360637835, 279.14717442757393, 325.78383998415404, 346.55508166507315, 316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515, 335.15668654917755, 323.97122850187884, 346.87104353402765, 299.7760705742698, 322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488, 329.28800026709763, 339.05050143858494, 326.12847201746047, 341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757, 357.2735364013091, 339.24631003121107, 359.0524455398952, 332.48733217269813, 319.3602734109712, 335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.106969206011389, "mean_inference_ms": 1.243051944596664, "mean_action_processing_ms": 0.20351801411040896, "mean_env_wait_ms": 486.67093267744394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009758234024047852, "StateBufferConnector_ms": 0.005906105041503906, "ViewRequirementAgentConnector_ms": 0.16699600219726562}, "num_episodes": 22, "episode_return_max": 369.2587757841182, "episode_return_min": 77.89480923064485, "episode_return_mean": 318.5743193411841}, "episode_reward_max": 369.2587757841182, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 318.5743193411841, "episode_len_mean": 49.32, "episodes_this_iter": 22, "episodes_timesteps_total": 4932, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.81975621551607, 261.2570207354271, 293.2649717916805, 326.6151784849098, 307.49071044921925, 292.9253996592986, 352.03293883059877, 346.1807674366501, 328.445622697507, 288.3983256253456, 344.4901659942209, 315.43174606620124, 261.005937692479, 297.2182881495646, 263.5724924652381, 314.8820341272565, 360.53132360637835, 279.14717442757393, 325.78383998415404, 346.55508166507315, 316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515, 335.15668654917755, 323.97122850187884, 346.87104353402765, 299.7760705742698, 322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488, 329.28800026709763, 339.05050143858494, 326.12847201746047, 341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757, 357.2735364013091, 339.24631003121107, 359.0524455398952, 332.48733217269813, 319.3602734109712, 335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.106969206011389, "mean_inference_ms": 1.243051944596664, "mean_action_processing_ms": 0.20351801411040896, "mean_env_wait_ms": 486.67093267744394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009758234024047852, "StateBufferConnector_ms": 0.005906105041503906, "ViewRequirementAgentConnector_ms": 0.16699600219726562}, "num_episodes": 22, "episode_return_max": 369.2587757841182, "episode_return_min": 77.89480923064485, "episode_return_mean": 318.5743193411841, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89496, "num_agent_steps_trained": 89496, "num_env_steps_sampled": 89496, "num_env_steps_trained": 89496, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.360756787727334, "num_env_steps_trained_throughput_per_sec": 10.360756787727334, "timesteps_total": 89496, "num_env_steps_sampled_lifetime": 89496, "num_agent_steps_sampled_lifetime": 89496, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 89496, "timers": {"training_iteration_time_ms": 95975.789, "restore_workers_time_ms": 0.017, "training_step_time_ms": 95975.738, "sample_time_ms": 94369.712, "load_time_ms": 0.468, "load_throughput": 2191452.821, "learn_time_ms": 1592.032, "learn_throughput": 644.459, "synch_weights_time_ms": 13.203}, "counters": {"num_env_steps_sampled": 89496, "num_env_steps_trained": 89496, "num_agent_steps_sampled": 89496, "num_agent_steps_trained": 89496}, "done": false, "episodes_total": 2074, "training_iteration": 113, "trial_id": "fe178_00005", "date": "2024-08-15_19-39-59", "timestamp": 1723772399, "time_this_iter_s": 99.03105187416077, "time_total_s": 8924.66630101204, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 959.794447183609, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 21.038732394366196, "ram_util_percent": 11.552816901408454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.47448439200719, "cur_kl_coeff": 0.12843408352682673, "cur_lr": 0.0005000000000000002, "total_loss": 7.048551920056343, "policy_loss": -0.0037103178775093207, "vf_loss": 7.0514892141024275, "vf_explained_var": 0.04388156607747078, "kl": 0.006018653836025097, "entropy": -0.9651868785421054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2520.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 90522, "num_env_steps_trained": 90522, "num_agent_steps_sampled": 90522, "num_agent_steps_trained": 90522}, "sampler_results": {"episode_reward_max": 369.2587757841182, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 318.4766039065418, "episode_len_mean": 49.16, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4916, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515, 335.15668654917755, 323.97122850187884, 346.87104353402765, 299.7760705742698, 322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488, 329.28800026709763, 339.05050143858494, 326.12847201746047, 341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757, 357.2735364013091, 339.24631003121107, 359.0524455398952, 332.48733217269813, 319.3602734109712, 335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064, 353.2689090976785, 185.0115762852904, 325.54343235352366, 334.72070793875645, 319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121], "episode_lengths": [50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.048478985129439, "mean_inference_ms": 1.2424505396525323, "mean_action_processing_ms": 0.20345638039114153, "mean_env_wait_ms": 486.8563089393517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009896516799926758, "StateBufferConnector_ms": 0.005860805511474609, "ViewRequirementAgentConnector_ms": 0.16660380363464355}, "num_episodes": 20, "episode_return_max": 369.2587757841182, "episode_return_min": 77.89480923064485, "episode_return_mean": 318.4766039065418}, "env_runner_results": {"episode_reward_max": 369.2587757841182, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 318.4766039065418, "episode_len_mean": 49.16, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4916, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515, 335.15668654917755, 323.97122850187884, 346.87104353402765, 299.7760705742698, 322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488, 329.28800026709763, 339.05050143858494, 326.12847201746047, 341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757, 357.2735364013091, 339.24631003121107, 359.0524455398952, 332.48733217269813, 319.3602734109712, 335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064, 353.2689090976785, 185.0115762852904, 325.54343235352366, 334.72070793875645, 319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121], "episode_lengths": [50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.048478985129439, "mean_inference_ms": 1.2424505396525323, "mean_action_processing_ms": 0.20345638039114153, "mean_env_wait_ms": 486.8563089393517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009896516799926758, "StateBufferConnector_ms": 0.005860805511474609, "ViewRequirementAgentConnector_ms": 0.16660380363464355}, "num_episodes": 20, "episode_return_max": 369.2587757841182, "episode_return_min": 77.89480923064485, "episode_return_mean": 318.4766039065418}, "episode_reward_max": 369.2587757841182, "episode_reward_min": 77.89480923064485, "episode_reward_mean": 318.4766039065418, "episode_len_mean": 49.16, "episodes_this_iter": 20, "episodes_timesteps_total": 4916, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [316.85852854457517, 257.4020751953126, 312.12080953704225, 311.7487880521553, 328.4893072059985, 135.20735057352522, 324.10447459096736, 352.7879170404798, 320.6189851340758, 320.28035946797155, 338.72080540793223, 77.89480923064485, 332.69095983874786, 315.828966614255, 329.21663180375305, 330.6467149576044, 341.4994802865639, 301.1359135092515, 335.15668654917755, 323.97122850187884, 346.87104353402765, 299.7760705742698, 322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488, 329.28800026709763, 339.05050143858494, 326.12847201746047, 341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757, 357.2735364013091, 339.24631003121107, 359.0524455398952, 332.48733217269813, 319.3602734109712, 335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064, 353.2689090976785, 185.0115762852904, 325.54343235352366, 334.72070793875645, 319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121], "episode_lengths": [50, 46, 50, 50, 50, 24, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.048478985129439, "mean_inference_ms": 1.2424505396525323, "mean_action_processing_ms": 0.20345638039114153, "mean_env_wait_ms": 486.8563089393517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009896516799926758, "StateBufferConnector_ms": 0.005860805511474609, "ViewRequirementAgentConnector_ms": 0.16660380363464355}, "num_episodes": 20, "episode_return_max": 369.2587757841182, "episode_return_min": 77.89480923064485, "episode_return_mean": 318.4766039065418, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90522, "num_agent_steps_trained": 90522, "num_env_steps_sampled": 90522, "num_env_steps_trained": 90522, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.366180275753964, "num_env_steps_trained_throughput_per_sec": 10.366180275753964, "timesteps_total": 90522, "num_env_steps_sampled_lifetime": 90522, "num_agent_steps_sampled_lifetime": 90522, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 90522, "timers": {"training_iteration_time_ms": 95871.317, "restore_workers_time_ms": 0.017, "training_step_time_ms": 95871.267, "sample_time_ms": 94564.686, "load_time_ms": 0.416, "load_throughput": 2467237.647, "learn_time_ms": 1292.704, "learn_throughput": 793.685, "synch_weights_time_ms": 13.165}, "counters": {"num_env_steps_sampled": 90522, "num_env_steps_trained": 90522, "num_agent_steps_sampled": 90522, "num_agent_steps_trained": 90522}, "done": false, "episodes_total": 2094, "training_iteration": 114, "trial_id": "fe178_00005", "date": "2024-08-15_19-41-38", "timestamp": 1723772498, "time_this_iter_s": 98.97952032089233, "time_total_s": 9023.645821332932, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1058.7739675045013, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 20.93758865248227, "ram_util_percent": 11.748226950354606}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.165152951081595, "cur_kl_coeff": 0.12843408352682673, "cur_lr": 0.0005000000000000002, "total_loss": 8.219120238224665, "policy_loss": -0.004044632330381622, "vf_loss": 8.22253955801328, "vf_explained_var": 0.08310907979806265, "kl": 0.004868943252830797, "entropy": -1.329450549185276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2760.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 91548, "num_env_steps_trained": 91548, "num_agent_steps_sampled": 91548, "num_agent_steps_trained": 91548}, "sampler_results": {"episode_reward_max": 369.2587757841182, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 319.8731137452289, "episode_len_mean": 49.24, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488, 329.28800026709763, 339.05050143858494, 326.12847201746047, 341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757, 357.2735364013091, 339.24631003121107, 359.0524455398952, 332.48733217269813, 319.3602734109712, 335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064, 353.2689090976785, 185.0115762852904, 325.54343235352366, 334.72070793875645, 319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121, 344.9422683756822, 337.0685770524991, 349.9822995310007, 298.12104173062295, 303.7223932064836, 145.65266113281257, 360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.999887944079244, "mean_inference_ms": 1.241267897579883, "mean_action_processing_ms": 0.20338076717485204, "mean_env_wait_ms": 486.1895588518941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009911775588989258, "StateBufferConnector_ms": 0.005898475646972656, "ViewRequirementAgentConnector_ms": 0.1669323444366455}, "num_episodes": 22, "episode_return_max": 369.2587757841182, "episode_return_min": 85.0233032226563, "episode_return_mean": 319.8731137452289}, "env_runner_results": {"episode_reward_max": 369.2587757841182, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 319.8731137452289, "episode_len_mean": 49.24, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488, 329.28800026709763, 339.05050143858494, 326.12847201746047, 341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757, 357.2735364013091, 339.24631003121107, 359.0524455398952, 332.48733217269813, 319.3602734109712, 335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064, 353.2689090976785, 185.0115762852904, 325.54343235352366, 334.72070793875645, 319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121, 344.9422683756822, 337.0685770524991, 349.9822995310007, 298.12104173062295, 303.7223932064836, 145.65266113281257, 360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.999887944079244, "mean_inference_ms": 1.241267897579883, "mean_action_processing_ms": 0.20338076717485204, "mean_env_wait_ms": 486.1895588518941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009911775588989258, "StateBufferConnector_ms": 0.005898475646972656, "ViewRequirementAgentConnector_ms": 0.1669323444366455}, "num_episodes": 22, "episode_return_max": 369.2587757841182, "episode_return_min": 85.0233032226563, "episode_return_mean": 319.8731137452289}, "episode_reward_max": 369.2587757841182, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 319.8731137452289, "episode_len_mean": 49.24, "episodes_this_iter": 22, "episodes_timesteps_total": 4924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [322.0690413452939, 294.5999910103755, 329.07751900764237, 359.78831786343295, 333.54377468276357, 338.73149853675864, 322.3353908536905, 329.70390167812474, 342.7373322936779, 317.9873526171716, 333.84737022124233, 326.33404466358337, 369.2587757841182, 342.6175393681935, 292.98822469699974, 318.3708918905658, 337.9190724901488, 329.28800026709763, 339.05050143858494, 326.12847201746047, 341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757, 357.2735364013091, 339.24631003121107, 359.0524455398952, 332.48733217269813, 319.3602734109712, 335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064, 353.2689090976785, 185.0115762852904, 325.54343235352366, 334.72070793875645, 319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121, 344.9422683756822, 337.0685770524991, 349.9822995310007, 298.12104173062295, 303.7223932064836, 145.65266113281257, 360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.999887944079244, "mean_inference_ms": 1.241267897579883, "mean_action_processing_ms": 0.20338076717485204, "mean_env_wait_ms": 486.1895588518941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009911775588989258, "StateBufferConnector_ms": 0.005898475646972656, "ViewRequirementAgentConnector_ms": 0.1669323444366455}, "num_episodes": 22, "episode_return_max": 369.2587757841182, "episode_return_min": 85.0233032226563, "episode_return_mean": 319.8731137452289, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91548, "num_agent_steps_trained": 91548, "num_env_steps_sampled": 91548, "num_env_steps_trained": 91548, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.263719911691886, "num_env_steps_trained_throughput_per_sec": 11.263719911691886, "timesteps_total": 91548, "num_env_steps_sampled_lifetime": 91548, "num_agent_steps_sampled_lifetime": 91548, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 91548, "timers": {"training_iteration_time_ms": 94702.477, "restore_workers_time_ms": 0.017, "training_step_time_ms": 94702.428, "sample_time_ms": 93391.718, "load_time_ms": 0.416, "load_throughput": 2468511.389, "learn_time_ms": 1296.879, "learn_throughput": 791.13, "synch_weights_time_ms": 13.121}, "counters": {"num_env_steps_sampled": 91548, "num_env_steps_trained": 91548, "num_agent_steps_sampled": 91548, "num_agent_steps_trained": 91548}, "done": false, "episodes_total": 2116, "training_iteration": 115, "trial_id": "fe178_00005", "date": "2024-08-15_19-43-09", "timestamp": 1723772589, "time_this_iter_s": 91.09302854537964, "time_total_s": 9114.738849878311, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1149.866996049881, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 22.791538461538458, "ram_util_percent": 11.870000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.13571333487828, "cur_kl_coeff": 0.06421704176341336, "cur_lr": 0.0005000000000000002, "total_loss": 7.748411563038826, "policy_loss": -0.009586120846991737, "vf_loss": 7.756855663657189, "vf_explained_var": 0.046133598188559215, "kl": 0.017783896410161225, "entropy": -1.2773723339041074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3000.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 92574, "num_env_steps_trained": 92574, "num_agent_steps_sampled": 92574, "num_agent_steps_trained": 92574}, "sampler_results": {"episode_reward_max": 366.42235049124014, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 319.50683755514024, "episode_len_mean": 49.24, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757, 357.2735364013091, 339.24631003121107, 359.0524455398952, 332.48733217269813, 319.3602734109712, 335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064, 353.2689090976785, 185.0115762852904, 325.54343235352366, 334.72070793875645, 319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121, 344.9422683756822, 337.0685770524991, 349.9822995310007, 298.12104173062295, 303.7223932064836, 145.65266113281257, 360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066, 289.7535739655005, 353.2917627376568, 348.5413199186461, 295.8333900523648, 309.5117394878642, 303.92853770254004, 354.87160644531286, 305.3507800485152, 335.3360135149491, 336.7064815770996, 340.71956841572927, 286.75127485616065, 353.448068781548, 366.42235049124014, 349.69945618245026, 300.0614561346741, 356.2101263106079, 353.0167691639104, 319.74665246055685, 310.5484654707304], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.953176064012235, "mean_inference_ms": 1.2408638886440608, "mean_action_processing_ms": 0.20331678728595165, "mean_env_wait_ms": 485.66985699954324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010107755661010742, "StateBufferConnector_ms": 0.0059092044830322266, "ViewRequirementAgentConnector_ms": 0.16643476486206055}, "num_episodes": 20, "episode_return_max": 366.42235049124014, "episode_return_min": 85.0233032226563, "episode_return_mean": 319.50683755514024}, "env_runner_results": {"episode_reward_max": 366.42235049124014, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 319.50683755514024, "episode_len_mean": 49.24, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757, 357.2735364013091, 339.24631003121107, 359.0524455398952, 332.48733217269813, 319.3602734109712, 335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064, 353.2689090976785, 185.0115762852904, 325.54343235352366, 334.72070793875645, 319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121, 344.9422683756822, 337.0685770524991, 349.9822995310007, 298.12104173062295, 303.7223932064836, 145.65266113281257, 360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066, 289.7535739655005, 353.2917627376568, 348.5413199186461, 295.8333900523648, 309.5117394878642, 303.92853770254004, 354.87160644531286, 305.3507800485152, 335.3360135149491, 336.7064815770996, 340.71956841572927, 286.75127485616065, 353.448068781548, 366.42235049124014, 349.69945618245026, 300.0614561346741, 356.2101263106079, 353.0167691639104, 319.74665246055685, 310.5484654707304], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.953176064012235, "mean_inference_ms": 1.2408638886440608, "mean_action_processing_ms": 0.20331678728595165, "mean_env_wait_ms": 485.66985699954324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010107755661010742, "StateBufferConnector_ms": 0.0059092044830322266, "ViewRequirementAgentConnector_ms": 0.16643476486206055}, "num_episodes": 20, "episode_return_max": 366.42235049124014, "episode_return_min": 85.0233032226563, "episode_return_mean": 319.50683755514024}, "episode_reward_max": 366.42235049124014, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 319.50683755514024, "episode_len_mean": 49.24, "episodes_this_iter": 20, "episodes_timesteps_total": 4924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [341.75246355647596, 349.40640818334504, 340.39489200299795, 329.434515747995, 334.65682175123476, 299.4999008495964, 296.3909193544323, 290.6478641838339, 256.69033775623444, 334.37332094255135, 304.2214489550434, 365.0277150630374, 309.96331422777695, 338.8171931523573, 330.46507796566465, 330.1148478713757, 357.2735364013091, 339.24631003121107, 359.0524455398952, 332.48733217269813, 319.3602734109712, 335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064, 353.2689090976785, 185.0115762852904, 325.54343235352366, 334.72070793875645, 319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121, 344.9422683756822, 337.0685770524991, 349.9822995310007, 298.12104173062295, 303.7223932064836, 145.65266113281257, 360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066, 289.7535739655005, 353.2917627376568, 348.5413199186461, 295.8333900523648, 309.5117394878642, 303.92853770254004, 354.87160644531286, 305.3507800485152, 335.3360135149491, 336.7064815770996, 340.71956841572927, 286.75127485616065, 353.448068781548, 366.42235049124014, 349.69945618245026, 300.0614561346741, 356.2101263106079, 353.0167691639104, 319.74665246055685, 310.5484654707304], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.953176064012235, "mean_inference_ms": 1.2408638886440608, "mean_action_processing_ms": 0.20331678728595165, "mean_env_wait_ms": 485.66985699954324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010107755661010742, "StateBufferConnector_ms": 0.0059092044830322266, "ViewRequirementAgentConnector_ms": 0.16643476486206055}, "num_episodes": 20, "episode_return_max": 366.42235049124014, "episode_return_min": 85.0233032226563, "episode_return_mean": 319.50683755514024, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92574, "num_agent_steps_trained": 92574, "num_env_steps_sampled": 92574, "num_env_steps_trained": 92574, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.508534996312402, "num_env_steps_trained_throughput_per_sec": 10.508534996312402, "timesteps_total": 92574, "num_env_steps_sampled_lifetime": 92574, "num_agent_steps_sampled_lifetime": 92574, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 92574, "timers": {"training_iteration_time_ms": 94140.58, "restore_workers_time_ms": 0.017, "training_step_time_ms": 94140.533, "sample_time_ms": 92826.131, "load_time_ms": 0.41, "load_throughput": 2501224.007, "learn_time_ms": 1300.606, "learn_throughput": 788.863, "synch_weights_time_ms": 13.096}, "counters": {"num_env_steps_sampled": 92574, "num_env_steps_trained": 92574, "num_agent_steps_sampled": 92574, "num_agent_steps_trained": 92574}, "done": false, "episodes_total": 2136, "training_iteration": 116, "trial_id": "fe178_00005", "date": "2024-08-15_19-44-46", "timestamp": 1723772686, "time_this_iter_s": 97.63876914978027, "time_total_s": 9212.377619028091, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1247.5057651996613, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 21.094285714285714, "ram_util_percent": 11.65142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.772850994269053, "cur_kl_coeff": 0.06421704176341336, "cur_lr": 0.0005000000000000002, "total_loss": 7.392168619235357, "policy_loss": -0.007150680583436042, "vf_loss": 7.398947440584501, "vf_explained_var": 0.06297489975889524, "kl": 0.0057903752833244814, "entropy": -1.056704285244147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3240.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 93600, "num_env_steps_trained": 93600, "num_agent_steps_sampled": 93600, "num_agent_steps_trained": 93600}, "sampler_results": {"episode_reward_max": 366.42235049124014, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 318.03525387699466, "episode_len_mean": 49.11, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4911, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064, 353.2689090976785, 185.0115762852904, 325.54343235352366, 334.72070793875645, 319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121, 344.9422683756822, 337.0685770524991, 349.9822995310007, 298.12104173062295, 303.7223932064836, 145.65266113281257, 360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066, 289.7535739655005, 353.2917627376568, 348.5413199186461, 295.8333900523648, 309.5117394878642, 303.92853770254004, 354.87160644531286, 305.3507800485152, 335.3360135149491, 336.7064815770996, 340.71956841572927, 286.75127485616065, 353.448068781548, 366.42235049124014, 349.69945618245026, 300.0614561346741, 356.2101263106079, 353.0167691639104, 319.74665246055685, 310.5484654707304, 291.7933588100285, 357.69380799288314, 281.6138552297875, 285.414836181327, 329.04239255194693, 180.5728328370849, 316.0337680906732, 311.7188749506424, 356.13043457524293, 332.1535498190437, 319.96533442732857, 330.6005902268097, 326.7931304117444, 348.7209574081425, 357.02053464896505, 350.43005275731025, 306.2436212728781, 292.19264938937937, 343.07252197265643, 342.25148387288357, 352.65998387871974], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.93058156822394, "mean_inference_ms": 1.2406937255067525, "mean_action_processing_ms": 0.20332294096210743, "mean_env_wait_ms": 484.39136697122905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010285615921020508, "StateBufferConnector_ms": 0.005993843078613281, "ViewRequirementAgentConnector_ms": 0.1675717830657959}, "num_episodes": 21, "episode_return_max": 366.42235049124014, "episode_return_min": 85.0233032226563, "episode_return_mean": 318.03525387699466}, "env_runner_results": {"episode_reward_max": 366.42235049124014, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 318.03525387699466, "episode_len_mean": 49.11, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4911, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064, 353.2689090976785, 185.0115762852904, 325.54343235352366, 334.72070793875645, 319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121, 344.9422683756822, 337.0685770524991, 349.9822995310007, 298.12104173062295, 303.7223932064836, 145.65266113281257, 360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066, 289.7535739655005, 353.2917627376568, 348.5413199186461, 295.8333900523648, 309.5117394878642, 303.92853770254004, 354.87160644531286, 305.3507800485152, 335.3360135149491, 336.7064815770996, 340.71956841572927, 286.75127485616065, 353.448068781548, 366.42235049124014, 349.69945618245026, 300.0614561346741, 356.2101263106079, 353.0167691639104, 319.74665246055685, 310.5484654707304, 291.7933588100285, 357.69380799288314, 281.6138552297875, 285.414836181327, 329.04239255194693, 180.5728328370849, 316.0337680906732, 311.7188749506424, 356.13043457524293, 332.1535498190437, 319.96533442732857, 330.6005902268097, 326.7931304117444, 348.7209574081425, 357.02053464896505, 350.43005275731025, 306.2436212728781, 292.19264938937937, 343.07252197265643, 342.25148387288357, 352.65998387871974], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.93058156822394, "mean_inference_ms": 1.2406937255067525, "mean_action_processing_ms": 0.20332294096210743, "mean_env_wait_ms": 484.39136697122905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010285615921020508, "StateBufferConnector_ms": 0.005993843078613281, "ViewRequirementAgentConnector_ms": 0.1675717830657959}, "num_episodes": 21, "episode_return_max": 366.42235049124014, "episode_return_min": 85.0233032226563, "episode_return_mean": 318.03525387699466}, "episode_reward_max": 366.42235049124014, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 318.03525387699466, "episode_len_mean": 49.11, "episodes_this_iter": 21, "episodes_timesteps_total": 4911, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [335.1362996484379, 314.31144593178476, 349.3548500329602, 281.60891081449716, 317.67669530258996, 352.2981734287876, 301.60973800627175, 337.2780828756261, 341.3889734702892, 324.17050355432264, 275.7235960508619, 351.29785094606996, 355.40296334510896, 332.1339487646062, 297.65765045688727, 300.74198259213097, 334.90963479571064, 353.2689090976785, 185.0115762852904, 325.54343235352366, 334.72070793875645, 319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121, 344.9422683756822, 337.0685770524991, 349.9822995310007, 298.12104173062295, 303.7223932064836, 145.65266113281257, 360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066, 289.7535739655005, 353.2917627376568, 348.5413199186461, 295.8333900523648, 309.5117394878642, 303.92853770254004, 354.87160644531286, 305.3507800485152, 335.3360135149491, 336.7064815770996, 340.71956841572927, 286.75127485616065, 353.448068781548, 366.42235049124014, 349.69945618245026, 300.0614561346741, 356.2101263106079, 353.0167691639104, 319.74665246055685, 310.5484654707304, 291.7933588100285, 357.69380799288314, 281.6138552297875, 285.414836181327, 329.04239255194693, 180.5728328370849, 316.0337680906732, 311.7188749506424, 356.13043457524293, 332.1535498190437, 319.96533442732857, 330.6005902268097, 326.7931304117444, 348.7209574081425, 357.02053464896505, 350.43005275731025, 306.2436212728781, 292.19264938937937, 343.07252197265643, 342.25148387288357, 352.65998387871974], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.93058156822394, "mean_inference_ms": 1.2406937255067525, "mean_action_processing_ms": 0.20332294096210743, "mean_env_wait_ms": 484.39136697122905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010285615921020508, "StateBufferConnector_ms": 0.005993843078613281, "ViewRequirementAgentConnector_ms": 0.1675717830657959}, "num_episodes": 21, "episode_return_max": 366.42235049124014, "episode_return_min": 85.0233032226563, "episode_return_mean": 318.03525387699466, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93600, "num_agent_steps_trained": 93600, "num_env_steps_sampled": 93600, "num_env_steps_trained": 93600, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.573389653257811, "num_env_steps_trained_throughput_per_sec": 11.573389653257811, "timesteps_total": 93600, "num_env_steps_sampled_lifetime": 93600, "num_agent_steps_sampled_lifetime": 93600, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 93600, "timers": {"training_iteration_time_ms": 95411.934, "restore_workers_time_ms": 0.016, "training_step_time_ms": 95411.89, "sample_time_ms": 94100.456, "load_time_ms": 0.411, "load_throughput": 2498755.025, "learn_time_ms": 1297.739, "learn_throughput": 790.606, "synch_weights_time_ms": 13.007}, "counters": {"num_env_steps_sampled": 93600, "num_env_steps_trained": 93600, "num_agent_steps_sampled": 93600, "num_agent_steps_trained": 93600}, "done": false, "episodes_total": 2157, "training_iteration": 117, "trial_id": "fe178_00005", "date": "2024-08-15_19-46-15", "timestamp": 1723772775, "time_this_iter_s": 88.65559244155884, "time_total_s": 9301.03321146965, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1336.16135764122, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.276190476190475, "ram_util_percent": 11.543650793650787}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.298675270875297, "cur_kl_coeff": 0.06421704176341336, "cur_lr": 0.0005000000000000002, "total_loss": 7.4073580225308735, "policy_loss": -0.008743458625394851, "vf_loss": 7.415561546881993, "vf_explained_var": 0.06580876186490059, "kl": 0.008407780527828139, "entropy": -1.2305596532920997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3480.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 94626, "num_env_steps_trained": 94626, "num_agent_steps_sampled": 94626, "num_agent_steps_trained": 94626}, "sampler_results": {"episode_reward_max": 366.42235049124014, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 317.2323371723006, "episode_len_mean": 49.04, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121, 344.9422683756822, 337.0685770524991, 349.9822995310007, 298.12104173062295, 303.7223932064836, 145.65266113281257, 360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066, 289.7535739655005, 353.2917627376568, 348.5413199186461, 295.8333900523648, 309.5117394878642, 303.92853770254004, 354.87160644531286, 305.3507800485152, 335.3360135149491, 336.7064815770996, 340.71956841572927, 286.75127485616065, 353.448068781548, 366.42235049124014, 349.69945618245026, 300.0614561346741, 356.2101263106079, 353.0167691639104, 319.74665246055685, 310.5484654707304, 291.7933588100285, 357.69380799288314, 281.6138552297875, 285.414836181327, 329.04239255194693, 180.5728328370849, 316.0337680906732, 311.7188749506424, 356.13043457524293, 332.1535498190437, 319.96533442732857, 330.6005902268097, 326.7931304117444, 348.7209574081425, 357.02053464896505, 350.43005275731025, 306.2436212728781, 292.19264938937937, 343.07252197265643, 342.25148387288357, 352.65998387871974, 345.28609446562103, 348.1285145111025, 312.0709077343053, 342.6058191085493, 346.8089117266435, 332.00640471784294, 324.6152272985919, 338.27885652161683, 324.63682745731114, 303.55282309529815, 310.2458224135814, 160.94059622857452, 347.80582862633264, 334.5918907545899, 352.83314208984416, 325.92731654612305, 319.8476595252907, 351.2819649265161, 321.70462073182927, 217.2282576040492, 260.556769139176], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 50, 50, 50, 45, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.899955703519294, "mean_inference_ms": 1.240145200995864, "mean_action_processing_ms": 0.20333729077783338, "mean_env_wait_ms": 482.6762111512988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010395288467407227, "StateBufferConnector_ms": 0.005976676940917969, "ViewRequirementAgentConnector_ms": 0.1663951873779297}, "num_episodes": 21, "episode_return_max": 366.42235049124014, "episode_return_min": 85.0233032226563, "episode_return_mean": 317.2323371723006}, "env_runner_results": {"episode_reward_max": 366.42235049124014, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 317.2323371723006, "episode_len_mean": 49.04, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121, 344.9422683756822, 337.0685770524991, 349.9822995310007, 298.12104173062295, 303.7223932064836, 145.65266113281257, 360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066, 289.7535739655005, 353.2917627376568, 348.5413199186461, 295.8333900523648, 309.5117394878642, 303.92853770254004, 354.87160644531286, 305.3507800485152, 335.3360135149491, 336.7064815770996, 340.71956841572927, 286.75127485616065, 353.448068781548, 366.42235049124014, 349.69945618245026, 300.0614561346741, 356.2101263106079, 353.0167691639104, 319.74665246055685, 310.5484654707304, 291.7933588100285, 357.69380799288314, 281.6138552297875, 285.414836181327, 329.04239255194693, 180.5728328370849, 316.0337680906732, 311.7188749506424, 356.13043457524293, 332.1535498190437, 319.96533442732857, 330.6005902268097, 326.7931304117444, 348.7209574081425, 357.02053464896505, 350.43005275731025, 306.2436212728781, 292.19264938937937, 343.07252197265643, 342.25148387288357, 352.65998387871974, 345.28609446562103, 348.1285145111025, 312.0709077343053, 342.6058191085493, 346.8089117266435, 332.00640471784294, 324.6152272985919, 338.27885652161683, 324.63682745731114, 303.55282309529815, 310.2458224135814, 160.94059622857452, 347.80582862633264, 334.5918907545899, 352.83314208984416, 325.92731654612305, 319.8476595252907, 351.2819649265161, 321.70462073182927, 217.2282576040492, 260.556769139176], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 50, 50, 50, 45, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.899955703519294, "mean_inference_ms": 1.240145200995864, "mean_action_processing_ms": 0.20333729077783338, "mean_env_wait_ms": 482.6762111512988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010395288467407227, "StateBufferConnector_ms": 0.005976676940917969, "ViewRequirementAgentConnector_ms": 0.1663951873779297}, "num_episodes": 21, "episode_return_max": 366.42235049124014, "episode_return_min": 85.0233032226563, "episode_return_mean": 317.2323371723006}, "episode_reward_max": 366.42235049124014, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 317.2323371723006, "episode_len_mean": 49.04, "episodes_this_iter": 21, "episodes_timesteps_total": 4904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [319.50974496023395, 326.53121117033174, 270.34272898278743, 302.54430476439694, 303.3571014798685, 311.9946349114463, 318.0186993188282, 234.30371962198586, 318.19994737480397, 311.9850793744495, 354.30967646179516, 353.28423872564633, 342.8047038676102, 353.99170418525244, 276.15900808986447, 330.3961036755121, 344.9422683756822, 337.0685770524991, 349.9822995310007, 298.12104173062295, 303.7223932064836, 145.65266113281257, 360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066, 289.7535739655005, 353.2917627376568, 348.5413199186461, 295.8333900523648, 309.5117394878642, 303.92853770254004, 354.87160644531286, 305.3507800485152, 335.3360135149491, 336.7064815770996, 340.71956841572927, 286.75127485616065, 353.448068781548, 366.42235049124014, 349.69945618245026, 300.0614561346741, 356.2101263106079, 353.0167691639104, 319.74665246055685, 310.5484654707304, 291.7933588100285, 357.69380799288314, 281.6138552297875, 285.414836181327, 329.04239255194693, 180.5728328370849, 316.0337680906732, 311.7188749506424, 356.13043457524293, 332.1535498190437, 319.96533442732857, 330.6005902268097, 326.7931304117444, 348.7209574081425, 357.02053464896505, 350.43005275731025, 306.2436212728781, 292.19264938937937, 343.07252197265643, 342.25148387288357, 352.65998387871974, 345.28609446562103, 348.1285145111025, 312.0709077343053, 342.6058191085493, 346.8089117266435, 332.00640471784294, 324.6152272985919, 338.27885652161683, 324.63682745731114, 303.55282309529815, 310.2458224135814, 160.94059622857452, 347.80582862633264, 334.5918907545899, 352.83314208984416, 325.92731654612305, 319.8476595252907, 351.2819649265161, 321.70462073182927, 217.2282576040492, 260.556769139176], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 50, 50, 50, 45, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.899955703519294, "mean_inference_ms": 1.240145200995864, "mean_action_processing_ms": 0.20333729077783338, "mean_env_wait_ms": 482.6762111512988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010395288467407227, "StateBufferConnector_ms": 0.005976676940917969, "ViewRequirementAgentConnector_ms": 0.1663951873779297}, "num_episodes": 21, "episode_return_max": 366.42235049124014, "episode_return_min": 85.0233032226563, "episode_return_mean": 317.2323371723006, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94626, "num_agent_steps_trained": 94626, "num_env_steps_sampled": 94626, "num_env_steps_trained": 94626, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.382682203481748, "num_env_steps_trained_throughput_per_sec": 10.382682203481748, "timesteps_total": 94626, "num_env_steps_sampled_lifetime": 94626, "num_agent_steps_sampled_lifetime": 94626, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 94626, "timers": {"training_iteration_time_ms": 94353.543, "restore_workers_time_ms": 0.016, "training_step_time_ms": 94353.501, "sample_time_ms": 93050.712, "load_time_ms": 0.405, "load_throughput": 2530939.19, "learn_time_ms": 1289.206, "learn_throughput": 795.839, "synch_weights_time_ms": 12.906}, "counters": {"num_env_steps_sampled": 94626, "num_env_steps_trained": 94626, "num_agent_steps_sampled": 94626, "num_agent_steps_trained": 94626}, "done": false, "episodes_total": 2178, "training_iteration": 118, "trial_id": "fe178_00005", "date": "2024-08-15_19-47-54", "timestamp": 1723772874, "time_this_iter_s": 98.82199907302856, "time_total_s": 9399.855210542679, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1434.9833567142487, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 21.02695035460993, "ram_util_percent": 11.651773049645392}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.47193386554718, "cur_kl_coeff": 0.06421704176341336, "cur_lr": 0.0005000000000000002, "total_loss": 7.322199336687723, "policy_loss": -0.009342011832632124, "vf_loss": 7.330843559900919, "vf_explained_var": 0.06689639687538147, "kl": 0.010866957100976531, "entropy": -1.2274714077512423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3720.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 95652, "num_env_steps_trained": 95652, "num_agent_steps_sampled": 95652, "num_agent_steps_trained": 95652}, "sampler_results": {"episode_reward_max": 366.42235049124014, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 317.7682366517092, "episode_len_mean": 48.92, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4892, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066, 289.7535739655005, 353.2917627376568, 348.5413199186461, 295.8333900523648, 309.5117394878642, 303.92853770254004, 354.87160644531286, 305.3507800485152, 335.3360135149491, 336.7064815770996, 340.71956841572927, 286.75127485616065, 353.448068781548, 366.42235049124014, 349.69945618245026, 300.0614561346741, 356.2101263106079, 353.0167691639104, 319.74665246055685, 310.5484654707304, 291.7933588100285, 357.69380799288314, 281.6138552297875, 285.414836181327, 329.04239255194693, 180.5728328370849, 316.0337680906732, 311.7188749506424, 356.13043457524293, 332.1535498190437, 319.96533442732857, 330.6005902268097, 326.7931304117444, 348.7209574081425, 357.02053464896505, 350.43005275731025, 306.2436212728781, 292.19264938937937, 343.07252197265643, 342.25148387288357, 352.65998387871974, 345.28609446562103, 348.1285145111025, 312.0709077343053, 342.6058191085493, 346.8089117266435, 332.00640471784294, 324.6152272985919, 338.27885652161683, 324.63682745731114, 303.55282309529815, 310.2458224135814, 160.94059622857452, 347.80582862633264, 334.5918907545899, 352.83314208984416, 325.92731654612305, 319.8476595252907, 351.2819649265161, 321.70462073182927, 217.2282576040492, 260.556769139176, 300.72253686168057, 347.87597603683224, 343.8840902440086, 340.54950507441396, 352.09116217481227, 324.7755319650019, 311.6144364164613, 289.43864896990937, 356.4283952512736, 346.30820041555035, 342.4322656473208, 311.5083935112398, 285.1275879726533, 140.83066492368675, 289.0068268721771, 321.5565137542741, 324.9672042234325, 217.66214080007768, 350.83391992463584, 293.0483901185084, 336.42962480361797, 333.71977997320033], "episode_lengths": [50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 50, 50, 50, 45, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 37, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.89701520354998, "mean_inference_ms": 1.2395846538438962, "mean_action_processing_ms": 0.20330209639365088, "mean_env_wait_ms": 479.9216025517698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010229110717773438, "StateBufferConnector_ms": 0.0059316158294677734, "ViewRequirementAgentConnector_ms": 0.16616415977478027}, "num_episodes": 22, "episode_return_max": 366.42235049124014, "episode_return_min": 85.0233032226563, "episode_return_mean": 317.7682366517092}, "env_runner_results": {"episode_reward_max": 366.42235049124014, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 317.7682366517092, "episode_len_mean": 48.92, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4892, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066, 289.7535739655005, 353.2917627376568, 348.5413199186461, 295.8333900523648, 309.5117394878642, 303.92853770254004, 354.87160644531286, 305.3507800485152, 335.3360135149491, 336.7064815770996, 340.71956841572927, 286.75127485616065, 353.448068781548, 366.42235049124014, 349.69945618245026, 300.0614561346741, 356.2101263106079, 353.0167691639104, 319.74665246055685, 310.5484654707304, 291.7933588100285, 357.69380799288314, 281.6138552297875, 285.414836181327, 329.04239255194693, 180.5728328370849, 316.0337680906732, 311.7188749506424, 356.13043457524293, 332.1535498190437, 319.96533442732857, 330.6005902268097, 326.7931304117444, 348.7209574081425, 357.02053464896505, 350.43005275731025, 306.2436212728781, 292.19264938937937, 343.07252197265643, 342.25148387288357, 352.65998387871974, 345.28609446562103, 348.1285145111025, 312.0709077343053, 342.6058191085493, 346.8089117266435, 332.00640471784294, 324.6152272985919, 338.27885652161683, 324.63682745731114, 303.55282309529815, 310.2458224135814, 160.94059622857452, 347.80582862633264, 334.5918907545899, 352.83314208984416, 325.92731654612305, 319.8476595252907, 351.2819649265161, 321.70462073182927, 217.2282576040492, 260.556769139176, 300.72253686168057, 347.87597603683224, 343.8840902440086, 340.54950507441396, 352.09116217481227, 324.7755319650019, 311.6144364164613, 289.43864896990937, 356.4283952512736, 346.30820041555035, 342.4322656473208, 311.5083935112398, 285.1275879726533, 140.83066492368675, 289.0068268721771, 321.5565137542741, 324.9672042234325, 217.66214080007768, 350.83391992463584, 293.0483901185084, 336.42962480361797, 333.71977997320033], "episode_lengths": [50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 50, 50, 50, 45, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 37, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.89701520354998, "mean_inference_ms": 1.2395846538438962, "mean_action_processing_ms": 0.20330209639365088, "mean_env_wait_ms": 479.9216025517698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010229110717773438, "StateBufferConnector_ms": 0.0059316158294677734, "ViewRequirementAgentConnector_ms": 0.16616415977478027}, "num_episodes": 22, "episode_return_max": 366.42235049124014, "episode_return_min": 85.0233032226563, "episode_return_mean": 317.7682366517092}, "episode_reward_max": 366.42235049124014, "episode_reward_min": 85.0233032226563, "episode_reward_mean": 317.7682366517092, "episode_len_mean": 48.92, "episodes_this_iter": 22, "episodes_timesteps_total": 4892, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [360.47095512906793, 85.0233032226563, 345.2468323019553, 271.25918979136276, 317.7095596683089, 313.99236109284385, 336.7702383098988, 331.7624881945601, 284.3960843048458, 348.04815271197776, 342.8788847411951, 311.27072777097106, 333.99823329489044, 335.33056808672524, 335.28488351315826, 359.7471868554066, 289.7535739655005, 353.2917627376568, 348.5413199186461, 295.8333900523648, 309.5117394878642, 303.92853770254004, 354.87160644531286, 305.3507800485152, 335.3360135149491, 336.7064815770996, 340.71956841572927, 286.75127485616065, 353.448068781548, 366.42235049124014, 349.69945618245026, 300.0614561346741, 356.2101263106079, 353.0167691639104, 319.74665246055685, 310.5484654707304, 291.7933588100285, 357.69380799288314, 281.6138552297875, 285.414836181327, 329.04239255194693, 180.5728328370849, 316.0337680906732, 311.7188749506424, 356.13043457524293, 332.1535498190437, 319.96533442732857, 330.6005902268097, 326.7931304117444, 348.7209574081425, 357.02053464896505, 350.43005275731025, 306.2436212728781, 292.19264938937937, 343.07252197265643, 342.25148387288357, 352.65998387871974, 345.28609446562103, 348.1285145111025, 312.0709077343053, 342.6058191085493, 346.8089117266435, 332.00640471784294, 324.6152272985919, 338.27885652161683, 324.63682745731114, 303.55282309529815, 310.2458224135814, 160.94059622857452, 347.80582862633264, 334.5918907545899, 352.83314208984416, 325.92731654612305, 319.8476595252907, 351.2819649265161, 321.70462073182927, 217.2282576040492, 260.556769139176, 300.72253686168057, 347.87597603683224, 343.8840902440086, 340.54950507441396, 352.09116217481227, 324.7755319650019, 311.6144364164613, 289.43864896990937, 356.4283952512736, 346.30820041555035, 342.4322656473208, 311.5083935112398, 285.1275879726533, 140.83066492368675, 289.0068268721771, 321.5565137542741, 324.9672042234325, 217.66214080007768, 350.83391992463584, 293.0483901185084, 336.42962480361797, 333.71977997320033], "episode_lengths": [50, 18, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 50, 50, 50, 45, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 37, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.89701520354998, "mean_inference_ms": 1.2395846538438962, "mean_action_processing_ms": 0.20330209639365088, "mean_env_wait_ms": 479.9216025517698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010229110717773438, "StateBufferConnector_ms": 0.0059316158294677734, "ViewRequirementAgentConnector_ms": 0.16616415977478027}, "num_episodes": 22, "episode_return_max": 366.42235049124014, "episode_return_min": 85.0233032226563, "episode_return_mean": 317.7682366517092, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95652, "num_agent_steps_trained": 95652, "num_env_steps_sampled": 95652, "num_env_steps_trained": 95652, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 12.073410578646477, "num_env_steps_trained_throughput_per_sec": 12.073410578646477, "timesteps_total": 95652, "num_env_steps_sampled_lifetime": 95652, "num_agent_steps_sampled_lifetime": 95652, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 95652, "timers": {"training_iteration_time_ms": 93022.339, "restore_workers_time_ms": 0.015, "training_step_time_ms": 93022.298, "sample_time_ms": 91736.918, "load_time_ms": 0.406, "load_throughput": 2528262.678, "learn_time_ms": 1271.844, "learn_throughput": 806.703, "synch_weights_time_ms": 12.864}, "counters": {"num_env_steps_sampled": 95652, "num_env_steps_trained": 95652, "num_agent_steps_sampled": 95652, "num_agent_steps_trained": 95652}, "done": false, "episodes_total": 2200, "training_iteration": 119, "trial_id": "fe178_00005", "date": "2024-08-15_19-49-19", "timestamp": 1723772959, "time_this_iter_s": 84.98418092727661, "time_total_s": 9484.839391469955, "pid": 16212, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.727917978983917, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1519.9675376415253, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.138524590163932, "ram_util_percent": 11.765573770491804}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.092872484276693, "cur_kl_coeff": 0.25686816705365345, "cur_lr": 5e-06, "total_loss": 5.321601414307952, "policy_loss": -0.007042727475830664, "vf_loss": 5.32786569831272, "vf_explained_var": 0.11012665567298731, "kl": 0.003030607120794586, "entropy": -1.475041430691878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 97704, "num_env_steps_trained": 97704, "num_agent_steps_sampled": 97704, "num_agent_steps_trained": 97704}, "sampler_results": {"episode_reward_max": 371.75015869140657, "episode_reward_min": 204.89526794482634, "episode_reward_mean": 329.5161127837952, "episode_len_mean": 49.1025641025641, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 1915, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.1019778148939, 306.48036241621986, 343.0927035687183, 359.73071103860445, 218.97045093876142, 337.75220780629917, 371.75015869140657, 335.72483873386705, 349.0335992878449, 353.25511655368143, 343.7612770394759, 353.4788843012106, 339.5697494674952, 204.89526794482634, 357.806521873234, 351.17781103180016, 315.7727979733411, 349.80565750843436, 350.3505607807943, 352.9437832692055, 341.7266738374961, 299.2620389959216, 321.50424981217265, 351.4653094444567, 362.890380859375, 332.6301270593615, 324.4647801448072, 334.8267038765055, 345.1006841552777, 320.8424771060168, 333.2721593577971, 319.889583885071, 364.2990393519536, 313.9813448044764, 299.80237464000055, 353.7784056798118, 360.2040088983086, 319.6833852875551, 222.05023333153292], "episode_lengths": [50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4167399021812255, "mean_inference_ms": 1.2362075153198835, "mean_action_processing_ms": 0.20235524259893634, "mean_env_wait_ms": 468.2226432334899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01198878655066857, "StateBufferConnector_ms": 0.005858372419308393, "ViewRequirementAgentConnector_ms": 0.16147906963641828}, "num_episodes": 39, "episode_return_max": 371.75015869140657, "episode_return_min": 204.89526794482634, "episode_return_mean": 329.5161127837952}, "env_runner_results": {"episode_reward_max": 371.75015869140657, "episode_reward_min": 204.89526794482634, "episode_reward_mean": 329.5161127837952, "episode_len_mean": 49.1025641025641, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 1915, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.1019778148939, 306.48036241621986, 343.0927035687183, 359.73071103860445, 218.97045093876142, 337.75220780629917, 371.75015869140657, 335.72483873386705, 349.0335992878449, 353.25511655368143, 343.7612770394759, 353.4788843012106, 339.5697494674952, 204.89526794482634, 357.806521873234, 351.17781103180016, 315.7727979733411, 349.80565750843436, 350.3505607807943, 352.9437832692055, 341.7266738374961, 299.2620389959216, 321.50424981217265, 351.4653094444567, 362.890380859375, 332.6301270593615, 324.4647801448072, 334.8267038765055, 345.1006841552777, 320.8424771060168, 333.2721593577971, 319.889583885071, 364.2990393519536, 313.9813448044764, 299.80237464000055, 353.7784056798118, 360.2040088983086, 319.6833852875551, 222.05023333153292], "episode_lengths": [50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4167399021812255, "mean_inference_ms": 1.2362075153198835, "mean_action_processing_ms": 0.20235524259893634, "mean_env_wait_ms": 468.2226432334899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01198878655066857, "StateBufferConnector_ms": 0.005858372419308393, "ViewRequirementAgentConnector_ms": 0.16147906963641828}, "num_episodes": 39, "episode_return_max": 371.75015869140657, "episode_return_min": 204.89526794482634, "episode_return_mean": 329.5161127837952}, "episode_reward_max": 371.75015869140657, "episode_reward_min": 204.89526794482634, "episode_reward_mean": 329.5161127837952, "episode_len_mean": 49.1025641025641, "episodes_this_iter": 39, "episodes_timesteps_total": 1915, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.1019778148939, 306.48036241621986, 343.0927035687183, 359.73071103860445, 218.97045093876142, 337.75220780629917, 371.75015869140657, 335.72483873386705, 349.0335992878449, 353.25511655368143, 343.7612770394759, 353.4788843012106, 339.5697494674952, 204.89526794482634, 357.806521873234, 351.17781103180016, 315.7727979733411, 349.80565750843436, 350.3505607807943, 352.9437832692055, 341.7266738374961, 299.2620389959216, 321.50424981217265, 351.4653094444567, 362.890380859375, 332.6301270593615, 324.4647801448072, 334.8267038765055, 345.1006841552777, 320.8424771060168, 333.2721593577971, 319.889583885071, 364.2990393519536, 313.9813448044764, 299.80237464000055, 353.7784056798118, 360.2040088983086, 319.6833852875551, 222.05023333153292], "episode_lengths": [50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4167399021812255, "mean_inference_ms": 1.2362075153198835, "mean_action_processing_ms": 0.20235524259893634, "mean_env_wait_ms": 468.2226432334899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01198878655066857, "StateBufferConnector_ms": 0.005858372419308393, "ViewRequirementAgentConnector_ms": 0.16147906963641828}, "num_episodes": 39, "episode_return_max": 371.75015869140657, "episode_return_min": 204.89526794482634, "episode_return_mean": 329.5161127837952, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97704, "num_agent_steps_trained": 97704, "num_env_steps_sampled": 97704, "num_env_steps_trained": 97704, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 10.812675106235263, "num_env_steps_trained_throughput_per_sec": 10.812675106235263, "timesteps_total": 97704, "num_env_steps_sampled_lifetime": 97704, "num_agent_steps_sampled_lifetime": 97704, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 97704, "timers": {"training_iteration_time_ms": 189777.288, "restore_workers_time_ms": 0.024, "training_step_time_ms": 189777.218, "sample_time_ms": 181999.652, "load_time_ms": 0.812, "load_throughput": 2527668.666, "learn_time_ms": 7762.656, "learn_throughput": 264.342, "synch_weights_time_ms": 13.486}, "counters": {"num_env_steps_sampled": 97704, "num_env_steps_trained": 97704, "num_agent_steps_sampled": 97704, "num_agent_steps_trained": 97704}, "done": false, "episodes_total": 2242, "training_iteration": 112, "trial_id": "fe178_00005", "date": "2024-08-15_19-52-46", "timestamp": 1723773166, "time_this_iter_s": 189.78068447113037, "time_total_s": 9661.12514090538, "pid": 73434, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1519453193226112, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 189.78068447113037, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 22.091143911439115, "ram_util_percent": 11.543173431734317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.20683264533679, "cur_kl_coeff": 0.12843408352682673, "cur_lr": 5e-06, "total_loss": 4.730597092211246, "policy_loss": 0.00026191000749046606, "vf_loss": 4.7256682572265465, "vf_explained_var": 0.06169126853346825, "kl": 0.03633728337875689, "entropy": -1.345972452685237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 720.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 99756, "num_env_steps_trained": 99756, "num_agent_steps_sampled": 99756, "num_agent_steps_trained": 99756}, "sampler_results": {"episode_reward_max": 371.75015869140657, "episode_reward_min": 204.89526794482634, "episode_reward_mean": 330.5720558649099, "episode_len_mean": 49.55128205128205, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 3865, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.1019778148939, 306.48036241621986, 343.0927035687183, 359.73071103860445, 218.97045093876142, 337.75220780629917, 371.75015869140657, 335.72483873386705, 349.0335992878449, 353.25511655368143, 343.7612770394759, 353.4788843012106, 339.5697494674952, 204.89526794482634, 357.806521873234, 351.17781103180016, 315.7727979733411, 349.80565750843436, 350.3505607807943, 352.9437832692055, 341.7266738374961, 299.2620389959216, 321.50424981217265, 351.4653094444567, 362.890380859375, 332.6301270593615, 324.4647801448072, 334.8267038765055, 345.1006841552777, 320.8424771060168, 333.2721593577971, 319.889583885071, 364.2990393519536, 313.9813448044764, 299.80237464000055, 353.7784056798118, 360.2040088983086, 319.6833852875551, 222.05023333153292, 351.3950657432237, 316.8837560865457, 341.15490663306076, 344.1599987589391, 316.9927163717808, 324.55208944188496, 335.85883861581044, 314.2058245969601, 307.50132974057783, 300.76206179623864, 348.283264565971, 306.2890995870004, 326.6355936872555, 341.9050872507199, 344.5221151212613, 335.5437056724961, 363.5652199072248, 345.3439888293243, 340.9298002362919, 359.93001116623515, 348.3587642280914, 331.22426311218936, 341.07354336695505, 351.8771584836399, 317.51871214083366, 345.93885256812416, 350.63006540004125, 334.02927249737525, 356.73342749240663, 357.58125954051974, 281.2514220572658, 287.7875493586663, 318.78927537858516, 297.1729982099272, 286.8200006997665, 344.77263247059244, 322.9899580680013, 337.8593739012008, 354.66895611197344], "episode_lengths": [50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.416715809096751, "mean_inference_ms": 1.2370571617375679, "mean_action_processing_ms": 0.20276517189450552, "mean_env_wait_ms": 474.75666791826126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011516228700295473, "StateBufferConnector_ms": 0.005944264240753956, "ViewRequirementAgentConnector_ms": 0.16252994537353516}, "num_episodes": 39, "episode_return_max": 371.75015869140657, "episode_return_min": 204.89526794482634, "episode_return_mean": 330.5720558649099}, "env_runner_results": {"episode_reward_max": 371.75015869140657, "episode_reward_min": 204.89526794482634, "episode_reward_mean": 330.5720558649099, "episode_len_mean": 49.55128205128205, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 3865, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.1019778148939, 306.48036241621986, 343.0927035687183, 359.73071103860445, 218.97045093876142, 337.75220780629917, 371.75015869140657, 335.72483873386705, 349.0335992878449, 353.25511655368143, 343.7612770394759, 353.4788843012106, 339.5697494674952, 204.89526794482634, 357.806521873234, 351.17781103180016, 315.7727979733411, 349.80565750843436, 350.3505607807943, 352.9437832692055, 341.7266738374961, 299.2620389959216, 321.50424981217265, 351.4653094444567, 362.890380859375, 332.6301270593615, 324.4647801448072, 334.8267038765055, 345.1006841552777, 320.8424771060168, 333.2721593577971, 319.889583885071, 364.2990393519536, 313.9813448044764, 299.80237464000055, 353.7784056798118, 360.2040088983086, 319.6833852875551, 222.05023333153292, 351.3950657432237, 316.8837560865457, 341.15490663306076, 344.1599987589391, 316.9927163717808, 324.55208944188496, 335.85883861581044, 314.2058245969601, 307.50132974057783, 300.76206179623864, 348.283264565971, 306.2890995870004, 326.6355936872555, 341.9050872507199, 344.5221151212613, 335.5437056724961, 363.5652199072248, 345.3439888293243, 340.9298002362919, 359.93001116623515, 348.3587642280914, 331.22426311218936, 341.07354336695505, 351.8771584836399, 317.51871214083366, 345.93885256812416, 350.63006540004125, 334.02927249737525, 356.73342749240663, 357.58125954051974, 281.2514220572658, 287.7875493586663, 318.78927537858516, 297.1729982099272, 286.8200006997665, 344.77263247059244, 322.9899580680013, 337.8593739012008, 354.66895611197344], "episode_lengths": [50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.416715809096751, "mean_inference_ms": 1.2370571617375679, "mean_action_processing_ms": 0.20276517189450552, "mean_env_wait_ms": 474.75666791826126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011516228700295473, "StateBufferConnector_ms": 0.005944264240753956, "ViewRequirementAgentConnector_ms": 0.16252994537353516}, "num_episodes": 39, "episode_return_max": 371.75015869140657, "episode_return_min": 204.89526794482634, "episode_return_mean": 330.5720558649099}, "episode_reward_max": 371.75015869140657, "episode_reward_min": 204.89526794482634, "episode_reward_mean": 330.5720558649099, "episode_len_mean": 49.55128205128205, "episodes_this_iter": 39, "episodes_timesteps_total": 3865, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.1019778148939, 306.48036241621986, 343.0927035687183, 359.73071103860445, 218.97045093876142, 337.75220780629917, 371.75015869140657, 335.72483873386705, 349.0335992878449, 353.25511655368143, 343.7612770394759, 353.4788843012106, 339.5697494674952, 204.89526794482634, 357.806521873234, 351.17781103180016, 315.7727979733411, 349.80565750843436, 350.3505607807943, 352.9437832692055, 341.7266738374961, 299.2620389959216, 321.50424981217265, 351.4653094444567, 362.890380859375, 332.6301270593615, 324.4647801448072, 334.8267038765055, 345.1006841552777, 320.8424771060168, 333.2721593577971, 319.889583885071, 364.2990393519536, 313.9813448044764, 299.80237464000055, 353.7784056798118, 360.2040088983086, 319.6833852875551, 222.05023333153292, 351.3950657432237, 316.8837560865457, 341.15490663306076, 344.1599987589391, 316.9927163717808, 324.55208944188496, 335.85883861581044, 314.2058245969601, 307.50132974057783, 300.76206179623864, 348.283264565971, 306.2890995870004, 326.6355936872555, 341.9050872507199, 344.5221151212613, 335.5437056724961, 363.5652199072248, 345.3439888293243, 340.9298002362919, 359.93001116623515, 348.3587642280914, 331.22426311218936, 341.07354336695505, 351.8771584836399, 317.51871214083366, 345.93885256812416, 350.63006540004125, 334.02927249737525, 356.73342749240663, 357.58125954051974, 281.2514220572658, 287.7875493586663, 318.78927537858516, 297.1729982099272, 286.8200006997665, 344.77263247059244, 322.9899580680013, 337.8593739012008, 354.66895611197344], "episode_lengths": [50, 50, 50, 50, 41, 50, 50, 50, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.416715809096751, "mean_inference_ms": 1.2370571617375679, "mean_action_processing_ms": 0.20276517189450552, "mean_env_wait_ms": 474.75666791826126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011516228700295473, "StateBufferConnector_ms": 0.005944264240753956, "ViewRequirementAgentConnector_ms": 0.16252994537353516}, "num_episodes": 39, "episode_return_max": 371.75015869140657, "episode_return_min": 204.89526794482634, "episode_return_mean": 330.5720558649099, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99756, "num_agent_steps_trained": 99756, "num_env_steps_sampled": 99756, "num_env_steps_trained": 99756, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 11.085237631288313, "num_env_steps_trained_throughput_per_sec": 11.085237631288313, "timesteps_total": 99756, "num_env_steps_sampled_lifetime": 99756, "num_agent_steps_sampled_lifetime": 99756, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 99756, "timers": {"training_iteration_time_ms": 187444.176, "restore_workers_time_ms": 0.023, "training_step_time_ms": 187444.111, "sample_time_ms": 182328.511, "load_time_ms": 0.713, "load_throughput": 2878498.932, "learn_time_ms": 5101.2, "learn_throughput": 402.258, "synch_weights_time_ms": 13.205}, "counters": {"num_env_steps_sampled": 99756, "num_env_steps_trained": 99756, "num_agent_steps_sampled": 99756, "num_agent_steps_trained": 99756}, "done": false, "episodes_total": 2281, "training_iteration": 113, "trial_id": "fe178_00005", "date": "2024-08-15_19-55-51", "timestamp": 1723773351, "time_this_iter_s": 185.11480069160461, "time_total_s": 9846.239941596985, "pid": 73434, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1519453193226112, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 374.895485162735, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 22.495833333333337, "ram_util_percent": 11.553787878787878}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.637879932423434, "cur_kl_coeff": 0.1926511252902401, "cur_lr": 5e-06, "total_loss": 4.503988820935289, "policy_loss": -0.004297128783218795, "vf_loss": 4.507436364268263, "vf_explained_var": 0.12133294530212879, "kl": 0.004410249642510109, "entropy": -1.3103308824201425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1200.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 101808, "num_env_steps_trained": 101808, "num_agent_steps_sampled": 101808, "num_agent_steps_trained": 101808}, "sampler_results": {"episode_reward_max": 366.6532736420677, "episode_reward_min": 104.7702514648438, "episode_reward_mean": 324.62787223423976, "episode_len_mean": 49.02, "episode_media": {}, "episodes_this_iter": 45, "episodes_timesteps_total": 4902, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.4653094444567, 362.890380859375, 332.6301270593615, 324.4647801448072, 334.8267038765055, 345.1006841552777, 320.8424771060168, 333.2721593577971, 319.889583885071, 364.2990393519536, 313.9813448044764, 299.80237464000055, 353.7784056798118, 360.2040088983086, 319.6833852875551, 222.05023333153292, 351.3950657432237, 316.8837560865457, 341.15490663306076, 344.1599987589391, 316.9927163717808, 324.55208944188496, 335.85883861581044, 314.2058245969601, 307.50132974057783, 300.76206179623864, 348.283264565971, 306.2890995870004, 326.6355936872555, 341.9050872507199, 344.5221151212613, 335.5437056724961, 363.5652199072248, 345.3439888293243, 340.9298002362919, 359.93001116623515, 348.3587642280914, 331.22426311218936, 341.07354336695505, 351.8771584836399, 317.51871214083366, 345.93885256812416, 350.63006540004125, 334.02927249737525, 356.73342749240663, 357.58125954051974, 281.2514220572658, 287.7875493586663, 318.78927537858516, 297.1729982099272, 286.8200006997665, 344.77263247059244, 322.9899580680013, 337.8593739012008, 354.66895611197344, 316.3262381071871, 312.1889925708299, 325.8188956705952, 145.22555626707833, 309.66934787518414, 352.22332941080026, 359.2702435285054, 320.3080375894189, 350.7941823257626, 357.2218358546167, 352.25464875468265, 303.8338758471325, 342.13445613808125, 366.4779126971021, 306.18897978256064, 119.69425188978487, 295.6955217040756, 351.06430610288527, 307.7807624468728, 355.6549351817434, 328.10863737987535, 345.29202754564517, 347.4082312564648, 319.328357046256, 362.13643195008734, 347.62662068295396, 335.1400120556254, 316.74370934613677, 274.8155965340156, 292.4167333451851, 320.54631430037404, 322.8739245003623, 104.7702514648438, 353.6470207532892, 273.3342370242303, 352.2135200395918, 358.9078547878491, 350.65975652459787, 366.6532736420677, 289.48052321202897, 308.1230092951086, 363.87697180509525, 343.817866786179, 324.18753546525954, 318.17954015869316], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.498389687792971, "mean_inference_ms": 1.2353861218958513, "mean_action_processing_ms": 0.20335528242241976, "mean_env_wait_ms": 479.48841797776333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011505603790283203, "StateBufferConnector_ms": 0.0060079097747802734, "ViewRequirementAgentConnector_ms": 0.1629343032836914}, "num_episodes": 45, "episode_return_max": 366.6532736420677, "episode_return_min": 104.7702514648438, "episode_return_mean": 324.62787223423976}, "env_runner_results": {"episode_reward_max": 366.6532736420677, "episode_reward_min": 104.7702514648438, "episode_reward_mean": 324.62787223423976, "episode_len_mean": 49.02, "episode_media": {}, "episodes_this_iter": 45, "episodes_timesteps_total": 4902, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.4653094444567, 362.890380859375, 332.6301270593615, 324.4647801448072, 334.8267038765055, 345.1006841552777, 320.8424771060168, 333.2721593577971, 319.889583885071, 364.2990393519536, 313.9813448044764, 299.80237464000055, 353.7784056798118, 360.2040088983086, 319.6833852875551, 222.05023333153292, 351.3950657432237, 316.8837560865457, 341.15490663306076, 344.1599987589391, 316.9927163717808, 324.55208944188496, 335.85883861581044, 314.2058245969601, 307.50132974057783, 300.76206179623864, 348.283264565971, 306.2890995870004, 326.6355936872555, 341.9050872507199, 344.5221151212613, 335.5437056724961, 363.5652199072248, 345.3439888293243, 340.9298002362919, 359.93001116623515, 348.3587642280914, 331.22426311218936, 341.07354336695505, 351.8771584836399, 317.51871214083366, 345.93885256812416, 350.63006540004125, 334.02927249737525, 356.73342749240663, 357.58125954051974, 281.2514220572658, 287.7875493586663, 318.78927537858516, 297.1729982099272, 286.8200006997665, 344.77263247059244, 322.9899580680013, 337.8593739012008, 354.66895611197344, 316.3262381071871, 312.1889925708299, 325.8188956705952, 145.22555626707833, 309.66934787518414, 352.22332941080026, 359.2702435285054, 320.3080375894189, 350.7941823257626, 357.2218358546167, 352.25464875468265, 303.8338758471325, 342.13445613808125, 366.4779126971021, 306.18897978256064, 119.69425188978487, 295.6955217040756, 351.06430610288527, 307.7807624468728, 355.6549351817434, 328.10863737987535, 345.29202754564517, 347.4082312564648, 319.328357046256, 362.13643195008734, 347.62662068295396, 335.1400120556254, 316.74370934613677, 274.8155965340156, 292.4167333451851, 320.54631430037404, 322.8739245003623, 104.7702514648438, 353.6470207532892, 273.3342370242303, 352.2135200395918, 358.9078547878491, 350.65975652459787, 366.6532736420677, 289.48052321202897, 308.1230092951086, 363.87697180509525, 343.817866786179, 324.18753546525954, 318.17954015869316], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.498389687792971, "mean_inference_ms": 1.2353861218958513, "mean_action_processing_ms": 0.20335528242241976, "mean_env_wait_ms": 479.48841797776333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011505603790283203, "StateBufferConnector_ms": 0.0060079097747802734, "ViewRequirementAgentConnector_ms": 0.1629343032836914}, "num_episodes": 45, "episode_return_max": 366.6532736420677, "episode_return_min": 104.7702514648438, "episode_return_mean": 324.62787223423976}, "episode_reward_max": 366.6532736420677, "episode_reward_min": 104.7702514648438, "episode_reward_mean": 324.62787223423976, "episode_len_mean": 49.02, "episodes_this_iter": 45, "episodes_timesteps_total": 4902, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [351.4653094444567, 362.890380859375, 332.6301270593615, 324.4647801448072, 334.8267038765055, 345.1006841552777, 320.8424771060168, 333.2721593577971, 319.889583885071, 364.2990393519536, 313.9813448044764, 299.80237464000055, 353.7784056798118, 360.2040088983086, 319.6833852875551, 222.05023333153292, 351.3950657432237, 316.8837560865457, 341.15490663306076, 344.1599987589391, 316.9927163717808, 324.55208944188496, 335.85883861581044, 314.2058245969601, 307.50132974057783, 300.76206179623864, 348.283264565971, 306.2890995870004, 326.6355936872555, 341.9050872507199, 344.5221151212613, 335.5437056724961, 363.5652199072248, 345.3439888293243, 340.9298002362919, 359.93001116623515, 348.3587642280914, 331.22426311218936, 341.07354336695505, 351.8771584836399, 317.51871214083366, 345.93885256812416, 350.63006540004125, 334.02927249737525, 356.73342749240663, 357.58125954051974, 281.2514220572658, 287.7875493586663, 318.78927537858516, 297.1729982099272, 286.8200006997665, 344.77263247059244, 322.9899580680013, 337.8593739012008, 354.66895611197344, 316.3262381071871, 312.1889925708299, 325.8188956705952, 145.22555626707833, 309.66934787518414, 352.22332941080026, 359.2702435285054, 320.3080375894189, 350.7941823257626, 357.2218358546167, 352.25464875468265, 303.8338758471325, 342.13445613808125, 366.4779126971021, 306.18897978256064, 119.69425188978487, 295.6955217040756, 351.06430610288527, 307.7807624468728, 355.6549351817434, 328.10863737987535, 345.29202754564517, 347.4082312564648, 319.328357046256, 362.13643195008734, 347.62662068295396, 335.1400120556254, 316.74370934613677, 274.8155965340156, 292.4167333451851, 320.54631430037404, 322.8739245003623, 104.7702514648438, 353.6470207532892, 273.3342370242303, 352.2135200395918, 358.9078547878491, 350.65975652459787, 366.6532736420677, 289.48052321202897, 308.1230092951086, 363.87697180509525, 343.817866786179, 324.18753546525954, 318.17954015869316], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 37, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.498389687792971, "mean_inference_ms": 1.2353861218958513, "mean_action_processing_ms": 0.20335528242241976, "mean_env_wait_ms": 479.48841797776333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011505603790283203, "StateBufferConnector_ms": 0.0060079097747802734, "ViewRequirementAgentConnector_ms": 0.1629343032836914}, "num_episodes": 45, "episode_return_max": 366.6532736420677, "episode_return_min": 104.7702514648438, "episode_return_mean": 324.62787223423976, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101808, "num_agent_steps_trained": 101808, "num_env_steps_sampled": 101808, "num_env_steps_trained": 101808, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 11.209578853898737, "num_env_steps_trained_throughput_per_sec": 11.209578853898737, "timesteps_total": 101808, "num_env_steps_sampled_lifetime": 101808, "num_agent_steps_sampled_lifetime": 101808, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 101808, "timers": {"training_iteration_time_ms": 185982.03, "restore_workers_time_ms": 0.022, "training_step_time_ms": 185981.968, "sample_time_ms": 181729.464, "load_time_ms": 0.632, "load_throughput": 3247407.298, "learn_time_ms": 4238.235, "learn_throughput": 484.164, "synch_weights_time_ms": 13.194}, "counters": {"num_env_steps_sampled": 101808, "num_env_steps_trained": 101808, "num_agent_steps_sampled": 101808, "num_agent_steps_trained": 101808}, "done": false, "episodes_total": 2326, "training_iteration": 114, "trial_id": "fe178_00005", "date": "2024-08-15_19-58-54", "timestamp": 1723773534, "time_this_iter_s": 183.06143975257874, "time_total_s": 10029.301381349564, "pid": 73434, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1519453193226112, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 557.9569249153137, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 21.942911877394636, "ram_util_percent": 11.682375478927199}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.57869542638461, "cur_kl_coeff": 0.5779533758707203, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.765003601710002, "policy_loss": -0.0073383828702693185, "vf_loss": 7.771002930402756, "vf_explained_var": 0.15199973235527675, "kl": 0.002316917631350565, "entropy": -1.4348241512974103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 102834, "num_env_steps_trained": 102834, "num_agent_steps_sampled": 102834, "num_agent_steps_trained": 102834}, "sampler_results": {"episode_reward_max": 359.4925423682279, "episode_reward_min": 117.45587414143137, "episode_reward_mean": 318.63826747428186, "episode_len_mean": 48.55555555555556, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 874, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.7206115637193, 280.03886834437526, 332.1211913625386, 333.1559494093555, 359.41313476562505, 304.01178648623244, 339.63107797901785, 320.62163584167746, 340.31935423787183, 117.45587414143137, 330.9343621421701, 343.2844187686296, 359.4925423682279, 352.5050347808978, 291.61608176310875, 284.46158077656565, 346.6735905609271, 351.0317192447021], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.16619931819827, "mean_inference_ms": 1.2401367804800818, "mean_action_processing_ms": 0.20307302474975586, "mean_env_wait_ms": 512.1496710204337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012079874674479166, "StateBufferConnector_ms": 0.00631411870320638, "ViewRequirementAgentConnector_ms": 0.1653750737508138}, "num_episodes": 18, "episode_return_max": 359.4925423682279, "episode_return_min": 117.45587414143137, "episode_return_mean": 318.63826747428186}, "env_runner_results": {"episode_reward_max": 359.4925423682279, "episode_reward_min": 117.45587414143137, "episode_reward_mean": 318.63826747428186, "episode_len_mean": 48.55555555555556, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 874, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.7206115637193, 280.03886834437526, 332.1211913625386, 333.1559494093555, 359.41313476562505, 304.01178648623244, 339.63107797901785, 320.62163584167746, 340.31935423787183, 117.45587414143137, 330.9343621421701, 343.2844187686296, 359.4925423682279, 352.5050347808978, 291.61608176310875, 284.46158077656565, 346.6735905609271, 351.0317192447021], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.16619931819827, "mean_inference_ms": 1.2401367804800818, "mean_action_processing_ms": 0.20307302474975586, "mean_env_wait_ms": 512.1496710204337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012079874674479166, "StateBufferConnector_ms": 0.00631411870320638, "ViewRequirementAgentConnector_ms": 0.1653750737508138}, "num_episodes": 18, "episode_return_max": 359.4925423682279, "episode_return_min": 117.45587414143137, "episode_return_mean": 318.63826747428186}, "episode_reward_max": 359.4925423682279, "episode_reward_min": 117.45587414143137, "episode_reward_mean": 318.63826747428186, "episode_len_mean": 48.55555555555556, "episodes_this_iter": 18, "episodes_timesteps_total": 874, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [348.7206115637193, 280.03886834437526, 332.1211913625386, 333.1559494093555, 359.41313476562505, 304.01178648623244, 339.63107797901785, 320.62163584167746, 340.31935423787183, 117.45587414143137, 330.9343621421701, 343.2844187686296, 359.4925423682279, 352.5050347808978, 291.61608176310875, 284.46158077656565, 346.6735905609271, 351.0317192447021], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.16619931819827, "mean_inference_ms": 1.2401367804800818, "mean_action_processing_ms": 0.20307302474975586, "mean_env_wait_ms": 512.1496710204337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012079874674479166, "StateBufferConnector_ms": 0.00631411870320638, "ViewRequirementAgentConnector_ms": 0.1653750737508138}, "num_episodes": 18, "episode_return_max": 359.4925423682279, "episode_return_min": 117.45587414143137, "episode_return_mean": 318.63826747428186, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102834, "num_agent_steps_trained": 102834, "num_env_steps_sampled": 102834, "num_env_steps_trained": 102834, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.399272187514008, "num_env_steps_trained_throughput_per_sec": 10.399272187514008, "timesteps_total": 102834, "num_env_steps_sampled_lifetime": 102834, "num_agent_steps_sampled_lifetime": 102834, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 102834, "timers": {"training_iteration_time_ms": 98660.76, "restore_workers_time_ms": 0.016, "training_step_time_ms": 98660.708, "sample_time_ms": 94516.031, "load_time_ms": 0.839, "load_throughput": 1222544.291, "learn_time_ms": 4130.991, "learn_throughput": 248.367, "synch_weights_time_ms": 12.341}, "counters": {"num_env_steps_sampled": 102834, "num_env_steps_trained": 102834, "num_agent_steps_sampled": 102834, "num_agent_steps_trained": 102834}, "done": false, "episodes_total": 2347, "training_iteration": 115, "trial_id": "fe178_00005", "date": "2024-08-15_20-00-51", "timestamp": 1723773651, "time_this_iter_s": 98.66393208503723, "time_total_s": 10114.948449850082, "pid": 32605, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1519453193226112, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 98.66393208503723, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 21.336879432624112, "ram_util_percent": 10.850354609929079}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.213031719128292, "cur_kl_coeff": 0.28897668793536013, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.684532546500365, "policy_loss": -0.008511405356694013, "vf_loss": 6.691730682551861, "vf_explained_var": 0.11124952187140782, "kl": 0.004544551723061471, "entropy": -1.3808451118568579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 103860, "num_env_steps_trained": 103860, "num_agent_steps_sampled": 103860, "num_agent_steps_trained": 103860}, "sampler_results": {"episode_reward_max": 369.56104071979075, "episode_reward_min": 112.13926611468207, "episode_reward_mean": 312.2106983215649, "episode_len_mean": 47.82051282051282, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 1865, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.7206115637193, 280.03886834437526, 332.1211913625386, 333.1559494093555, 359.41313476562505, 304.01178648623244, 339.63107797901785, 320.62163584167746, 340.31935423787183, 117.45587414143137, 330.9343621421701, 343.2844187686296, 359.4925423682279, 352.5050347808978, 291.61608176310875, 284.46158077656565, 346.6735905609271, 351.0317192447021, 338.8679978271613, 293.55913762495953, 271.6944863333393, 294.3523438293609, 275.54655691733024, 112.13926611468207, 351.51433134024086, 337.62841796875045, 283.79083684682973, 338.0583837510192, 342.1061168602245, 325.82625464600767, 320.7914594743236, 338.37439012724155, 352.2389793302717, 355.87552803617075, 369.56104071979075, 334.69121715916987, 348.42296235380815, 116.76938333501874, 338.9193294082536], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.316655572056333, "mean_inference_ms": 1.2400264510454566, "mean_action_processing_ms": 0.20314559564378715, "mean_env_wait_ms": 475.88705810777884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012430777916541466, "StateBufferConnector_ms": 0.006226392892690806, "ViewRequirementAgentConnector_ms": 0.16593321775778747}, "num_episodes": 21, "episode_return_max": 369.56104071979075, "episode_return_min": 112.13926611468207, "episode_return_mean": 312.2106983215649}, "env_runner_results": {"episode_reward_max": 369.56104071979075, "episode_reward_min": 112.13926611468207, "episode_reward_mean": 312.2106983215649, "episode_len_mean": 47.82051282051282, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 1865, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.7206115637193, 280.03886834437526, 332.1211913625386, 333.1559494093555, 359.41313476562505, 304.01178648623244, 339.63107797901785, 320.62163584167746, 340.31935423787183, 117.45587414143137, 330.9343621421701, 343.2844187686296, 359.4925423682279, 352.5050347808978, 291.61608176310875, 284.46158077656565, 346.6735905609271, 351.0317192447021, 338.8679978271613, 293.55913762495953, 271.6944863333393, 294.3523438293609, 275.54655691733024, 112.13926611468207, 351.51433134024086, 337.62841796875045, 283.79083684682973, 338.0583837510192, 342.1061168602245, 325.82625464600767, 320.7914594743236, 338.37439012724155, 352.2389793302717, 355.87552803617075, 369.56104071979075, 334.69121715916987, 348.42296235380815, 116.76938333501874, 338.9193294082536], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.316655572056333, "mean_inference_ms": 1.2400264510454566, "mean_action_processing_ms": 0.20314559564378715, "mean_env_wait_ms": 475.88705810777884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012430777916541466, "StateBufferConnector_ms": 0.006226392892690806, "ViewRequirementAgentConnector_ms": 0.16593321775778747}, "num_episodes": 21, "episode_return_max": 369.56104071979075, "episode_return_min": 112.13926611468207, "episode_return_mean": 312.2106983215649}, "episode_reward_max": 369.56104071979075, "episode_reward_min": 112.13926611468207, "episode_reward_mean": 312.2106983215649, "episode_len_mean": 47.82051282051282, "episodes_this_iter": 21, "episodes_timesteps_total": 1865, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [348.7206115637193, 280.03886834437526, 332.1211913625386, 333.1559494093555, 359.41313476562505, 304.01178648623244, 339.63107797901785, 320.62163584167746, 340.31935423787183, 117.45587414143137, 330.9343621421701, 343.2844187686296, 359.4925423682279, 352.5050347808978, 291.61608176310875, 284.46158077656565, 346.6735905609271, 351.0317192447021, 338.8679978271613, 293.55913762495953, 271.6944863333393, 294.3523438293609, 275.54655691733024, 112.13926611468207, 351.51433134024086, 337.62841796875045, 283.79083684682973, 338.0583837510192, 342.1061168602245, 325.82625464600767, 320.7914594743236, 338.37439012724155, 352.2389793302717, 355.87552803617075, 369.56104071979075, 334.69121715916987, 348.42296235380815, 116.76938333501874, 338.9193294082536], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.316655572056333, "mean_inference_ms": 1.2400264510454566, "mean_action_processing_ms": 0.20314559564378715, "mean_env_wait_ms": 475.88705810777884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012430777916541466, "StateBufferConnector_ms": 0.006226392892690806, "ViewRequirementAgentConnector_ms": 0.16593321775778747}, "num_episodes": 21, "episode_return_max": 369.56104071979075, "episode_return_min": 112.13926611468207, "episode_return_mean": 312.2106983215649, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103860, "num_agent_steps_trained": 103860, "num_env_steps_sampled": 103860, "num_env_steps_trained": 103860, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 12.761093923114828, "num_env_steps_trained_throughput_per_sec": 12.761093923114828, "timesteps_total": 103860, "num_env_steps_sampled_lifetime": 103860, "num_agent_steps_sampled_lifetime": 103860, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 103860, "timers": {"training_iteration_time_ms": 89530.7, "restore_workers_time_ms": 0.016, "training_step_time_ms": 89530.65, "sample_time_ms": 86788.078, "load_time_ms": 0.632, "load_throughput": 1622683.222, "learn_time_ms": 2728.841, "learn_throughput": 375.984, "synch_weights_time_ms": 12.694}, "counters": {"num_env_steps_sampled": 103860, "num_env_steps_trained": 103860, "num_agent_steps_sampled": 103860, "num_agent_steps_trained": 103860}, "done": false, "episodes_total": 2368, "training_iteration": 116, "trial_id": "fe178_00005", "date": "2024-08-15_20-02-11", "timestamp": 1723773731, "time_this_iter_s": 80.40371751785278, "time_total_s": 10195.352167367935, "pid": 32605, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19007650645025967, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1519453193226112, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 179.06764960289001, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.86782608695652, "ram_util_percent": 10.67826086956522}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 105.76829875707627, "cur_kl_coeff": 1.3003950957091206, "cur_lr": 5e-06, "total_loss": 6.6876161540548, "policy_loss": 0.00824259715397299, "vf_loss": 6.530585733056069, "vf_explained_var": 0.08474289029836654, "kl": 0.11441737689262377, "entropy": -1.1851829251895347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 104886, "num_env_steps_trained": 104886, "num_agent_steps_sampled": 104886, "num_agent_steps_trained": 104886}, "sampler_results": {"episode_reward_max": 366.32079829928216, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 314.9668951832458, "episode_len_mean": 48.26315789473684, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 917, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [331.19135214849183, 322.2885858492982, 336.6098035623469, 77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.418464267852111, "mean_inference_ms": 1.2376074983557113, "mean_action_processing_ms": 0.20594973313181023, "mean_env_wait_ms": 466.3159702078073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011799209996273643, "StateBufferConnector_ms": 0.0059240742733604025, "ViewRequirementAgentConnector_ms": 0.16484135075619347}, "num_episodes": 19, "episode_return_max": 366.32079829928216, "episode_return_min": 77.31726074218761, "episode_return_mean": 314.9668951832458}, "env_runner_results": {"episode_reward_max": 366.32079829928216, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 314.9668951832458, "episode_len_mean": 48.26315789473684, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 917, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [331.19135214849183, 322.2885858492982, 336.6098035623469, 77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.418464267852111, "mean_inference_ms": 1.2376074983557113, "mean_action_processing_ms": 0.20594973313181023, "mean_env_wait_ms": 466.3159702078073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011799209996273643, "StateBufferConnector_ms": 0.0059240742733604025, "ViewRequirementAgentConnector_ms": 0.16484135075619347}, "num_episodes": 19, "episode_return_max": 366.32079829928216, "episode_return_min": 77.31726074218761, "episode_return_mean": 314.9668951832458}, "episode_reward_max": 366.32079829928216, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 314.9668951832458, "episode_len_mean": 48.26315789473684, "episodes_this_iter": 19, "episodes_timesteps_total": 917, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [331.19135214849183, 322.2885858492982, 336.6098035623469, 77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.418464267852111, "mean_inference_ms": 1.2376074983557113, "mean_action_processing_ms": 0.20594973313181023, "mean_env_wait_ms": 466.3159702078073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011799209996273643, "StateBufferConnector_ms": 0.0059240742733604025, "ViewRequirementAgentConnector_ms": 0.16484135075619347}, "num_episodes": 19, "episode_return_max": 366.32079829928216, "episode_return_min": 77.31726074218761, "episode_return_mean": 314.9668951832458, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104886, "num_agent_steps_trained": 104886, "num_env_steps_sampled": 104886, "num_env_steps_trained": 104886, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.428845616230847, "num_env_steps_trained_throughput_per_sec": 11.428845616230847, "timesteps_total": 104886, "num_env_steps_sampled_lifetime": 104886, "num_agent_steps_sampled_lifetime": 104886, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 104886, "timers": {"training_iteration_time_ms": 89772.859, "restore_workers_time_ms": 0.021, "training_step_time_ms": 89772.794, "sample_time_ms": 88501.787, "load_time_ms": 0.791, "load_throughput": 1296582.074, "learn_time_ms": 1256.026, "learn_throughput": 816.862, "synch_weights_time_ms": 13.604}, "counters": {"num_env_steps_sampled": 104886, "num_env_steps_trained": 104886, "num_agent_steps_sampled": 104886, "num_agent_steps_trained": 104886}, "done": false, "episodes_total": 2385, "training_iteration": 116, "trial_id": "fe178_00005", "date": "2024-08-15_20-03-59", "timestamp": 1723773839, "time_this_iter_s": 89.77612805366516, "time_total_s": 10295.983934640884, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 89.77612805366516, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 22.114728682170544, "ram_util_percent": 10.732558139534882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.23552924791972, "cur_kl_coeff": 1.950592643563681, "cur_lr": 5e-06, "total_loss": 7.1980419471859935, "policy_loss": -0.00298560713029777, "vf_loss": 7.194496900836627, "vf_explained_var": 0.08207432155807813, "kl": 0.003348013884112421, "entropy": -1.4060496280590693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 105912, "num_env_steps_trained": 105912, "num_agent_steps_sampled": 105912, "num_agent_steps_trained": 105912}, "sampler_results": {"episode_reward_max": 366.32079829928216, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 323.7510266612452, "episode_len_mean": 49.108108108108105, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1817, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [331.19135214849183, 322.2885858492982, 336.6098035623469, 77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587, 321.5374271026993, 331.05532226562536, 272.1886393519104, 342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.344031145820498, "mean_inference_ms": 1.2377465095424038, "mean_action_processing_ms": 0.20586249488492106, "mean_env_wait_ms": 480.74417506813376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012620075328930004, "StateBufferConnector_ms": 0.006006215069745038, "ViewRequirementAgentConnector_ms": 0.16214460939974398}, "num_episodes": 18, "episode_return_max": 366.32079829928216, "episode_return_min": 77.31726074218761, "episode_return_mean": 323.7510266612452}, "env_runner_results": {"episode_reward_max": 366.32079829928216, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 323.7510266612452, "episode_len_mean": 49.108108108108105, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1817, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [331.19135214849183, 322.2885858492982, 336.6098035623469, 77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587, 321.5374271026993, 331.05532226562536, 272.1886393519104, 342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.344031145820498, "mean_inference_ms": 1.2377465095424038, "mean_action_processing_ms": 0.20586249488492106, "mean_env_wait_ms": 480.74417506813376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012620075328930004, "StateBufferConnector_ms": 0.006006215069745038, "ViewRequirementAgentConnector_ms": 0.16214460939974398}, "num_episodes": 18, "episode_return_max": 366.32079829928216, "episode_return_min": 77.31726074218761, "episode_return_mean": 323.7510266612452}, "episode_reward_max": 366.32079829928216, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 323.7510266612452, "episode_len_mean": 49.108108108108105, "episodes_this_iter": 18, "episodes_timesteps_total": 1817, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [331.19135214849183, 322.2885858492982, 336.6098035623469, 77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587, 321.5374271026993, 331.05532226562536, 272.1886393519104, 342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.344031145820498, "mean_inference_ms": 1.2377465095424038, "mean_action_processing_ms": 0.20586249488492106, "mean_env_wait_ms": 480.74417506813376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012620075328930004, "StateBufferConnector_ms": 0.006006215069745038, "ViewRequirementAgentConnector_ms": 0.16214460939974398}, "num_episodes": 18, "episode_return_max": 366.32079829928216, "episode_return_min": 77.31726074218761, "episode_return_mean": 323.7510266612452, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105912, "num_agent_steps_trained": 105912, "num_env_steps_sampled": 105912, "num_env_steps_trained": 105912, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.541127038605207, "num_env_steps_trained_throughput_per_sec": 10.541127038605207, "timesteps_total": 105912, "num_env_steps_sampled_lifetime": 105912, "num_agent_steps_sampled_lifetime": 105912, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 105912, "timers": {"training_iteration_time_ms": 93552.959, "restore_workers_time_ms": 0.021, "training_step_time_ms": 93552.895, "sample_time_ms": 92253.268, "load_time_ms": 0.571, "load_throughput": 1797934.366, "learn_time_ms": 1285.419, "learn_throughput": 798.183, "synch_weights_time_ms": 13.209}, "counters": {"num_env_steps_sampled": 105912, "num_env_steps_trained": 105912, "num_agent_steps_sampled": 105912, "num_agent_steps_trained": 105912}, "done": false, "episodes_total": 2403, "training_iteration": 117, "trial_id": "fe178_00005", "date": "2024-08-15_20-05-36", "timestamp": 1723773936, "time_this_iter_s": 97.33656811714172, "time_total_s": 10393.320502758026, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 187.11269617080688, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 21.131884057971014, "ram_util_percent": 10.842028985507246}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.11242321332296, "cur_kl_coeff": 0.9752963217818404, "cur_lr": 5e-06, "total_loss": 6.386439508199691, "policy_loss": -0.0028237747591144096, "vf_loss": 6.388369021316369, "vf_explained_var": 0.09942770774165789, "kl": 0.0009168596541712759, "entropy": -1.3053330473601819, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 106938, "num_env_steps_trained": 106938, "num_agent_steps_sampled": 106938, "num_agent_steps_trained": 106938}, "sampler_results": {"episode_reward_max": 366.32079829928216, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 325.7102132974413, "episode_len_mean": 49.333333333333336, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 2960, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [331.19135214849183, 322.2885858492982, 336.6098035623469, 77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587, 321.5374271026993, 331.05532226562536, 272.1886393519104, 342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674, 303.29255457152374, 364.30721641143435, 350.53109181690803, 324.57305103854554, 318.02782181839984, 349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.418939232142434, "mean_inference_ms": 1.237313480813853, "mean_action_processing_ms": 0.20594616906585472, "mean_env_wait_ms": 480.5975483064588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01266638437906901, "StateBufferConnector_ms": 0.006109476089477539, "ViewRequirementAgentConnector_ms": 0.16358455022176108}, "num_episodes": 23, "episode_return_max": 366.32079829928216, "episode_return_min": 77.31726074218761, "episode_return_mean": 325.7102132974413}, "env_runner_results": {"episode_reward_max": 366.32079829928216, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 325.7102132974413, "episode_len_mean": 49.333333333333336, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 2960, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [331.19135214849183, 322.2885858492982, 336.6098035623469, 77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587, 321.5374271026993, 331.05532226562536, 272.1886393519104, 342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674, 303.29255457152374, 364.30721641143435, 350.53109181690803, 324.57305103854554, 318.02782181839984, 349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.418939232142434, "mean_inference_ms": 1.237313480813853, "mean_action_processing_ms": 0.20594616906585472, "mean_env_wait_ms": 480.5975483064588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01266638437906901, "StateBufferConnector_ms": 0.006109476089477539, "ViewRequirementAgentConnector_ms": 0.16358455022176108}, "num_episodes": 23, "episode_return_max": 366.32079829928216, "episode_return_min": 77.31726074218761, "episode_return_mean": 325.7102132974413}, "episode_reward_max": 366.32079829928216, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 325.7102132974413, "episode_len_mean": 49.333333333333336, "episodes_this_iter": 23, "episodes_timesteps_total": 2960, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [331.19135214849183, 322.2885858492982, 336.6098035623469, 77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587, 321.5374271026993, 331.05532226562536, 272.1886393519104, 342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674, 303.29255457152374, 364.30721641143435, 350.53109181690803, 324.57305103854554, 318.02782181839984, 349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.418939232142434, "mean_inference_ms": 1.237313480813853, "mean_action_processing_ms": 0.20594616906585472, "mean_env_wait_ms": 480.5975483064588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01266638437906901, "StateBufferConnector_ms": 0.006109476089477539, "ViewRequirementAgentConnector_ms": 0.16358455022176108}, "num_episodes": 23, "episode_return_max": 366.32079829928216, "episode_return_min": 77.31726074218761, "episode_return_mean": 325.7102132974413, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106938, "num_agent_steps_trained": 106938, "num_env_steps_sampled": 106938, "num_env_steps_trained": 106938, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 12.207331494782691, "num_env_steps_trained_throughput_per_sec": 12.207331494782691, "timesteps_total": 106938, "num_env_steps_sampled_lifetime": 106938, "num_agent_steps_sampled_lifetime": 106938, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 106938, "timers": {"training_iteration_time_ms": 90384.595, "restore_workers_time_ms": 0.021, "training_step_time_ms": 90384.533, "sample_time_ms": 89079.035, "load_time_ms": 0.519, "load_throughput": 1978251.258, "learn_time_ms": 1291.389, "learn_throughput": 794.493, "synch_weights_time_ms": 13.203}, "counters": {"num_env_steps_sampled": 106938, "num_env_steps_trained": 106938, "num_agent_steps_sampled": 106938, "num_agent_steps_trained": 106938}, "done": false, "episodes_total": 2426, "training_iteration": 118, "trial_id": "fe178_00005", "date": "2024-08-15_20-07-00", "timestamp": 1723774020, "time_this_iter_s": 84.05139446258545, "time_total_s": 10477.371897220612, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 271.16409063339233, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.749166666666667, "ram_util_percent": 10.580833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.059328615665436, "cur_kl_coeff": 0.4876481608909202, "cur_lr": 5e-06, "total_loss": 5.9311886792381605, "policy_loss": -0.008413077510582904, "vf_loss": 5.9372435584664345, "vf_explained_var": 0.02760250022013982, "kl": 0.004835776354777296, "entropy": -1.1553128304580846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 107964, "num_env_steps_trained": 107964, "num_agent_steps_sampled": 107964, "num_agent_steps_trained": 107964}, "sampler_results": {"episode_reward_max": 366.32079829928216, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 325.52576681463114, "episode_len_mean": 49.49367088607595, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 3910, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [331.19135214849183, 322.2885858492982, 336.6098035623469, 77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587, 321.5374271026993, 331.05532226562536, 272.1886393519104, 342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674, 303.29255457152374, 364.30721641143435, 350.53109181690803, 324.57305103854554, 318.02782181839984, 349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546, 321.53451093567674, 316.28739492030695, 359.4383334134333, 312.7207786484227, 350.95994525469166, 308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.439263832729373, "mean_inference_ms": 1.2373157255698832, "mean_action_processing_ms": 0.2059605718052035, "mean_env_wait_ms": 483.7051390335172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011971027036256429, "StateBufferConnector_ms": 0.006082088132447834, "ViewRequirementAgentConnector_ms": 0.16412614267083664}, "num_episodes": 19, "episode_return_max": 366.32079829928216, "episode_return_min": 77.31726074218761, "episode_return_mean": 325.52576681463114}, "env_runner_results": {"episode_reward_max": 366.32079829928216, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 325.52576681463114, "episode_len_mean": 49.49367088607595, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 3910, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [331.19135214849183, 322.2885858492982, 336.6098035623469, 77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587, 321.5374271026993, 331.05532226562536, 272.1886393519104, 342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674, 303.29255457152374, 364.30721641143435, 350.53109181690803, 324.57305103854554, 318.02782181839984, 349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546, 321.53451093567674, 316.28739492030695, 359.4383334134333, 312.7207786484227, 350.95994525469166, 308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.439263832729373, "mean_inference_ms": 1.2373157255698832, "mean_action_processing_ms": 0.2059605718052035, "mean_env_wait_ms": 483.7051390335172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011971027036256429, "StateBufferConnector_ms": 0.006082088132447834, "ViewRequirementAgentConnector_ms": 0.16412614267083664}, "num_episodes": 19, "episode_return_max": 366.32079829928216, "episode_return_min": 77.31726074218761, "episode_return_mean": 325.52576681463114}, "episode_reward_max": 366.32079829928216, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 325.52576681463114, "episode_len_mean": 49.49367088607595, "episodes_this_iter": 19, "episodes_timesteps_total": 3910, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [331.19135214849183, 322.2885858492982, 336.6098035623469, 77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587, 321.5374271026993, 331.05532226562536, 272.1886393519104, 342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674, 303.29255457152374, 364.30721641143435, 350.53109181690803, 324.57305103854554, 318.02782181839984, 349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546, 321.53451093567674, 316.28739492030695, 359.4383334134333, 312.7207786484227, 350.95994525469166, 308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003], "episode_lengths": [50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.439263832729373, "mean_inference_ms": 1.2373157255698832, "mean_action_processing_ms": 0.2059605718052035, "mean_env_wait_ms": 483.7051390335172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011971027036256429, "StateBufferConnector_ms": 0.006082088132447834, "ViewRequirementAgentConnector_ms": 0.16412614267083664}, "num_episodes": 19, "episode_return_max": 366.32079829928216, "episode_return_min": 77.31726074218761, "episode_return_mean": 325.52576681463114, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107964, "num_agent_steps_trained": 107964, "num_env_steps_sampled": 107964, "num_env_steps_trained": 107964, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.304022822574117, "num_env_steps_trained_throughput_per_sec": 10.304022822574117, "timesteps_total": 107964, "num_env_steps_sampled_lifetime": 107964, "num_agent_steps_sampled_lifetime": 107964, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 107964, "timers": {"training_iteration_time_ms": 92681.639, "restore_workers_time_ms": 0.02, "training_step_time_ms": 92681.579, "sample_time_ms": 91362.07, "load_time_ms": 0.496, "load_throughput": 2068423.89, "learn_time_ms": 1305.508, "learn_throughput": 785.901, "synch_weights_time_ms": 13.138}, "counters": {"num_env_steps_sampled": 107964, "num_env_steps_trained": 107964, "num_agent_steps_sampled": 107964, "num_agent_steps_trained": 107964}, "done": false, "episodes_total": 2445, "training_iteration": 119, "trial_id": "fe178_00005", "date": "2024-08-15_20-08-40", "timestamp": 1723774120, "time_this_iter_s": 99.57619714736938, "time_total_s": 10576.948094367981, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 370.7402877807617, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.25034965034965, "ram_util_percent": 10.670629370629374}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.001221291224162, "cur_kl_coeff": 0.2438240804454601, "cur_lr": 5e-06, "total_loss": 7.172059418757756, "policy_loss": -0.007770278739432494, "vf_loss": 7.179435378313064, "vf_explained_var": 0.041773648311694465, "kl": 0.0016169469841788781, "entropy": -1.3860591009259224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 108990, "num_env_steps_trained": 108990, "num_agent_steps_sampled": 108990, "num_agent_steps_trained": 108990}, "sampler_results": {"episode_reward_max": 366.7356318263297, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 323.8232025632516, "episode_len_mean": 49.06, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 4906, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587, 321.5374271026993, 331.05532226562536, 272.1886393519104, 342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674, 303.29255457152374, 364.30721641143435, 350.53109181690803, 324.57305103854554, 318.02782181839984, 349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546, 321.53451093567674, 316.28739492030695, 359.4383334134333, 312.7207786484227, 350.95994525469166, 308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003, 314.42857051569416, 306.71133019761083, 346.14093143292774, 344.9437407343836, 356.04513890340405, 303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841], "episode_lengths": [17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.461790238765375, "mean_inference_ms": 1.2362487881204733, "mean_action_processing_ms": 0.20588173207585342, "mean_env_wait_ms": 484.2111595458702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011481046676635742, "StateBufferConnector_ms": 0.006057262420654297, "ViewRequirementAgentConnector_ms": 0.1639571189880371}, "num_episodes": 24, "episode_return_max": 366.7356318263297, "episode_return_min": 77.31726074218761, "episode_return_mean": 323.8232025632516}, "env_runner_results": {"episode_reward_max": 366.7356318263297, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 323.8232025632516, "episode_len_mean": 49.06, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 4906, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587, 321.5374271026993, 331.05532226562536, 272.1886393519104, 342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674, 303.29255457152374, 364.30721641143435, 350.53109181690803, 324.57305103854554, 318.02782181839984, 349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546, 321.53451093567674, 316.28739492030695, 359.4383334134333, 312.7207786484227, 350.95994525469166, 308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003, 314.42857051569416, 306.71133019761083, 346.14093143292774, 344.9437407343836, 356.04513890340405, 303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841], "episode_lengths": [17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.461790238765375, "mean_inference_ms": 1.2362487881204733, "mean_action_processing_ms": 0.20588173207585342, "mean_env_wait_ms": 484.2111595458702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011481046676635742, "StateBufferConnector_ms": 0.006057262420654297, "ViewRequirementAgentConnector_ms": 0.1639571189880371}, "num_episodes": 24, "episode_return_max": 366.7356318263297, "episode_return_min": 77.31726074218761, "episode_return_mean": 323.8232025632516}, "episode_reward_max": 366.7356318263297, "episode_reward_min": 77.31726074218761, "episode_reward_mean": 323.8232025632516, "episode_len_mean": 49.06, "episodes_this_iter": 24, "episodes_timesteps_total": 4906, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [77.31726074218761, 332.7041754356843, 307.92572756377905, 324.84564086634066, 339.40120199842823, 320.9448878403073, 310.26076505927625, 349.10178124502215, 324.95359640216145, 337.66503167241905, 341.1910968121951, 262.1914399735884, 366.32079829928216, 363.9443647932143, 326.1263853908883, 309.3871128267587, 321.5374271026993, 331.05532226562536, 272.1886393519104, 342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674, 303.29255457152374, 364.30721641143435, 350.53109181690803, 324.57305103854554, 318.02782181839984, 349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546, 321.53451093567674, 316.28739492030695, 359.4383334134333, 312.7207786484227, 350.95994525469166, 308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003, 314.42857051569416, 306.71133019761083, 346.14093143292774, 344.9437407343836, 356.04513890340405, 303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841], "episode_lengths": [17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.461790238765375, "mean_inference_ms": 1.2362487881204733, "mean_action_processing_ms": 0.20588173207585342, "mean_env_wait_ms": 484.2111595458702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011481046676635742, "StateBufferConnector_ms": 0.006057262420654297, "ViewRequirementAgentConnector_ms": 0.1639571189880371}, "num_episodes": 24, "episode_return_max": 366.7356318263297, "episode_return_min": 77.31726074218761, "episode_return_mean": 323.8232025632516, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108990, "num_agent_steps_trained": 108990, "num_env_steps_sampled": 108990, "num_env_steps_trained": 108990, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.842775904225597, "num_env_steps_trained_throughput_per_sec": 11.842775904225597, "timesteps_total": 108990, "num_env_steps_sampled_lifetime": 108990, "num_agent_steps_sampled_lifetime": 108990, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 108990, "timers": {"training_iteration_time_ms": 91472.333, "restore_workers_time_ms": 0.02, "training_step_time_ms": 91472.273, "sample_time_ms": 90142.332, "load_time_ms": 0.484, "load_throughput": 2118627.365, "learn_time_ms": 1315.978, "learn_throughput": 779.648, "synch_weights_time_ms": 13.126}, "counters": {"num_env_steps_sampled": 108990, "num_env_steps_trained": 108990, "num_agent_steps_sampled": 108990, "num_agent_steps_trained": 108990}, "done": false, "episodes_total": 2469, "training_iteration": 120, "trial_id": "fe178_00005", "date": "2024-08-15_20-10-06", "timestamp": 1723774206, "time_this_iter_s": 86.63847184181213, "time_total_s": 10663.586566209793, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 457.37875962257385, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.188617886178864, "ram_util_percent": 10.63739837398374}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.23051143884659, "cur_kl_coeff": 0.12191204022273006, "cur_lr": 5e-06, "total_loss": 6.878684801856677, "policy_loss": -0.0073032305731127655, "vf_loss": 6.8842678144574165, "vf_explained_var": 0.03167400807142258, "kl": 0.014110332656373221, "entropy": -1.3696122546990712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 110016, "num_env_steps_trained": 110016, "num_agent_steps_sampled": 110016, "num_agent_steps_trained": 110016}, "sampler_results": {"episode_reward_max": 367.7835510621982, "episode_reward_min": 110.00572580884841, "episode_reward_mean": 329.1111745401522, "episode_len_mean": 49.39, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4939, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674, 303.29255457152374, 364.30721641143435, 350.53109181690803, 324.57305103854554, 318.02782181839984, 349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546, 321.53451093567674, 316.28739492030695, 359.4383334134333, 312.7207786484227, 350.95994525469166, 308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003, 314.42857051569416, 306.71133019761083, 346.14093143292774, 344.9437407343836, 356.04513890340405, 303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841, 351.0784667968753, 344.5989159767625, 330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.511615819253117, "mean_inference_ms": 1.2358079811196259, "mean_action_processing_ms": 0.20589914107525492, "mean_env_wait_ms": 490.74243768345485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011126279830932617, "StateBufferConnector_ms": 0.006075620651245117, "ViewRequirementAgentConnector_ms": 0.16457390785217285}, "num_episodes": 19, "episode_return_max": 367.7835510621982, "episode_return_min": 110.00572580884841, "episode_return_mean": 329.1111745401522}, "env_runner_results": {"episode_reward_max": 367.7835510621982, "episode_reward_min": 110.00572580884841, "episode_reward_mean": 329.1111745401522, "episode_len_mean": 49.39, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4939, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674, 303.29255457152374, 364.30721641143435, 350.53109181690803, 324.57305103854554, 318.02782181839984, 349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546, 321.53451093567674, 316.28739492030695, 359.4383334134333, 312.7207786484227, 350.95994525469166, 308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003, 314.42857051569416, 306.71133019761083, 346.14093143292774, 344.9437407343836, 356.04513890340405, 303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841, 351.0784667968753, 344.5989159767625, 330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.511615819253117, "mean_inference_ms": 1.2358079811196259, "mean_action_processing_ms": 0.20589914107525492, "mean_env_wait_ms": 490.74243768345485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011126279830932617, "StateBufferConnector_ms": 0.006075620651245117, "ViewRequirementAgentConnector_ms": 0.16457390785217285}, "num_episodes": 19, "episode_return_max": 367.7835510621982, "episode_return_min": 110.00572580884841, "episode_return_mean": 329.1111745401522}, "episode_reward_max": 367.7835510621982, "episode_reward_min": 110.00572580884841, "episode_reward_mean": 329.1111745401522, "episode_len_mean": 49.39, "episodes_this_iter": 19, "episodes_timesteps_total": 4939, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [342.03762668454914, 297.0611192498531, 358.4331289986459, 311.4597002784922, 321.28746911940493, 349.60660446618647, 345.17841301919475, 340.16883544921916, 329.87204253862325, 357.5553547560528, 341.80626710738954, 339.5273596656379, 327.97744785557984, 342.1201035775026, 365.54411649783674, 303.29255457152374, 364.30721641143435, 350.53109181690803, 324.57305103854554, 318.02782181839984, 349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546, 321.53451093567674, 316.28739492030695, 359.4383334134333, 312.7207786484227, 350.95994525469166, 308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003, 314.42857051569416, 306.71133019761083, 346.14093143292774, 344.9437407343836, 356.04513890340405, 303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841, 351.0784667968753, 344.5989159767625, 330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.511615819253117, "mean_inference_ms": 1.2358079811196259, "mean_action_processing_ms": 0.20589914107525492, "mean_env_wait_ms": 490.74243768345485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011126279830932617, "StateBufferConnector_ms": 0.006075620651245117, "ViewRequirementAgentConnector_ms": 0.16457390785217285}, "num_episodes": 19, "episode_return_max": 367.7835510621982, "episode_return_min": 110.00572580884841, "episode_return_mean": 329.1111745401522, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110016, "num_agent_steps_trained": 110016, "num_env_steps_sampled": 110016, "num_env_steps_trained": 110016, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 8.994668744969083, "num_env_steps_trained_throughput_per_sec": 8.994668744969083, "timesteps_total": 110016, "num_env_steps_sampled_lifetime": 110016, "num_agent_steps_sampled_lifetime": 110016, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 110016, "timers": {"training_iteration_time_ms": 95238.208, "restore_workers_time_ms": 0.02, "training_step_time_ms": 95238.149, "sample_time_ms": 93908.293, "load_time_ms": 0.476, "load_throughput": 2155809.921, "learn_time_ms": 1315.801, "learn_throughput": 779.753, "synch_weights_time_ms": 13.231}, "counters": {"num_env_steps_sampled": 110016, "num_env_steps_trained": 110016, "num_agent_steps_sampled": 110016, "num_agent_steps_trained": 110016}, "done": false, "episodes_total": 2488, "training_iteration": 121, "trial_id": "fe178_00005", "date": "2024-08-15_20-12-00", "timestamp": 1723774320, "time_this_iter_s": 114.07130599021912, "time_total_s": 10777.657872200012, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 571.450065612793, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.876073619631903, "ram_util_percent": 10.81717791411043}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.47087214390437, "cur_kl_coeff": 0.12191204022273006, "cur_lr": 5e-06, "total_loss": 6.758277360101541, "policy_loss": -0.006974035452973718, "vf_loss": 6.764671372373899, "vf_explained_var": 0.05065345366795858, "kl": 0.00475778896798376, "entropy": -1.307194149742524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 111042, "num_env_steps_trained": 111042, "num_agent_steps_sampled": 111042, "num_agent_steps_trained": 111042}, "sampler_results": {"episode_reward_max": 367.7835510621982, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 324.77356229529414, "episode_len_mean": 49.06, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4906, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546, 321.53451093567674, 316.28739492030695, 359.4383334134333, 312.7207786484227, 350.95994525469166, 308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003, 314.42857051569416, 306.71133019761083, 346.14093143292774, 344.9437407343836, 356.04513890340405, 303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841, 351.0784667968753, 344.5989159767625, 330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063, 298.50070430287167, 353.08104566858566, 331.1850918164001, 342.63015093894177, 280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.573201658695167, "mean_inference_ms": 1.2346851985648983, "mean_action_processing_ms": 0.20591710106485178, "mean_env_wait_ms": 491.7528933954416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01037454605102539, "StateBufferConnector_ms": 0.006052732467651367, "ViewRequirementAgentConnector_ms": 0.1651451587677002}, "num_episodes": 20, "episode_return_max": 367.7835510621982, "episode_return_min": 79.73502148114795, "episode_return_mean": 324.77356229529414}, "env_runner_results": {"episode_reward_max": 367.7835510621982, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 324.77356229529414, "episode_len_mean": 49.06, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4906, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546, 321.53451093567674, 316.28739492030695, 359.4383334134333, 312.7207786484227, 350.95994525469166, 308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003, 314.42857051569416, 306.71133019761083, 346.14093143292774, 344.9437407343836, 356.04513890340405, 303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841, 351.0784667968753, 344.5989159767625, 330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063, 298.50070430287167, 353.08104566858566, 331.1850918164001, 342.63015093894177, 280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.573201658695167, "mean_inference_ms": 1.2346851985648983, "mean_action_processing_ms": 0.20591710106485178, "mean_env_wait_ms": 491.7528933954416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01037454605102539, "StateBufferConnector_ms": 0.006052732467651367, "ViewRequirementAgentConnector_ms": 0.1651451587677002}, "num_episodes": 20, "episode_return_max": 367.7835510621982, "episode_return_min": 79.73502148114795, "episode_return_mean": 324.77356229529414}, "episode_reward_max": 367.7835510621982, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 324.77356229529414, "episode_len_mean": 49.06, "episodes_this_iter": 20, "episodes_timesteps_total": 4906, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [349.33029249623627, 351.8012077910221, 346.5317616193516, 337.9848181796835, 316.94697938142383, 337.6570097953802, 348.08538529315064, 322.79562248370473, 318.82043015796773, 341.73458435965887, 343.5155330052294, 354.7743736249253, 190.4090332031252, 326.0550099236447, 332.64554834146776, 334.60720426139835, 345.4481128372218, 303.95016896900546, 321.53451093567674, 316.28739492030695, 359.4383334134333, 312.7207786484227, 350.95994525469166, 308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003, 314.42857051569416, 306.71133019761083, 346.14093143292774, 344.9437407343836, 356.04513890340405, 303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841, 351.0784667968753, 344.5989159767625, 330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063, 298.50070430287167, 353.08104566858566, 331.1850918164001, 342.63015093894177, 280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.573201658695167, "mean_inference_ms": 1.2346851985648983, "mean_action_processing_ms": 0.20591710106485178, "mean_env_wait_ms": 491.7528933954416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01037454605102539, "StateBufferConnector_ms": 0.006052732467651367, "ViewRequirementAgentConnector_ms": 0.1651451587677002}, "num_episodes": 20, "episode_return_max": 367.7835510621982, "episode_return_min": 79.73502148114795, "episode_return_mean": 324.77356229529414, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111042, "num_agent_steps_trained": 111042, "num_env_steps_sampled": 111042, "num_env_steps_trained": 111042, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 12.177434928659023, "num_env_steps_trained_throughput_per_sec": 12.177434928659023, "timesteps_total": 111042, "num_env_steps_sampled_lifetime": 111042, "num_agent_steps_sampled_lifetime": 111042, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 111042, "timers": {"training_iteration_time_ms": 93669.066, "restore_workers_time_ms": 0.02, "training_step_time_ms": 93669.007, "sample_time_ms": 92361.525, "load_time_ms": 0.463, "load_throughput": 2217081.867, "learn_time_ms": 1293.568, "learn_throughput": 793.155, "synch_weights_time_ms": 13.121}, "counters": {"num_env_steps_sampled": 111042, "num_env_steps_trained": 111042, "num_agent_steps_sampled": 111042, "num_agent_steps_trained": 111042}, "done": false, "episodes_total": 2508, "training_iteration": 122, "trial_id": "fe178_00005", "date": "2024-08-15_20-13-25", "timestamp": 1723774405, "time_this_iter_s": 84.25766706466675, "time_total_s": 10861.915539264679, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 655.7077326774597, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.522314049586775, "ram_util_percent": 10.92727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.54594962994258, "cur_kl_coeff": 0.06095602011136503, "cur_lr": 5e-06, "total_loss": 6.779791498680909, "policy_loss": -0.010325937283535798, "vf_loss": 6.789056685566902, "vf_explained_var": 0.03108251690864563, "kl": 0.017401421083743703, "entropy": -1.3324751789371172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 112068, "num_env_steps_trained": 112068, "num_agent_steps_sampled": 112068, "num_agent_steps_trained": 112068}, "sampler_results": {"episode_reward_max": 372.7862760205635, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 324.9844390182052, "episode_len_mean": 49.13, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 4913, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003, 314.42857051569416, 306.71133019761083, 346.14093143292774, 344.9437407343836, 356.04513890340405, 303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841, 351.0784667968753, 344.5989159767625, 330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063, 298.50070430287167, 353.08104566858566, 331.1850918164001, 342.63015093894177, 280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618, 338.82788960635094, 313.3257541793216, 331.7470157244266, 343.19495090433935, 319.8563777970759, 372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.587206372702489, "mean_inference_ms": 1.2339088882183533, "mean_action_processing_ms": 0.2058376709341056, "mean_env_wait_ms": 493.6177338550011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009739398956298828, "StateBufferConnector_ms": 0.0060482025146484375, "ViewRequirementAgentConnector_ms": 0.1652541160583496}, "num_episodes": 23, "episode_return_max": 372.7862760205635, "episode_return_min": 79.73502148114795, "episode_return_mean": 324.9844390182052}, "env_runner_results": {"episode_reward_max": 372.7862760205635, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 324.9844390182052, "episode_len_mean": 49.13, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 4913, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003, 314.42857051569416, 306.71133019761083, 346.14093143292774, 344.9437407343836, 356.04513890340405, 303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841, 351.0784667968753, 344.5989159767625, 330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063, 298.50070430287167, 353.08104566858566, 331.1850918164001, 342.63015093894177, 280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618, 338.82788960635094, 313.3257541793216, 331.7470157244266, 343.19495090433935, 319.8563777970759, 372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.587206372702489, "mean_inference_ms": 1.2339088882183533, "mean_action_processing_ms": 0.2058376709341056, "mean_env_wait_ms": 493.6177338550011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009739398956298828, "StateBufferConnector_ms": 0.0060482025146484375, "ViewRequirementAgentConnector_ms": 0.1652541160583496}, "num_episodes": 23, "episode_return_max": 372.7862760205635, "episode_return_min": 79.73502148114795, "episode_return_mean": 324.9844390182052}, "episode_reward_max": 372.7862760205635, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 324.9844390182052, "episode_len_mean": 49.13, "episodes_this_iter": 23, "episodes_timesteps_total": 4913, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [308.05502583632745, 348.89885856399155, 279.69604690776214, 319.77296574130844, 324.26590557751445, 323.19323550455834, 329.8185325848167, 325.5899118414514, 326.32829183630326, 335.7097397541425, 352.72738037109343, 317.04475406385944, 307.8823133073118, 313.9988554464003, 314.42857051569416, 306.71133019761083, 346.14093143292774, 344.9437407343836, 356.04513890340405, 303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841, 351.0784667968753, 344.5989159767625, 330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063, 298.50070430287167, 353.08104566858566, 331.1850918164001, 342.63015093894177, 280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618, 338.82788960635094, 313.3257541793216, 331.7470157244266, 343.19495090433935, 319.8563777970759, 372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.587206372702489, "mean_inference_ms": 1.2339088882183533, "mean_action_processing_ms": 0.2058376709341056, "mean_env_wait_ms": 493.6177338550011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009739398956298828, "StateBufferConnector_ms": 0.0060482025146484375, "ViewRequirementAgentConnector_ms": 0.1652541160583496}, "num_episodes": 23, "episode_return_max": 372.7862760205635, "episode_return_min": 79.73502148114795, "episode_return_mean": 324.9844390182052, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112068, "num_agent_steps_trained": 112068, "num_env_steps_sampled": 112068, "num_env_steps_trained": 112068, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.37901997171737, "num_env_steps_trained_throughput_per_sec": 11.37901997171737, "timesteps_total": 112068, "num_env_steps_sampled_lifetime": 112068, "num_agent_steps_sampled_lifetime": 112068, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 112068, "timers": {"training_iteration_time_ms": 93231.176, "restore_workers_time_ms": 0.02, "training_step_time_ms": 93231.119, "sample_time_ms": 91917.257, "load_time_ms": 0.46, "load_throughput": 2228274.902, "learn_time_ms": 1299.956, "learn_throughput": 789.257, "synch_weights_time_ms": 13.117}, "counters": {"num_env_steps_sampled": 112068, "num_env_steps_trained": 112068, "num_agent_steps_sampled": 112068, "num_agent_steps_trained": 112068}, "done": false, "episodes_total": 2531, "training_iteration": 123, "trial_id": "fe178_00005", "date": "2024-08-15_20-14-55", "timestamp": 1723774495, "time_this_iter_s": 90.16939759254456, "time_total_s": 10952.084936857224, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 745.8771302700043, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.046875, "ram_util_percent": 11.0203125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.63648356993993, "cur_kl_coeff": 0.06095602011136503, "cur_lr": 5e-06, "total_loss": 7.2176664272944135, "policy_loss": -0.00637759828241542, "vf_loss": 7.223636437455813, "vf_explained_var": 0.04508602544665337, "kl": 0.006687961778396799, "entropy": -1.5103542777399221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2040.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 113094, "num_env_steps_trained": 113094, "num_agent_steps_sampled": 113094, "num_agent_steps_trained": 113094}, "sampler_results": {"episode_reward_max": 372.7862760205635, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 325.44662542604016, "episode_len_mean": 48.9, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4890, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841, 351.0784667968753, 344.5989159767625, 330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063, 298.50070430287167, 353.08104566858566, 331.1850918164001, 342.63015093894177, 280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618, 338.82788960635094, 313.3257541793216, 331.7470157244266, 343.19495090433935, 319.8563777970759, 372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345, 307.8193937410848, 356.10768290768505, 345.3602105373938, 354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.607142550272511, "mean_inference_ms": 1.233278512792429, "mean_action_processing_ms": 0.20588486485597093, "mean_env_wait_ms": 492.99210483492095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00975942611694336, "StateBufferConnector_ms": 0.0060617923736572266, "ViewRequirementAgentConnector_ms": 0.16614651679992676}, "num_episodes": 19, "episode_return_max": 372.7862760205635, "episode_return_min": 79.73502148114795, "episode_return_mean": 325.44662542604016}, "env_runner_results": {"episode_reward_max": 372.7862760205635, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 325.44662542604016, "episode_len_mean": 48.9, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4890, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841, 351.0784667968753, 344.5989159767625, 330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063, 298.50070430287167, 353.08104566858566, 331.1850918164001, 342.63015093894177, 280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618, 338.82788960635094, 313.3257541793216, 331.7470157244266, 343.19495090433935, 319.8563777970759, 372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345, 307.8193937410848, 356.10768290768505, 345.3602105373938, 354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.607142550272511, "mean_inference_ms": 1.233278512792429, "mean_action_processing_ms": 0.20588486485597093, "mean_env_wait_ms": 492.99210483492095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00975942611694336, "StateBufferConnector_ms": 0.0060617923736572266, "ViewRequirementAgentConnector_ms": 0.16614651679992676}, "num_episodes": 19, "episode_return_max": 372.7862760205635, "episode_return_min": 79.73502148114795, "episode_return_mean": 325.44662542604016}, "episode_reward_max": 372.7862760205635, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 325.44662542604016, "episode_len_mean": 48.9, "episodes_this_iter": 19, "episodes_timesteps_total": 4890, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [303.89347503902275, 320.8571306272359, 338.92044900567674, 310.82798674309856, 325.553585211725, 357.38153894360266, 330.8751790953416, 344.8260281514274, 352.2350952710201, 340.14253599018724, 343.5112946372812, 334.3213748333867, 366.7356318263297, 316.8254620919441, 348.3148322511515, 133.86865836695506, 347.6648282435329, 360.8438956076535, 110.00572580884841, 351.0784667968753, 344.5989159767625, 330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063, 298.50070430287167, 353.08104566858566, 331.1850918164001, 342.63015093894177, 280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618, 338.82788960635094, 313.3257541793216, 331.7470157244266, 343.19495090433935, 319.8563777970759, 372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345, 307.8193937410848, 356.10768290768505, 345.3602105373938, 354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.607142550272511, "mean_inference_ms": 1.233278512792429, "mean_action_processing_ms": 0.20588486485597093, "mean_env_wait_ms": 492.99210483492095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00975942611694336, "StateBufferConnector_ms": 0.0060617923736572266, "ViewRequirementAgentConnector_ms": 0.16614651679992676}, "num_episodes": 19, "episode_return_max": 372.7862760205635, "episode_return_min": 79.73502148114795, "episode_return_mean": 325.44662542604016, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113094, "num_agent_steps_trained": 113094, "num_env_steps_sampled": 113094, "num_env_steps_trained": 113094, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 12.056037937266806, "num_env_steps_trained_throughput_per_sec": 12.056037937266806, "timesteps_total": 113094, "num_env_steps_sampled_lifetime": 113094, "num_agent_steps_sampled_lifetime": 113094, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 113094, "timers": {"training_iteration_time_ms": 92328.001, "restore_workers_time_ms": 0.019, "training_step_time_ms": 92327.946, "sample_time_ms": 91026.499, "load_time_ms": 0.454, "load_throughput": 2261353.602, "learn_time_ms": 1287.589, "learn_throughput": 796.838, "synch_weights_time_ms": 13.082}, "counters": {"num_env_steps_sampled": 113094, "num_env_steps_trained": 113094, "num_agent_steps_sampled": 113094, "num_agent_steps_trained": 113094}, "done": false, "episodes_total": 2550, "training_iteration": 124, "trial_id": "fe178_00005", "date": "2024-08-15_20-16-20", "timestamp": 1723774580, "time_this_iter_s": 85.10591840744019, "time_total_s": 11037.190855264664, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 830.9830486774445, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.75245901639344, "ram_util_percent": 10.783606557377047}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.029551327228546, "cur_kl_coeff": 0.06095602011136503, "cur_lr": 5e-06, "total_loss": 7.204534667730331, "policy_loss": -0.0022330027616893253, "vf_loss": 7.205820253491401, "vf_explained_var": 0.024393669267495473, "kl": 0.015542160817617971, "entropy": -1.5769834364453952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2280.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 114120, "num_env_steps_trained": 114120, "num_agent_steps_sampled": 114120, "num_agent_steps_trained": 114120}, "sampler_results": {"episode_reward_max": 372.7862760205635, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 330.46586556728505, "episode_len_mean": 49.44, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4944, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063, 298.50070430287167, 353.08104566858566, 331.1850918164001, 342.63015093894177, 280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618, 338.82788960635094, 313.3257541793216, 331.7470157244266, 343.19495090433935, 319.8563777970759, 372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345, 307.8193937410848, 356.10768290768505, 345.3602105373938, 354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269, 328.7860655338855, 363.00557870711407, 323.450924464153, 352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.595487844311651, "mean_inference_ms": 1.2331074603219279, "mean_action_processing_ms": 0.20587180835133526, "mean_env_wait_ms": 493.4050419612103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009787559509277344, "StateBufferConnector_ms": 0.006068706512451172, "ViewRequirementAgentConnector_ms": 0.16678500175476074}, "num_episodes": 21, "episode_return_max": 372.7862760205635, "episode_return_min": 79.73502148114795, "episode_return_mean": 330.46586556728505}, "env_runner_results": {"episode_reward_max": 372.7862760205635, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 330.46586556728505, "episode_len_mean": 49.44, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4944, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063, 298.50070430287167, 353.08104566858566, 331.1850918164001, 342.63015093894177, 280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618, 338.82788960635094, 313.3257541793216, 331.7470157244266, 343.19495090433935, 319.8563777970759, 372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345, 307.8193937410848, 356.10768290768505, 345.3602105373938, 354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269, 328.7860655338855, 363.00557870711407, 323.450924464153, 352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.595487844311651, "mean_inference_ms": 1.2331074603219279, "mean_action_processing_ms": 0.20587180835133526, "mean_env_wait_ms": 493.4050419612103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009787559509277344, "StateBufferConnector_ms": 0.006068706512451172, "ViewRequirementAgentConnector_ms": 0.16678500175476074}, "num_episodes": 21, "episode_return_max": 372.7862760205635, "episode_return_min": 79.73502148114795, "episode_return_mean": 330.46586556728505}, "episode_reward_max": 372.7862760205635, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 330.46586556728505, "episode_len_mean": 49.44, "episodes_this_iter": 21, "episodes_timesteps_total": 4944, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.786785118712, 325.8380573230483, 321.7538414641548, 351.2382693769119, 325.0370742244944, 334.3758895665625, 329.3355403489892, 345.38063725722003, 367.7835510621982, 347.88749900291253, 305.94164586207665, 352.3943336555228, 315.0528122397366, 343.184346577114, 355.04198114229723, 349.2433558938507, 351.90685044239063, 298.50070430287167, 353.08104566858566, 331.1850918164001, 342.63015093894177, 280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618, 338.82788960635094, 313.3257541793216, 331.7470157244266, 343.19495090433935, 319.8563777970759, 372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345, 307.8193937410848, 356.10768290768505, 345.3602105373938, 354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269, 328.7860655338855, 363.00557870711407, 323.450924464153, 352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.595487844311651, "mean_inference_ms": 1.2331074603219279, "mean_action_processing_ms": 0.20587180835133526, "mean_env_wait_ms": 493.4050419612103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009787559509277344, "StateBufferConnector_ms": 0.006068706512451172, "ViewRequirementAgentConnector_ms": 0.16678500175476074}, "num_episodes": 21, "episode_return_max": 372.7862760205635, "episode_return_min": 79.73502148114795, "episode_return_mean": 330.46586556728505, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114120, "num_agent_steps_trained": 114120, "num_env_steps_sampled": 114120, "num_env_steps_trained": 114120, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.140968432348078, "num_env_steps_trained_throughput_per_sec": 10.140968432348078, "timesteps_total": 114120, "num_env_steps_sampled_lifetime": 114120, "num_agent_steps_sampled_lifetime": 114120, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 114120, "timers": {"training_iteration_time_ms": 93212.579, "restore_workers_time_ms": 0.018, "training_step_time_ms": 93212.525, "sample_time_ms": 91903.911, "load_time_ms": 0.445, "load_throughput": 2306563.705, "learn_time_ms": 1294.75, "learn_throughput": 792.431, "synch_weights_time_ms": 13.099}, "counters": {"num_env_steps_sampled": 114120, "num_env_steps_trained": 114120, "num_agent_steps_sampled": 114120, "num_agent_steps_trained": 114120}, "done": false, "episodes_total": 2571, "training_iteration": 125, "trial_id": "fe178_00005", "date": "2024-08-15_20-18-01", "timestamp": 1723774681, "time_this_iter_s": 101.17765283584595, "time_total_s": 11138.36850810051, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 932.1607015132904, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 21.475, "ram_util_percent": 10.69236111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.68158346811931, "cur_kl_coeff": 0.06095602011136503, "cur_lr": 5e-06, "total_loss": 6.496369248131911, "policy_loss": -0.005985198915004731, "vf_loss": 6.501451056202253, "vf_explained_var": 0.03430718456705411, "kl": 0.014820164135018977, "entropy": -1.418453604976336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2520.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 115146, "num_env_steps_trained": 115146, "num_agent_steps_sampled": 115146, "num_agent_steps_trained": 115146}, "sampler_results": {"episode_reward_max": 372.7862760205635, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 330.34206284617534, "episode_len_mean": 49.44, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4944, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618, 338.82788960635094, 313.3257541793216, 331.7470157244266, 343.19495090433935, 319.8563777970759, 372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345, 307.8193937410848, 356.10768290768505, 345.3602105373938, 354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269, 328.7860655338855, 363.00557870711407, 323.450924464153, 352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256, 350.40023330565595, 347.4604936976461, 358.24477647712314, 324.6849070015628, 351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.601029413733895, "mean_inference_ms": 1.2320680509160664, "mean_action_processing_ms": 0.20586421143004288, "mean_env_wait_ms": 491.2779444463054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010257244110107422, "StateBufferConnector_ms": 0.0060579776763916016, "ViewRequirementAgentConnector_ms": 0.16699647903442383}, "num_episodes": 21, "episode_return_max": 372.7862760205635, "episode_return_min": 79.73502148114795, "episode_return_mean": 330.34206284617534}, "env_runner_results": {"episode_reward_max": 372.7862760205635, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 330.34206284617534, "episode_len_mean": 49.44, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4944, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618, 338.82788960635094, 313.3257541793216, 331.7470157244266, 343.19495090433935, 319.8563777970759, 372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345, 307.8193937410848, 356.10768290768505, 345.3602105373938, 354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269, 328.7860655338855, 363.00557870711407, 323.450924464153, 352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256, 350.40023330565595, 347.4604936976461, 358.24477647712314, 324.6849070015628, 351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.601029413733895, "mean_inference_ms": 1.2320680509160664, "mean_action_processing_ms": 0.20586421143004288, "mean_env_wait_ms": 491.2779444463054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010257244110107422, "StateBufferConnector_ms": 0.0060579776763916016, "ViewRequirementAgentConnector_ms": 0.16699647903442383}, "num_episodes": 21, "episode_return_max": 372.7862760205635, "episode_return_min": 79.73502148114795, "episode_return_mean": 330.34206284617534}, "episode_reward_max": 372.7862760205635, "episode_reward_min": 79.73502148114795, "episode_reward_mean": 330.34206284617534, "episode_len_mean": 49.44, "episodes_this_iter": 21, "episodes_timesteps_total": 4944, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [280.3214817116099, 323.5123612037375, 309.094688622261, 344.8284756501258, 324.4344718105198, 338.0018188383978, 347.5863580918667, 341.6619749506212, 288.14963943636525, 344.2287966201428, 356.1473292731082, 292.7790452995625, 339.9426962821477, 79.73502148114795, 364.55140267229604, 296.2335457644618, 338.82788960635094, 313.3257541793216, 331.7470157244266, 343.19495090433935, 319.8563777970759, 372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345, 307.8193937410848, 356.10768290768505, 345.3602105373938, 354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269, 328.7860655338855, 363.00557870711407, 323.450924464153, 352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256, 350.40023330565595, 347.4604936976461, 358.24477647712314, 324.6849070015628, 351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.601029413733895, "mean_inference_ms": 1.2320680509160664, "mean_action_processing_ms": 0.20586421143004288, "mean_env_wait_ms": 491.2779444463054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010257244110107422, "StateBufferConnector_ms": 0.0060579776763916016, "ViewRequirementAgentConnector_ms": 0.16699647903442383}, "num_episodes": 21, "episode_return_max": 372.7862760205635, "episode_return_min": 79.73502148114795, "episode_return_mean": 330.34206284617534, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115146, "num_agent_steps_trained": 115146, "num_env_steps_sampled": 115146, "num_env_steps_trained": 115146, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.808663610662412, "num_env_steps_trained_throughput_per_sec": 10.808663610662412, "timesteps_total": 115146, "num_env_steps_sampled_lifetime": 115146, "num_agent_steps_sampled_lifetime": 115146, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 115146, "timers": {"training_iteration_time_ms": 93727.679, "restore_workers_time_ms": 0.017, "training_step_time_ms": 93727.629, "sample_time_ms": 92409.847, "load_time_ms": 0.404, "load_throughput": 2536757.784, "learn_time_ms": 1304.01, "learn_throughput": 786.804, "synch_weights_time_ms": 13.075}, "counters": {"num_env_steps_sampled": 115146, "num_env_steps_trained": 115146, "num_agent_steps_sampled": 115146, "num_agent_steps_trained": 115146}, "done": false, "episodes_total": 2592, "training_iteration": 126, "trial_id": "fe178_00005", "date": "2024-08-15_20-19-36", "timestamp": 1723774776, "time_this_iter_s": 94.92758560180664, "time_total_s": 11233.296093702316, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1027.088287115097, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 21.62573529411765, "ram_util_percent": 10.856617647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.130341947078705, "cur_kl_coeff": 0.06095602011136503, "cur_lr": 5e-06, "total_loss": 6.815895159045855, "policy_loss": 0.0038562294522610802, "vf_loss": 6.810016329089801, "vf_explained_var": 0.02245359495282173, "kl": 0.03318179031824468, "entropy": -1.5233078305919965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2760.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 116172, "num_env_steps_trained": 116172, "num_agent_steps_sampled": 116172, "num_agent_steps_trained": 116172}, "sampler_results": {"episode_reward_max": 372.7862760205635, "episode_reward_min": 140.42823570556715, "episode_reward_mean": 333.5570509324184, "episode_len_mean": 49.77, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4977, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345, 307.8193937410848, 356.10768290768505, 345.3602105373938, 354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269, 328.7860655338855, 363.00557870711407, 323.450924464153, 352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256, 350.40023330565595, 347.4604936976461, 358.24477647712314, 324.6849070015628, 351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587, 323.0145960490542, 364.12855599465337, 291.2154443639173, 323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.601897584033227, "mean_inference_ms": 1.2316205581982091, "mean_action_processing_ms": 0.20581640554409708, "mean_env_wait_ms": 489.71737700593343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010418891906738281, "StateBufferConnector_ms": 0.006075859069824219, "ViewRequirementAgentConnector_ms": 0.1673736572265625}, "num_episodes": 21, "episode_return_max": 372.7862760205635, "episode_return_min": 140.42823570556715, "episode_return_mean": 333.5570509324184}, "env_runner_results": {"episode_reward_max": 372.7862760205635, "episode_reward_min": 140.42823570556715, "episode_reward_mean": 333.5570509324184, "episode_len_mean": 49.77, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4977, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345, 307.8193937410848, 356.10768290768505, 345.3602105373938, 354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269, 328.7860655338855, 363.00557870711407, 323.450924464153, 352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256, 350.40023330565595, 347.4604936976461, 358.24477647712314, 324.6849070015628, 351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587, 323.0145960490542, 364.12855599465337, 291.2154443639173, 323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.601897584033227, "mean_inference_ms": 1.2316205581982091, "mean_action_processing_ms": 0.20581640554409708, "mean_env_wait_ms": 489.71737700593343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010418891906738281, "StateBufferConnector_ms": 0.006075859069824219, "ViewRequirementAgentConnector_ms": 0.1673736572265625}, "num_episodes": 21, "episode_return_max": 372.7862760205635, "episode_return_min": 140.42823570556715, "episode_return_mean": 333.5570509324184}, "episode_reward_max": 372.7862760205635, "episode_reward_min": 140.42823570556715, "episode_reward_mean": 333.5570509324184, "episode_len_mean": 49.77, "episodes_this_iter": 21, "episodes_timesteps_total": 4977, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [372.7862760205635, 265.6167825861375, 288.5121277384194, 317.9453704146876, 322.38711405930223, 350.8880732945298, 298.9297613979066, 345.85127120109223, 344.4953556529492, 305.74094553913625, 346.79896144119107, 315.07061882515774, 349.411091834191, 365.9366573090486, 334.8975605321194, 339.7910081315678, 319.20718979383236, 353.90355720388345, 307.8193937410848, 356.10768290768505, 345.3602105373938, 354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269, 328.7860655338855, 363.00557870711407, 323.450924464153, 352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256, 350.40023330565595, 347.4604936976461, 358.24477647712314, 324.6849070015628, 351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587, 323.0145960490542, 364.12855599465337, 291.2154443639173, 323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.601897584033227, "mean_inference_ms": 1.2316205581982091, "mean_action_processing_ms": 0.20581640554409708, "mean_env_wait_ms": 489.71737700593343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010418891906738281, "StateBufferConnector_ms": 0.006075859069824219, "ViewRequirementAgentConnector_ms": 0.1673736572265625}, "num_episodes": 21, "episode_return_max": 372.7862760205635, "episode_return_min": 140.42823570556715, "episode_return_mean": 333.5570509324184, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116172, "num_agent_steps_trained": 116172, "num_env_steps_sampled": 116172, "num_env_steps_trained": 116172, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 12.220548405867024, "num_env_steps_trained_throughput_per_sec": 12.220548405867024, "timesteps_total": 116172, "num_env_steps_sampled_lifetime": 116172, "num_agent_steps_sampled_lifetime": 116172, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 116172, "timers": {"training_iteration_time_ms": 92390.07, "restore_workers_time_ms": 0.017, "training_step_time_ms": 92390.021, "sample_time_ms": 91070.441, "load_time_ms": 0.41, "load_throughput": 2501514.796, "learn_time_ms": 1305.843, "learn_throughput": 785.699, "synch_weights_time_ms": 13.036}, "counters": {"num_env_steps_sampled": 116172, "num_env_steps_trained": 116172, "num_agent_steps_sampled": 116172, "num_agent_steps_trained": 116172}, "done": false, "episodes_total": 2613, "training_iteration": 127, "trial_id": "fe178_00005", "date": "2024-08-15_20-21-00", "timestamp": 1723774860, "time_this_iter_s": 83.96072173118591, "time_total_s": 11317.256815433502, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1111.049008846283, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.471666666666668, "ram_util_percent": 10.968333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.29859881401062, "cur_kl_coeff": 0.09143403016704754, "cur_lr": 5e-06, "total_loss": 7.62733650902907, "policy_loss": -0.0017613639589399098, "vf_loss": 7.626571504275004, "vf_explained_var": 0.03411421825488408, "kl": 0.027629909285681414, "entropy": -1.6214875680704912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3000.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 117198, "num_env_steps_trained": 117198, "num_agent_steps_sampled": 117198, "num_agent_steps_trained": 117198}, "sampler_results": {"episode_reward_max": 371.6138475774663, "episode_reward_min": 140.42823570556715, "episode_reward_mean": 335.47139833047294, "episode_len_mean": 49.77, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4977, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269, 328.7860655338855, 363.00557870711407, 323.450924464153, 352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256, 350.40023330565595, 347.4604936976461, 358.24477647712314, 324.6849070015628, 351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587, 323.0145960490542, 364.12855599465337, 291.2154443639173, 323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117, 370.28284709440925, 341.0762106950045, 348.825513056813, 332.30037746493457, 312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.601883860347956, "mean_inference_ms": 1.2314779228234927, "mean_action_processing_ms": 0.2058639607561882, "mean_env_wait_ms": 489.7489436379344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01060342788696289, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.16696405410766602}, "num_episodes": 21, "episode_return_max": 371.6138475774663, "episode_return_min": 140.42823570556715, "episode_return_mean": 335.47139833047294}, "env_runner_results": {"episode_reward_max": 371.6138475774663, "episode_reward_min": 140.42823570556715, "episode_reward_mean": 335.47139833047294, "episode_len_mean": 49.77, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4977, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269, 328.7860655338855, 363.00557870711407, 323.450924464153, 352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256, 350.40023330565595, 347.4604936976461, 358.24477647712314, 324.6849070015628, 351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587, 323.0145960490542, 364.12855599465337, 291.2154443639173, 323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117, 370.28284709440925, 341.0762106950045, 348.825513056813, 332.30037746493457, 312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.601883860347956, "mean_inference_ms": 1.2314779228234927, "mean_action_processing_ms": 0.2058639607561882, "mean_env_wait_ms": 489.7489436379344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01060342788696289, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.16696405410766602}, "num_episodes": 21, "episode_return_max": 371.6138475774663, "episode_return_min": 140.42823570556715, "episode_return_mean": 335.47139833047294}, "episode_reward_max": 371.6138475774663, "episode_reward_min": 140.42823570556715, "episode_reward_mean": 335.47139833047294, "episode_len_mean": 49.77, "episodes_this_iter": 21, "episodes_timesteps_total": 4977, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [354.0270073338837, 343.2096766683754, 353.11472849141404, 322.58906719093767, 297.68565244101046, 348.45577887096186, 353.2635397201745, 359.98801269531236, 328.975346891739, 349.40316229793143, 140.42823570556715, 327.86733410299433, 355.9294405356577, 316.63062854177514, 349.8517843621975, 316.763486868269, 328.7860655338855, 363.00557870711407, 323.450924464153, 352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256, 350.40023330565595, 347.4604936976461, 358.24477647712314, 324.6849070015628, 351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587, 323.0145960490542, 364.12855599465337, 291.2154443639173, 323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117, 370.28284709440925, 341.0762106950045, 348.825513056813, 332.30037746493457, 312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.601883860347956, "mean_inference_ms": 1.2314779228234927, "mean_action_processing_ms": 0.2058639607561882, "mean_env_wait_ms": 489.7489436379344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01060342788696289, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.16696405410766602}, "num_episodes": 21, "episode_return_max": 371.6138475774663, "episode_return_min": 140.42823570556715, "episode_return_mean": 335.47139833047294, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117198, "num_agent_steps_trained": 117198, "num_env_steps_sampled": 117198, "num_env_steps_trained": 117198, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.20623785447266, "num_env_steps_trained_throughput_per_sec": 10.20623785447266, "timesteps_total": 117198, "num_env_steps_sampled_lifetime": 117198, "num_agent_steps_sampled_lifetime": 117198, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 117198, "timers": {"training_iteration_time_ms": 94037.96, "restore_workers_time_ms": 0.017, "training_step_time_ms": 94037.913, "sample_time_ms": 92730.379, "load_time_ms": 0.406, "load_throughput": 2525591.821, "learn_time_ms": 1293.855, "learn_throughput": 792.979, "synch_weights_time_ms": 12.988}, "counters": {"num_env_steps_sampled": 117198, "num_env_steps_trained": 117198, "num_agent_steps_sampled": 117198, "num_agent_steps_trained": 117198}, "done": false, "episodes_total": 2634, "training_iteration": 128, "trial_id": "fe178_00005", "date": "2024-08-15_20-22-41", "timestamp": 1723774961, "time_this_iter_s": 100.53038358688354, "time_total_s": 11417.787199020386, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1211.5793924331665, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 20.27762237762238, "ram_util_percent": 11.028671328671328}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.78851514259974, "cur_kl_coeff": 0.13715104525057129, "cur_lr": 5e-06, "total_loss": 6.270633992056052, "policy_loss": -0.005691296662553214, "vf_loss": 6.275736347337564, "vf_explained_var": 0.036965548247098926, "kl": 0.004294076242757046, "entropy": -1.4012440043191114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3240.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 118224, "num_env_steps_trained": 118224, "num_agent_steps_sampled": 118224, "num_agent_steps_trained": 118224}, "sampler_results": {"episode_reward_max": 371.6138475774663, "episode_reward_min": 103.176546110456, "episode_reward_mean": 333.5155601682572, "episode_len_mean": 49.7, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256, 350.40023330565595, 347.4604936976461, 358.24477647712314, 324.6849070015628, 351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587, 323.0145960490542, 364.12855599465337, 291.2154443639173, 323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117, 370.28284709440925, 341.0762106950045, 348.825513056813, 332.30037746493457, 312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669, 359.0137653495783, 290.60619651439436, 320.8737039445199, 356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.603230246239261, "mean_inference_ms": 1.2310389380872546, "mean_action_processing_ms": 0.20583409257625981, "mean_env_wait_ms": 489.66764199705386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010582208633422852, "StateBufferConnector_ms": 0.0060787200927734375, "ViewRequirementAgentConnector_ms": 0.1660628318786621}, "num_episodes": 19, "episode_return_max": 371.6138475774663, "episode_return_min": 103.176546110456, "episode_return_mean": 333.5155601682572}, "env_runner_results": {"episode_reward_max": 371.6138475774663, "episode_reward_min": 103.176546110456, "episode_reward_mean": 333.5155601682572, "episode_len_mean": 49.7, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256, 350.40023330565595, 347.4604936976461, 358.24477647712314, 324.6849070015628, 351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587, 323.0145960490542, 364.12855599465337, 291.2154443639173, 323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117, 370.28284709440925, 341.0762106950045, 348.825513056813, 332.30037746493457, 312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669, 359.0137653495783, 290.60619651439436, 320.8737039445199, 356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.603230246239261, "mean_inference_ms": 1.2310389380872546, "mean_action_processing_ms": 0.20583409257625981, "mean_env_wait_ms": 489.66764199705386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010582208633422852, "StateBufferConnector_ms": 0.0060787200927734375, "ViewRequirementAgentConnector_ms": 0.1660628318786621}, "num_episodes": 19, "episode_return_max": 371.6138475774663, "episode_return_min": 103.176546110456, "episode_return_mean": 333.5155601682572}, "episode_reward_max": 371.6138475774663, "episode_reward_min": 103.176546110456, "episode_reward_mean": 333.5155601682572, "episode_len_mean": 49.7, "episodes_this_iter": 19, "episodes_timesteps_total": 4970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [352.61049138838825, 352.7803494986422, 329.94915206529805, 355.2277614453548, 348.44778178840187, 353.17678281449565, 309.5911537687822, 356.3207498859277, 343.98662011270136, 331.6781648356835, 361.9449138742039, 354.11114629645004, 337.7133805985736, 351.28516838193644, 354.4209610566245, 310.45242417937493, 305.06764909846726, 361.19888484909256, 350.40023330565595, 347.4604936976461, 358.24477647712314, 324.6849070015628, 351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587, 323.0145960490542, 364.12855599465337, 291.2154443639173, 323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117, 370.28284709440925, 341.0762106950045, 348.825513056813, 332.30037746493457, 312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669, 359.0137653495783, 290.60619651439436, 320.8737039445199, 356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.603230246239261, "mean_inference_ms": 1.2310389380872546, "mean_action_processing_ms": 0.20583409257625981, "mean_env_wait_ms": 489.66764199705386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010582208633422852, "StateBufferConnector_ms": 0.0060787200927734375, "ViewRequirementAgentConnector_ms": 0.1660628318786621}, "num_episodes": 19, "episode_return_max": 371.6138475774663, "episode_return_min": 103.176546110456, "episode_return_mean": 333.5155601682572, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118224, "num_agent_steps_trained": 118224, "num_env_steps_sampled": 118224, "num_env_steps_trained": 118224, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 12.167898325318506, "num_env_steps_trained_throughput_per_sec": 12.167898325318506, "timesteps_total": 118224, "num_env_steps_sampled_lifetime": 118224, "num_agent_steps_sampled_lifetime": 118224, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 118224, "timers": {"training_iteration_time_ms": 92512.707, "restore_workers_time_ms": 0.017, "training_step_time_ms": 92512.661, "sample_time_ms": 91206.904, "load_time_ms": 0.405, "load_throughput": 2530790.346, "learn_time_ms": 1292.005, "learn_throughput": 794.114, "synch_weights_time_ms": 13.058}, "counters": {"num_env_steps_sampled": 118224, "num_env_steps_trained": 118224, "num_agent_steps_sampled": 118224, "num_agent_steps_trained": 118224}, "done": false, "episodes_total": 2653, "training_iteration": 129, "trial_id": "fe178_00005", "date": "2024-08-15_20-24-05", "timestamp": 1723775045, "time_this_iter_s": 84.32383394241333, "time_total_s": 11502.111032962799, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1295.9032263755798, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.89834710743802, "ram_util_percent": 10.93388429752066}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 55.024969108899434, "cur_kl_coeff": 0.06857552262528564, "cur_lr": 5e-06, "total_loss": 6.720876966913541, "policy_loss": 0.002066228441738834, "vf_loss": 6.715981220205625, "vf_explained_var": 0.10437451501687368, "kl": 0.041260883135937926, "entropy": -1.4963189979394278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3480.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 119250, "num_env_steps_trained": 119250, "num_agent_steps_sampled": 119250, "num_agent_steps_trained": 119250}, "sampler_results": {"episode_reward_max": 371.6138475774663, "episode_reward_min": 103.176546110456, "episode_reward_mean": 331.055545565714, "episode_len_mean": 49.7, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587, 323.0145960490542, 364.12855599465337, 291.2154443639173, 323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117, 370.28284709440925, 341.0762106950045, 348.825513056813, 332.30037746493457, 312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669, 359.0137653495783, 290.60619651439436, 320.8737039445199, 356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246, 354.7584969356777, 361.6465209960934, 342.41547811219306, 365.6578153215024, 313.50636975790775, 344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.602497526251857, "mean_inference_ms": 1.2304231066874354, "mean_action_processing_ms": 0.20582235865356557, "mean_env_wait_ms": 489.8421391485991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010434389114379883, "StateBufferConnector_ms": 0.00603175163269043, "ViewRequirementAgentConnector_ms": 0.16486334800720215}, "num_episodes": 22, "episode_return_max": 371.6138475774663, "episode_return_min": 103.176546110456, "episode_return_mean": 331.055545565714}, "env_runner_results": {"episode_reward_max": 371.6138475774663, "episode_reward_min": 103.176546110456, "episode_reward_mean": 331.055545565714, "episode_len_mean": 49.7, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587, 323.0145960490542, 364.12855599465337, 291.2154443639173, 323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117, 370.28284709440925, 341.0762106950045, 348.825513056813, 332.30037746493457, 312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669, 359.0137653495783, 290.60619651439436, 320.8737039445199, 356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246, 354.7584969356777, 361.6465209960934, 342.41547811219306, 365.6578153215024, 313.50636975790775, 344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.602497526251857, "mean_inference_ms": 1.2304231066874354, "mean_action_processing_ms": 0.20582235865356557, "mean_env_wait_ms": 489.8421391485991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010434389114379883, "StateBufferConnector_ms": 0.00603175163269043, "ViewRequirementAgentConnector_ms": 0.16486334800720215}, "num_episodes": 22, "episode_return_max": 371.6138475774663, "episode_return_min": 103.176546110456, "episode_return_mean": 331.055545565714}, "episode_reward_max": 371.6138475774663, "episode_reward_min": 103.176546110456, "episode_reward_mean": 331.055545565714, "episode_len_mean": 49.7, "episodes_this_iter": 22, "episodes_timesteps_total": 4970, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [351.49221191406286, 329.920070027551, 318.1743215759257, 300.07854075296615, 355.99280808782044, 354.25175188240377, 353.8709413050701, 322.93798003102745, 371.6138475774663, 362.05131857407554, 318.31062592796076, 325.5584983602498, 357.8451173201684, 309.1053414021233, 333.0571183369427, 306.29229861975693, 313.8559889964587, 323.0145960490542, 364.12855599465337, 291.2154443639173, 323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117, 370.28284709440925, 341.0762106950045, 348.825513056813, 332.30037746493457, 312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669, 359.0137653495783, 290.60619651439436, 320.8737039445199, 356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246, 354.7584969356777, 361.6465209960934, 342.41547811219306, 365.6578153215024, 313.50636975790775, 344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.602497526251857, "mean_inference_ms": 1.2304231066874354, "mean_action_processing_ms": 0.20582235865356557, "mean_env_wait_ms": 489.8421391485991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010434389114379883, "StateBufferConnector_ms": 0.00603175163269043, "ViewRequirementAgentConnector_ms": 0.16486334800720215}, "num_episodes": 22, "episode_return_max": 371.6138475774663, "episode_return_min": 103.176546110456, "episode_return_mean": 331.055545565714, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119250, "num_agent_steps_trained": 119250, "num_env_steps_sampled": 119250, "num_env_steps_trained": 119250, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.116735245351316, "num_env_steps_trained_throughput_per_sec": 10.116735245351316, "timesteps_total": 119250, "num_env_steps_sampled_lifetime": 119250, "num_agent_steps_sampled_lifetime": 119250, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 119250, "timers": {"training_iteration_time_ms": 93990.808, "restore_workers_time_ms": 0.016, "training_step_time_ms": 93990.765, "sample_time_ms": 92696.766, "load_time_ms": 0.395, "load_throughput": 2596449.803, "learn_time_ms": 1280.226, "learn_throughput": 801.421, "synch_weights_time_ms": 13.088}, "counters": {"num_env_steps_sampled": 119250, "num_env_steps_trained": 119250, "num_agent_steps_sampled": 119250, "num_agent_steps_trained": 119250}, "done": false, "episodes_total": 2675, "training_iteration": 130, "trial_id": "fe178_00005", "date": "2024-08-15_20-25-47", "timestamp": 1723775147, "time_this_iter_s": 101.41966128349304, "time_total_s": 11603.530694246292, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1397.3228876590729, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 21.009722222222223, "ram_util_percent": 11.009027777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.98881283005078, "cur_kl_coeff": 0.10286328393792844, "cur_lr": 5e-06, "total_loss": 6.200411967933178, "policy_loss": -0.008289815958899755, "vf_loss": 6.208257511258125, "vf_explained_var": 0.09930924673875173, "kl": 0.004319095133180183, "entropy": -1.373171249528726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3720.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 120276, "num_env_steps_trained": 120276, "num_agent_steps_sampled": 120276, "num_agent_steps_trained": 120276}, "sampler_results": {"episode_reward_max": 370.592188832724, "episode_reward_min": 103.176546110456, "episode_reward_mean": 328.0526864971342, "episode_len_mean": 49.34, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4934, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117, 370.28284709440925, 341.0762106950045, 348.825513056813, 332.30037746493457, 312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669, 359.0137653495783, 290.60619651439436, 320.8737039445199, 356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246, 354.7584969356777, 361.6465209960934, 342.41547811219306, 365.6578153215024, 313.50636975790775, 344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705, 334.1956194368561, 355.52248145002653, 324.3222140524854, 315.76999774182786, 338.6527635509163, 302.9881835988439, 330.78992630455775, 366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.603210807666427, "mean_inference_ms": 1.2304443783011692, "mean_action_processing_ms": 0.2058031405912404, "mean_env_wait_ms": 488.270603921321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010300636291503906, "StateBufferConnector_ms": 0.006077766418457031, "ViewRequirementAgentConnector_ms": 0.16489863395690918}, "num_episodes": 20, "episode_return_max": 370.592188832724, "episode_return_min": 103.176546110456, "episode_return_mean": 328.0526864971342}, "env_runner_results": {"episode_reward_max": 370.592188832724, "episode_reward_min": 103.176546110456, "episode_reward_mean": 328.0526864971342, "episode_len_mean": 49.34, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4934, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117, 370.28284709440925, 341.0762106950045, 348.825513056813, 332.30037746493457, 312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669, 359.0137653495783, 290.60619651439436, 320.8737039445199, 356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246, 354.7584969356777, 361.6465209960934, 342.41547811219306, 365.6578153215024, 313.50636975790775, 344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705, 334.1956194368561, 355.52248145002653, 324.3222140524854, 315.76999774182786, 338.6527635509163, 302.9881835988439, 330.78992630455775, 366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.603210807666427, "mean_inference_ms": 1.2304443783011692, "mean_action_processing_ms": 0.2058031405912404, "mean_env_wait_ms": 488.270603921321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010300636291503906, "StateBufferConnector_ms": 0.006077766418457031, "ViewRequirementAgentConnector_ms": 0.16489863395690918}, "num_episodes": 20, "episode_return_max": 370.592188832724, "episode_return_min": 103.176546110456, "episode_return_mean": 328.0526864971342}, "episode_reward_max": 370.592188832724, "episode_reward_min": 103.176546110456, "episode_reward_mean": 328.0526864971342, "episode_len_mean": 49.34, "episodes_this_iter": 20, "episodes_timesteps_total": 4934, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [323.6545909119252, 335.36362630651564, 308.69556966779214, 340.92894832661375, 292.0085824713578, 358.64338598799804, 301.1625612344892, 316.63342977290273, 325.5361719256552, 290.9113847968578, 349.4557332507851, 352.48410230511786, 343.4286512018863, 338.63596030565054, 354.8525878906253, 347.2163488809235, 341.44595284456017, 340.2437200549117, 370.28284709440925, 341.0762106950045, 348.825513056813, 332.30037746493457, 312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669, 359.0137653495783, 290.60619651439436, 320.8737039445199, 356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246, 354.7584969356777, 361.6465209960934, 342.41547811219306, 365.6578153215024, 313.50636975790775, 344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705, 334.1956194368561, 355.52248145002653, 324.3222140524854, 315.76999774182786, 338.6527635509163, 302.9881835988439, 330.78992630455775, 366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.603210807666427, "mean_inference_ms": 1.2304443783011692, "mean_action_processing_ms": 0.2058031405912404, "mean_env_wait_ms": 488.270603921321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010300636291503906, "StateBufferConnector_ms": 0.006077766418457031, "ViewRequirementAgentConnector_ms": 0.16489863395690918}, "num_episodes": 20, "episode_return_max": 370.592188832724, "episode_return_min": 103.176546110456, "episode_return_mean": 328.0526864971342, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120276, "num_agent_steps_trained": 120276, "num_env_steps_sampled": 120276, "num_env_steps_trained": 120276, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 12.931026345362616, "num_env_steps_trained_throughput_per_sec": 12.931026345362616, "timesteps_total": 120276, "num_env_steps_sampled_lifetime": 120276, "num_agent_steps_sampled_lifetime": 120276, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 120276, "timers": {"training_iteration_time_ms": 90518.456, "restore_workers_time_ms": 0.015, "training_step_time_ms": 90518.415, "sample_time_ms": 89224.206, "load_time_ms": 0.393, "load_throughput": 2608726.906, "learn_time_ms": 1280.547, "learn_throughput": 801.22, "synch_weights_time_ms": 12.987}, "counters": {"num_env_steps_sampled": 120276, "num_env_steps_trained": 120276, "num_agent_steps_sampled": 120276, "num_agent_steps_trained": 120276}, "done": false, "episodes_total": 2695, "training_iteration": 131, "trial_id": "fe178_00005", "date": "2024-08-15_20-27-06", "timestamp": 1723775226, "time_this_iter_s": 79.34793496131897, "time_total_s": 11682.878629207611, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1476.6708226203918, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 25.67280701754386, "ram_util_percent": 11.192982456140351}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.66431634426117, "cur_kl_coeff": 0.05143164196896422, "cur_lr": 5e-06, "total_loss": 7.091392663121224, "policy_loss": -0.006172849787011121, "vf_loss": 7.097138013442358, "vf_explained_var": 0.06000631774465243, "kl": 0.008311971638252652, "entropy": -1.750540235141913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3960.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 121302, "num_env_steps_trained": 121302, "num_agent_steps_sampled": 121302, "num_agent_steps_trained": 121302}, "sampler_results": {"episode_reward_max": 374.844637279712, "episode_reward_min": 103.176546110456, "episode_reward_mean": 328.6734532092269, "episode_len_mean": 49.24, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669, 359.0137653495783, 290.60619651439436, 320.8737039445199, 356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246, 354.7584969356777, 361.6465209960934, 342.41547811219306, 365.6578153215024, 313.50636975790775, 344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705, 334.1956194368561, 355.52248145002653, 324.3222140524854, 315.76999774182786, 338.6527635509163, 302.9881835988439, 330.78992630455775, 366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269, 347.95286011446063, 359.6670550071258, 339.2952373932559, 336.2824563204508, 361.28771046871475, 374.844637279712, 359.3223502731341, 344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.603050441049047, "mean_inference_ms": 1.2300276023294705, "mean_action_processing_ms": 0.20585877621043885, "mean_env_wait_ms": 487.4584125658458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010208368301391602, "StateBufferConnector_ms": 0.006097316741943359, "ViewRequirementAgentConnector_ms": 0.16567587852478027}, "num_episodes": 22, "episode_return_max": 374.844637279712, "episode_return_min": 103.176546110456, "episode_return_mean": 328.6734532092269}, "env_runner_results": {"episode_reward_max": 374.844637279712, "episode_reward_min": 103.176546110456, "episode_reward_mean": 328.6734532092269, "episode_len_mean": 49.24, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 4924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669, 359.0137653495783, 290.60619651439436, 320.8737039445199, 356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246, 354.7584969356777, 361.6465209960934, 342.41547811219306, 365.6578153215024, 313.50636975790775, 344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705, 334.1956194368561, 355.52248145002653, 324.3222140524854, 315.76999774182786, 338.6527635509163, 302.9881835988439, 330.78992630455775, 366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269, 347.95286011446063, 359.6670550071258, 339.2952373932559, 336.2824563204508, 361.28771046871475, 374.844637279712, 359.3223502731341, 344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.603050441049047, "mean_inference_ms": 1.2300276023294705, "mean_action_processing_ms": 0.20585877621043885, "mean_env_wait_ms": 487.4584125658458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010208368301391602, "StateBufferConnector_ms": 0.006097316741943359, "ViewRequirementAgentConnector_ms": 0.16567587852478027}, "num_episodes": 22, "episode_return_max": 374.844637279712, "episode_return_min": 103.176546110456, "episode_return_mean": 328.6734532092269}, "episode_reward_max": 374.844637279712, "episode_reward_min": 103.176546110456, "episode_reward_mean": 328.6734532092269, "episode_len_mean": 49.24, "episodes_this_iter": 22, "episodes_timesteps_total": 4924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [312.92354478347795, 361.5620149644768, 352.95117444777765, 349.96860735372303, 367.2249968521699, 349.48913228057535, 281.1572485130577, 359.928275875593, 344.1258552145091, 334.92842066318093, 343.5472302662636, 299.02814122234366, 289.85319906301373, 366.0975615873407, 336.17279386326265, 345.85375475104, 351.5948499543669, 359.0137653495783, 290.60619651439436, 320.8737039445199, 356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246, 354.7584969356777, 361.6465209960934, 342.41547811219306, 365.6578153215024, 313.50636975790775, 344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705, 334.1956194368561, 355.52248145002653, 324.3222140524854, 315.76999774182786, 338.6527635509163, 302.9881835988439, 330.78992630455775, 366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269, 347.95286011446063, 359.6670550071258, 339.2952373932559, 336.2824563204508, 361.28771046871475, 374.844637279712, 359.3223502731341, 344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.603050441049047, "mean_inference_ms": 1.2300276023294705, "mean_action_processing_ms": 0.20585877621043885, "mean_env_wait_ms": 487.4584125658458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010208368301391602, "StateBufferConnector_ms": 0.006097316741943359, "ViewRequirementAgentConnector_ms": 0.16567587852478027}, "num_episodes": 22, "episode_return_max": 374.844637279712, "episode_return_min": 103.176546110456, "episode_return_mean": 328.6734532092269, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121302, "num_agent_steps_trained": 121302, "num_env_steps_sampled": 121302, "num_env_steps_trained": 121302, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.36389661160375, "num_env_steps_trained_throughput_per_sec": 10.36389661160375, "timesteps_total": 121302, "num_env_steps_sampled_lifetime": 121302, "num_agent_steps_sampled_lifetime": 121302, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 121302, "timers": {"training_iteration_time_ms": 91992.788, "restore_workers_time_ms": 0.015, "training_step_time_ms": 91992.747, "sample_time_ms": 90690.243, "load_time_ms": 0.391, "load_throughput": 2626239.414, "learn_time_ms": 1288.766, "learn_throughput": 796.11, "synch_weights_time_ms": 13.058}, "counters": {"num_env_steps_sampled": 121302, "num_env_steps_trained": 121302, "num_agent_steps_sampled": 121302, "num_agent_steps_trained": 121302}, "done": false, "episodes_total": 2717, "training_iteration": 132, "trial_id": "fe178_00005", "date": "2024-08-15_20-28-45", "timestamp": 1723775325, "time_this_iter_s": 99.00145721435547, "time_total_s": 11781.880086421967, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1575.6722798347473, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 20.791489361702123, "ram_util_percent": 11.285815602836877}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67.49769392808278, "cur_kl_coeff": 0.05143164196896422, "cur_lr": 5e-06, "total_loss": 6.019120087226232, "policy_loss": 0.022091862101418277, "vf_loss": 5.9919234380126, "vf_explained_var": 0.03909072702129682, "kl": 0.09925498020189523, "entropy": -1.5446350107590356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4200.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 122328, "num_env_steps_trained": 122328, "num_agent_steps_sampled": 122328, "num_agent_steps_trained": 122328}, "sampler_results": {"episode_reward_max": 374.844637279712, "episode_reward_min": 103.176546110456, "episode_reward_mean": 328.42644024045586, "episode_len_mean": 49.24, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246, 354.7584969356777, 361.6465209960934, 342.41547811219306, 365.6578153215024, 313.50636975790775, 344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705, 334.1956194368561, 355.52248145002653, 324.3222140524854, 315.76999774182786, 338.6527635509163, 302.9881835988439, 330.78992630455775, 366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269, 347.95286011446063, 359.6670550071258, 339.2952373932559, 336.2824563204508, 361.28771046871475, 374.844637279712, 359.3223502731341, 344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412, 357.3352610852113, 294.8012185765367, 291.13288914193305, 353.0221574208779, 316.572989465626, 305.5845506152151, 370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.603753532690979, "mean_inference_ms": 1.230082410843734, "mean_action_processing_ms": 0.20584659620729162, "mean_env_wait_ms": 486.0813670912943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010375261306762695, "StateBufferConnector_ms": 0.00612950325012207, "ViewRequirementAgentConnector_ms": 0.1662893295288086}, "num_episodes": 20, "episode_return_max": 374.844637279712, "episode_return_min": 103.176546110456, "episode_return_mean": 328.42644024045586}, "env_runner_results": {"episode_reward_max": 374.844637279712, "episode_reward_min": 103.176546110456, "episode_reward_mean": 328.42644024045586, "episode_len_mean": 49.24, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246, 354.7584969356777, 361.6465209960934, 342.41547811219306, 365.6578153215024, 313.50636975790775, 344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705, 334.1956194368561, 355.52248145002653, 324.3222140524854, 315.76999774182786, 338.6527635509163, 302.9881835988439, 330.78992630455775, 366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269, 347.95286011446063, 359.6670550071258, 339.2952373932559, 336.2824563204508, 361.28771046871475, 374.844637279712, 359.3223502731341, 344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412, 357.3352610852113, 294.8012185765367, 291.13288914193305, 353.0221574208779, 316.572989465626, 305.5845506152151, 370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.603753532690979, "mean_inference_ms": 1.230082410843734, "mean_action_processing_ms": 0.20584659620729162, "mean_env_wait_ms": 486.0813670912943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010375261306762695, "StateBufferConnector_ms": 0.00612950325012207, "ViewRequirementAgentConnector_ms": 0.1662893295288086}, "num_episodes": 20, "episode_return_max": 374.844637279712, "episode_return_min": 103.176546110456, "episode_return_mean": 328.42644024045586}, "episode_reward_max": 374.844637279712, "episode_reward_min": 103.176546110456, "episode_reward_mean": 328.42644024045586, "episode_len_mean": 49.24, "episodes_this_iter": 20, "episodes_timesteps_total": 4924, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [356.0537684367451, 275.5280135604302, 370.592188832724, 348.972292692846, 278.2289161761562, 313.5053951479667, 354.73460647498587, 333.3430940009347, 313.49081873319426, 103.176546110456, 352.9953298278681, 273.4084558589473, 354.9370683225267, 338.26624938656914, 348.82421736142675, 351.29100846951246, 354.7584969356777, 361.6465209960934, 342.41547811219306, 365.6578153215024, 313.50636975790775, 344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705, 334.1956194368561, 355.52248145002653, 324.3222140524854, 315.76999774182786, 338.6527635509163, 302.9881835988439, 330.78992630455775, 366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269, 347.95286011446063, 359.6670550071258, 339.2952373932559, 336.2824563204508, 361.28771046871475, 374.844637279712, 359.3223502731341, 344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412, 357.3352610852113, 294.8012185765367, 291.13288914193305, 353.0221574208779, 316.572989465626, 305.5845506152151, 370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.603753532690979, "mean_inference_ms": 1.230082410843734, "mean_action_processing_ms": 0.20584659620729162, "mean_env_wait_ms": 486.0813670912943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010375261306762695, "StateBufferConnector_ms": 0.00612950325012207, "ViewRequirementAgentConnector_ms": 0.1662893295288086}, "num_episodes": 20, "episode_return_max": 374.844637279712, "episode_return_min": 103.176546110456, "episode_return_mean": 328.42644024045586, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122328, "num_agent_steps_trained": 122328, "num_env_steps_sampled": 122328, "num_env_steps_trained": 122328, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.358575347979569, "num_env_steps_trained_throughput_per_sec": 11.358575347979569, "timesteps_total": 122328, "num_env_steps_sampled_lifetime": 122328, "num_agent_steps_sampled_lifetime": 122328, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 122328, "timers": {"training_iteration_time_ms": 92009.017, "restore_workers_time_ms": 0.015, "training_step_time_ms": 92008.977, "sample_time_ms": 90718.837, "load_time_ms": 0.384, "load_throughput": 2674553.079, "learn_time_ms": 1276.408, "learn_throughput": 803.818, "synch_weights_time_ms": 13.06}, "counters": {"num_env_steps_sampled": 122328, "num_env_steps_trained": 122328, "num_agent_steps_sampled": 122328, "num_agent_steps_trained": 122328}, "done": false, "episodes_total": 2737, "training_iteration": 133, "trial_id": "fe178_00005", "date": "2024-08-15_20-30-15", "timestamp": 1723775415, "time_this_iter_s": 90.33206915855408, "time_total_s": 11872.21215558052, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1666.0043489933014, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 22.526356589147284, "ram_util_percent": 11.391472868217056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.74677806695302, "cur_kl_coeff": 0.07714746295344635, "cur_lr": 5e-06, "total_loss": 6.057115806639194, "policy_loss": -0.007526698358318148, "vf_loss": 6.064005924761295, "vf_explained_var": 0.11504547322789828, "kl": 0.008251652921900408, "entropy": -1.2540719976027808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4440.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 123354, "num_env_steps_trained": 123354, "num_agent_steps_sampled": 123354, "num_agent_steps_trained": 123354}, "sampler_results": {"episode_reward_max": 374.844637279712, "episode_reward_min": 101.78856201171891, "episode_reward_mean": 323.91523363609156, "episode_len_mean": 49.0, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705, 334.1956194368561, 355.52248145002653, 324.3222140524854, 315.76999774182786, 338.6527635509163, 302.9881835988439, 330.78992630455775, 366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269, 347.95286011446063, 359.6670550071258, 339.2952373932559, 336.2824563204508, 361.28771046871475, 374.844637279712, 359.3223502731341, 344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412, 357.3352610852113, 294.8012185765367, 291.13288914193305, 353.0221574208779, 316.572989465626, 305.5845506152151, 370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446, 345.2632501306595, 311.43961160705874, 305.3289072502596, 335.29187185848014, 345.976451263029, 290.2102336821627, 300.77598512668453, 344.4908319111362, 333.5678676359406, 139.61202039969913, 350.8703181234171, 345.00434641544274, 280.2321968789973, 345.3299361564975, 314.59020351950005, 353.0549934244155, 101.78856201171891, 249.45695785854258, 308.9901794411847, 339.11605742348246, 313.82120796193135], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.60956899029186, "mean_inference_ms": 1.2298686299120005, "mean_action_processing_ms": 0.20587472801399087, "mean_env_wait_ms": 485.22089868254074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010411977767944336, "StateBufferConnector_ms": 0.006136894226074219, "ViewRequirementAgentConnector_ms": 0.16633272171020508}, "num_episodes": 21, "episode_return_max": 374.844637279712, "episode_return_min": 101.78856201171891, "episode_return_mean": 323.91523363609156}, "env_runner_results": {"episode_reward_max": 374.844637279712, "episode_reward_min": 101.78856201171891, "episode_reward_mean": 323.91523363609156, "episode_len_mean": 49.0, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705, 334.1956194368561, 355.52248145002653, 324.3222140524854, 315.76999774182786, 338.6527635509163, 302.9881835988439, 330.78992630455775, 366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269, 347.95286011446063, 359.6670550071258, 339.2952373932559, 336.2824563204508, 361.28771046871475, 374.844637279712, 359.3223502731341, 344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412, 357.3352610852113, 294.8012185765367, 291.13288914193305, 353.0221574208779, 316.572989465626, 305.5845506152151, 370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446, 345.2632501306595, 311.43961160705874, 305.3289072502596, 335.29187185848014, 345.976451263029, 290.2102336821627, 300.77598512668453, 344.4908319111362, 333.5678676359406, 139.61202039969913, 350.8703181234171, 345.00434641544274, 280.2321968789973, 345.3299361564975, 314.59020351950005, 353.0549934244155, 101.78856201171891, 249.45695785854258, 308.9901794411847, 339.11605742348246, 313.82120796193135], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.60956899029186, "mean_inference_ms": 1.2298686299120005, "mean_action_processing_ms": 0.20587472801399087, "mean_env_wait_ms": 485.22089868254074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010411977767944336, "StateBufferConnector_ms": 0.006136894226074219, "ViewRequirementAgentConnector_ms": 0.16633272171020508}, "num_episodes": 21, "episode_return_max": 374.844637279712, "episode_return_min": 101.78856201171891, "episode_return_mean": 323.91523363609156}, "episode_reward_max": 374.844637279712, "episode_reward_min": 101.78856201171891, "episode_reward_mean": 323.91523363609156, "episode_len_mean": 49.0, "episodes_this_iter": 21, "episodes_timesteps_total": 4900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [344.5476095171699, 352.752260662912, 340.18814667263405, 274.56078396018773, 323.37910911700715, 298.93197475648213, 290.413461103835, 331.20230557107715, 271.12687940036733, 357.5457300986989, 321.44474872007646, 365.2178626702308, 335.86486406170945, 343.95532261696115, 347.01070318348116, 333.4819443737846, 335.1440985560705, 334.1956194368561, 355.52248145002653, 324.3222140524854, 315.76999774182786, 338.6527635509163, 302.9881835988439, 330.78992630455775, 366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269, 347.95286011446063, 359.6670550071258, 339.2952373932559, 336.2824563204508, 361.28771046871475, 374.844637279712, 359.3223502731341, 344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412, 357.3352610852113, 294.8012185765367, 291.13288914193305, 353.0221574208779, 316.572989465626, 305.5845506152151, 370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446, 345.2632501306595, 311.43961160705874, 305.3289072502596, 335.29187185848014, 345.976451263029, 290.2102336821627, 300.77598512668453, 344.4908319111362, 333.5678676359406, 139.61202039969913, 350.8703181234171, 345.00434641544274, 280.2321968789973, 345.3299361564975, 314.59020351950005, 353.0549934244155, 101.78856201171891, 249.45695785854258, 308.9901794411847, 339.11605742348246, 313.82120796193135], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.60956899029186, "mean_inference_ms": 1.2298686299120005, "mean_action_processing_ms": 0.20587472801399087, "mean_env_wait_ms": 485.22089868254074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010411977767944336, "StateBufferConnector_ms": 0.006136894226074219, "ViewRequirementAgentConnector_ms": 0.16633272171020508}, "num_episodes": 21, "episode_return_max": 374.844637279712, "episode_return_min": 101.78856201171891, "episode_return_mean": 323.91523363609156, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123354, "num_agent_steps_trained": 123354, "num_env_steps_sampled": 123354, "num_env_steps_trained": 123354, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.667537463676576, "num_env_steps_trained_throughput_per_sec": 10.667537463676576, "timesteps_total": 123354, "num_env_steps_sampled_lifetime": 123354, "num_agent_steps_sampled_lifetime": 123354, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 123354, "timers": {"training_iteration_time_ms": 93116.723, "restore_workers_time_ms": 0.015, "training_step_time_ms": 93116.682, "sample_time_ms": 91808.627, "load_time_ms": 0.387, "load_throughput": 2654590.034, "learn_time_ms": 1294.258, "learn_throughput": 792.732, "synch_weights_time_ms": 13.118}, "counters": {"num_env_steps_sampled": 123354, "num_env_steps_trained": 123354, "num_agent_steps_sampled": 123354, "num_agent_steps_trained": 123354}, "done": false, "episodes_total": 2758, "training_iteration": 134, "trial_id": "fe178_00005", "date": "2024-08-15_20-31-51", "timestamp": 1723775511, "time_this_iter_s": 96.18331408500671, "time_total_s": 11968.395469665527, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1762.187663078308, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 21.886861313868614, "ram_util_percent": 11.468613138686132}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.39354154666265, "cur_kl_coeff": 0.07714746295344635, "cur_lr": 5e-06, "total_loss": 6.403660547236601, "policy_loss": -0.009088210668414832, "vf_loss": 6.41155896037817, "vf_explained_var": 0.04840280289451281, "kl": 0.015422306091449012, "entropy": -1.6560175254940988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4680.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 124380, "num_env_steps_trained": 124380, "num_agent_steps_sampled": 124380, "num_agent_steps_trained": 124380}, "sampler_results": {"episode_reward_max": 374.844637279712, "episode_reward_min": 79.64377601743354, "episode_reward_mean": 319.2378458003714, "episode_len_mean": 48.22, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 4822, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269, 347.95286011446063, 359.6670550071258, 339.2952373932559, 336.2824563204508, 361.28771046871475, 374.844637279712, 359.3223502731341, 344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412, 357.3352610852113, 294.8012185765367, 291.13288914193305, 353.0221574208779, 316.572989465626, 305.5845506152151, 370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446, 345.2632501306595, 311.43961160705874, 305.3289072502596, 335.29187185848014, 345.976451263029, 290.2102336821627, 300.77598512668453, 344.4908319111362, 333.5678676359406, 139.61202039969913, 350.8703181234171, 345.00434641544274, 280.2321968789973, 345.3299361564975, 314.59020351950005, 353.0549934244155, 101.78856201171891, 249.45695785854258, 308.9901794411847, 339.11605742348246, 313.82120796193135, 281.00025679050685, 351.37519038584, 310.502176487592, 342.66894531250045, 320.9012240731845, 369.3690035771703, 367.82221679687495, 330.7103572042285, 100.40041282059917, 79.64377601743354, 348.1115205140005, 348.60599561900307, 215.80972904450067, 301.65486987094414, 361.2208394396712, 301.60289421817606, 328.4371075093523, 310.5248177001293, 358.33167914797406, 323.19055821628956, 332.9346009633961, 338.89771051738177, 345.6609123344885, 331.8934130449438], "episode_lengths": [50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 15, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.616927054298321, "mean_inference_ms": 1.2295822620622519, "mean_action_processing_ms": 0.20591954634437953, "mean_env_wait_ms": 484.20918210482387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010210990905761719, "StateBufferConnector_ms": 0.006133079528808594, "ViewRequirementAgentConnector_ms": 0.1670820713043213}, "num_episodes": 24, "episode_return_max": 374.844637279712, "episode_return_min": 79.64377601743354, "episode_return_mean": 319.2378458003714}, "env_runner_results": {"episode_reward_max": 374.844637279712, "episode_reward_min": 79.64377601743354, "episode_reward_mean": 319.2378458003714, "episode_len_mean": 48.22, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 4822, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269, 347.95286011446063, 359.6670550071258, 339.2952373932559, 336.2824563204508, 361.28771046871475, 374.844637279712, 359.3223502731341, 344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412, 357.3352610852113, 294.8012185765367, 291.13288914193305, 353.0221574208779, 316.572989465626, 305.5845506152151, 370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446, 345.2632501306595, 311.43961160705874, 305.3289072502596, 335.29187185848014, 345.976451263029, 290.2102336821627, 300.77598512668453, 344.4908319111362, 333.5678676359406, 139.61202039969913, 350.8703181234171, 345.00434641544274, 280.2321968789973, 345.3299361564975, 314.59020351950005, 353.0549934244155, 101.78856201171891, 249.45695785854258, 308.9901794411847, 339.11605742348246, 313.82120796193135, 281.00025679050685, 351.37519038584, 310.502176487592, 342.66894531250045, 320.9012240731845, 369.3690035771703, 367.82221679687495, 330.7103572042285, 100.40041282059917, 79.64377601743354, 348.1115205140005, 348.60599561900307, 215.80972904450067, 301.65486987094414, 361.2208394396712, 301.60289421817606, 328.4371075093523, 310.5248177001293, 358.33167914797406, 323.19055821628956, 332.9346009633961, 338.89771051738177, 345.6609123344885, 331.8934130449438], "episode_lengths": [50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 15, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.616927054298321, "mean_inference_ms": 1.2295822620622519, "mean_action_processing_ms": 0.20591954634437953, "mean_env_wait_ms": 484.20918210482387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010210990905761719, "StateBufferConnector_ms": 0.006133079528808594, "ViewRequirementAgentConnector_ms": 0.1670820713043213}, "num_episodes": 24, "episode_return_max": 374.844637279712, "episode_return_min": 79.64377601743354, "episode_return_mean": 319.2378458003714}, "episode_reward_max": 374.844637279712, "episode_reward_min": 79.64377601743354, "episode_reward_mean": 319.2378458003714, "episode_len_mean": 48.22, "episodes_this_iter": 24, "episodes_timesteps_total": 4822, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.65631994045515, 318.3116681341721, 313.20674863571037, 111.62370762885769, 222.04856730933926, 350.6575748316292, 360.60345086294757, 321.16781853476726, 349.63421010504004, 296.4156120788131, 368.7495221626925, 363.73314133440647, 317.4319425473269, 347.95286011446063, 359.6670550071258, 339.2952373932559, 336.2824563204508, 361.28771046871475, 374.844637279712, 359.3223502731341, 344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412, 357.3352610852113, 294.8012185765367, 291.13288914193305, 353.0221574208779, 316.572989465626, 305.5845506152151, 370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446, 345.2632501306595, 311.43961160705874, 305.3289072502596, 335.29187185848014, 345.976451263029, 290.2102336821627, 300.77598512668453, 344.4908319111362, 333.5678676359406, 139.61202039969913, 350.8703181234171, 345.00434641544274, 280.2321968789973, 345.3299361564975, 314.59020351950005, 353.0549934244155, 101.78856201171891, 249.45695785854258, 308.9901794411847, 339.11605742348246, 313.82120796193135, 281.00025679050685, 351.37519038584, 310.502176487592, 342.66894531250045, 320.9012240731845, 369.3690035771703, 367.82221679687495, 330.7103572042285, 100.40041282059917, 79.64377601743354, 348.1115205140005, 348.60599561900307, 215.80972904450067, 301.65486987094414, 361.2208394396712, 301.60289421817606, 328.4371075093523, 310.5248177001293, 358.33167914797406, 323.19055821628956, 332.9346009633961, 338.89771051738177, 345.6609123344885, 331.8934130449438], "episode_lengths": [50, 50, 50, 21, 43, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 15, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.616927054298321, "mean_inference_ms": 1.2295822620622519, "mean_action_processing_ms": 0.20591954634437953, "mean_env_wait_ms": 484.20918210482387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010210990905761719, "StateBufferConnector_ms": 0.006133079528808594, "ViewRequirementAgentConnector_ms": 0.1670820713043213}, "num_episodes": 24, "episode_return_max": 374.844637279712, "episode_return_min": 79.64377601743354, "episode_return_mean": 319.2378458003714, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124380, "num_agent_steps_trained": 124380, "num_env_steps_sampled": 124380, "num_env_steps_trained": 124380, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.018321325645095, "num_env_steps_trained_throughput_per_sec": 11.018321325645095, "timesteps_total": 124380, "num_env_steps_sampled_lifetime": 124380, "num_agent_steps_sampled_lifetime": 124380, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 124380, "timers": {"training_iteration_time_ms": 92311.11, "restore_workers_time_ms": 0.015, "training_step_time_ms": 92311.069, "sample_time_ms": 91021.153, "load_time_ms": 0.39, "load_throughput": 2627682.667, "learn_time_ms": 1276.202, "learn_throughput": 803.948, "synch_weights_time_ms": 13.036}, "counters": {"num_env_steps_sampled": 124380, "num_env_steps_trained": 124380, "num_agent_steps_sampled": 124380, "num_agent_steps_trained": 124380}, "done": false, "episodes_total": 2782, "training_iteration": 135, "trial_id": "fe178_00005", "date": "2024-08-15_20-33-25", "timestamp": 1723775605, "time_this_iter_s": 93.12117195129395, "time_total_s": 12061.516641616821, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1855.308835029602, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 22.17368421052631, "ram_util_percent": 11.572932330827067}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.388736542065935, "cur_kl_coeff": 0.07714746295344635, "cur_lr": 5e-06, "total_loss": 5.826756314436595, "policy_loss": -0.008169428957626224, "vf_loss": 5.834270638227463, "vf_explained_var": 0.07213483899831771, "kl": 0.00849126842076816, "entropy": -1.4192305902640026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4920.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 125406, "num_env_steps_trained": 125406, "num_agent_steps_sampled": 125406, "num_agent_steps_trained": 125406}, "sampler_results": {"episode_reward_max": 370.6519497435647, "episode_reward_min": 79.64377601743354, "episode_reward_mean": 316.668577713823, "episode_len_mean": 48.21, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4821, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412, 357.3352610852113, 294.8012185765367, 291.13288914193305, 353.0221574208779, 316.572989465626, 305.5845506152151, 370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446, 345.2632501306595, 311.43961160705874, 305.3289072502596, 335.29187185848014, 345.976451263029, 290.2102336821627, 300.77598512668453, 344.4908319111362, 333.5678676359406, 139.61202039969913, 350.8703181234171, 345.00434641544274, 280.2321968789973, 345.3299361564975, 314.59020351950005, 353.0549934244155, 101.78856201171891, 249.45695785854258, 308.9901794411847, 339.11605742348246, 313.82120796193135, 281.00025679050685, 351.37519038584, 310.502176487592, 342.66894531250045, 320.9012240731845, 369.3690035771703, 367.82221679687495, 330.7103572042285, 100.40041282059917, 79.64377601743354, 348.1115205140005, 348.60599561900307, 215.80972904450067, 301.65486987094414, 361.2208394396712, 301.60289421817606, 328.4371075093523, 310.5248177001293, 358.33167914797406, 323.19055821628956, 332.9346009633961, 338.89771051738177, 345.6609123344885, 331.8934130449438, 362.31083953106577, 357.47934311699055, 291.67306569311705, 348.8944442695928, 98.83135986328136, 341.432522512794, 356.7559557586321, 264.6667028687705, 292.1982167771039, 327.1341982038086, 249.49397720957387, 310.41568333284573, 316.4788906358605, 357.9846925425879, 352.09093187096727, 349.27357635350853, 322.21079763768597, 317.2555205326462, 345.3226634302773, 320.0624001670673], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 15, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.622463701562721, "mean_inference_ms": 1.229556417599151, "mean_action_processing_ms": 0.2058847824838774, "mean_env_wait_ms": 484.56373121251426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010154962539672852, "StateBufferConnector_ms": 0.006124019622802734, "ViewRequirementAgentConnector_ms": 0.16677641868591309}, "num_episodes": 20, "episode_return_max": 370.6519497435647, "episode_return_min": 79.64377601743354, "episode_return_mean": 316.668577713823}, "env_runner_results": {"episode_reward_max": 370.6519497435647, "episode_reward_min": 79.64377601743354, "episode_reward_mean": 316.668577713823, "episode_len_mean": 48.21, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4821, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412, 357.3352610852113, 294.8012185765367, 291.13288914193305, 353.0221574208779, 316.572989465626, 305.5845506152151, 370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446, 345.2632501306595, 311.43961160705874, 305.3289072502596, 335.29187185848014, 345.976451263029, 290.2102336821627, 300.77598512668453, 344.4908319111362, 333.5678676359406, 139.61202039969913, 350.8703181234171, 345.00434641544274, 280.2321968789973, 345.3299361564975, 314.59020351950005, 353.0549934244155, 101.78856201171891, 249.45695785854258, 308.9901794411847, 339.11605742348246, 313.82120796193135, 281.00025679050685, 351.37519038584, 310.502176487592, 342.66894531250045, 320.9012240731845, 369.3690035771703, 367.82221679687495, 330.7103572042285, 100.40041282059917, 79.64377601743354, 348.1115205140005, 348.60599561900307, 215.80972904450067, 301.65486987094414, 361.2208394396712, 301.60289421817606, 328.4371075093523, 310.5248177001293, 358.33167914797406, 323.19055821628956, 332.9346009633961, 338.89771051738177, 345.6609123344885, 331.8934130449438, 362.31083953106577, 357.47934311699055, 291.67306569311705, 348.8944442695928, 98.83135986328136, 341.432522512794, 356.7559557586321, 264.6667028687705, 292.1982167771039, 327.1341982038086, 249.49397720957387, 310.41568333284573, 316.4788906358605, 357.9846925425879, 352.09093187096727, 349.27357635350853, 322.21079763768597, 317.2555205326462, 345.3226634302773, 320.0624001670673], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 15, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.622463701562721, "mean_inference_ms": 1.229556417599151, "mean_action_processing_ms": 0.2058847824838774, "mean_env_wait_ms": 484.56373121251426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010154962539672852, "StateBufferConnector_ms": 0.006124019622802734, "ViewRequirementAgentConnector_ms": 0.16677641868591309}, "num_episodes": 20, "episode_return_max": 370.6519497435647, "episode_return_min": 79.64377601743354, "episode_return_mean": 316.668577713823}, "episode_reward_max": 370.6519497435647, "episode_reward_min": 79.64377601743354, "episode_reward_mean": 316.668577713823, "episode_len_mean": 48.21, "episodes_this_iter": 20, "episodes_timesteps_total": 4821, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [344.33433637998667, 323.7919372525013, 350.5975087949443, 310.0493498668879, 328.16698907438655, 345.34899519100907, 344.111490806534, 350.73104855206026, 363.5419195311335, 329.7403347202649, 295.7645797233002, 350.2208508182785, 351.832864773448, 330.6889416472899, 218.28947366812412, 357.3352610852113, 294.8012185765367, 291.13288914193305, 353.0221574208779, 316.572989465626, 305.5845506152151, 370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446, 345.2632501306595, 311.43961160705874, 305.3289072502596, 335.29187185848014, 345.976451263029, 290.2102336821627, 300.77598512668453, 344.4908319111362, 333.5678676359406, 139.61202039969913, 350.8703181234171, 345.00434641544274, 280.2321968789973, 345.3299361564975, 314.59020351950005, 353.0549934244155, 101.78856201171891, 249.45695785854258, 308.9901794411847, 339.11605742348246, 313.82120796193135, 281.00025679050685, 351.37519038584, 310.502176487592, 342.66894531250045, 320.9012240731845, 369.3690035771703, 367.82221679687495, 330.7103572042285, 100.40041282059917, 79.64377601743354, 348.1115205140005, 348.60599561900307, 215.80972904450067, 301.65486987094414, 361.2208394396712, 301.60289421817606, 328.4371075093523, 310.5248177001293, 358.33167914797406, 323.19055821628956, 332.9346009633961, 338.89771051738177, 345.6609123344885, 331.8934130449438, 362.31083953106577, 357.47934311699055, 291.67306569311705, 348.8944442695928, 98.83135986328136, 341.432522512794, 356.7559557586321, 264.6667028687705, 292.1982167771039, 327.1341982038086, 249.49397720957387, 310.41568333284573, 316.4788906358605, 357.9846925425879, 352.09093187096727, 349.27357635350853, 322.21079763768597, 317.2555205326462, 345.3226634302773, 320.0624001670673], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 15, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.622463701562721, "mean_inference_ms": 1.229556417599151, "mean_action_processing_ms": 0.2058847824838774, "mean_env_wait_ms": 484.56373121251426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010154962539672852, "StateBufferConnector_ms": 0.006124019622802734, "ViewRequirementAgentConnector_ms": 0.16677641868591309}, "num_episodes": 20, "episode_return_max": 370.6519497435647, "episode_return_min": 79.64377601743354, "episode_return_mean": 316.668577713823, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125406, "num_agent_steps_trained": 125406, "num_env_steps_sampled": 125406, "num_env_steps_trained": 125406, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.764660632316401, "num_env_steps_trained_throughput_per_sec": 10.764660632316401, "timesteps_total": 125406, "num_env_steps_sampled_lifetime": 125406, "num_agent_steps_sampled_lifetime": 125406, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 125406, "timers": {"training_iteration_time_ms": 92349.911, "restore_workers_time_ms": 0.015, "training_step_time_ms": 92349.872, "sample_time_ms": 91061.331, "load_time_ms": 0.393, "load_throughput": 2607936.431, "learn_time_ms": 1274.882, "learn_throughput": 804.78, "synch_weights_time_ms": 12.984}, "counters": {"num_env_steps_sampled": 125406, "num_env_steps_trained": 125406, "num_agent_steps_sampled": 125406, "num_agent_steps_trained": 125406}, "done": false, "episodes_total": 2802, "training_iteration": 136, "trial_id": "fe178_00005", "date": "2024-08-15_20-35-00", "timestamp": 1723775700, "time_this_iter_s": 95.3157320022583, "time_total_s": 12156.83237361908, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1950.6245670318604, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 21.576470588235296, "ram_util_percent": 11.673529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.78869260152181, "cur_kl_coeff": 0.07714746295344635, "cur_lr": 5e-06, "total_loss": 5.5498006304105125, "policy_loss": 0.010450113021458188, "vf_loss": 5.53500207811594, "vf_explained_var": 0.0681182270248731, "kl": 0.05636565167691029, "entropy": -1.3833423083027203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5160.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 126432, "num_env_steps_trained": 126432, "num_agent_steps_sampled": 126432, "num_agent_steps_trained": 126432}, "sampler_results": {"episode_reward_max": 370.6519497435647, "episode_reward_min": 79.64377601743354, "episode_reward_mean": 316.587237705195, "episode_len_mean": 48.31, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4831, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446, 345.2632501306595, 311.43961160705874, 305.3289072502596, 335.29187185848014, 345.976451263029, 290.2102336821627, 300.77598512668453, 344.4908319111362, 333.5678676359406, 139.61202039969913, 350.8703181234171, 345.00434641544274, 280.2321968789973, 345.3299361564975, 314.59020351950005, 353.0549934244155, 101.78856201171891, 249.45695785854258, 308.9901794411847, 339.11605742348246, 313.82120796193135, 281.00025679050685, 351.37519038584, 310.502176487592, 342.66894531250045, 320.9012240731845, 369.3690035771703, 367.82221679687495, 330.7103572042285, 100.40041282059917, 79.64377601743354, 348.1115205140005, 348.60599561900307, 215.80972904450067, 301.65486987094414, 361.2208394396712, 301.60289421817606, 328.4371075093523, 310.5248177001293, 358.33167914797406, 323.19055821628956, 332.9346009633961, 338.89771051738177, 345.6609123344885, 331.8934130449438, 362.31083953106577, 357.47934311699055, 291.67306569311705, 348.8944442695928, 98.83135986328136, 341.432522512794, 356.7559557586321, 264.6667028687705, 292.1982167771039, 327.1341982038086, 249.49397720957387, 310.41568333284573, 316.4788906358605, 357.9846925425879, 352.09093187096727, 349.27357635350853, 322.21079763768597, 317.2555205326462, 345.3226634302773, 320.0624001670673, 344.9227608285887, 347.2267048426914, 320.4367177951194, 293.7214995290669, 297.25032358288075, 275.67328210281835, 307.0385274293951, 310.98746461127865, 353.05416881918615, 311.22883708694343, 317.87629826020714, 295.5610473476009, 353.778110461655, 348.712953802273, 331.8322556963063, 329.6486187026102, 337.61131597336856, 356.2595883964715, 329.7501200537812, 346.4513470123942, 338.50374390810686], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 15, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.625311638797289, "mean_inference_ms": 1.2289956655869454, "mean_action_processing_ms": 0.20587878194448664, "mean_env_wait_ms": 484.82867389072385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010143280029296875, "StateBufferConnector_ms": 0.006139993667602539, "ViewRequirementAgentConnector_ms": 0.166670560836792}, "num_episodes": 21, "episode_return_max": 370.6519497435647, "episode_return_min": 79.64377601743354, "episode_return_mean": 316.587237705195}, "env_runner_results": {"episode_reward_max": 370.6519497435647, "episode_reward_min": 79.64377601743354, "episode_reward_mean": 316.587237705195, "episode_len_mean": 48.31, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4831, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446, 345.2632501306595, 311.43961160705874, 305.3289072502596, 335.29187185848014, 345.976451263029, 290.2102336821627, 300.77598512668453, 344.4908319111362, 333.5678676359406, 139.61202039969913, 350.8703181234171, 345.00434641544274, 280.2321968789973, 345.3299361564975, 314.59020351950005, 353.0549934244155, 101.78856201171891, 249.45695785854258, 308.9901794411847, 339.11605742348246, 313.82120796193135, 281.00025679050685, 351.37519038584, 310.502176487592, 342.66894531250045, 320.9012240731845, 369.3690035771703, 367.82221679687495, 330.7103572042285, 100.40041282059917, 79.64377601743354, 348.1115205140005, 348.60599561900307, 215.80972904450067, 301.65486987094414, 361.2208394396712, 301.60289421817606, 328.4371075093523, 310.5248177001293, 358.33167914797406, 323.19055821628956, 332.9346009633961, 338.89771051738177, 345.6609123344885, 331.8934130449438, 362.31083953106577, 357.47934311699055, 291.67306569311705, 348.8944442695928, 98.83135986328136, 341.432522512794, 356.7559557586321, 264.6667028687705, 292.1982167771039, 327.1341982038086, 249.49397720957387, 310.41568333284573, 316.4788906358605, 357.9846925425879, 352.09093187096727, 349.27357635350853, 322.21079763768597, 317.2555205326462, 345.3226634302773, 320.0624001670673, 344.9227608285887, 347.2267048426914, 320.4367177951194, 293.7214995290669, 297.25032358288075, 275.67328210281835, 307.0385274293951, 310.98746461127865, 353.05416881918615, 311.22883708694343, 317.87629826020714, 295.5610473476009, 353.778110461655, 348.712953802273, 331.8322556963063, 329.6486187026102, 337.61131597336856, 356.2595883964715, 329.7501200537812, 346.4513470123942, 338.50374390810686], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 15, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.625311638797289, "mean_inference_ms": 1.2289956655869454, "mean_action_processing_ms": 0.20587878194448664, "mean_env_wait_ms": 484.82867389072385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010143280029296875, "StateBufferConnector_ms": 0.006139993667602539, "ViewRequirementAgentConnector_ms": 0.166670560836792}, "num_episodes": 21, "episode_return_max": 370.6519497435647, "episode_return_min": 79.64377601743354, "episode_return_mean": 316.587237705195}, "episode_reward_max": 370.6519497435647, "episode_reward_min": 79.64377601743354, "episode_reward_mean": 316.587237705195, "episode_len_mean": 48.31, "episodes_this_iter": 21, "episodes_timesteps_total": 4831, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [370.6519497435647, 347.09043010141545, 362.194641113281, 312.1688041616207, 359.1294840528552, 297.51049324327374, 311.3694520144395, 356.30956721409416, 353.4191106030423, 347.97735281578747, 338.69768269412447, 341.94498333782667, 357.55631103515657, 317.72984215167446, 345.2632501306595, 311.43961160705874, 305.3289072502596, 335.29187185848014, 345.976451263029, 290.2102336821627, 300.77598512668453, 344.4908319111362, 333.5678676359406, 139.61202039969913, 350.8703181234171, 345.00434641544274, 280.2321968789973, 345.3299361564975, 314.59020351950005, 353.0549934244155, 101.78856201171891, 249.45695785854258, 308.9901794411847, 339.11605742348246, 313.82120796193135, 281.00025679050685, 351.37519038584, 310.502176487592, 342.66894531250045, 320.9012240731845, 369.3690035771703, 367.82221679687495, 330.7103572042285, 100.40041282059917, 79.64377601743354, 348.1115205140005, 348.60599561900307, 215.80972904450067, 301.65486987094414, 361.2208394396712, 301.60289421817606, 328.4371075093523, 310.5248177001293, 358.33167914797406, 323.19055821628956, 332.9346009633961, 338.89771051738177, 345.6609123344885, 331.8934130449438, 362.31083953106577, 357.47934311699055, 291.67306569311705, 348.8944442695928, 98.83135986328136, 341.432522512794, 356.7559557586321, 264.6667028687705, 292.1982167771039, 327.1341982038086, 249.49397720957387, 310.41568333284573, 316.4788906358605, 357.9846925425879, 352.09093187096727, 349.27357635350853, 322.21079763768597, 317.2555205326462, 345.3226634302773, 320.0624001670673, 344.9227608285887, 347.2267048426914, 320.4367177951194, 293.7214995290669, 297.25032358288075, 275.67328210281835, 307.0385274293951, 310.98746461127865, 353.05416881918615, 311.22883708694343, 317.87629826020714, 295.5610473476009, 353.778110461655, 348.712953802273, 331.8322556963063, 329.6486187026102, 337.61131597336856, 356.2595883964715, 329.7501200537812, 346.4513470123942, 338.50374390810686], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 15, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.625311638797289, "mean_inference_ms": 1.2289956655869454, "mean_action_processing_ms": 0.20587878194448664, "mean_env_wait_ms": 484.82867389072385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010143280029296875, "StateBufferConnector_ms": 0.006139993667602539, "ViewRequirementAgentConnector_ms": 0.166670560836792}, "num_episodes": 21, "episode_return_max": 370.6519497435647, "episode_return_min": 79.64377601743354, "episode_return_mean": 316.587237705195, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126432, "num_agent_steps_trained": 126432, "num_env_steps_sampled": 126432, "num_env_steps_trained": 126432, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.038772710999377, "num_env_steps_trained_throughput_per_sec": 10.038772710999377, "timesteps_total": 126432, "num_env_steps_sampled_lifetime": 126432, "num_agent_steps_sampled_lifetime": 126432, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 126432, "timers": {"training_iteration_time_ms": 94174.589, "restore_workers_time_ms": 0.015, "training_step_time_ms": 94174.549, "sample_time_ms": 92886.295, "load_time_ms": 0.393, "load_throughput": 2608410.658, "learn_time_ms": 1274.519, "learn_throughput": 805.009, "synch_weights_time_ms": 13.056}, "counters": {"num_env_steps_sampled": 126432, "num_env_steps_trained": 126432, "num_agent_steps_sampled": 126432, "num_agent_steps_trained": 126432}, "done": false, "episodes_total": 2823, "training_iteration": 137, "trial_id": "fe178_00005", "date": "2024-08-15_20-36-42", "timestamp": 1723775802, "time_this_iter_s": 102.20753455162048, "time_total_s": 12259.0399081707, "pid": 54428, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.07596288975414539, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9215562554580891, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 2052.832101583481, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 20.2513698630137, "ram_util_percent": 11.77671232876712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.498457926263413, "cur_kl_coeff": 0.16254938696364007, "cur_lr": 5e-06, "total_loss": 3.3802614632993935, "policy_loss": -0.002361692921840586, "vf_loss": 3.379273895298441, "vf_explained_var": 0.06904226007560889, "kl": 0.02060455926011932, "entropy": -1.4451952257504066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 126432, "num_env_steps_trained": 126432, "num_agent_steps_sampled": 126432, "num_agent_steps_trained": 126432}, "sampler_results": {"episode_reward_max": 365.9318173540444, "episode_reward_min": 223.00428436330952, "episode_reward_mean": 326.25983007141747, "episode_len_mean": 49.729729729729726, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 1840, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.2417949497223, 346.50780404867015, 350.36671985836085, 346.47299928591633, 344.9233124620977, 322.1474432306837, 323.751036835508, 314.53471859435496, 336.89483668842325, 306.1903846800782, 312.2092434484813, 313.54995198894636, 353.9111754506712, 365.9318173540444, 305.0208948819521, 303.786139631384, 351.4769503749108, 271.9275262752303, 351.90289420139345, 338.29622882561574, 223.00428436330952, 344.77153820352135, 312.9815132246648, 345.30368514208953, 354.1137702604175, 347.1887687349964, 349.5457136663932, 354.2135674233234, 346.89320713528247, 305.92354467278216, 346.04774579780985, 314.71641587113834, 355.238317014124, 302.2835383003387, 313.83158864711527, 272.990419346506, 311.5222217721872], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.242900113463544, "mean_inference_ms": 1.242685708750901, "mean_action_processing_ms": 0.20578525447928114, "mean_env_wait_ms": 451.38373749540375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012556926624194996, "StateBufferConnector_ms": 0.00573300026558541, "ViewRequirementAgentConnector_ms": 0.16526853716051257}, "num_episodes": 37, "episode_return_max": 365.9318173540444, "episode_return_min": 223.00428436330952, "episode_return_mean": 326.25983007141747}, "env_runner_results": {"episode_reward_max": 365.9318173540444, "episode_reward_min": 223.00428436330952, "episode_reward_mean": 326.25983007141747, "episode_len_mean": 49.729729729729726, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 1840, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.2417949497223, 346.50780404867015, 350.36671985836085, 346.47299928591633, 344.9233124620977, 322.1474432306837, 323.751036835508, 314.53471859435496, 336.89483668842325, 306.1903846800782, 312.2092434484813, 313.54995198894636, 353.9111754506712, 365.9318173540444, 305.0208948819521, 303.786139631384, 351.4769503749108, 271.9275262752303, 351.90289420139345, 338.29622882561574, 223.00428436330952, 344.77153820352135, 312.9815132246648, 345.30368514208953, 354.1137702604175, 347.1887687349964, 349.5457136663932, 354.2135674233234, 346.89320713528247, 305.92354467278216, 346.04774579780985, 314.71641587113834, 355.238317014124, 302.2835383003387, 313.83158864711527, 272.990419346506, 311.5222217721872], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.242900113463544, "mean_inference_ms": 1.242685708750901, "mean_action_processing_ms": 0.20578525447928114, "mean_env_wait_ms": 451.38373749540375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012556926624194996, "StateBufferConnector_ms": 0.00573300026558541, "ViewRequirementAgentConnector_ms": 0.16526853716051257}, "num_episodes": 37, "episode_return_max": 365.9318173540444, "episode_return_min": 223.00428436330952, "episode_return_mean": 326.25983007141747}, "episode_reward_max": 365.9318173540444, "episode_reward_min": 223.00428436330952, "episode_reward_mean": 326.25983007141747, "episode_len_mean": 49.729729729729726, "episodes_this_iter": 37, "episodes_timesteps_total": 1840, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [311.2417949497223, 346.50780404867015, 350.36671985836085, 346.47299928591633, 344.9233124620977, 322.1474432306837, 323.751036835508, 314.53471859435496, 336.89483668842325, 306.1903846800782, 312.2092434484813, 313.54995198894636, 353.9111754506712, 365.9318173540444, 305.0208948819521, 303.786139631384, 351.4769503749108, 271.9275262752303, 351.90289420139345, 338.29622882561574, 223.00428436330952, 344.77153820352135, 312.9815132246648, 345.30368514208953, 354.1137702604175, 347.1887687349964, 349.5457136663932, 354.2135674233234, 346.89320713528247, 305.92354467278216, 346.04774579780985, 314.71641587113834, 355.238317014124, 302.2835383003387, 313.83158864711527, 272.990419346506, 311.5222217721872], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.242900113463544, "mean_inference_ms": 1.242685708750901, "mean_action_processing_ms": 0.20578525447928114, "mean_env_wait_ms": 451.38373749540375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012556926624194996, "StateBufferConnector_ms": 0.00573300026558541, "ViewRequirementAgentConnector_ms": 0.16526853716051257}, "num_episodes": 37, "episode_return_max": 365.9318173540444, "episode_return_min": 223.00428436330952, "episode_return_mean": 326.25983007141747, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126432, "num_agent_steps_trained": 126432, "num_env_steps_sampled": 126432, "num_env_steps_trained": 126432, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 11.346547001793269, "num_env_steps_trained_throughput_per_sec": 11.346547001793269, "timesteps_total": 126432, "num_env_steps_sampled_lifetime": 126432, "num_agent_steps_sampled_lifetime": 126432, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 126432, "timers": {"training_iteration_time_ms": 180847.983, "restore_workers_time_ms": 0.015, "training_step_time_ms": 180847.927, "sample_time_ms": 173810.074, "load_time_ms": 0.811, "load_throughput": 2531385.826, "learn_time_ms": 7022.907, "learn_throughput": 292.187, "synch_weights_time_ms": 13.518}, "counters": {"num_env_steps_sampled": 126432, "num_env_steps_trained": 126432, "num_agent_steps_sampled": 126432, "num_agent_steps_trained": 126432}, "done": false, "episodes_total": 2821, "training_iteration": 126, "trial_id": "fe178_00005", "date": "2024-08-15_20-40-01", "timestamp": 1723776001, "time_this_iter_s": 180.8519322872162, "time_total_s": 12250.954303741455, "pid": 69869, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3122769925688852, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7894780888551545, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 180.8519322872162, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 22.55945945945946, "ram_util_percent": 11.415830115830119}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.38019889468948, "cur_kl_coeff": 0.2438240804454601, "cur_lr": 5e-06, "total_loss": 3.2806356163074573, "policy_loss": -0.00027374928734692127, "vf_loss": 3.2721289166559777, "vf_explained_var": 0.12143867276608944, "kl": 0.03601154113275774, "entropy": -1.3412140338371197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 720.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 128484, "num_env_steps_trained": 128484, "num_agent_steps_sampled": 128484, "num_agent_steps_trained": 128484}, "sampler_results": {"episode_reward_max": 367.15768491342646, "episode_reward_min": 79.74277503307786, "episode_reward_mean": 321.06372695552625, "episode_len_mean": 49.125, "episode_media": {}, "episodes_this_iter": 43, "episodes_timesteps_total": 3930, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.2417949497223, 346.50780404867015, 350.36671985836085, 346.47299928591633, 344.9233124620977, 322.1474432306837, 323.751036835508, 314.53471859435496, 336.89483668842325, 306.1903846800782, 312.2092434484813, 313.54995198894636, 353.9111754506712, 365.9318173540444, 305.0208948819521, 303.786139631384, 351.4769503749108, 271.9275262752303, 351.90289420139345, 338.29622882561574, 223.00428436330952, 344.77153820352135, 312.9815132246648, 345.30368514208953, 354.1137702604175, 347.1887687349964, 349.5457136663932, 354.2135674233234, 346.89320713528247, 305.92354467278216, 346.04774579780985, 314.71641587113834, 355.238317014124, 302.2835383003387, 313.83158864711527, 272.990419346506, 311.5222217721872, 350.3521774631831, 324.138834055677, 321.038799551465, 295.17009359937686, 268.8657798459677, 291.41041719310437, 350.1280247324145, 348.12574942025634, 358.64550576703294, 328.2826894781382, 343.9649715072015, 345.42472510873404, 360.1527297782571, 349.32448730468764, 295.0841415320293, 310.8721489432417, 312.6190699809689, 345.2487900043202, 330.36499023437545, 343.4248779296877, 345.6251457416742, 336.39781535358566, 79.74277503307786, 319.51547365677476, 327.91856277136236, 329.7073663543327, 354.4305024570274, 101.83653564453141, 347.1509955703773, 367.15768491342646, 348.90857178532417, 336.49719733846155, 321.482709942757, 333.8490542128977, 289.3490529967213, 321.4378834742446, 334.91955432624576, 305.42497756709105, 338.3452469020759, 284.6737905371552, 319.83582654430336, 332.3176929483355, 264.3210242977513], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.789945918600283, "mean_inference_ms": 1.239797275168002, "mean_action_processing_ms": 0.20545784287691057, "mean_env_wait_ms": 457.539716268189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011795461177825928, "StateBufferConnector_ms": 0.0057125091552734375, "ViewRequirementAgentConnector_ms": 0.16387909650802612}, "num_episodes": 43, "episode_return_max": 367.15768491342646, "episode_return_min": 79.74277503307786, "episode_return_mean": 321.06372695552625}, "env_runner_results": {"episode_reward_max": 367.15768491342646, "episode_reward_min": 79.74277503307786, "episode_reward_mean": 321.06372695552625, "episode_len_mean": 49.125, "episode_media": {}, "episodes_this_iter": 43, "episodes_timesteps_total": 3930, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.2417949497223, 346.50780404867015, 350.36671985836085, 346.47299928591633, 344.9233124620977, 322.1474432306837, 323.751036835508, 314.53471859435496, 336.89483668842325, 306.1903846800782, 312.2092434484813, 313.54995198894636, 353.9111754506712, 365.9318173540444, 305.0208948819521, 303.786139631384, 351.4769503749108, 271.9275262752303, 351.90289420139345, 338.29622882561574, 223.00428436330952, 344.77153820352135, 312.9815132246648, 345.30368514208953, 354.1137702604175, 347.1887687349964, 349.5457136663932, 354.2135674233234, 346.89320713528247, 305.92354467278216, 346.04774579780985, 314.71641587113834, 355.238317014124, 302.2835383003387, 313.83158864711527, 272.990419346506, 311.5222217721872, 350.3521774631831, 324.138834055677, 321.038799551465, 295.17009359937686, 268.8657798459677, 291.41041719310437, 350.1280247324145, 348.12574942025634, 358.64550576703294, 328.2826894781382, 343.9649715072015, 345.42472510873404, 360.1527297782571, 349.32448730468764, 295.0841415320293, 310.8721489432417, 312.6190699809689, 345.2487900043202, 330.36499023437545, 343.4248779296877, 345.6251457416742, 336.39781535358566, 79.74277503307786, 319.51547365677476, 327.91856277136236, 329.7073663543327, 354.4305024570274, 101.83653564453141, 347.1509955703773, 367.15768491342646, 348.90857178532417, 336.49719733846155, 321.482709942757, 333.8490542128977, 289.3490529967213, 321.4378834742446, 334.91955432624576, 305.42497756709105, 338.3452469020759, 284.6737905371552, 319.83582654430336, 332.3176929483355, 264.3210242977513], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.789945918600283, "mean_inference_ms": 1.239797275168002, "mean_action_processing_ms": 0.20545784287691057, "mean_env_wait_ms": 457.539716268189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011795461177825928, "StateBufferConnector_ms": 0.0057125091552734375, "ViewRequirementAgentConnector_ms": 0.16387909650802612}, "num_episodes": 43, "episode_return_max": 367.15768491342646, "episode_return_min": 79.74277503307786, "episode_return_mean": 321.06372695552625}, "episode_reward_max": 367.15768491342646, "episode_reward_min": 79.74277503307786, "episode_reward_mean": 321.06372695552625, "episode_len_mean": 49.125, "episodes_this_iter": 43, "episodes_timesteps_total": 3930, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [311.2417949497223, 346.50780404867015, 350.36671985836085, 346.47299928591633, 344.9233124620977, 322.1474432306837, 323.751036835508, 314.53471859435496, 336.89483668842325, 306.1903846800782, 312.2092434484813, 313.54995198894636, 353.9111754506712, 365.9318173540444, 305.0208948819521, 303.786139631384, 351.4769503749108, 271.9275262752303, 351.90289420139345, 338.29622882561574, 223.00428436330952, 344.77153820352135, 312.9815132246648, 345.30368514208953, 354.1137702604175, 347.1887687349964, 349.5457136663932, 354.2135674233234, 346.89320713528247, 305.92354467278216, 346.04774579780985, 314.71641587113834, 355.238317014124, 302.2835383003387, 313.83158864711527, 272.990419346506, 311.5222217721872, 350.3521774631831, 324.138834055677, 321.038799551465, 295.17009359937686, 268.8657798459677, 291.41041719310437, 350.1280247324145, 348.12574942025634, 358.64550576703294, 328.2826894781382, 343.9649715072015, 345.42472510873404, 360.1527297782571, 349.32448730468764, 295.0841415320293, 310.8721489432417, 312.6190699809689, 345.2487900043202, 330.36499023437545, 343.4248779296877, 345.6251457416742, 336.39781535358566, 79.74277503307786, 319.51547365677476, 327.91856277136236, 329.7073663543327, 354.4305024570274, 101.83653564453141, 347.1509955703773, 367.15768491342646, 348.90857178532417, 336.49719733846155, 321.482709942757, 333.8490542128977, 289.3490529967213, 321.4378834742446, 334.91955432624576, 305.42497756709105, 338.3452469020759, 284.6737905371552, 319.83582654430336, 332.3176929483355, 264.3210242977513], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.789945918600283, "mean_inference_ms": 1.239797275168002, "mean_action_processing_ms": 0.20545784287691057, "mean_env_wait_ms": 457.539716268189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011795461177825928, "StateBufferConnector_ms": 0.0057125091552734375, "ViewRequirementAgentConnector_ms": 0.16387909650802612}, "num_episodes": 43, "episode_return_max": 367.15768491342646, "episode_return_min": 79.74277503307786, "episode_return_mean": 321.06372695552625, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128484, "num_agent_steps_trained": 128484, "num_env_steps_sampled": 128484, "num_env_steps_trained": 128484, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 10.336171570312091, "num_env_steps_trained_throughput_per_sec": 10.336171570312091, "timesteps_total": 128484, "num_env_steps_sampled_lifetime": 128484, "num_agent_steps_sampled_lifetime": 128484, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 128484, "timers": {"training_iteration_time_ms": 189687.057, "restore_workers_time_ms": 0.02, "training_step_time_ms": 189686.992, "sample_time_ms": 184889.886, "load_time_ms": 0.65, "load_throughput": 3159005.986, "learn_time_ms": 4782.547, "learn_throughput": 429.06, "synch_weights_time_ms": 13.41}, "counters": {"num_env_steps_sampled": 128484, "num_env_steps_trained": 128484, "num_agent_steps_sampled": 128484, "num_agent_steps_trained": 128484}, "done": false, "episodes_total": 2864, "training_iteration": 127, "trial_id": "fe178_00005", "date": "2024-08-15_20-43-20", "timestamp": 1723776200, "time_this_iter_s": 198.52976274490356, "time_total_s": 12449.484066486359, "pid": 69869, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3122769925688852, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7894780888551545, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 379.38169503211975, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.72226148409894, "ram_util_percent": 11.290812720848058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.031192525227866, "cur_kl_coeff": 0.1542949259068927, "cur_lr": 0.00010000000000000003, "total_loss": 5.260425398250421, "policy_loss": -0.0030612684068425247, "vf_loss": 5.258242269357045, "vf_explained_var": 0.15920790359377862, "kl": 0.0339890625201726, "entropy": -1.5371944266060988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 129510, "num_env_steps_trained": 129510, "num_agent_steps_sampled": 129510, "num_agent_steps_trained": 129510}, "sampler_results": {"episode_reward_max": 358.69014892578093, "episode_reward_min": 137.5606689453125, "episode_reward_mean": 322.2154584796471, "episode_len_mean": 48.55555555555556, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 874, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.6605834960942, 318.58413967086557, 349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.199335342229799, "mean_inference_ms": 1.2529617132142534, "mean_action_processing_ms": 0.20637807919997575, "mean_env_wait_ms": 431.2303819397623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01217259301079644, "StateBufferConnector_ms": 0.005959139929877387, "ViewRequirementAgentConnector_ms": 0.166471799214681}, "num_episodes": 18, "episode_return_max": 358.69014892578093, "episode_return_min": 137.5606689453125, "episode_return_mean": 322.2154584796471}, "env_runner_results": {"episode_reward_max": 358.69014892578093, "episode_reward_min": 137.5606689453125, "episode_reward_mean": 322.2154584796471, "episode_len_mean": 48.55555555555556, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 874, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.6605834960942, 318.58413967086557, 349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.199335342229799, "mean_inference_ms": 1.2529617132142534, "mean_action_processing_ms": 0.20637807919997575, "mean_env_wait_ms": 431.2303819397623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01217259301079644, "StateBufferConnector_ms": 0.005959139929877387, "ViewRequirementAgentConnector_ms": 0.166471799214681}, "num_episodes": 18, "episode_return_max": 358.69014892578093, "episode_return_min": 137.5606689453125, "episode_return_mean": 322.2154584796471}, "episode_reward_max": 358.69014892578093, "episode_reward_min": 137.5606689453125, "episode_reward_mean": 322.2154584796471, "episode_len_mean": 48.55555555555556, "episodes_this_iter": 18, "episodes_timesteps_total": 874, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [344.6605834960942, 318.58413967086557, 349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.199335342229799, "mean_inference_ms": 1.2529617132142534, "mean_action_processing_ms": 0.20637807919997575, "mean_env_wait_ms": 431.2303819397623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01217259301079644, "StateBufferConnector_ms": 0.005959139929877387, "ViewRequirementAgentConnector_ms": 0.166471799214681}, "num_episodes": 18, "episode_return_max": 358.69014892578093, "episode_return_min": 137.5606689453125, "episode_return_mean": 322.2154584796471, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129510, "num_agent_steps_trained": 129510, "num_env_steps_sampled": 129510, "num_env_steps_trained": 129510, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 12.001688843509914, "num_env_steps_trained_throughput_per_sec": 12.001688843509914, "timesteps_total": 129510, "num_env_steps_sampled_lifetime": 129510, "num_agent_steps_sampled_lifetime": 129510, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 129510, "timers": {"training_iteration_time_ms": 85487.985, "restore_workers_time_ms": 0.022, "training_step_time_ms": 85487.915, "sample_time_ms": 80073.579, "load_time_ms": 0.777, "load_throughput": 1321263.71, "learn_time_ms": 5400.353, "learn_throughput": 189.988, "synch_weights_time_ms": 12.753}, "counters": {"num_env_steps_sampled": 129510, "num_env_steps_trained": 129510, "num_agent_steps_sampled": 129510, "num_agent_steps_trained": 129510}, "done": false, "episodes_total": 2876, "training_iteration": 135, "trial_id": "fe178_00005", "date": "2024-08-15_20-45-04", "timestamp": 1723776304, "time_this_iter_s": 85.49135494232178, "time_total_s": 12495.507354736328, "pid": 11366, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3784888502678799, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7297845213991309, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 85.49135494232178, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 24.191869918699187, "ram_util_percent": 10.617073170731706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.05859445730844, "cur_kl_coeff": 0.231442388860339, "cur_lr": 0.00010000000000000003, "total_loss": 5.075155216952165, "policy_loss": 0.012117572400408486, "vf_loss": 5.050977148860693, "vf_explained_var": 0.10844991654157639, "kl": 0.052110292282307125, "entropy": -1.6170189412931602, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 130536, "num_env_steps_trained": 130536, "num_agent_steps_sampled": 130536, "num_agent_steps_trained": 130536}, "sampler_results": {"episode_reward_max": 372.1595881004341, "episode_reward_min": 137.5606689453125, "episode_reward_mean": 329.3433799456775, "episode_len_mean": 49.2972972972973, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 1824, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.6605834960942, 318.58413967086557, 349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557, 349.8196258439262, 358.22158303839524, 310.54648809337743, 355.9114046039315, 349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.245848236417281, "mean_inference_ms": 1.2494350446826907, "mean_action_processing_ms": 0.20613441862446774, "mean_env_wait_ms": 465.86119282892736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012689023404508023, "StateBufferConnector_ms": 0.00590182639457084, "ViewRequirementAgentConnector_ms": 0.1659187110694679}, "num_episodes": 19, "episode_return_max": 372.1595881004341, "episode_return_min": 137.5606689453125, "episode_return_mean": 329.3433799456775}, "env_runner_results": {"episode_reward_max": 372.1595881004341, "episode_reward_min": 137.5606689453125, "episode_reward_mean": 329.3433799456775, "episode_len_mean": 49.2972972972973, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 1824, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.6605834960942, 318.58413967086557, 349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557, 349.8196258439262, 358.22158303839524, 310.54648809337743, 355.9114046039315, 349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.245848236417281, "mean_inference_ms": 1.2494350446826907, "mean_action_processing_ms": 0.20613441862446774, "mean_env_wait_ms": 465.86119282892736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012689023404508023, "StateBufferConnector_ms": 0.00590182639457084, "ViewRequirementAgentConnector_ms": 0.1659187110694679}, "num_episodes": 19, "episode_return_max": 372.1595881004341, "episode_return_min": 137.5606689453125, "episode_return_mean": 329.3433799456775}, "episode_reward_max": 372.1595881004341, "episode_reward_min": 137.5606689453125, "episode_reward_mean": 329.3433799456775, "episode_len_mean": 49.2972972972973, "episodes_this_iter": 19, "episodes_timesteps_total": 1824, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [344.6605834960942, 318.58413967086557, 349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557, 349.8196258439262, 358.22158303839524, 310.54648809337743, 355.9114046039315, 349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.245848236417281, "mean_inference_ms": 1.2494350446826907, "mean_action_processing_ms": 0.20613441862446774, "mean_env_wait_ms": 465.86119282892736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012689023404508023, "StateBufferConnector_ms": 0.00590182639457084, "ViewRequirementAgentConnector_ms": 0.1659187110694679}, "num_episodes": 19, "episode_return_max": 372.1595881004341, "episode_return_min": 137.5606689453125, "episode_return_mean": 329.3433799456775, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130536, "num_agent_steps_trained": 130536, "num_env_steps_sampled": 130536, "num_env_steps_trained": 130536, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.671989228070661, "num_env_steps_trained_throughput_per_sec": 9.671989228070661, "timesteps_total": 130536, "num_env_steps_sampled_lifetime": 130536, "num_agent_steps_sampled_lifetime": 130536, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 130536, "timers": {"training_iteration_time_ms": 95783.759, "restore_workers_time_ms": 0.019, "training_step_time_ms": 95783.697, "sample_time_ms": 92409.389, "load_time_ms": 0.579, "load_throughput": 1773482.755, "learn_time_ms": 3360.169, "learn_throughput": 305.342, "synch_weights_time_ms": 13.178}, "counters": {"num_env_steps_sampled": 130536, "num_env_steps_trained": 130536, "num_agent_steps_sampled": 130536, "num_agent_steps_trained": 130536}, "done": false, "episodes_total": 2895, "training_iteration": 136, "trial_id": "fe178_00005", "date": "2024-08-15_20-46-50", "timestamp": 1723776410, "time_this_iter_s": 106.08298063278198, "time_total_s": 12601.59033536911, "pid": 11366, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3784888502678799, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7297845213991309, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 191.57433557510376, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.666225165562917, "ram_util_percent": 10.711258278145694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.82618408997853, "cur_kl_coeff": 0.3471635832905085, "cur_lr": 0.00010000000000000003, "total_loss": 5.3778548260529835, "policy_loss": -0.0013412158315380415, "vf_loss": 5.376795503000419, "vf_explained_var": 0.05959055299560229, "kl": 0.006914734658982531, "entropy": -1.8036009699106217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 131562, "num_env_steps_trained": 131562, "num_agent_steps_sampled": 131562, "num_agent_steps_trained": 131562}, "sampler_results": {"episode_reward_max": 372.1595881004341, "episode_reward_min": 137.5606689453125, "episode_reward_mean": 329.64641446490003, "episode_len_mean": 49.233333333333334, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 2954, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.6605834960942, 318.58413967086557, 349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557, 349.8196258439262, 358.22158303839524, 310.54648809337743, 355.9114046039315, 349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341, 350.9179074343444, 335.6070918590972, 312.0041648846369, 162.5877961735033, 309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.366042939504191, "mean_inference_ms": 1.2489732129309794, "mean_action_processing_ms": 0.2061457604781327, "mean_env_wait_ms": 472.83364201471164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012596845626831055, "StateBufferConnector_ms": 0.0059346357981363935, "ViewRequirementAgentConnector_ms": 0.165635347366333}, "num_episodes": 23, "episode_return_max": 372.1595881004341, "episode_return_min": 137.5606689453125, "episode_return_mean": 329.64641446490003}, "env_runner_results": {"episode_reward_max": 372.1595881004341, "episode_reward_min": 137.5606689453125, "episode_reward_mean": 329.64641446490003, "episode_len_mean": 49.233333333333334, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 2954, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.6605834960942, 318.58413967086557, 349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557, 349.8196258439262, 358.22158303839524, 310.54648809337743, 355.9114046039315, 349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341, 350.9179074343444, 335.6070918590972, 312.0041648846369, 162.5877961735033, 309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.366042939504191, "mean_inference_ms": 1.2489732129309794, "mean_action_processing_ms": 0.2061457604781327, "mean_env_wait_ms": 472.83364201471164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012596845626831055, "StateBufferConnector_ms": 0.0059346357981363935, "ViewRequirementAgentConnector_ms": 0.165635347366333}, "num_episodes": 23, "episode_return_max": 372.1595881004341, "episode_return_min": 137.5606689453125, "episode_return_mean": 329.64641446490003}, "episode_reward_max": 372.1595881004341, "episode_reward_min": 137.5606689453125, "episode_reward_mean": 329.64641446490003, "episode_len_mean": 49.233333333333334, "episodes_this_iter": 23, "episodes_timesteps_total": 2954, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [344.6605834960942, 318.58413967086557, 349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557, 349.8196258439262, 358.22158303839524, 310.54648809337743, 355.9114046039315, 349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341, 350.9179074343444, 335.6070918590972, 312.0041648846369, 162.5877961735033, 309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.366042939504191, "mean_inference_ms": 1.2489732129309794, "mean_action_processing_ms": 0.2061457604781327, "mean_env_wait_ms": 472.83364201471164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012596845626831055, "StateBufferConnector_ms": 0.0059346357981363935, "ViewRequirementAgentConnector_ms": 0.165635347366333}, "num_episodes": 23, "episode_return_max": 372.1595881004341, "episode_return_min": 137.5606689453125, "episode_return_mean": 329.64641446490003, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131562, "num_agent_steps_trained": 131562, "num_env_steps_sampled": 131562, "num_env_steps_trained": 131562, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.950027601503223, "num_env_steps_trained_throughput_per_sec": 11.950027601503223, "timesteps_total": 131562, "num_env_steps_sampled_lifetime": 131562, "num_agent_steps_sampled_lifetime": 131562, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 131562, "timers": {"training_iteration_time_ms": 92475.024, "restore_workers_time_ms": 0.018, "training_step_time_ms": 92474.965, "sample_time_ms": 89793.875, "load_time_ms": 0.516, "load_throughput": 1987387.271, "learn_time_ms": 2667.222, "learn_throughput": 384.67, "synch_weights_time_ms": 13.012}, "counters": {"num_env_steps_sampled": 131562, "num_env_steps_trained": 131562, "num_agent_steps_sampled": 131562, "num_agent_steps_trained": 131562}, "done": false, "episodes_total": 2918, "training_iteration": 137, "trial_id": "fe178_00005", "date": "2024-08-15_20-48-16", "timestamp": 1723776496, "time_this_iter_s": 85.86078333854675, "time_total_s": 12687.451118707657, "pid": 11366, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3784888502678799, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7297845213991309, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 277.4351189136505, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.736585365853653, "ram_util_percent": 10.818699186991871}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.26792305310567, "cur_kl_coeff": 0.3471635832905085, "cur_lr": 0.00010000000000000003, "total_loss": 5.079809388021628, "policy_loss": -0.004488701835119476, "vf_loss": 5.081802891691526, "vf_explained_var": 0.07271134704351426, "kl": 0.007187317890083496, "entropy": -1.7410277610023817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 132588, "num_env_steps_trained": 132588, "num_agent_steps_sampled": 132588, "num_agent_steps_trained": 132588}, "sampler_results": {"episode_reward_max": 372.1595881004341, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 330.3475947299077, "episode_len_mean": 49.08641975308642, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 3976, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.6605834960942, 318.58413967086557, 349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557, 349.8196258439262, 358.22158303839524, 310.54648809337743, 355.9114046039315, 349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341, 350.9179074343444, 335.6070918590972, 312.0041648846369, 162.5877961735033, 309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306, 354.6882111030864, 353.10333925749836, 360.2045229229372, 316.7634953185894, 316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.429477359558404, "mean_inference_ms": 1.2471911364818957, "mean_action_processing_ms": 0.2060696931824684, "mean_env_wait_ms": 474.8487972494116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011766104050624518, "StateBufferConnector_ms": 0.005876576458966291, "ViewRequirementAgentConnector_ms": 0.1657883326212565}, "num_episodes": 21, "episode_return_max": 372.1595881004341, "episode_return_min": 104.95859375000009, "episode_return_mean": 330.3475947299077}, "env_runner_results": {"episode_reward_max": 372.1595881004341, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 330.3475947299077, "episode_len_mean": 49.08641975308642, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 3976, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.6605834960942, 318.58413967086557, 349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557, 349.8196258439262, 358.22158303839524, 310.54648809337743, 355.9114046039315, 349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341, 350.9179074343444, 335.6070918590972, 312.0041648846369, 162.5877961735033, 309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306, 354.6882111030864, 353.10333925749836, 360.2045229229372, 316.7634953185894, 316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.429477359558404, "mean_inference_ms": 1.2471911364818957, "mean_action_processing_ms": 0.2060696931824684, "mean_env_wait_ms": 474.8487972494116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011766104050624518, "StateBufferConnector_ms": 0.005876576458966291, "ViewRequirementAgentConnector_ms": 0.1657883326212565}, "num_episodes": 21, "episode_return_max": 372.1595881004341, "episode_return_min": 104.95859375000009, "episode_return_mean": 330.3475947299077}, "episode_reward_max": 372.1595881004341, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 330.3475947299077, "episode_len_mean": 49.08641975308642, "episodes_this_iter": 21, "episodes_timesteps_total": 3976, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [344.6605834960942, 318.58413967086557, 349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557, 349.8196258439262, 358.22158303839524, 310.54648809337743, 355.9114046039315, 349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341, 350.9179074343444, 335.6070918590972, 312.0041648846369, 162.5877961735033, 309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306, 354.6882111030864, 353.10333925749836, 360.2045229229372, 316.7634953185894, 316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.429477359558404, "mean_inference_ms": 1.2471911364818957, "mean_action_processing_ms": 0.2060696931824684, "mean_env_wait_ms": 474.8487972494116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011766104050624518, "StateBufferConnector_ms": 0.005876576458966291, "ViewRequirementAgentConnector_ms": 0.1657883326212565}, "num_episodes": 21, "episode_return_max": 372.1595881004341, "episode_return_min": 104.95859375000009, "episode_return_mean": 330.3475947299077, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132588, "num_agent_steps_trained": 132588, "num_env_steps_sampled": 132588, "num_env_steps_trained": 132588, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.551270949087156, "num_env_steps_trained_throughput_per_sec": 10.551270949087156, "timesteps_total": 132588, "num_env_steps_sampled_lifetime": 132588, "num_agent_steps_sampled_lifetime": 132588, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 132588, "timers": {"training_iteration_time_ms": 93666.139, "restore_workers_time_ms": 0.018, "training_step_time_ms": 93666.079, "sample_time_ms": 91341.299, "load_time_ms": 0.496, "load_throughput": 2069169.806, "learn_time_ms": 2310.922, "learn_throughput": 443.979, "synch_weights_time_ms": 13.04}, "counters": {"num_env_steps_sampled": 132588, "num_env_steps_trained": 132588, "num_agent_steps_sampled": 132588, "num_agent_steps_trained": 132588}, "done": false, "episodes_total": 2939, "training_iteration": 138, "trial_id": "fe178_00005", "date": "2024-08-15_20-49-53", "timestamp": 1723776593, "time_this_iter_s": 97.2435302734375, "time_total_s": 12784.694648981094, "pid": 11366, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3784888502678799, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7297845213991309, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 374.678649187088, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.41798561151079, "ram_util_percent": 10.910071942446045}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.767736959457395, "cur_kl_coeff": 0.3471635832905085, "cur_lr": 0.00010000000000000003, "total_loss": 5.0736809780200325, "policy_loss": -0.007576242896417776, "vf_loss": 5.079673052827517, "vf_explained_var": 0.14920244887471198, "kl": 0.0045632000388347175, "entropy": -1.476789266616106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 133614, "num_env_steps_trained": 133614, "num_agent_steps_sampled": 133614, "num_agent_steps_trained": 133614}, "sampler_results": {"episode_reward_max": 372.1595881004341, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 327.22802528657394, "episode_len_mean": 49.1, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4910, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557, 349.8196258439262, 358.22158303839524, 310.54648809337743, 355.9114046039315, 349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341, 350.9179074343444, 335.6070918590972, 312.0041648846369, 162.5877961735033, 309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306, 354.6882111030864, 353.10333925749836, 360.2045229229372, 316.7634953185894, 316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214, 354.12049032649173, 346.0881286223785, 362.55757755931813, 345.67766170951734, 352.48350541374816, 326.0507164585341, 313.7503051844586, 347.31540614434624, 237.5810656605513, 295.65047200629004, 328.8836943299006, 352.46920383167446, 142.9231229397974, 318.4338810078294, 351.0188816300159, 291.39725382948444, 316.774823351747, 302.0598618059498, 319.7738577857634, 305.12012913606435, 317.76203996797443], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.472769006105223, "mean_inference_ms": 1.2454037383586776, "mean_action_processing_ms": 0.20593110317232202, "mean_env_wait_ms": 476.3664679523567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011303901672363281, "StateBufferConnector_ms": 0.005871772766113281, "ViewRequirementAgentConnector_ms": 0.16578102111816406}, "num_episodes": 21, "episode_return_max": 372.1595881004341, "episode_return_min": 104.95859375000009, "episode_return_mean": 327.22802528657394}, "env_runner_results": {"episode_reward_max": 372.1595881004341, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 327.22802528657394, "episode_len_mean": 49.1, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4910, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557, 349.8196258439262, 358.22158303839524, 310.54648809337743, 355.9114046039315, 349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341, 350.9179074343444, 335.6070918590972, 312.0041648846369, 162.5877961735033, 309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306, 354.6882111030864, 353.10333925749836, 360.2045229229372, 316.7634953185894, 316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214, 354.12049032649173, 346.0881286223785, 362.55757755931813, 345.67766170951734, 352.48350541374816, 326.0507164585341, 313.7503051844586, 347.31540614434624, 237.5810656605513, 295.65047200629004, 328.8836943299006, 352.46920383167446, 142.9231229397974, 318.4338810078294, 351.0188816300159, 291.39725382948444, 316.774823351747, 302.0598618059498, 319.7738577857634, 305.12012913606435, 317.76203996797443], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.472769006105223, "mean_inference_ms": 1.2454037383586776, "mean_action_processing_ms": 0.20593110317232202, "mean_env_wait_ms": 476.3664679523567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011303901672363281, "StateBufferConnector_ms": 0.005871772766113281, "ViewRequirementAgentConnector_ms": 0.16578102111816406}, "num_episodes": 21, "episode_return_max": 372.1595881004341, "episode_return_min": 104.95859375000009, "episode_return_mean": 327.22802528657394}, "episode_reward_max": 372.1595881004341, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 327.22802528657394, "episode_len_mean": 49.1, "episodes_this_iter": 21, "episodes_timesteps_total": 4910, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [349.39926274760586, 297.6278240590005, 289.8385590306366, 313.3380858179304, 333.90223782028, 331.8263353039224, 319.9669313902257, 353.1005873165597, 358.69014892578093, 313.24281669595126, 352.8611343657273, 338.98682647805975, 351.22920518887247, 345.8505413408667, 137.5606689453125, 349.2123640399557, 349.8196258439262, 358.22158303839524, 310.54648809337743, 355.9114046039315, 349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341, 350.9179074343444, 335.6070918590972, 312.0041648846369, 162.5877961735033, 309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306, 354.6882111030864, 353.10333925749836, 360.2045229229372, 316.7634953185894, 316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214, 354.12049032649173, 346.0881286223785, 362.55757755931813, 345.67766170951734, 352.48350541374816, 326.0507164585341, 313.7503051844586, 347.31540614434624, 237.5810656605513, 295.65047200629004, 328.8836943299006, 352.46920383167446, 142.9231229397974, 318.4338810078294, 351.0188816300159, 291.39725382948444, 316.774823351747, 302.0598618059498, 319.7738577857634, 305.12012913606435, 317.76203996797443], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.472769006105223, "mean_inference_ms": 1.2454037383586776, "mean_action_processing_ms": 0.20593110317232202, "mean_env_wait_ms": 476.3664679523567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011303901672363281, "StateBufferConnector_ms": 0.005871772766113281, "ViewRequirementAgentConnector_ms": 0.16578102111816406}, "num_episodes": 21, "episode_return_max": 372.1595881004341, "episode_return_min": 104.95859375000009, "episode_return_mean": 327.22802528657394, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133614, "num_agent_steps_trained": 133614, "num_env_steps_sampled": 133614, "num_env_steps_trained": 133614, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.674295378086784, "num_env_steps_trained_throughput_per_sec": 11.674295378086784, "timesteps_total": 133614, "num_env_steps_sampled_lifetime": 133614, "num_agent_steps_sampled_lifetime": 133614, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 133614, "timers": {"training_iteration_time_ms": 92509.992, "restore_workers_time_ms": 0.018, "training_step_time_ms": 92509.934, "sample_time_ms": 90406.659, "load_time_ms": 0.477, "load_throughput": 2150817.625, "learn_time_ms": 2089.556, "learn_throughput": 491.013, "synch_weights_time_ms": 12.933}, "counters": {"num_env_steps_sampled": 133614, "num_env_steps_trained": 133614, "num_agent_steps_sampled": 133614, "num_agent_steps_trained": 133614}, "done": false, "episodes_total": 2960, "training_iteration": 139, "trial_id": "fe178_00005", "date": "2024-08-15_20-51-21", "timestamp": 1723776681, "time_this_iter_s": 87.88863253593445, "time_total_s": 12872.583281517029, "pid": 11366, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3784888502678799, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7297845213991309, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 462.56728172302246, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 22.636000000000006, "ram_util_percent": 10.833600000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.88188607394695, "cur_kl_coeff": 0.17358179164525425, "cur_lr": 0.00010000000000000003, "total_loss": 4.946708912650744, "policy_loss": 0.004352533580580105, "vf_loss": 4.910858786106109, "vf_explained_var": 0.09032502720753352, "kl": 0.1814568960942495, "entropy": -1.489192459732294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 134640, "num_env_steps_trained": 134640, "num_agent_steps_sampled": 134640, "num_agent_steps_trained": 134640}, "sampler_results": {"episode_reward_max": 372.1595881004341, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 327.51402400978617, "episode_len_mean": 49.11, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4911, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341, 350.9179074343444, 335.6070918590972, 312.0041648846369, 162.5877961735033, 309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306, 354.6882111030864, 353.10333925749836, 360.2045229229372, 316.7634953185894, 316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214, 354.12049032649173, 346.0881286223785, 362.55757755931813, 345.67766170951734, 352.48350541374816, 326.0507164585341, 313.7503051844586, 347.31540614434624, 237.5810656605513, 295.65047200629004, 328.8836943299006, 352.46920383167446, 142.9231229397974, 318.4338810078294, 351.0188816300159, 291.39725382948444, 316.774823351747, 302.0598618059498, 319.7738577857634, 305.12012913606435, 317.76203996797443, 315.70803352158293, 342.12245698896635, 355.92419460674734, 355.14133521303717, 352.73082095760844, 340.68695645301153, 356.6248966535759, 348.26026352580647, 303.92501089266653, 354.9294714892796, 370.6721747518371, 310.34386295298896, 336.84072686449264, 356.9257873979613, 315.3760768818142, 291.71282759455374, 354.09838971208535, 288.3832008908297, 140.46561041318057, 348.8604056055093], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.556538163345883, "mean_inference_ms": 1.2425465791283068, "mean_action_processing_ms": 0.20582263001341589, "mean_env_wait_ms": 483.49978988098826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010706663131713867, "StateBufferConnector_ms": 0.005835533142089844, "ViewRequirementAgentConnector_ms": 0.1654202938079834}, "num_episodes": 20, "episode_return_max": 372.1595881004341, "episode_return_min": 104.95859375000009, "episode_return_mean": 327.51402400978617}, "env_runner_results": {"episode_reward_max": 372.1595881004341, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 327.51402400978617, "episode_len_mean": 49.11, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4911, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341, 350.9179074343444, 335.6070918590972, 312.0041648846369, 162.5877961735033, 309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306, 354.6882111030864, 353.10333925749836, 360.2045229229372, 316.7634953185894, 316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214, 354.12049032649173, 346.0881286223785, 362.55757755931813, 345.67766170951734, 352.48350541374816, 326.0507164585341, 313.7503051844586, 347.31540614434624, 237.5810656605513, 295.65047200629004, 328.8836943299006, 352.46920383167446, 142.9231229397974, 318.4338810078294, 351.0188816300159, 291.39725382948444, 316.774823351747, 302.0598618059498, 319.7738577857634, 305.12012913606435, 317.76203996797443, 315.70803352158293, 342.12245698896635, 355.92419460674734, 355.14133521303717, 352.73082095760844, 340.68695645301153, 356.6248966535759, 348.26026352580647, 303.92501089266653, 354.9294714892796, 370.6721747518371, 310.34386295298896, 336.84072686449264, 356.9257873979613, 315.3760768818142, 291.71282759455374, 354.09838971208535, 288.3832008908297, 140.46561041318057, 348.8604056055093], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.556538163345883, "mean_inference_ms": 1.2425465791283068, "mean_action_processing_ms": 0.20582263001341589, "mean_env_wait_ms": 483.49978988098826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010706663131713867, "StateBufferConnector_ms": 0.005835533142089844, "ViewRequirementAgentConnector_ms": 0.1654202938079834}, "num_episodes": 20, "episode_return_max": 372.1595881004341, "episode_return_min": 104.95859375000009, "episode_return_mean": 327.51402400978617}, "episode_reward_max": 372.1595881004341, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 327.51402400978617, "episode_len_mean": 49.11, "episodes_this_iter": 20, "episodes_timesteps_total": 4911, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [349.9636072905091, 331.04871025760957, 349.0726938213475, 348.5362548828127, 234.78937176783091, 337.7802322491825, 351.6937658599081, 292.2319474199127, 350.67275620893383, 327.7208301035937, 352.72006469034295, 329.78384556354234, 340.478486249953, 342.67554931087494, 372.1595881004341, 350.9179074343444, 335.6070918590972, 312.0041648846369, 162.5877961735033, 309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306, 354.6882111030864, 353.10333925749836, 360.2045229229372, 316.7634953185894, 316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214, 354.12049032649173, 346.0881286223785, 362.55757755931813, 345.67766170951734, 352.48350541374816, 326.0507164585341, 313.7503051844586, 347.31540614434624, 237.5810656605513, 295.65047200629004, 328.8836943299006, 352.46920383167446, 142.9231229397974, 318.4338810078294, 351.0188816300159, 291.39725382948444, 316.774823351747, 302.0598618059498, 319.7738577857634, 305.12012913606435, 317.76203996797443, 315.70803352158293, 342.12245698896635, 355.92419460674734, 355.14133521303717, 352.73082095760844, 340.68695645301153, 356.6248966535759, 348.26026352580647, 303.92501089266653, 354.9294714892796, 370.6721747518371, 310.34386295298896, 336.84072686449264, 356.9257873979613, 315.3760768818142, 291.71282759455374, 354.09838971208535, 288.3832008908297, 140.46561041318057, 348.8604056055093], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.556538163345883, "mean_inference_ms": 1.2425465791283068, "mean_action_processing_ms": 0.20582263001341589, "mean_env_wait_ms": 483.49978988098826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010706663131713867, "StateBufferConnector_ms": 0.005835533142089844, "ViewRequirementAgentConnector_ms": 0.1654202938079834}, "num_episodes": 20, "episode_return_max": 372.1595881004341, "episode_return_min": 104.95859375000009, "episode_return_mean": 327.51402400978617, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134640, "num_agent_steps_trained": 134640, "num_env_steps_sampled": 134640, "num_env_steps_trained": 134640, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.99984530174767, "num_env_steps_trained_throughput_per_sec": 10.99984530174767, "timesteps_total": 134640, "num_env_steps_sampled_lifetime": 134640, "num_agent_steps_sampled_lifetime": 134640, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 134640, "timers": {"training_iteration_time_ms": 92637.335, "restore_workers_time_ms": 0.017, "training_step_time_ms": 92637.279, "sample_time_ms": 90661.77, "load_time_ms": 0.463, "load_throughput": 2214229.948, "learn_time_ms": 1961.752, "learn_throughput": 523.002, "synch_weights_time_ms": 12.985}, "counters": {"num_env_steps_sampled": 134640, "num_env_steps_trained": 134640, "num_agent_steps_sampled": 134640, "num_agent_steps_trained": 134640}, "done": false, "episodes_total": 2980, "training_iteration": 140, "trial_id": "fe178_00005", "date": "2024-08-15_20-52-54", "timestamp": 1723776774, "time_this_iter_s": 93.2775297164917, "time_total_s": 12965.86081123352, "pid": 11366, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3784888502678799, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7297845213991309, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 555.8448114395142, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.26917293233083, "ram_util_percent": 10.948120300751881}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72.45753136078517, "cur_kl_coeff": 0.2603726874678815, "cur_lr": 0.00010000000000000003, "total_loss": 4.7885289770861466, "policy_loss": 0.013247843141046663, "vf_loss": 4.759493268529574, "vf_explained_var": 0.08820951879024505, "kl": 0.06063559032700381, "entropy": -1.5208129093050957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 135666, "num_env_steps_trained": 135666, "num_agent_steps_sampled": 135666, "num_agent_steps_trained": 135666}, "sampler_results": {"episode_reward_max": 370.6721747518371, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 329.5213032264517, "episode_len_mean": 49.31, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4931, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306, 354.6882111030864, 353.10333925749836, 360.2045229229372, 316.7634953185894, 316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214, 354.12049032649173, 346.0881286223785, 362.55757755931813, 345.67766170951734, 352.48350541374816, 326.0507164585341, 313.7503051844586, 347.31540614434624, 237.5810656605513, 295.65047200629004, 328.8836943299006, 352.46920383167446, 142.9231229397974, 318.4338810078294, 351.0188816300159, 291.39725382948444, 316.774823351747, 302.0598618059498, 319.7738577857634, 305.12012913606435, 317.76203996797443, 315.70803352158293, 342.12245698896635, 355.92419460674734, 355.14133521303717, 352.73082095760844, 340.68695645301153, 356.6248966535759, 348.26026352580647, 303.92501089266653, 354.9294714892796, 370.6721747518371, 310.34386295298896, 336.84072686449264, 356.9257873979613, 315.3760768818142, 291.71282759455374, 354.09838971208535, 288.3832008908297, 140.46561041318057, 348.8604056055093, 355.2866570844992, 313.79621393625945, 351.6477156493681, 300.8946004411711, 357.2993975759102, 313.46815708817735, 347.97045845738995, 333.87890254750266, 345.1117884516588, 298.70438232421907, 346.44888161872024, 345.275773373341, 320.07248872533245, 356.4625234055998, 314.8380593757341, 346.3618434376115, 336.51328612067937, 345.27420424271526, 343.8672519390312], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5958485949684755, "mean_inference_ms": 1.2407921247917324, "mean_action_processing_ms": 0.20575165865853823, "mean_env_wait_ms": 479.07293980759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01026010513305664, "StateBufferConnector_ms": 0.005835533142089844, "ViewRequirementAgentConnector_ms": 0.16568231582641602}, "num_episodes": 19, "episode_return_max": 370.6721747518371, "episode_return_min": 104.95859375000009, "episode_return_mean": 329.5213032264517}, "env_runner_results": {"episode_reward_max": 370.6721747518371, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 329.5213032264517, "episode_len_mean": 49.31, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4931, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306, 354.6882111030864, 353.10333925749836, 360.2045229229372, 316.7634953185894, 316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214, 354.12049032649173, 346.0881286223785, 362.55757755931813, 345.67766170951734, 352.48350541374816, 326.0507164585341, 313.7503051844586, 347.31540614434624, 237.5810656605513, 295.65047200629004, 328.8836943299006, 352.46920383167446, 142.9231229397974, 318.4338810078294, 351.0188816300159, 291.39725382948444, 316.774823351747, 302.0598618059498, 319.7738577857634, 305.12012913606435, 317.76203996797443, 315.70803352158293, 342.12245698896635, 355.92419460674734, 355.14133521303717, 352.73082095760844, 340.68695645301153, 356.6248966535759, 348.26026352580647, 303.92501089266653, 354.9294714892796, 370.6721747518371, 310.34386295298896, 336.84072686449264, 356.9257873979613, 315.3760768818142, 291.71282759455374, 354.09838971208535, 288.3832008908297, 140.46561041318057, 348.8604056055093, 355.2866570844992, 313.79621393625945, 351.6477156493681, 300.8946004411711, 357.2993975759102, 313.46815708817735, 347.97045845738995, 333.87890254750266, 345.1117884516588, 298.70438232421907, 346.44888161872024, 345.275773373341, 320.07248872533245, 356.4625234055998, 314.8380593757341, 346.3618434376115, 336.51328612067937, 345.27420424271526, 343.8672519390312], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5958485949684755, "mean_inference_ms": 1.2407921247917324, "mean_action_processing_ms": 0.20575165865853823, "mean_env_wait_ms": 479.07293980759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01026010513305664, "StateBufferConnector_ms": 0.005835533142089844, "ViewRequirementAgentConnector_ms": 0.16568231582641602}, "num_episodes": 19, "episode_return_max": 370.6721747518371, "episode_return_min": 104.95859375000009, "episode_return_mean": 329.5213032264517}, "episode_reward_max": 370.6721747518371, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 329.5213032264517, "episode_len_mean": 49.31, "episodes_this_iter": 19, "episodes_timesteps_total": 4931, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [309.8528047141008, 355.53034836043264, 349.91669211968787, 341.87425700549494, 308.41320970614527, 360.37446248435236, 349.5248755961284, 348.58066110219215, 338.42417146758623, 351.12603129553656, 356.3381958007815, 356.54835205078143, 326.78996673248383, 293.98957255254123, 350.99004644797526, 321.23589579976687, 321.6816473939244, 343.72149141499835, 347.05016750744306, 354.6882111030864, 353.10333925749836, 360.2045229229372, 316.7634953185894, 316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214, 354.12049032649173, 346.0881286223785, 362.55757755931813, 345.67766170951734, 352.48350541374816, 326.0507164585341, 313.7503051844586, 347.31540614434624, 237.5810656605513, 295.65047200629004, 328.8836943299006, 352.46920383167446, 142.9231229397974, 318.4338810078294, 351.0188816300159, 291.39725382948444, 316.774823351747, 302.0598618059498, 319.7738577857634, 305.12012913606435, 317.76203996797443, 315.70803352158293, 342.12245698896635, 355.92419460674734, 355.14133521303717, 352.73082095760844, 340.68695645301153, 356.6248966535759, 348.26026352580647, 303.92501089266653, 354.9294714892796, 370.6721747518371, 310.34386295298896, 336.84072686449264, 356.9257873979613, 315.3760768818142, 291.71282759455374, 354.09838971208535, 288.3832008908297, 140.46561041318057, 348.8604056055093, 355.2866570844992, 313.79621393625945, 351.6477156493681, 300.8946004411711, 357.2993975759102, 313.46815708817735, 347.97045845738995, 333.87890254750266, 345.1117884516588, 298.70438232421907, 346.44888161872024, 345.275773373341, 320.07248872533245, 356.4625234055998, 314.8380593757341, 346.3618434376115, 336.51328612067937, 345.27420424271526, 343.8672519390312], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5958485949684755, "mean_inference_ms": 1.2407921247917324, "mean_action_processing_ms": 0.20575165865853823, "mean_env_wait_ms": 479.07293980759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01026010513305664, "StateBufferConnector_ms": 0.005835533142089844, "ViewRequirementAgentConnector_ms": 0.16568231582641602}, "num_episodes": 19, "episode_return_max": 370.6721747518371, "episode_return_min": 104.95859375000009, "episode_return_mean": 329.5213032264517, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135666, "num_agent_steps_trained": 135666, "num_env_steps_sampled": 135666, "num_env_steps_trained": 135666, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 12.66271125856184, "num_env_steps_trained_throughput_per_sec": 12.66271125856184, "timesteps_total": 135666, "num_env_steps_sampled_lifetime": 135666, "num_agent_steps_sampled_lifetime": 135666, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 135666, "timers": {"training_iteration_time_ms": 90978.475, "restore_workers_time_ms": 0.018, "training_step_time_ms": 90978.418, "sample_time_ms": 89091.324, "load_time_ms": 0.457, "load_throughput": 2243000.099, "learn_time_ms": 1873.361, "learn_throughput": 547.679, "synch_weights_time_ms": 12.97}, "counters": {"num_env_steps_sampled": 135666, "num_env_steps_trained": 135666, "num_agent_steps_sampled": 135666, "num_agent_steps_trained": 135666}, "done": false, "episodes_total": 2999, "training_iteration": 141, "trial_id": "fe178_00005", "date": "2024-08-15_20-54-15", "timestamp": 1723776855, "time_this_iter_s": 81.02863430976868, "time_total_s": 13046.88944554329, "pid": 11366, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3784888502678799, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7297845213991309, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 636.8734457492828, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 24.41293103448276, "ram_util_percent": 11.040517241379305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.026015587647755, "cur_kl_coeff": 0.39055903120182217, "cur_lr": 0.00010000000000000003, "total_loss": 5.102924851576487, "policy_loss": -0.0027570941019803286, "vf_loss": 5.104437893132369, "vf_explained_var": 0.09477688372135162, "kl": 0.0031853329652249737, "entropy": -1.56049445271492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 136692, "num_env_steps_trained": 136692, "num_agent_steps_sampled": 136692, "num_agent_steps_trained": 136692}, "sampler_results": {"episode_reward_max": 370.6721747518371, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 324.03523429526155, "episode_len_mean": 48.6, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 4860, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214, 354.12049032649173, 346.0881286223785, 362.55757755931813, 345.67766170951734, 352.48350541374816, 326.0507164585341, 313.7503051844586, 347.31540614434624, 237.5810656605513, 295.65047200629004, 328.8836943299006, 352.46920383167446, 142.9231229397974, 318.4338810078294, 351.0188816300159, 291.39725382948444, 316.774823351747, 302.0598618059498, 319.7738577857634, 305.12012913606435, 317.76203996797443, 315.70803352158293, 342.12245698896635, 355.92419460674734, 355.14133521303717, 352.73082095760844, 340.68695645301153, 356.6248966535759, 348.26026352580647, 303.92501089266653, 354.9294714892796, 370.6721747518371, 310.34386295298896, 336.84072686449264, 356.9257873979613, 315.3760768818142, 291.71282759455374, 354.09838971208535, 288.3832008908297, 140.46561041318057, 348.8604056055093, 355.2866570844992, 313.79621393625945, 351.6477156493681, 300.8946004411711, 357.2993975759102, 313.46815708817735, 347.97045845738995, 333.87890254750266, 345.1117884516588, 298.70438232421907, 346.44888161872024, 345.275773373341, 320.07248872533245, 356.4625234055998, 314.8380593757341, 346.3618434376115, 336.51328612067937, 345.27420424271526, 343.8672519390312, 336.1741300818269, 368.1682128239796, 352.9040039062504, 343.4448281410194, 360.5583197341336, 355.7206895514275, 108.26808511720151, 309.86797263068183, 272.8641118143827, 333.56837572780535, 134.59681196440215, 343.95728011397773, 354.2038736222912, 351.5365915922704, 173.798095703125, 316.2144441963864, 351.260529389761, 367.9602038189418, 352.14551850627606, 362.73143276372497, 341.88149108935716, 321.99055681588754, 354.299965930341], "episode_lengths": [50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 24, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.606676817146097, "mean_inference_ms": 1.2380973634749344, "mean_action_processing_ms": 0.20563152052590797, "mean_env_wait_ms": 476.8659093001752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00976705551147461, "StateBufferConnector_ms": 0.005845308303833008, "ViewRequirementAgentConnector_ms": 0.1659688949584961}, "num_episodes": 23, "episode_return_max": 370.6721747518371, "episode_return_min": 104.95859375000009, "episode_return_mean": 324.03523429526155}, "env_runner_results": {"episode_reward_max": 370.6721747518371, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 324.03523429526155, "episode_len_mean": 48.6, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 4860, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214, 354.12049032649173, 346.0881286223785, 362.55757755931813, 345.67766170951734, 352.48350541374816, 326.0507164585341, 313.7503051844586, 347.31540614434624, 237.5810656605513, 295.65047200629004, 328.8836943299006, 352.46920383167446, 142.9231229397974, 318.4338810078294, 351.0188816300159, 291.39725382948444, 316.774823351747, 302.0598618059498, 319.7738577857634, 305.12012913606435, 317.76203996797443, 315.70803352158293, 342.12245698896635, 355.92419460674734, 355.14133521303717, 352.73082095760844, 340.68695645301153, 356.6248966535759, 348.26026352580647, 303.92501089266653, 354.9294714892796, 370.6721747518371, 310.34386295298896, 336.84072686449264, 356.9257873979613, 315.3760768818142, 291.71282759455374, 354.09838971208535, 288.3832008908297, 140.46561041318057, 348.8604056055093, 355.2866570844992, 313.79621393625945, 351.6477156493681, 300.8946004411711, 357.2993975759102, 313.46815708817735, 347.97045845738995, 333.87890254750266, 345.1117884516588, 298.70438232421907, 346.44888161872024, 345.275773373341, 320.07248872533245, 356.4625234055998, 314.8380593757341, 346.3618434376115, 336.51328612067937, 345.27420424271526, 343.8672519390312, 336.1741300818269, 368.1682128239796, 352.9040039062504, 343.4448281410194, 360.5583197341336, 355.7206895514275, 108.26808511720151, 309.86797263068183, 272.8641118143827, 333.56837572780535, 134.59681196440215, 343.95728011397773, 354.2038736222912, 351.5365915922704, 173.798095703125, 316.2144441963864, 351.260529389761, 367.9602038189418, 352.14551850627606, 362.73143276372497, 341.88149108935716, 321.99055681588754, 354.299965930341], "episode_lengths": [50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 24, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.606676817146097, "mean_inference_ms": 1.2380973634749344, "mean_action_processing_ms": 0.20563152052590797, "mean_env_wait_ms": 476.8659093001752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00976705551147461, "StateBufferConnector_ms": 0.005845308303833008, "ViewRequirementAgentConnector_ms": 0.1659688949584961}, "num_episodes": 23, "episode_return_max": 370.6721747518371, "episode_return_min": 104.95859375000009, "episode_return_mean": 324.03523429526155}, "episode_reward_max": 370.6721747518371, "episode_reward_min": 104.95859375000009, "episode_reward_mean": 324.03523429526155, "episode_len_mean": 48.6, "episodes_this_iter": 23, "episodes_timesteps_total": 4860, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [316.0943820067774, 343.33499135327656, 361.0737670308103, 354.00168716679144, 349.8316778527247, 300.77466171428836, 104.95859375000009, 343.3715155664241, 338.24067816831547, 346.9891437918787, 353.04076143744265, 348.8500280935947, 344.34012419787786, 353.39504394531286, 359.546203613281, 346.75786170949505, 330.0096152281214, 354.12049032649173, 346.0881286223785, 362.55757755931813, 345.67766170951734, 352.48350541374816, 326.0507164585341, 313.7503051844586, 347.31540614434624, 237.5810656605513, 295.65047200629004, 328.8836943299006, 352.46920383167446, 142.9231229397974, 318.4338810078294, 351.0188816300159, 291.39725382948444, 316.774823351747, 302.0598618059498, 319.7738577857634, 305.12012913606435, 317.76203996797443, 315.70803352158293, 342.12245698896635, 355.92419460674734, 355.14133521303717, 352.73082095760844, 340.68695645301153, 356.6248966535759, 348.26026352580647, 303.92501089266653, 354.9294714892796, 370.6721747518371, 310.34386295298896, 336.84072686449264, 356.9257873979613, 315.3760768818142, 291.71282759455374, 354.09838971208535, 288.3832008908297, 140.46561041318057, 348.8604056055093, 355.2866570844992, 313.79621393625945, 351.6477156493681, 300.8946004411711, 357.2993975759102, 313.46815708817735, 347.97045845738995, 333.87890254750266, 345.1117884516588, 298.70438232421907, 346.44888161872024, 345.275773373341, 320.07248872533245, 356.4625234055998, 314.8380593757341, 346.3618434376115, 336.51328612067937, 345.27420424271526, 343.8672519390312, 336.1741300818269, 368.1682128239796, 352.9040039062504, 343.4448281410194, 360.5583197341336, 355.7206895514275, 108.26808511720151, 309.86797263068183, 272.8641118143827, 333.56837572780535, 134.59681196440215, 343.95728011397773, 354.2038736222912, 351.5365915922704, 173.798095703125, 316.2144441963864, 351.260529389761, 367.9602038189418, 352.14551850627606, 362.73143276372497, 341.88149108935716, 321.99055681588754, 354.299965930341], "episode_lengths": [50, 50, 50, 50, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 24, 50, 50, 50, 34, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.606676817146097, "mean_inference_ms": 1.2380973634749344, "mean_action_processing_ms": 0.20563152052590797, "mean_env_wait_ms": 476.8659093001752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00976705551147461, "StateBufferConnector_ms": 0.005845308303833008, "ViewRequirementAgentConnector_ms": 0.1659688949584961}, "num_episodes": 23, "episode_return_max": 370.6721747518371, "episode_return_min": 104.95859375000009, "episode_return_mean": 324.03523429526155, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136692, "num_agent_steps_trained": 136692, "num_env_steps_sampled": 136692, "num_env_steps_trained": 136692, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.652492822854594, "num_env_steps_trained_throughput_per_sec": 10.652492822854594, "timesteps_total": 136692, "num_env_steps_sampled_lifetime": 136692, "num_agent_steps_sampled_lifetime": 136692, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 136692, "timers": {"training_iteration_time_ms": 91645.603, "restore_workers_time_ms": 0.019, "training_step_time_ms": 91645.546, "sample_time_ms": 89824.349, "load_time_ms": 0.452, "load_throughput": 2269702.481, "learn_time_ms": 1807.481, "learn_throughput": 567.641, "synch_weights_time_ms": 12.963}, "counters": {"num_env_steps_sampled": 136692, "num_env_steps_trained": 136692, "num_agent_steps_sampled": 136692, "num_agent_steps_trained": 136692}, "done": false, "episodes_total": 3022, "training_iteration": 142, "trial_id": "fe178_00005", "date": "2024-08-15_20-55-51", "timestamp": 1723776951, "time_this_iter_s": 96.3188865184784, "time_total_s": 13143.208332061768, "pid": 11366, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3784888502678799, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7297845213991309, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 733.1923322677612, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.905797101449274, "ram_util_percent": 11.128985507246377}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 80.13535504142443, "cur_kl_coeff": 0.3471635832905085, "cur_lr": 5e-06, "total_loss": 4.988237610956033, "policy_loss": 0.031017669146725286, "vf_loss": 4.896701417118311, "vf_explained_var": 0.15929826721549034, "kl": 0.17432272683751734, "entropy": -1.5073093426724276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 137718, "num_env_steps_trained": 137718, "num_agent_steps_sampled": 137718, "num_agent_steps_trained": 137718}, "sampler_results": {"episode_reward_max": 371.458720946908, "episode_reward_min": 193.83472679069735, "episode_reward_mean": 334.7076406082372, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.6983892628833, 345.32187867950717, 343.6989869395963, 358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.235585824463718, "mean_inference_ms": 1.2356620426325833, "mean_action_processing_ms": 0.20355725473211714, "mean_env_wait_ms": 535.8691897041112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01174873775906033, "StateBufferConnector_ms": 0.005842579735649956, "ViewRequirementAgentConnector_ms": 0.16540288925170898}, "num_episodes": 18, "episode_return_max": 371.458720946908, "episode_return_min": 193.83472679069735, "episode_return_mean": 334.7076406082372}, "env_runner_results": {"episode_reward_max": 371.458720946908, "episode_reward_min": 193.83472679069735, "episode_reward_mean": 334.7076406082372, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.6983892628833, 345.32187867950717, 343.6989869395963, 358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.235585824463718, "mean_inference_ms": 1.2356620426325833, "mean_action_processing_ms": 0.20355725473211714, "mean_env_wait_ms": 535.8691897041112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01174873775906033, "StateBufferConnector_ms": 0.005842579735649956, "ViewRequirementAgentConnector_ms": 0.16540288925170898}, "num_episodes": 18, "episode_return_max": 371.458720946908, "episode_return_min": 193.83472679069735, "episode_return_mean": 334.7076406082372}, "episode_reward_max": 371.458720946908, "episode_reward_min": 193.83472679069735, "episode_reward_mean": 334.7076406082372, "episode_len_mean": 50.0, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [352.6983892628833, 345.32187867950717, 343.6989869395963, 358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.235585824463718, "mean_inference_ms": 1.2356620426325833, "mean_action_processing_ms": 0.20355725473211714, "mean_env_wait_ms": 535.8691897041112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01174873775906033, "StateBufferConnector_ms": 0.005842579735649956, "ViewRequirementAgentConnector_ms": 0.16540288925170898}, "num_episodes": 18, "episode_return_max": 371.458720946908, "episode_return_min": 193.83472679069735, "episode_return_mean": 334.7076406082372, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137718, "num_agent_steps_trained": 137718, "num_env_steps_sampled": 137718, "num_env_steps_trained": 137718, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.057804416760131, "num_env_steps_trained_throughput_per_sec": 10.057804416760131, "timesteps_total": 137718, "num_env_steps_sampled_lifetime": 137718, "num_agent_steps_sampled_lifetime": 137718, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 137718, "timers": {"training_iteration_time_ms": 102010.346, "restore_workers_time_ms": 0.017, "training_step_time_ms": 102010.291, "sample_time_ms": 97853.514, "load_time_ms": 0.731, "load_throughput": 1404031.29, "learn_time_ms": 4141.955, "learn_throughput": 247.709, "synch_weights_time_ms": 13.529}, "counters": {"num_env_steps_sampled": 137718, "num_env_steps_trained": 137718, "num_agent_steps_sampled": 137718, "num_agent_steps_trained": 137718}, "done": false, "episodes_total": 3045, "training_iteration": 139, "trial_id": "fe178_00005", "date": "2024-08-15_20-57-52", "timestamp": 1723777072, "time_this_iter_s": 102.01372575759888, "time_total_s": 13263.110712766647, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 102.01372575759888, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 20.56232876712329, "ram_util_percent": 10.460273972602739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.44767941236496, "cur_kl_coeff": 0.520745374935763, "cur_lr": 5e-06, "total_loss": 4.353426818797986, "policy_loss": -0.006056958293387046, "vf_loss": 4.356970025102298, "vf_explained_var": 0.1274726462860902, "kl": 0.0048271880014642225, "entropy": -1.4163386543591818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 138744, "num_env_steps_trained": 138744, "num_agent_steps_sampled": 138744, "num_agent_steps_trained": 138744}, "sampler_results": {"episode_reward_max": 371.458720946908, "episode_reward_min": 193.83472679069735, "episode_reward_mean": 335.7885734107675, "episode_len_mean": 49.833333333333336, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1794, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.6983892628833, 345.32187867950717, 343.6989869395963, 358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524, 343.0593959151598, 316.1759957479242, 364.5497220707935, 342.59903279029436, 367.5685265433861, 313.7975514426754, 337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.235554651141552, "mean_inference_ms": 1.2358375811201274, "mean_action_processing_ms": 0.2036583153657876, "mean_env_wait_ms": 518.0181236079924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01275075806511773, "StateBufferConnector_ms": 0.005820724699232314, "ViewRequirementAgentConnector_ms": 0.16540222697787815}, "num_episodes": 18, "episode_return_max": 371.458720946908, "episode_return_min": 193.83472679069735, "episode_return_mean": 335.7885734107675}, "env_runner_results": {"episode_reward_max": 371.458720946908, "episode_reward_min": 193.83472679069735, "episode_reward_mean": 335.7885734107675, "episode_len_mean": 49.833333333333336, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1794, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.6983892628833, 345.32187867950717, 343.6989869395963, 358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524, 343.0593959151598, 316.1759957479242, 364.5497220707935, 342.59903279029436, 367.5685265433861, 313.7975514426754, 337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.235554651141552, "mean_inference_ms": 1.2358375811201274, "mean_action_processing_ms": 0.2036583153657876, "mean_env_wait_ms": 518.0181236079924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01275075806511773, "StateBufferConnector_ms": 0.005820724699232314, "ViewRequirementAgentConnector_ms": 0.16540222697787815}, "num_episodes": 18, "episode_return_max": 371.458720946908, "episode_return_min": 193.83472679069735, "episode_return_mean": 335.7885734107675}, "episode_reward_max": 371.458720946908, "episode_reward_min": 193.83472679069735, "episode_reward_mean": 335.7885734107675, "episode_len_mean": 49.833333333333336, "episodes_this_iter": 18, "episodes_timesteps_total": 1794, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [352.6983892628833, 345.32187867950717, 343.6989869395963, 358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524, 343.0593959151598, 316.1759957479242, 364.5497220707935, 342.59903279029436, 367.5685265433861, 313.7975514426754, 337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.235554651141552, "mean_inference_ms": 1.2358375811201274, "mean_action_processing_ms": 0.2036583153657876, "mean_env_wait_ms": 518.0181236079924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01275075806511773, "StateBufferConnector_ms": 0.005820724699232314, "ViewRequirementAgentConnector_ms": 0.16540222697787815}, "num_episodes": 18, "episode_return_max": 371.458720946908, "episode_return_min": 193.83472679069735, "episode_return_mean": 335.7885734107675, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138744, "num_agent_steps_trained": 138744, "num_env_steps_sampled": 138744, "num_env_steps_trained": 138744, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.75518376231967, "num_env_steps_trained_throughput_per_sec": 11.75518376231967, "timesteps_total": 138744, "num_env_steps_sampled_lifetime": 138744, "num_agent_steps_sampled_lifetime": 138744, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 138744, "timers": {"training_iteration_time_ms": 94645.501, "restore_workers_time_ms": 0.018, "training_step_time_ms": 94645.442, "sample_time_ms": 91903.542, "load_time_ms": 0.556, "load_throughput": 1845349.873, "learn_time_ms": 2727.32, "learn_throughput": 376.193, "synch_weights_time_ms": 13.574}, "counters": {"num_env_steps_sampled": 138744, "num_env_steps_trained": 138744, "num_agent_steps_sampled": 138744, "num_agent_steps_trained": 138744}, "done": false, "episodes_total": 3063, "training_iteration": 140, "trial_id": "fe178_00005", "date": "2024-08-15_20-59-19", "timestamp": 1723777159, "time_this_iter_s": 87.28445291519165, "time_total_s": 13350.395165681839, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 189.29817867279053, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.37258064516129, "ram_util_percent": 10.676612903225807}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.91978332400322, "cur_kl_coeff": 0.2603726874678815, "cur_lr": 5e-06, "total_loss": 4.624338119290769, "policy_loss": -0.0027724620265265304, "vf_loss": 4.622065273672343, "vf_explained_var": 0.07614778354763985, "kl": 0.019377241423188543, "entropy": -1.4876053765416146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 139770, "num_env_steps_trained": 139770, "num_agent_steps_sampled": 139770, "num_agent_steps_trained": 139770}, "sampler_results": {"episode_reward_max": 371.458720946908, "episode_reward_min": 193.83472679069735, "episode_reward_mean": 338.60498296204116, "episode_len_mean": 49.9, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 2994, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.6983892628833, 345.32187867950717, 343.6989869395963, 358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524, 343.0593959151598, 316.1759957479242, 364.5497220707935, 342.59903279029436, 367.5685265433861, 313.7975514426754, 337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913, 362.67123667864, 352.03245783618866, 338.13728382086265, 303.04545405726606, 343.6493967584025, 326.03905460832556, 341.5800864324251, 333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.373724615666975, "mean_inference_ms": 1.2361185895957927, "mean_action_processing_ms": 0.20385474410988483, "mean_env_wait_ms": 510.7099577030735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013061761856079102, "StateBufferConnector_ms": 0.005956888198852539, "ViewRequirementAgentConnector_ms": 0.16718904177347818}, "num_episodes": 24, "episode_return_max": 371.458720946908, "episode_return_min": 193.83472679069735, "episode_return_mean": 338.60498296204116}, "env_runner_results": {"episode_reward_max": 371.458720946908, "episode_reward_min": 193.83472679069735, "episode_reward_mean": 338.60498296204116, "episode_len_mean": 49.9, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 2994, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.6983892628833, 345.32187867950717, 343.6989869395963, 358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524, 343.0593959151598, 316.1759957479242, 364.5497220707935, 342.59903279029436, 367.5685265433861, 313.7975514426754, 337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913, 362.67123667864, 352.03245783618866, 338.13728382086265, 303.04545405726606, 343.6493967584025, 326.03905460832556, 341.5800864324251, 333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.373724615666975, "mean_inference_ms": 1.2361185895957927, "mean_action_processing_ms": 0.20385474410988483, "mean_env_wait_ms": 510.7099577030735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013061761856079102, "StateBufferConnector_ms": 0.005956888198852539, "ViewRequirementAgentConnector_ms": 0.16718904177347818}, "num_episodes": 24, "episode_return_max": 371.458720946908, "episode_return_min": 193.83472679069735, "episode_return_mean": 338.60498296204116}, "episode_reward_max": 371.458720946908, "episode_reward_min": 193.83472679069735, "episode_reward_mean": 338.60498296204116, "episode_len_mean": 49.9, "episodes_this_iter": 24, "episodes_timesteps_total": 2994, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [352.6983892628833, 345.32187867950717, 343.6989869395963, 358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524, 343.0593959151598, 316.1759957479242, 364.5497220707935, 342.59903279029436, 367.5685265433861, 313.7975514426754, 337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913, 362.67123667864, 352.03245783618866, 338.13728382086265, 303.04545405726606, 343.6493967584025, 326.03905460832556, 341.5800864324251, 333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.373724615666975, "mean_inference_ms": 1.2361185895957927, "mean_action_processing_ms": 0.20385474410988483, "mean_env_wait_ms": 510.7099577030735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013061761856079102, "StateBufferConnector_ms": 0.005956888198852539, "ViewRequirementAgentConnector_ms": 0.16718904177347818}, "num_episodes": 24, "episode_return_max": 371.458720946908, "episode_return_min": 193.83472679069735, "episode_return_mean": 338.60498296204116, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139770, "num_agent_steps_trained": 139770, "num_env_steps_sampled": 139770, "num_env_steps_trained": 139770, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.101071311307841, "num_env_steps_trained_throughput_per_sec": 11.101071311307841, "timesteps_total": 139770, "num_env_steps_sampled_lifetime": 139770, "num_agent_steps_sampled_lifetime": 139770, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 139770, "timers": {"training_iteration_time_ms": 93904.842, "restore_workers_time_ms": 0.018, "training_step_time_ms": 93904.785, "sample_time_ms": 91678.244, "load_time_ms": 0.517, "load_throughput": 1985858.747, "learn_time_ms": 2212.114, "learn_throughput": 463.81, "synch_weights_time_ms": 13.495}, "counters": {"num_env_steps_sampled": 139770, "num_env_steps_trained": 139770, "num_agent_steps_sampled": 139770, "num_agent_steps_trained": 139770}, "done": false, "episodes_total": 3087, "training_iteration": 141, "trial_id": "fe178_00005", "date": "2024-08-15_21-00-52", "timestamp": 1723777252, "time_this_iter_s": 92.42703700065613, "time_total_s": 13442.822202682495, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 281.72521567344666, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 20.863636363636363, "ram_util_percent": 9.962878787878788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.38777460455894, "cur_kl_coeff": 0.2603726874678815, "cur_lr": 5e-06, "total_loss": 4.411592034002145, "policy_loss": -0.005820362945087254, "vf_loss": 4.415540880709886, "vf_explained_var": 0.04944833591580391, "kl": 0.007187709890667657, "entropy": -1.4490921114881834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 140796, "num_env_steps_trained": 140796, "num_agent_steps_sampled": 140796, "num_agent_steps_trained": 140796}, "sampler_results": {"episode_reward_max": 373.23451553600586, "episode_reward_min": 141.09674902585016, "episode_reward_mean": 336.37736392489154, "episode_len_mean": 49.59493670886076, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 3918, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.6983892628833, 345.32187867950717, 343.6989869395963, 358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524, 343.0593959151598, 316.1759957479242, 364.5497220707935, 342.59903279029436, 367.5685265433861, 313.7975514426754, 337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913, 362.67123667864, 352.03245783618866, 338.13728382086265, 303.04545405726606, 343.6493967584025, 326.03905460832556, 341.5800864324251, 333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723, 360.9255092507075, 330.3709277630009, 347.58169976614977, 350.3727653100419, 355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.41302845274312, "mean_inference_ms": 1.2358580243262003, "mean_action_processing_ms": 0.2039385929752038, "mean_env_wait_ms": 506.230403797538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012261958061894285, "StateBufferConnector_ms": 0.0059420549416843845, "ViewRequirementAgentConnector_ms": 0.16624142852010607}, "num_episodes": 19, "episode_return_max": 373.23451553600586, "episode_return_min": 141.09674902585016, "episode_return_mean": 336.37736392489154}, "env_runner_results": {"episode_reward_max": 373.23451553600586, "episode_reward_min": 141.09674902585016, "episode_reward_mean": 336.37736392489154, "episode_len_mean": 49.59493670886076, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 3918, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.6983892628833, 345.32187867950717, 343.6989869395963, 358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524, 343.0593959151598, 316.1759957479242, 364.5497220707935, 342.59903279029436, 367.5685265433861, 313.7975514426754, 337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913, 362.67123667864, 352.03245783618866, 338.13728382086265, 303.04545405726606, 343.6493967584025, 326.03905460832556, 341.5800864324251, 333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723, 360.9255092507075, 330.3709277630009, 347.58169976614977, 350.3727653100419, 355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.41302845274312, "mean_inference_ms": 1.2358580243262003, "mean_action_processing_ms": 0.2039385929752038, "mean_env_wait_ms": 506.230403797538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012261958061894285, "StateBufferConnector_ms": 0.0059420549416843845, "ViewRequirementAgentConnector_ms": 0.16624142852010607}, "num_episodes": 19, "episode_return_max": 373.23451553600586, "episode_return_min": 141.09674902585016, "episode_return_mean": 336.37736392489154}, "episode_reward_max": 373.23451553600586, "episode_reward_min": 141.09674902585016, "episode_reward_mean": 336.37736392489154, "episode_len_mean": 49.59493670886076, "episodes_this_iter": 19, "episodes_timesteps_total": 3918, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [352.6983892628833, 345.32187867950717, 343.6989869395963, 358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524, 343.0593959151598, 316.1759957479242, 364.5497220707935, 342.59903279029436, 367.5685265433861, 313.7975514426754, 337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913, 362.67123667864, 352.03245783618866, 338.13728382086265, 303.04545405726606, 343.6493967584025, 326.03905460832556, 341.5800864324251, 333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723, 360.9255092507075, 330.3709277630009, 347.58169976614977, 350.3727653100419, 355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.41302845274312, "mean_inference_ms": 1.2358580243262003, "mean_action_processing_ms": 0.2039385929752038, "mean_env_wait_ms": 506.230403797538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012261958061894285, "StateBufferConnector_ms": 0.0059420549416843845, "ViewRequirementAgentConnector_ms": 0.16624142852010607}, "num_episodes": 19, "episode_return_max": 373.23451553600586, "episode_return_min": 141.09674902585016, "episode_return_mean": 336.37736392489154, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140796, "num_agent_steps_trained": 140796, "num_env_steps_sampled": 140796, "num_env_steps_trained": 140796, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.514713015514186, "num_env_steps_trained_throughput_per_sec": 11.514713015514186, "timesteps_total": 140796, "num_env_steps_sampled_lifetime": 140796, "num_agent_steps_sampled_lifetime": 140796, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 140796, "timers": {"training_iteration_time_ms": 92704.483, "restore_workers_time_ms": 0.018, "training_step_time_ms": 92704.424, "sample_time_ms": 90727.016, "load_time_ms": 0.483, "load_throughput": 2124589.437, "learn_time_ms": 1963.037, "learn_throughput": 522.659, "synch_weights_time_ms": 13.497}, "counters": {"num_env_steps_sampled": 140796, "num_env_steps_trained": 140796, "num_agent_steps_sampled": 140796, "num_agent_steps_trained": 140796}, "done": false, "episodes_total": 3106, "training_iteration": 142, "trial_id": "fe178_00005", "date": "2024-08-15_21-02-21", "timestamp": 1723777341, "time_this_iter_s": 89.10692477226257, "time_total_s": 13531.929127454758, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 370.83214044570923, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 23.10078125, "ram_util_percent": 10.393750000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.239564207196235, "cur_kl_coeff": 0.2603726874678815, "cur_lr": 5e-06, "total_loss": 4.412473235527674, "policy_loss": -0.00754918825502197, "vf_loss": 4.419486712416013, "vf_explained_var": 0.045014007637898125, "kl": 0.0020574565965965365, "entropy": -1.4111373136440912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 141822, "num_env_steps_trained": 141822, "num_agent_steps_sampled": 141822, "num_agent_steps_trained": 141822}, "sampler_results": {"episode_reward_max": 373.23451553600586, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 330.6219546141482, "episode_len_mean": 48.84, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 4884, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524, 343.0593959151598, 316.1759957479242, 364.5497220707935, 342.59903279029436, 367.5685265433861, 313.7975514426754, 337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913, 362.67123667864, 352.03245783618866, 338.13728382086265, 303.04545405726606, 343.6493967584025, 326.03905460832556, 341.5800864324251, 333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723, 360.9255092507075, 330.3709277630009, 347.58169976614977, 350.3727653100419, 355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165, 351.8349920761289, 131.26970214843755, 306.7698272184487, 348.98747213549126, 145.6782048159365, 366.0621783387905, 358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 25, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.482102840598061, "mean_inference_ms": 1.235565896018966, "mean_action_processing_ms": 0.20407647081762575, "mean_env_wait_ms": 502.3515001879631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011881113052368164, "StateBufferConnector_ms": 0.005955696105957031, "ViewRequirementAgentConnector_ms": 0.16661310195922852}, "num_episodes": 24, "episode_return_max": 373.23451553600586, "episode_return_min": 103.78155389057434, "episode_return_mean": 330.6219546141482}, "env_runner_results": {"episode_reward_max": 373.23451553600586, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 330.6219546141482, "episode_len_mean": 48.84, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 4884, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524, 343.0593959151598, 316.1759957479242, 364.5497220707935, 342.59903279029436, 367.5685265433861, 313.7975514426754, 337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913, 362.67123667864, 352.03245783618866, 338.13728382086265, 303.04545405726606, 343.6493967584025, 326.03905460832556, 341.5800864324251, 333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723, 360.9255092507075, 330.3709277630009, 347.58169976614977, 350.3727653100419, 355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165, 351.8349920761289, 131.26970214843755, 306.7698272184487, 348.98747213549126, 145.6782048159365, 366.0621783387905, 358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 25, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.482102840598061, "mean_inference_ms": 1.235565896018966, "mean_action_processing_ms": 0.20407647081762575, "mean_env_wait_ms": 502.3515001879631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011881113052368164, "StateBufferConnector_ms": 0.005955696105957031, "ViewRequirementAgentConnector_ms": 0.16661310195922852}, "num_episodes": 24, "episode_return_max": 373.23451553600586, "episode_return_min": 103.78155389057434, "episode_return_mean": 330.6219546141482}, "episode_reward_max": 373.23451553600586, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 330.6219546141482, "episode_len_mean": 48.84, "episodes_this_iter": 24, "episodes_timesteps_total": 4884, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [358.4825077315984, 349.1132846924779, 344.95271094567676, 319.7328630943733, 311.6068274722938, 193.83472679069735, 350.57001829438167, 324.9483579448825, 319.16651403347157, 345.0980916246912, 349.86624185248513, 328.4085242913802, 347.77967487981346, 371.458720946908, 367.9992114711524, 343.0593959151598, 316.1759957479242, 364.5497220707935, 342.59903279029436, 367.5685265433861, 313.7975514426754, 337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913, 362.67123667864, 352.03245783618866, 338.13728382086265, 303.04545405726606, 343.6493967584025, 326.03905460832556, 341.5800864324251, 333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723, 360.9255092507075, 330.3709277630009, 347.58169976614977, 350.3727653100419, 355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165, 351.8349920761289, 131.26970214843755, 306.7698272184487, 348.98747213549126, 145.6782048159365, 366.0621783387905, 358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 25, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.482102840598061, "mean_inference_ms": 1.235565896018966, "mean_action_processing_ms": 0.20407647081762575, "mean_env_wait_ms": 502.3515001879631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011881113052368164, "StateBufferConnector_ms": 0.005955696105957031, "ViewRequirementAgentConnector_ms": 0.16661310195922852}, "num_episodes": 24, "episode_return_max": 373.23451553600586, "episode_return_min": 103.78155389057434, "episode_return_mean": 330.6219546141482, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141822, "num_agent_steps_trained": 141822, "num_env_steps_sampled": 141822, "num_env_steps_trained": 141822, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.879488200817033, "num_env_steps_trained_throughput_per_sec": 10.879488200817033, "timesteps_total": 141822, "num_env_steps_sampled_lifetime": 141822, "num_agent_steps_sampled_lifetime": 141822, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 141822, "timers": {"training_iteration_time_ms": 93024.77, "restore_workers_time_ms": 0.019, "training_step_time_ms": 93024.713, "sample_time_ms": 91174.014, "load_time_ms": 0.461, "load_throughput": 2227871.145, "learn_time_ms": 1836.435, "learn_throughput": 558.691, "synch_weights_time_ms": 13.437}, "counters": {"num_env_steps_sampled": 141822, "num_env_steps_trained": 141822, "num_agent_steps_sampled": 141822, "num_agent_steps_trained": 141822}, "done": false, "episodes_total": 3130, "training_iteration": 143, "trial_id": "fe178_00005", "date": "2024-08-15_21-03-55", "timestamp": 1723777435, "time_this_iter_s": 94.3096809387207, "time_total_s": 13626.238808393478, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 465.14182138442993, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.9089552238806, "ram_util_percent": 9.958955223880597}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.1033626417319, "cur_kl_coeff": 0.13018634373394075, "cur_lr": 5e-06, "total_loss": 4.694166797399521, "policy_loss": -0.005089267030416522, "vf_loss": 4.698645482212305, "vf_explained_var": 0.071884652475516, "kl": 0.004689910717087732, "entropy": -1.59083531498909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 142848, "num_env_steps_trained": 142848, "num_agent_steps_sampled": 142848, "num_agent_steps_trained": 142848}, "sampler_results": {"episode_reward_max": 373.23451553600586, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 331.13290734546285, "episode_len_mean": 48.64, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4864, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913, 362.67123667864, 352.03245783618866, 338.13728382086265, 303.04545405726606, 343.6493967584025, 326.03905460832556, 341.5800864324251, 333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723, 360.9255092507075, 330.3709277630009, 347.58169976614977, 350.3727653100419, 355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165, 351.8349920761289, 131.26970214843755, 306.7698272184487, 348.98747213549126, 145.6782048159365, 366.0621783387905, 358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974, 353.25497619639094, 350.0354050706001, 350.7940972169101, 290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 25, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.570700441167621, "mean_inference_ms": 1.2351573840777939, "mean_action_processing_ms": 0.20422840068561146, "mean_env_wait_ms": 493.1547005588962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011269092559814453, "StateBufferConnector_ms": 0.005987405776977539, "ViewRequirementAgentConnector_ms": 0.16697025299072266}, "num_episodes": 21, "episode_return_max": 373.23451553600586, "episode_return_min": 103.78155389057434, "episode_return_mean": 331.13290734546285}, "env_runner_results": {"episode_reward_max": 373.23451553600586, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 331.13290734546285, "episode_len_mean": 48.64, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4864, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913, 362.67123667864, 352.03245783618866, 338.13728382086265, 303.04545405726606, 343.6493967584025, 326.03905460832556, 341.5800864324251, 333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723, 360.9255092507075, 330.3709277630009, 347.58169976614977, 350.3727653100419, 355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165, 351.8349920761289, 131.26970214843755, 306.7698272184487, 348.98747213549126, 145.6782048159365, 366.0621783387905, 358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974, 353.25497619639094, 350.0354050706001, 350.7940972169101, 290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 25, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.570700441167621, "mean_inference_ms": 1.2351573840777939, "mean_action_processing_ms": 0.20422840068561146, "mean_env_wait_ms": 493.1547005588962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011269092559814453, "StateBufferConnector_ms": 0.005987405776977539, "ViewRequirementAgentConnector_ms": 0.16697025299072266}, "num_episodes": 21, "episode_return_max": 373.23451553600586, "episode_return_min": 103.78155389057434, "episode_return_mean": 331.13290734546285}, "episode_reward_max": 373.23451553600586, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 331.13290734546285, "episode_len_mean": 48.64, "episodes_this_iter": 21, "episodes_timesteps_total": 4864, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [337.31142357957856, 354.4185516216755, 321.28006221628783, 347.32104381212525, 351.84272316372585, 354.7191790128344, 252.22998245002321, 313.8067318274912, 342.9612112788544, 340.4137185361259, 343.58799380982606, 356.00826602057913, 362.67123667864, 352.03245783618866, 338.13728382086265, 303.04545405726606, 343.6493967584025, 326.03905460832556, 341.5800864324251, 333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723, 360.9255092507075, 330.3709277630009, 347.58169976614977, 350.3727653100419, 355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165, 351.8349920761289, 131.26970214843755, 306.7698272184487, 348.98747213549126, 145.6782048159365, 366.0621783387905, 358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974, 353.25497619639094, 350.0354050706001, 350.7940972169101, 290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469], "episode_lengths": [50, 50, 50, 50, 50, 50, 44, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 25, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.570700441167621, "mean_inference_ms": 1.2351573840777939, "mean_action_processing_ms": 0.20422840068561146, "mean_env_wait_ms": 493.1547005588962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011269092559814453, "StateBufferConnector_ms": 0.005987405776977539, "ViewRequirementAgentConnector_ms": 0.16697025299072266}, "num_episodes": 21, "episode_return_max": 373.23451553600586, "episode_return_min": 103.78155389057434, "episode_return_mean": 331.13290734546285, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142848, "num_agent_steps_trained": 142848, "num_env_steps_sampled": 142848, "num_env_steps_trained": 142848, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 12.643783610717295, "num_env_steps_trained_throughput_per_sec": 12.643783610717295, "timesteps_total": 142848, "num_env_steps_sampled_lifetime": 142848, "num_agent_steps_sampled_lifetime": 142848, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 142848, "timers": {"training_iteration_time_ms": 91045.077, "restore_workers_time_ms": 0.018, "training_step_time_ms": 91045.021, "sample_time_ms": 89309.54, "load_time_ms": 0.445, "load_throughput": 2306810.991, "learn_time_ms": 1721.408, "learn_throughput": 596.024, "synch_weights_time_ms": 13.275}, "counters": {"num_env_steps_sampled": 142848, "num_env_steps_trained": 142848, "num_agent_steps_sampled": 142848, "num_agent_steps_trained": 142848}, "done": false, "episodes_total": 3151, "training_iteration": 144, "trial_id": "fe178_00005", "date": "2024-08-15_21-05-16", "timestamp": 1723777516, "time_this_iter_s": 81.150550365448, "time_total_s": 13707.389358758926, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 546.2923717498779, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.657758620689652, "ram_util_percent": 10.404310344827588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.95333986679713, "cur_kl_coeff": 0.06509317186697038, "cur_lr": 5e-06, "total_loss": 4.705833896994591, "policy_loss": -0.007090446333556126, "vf_loss": 4.712701025108497, "vf_explained_var": 0.04744988481203715, "kl": 0.003430742780731003, "entropy": -1.6581044087807337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1560.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 143874, "num_env_steps_trained": 143874, "num_agent_steps_sampled": 143874, "num_agent_steps_trained": 143874}, "sampler_results": {"episode_reward_max": 373.23451553600586, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 331.48590626473595, "episode_len_mean": 48.41, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4841, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723, 360.9255092507075, 330.3709277630009, 347.58169976614977, 350.3727653100419, 355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165, 351.8349920761289, 131.26970214843755, 306.7698272184487, 348.98747213549126, 145.6782048159365, 366.0621783387905, 358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974, 353.25497619639094, 350.0354050706001, 350.7940972169101, 290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469, 355.9039801172234, 355.5194171337548, 343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 25, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.619943970770468, "mean_inference_ms": 1.2345639972270892, "mean_action_processing_ms": 0.20432960163913894, "mean_env_wait_ms": 489.5652445027461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01055145263671875, "StateBufferConnector_ms": 0.005977153778076172, "ViewRequirementAgentConnector_ms": 0.16715097427368164}, "num_episodes": 19, "episode_return_max": 373.23451553600586, "episode_return_min": 103.78155389057434, "episode_return_mean": 331.48590626473595}, "env_runner_results": {"episode_reward_max": 373.23451553600586, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 331.48590626473595, "episode_len_mean": 48.41, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 4841, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723, 360.9255092507075, 330.3709277630009, 347.58169976614977, 350.3727653100419, 355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165, 351.8349920761289, 131.26970214843755, 306.7698272184487, 348.98747213549126, 145.6782048159365, 366.0621783387905, 358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974, 353.25497619639094, 350.0354050706001, 350.7940972169101, 290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469, 355.9039801172234, 355.5194171337548, 343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 25, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.619943970770468, "mean_inference_ms": 1.2345639972270892, "mean_action_processing_ms": 0.20432960163913894, "mean_env_wait_ms": 489.5652445027461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01055145263671875, "StateBufferConnector_ms": 0.005977153778076172, "ViewRequirementAgentConnector_ms": 0.16715097427368164}, "num_episodes": 19, "episode_return_max": 373.23451553600586, "episode_return_min": 103.78155389057434, "episode_return_mean": 331.48590626473595}, "episode_reward_max": 373.23451553600586, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 331.48590626473595, "episode_len_mean": 48.41, "episodes_this_iter": 19, "episodes_timesteps_total": 4841, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [333.0304620838297, 338.6651178343089, 354.1544849849906, 354.24196344008163, 352.98210871657176, 329.472487493332, 367.12216873456265, 328.9558104986738, 348.25722070289265, 322.533108173492, 364.40349426241704, 360.20298274306026, 323.04412080688036, 340.772839599606, 350.6641933651111, 340.5086105685578, 351.74419073435723, 360.9255092507075, 330.3709277630009, 347.58169976614977, 350.3727653100419, 355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165, 351.8349920761289, 131.26970214843755, 306.7698272184487, 348.98747213549126, 145.6782048159365, 366.0621783387905, 358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974, 353.25497619639094, 350.0354050706001, 350.7940972169101, 290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469, 355.9039801172234, 355.5194171337548, 343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 25, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.619943970770468, "mean_inference_ms": 1.2345639972270892, "mean_action_processing_ms": 0.20432960163913894, "mean_env_wait_ms": 489.5652445027461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01055145263671875, "StateBufferConnector_ms": 0.005977153778076172, "ViewRequirementAgentConnector_ms": 0.16715097427368164}, "num_episodes": 19, "episode_return_max": 373.23451553600586, "episode_return_min": 103.78155389057434, "episode_return_mean": 331.48590626473595, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143874, "num_agent_steps_trained": 143874, "num_env_steps_sampled": 143874, "num_env_steps_trained": 143874, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.48014458450429, "num_env_steps_trained_throughput_per_sec": 11.48014458450429, "timesteps_total": 143874, "num_env_steps_sampled_lifetime": 143874, "num_agent_steps_sampled_lifetime": 143874, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 143874, "timers": {"training_iteration_time_ms": 90806.024, "restore_workers_time_ms": 0.018, "training_step_time_ms": 90805.97, "sample_time_ms": 89135.906, "load_time_ms": 0.433, "load_throughput": 2368012.839, "learn_time_ms": 1656.096, "learn_throughput": 619.529, "synch_weights_time_ms": 13.188}, "counters": {"num_env_steps_sampled": 143874, "num_env_steps_trained": 143874, "num_agent_steps_sampled": 143874, "num_agent_steps_trained": 143874}, "done": false, "episodes_total": 3170, "training_iteration": 145, "trial_id": "fe178_00005", "date": "2024-08-15_21-06-46", "timestamp": 1723777606, "time_this_iter_s": 89.37534737586975, "time_total_s": 13796.764706134796, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 635.6677191257477, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 22.10546875, "ram_util_percent": 10.3875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.62824663321177, "cur_kl_coeff": 0.03254658593348519, "cur_lr": 5e-06, "total_loss": 4.1546405397355555, "policy_loss": -0.008577705873176456, "vf_loss": 4.1623454655210175, "vf_explained_var": 0.044244251151879625, "kl": 0.02681595853670719, "entropy": -1.3402615323662759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1800.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 144900, "num_env_steps_trained": 144900, "num_agent_steps_sampled": 144900, "num_agent_steps_trained": 144900}, "sampler_results": {"episode_reward_max": 373.23451553600586, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 330.0502758797869, "episode_len_mean": 48.41, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4841, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165, 351.8349920761289, 131.26970214843755, 306.7698272184487, 348.98747213549126, 145.6782048159365, 366.0621783387905, 358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974, 353.25497619639094, 350.0354050706001, 350.7940972169101, 290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469, 355.9039801172234, 355.5194171337548, 343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429, 364.05534428813996, 351.729521817504, 328.88359782612173, 309.8903601938496, 360.08244213720707, 284.1957735629395, 306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301], "episode_lengths": [50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 25, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.634730070470071, "mean_inference_ms": 1.2345824036491602, "mean_action_processing_ms": 0.20445304451997154, "mean_env_wait_ms": 486.1716398592942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009903430938720703, "StateBufferConnector_ms": 0.0059566497802734375, "ViewRequirementAgentConnector_ms": 0.16705799102783203}, "num_episodes": 21, "episode_return_max": 373.23451553600586, "episode_return_min": 103.78155389057434, "episode_return_mean": 330.0502758797869}, "env_runner_results": {"episode_reward_max": 373.23451553600586, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 330.0502758797869, "episode_len_mean": 48.41, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4841, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165, 351.8349920761289, 131.26970214843755, 306.7698272184487, 348.98747213549126, 145.6782048159365, 366.0621783387905, 358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974, 353.25497619639094, 350.0354050706001, 350.7940972169101, 290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469, 355.9039801172234, 355.5194171337548, 343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429, 364.05534428813996, 351.729521817504, 328.88359782612173, 309.8903601938496, 360.08244213720707, 284.1957735629395, 306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301], "episode_lengths": [50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 25, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.634730070470071, "mean_inference_ms": 1.2345824036491602, "mean_action_processing_ms": 0.20445304451997154, "mean_env_wait_ms": 486.1716398592942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009903430938720703, "StateBufferConnector_ms": 0.0059566497802734375, "ViewRequirementAgentConnector_ms": 0.16705799102783203}, "num_episodes": 21, "episode_return_max": 373.23451553600586, "episode_return_min": 103.78155389057434, "episode_return_mean": 330.0502758797869}, "episode_reward_max": 373.23451553600586, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 330.0502758797869, "episode_len_mean": 48.41, "episodes_this_iter": 21, "episodes_timesteps_total": 4841, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [355.31706485573295, 319.1078700698121, 373.23451553600586, 141.09674902585016, 300.96918226057875, 346.35700182657774, 359.94245181920036, 347.1682878656602, 354.7279194675399, 324.1989736203067, 347.57445913680766, 302.8424598051891, 339.4732291077221, 356.8780368545638, 299.3736690025165, 351.8349920761289, 131.26970214843755, 306.7698272184487, 348.98747213549126, 145.6782048159365, 366.0621783387905, 358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974, 353.25497619639094, 350.0354050706001, 350.7940972169101, 290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469, 355.9039801172234, 355.5194171337548, 343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429, 364.05534428813996, 351.729521817504, 328.88359782612173, 309.8903601938496, 360.08244213720707, 284.1957735629395, 306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301], "episode_lengths": [50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 25, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.634730070470071, "mean_inference_ms": 1.2345824036491602, "mean_action_processing_ms": 0.20445304451997154, "mean_env_wait_ms": 486.1716398592942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009903430938720703, "StateBufferConnector_ms": 0.0059566497802734375, "ViewRequirementAgentConnector_ms": 0.16705799102783203}, "num_episodes": 21, "episode_return_max": 373.23451553600586, "episode_return_min": 103.78155389057434, "episode_return_mean": 330.0502758797869, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144900, "num_agent_steps_trained": 144900, "num_env_steps_sampled": 144900, "num_env_steps_trained": 144900, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.131554849055886, "num_env_steps_trained_throughput_per_sec": 11.131554849055886, "timesteps_total": 144900, "num_env_steps_sampled_lifetime": 144900, "num_agent_steps_sampled_lifetime": 144900, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 144900, "timers": {"training_iteration_time_ms": 90976.574, "restore_workers_time_ms": 0.018, "training_step_time_ms": 90976.521, "sample_time_ms": 89358.522, "load_time_ms": 0.423, "load_throughput": 2425792.505, "learn_time_ms": 1604.135, "learn_throughput": 639.597, "synch_weights_time_ms": 13.103}, "counters": {"num_env_steps_sampled": 144900, "num_env_steps_trained": 144900, "num_agent_steps_sampled": 144900, "num_agent_steps_trained": 144900}, "done": false, "episodes_total": 3191, "training_iteration": 146, "trial_id": "fe178_00005", "date": "2024-08-15_21-08-18", "timestamp": 1723777698, "time_this_iter_s": 92.17405772209167, "time_total_s": 13888.938763856888, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 727.8417768478394, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.307575757575762, "ram_util_percent": 10.602272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.9086280186971, "cur_kl_coeff": 0.04881987890022777, "cur_lr": 5e-06, "total_loss": 4.911622630804777, "policy_loss": 0.01653277037354807, "vf_loss": 4.891780864695708, "vf_explained_var": 0.047982565810283026, "kl": 0.06778016063326504, "entropy": -1.7294755473732948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2040.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 145926, "num_env_steps_trained": 145926, "num_agent_steps_sampled": 145926, "num_agent_steps_trained": 145926}, "sampler_results": {"episode_reward_max": 373.27131099882166, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 338.34642318551647, "episode_len_mean": 49.18, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4918, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974, 353.25497619639094, 350.0354050706001, 350.7940972169101, 290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469, 355.9039801172234, 355.5194171337548, 343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429, 364.05534428813996, 351.729521817504, 328.88359782612173, 309.8903601938496, 360.08244213720707, 284.1957735629395, 306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301, 347.77901380632085, 356.17763858821775, 341.05483576521715, 303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345], "episode_lengths": [50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.637208361273041, "mean_inference_ms": 1.2335507969740993, "mean_action_processing_ms": 0.2045276463522989, "mean_env_wait_ms": 484.53378778227886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010002613067626953, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.166717529296875}, "num_episodes": 21, "episode_return_max": 373.27131099882166, "episode_return_min": 103.78155389057434, "episode_return_mean": 338.34642318551647}, "env_runner_results": {"episode_reward_max": 373.27131099882166, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 338.34642318551647, "episode_len_mean": 49.18, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4918, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974, 353.25497619639094, 350.0354050706001, 350.7940972169101, 290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469, 355.9039801172234, 355.5194171337548, 343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429, 364.05534428813996, 351.729521817504, 328.88359782612173, 309.8903601938496, 360.08244213720707, 284.1957735629395, 306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301, 347.77901380632085, 356.17763858821775, 341.05483576521715, 303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345], "episode_lengths": [50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.637208361273041, "mean_inference_ms": 1.2335507969740993, "mean_action_processing_ms": 0.2045276463522989, "mean_env_wait_ms": 484.53378778227886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010002613067626953, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.166717529296875}, "num_episodes": 21, "episode_return_max": 373.27131099882166, "episode_return_min": 103.78155389057434, "episode_return_mean": 338.34642318551647}, "episode_reward_max": 373.27131099882166, "episode_reward_min": 103.78155389057434, "episode_reward_mean": 338.34642318551647, "episode_len_mean": 49.18, "episodes_this_iter": 21, "episodes_timesteps_total": 4918, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [358.4697789856574, 103.78155389057434, 349.54627882065176, 354.7933421155821, 343.9802851759904, 349.6437365060999, 335.2711660206664, 360.83805815086225, 353.2241808900027, 322.51025860840826, 325.5655038514701, 318.22271807606177, 283.823931836562, 314.73331992557087, 363.91545410156255, 348.7340134748892, 371.7352384212317, 320.71177064529974, 353.25497619639094, 350.0354050706001, 350.7940972169101, 290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469, 355.9039801172234, 355.5194171337548, 343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429, 364.05534428813996, 351.729521817504, 328.88359782612173, 309.8903601938496, 360.08244213720707, 284.1957735629395, 306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301, 347.77901380632085, 356.17763858821775, 341.05483576521715, 303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345], "episode_lengths": [50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.637208361273041, "mean_inference_ms": 1.2335507969740993, "mean_action_processing_ms": 0.2045276463522989, "mean_env_wait_ms": 484.53378778227886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010002613067626953, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.166717529296875}, "num_episodes": 21, "episode_return_max": 373.27131099882166, "episode_return_min": 103.78155389057434, "episode_return_mean": 338.34642318551647, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145926, "num_agent_steps_trained": 145926, "num_env_steps_sampled": 145926, "num_env_steps_trained": 145926, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.657669903527683, "num_env_steps_trained_throughput_per_sec": 10.657669903527683, "timesteps_total": 145926, "num_env_steps_sampled_lifetime": 145926, "num_agent_steps_sampled_lifetime": 145926, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 145926, "timers": {"training_iteration_time_ms": 91564.589, "restore_workers_time_ms": 0.017, "training_step_time_ms": 91564.538, "sample_time_ms": 89990.119, "load_time_ms": 0.41, "load_throughput": 2501466.327, "learn_time_ms": 1560.656, "learn_throughput": 657.416, "synch_weights_time_ms": 13.028}, "counters": {"num_env_steps_sampled": 145926, "num_env_steps_trained": 145926, "num_agent_steps_sampled": 145926, "num_agent_steps_trained": 145926}, "done": false, "episodes_total": 3212, "training_iteration": 147, "trial_id": "fe178_00005", "date": "2024-08-15_21-09-54", "timestamp": 1723777794, "time_this_iter_s": 96.272390127182, "time_total_s": 13985.21115398407, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 824.1141669750214, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 21.25693430656934, "ram_util_percent": 10.697080291970803}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.75938577055931, "cur_kl_coeff": 0.07322981835034167, "cur_lr": 5e-06, "total_loss": 4.433775122463703, "policy_loss": -0.00667415054825445, "vf_loss": 4.439382533729076, "vf_explained_var": 0.14416894242167472, "kl": 0.014567334425617624, "entropy": -1.2676838338375092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2280.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 146952, "num_env_steps_trained": 146952, "num_agent_steps_sampled": 146952, "num_agent_steps_trained": 146952}, "sampler_results": {"episode_reward_max": 373.27131099882166, "episode_reward_min": 117.65173463142906, "episode_reward_mean": 337.22197996010806, "episode_len_mean": 49.51, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4951, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469, 355.9039801172234, 355.5194171337548, 343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429, 364.05534428813996, 351.729521817504, 328.88359782612173, 309.8903601938496, 360.08244213720707, 284.1957735629395, 306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301, 347.77901380632085, 356.17763858821775, 341.05483576521715, 303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345, 303.3957441450742, 355.5440990613716, 351.1333731157349, 291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.636369785650609, "mean_inference_ms": 1.2331421285875845, "mean_action_processing_ms": 0.20454090729810315, "mean_env_wait_ms": 484.37622496978935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010055780410766602, "StateBufferConnector_ms": 0.005860805511474609, "ViewRequirementAgentConnector_ms": 0.1663341522216797}, "num_episodes": 21, "episode_return_max": 373.27131099882166, "episode_return_min": 117.65173463142906, "episode_return_mean": 337.22197996010806}, "env_runner_results": {"episode_reward_max": 373.27131099882166, "episode_reward_min": 117.65173463142906, "episode_reward_mean": 337.22197996010806, "episode_len_mean": 49.51, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4951, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469, 355.9039801172234, 355.5194171337548, 343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429, 364.05534428813996, 351.729521817504, 328.88359782612173, 309.8903601938496, 360.08244213720707, 284.1957735629395, 306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301, 347.77901380632085, 356.17763858821775, 341.05483576521715, 303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345, 303.3957441450742, 355.5440990613716, 351.1333731157349, 291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.636369785650609, "mean_inference_ms": 1.2331421285875845, "mean_action_processing_ms": 0.20454090729810315, "mean_env_wait_ms": 484.37622496978935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010055780410766602, "StateBufferConnector_ms": 0.005860805511474609, "ViewRequirementAgentConnector_ms": 0.1663341522216797}, "num_episodes": 21, "episode_return_max": 373.27131099882166, "episode_return_min": 117.65173463142906, "episode_return_mean": 337.22197996010806}, "episode_reward_max": 373.27131099882166, "episode_reward_min": 117.65173463142906, "episode_reward_mean": 337.22197996010806, "episode_len_mean": 49.51, "episodes_this_iter": 21, "episodes_timesteps_total": 4951, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [290.56493878024753, 333.68998950213125, 355.72073797860196, 360.4171020507813, 346.37867438954896, 364.15020513560626, 325.0462046189463, 345.70185422610496, 363.2291903051766, 360.800102990323, 314.28237659276846, 364.1443467485251, 352.5323827396233, 162.21433899592694, 304.8511773334018, 357.07744325142016, 362.93507772947476, 364.043151855469, 355.9039801172234, 355.5194171337548, 343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429, 364.05534428813996, 351.729521817504, 328.88359782612173, 309.8903601938496, 360.08244213720707, 284.1957735629395, 306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301, 347.77901380632085, 356.17763858821775, 341.05483576521715, 303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345, 303.3957441450742, 355.5440990613716, 351.1333731157349, 291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 30, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.636369785650609, "mean_inference_ms": 1.2331421285875845, "mean_action_processing_ms": 0.20454090729810315, "mean_env_wait_ms": 484.37622496978935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010055780410766602, "StateBufferConnector_ms": 0.005860805511474609, "ViewRequirementAgentConnector_ms": 0.1663341522216797}, "num_episodes": 21, "episode_return_max": 373.27131099882166, "episode_return_min": 117.65173463142906, "episode_return_mean": 337.22197996010806, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146952, "num_agent_steps_trained": 146952, "num_env_steps_sampled": 146952, "num_env_steps_trained": 146952, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.004369276487058, "num_env_steps_trained_throughput_per_sec": 10.004369276487058, "timesteps_total": 146952, "num_env_steps_sampled_lifetime": 146952, "num_agent_steps_sampled_lifetime": 146952, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 146952, "timers": {"training_iteration_time_ms": 92663.65, "restore_workers_time_ms": 0.017, "training_step_time_ms": 92663.601, "sample_time_ms": 91126.606, "load_time_ms": 0.403, "load_throughput": 2547872.057, "learn_time_ms": 1523.293, "learn_throughput": 673.541, "synch_weights_time_ms": 12.98}, "counters": {"num_env_steps_sampled": 146952, "num_env_steps_trained": 146952, "num_agent_steps_sampled": 146952, "num_agent_steps_trained": 146952}, "done": false, "episodes_total": 3233, "training_iteration": 148, "trial_id": "fe178_00005", "date": "2024-08-15_21-11-37", "timestamp": 1723777897, "time_this_iter_s": 102.55887746810913, "time_total_s": 14087.770031452179, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 926.6730444431305, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 20.593197278911564, "ram_util_percent": 10.807482993197278}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.00983986059825, "cur_kl_coeff": 0.07322981835034167, "cur_lr": 5e-06, "total_loss": 4.307026069611311, "policy_loss": -0.0014605713697771231, "vf_loss": 4.305203061550856, "vf_explained_var": 0.07102105046312014, "kl": 0.04483952666050954, "entropy": -1.4871429070830344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2520.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 147978, "num_env_steps_trained": 147978, "num_agent_steps_sampled": 147978, "num_agent_steps_trained": 147978}, "sampler_results": {"episode_reward_max": 373.27131099882166, "episode_reward_min": 117.65173463142906, "episode_reward_mean": 337.88329977424314, "episode_len_mean": 49.71, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4971, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429, 364.05534428813996, 351.729521817504, 328.88359782612173, 309.8903601938496, 360.08244213720707, 284.1957735629395, 306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301, 347.77901380632085, 356.17763858821775, 341.05483576521715, 303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345, 303.3957441450742, 355.5440990613716, 351.1333731157349, 291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897, 361.8540454772046, 338.8187057618656, 344.18669635647746, 342.84308319514236, 350.1887695094147, 343.3701599130481, 343.5001898690086, 351.6781863400336, 353.17479353714793, 309.5621410950726, 334.853613464879, 336.6020963972389, 330.0646373419196, 359.8689555300985, 349.14245043018195, 343.4582121450735, 268.2815585404173, 360.4653589784318, 355.88510996808196, 327.53591003781895], "episode_lengths": [50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.627904610942044, "mean_inference_ms": 1.2322646580541652, "mean_action_processing_ms": 0.20447282375894993, "mean_env_wait_ms": 485.5548041923477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010014057159423828, "StateBufferConnector_ms": 0.00579833984375, "ViewRequirementAgentConnector_ms": 0.1649625301361084}, "num_episodes": 20, "episode_return_max": 373.27131099882166, "episode_return_min": 117.65173463142906, "episode_return_mean": 337.88329977424314}, "env_runner_results": {"episode_reward_max": 373.27131099882166, "episode_reward_min": 117.65173463142906, "episode_reward_mean": 337.88329977424314, "episode_len_mean": 49.71, "episode_media": {}, "episodes_this_iter": 20, "episodes_timesteps_total": 4971, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429, 364.05534428813996, 351.729521817504, 328.88359782612173, 309.8903601938496, 360.08244213720707, 284.1957735629395, 306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301, 347.77901380632085, 356.17763858821775, 341.05483576521715, 303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345, 303.3957441450742, 355.5440990613716, 351.1333731157349, 291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897, 361.8540454772046, 338.8187057618656, 344.18669635647746, 342.84308319514236, 350.1887695094147, 343.3701599130481, 343.5001898690086, 351.6781863400336, 353.17479353714793, 309.5621410950726, 334.853613464879, 336.6020963972389, 330.0646373419196, 359.8689555300985, 349.14245043018195, 343.4582121450735, 268.2815585404173, 360.4653589784318, 355.88510996808196, 327.53591003781895], "episode_lengths": [50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.627904610942044, "mean_inference_ms": 1.2322646580541652, "mean_action_processing_ms": 0.20447282375894993, "mean_env_wait_ms": 485.5548041923477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010014057159423828, "StateBufferConnector_ms": 0.00579833984375, "ViewRequirementAgentConnector_ms": 0.1649625301361084}, "num_episodes": 20, "episode_return_max": 373.27131099882166, "episode_return_min": 117.65173463142906, "episode_return_mean": 337.88329977424314}, "episode_reward_max": 373.27131099882166, "episode_reward_min": 117.65173463142906, "episode_reward_mean": 337.88329977424314, "episode_len_mean": 49.71, "episodes_this_iter": 20, "episodes_timesteps_total": 4971, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [343.82155761718786, 354.10898275490354, 360.3085416874557, 352.68772621217573, 117.65173463142906, 363.6179394359141, 340.6981980474221, 354.9851496029775, 349.21431073005886, 366.12265797500584, 345.92602182151074, 335.6624976271015, 344.2071333070764, 325.11003369599115, 354.0424812492603, 350.53571509286746, 348.2316707092429, 364.05534428813996, 351.729521817504, 328.88359782612173, 309.8903601938496, 360.08244213720707, 284.1957735629395, 306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301, 347.77901380632085, 356.17763858821775, 341.05483576521715, 303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345, 303.3957441450742, 355.5440990613716, 351.1333731157349, 291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897, 361.8540454772046, 338.8187057618656, 344.18669635647746, 342.84308319514236, 350.1887695094147, 343.3701599130481, 343.5001898690086, 351.6781863400336, 353.17479353714793, 309.5621410950726, 334.853613464879, 336.6020963972389, 330.0646373419196, 359.8689555300985, 349.14245043018195, 343.4582121450735, 268.2815585404173, 360.4653589784318, 355.88510996808196, 327.53591003781895], "episode_lengths": [50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.627904610942044, "mean_inference_ms": 1.2322646580541652, "mean_action_processing_ms": 0.20447282375894993, "mean_env_wait_ms": 485.5548041923477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010014057159423828, "StateBufferConnector_ms": 0.00579833984375, "ViewRequirementAgentConnector_ms": 0.1649625301361084}, "num_episodes": 20, "episode_return_max": 373.27131099882166, "episode_return_min": 117.65173463142906, "episode_return_mean": 337.88329977424314, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147978, "num_agent_steps_trained": 147978, "num_env_steps_sampled": 147978, "num_env_steps_trained": 147978, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.96101979497906, "num_env_steps_trained_throughput_per_sec": 11.96101979497906, "timesteps_total": 147978, "num_env_steps_sampled_lifetime": 147978, "num_agent_steps_sampled_lifetime": 147978, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 147978, "timers": {"training_iteration_time_ms": 91040.481, "restore_workers_time_ms": 0.016, "training_step_time_ms": 91040.434, "sample_time_ms": 89789.618, "load_time_ms": 0.363, "load_throughput": 2825392.886, "learn_time_ms": 1237.236, "learn_throughput": 829.268, "synch_weights_time_ms": 12.925}, "counters": {"num_env_steps_sampled": 147978, "num_env_steps_trained": 147978, "num_agent_steps_sampled": 147978, "num_agent_steps_trained": 147978}, "done": false, "episodes_total": 3253, "training_iteration": 149, "trial_id": "fe178_00005", "date": "2024-08-15_21-13-03", "timestamp": 1723777983, "time_this_iter_s": 85.7827422618866, "time_total_s": 14173.552773714066, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1012.4557867050171, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 23.55983606557377, "ram_util_percent": 10.895081967213118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.589240262905754, "cur_kl_coeff": 0.10984472752551254, "cur_lr": 5e-06, "total_loss": 4.2570393803219, "policy_loss": -0.005008283238081882, "vf_loss": 4.261498369276524, "vf_explained_var": 0.1387729153037071, "kl": 0.0050010604594737905, "entropy": -1.5708274483680724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2760.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 149004, "num_env_steps_trained": 149004, "num_agent_steps_sampled": 149004, "num_agent_steps_trained": 149004}, "sampler_results": {"episode_reward_max": 373.27131099882166, "episode_reward_min": 126.92611083984377, "episode_reward_mean": 337.7806366505083, "episode_len_mean": 49.71, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 4971, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301, 347.77901380632085, 356.17763858821775, 341.05483576521715, 303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345, 303.3957441450742, 355.5440990613716, 351.1333731157349, 291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897, 361.8540454772046, 338.8187057618656, 344.18669635647746, 342.84308319514236, 350.1887695094147, 343.3701599130481, 343.5001898690086, 351.6781863400336, 353.17479353714793, 309.5621410950726, 334.853613464879, 336.6020963972389, 330.0646373419196, 359.8689555300985, 349.14245043018195, 343.4582121450735, 268.2815585404173, 360.4653589784318, 355.88510996808196, 327.53591003781895, 347.2761159945931, 361.7274187893796, 304.3641190924807, 355.3860350173633, 354.69575075532543, 348.7061965984064, 360.52151121207856, 340.1154678909271, 315.5807246869478, 346.775301419377, 361.76729736328116, 126.92611083984377, 353.2970909993306, 343.5665307762325, 329.5648325997423, 333.77557637591264, 355.4721059128838, 338.5586309300299, 331.8957979458823, 358.2616222750328, 347.99560654631085, 356.0276414257088, 323.2455942027853], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.625506246304017, "mean_inference_ms": 1.230336185993113, "mean_action_processing_ms": 0.20423910583875454, "mean_env_wait_ms": 488.1717942580428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009929418563842773, "StateBufferConnector_ms": 0.005769491195678711, "ViewRequirementAgentConnector_ms": 0.1642453670501709}, "num_episodes": 23, "episode_return_max": 373.27131099882166, "episode_return_min": 126.92611083984377, "episode_return_mean": 337.7806366505083}, "env_runner_results": {"episode_reward_max": 373.27131099882166, "episode_reward_min": 126.92611083984377, "episode_reward_mean": 337.7806366505083, "episode_len_mean": 49.71, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 4971, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301, 347.77901380632085, 356.17763858821775, 341.05483576521715, 303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345, 303.3957441450742, 355.5440990613716, 351.1333731157349, 291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897, 361.8540454772046, 338.8187057618656, 344.18669635647746, 342.84308319514236, 350.1887695094147, 343.3701599130481, 343.5001898690086, 351.6781863400336, 353.17479353714793, 309.5621410950726, 334.853613464879, 336.6020963972389, 330.0646373419196, 359.8689555300985, 349.14245043018195, 343.4582121450735, 268.2815585404173, 360.4653589784318, 355.88510996808196, 327.53591003781895, 347.2761159945931, 361.7274187893796, 304.3641190924807, 355.3860350173633, 354.69575075532543, 348.7061965984064, 360.52151121207856, 340.1154678909271, 315.5807246869478, 346.775301419377, 361.76729736328116, 126.92611083984377, 353.2970909993306, 343.5665307762325, 329.5648325997423, 333.77557637591264, 355.4721059128838, 338.5586309300299, 331.8957979458823, 358.2616222750328, 347.99560654631085, 356.0276414257088, 323.2455942027853], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.625506246304017, "mean_inference_ms": 1.230336185993113, "mean_action_processing_ms": 0.20423910583875454, "mean_env_wait_ms": 488.1717942580428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009929418563842773, "StateBufferConnector_ms": 0.005769491195678711, "ViewRequirementAgentConnector_ms": 0.1642453670501709}, "num_episodes": 23, "episode_return_max": 373.27131099882166, "episode_return_min": 126.92611083984377, "episode_return_mean": 337.7806366505083}, "episode_reward_max": 373.27131099882166, "episode_reward_min": 126.92611083984377, "episode_reward_mean": 337.7806366505083, "episode_len_mean": 49.71, "episodes_this_iter": 23, "episodes_timesteps_total": 4971, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [306.8395313904882, 313.3179951677415, 311.9606783990584, 355.04532434283993, 365.53927745721296, 364.0372271535683, 358.72650122419094, 330.11354907346197, 347.47207696210796, 347.61240163919143, 349.2210562507819, 357.8547772279699, 331.1177292039734, 319.25154478803915, 349.4965182313301, 347.77901380632085, 356.17763858821775, 341.05483576521715, 303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345, 303.3957441450742, 355.5440990613716, 351.1333731157349, 291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897, 361.8540454772046, 338.8187057618656, 344.18669635647746, 342.84308319514236, 350.1887695094147, 343.3701599130481, 343.5001898690086, 351.6781863400336, 353.17479353714793, 309.5621410950726, 334.853613464879, 336.6020963972389, 330.0646373419196, 359.8689555300985, 349.14245043018195, 343.4582121450735, 268.2815585404173, 360.4653589784318, 355.88510996808196, 327.53591003781895, 347.2761159945931, 361.7274187893796, 304.3641190924807, 355.3860350173633, 354.69575075532543, 348.7061965984064, 360.52151121207856, 340.1154678909271, 315.5807246869478, 346.775301419377, 361.76729736328116, 126.92611083984377, 353.2970909993306, 343.5665307762325, 329.5648325997423, 333.77557637591264, 355.4721059128838, 338.5586309300299, 331.8957979458823, 358.2616222750328, 347.99560654631085, 356.0276414257088, 323.2455942027853], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.625506246304017, "mean_inference_ms": 1.230336185993113, "mean_action_processing_ms": 0.20423910583875454, "mean_env_wait_ms": 488.1717942580428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009929418563842773, "StateBufferConnector_ms": 0.005769491195678711, "ViewRequirementAgentConnector_ms": 0.1642453670501709}, "num_episodes": 23, "episode_return_max": 373.27131099882166, "episode_return_min": 126.92611083984377, "episode_return_mean": 337.7806366505083, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149004, "num_agent_steps_trained": 149004, "num_env_steps_sampled": 149004, "num_env_steps_trained": 149004, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.986627598287086, "num_env_steps_trained_throughput_per_sec": 9.986627598287086, "timesteps_total": 149004, "num_env_steps_sampled_lifetime": 149004, "num_agent_steps_sampled_lifetime": 149004, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 149004, "timers": {"training_iteration_time_ms": 92586.155, "restore_workers_time_ms": 0.015, "training_step_time_ms": 92586.11, "sample_time_ms": 91339.245, "load_time_ms": 0.358, "load_throughput": 2864511.685, "learn_time_ms": 1233.413, "learn_throughput": 831.838, "synch_weights_time_ms": 12.813}, "counters": {"num_env_steps_sampled": 149004, "num_env_steps_trained": 149004, "num_agent_steps_sampled": 149004, "num_agent_steps_trained": 149004}, "done": false, "episodes_total": 3276, "training_iteration": 150, "trial_id": "fe178_00005", "date": "2024-08-15_21-14-45", "timestamp": 1723778085, "time_this_iter_s": 102.7410876750946, "time_total_s": 14276.29386138916, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1115.1968743801117, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 20.87142857142857, "ram_util_percent": 11.001360544217686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.97785715262095, "cur_kl_coeff": 0.10984472752551254, "cur_lr": 5e-06, "total_loss": 4.218606196095546, "policy_loss": -0.0005580646917223931, "vf_loss": 4.21559030165275, "vf_explained_var": 0.03590783178806305, "kl": 0.03253676398793319, "entropy": -1.5053389566640059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3000.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 150030, "num_env_steps_trained": 150030, "num_agent_steps_sampled": 150030, "num_agent_steps_trained": 150030}, "sampler_results": {"episode_reward_max": 373.27131099882166, "episode_reward_min": 126.92611083984377, "episode_reward_mean": 337.68741585826507, "episode_len_mean": 49.71, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 4971, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345, 303.3957441450742, 355.5440990613716, 351.1333731157349, 291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897, 361.8540454772046, 338.8187057618656, 344.18669635647746, 342.84308319514236, 350.1887695094147, 343.3701599130481, 343.5001898690086, 351.6781863400336, 353.17479353714793, 309.5621410950726, 334.853613464879, 336.6020963972389, 330.0646373419196, 359.8689555300985, 349.14245043018195, 343.4582121450735, 268.2815585404173, 360.4653589784318, 355.88510996808196, 327.53591003781895, 347.2761159945931, 361.7274187893796, 304.3641190924807, 355.3860350173633, 354.69575075532543, 348.7061965984064, 360.52151121207856, 340.1154678909271, 315.5807246869478, 346.775301419377, 361.76729736328116, 126.92611083984377, 353.2970909993306, 343.5665307762325, 329.5648325997423, 333.77557637591264, 355.4721059128838, 338.5586309300299, 331.8957979458823, 358.2616222750328, 347.99560654631085, 356.0276414257088, 323.2455942027853, 361.8681402039532, 290.42695234463014, 368.8601823419753, 327.8473398987429, 354.9208901845854, 323.29853332555206, 323.36143798876697, 348.40706412022604, 363.1150666868721, 352.0327221638305, 315.7787475616097, 354.00864046357447, 353.2452307950719, 310.3116011020089, 357.27425515315724, 364.8489252662459, 342.83358555496875, 330.8562822916177], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.627772859402202, "mean_inference_ms": 1.2293272712078929, "mean_action_processing_ms": 0.20425046755326506, "mean_env_wait_ms": 489.61475493770865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00982213020324707, "StateBufferConnector_ms": 0.005688905715942383, "ViewRequirementAgentConnector_ms": 0.16341495513916016}, "num_episodes": 18, "episode_return_max": 373.27131099882166, "episode_return_min": 126.92611083984377, "episode_return_mean": 337.68741585826507}, "env_runner_results": {"episode_reward_max": 373.27131099882166, "episode_reward_min": 126.92611083984377, "episode_reward_mean": 337.68741585826507, "episode_len_mean": 49.71, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 4971, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345, 303.3957441450742, 355.5440990613716, 351.1333731157349, 291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897, 361.8540454772046, 338.8187057618656, 344.18669635647746, 342.84308319514236, 350.1887695094147, 343.3701599130481, 343.5001898690086, 351.6781863400336, 353.17479353714793, 309.5621410950726, 334.853613464879, 336.6020963972389, 330.0646373419196, 359.8689555300985, 349.14245043018195, 343.4582121450735, 268.2815585404173, 360.4653589784318, 355.88510996808196, 327.53591003781895, 347.2761159945931, 361.7274187893796, 304.3641190924807, 355.3860350173633, 354.69575075532543, 348.7061965984064, 360.52151121207856, 340.1154678909271, 315.5807246869478, 346.775301419377, 361.76729736328116, 126.92611083984377, 353.2970909993306, 343.5665307762325, 329.5648325997423, 333.77557637591264, 355.4721059128838, 338.5586309300299, 331.8957979458823, 358.2616222750328, 347.99560654631085, 356.0276414257088, 323.2455942027853, 361.8681402039532, 290.42695234463014, 368.8601823419753, 327.8473398987429, 354.9208901845854, 323.29853332555206, 323.36143798876697, 348.40706412022604, 363.1150666868721, 352.0327221638305, 315.7787475616097, 354.00864046357447, 353.2452307950719, 310.3116011020089, 357.27425515315724, 364.8489252662459, 342.83358555496875, 330.8562822916177], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.627772859402202, "mean_inference_ms": 1.2293272712078929, "mean_action_processing_ms": 0.20425046755326506, "mean_env_wait_ms": 489.61475493770865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00982213020324707, "StateBufferConnector_ms": 0.005688905715942383, "ViewRequirementAgentConnector_ms": 0.16341495513916016}, "num_episodes": 18, "episode_return_max": 373.27131099882166, "episode_return_min": 126.92611083984377, "episode_return_mean": 337.68741585826507}, "episode_reward_max": 373.27131099882166, "episode_reward_min": 126.92611083984377, "episode_reward_mean": 337.68741585826507, "episode_len_mean": 49.71, "episodes_this_iter": 18, "episodes_timesteps_total": 4971, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [303.5659222489411, 356.4258465115276, 371.5119267010707, 355.86231585264494, 354.0898448371814, 350.8424749757242, 341.53771637616825, 333.063176577246, 353.4573813324517, 353.4955587860437, 369.35142050809685, 370.3198806834018, 344.9664055858599, 358.41893306144505, 334.9915842984858, 335.5350741868722, 373.27131099882166, 342.76071587851345, 303.3957441450742, 355.5440990613716, 351.1333731157349, 291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897, 361.8540454772046, 338.8187057618656, 344.18669635647746, 342.84308319514236, 350.1887695094147, 343.3701599130481, 343.5001898690086, 351.6781863400336, 353.17479353714793, 309.5621410950726, 334.853613464879, 336.6020963972389, 330.0646373419196, 359.8689555300985, 349.14245043018195, 343.4582121450735, 268.2815585404173, 360.4653589784318, 355.88510996808196, 327.53591003781895, 347.2761159945931, 361.7274187893796, 304.3641190924807, 355.3860350173633, 354.69575075532543, 348.7061965984064, 360.52151121207856, 340.1154678909271, 315.5807246869478, 346.775301419377, 361.76729736328116, 126.92611083984377, 353.2970909993306, 343.5665307762325, 329.5648325997423, 333.77557637591264, 355.4721059128838, 338.5586309300299, 331.8957979458823, 358.2616222750328, 347.99560654631085, 356.0276414257088, 323.2455942027853, 361.8681402039532, 290.42695234463014, 368.8601823419753, 327.8473398987429, 354.9208901845854, 323.29853332555206, 323.36143798876697, 348.40706412022604, 363.1150666868721, 352.0327221638305, 315.7787475616097, 354.00864046357447, 353.2452307950719, 310.3116011020089, 357.27425515315724, 364.8489252662459, 342.83358555496875, 330.8562822916177], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.627772859402202, "mean_inference_ms": 1.2293272712078929, "mean_action_processing_ms": 0.20425046755326506, "mean_env_wait_ms": 489.61475493770865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00982213020324707, "StateBufferConnector_ms": 0.005688905715942383, "ViewRequirementAgentConnector_ms": 0.16341495513916016}, "num_episodes": 18, "episode_return_max": 373.27131099882166, "episode_return_min": 126.92611083984377, "episode_return_mean": 337.68741585826507, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150030, "num_agent_steps_trained": 150030, "num_env_steps_sampled": 150030, "num_env_steps_trained": 150030, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.527785613907445, "num_env_steps_trained_throughput_per_sec": 11.527785613907445, "timesteps_total": 150030, "num_env_steps_sampled_lifetime": 150030, "num_agent_steps_sampled_lifetime": 150030, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 150030, "timers": {"training_iteration_time_ms": 92244.039, "restore_workers_time_ms": 0.015, "training_step_time_ms": 92243.995, "sample_time_ms": 90996.982, "load_time_ms": 0.347, "load_throughput": 2955601.582, "learn_time_ms": 1233.659, "learn_throughput": 831.673, "synch_weights_time_ms": 12.736}, "counters": {"num_env_steps_sampled": 150030, "num_env_steps_trained": 150030, "num_agent_steps_sampled": 150030, "num_agent_steps_trained": 150030}, "done": false, "episodes_total": 3294, "training_iteration": 151, "trial_id": "fe178_00005", "date": "2024-08-15_21-16-14", "timestamp": 1723778174, "time_this_iter_s": 89.00573825836182, "time_total_s": 14365.299599647522, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1204.2026126384735, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 22.953543307086612, "ram_util_percent": 11.095275590551173}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.19950424631437, "cur_kl_coeff": 0.16476709128826877, "cur_lr": 5e-06, "total_loss": 4.265210542827845, "policy_loss": -0.005882425350137055, "vf_loss": 4.270664111028115, "vf_explained_var": 0.040382335583368935, "kl": 0.0026029100711959826, "entropy": -1.642833084364732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3240.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 151056, "num_env_steps_trained": 151056, "num_agent_steps_sampled": 151056, "num_agent_steps_trained": 151056}, "sampler_results": {"episode_reward_max": 368.8601823419753, "episode_reward_min": 102.00806795391256, "episode_reward_mean": 333.8174861277117, "episode_len_mean": 49.38, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4938, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897, 361.8540454772046, 338.8187057618656, 344.18669635647746, 342.84308319514236, 350.1887695094147, 343.3701599130481, 343.5001898690086, 351.6781863400336, 353.17479353714793, 309.5621410950726, 334.853613464879, 336.6020963972389, 330.0646373419196, 359.8689555300985, 349.14245043018195, 343.4582121450735, 268.2815585404173, 360.4653589784318, 355.88510996808196, 327.53591003781895, 347.2761159945931, 361.7274187893796, 304.3641190924807, 355.3860350173633, 354.69575075532543, 348.7061965984064, 360.52151121207856, 340.1154678909271, 315.5807246869478, 346.775301419377, 361.76729736328116, 126.92611083984377, 353.2970909993306, 343.5665307762325, 329.5648325997423, 333.77557637591264, 355.4721059128838, 338.5586309300299, 331.8957979458823, 358.2616222750328, 347.99560654631085, 356.0276414257088, 323.2455942027853, 361.8681402039532, 290.42695234463014, 368.8601823419753, 327.8473398987429, 354.9208901845854, 323.29853332555206, 323.36143798876697, 348.40706412022604, 363.1150666868721, 352.0327221638305, 315.7787475616097, 354.00864046357447, 353.2452307950719, 310.3116011020089, 357.27425515315724, 364.8489252662459, 342.83358555496875, 330.8562822916177, 345.7514564704872, 336.420898702399, 325.51369498291706, 312.89818968606346, 346.80066950229985, 307.31664568329023, 350.66876366514055, 355.9004686931352, 102.00806795391256, 327.228794146339, 346.5843806561856, 331.3164510128851, 362.6915303781158, 325.04197715101424, 291.6939630470715, 353.1372996769626, 362.8870752312026, 353.16409578507756, 361.86288920872806, 359.0327880859379, 368.6276329481778], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.621303561332029, "mean_inference_ms": 1.2281731802003872, "mean_action_processing_ms": 0.20418348426537736, "mean_env_wait_ms": 489.92545403581744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009693622589111328, "StateBufferConnector_ms": 0.005719900131225586, "ViewRequirementAgentConnector_ms": 0.16355347633361816}, "num_episodes": 21, "episode_return_max": 368.8601823419753, "episode_return_min": 102.00806795391256, "episode_return_mean": 333.8174861277117}, "env_runner_results": {"episode_reward_max": 368.8601823419753, "episode_reward_min": 102.00806795391256, "episode_reward_mean": 333.8174861277117, "episode_len_mean": 49.38, "episode_media": {}, "episodes_this_iter": 21, "episodes_timesteps_total": 4938, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897, 361.8540454772046, 338.8187057618656, 344.18669635647746, 342.84308319514236, 350.1887695094147, 343.3701599130481, 343.5001898690086, 351.6781863400336, 353.17479353714793, 309.5621410950726, 334.853613464879, 336.6020963972389, 330.0646373419196, 359.8689555300985, 349.14245043018195, 343.4582121450735, 268.2815585404173, 360.4653589784318, 355.88510996808196, 327.53591003781895, 347.2761159945931, 361.7274187893796, 304.3641190924807, 355.3860350173633, 354.69575075532543, 348.7061965984064, 360.52151121207856, 340.1154678909271, 315.5807246869478, 346.775301419377, 361.76729736328116, 126.92611083984377, 353.2970909993306, 343.5665307762325, 329.5648325997423, 333.77557637591264, 355.4721059128838, 338.5586309300299, 331.8957979458823, 358.2616222750328, 347.99560654631085, 356.0276414257088, 323.2455942027853, 361.8681402039532, 290.42695234463014, 368.8601823419753, 327.8473398987429, 354.9208901845854, 323.29853332555206, 323.36143798876697, 348.40706412022604, 363.1150666868721, 352.0327221638305, 315.7787475616097, 354.00864046357447, 353.2452307950719, 310.3116011020089, 357.27425515315724, 364.8489252662459, 342.83358555496875, 330.8562822916177, 345.7514564704872, 336.420898702399, 325.51369498291706, 312.89818968606346, 346.80066950229985, 307.31664568329023, 350.66876366514055, 355.9004686931352, 102.00806795391256, 327.228794146339, 346.5843806561856, 331.3164510128851, 362.6915303781158, 325.04197715101424, 291.6939630470715, 353.1372996769626, 362.8870752312026, 353.16409578507756, 361.86288920872806, 359.0327880859379, 368.6276329481778], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.621303561332029, "mean_inference_ms": 1.2281731802003872, "mean_action_processing_ms": 0.20418348426537736, "mean_env_wait_ms": 489.92545403581744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009693622589111328, "StateBufferConnector_ms": 0.005719900131225586, "ViewRequirementAgentConnector_ms": 0.16355347633361816}, "num_episodes": 21, "episode_return_max": 368.8601823419753, "episode_return_min": 102.00806795391256, "episode_return_mean": 333.8174861277117}, "episode_reward_max": 368.8601823419753, "episode_reward_min": 102.00806795391256, "episode_reward_mean": 333.8174861277117, "episode_len_mean": 49.38, "episodes_this_iter": 21, "episodes_timesteps_total": 4938, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [291.2147960046555, 322.71350834820896, 360.2391845417099, 307.7646881256504, 343.47839063161854, 363.5398494377157, 362.4547733537156, 367.3924457801049, 324.8557522436872, 247.43089890607655, 304.5194195800829, 245.8672920237263, 319.5496651282403, 305.9875748798642, 348.04885879129887, 312.6448018750334, 339.89574482554787, 343.4698846410897, 361.8540454772046, 338.8187057618656, 344.18669635647746, 342.84308319514236, 350.1887695094147, 343.3701599130481, 343.5001898690086, 351.6781863400336, 353.17479353714793, 309.5621410950726, 334.853613464879, 336.6020963972389, 330.0646373419196, 359.8689555300985, 349.14245043018195, 343.4582121450735, 268.2815585404173, 360.4653589784318, 355.88510996808196, 327.53591003781895, 347.2761159945931, 361.7274187893796, 304.3641190924807, 355.3860350173633, 354.69575075532543, 348.7061965984064, 360.52151121207856, 340.1154678909271, 315.5807246869478, 346.775301419377, 361.76729736328116, 126.92611083984377, 353.2970909993306, 343.5665307762325, 329.5648325997423, 333.77557637591264, 355.4721059128838, 338.5586309300299, 331.8957979458823, 358.2616222750328, 347.99560654631085, 356.0276414257088, 323.2455942027853, 361.8681402039532, 290.42695234463014, 368.8601823419753, 327.8473398987429, 354.9208901845854, 323.29853332555206, 323.36143798876697, 348.40706412022604, 363.1150666868721, 352.0327221638305, 315.7787475616097, 354.00864046357447, 353.2452307950719, 310.3116011020089, 357.27425515315724, 364.8489252662459, 342.83358555496875, 330.8562822916177, 345.7514564704872, 336.420898702399, 325.51369498291706, 312.89818968606346, 346.80066950229985, 307.31664568329023, 350.66876366514055, 355.9004686931352, 102.00806795391256, 327.228794146339, 346.5843806561856, 331.3164510128851, 362.6915303781158, 325.04197715101424, 291.6939630470715, 353.1372996769626, 362.8870752312026, 353.16409578507756, 361.86288920872806, 359.0327880859379, 368.6276329481778], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 17, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.621303561332029, "mean_inference_ms": 1.2281731802003872, "mean_action_processing_ms": 0.20418348426537736, "mean_env_wait_ms": 489.92545403581744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009693622589111328, "StateBufferConnector_ms": 0.005719900131225586, "ViewRequirementAgentConnector_ms": 0.16355347633361816}, "num_episodes": 21, "episode_return_max": 368.8601823419753, "episode_return_min": 102.00806795391256, "episode_return_mean": 333.8174861277117, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151056, "num_agent_steps_trained": 151056, "num_env_steps_sampled": 151056, "num_env_steps_trained": 151056, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.929922765591693, "num_env_steps_trained_throughput_per_sec": 10.929922765591693, "timesteps_total": 151056, "num_env_steps_sampled_lifetime": 151056, "num_agent_steps_sampled_lifetime": 151056, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 151056, "timers": {"training_iteration_time_ms": 92720.774, "restore_workers_time_ms": 0.015, "training_step_time_ms": 92720.733, "sample_time_ms": 91479.703, "load_time_ms": 0.341, "load_throughput": 3008918.965, "learn_time_ms": 1227.762, "learn_throughput": 835.667, "synch_weights_time_ms": 12.663}, "counters": {"num_env_steps_sampled": 151056, "num_env_steps_trained": 151056, "num_agent_steps_sampled": 151056, "num_agent_steps_trained": 151056}, "done": false, "episodes_total": 3315, "training_iteration": 152, "trial_id": "fe178_00005", "date": "2024-08-15_21-17-48", "timestamp": 1723778268, "time_this_iter_s": 93.87456226348877, "time_total_s": 14459.17416191101, "pid": 89032, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2931950616049318, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0946767820986962, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1298.0771749019623, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 22.477611940298512, "ram_util_percent": 11.17985074626866}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.392957060784102, "cur_kl_coeff": 1.1716770936054668, "cur_lr": 0.00010000000000000003, "total_loss": 2.4002571272974214, "policy_loss": -0.0022887591199832968, "vf_loss": 2.399129484159251, "vf_explained_var": 0.11016603124638398, "kl": 0.002915807122069582, "entropy": -1.6026703322927156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 151056, "num_env_steps_trained": 151056, "num_agent_steps_sampled": 151056, "num_agent_steps_trained": 151056}, "sampler_results": {"episode_reward_max": 370.970837087593, "episode_reward_min": 113.74387207031259, "episode_reward_mean": 341.3967856187604, "episode_len_mean": 49.189189189189186, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 1820, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.6283759252345, 341.4219104477484, 366.8755143205058, 348.5129116343419, 113.74387207031259, 344.89606617875376, 314.4874031615192, 330.6637083549022, 363.7176809876382, 342.37873390283454, 326.37256273055385, 348.57811129865576, 370.970837087593, 361.7024841809525, 346.20645214449047, 363.7849955751201, 353.2531579626137, 349.7347077541469, 341.0059146318285, 339.51614862458666, 330.1920078979517, 353.72352588142405, 346.227278649351, 355.4704533777889, 335.6110075577922, 344.8967562647446, 368.3626088877086, 369.04231465036605, 358.13025238700646, 331.7618490723145, 303.46117484308195, 344.461712424714, 351.6855224609378, 349.3041466555237, 358.57540941893217, 342.25313399086644, 360.07036449930183], "episode_lengths": [50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.334319464187796, "mean_inference_ms": 1.244560218704629, "mean_action_processing_ms": 0.2044718200344536, "mean_env_wait_ms": 496.63399825300155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01317423743170661, "StateBufferConnector_ms": 0.005955309481234164, "ViewRequirementAgentConnector_ms": 0.16050016557848132}, "num_episodes": 37, "episode_return_max": 370.970837087593, "episode_return_min": 113.74387207031259, "episode_return_mean": 341.3967856187604}, "env_runner_results": {"episode_reward_max": 370.970837087593, "episode_reward_min": 113.74387207031259, "episode_reward_mean": 341.3967856187604, "episode_len_mean": 49.189189189189186, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 1820, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.6283759252345, 341.4219104477484, 366.8755143205058, 348.5129116343419, 113.74387207031259, 344.89606617875376, 314.4874031615192, 330.6637083549022, 363.7176809876382, 342.37873390283454, 326.37256273055385, 348.57811129865576, 370.970837087593, 361.7024841809525, 346.20645214449047, 363.7849955751201, 353.2531579626137, 349.7347077541469, 341.0059146318285, 339.51614862458666, 330.1920078979517, 353.72352588142405, 346.227278649351, 355.4704533777889, 335.6110075577922, 344.8967562647446, 368.3626088877086, 369.04231465036605, 358.13025238700646, 331.7618490723145, 303.46117484308195, 344.461712424714, 351.6855224609378, 349.3041466555237, 358.57540941893217, 342.25313399086644, 360.07036449930183], "episode_lengths": [50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.334319464187796, "mean_inference_ms": 1.244560218704629, "mean_action_processing_ms": 0.2044718200344536, "mean_env_wait_ms": 496.63399825300155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01317423743170661, "StateBufferConnector_ms": 0.005955309481234164, "ViewRequirementAgentConnector_ms": 0.16050016557848132}, "num_episodes": 37, "episode_return_max": 370.970837087593, "episode_return_min": 113.74387207031259, "episode_return_mean": 341.3967856187604}, "episode_reward_max": 370.970837087593, "episode_reward_min": 113.74387207031259, "episode_reward_mean": 341.3967856187604, "episode_len_mean": 49.189189189189186, "episodes_this_iter": 37, "episodes_timesteps_total": 1820, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [360.6283759252345, 341.4219104477484, 366.8755143205058, 348.5129116343419, 113.74387207031259, 344.89606617875376, 314.4874031615192, 330.6637083549022, 363.7176809876382, 342.37873390283454, 326.37256273055385, 348.57811129865576, 370.970837087593, 361.7024841809525, 346.20645214449047, 363.7849955751201, 353.2531579626137, 349.7347077541469, 341.0059146318285, 339.51614862458666, 330.1920078979517, 353.72352588142405, 346.227278649351, 355.4704533777889, 335.6110075577922, 344.8967562647446, 368.3626088877086, 369.04231465036605, 358.13025238700646, 331.7618490723145, 303.46117484308195, 344.461712424714, 351.6855224609378, 349.3041466555237, 358.57540941893217, 342.25313399086644, 360.07036449930183], "episode_lengths": [50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.334319464187796, "mean_inference_ms": 1.244560218704629, "mean_action_processing_ms": 0.2044718200344536, "mean_env_wait_ms": 496.63399825300155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01317423743170661, "StateBufferConnector_ms": 0.005955309481234164, "ViewRequirementAgentConnector_ms": 0.16050016557848132}, "num_episodes": 37, "episode_return_max": 370.970837087593, "episode_return_min": 113.74387207031259, "episode_return_mean": 341.3967856187604, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151056, "num_agent_steps_trained": 151056, "num_env_steps_sampled": 151056, "num_env_steps_trained": 151056, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 10.92822332527823, "num_env_steps_trained_throughput_per_sec": 10.92822332527823, "timesteps_total": 151056, "num_env_steps_sampled_lifetime": 151056, "num_agent_steps_sampled_lifetime": 151056, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 151056, "timers": {"training_iteration_time_ms": 187770.698, "restore_workers_time_ms": 0.019, "training_step_time_ms": 187770.639, "sample_time_ms": 182480.221, "load_time_ms": 0.684, "load_throughput": 3001992.26, "learn_time_ms": 5276.673, "learn_throughput": 388.881, "synch_weights_time_ms": 12.528}, "counters": {"num_env_steps_sampled": 151056, "num_env_steps_trained": 151056, "num_agent_steps_sampled": 151056, "num_agent_steps_trained": 151056}, "done": false, "episodes_total": 3300, "training_iteration": 145, "trial_id": "fe178_00005", "date": "2024-08-15_21-21-15", "timestamp": 1723778475, "time_this_iter_s": 187.77435898780823, "time_total_s": 14466.42160487175, "pid": 25554, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2596169418873165, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.5763345662221224, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 187.77435898780823, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 21.92007434944238, "ram_util_percent": 11.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.82367634177208, "cur_kl_coeff": 0.5858385468027334, "cur_lr": 0.00010000000000000003, "total_loss": 2.238355761692704, "policy_loss": -0.00016171729657799006, "vf_loss": 2.226280416827649, "vf_explained_var": 0.13313865785797438, "kl": 0.020888126599797385, "entropy": -1.6599592340489229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 720.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 153108, "num_env_steps_trained": 153108, "num_agent_steps_sampled": 153108, "num_agent_steps_trained": 153108}, "sampler_results": {"episode_reward_max": 370.970837087593, "episode_reward_min": 113.74387207031259, "episode_reward_mean": 345.1680447181607, "episode_len_mean": 49.620253164556964, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 3920, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.6283759252345, 341.4219104477484, 366.8755143205058, 348.5129116343419, 113.74387207031259, 344.89606617875376, 314.4874031615192, 330.6637083549022, 363.7176809876382, 342.37873390283454, 326.37256273055385, 348.57811129865576, 370.970837087593, 361.7024841809525, 346.20645214449047, 363.7849955751201, 353.2531579626137, 349.7347077541469, 341.0059146318285, 339.51614862458666, 330.1920078979517, 353.72352588142405, 346.227278649351, 355.4704533777889, 335.6110075577922, 344.8967562647446, 368.3626088877086, 369.04231465036605, 358.13025238700646, 331.7618490723145, 303.46117484308195, 344.461712424714, 351.6855224609378, 349.3041466555237, 358.57540941893217, 342.25313399086644, 360.07036449930183, 344.7716997000538, 370.44090645665733, 351.1364529824006, 346.4299117255745, 351.030133133958, 368.1789897569498, 360.54904112860584, 324.7535443646745, 353.5476201151407, 331.8547419825444, 356.65548293622317, 334.25354817329605, 344.44090876788266, 352.7773940319564, 352.84753182341836, 343.0214491238362, 358.78534151225944, 336.4895575758296, 339.37955565902223, 357.36651073432165, 363.49889220003297, 332.9890957351595, 356.09952590500825, 346.91734086380484, 356.39322557630874, 332.1438677498188, 359.8063746970453, 340.97301129687094, 348.1847769938141, 338.1065323977468, 322.06507623080915, 360.2569201767707, 360.8154618988168, 355.94737819547925, 338.5158760331444, 360.48799917705185, 358.40849594465186, 336.7864277197996, 354.3469889319221, 348.7278808593753, 352.418325577132, 333.99466899538993], "episode_lengths": [50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.441315130149709, "mean_inference_ms": 1.2427364498261455, "mean_action_processing_ms": 0.20462316151616777, "mean_env_wait_ms": 490.1354723703632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012368793728985365, "StateBufferConnector_ms": 0.006032895438278778, "ViewRequirementAgentConnector_ms": 0.16387414328659636}, "num_episodes": 42, "episode_return_max": 370.970837087593, "episode_return_min": 113.74387207031259, "episode_return_mean": 345.1680447181607}, "env_runner_results": {"episode_reward_max": 370.970837087593, "episode_reward_min": 113.74387207031259, "episode_reward_mean": 345.1680447181607, "episode_len_mean": 49.620253164556964, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 3920, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.6283759252345, 341.4219104477484, 366.8755143205058, 348.5129116343419, 113.74387207031259, 344.89606617875376, 314.4874031615192, 330.6637083549022, 363.7176809876382, 342.37873390283454, 326.37256273055385, 348.57811129865576, 370.970837087593, 361.7024841809525, 346.20645214449047, 363.7849955751201, 353.2531579626137, 349.7347077541469, 341.0059146318285, 339.51614862458666, 330.1920078979517, 353.72352588142405, 346.227278649351, 355.4704533777889, 335.6110075577922, 344.8967562647446, 368.3626088877086, 369.04231465036605, 358.13025238700646, 331.7618490723145, 303.46117484308195, 344.461712424714, 351.6855224609378, 349.3041466555237, 358.57540941893217, 342.25313399086644, 360.07036449930183, 344.7716997000538, 370.44090645665733, 351.1364529824006, 346.4299117255745, 351.030133133958, 368.1789897569498, 360.54904112860584, 324.7535443646745, 353.5476201151407, 331.8547419825444, 356.65548293622317, 334.25354817329605, 344.44090876788266, 352.7773940319564, 352.84753182341836, 343.0214491238362, 358.78534151225944, 336.4895575758296, 339.37955565902223, 357.36651073432165, 363.49889220003297, 332.9890957351595, 356.09952590500825, 346.91734086380484, 356.39322557630874, 332.1438677498188, 359.8063746970453, 340.97301129687094, 348.1847769938141, 338.1065323977468, 322.06507623080915, 360.2569201767707, 360.8154618988168, 355.94737819547925, 338.5158760331444, 360.48799917705185, 358.40849594465186, 336.7864277197996, 354.3469889319221, 348.7278808593753, 352.418325577132, 333.99466899538993], "episode_lengths": [50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.441315130149709, "mean_inference_ms": 1.2427364498261455, "mean_action_processing_ms": 0.20462316151616777, "mean_env_wait_ms": 490.1354723703632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012368793728985365, "StateBufferConnector_ms": 0.006032895438278778, "ViewRequirementAgentConnector_ms": 0.16387414328659636}, "num_episodes": 42, "episode_return_max": 370.970837087593, "episode_return_min": 113.74387207031259, "episode_return_mean": 345.1680447181607}, "episode_reward_max": 370.970837087593, "episode_reward_min": 113.74387207031259, "episode_reward_mean": 345.1680447181607, "episode_len_mean": 49.620253164556964, "episodes_this_iter": 42, "episodes_timesteps_total": 3920, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [360.6283759252345, 341.4219104477484, 366.8755143205058, 348.5129116343419, 113.74387207031259, 344.89606617875376, 314.4874031615192, 330.6637083549022, 363.7176809876382, 342.37873390283454, 326.37256273055385, 348.57811129865576, 370.970837087593, 361.7024841809525, 346.20645214449047, 363.7849955751201, 353.2531579626137, 349.7347077541469, 341.0059146318285, 339.51614862458666, 330.1920078979517, 353.72352588142405, 346.227278649351, 355.4704533777889, 335.6110075577922, 344.8967562647446, 368.3626088877086, 369.04231465036605, 358.13025238700646, 331.7618490723145, 303.46117484308195, 344.461712424714, 351.6855224609378, 349.3041466555237, 358.57540941893217, 342.25313399086644, 360.07036449930183, 344.7716997000538, 370.44090645665733, 351.1364529824006, 346.4299117255745, 351.030133133958, 368.1789897569498, 360.54904112860584, 324.7535443646745, 353.5476201151407, 331.8547419825444, 356.65548293622317, 334.25354817329605, 344.44090876788266, 352.7773940319564, 352.84753182341836, 343.0214491238362, 358.78534151225944, 336.4895575758296, 339.37955565902223, 357.36651073432165, 363.49889220003297, 332.9890957351595, 356.09952590500825, 346.91734086380484, 356.39322557630874, 332.1438677498188, 359.8063746970453, 340.97301129687094, 348.1847769938141, 338.1065323977468, 322.06507623080915, 360.2569201767707, 360.8154618988168, 355.94737819547925, 338.5158760331444, 360.48799917705185, 358.40849594465186, 336.7864277197996, 354.3469889319221, 348.7278808593753, 352.418325577132, 333.99466899538993], "episode_lengths": [50, 50, 50, 50, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.441315130149709, "mean_inference_ms": 1.2427364498261455, "mean_action_processing_ms": 0.20462316151616777, "mean_env_wait_ms": 490.1354723703632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012368793728985365, "StateBufferConnector_ms": 0.006032895438278778, "ViewRequirementAgentConnector_ms": 0.16387414328659636}, "num_episodes": 42, "episode_return_max": 370.970837087593, "episode_return_min": 113.74387207031259, "episode_return_mean": 345.1680447181607, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153108, "num_agent_steps_trained": 153108, "num_env_steps_sampled": 153108, "num_env_steps_trained": 153108, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 11.569335444207107, "num_env_steps_trained_throughput_per_sec": 11.569335444207107, "timesteps_total": 153108, "num_env_steps_sampled_lifetime": 153108, "num_agent_steps_sampled_lifetime": 153108, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 153108, "timers": {"training_iteration_time_ms": 182568.063, "restore_workers_time_ms": 0.018, "training_step_time_ms": 182568.006, "sample_time_ms": 178655.614, "load_time_ms": 0.598, "load_throughput": 3431019.258, "learn_time_ms": 3898.59, "learn_throughput": 526.344, "synch_weights_time_ms": 12.757}, "counters": {"num_env_steps_sampled": 153108, "num_env_steps_trained": 153108, "num_agent_steps_sampled": 153108, "num_agent_steps_trained": 153108}, "done": false, "episodes_total": 3342, "training_iteration": 146, "trial_id": "fe178_00005", "date": "2024-08-15_21-24-12", "timestamp": 1723778652, "time_this_iter_s": 177.3687653541565, "time_total_s": 14643.790370225906, "pid": 25554, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2596169418873165, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.5763345662221224, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 365.1431243419647, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 22.97272727272727, "ram_util_percent": 11.207114624505925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58.29656166434288, "cur_kl_coeff": 0.8787578202041003, "cur_lr": 0.00010000000000000003, "total_loss": 2.14065204312404, "policy_loss": -0.0008114996637838582, "vf_loss": 2.1262348684171837, "vf_explained_var": 0.14320543296635152, "kl": 0.017329758249495994, "entropy": -1.5179611186186472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1200.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 155160, "num_env_steps_trained": 155160, "num_agent_steps_sampled": 155160, "num_agent_steps_trained": 155160}, "sampler_results": {"episode_reward_max": 370.44090645665733, "episode_reward_min": 281.9804277271551, "episode_reward_mean": 344.9119454757931, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.72352588142405, 346.227278649351, 355.4704533777889, 335.6110075577922, 344.8967562647446, 368.3626088877086, 369.04231465036605, 358.13025238700646, 331.7618490723145, 303.46117484308195, 344.461712424714, 351.6855224609378, 349.3041466555237, 358.57540941893217, 342.25313399086644, 360.07036449930183, 344.7716997000538, 370.44090645665733, 351.1364529824006, 346.4299117255745, 351.030133133958, 368.1789897569498, 360.54904112860584, 324.7535443646745, 353.5476201151407, 331.8547419825444, 356.65548293622317, 334.25354817329605, 344.44090876788266, 352.7773940319564, 352.84753182341836, 343.0214491238362, 358.78534151225944, 336.4895575758296, 339.37955565902223, 357.36651073432165, 363.49889220003297, 332.9890957351595, 356.09952590500825, 346.91734086380484, 356.39322557630874, 332.1438677498188, 359.8063746970453, 340.97301129687094, 348.1847769938141, 338.1065323977468, 322.06507623080915, 360.2569201767707, 360.8154618988168, 355.94737819547925, 338.5158760331444, 360.48799917705185, 358.40849594465186, 336.7864277197996, 354.3469889319221, 348.7278808593753, 352.418325577132, 333.99466899538993, 328.81582500876374, 346.5965902362923, 335.94491563870054, 341.63127224364695, 327.8004970650215, 368.75486735101117, 354.01185013179463, 343.7730683660799, 357.3364703487511, 316.607504999036, 309.3449354993511, 342.0398404978968, 341.74880612011196, 281.9804277271551, 331.442307197373, 331.4530154487001, 357.74428180101467, 344.46302490234416, 339.9796931644981, 361.2260168553896, 327.78068973657724, 347.33091832088945, 350.5248681109963, 324.06013379711834, 318.65036772486997, 334.6653423100894, 364.70608261890396, 342.79977953239575, 360.04444053553476, 346.1236183194027, 348.8903104852122, 356.9027787145168, 327.4673292874269, 347.08861499675936, 341.1502602665687, 359.56365718655496, 336.23424506775746, 311.06700954208435, 339.9149318047625, 341.50746769388377, 334.9490338619435, 357.44548119972364], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.512605017454189, "mean_inference_ms": 1.2381755742655502, "mean_action_processing_ms": 0.2046053761425566, "mean_env_wait_ms": 488.56447894942687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010965585708618164, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.16348719596862793}, "num_episodes": 42, "episode_return_max": 370.44090645665733, "episode_return_min": 281.9804277271551, "episode_return_mean": 344.9119454757931}, "env_runner_results": {"episode_reward_max": 370.44090645665733, "episode_reward_min": 281.9804277271551, "episode_reward_mean": 344.9119454757931, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.72352588142405, 346.227278649351, 355.4704533777889, 335.6110075577922, 344.8967562647446, 368.3626088877086, 369.04231465036605, 358.13025238700646, 331.7618490723145, 303.46117484308195, 344.461712424714, 351.6855224609378, 349.3041466555237, 358.57540941893217, 342.25313399086644, 360.07036449930183, 344.7716997000538, 370.44090645665733, 351.1364529824006, 346.4299117255745, 351.030133133958, 368.1789897569498, 360.54904112860584, 324.7535443646745, 353.5476201151407, 331.8547419825444, 356.65548293622317, 334.25354817329605, 344.44090876788266, 352.7773940319564, 352.84753182341836, 343.0214491238362, 358.78534151225944, 336.4895575758296, 339.37955565902223, 357.36651073432165, 363.49889220003297, 332.9890957351595, 356.09952590500825, 346.91734086380484, 356.39322557630874, 332.1438677498188, 359.8063746970453, 340.97301129687094, 348.1847769938141, 338.1065323977468, 322.06507623080915, 360.2569201767707, 360.8154618988168, 355.94737819547925, 338.5158760331444, 360.48799917705185, 358.40849594465186, 336.7864277197996, 354.3469889319221, 348.7278808593753, 352.418325577132, 333.99466899538993, 328.81582500876374, 346.5965902362923, 335.94491563870054, 341.63127224364695, 327.8004970650215, 368.75486735101117, 354.01185013179463, 343.7730683660799, 357.3364703487511, 316.607504999036, 309.3449354993511, 342.0398404978968, 341.74880612011196, 281.9804277271551, 331.442307197373, 331.4530154487001, 357.74428180101467, 344.46302490234416, 339.9796931644981, 361.2260168553896, 327.78068973657724, 347.33091832088945, 350.5248681109963, 324.06013379711834, 318.65036772486997, 334.6653423100894, 364.70608261890396, 342.79977953239575, 360.04444053553476, 346.1236183194027, 348.8903104852122, 356.9027787145168, 327.4673292874269, 347.08861499675936, 341.1502602665687, 359.56365718655496, 336.23424506775746, 311.06700954208435, 339.9149318047625, 341.50746769388377, 334.9490338619435, 357.44548119972364], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.512605017454189, "mean_inference_ms": 1.2381755742655502, "mean_action_processing_ms": 0.2046053761425566, "mean_env_wait_ms": 488.56447894942687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010965585708618164, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.16348719596862793}, "num_episodes": 42, "episode_return_max": 370.44090645665733, "episode_return_min": 281.9804277271551, "episode_return_mean": 344.9119454757931}, "episode_reward_max": 370.44090645665733, "episode_reward_min": 281.9804277271551, "episode_reward_mean": 344.9119454757931, "episode_len_mean": 50.0, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [353.72352588142405, 346.227278649351, 355.4704533777889, 335.6110075577922, 344.8967562647446, 368.3626088877086, 369.04231465036605, 358.13025238700646, 331.7618490723145, 303.46117484308195, 344.461712424714, 351.6855224609378, 349.3041466555237, 358.57540941893217, 342.25313399086644, 360.07036449930183, 344.7716997000538, 370.44090645665733, 351.1364529824006, 346.4299117255745, 351.030133133958, 368.1789897569498, 360.54904112860584, 324.7535443646745, 353.5476201151407, 331.8547419825444, 356.65548293622317, 334.25354817329605, 344.44090876788266, 352.7773940319564, 352.84753182341836, 343.0214491238362, 358.78534151225944, 336.4895575758296, 339.37955565902223, 357.36651073432165, 363.49889220003297, 332.9890957351595, 356.09952590500825, 346.91734086380484, 356.39322557630874, 332.1438677498188, 359.8063746970453, 340.97301129687094, 348.1847769938141, 338.1065323977468, 322.06507623080915, 360.2569201767707, 360.8154618988168, 355.94737819547925, 338.5158760331444, 360.48799917705185, 358.40849594465186, 336.7864277197996, 354.3469889319221, 348.7278808593753, 352.418325577132, 333.99466899538993, 328.81582500876374, 346.5965902362923, 335.94491563870054, 341.63127224364695, 327.8004970650215, 368.75486735101117, 354.01185013179463, 343.7730683660799, 357.3364703487511, 316.607504999036, 309.3449354993511, 342.0398404978968, 341.74880612011196, 281.9804277271551, 331.442307197373, 331.4530154487001, 357.74428180101467, 344.46302490234416, 339.9796931644981, 361.2260168553896, 327.78068973657724, 347.33091832088945, 350.5248681109963, 324.06013379711834, 318.65036772486997, 334.6653423100894, 364.70608261890396, 342.79977953239575, 360.04444053553476, 346.1236183194027, 348.8903104852122, 356.9027787145168, 327.4673292874269, 347.08861499675936, 341.1502602665687, 359.56365718655496, 336.23424506775746, 311.06700954208435, 339.9149318047625, 341.50746769388377, 334.9490338619435, 357.44548119972364], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.512605017454189, "mean_inference_ms": 1.2381755742655502, "mean_action_processing_ms": 0.2046053761425566, "mean_env_wait_ms": 488.56447894942687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010965585708618164, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.16348719596862793}, "num_episodes": 42, "episode_return_max": 370.44090645665733, "episode_return_min": 281.9804277271551, "episode_return_mean": 344.9119454757931, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155160, "num_agent_steps_trained": 155160, "num_env_steps_sampled": 155160, "num_env_steps_trained": 155160, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 11.05388963324301, "num_env_steps_trained_throughput_per_sec": 11.05388963324301, "timesteps_total": 155160, "num_env_steps_sampled_lifetime": 155160, "num_agent_steps_sampled_lifetime": 155160, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 155160, "timers": {"training_iteration_time_ms": 183590.716, "restore_workers_time_ms": 0.017, "training_step_time_ms": 183590.663, "sample_time_ms": 180172.053, "load_time_ms": 0.559, "load_throughput": 3673372.517, "learn_time_ms": 3401.522, "learn_throughput": 603.259, "synch_weights_time_ms": 16.127}, "counters": {"num_env_steps_sampled": 155160, "num_env_steps_trained": 155160, "num_agent_steps_sampled": 155160, "num_agent_steps_trained": 155160}, "done": false, "episodes_total": 3384, "training_iteration": 147, "trial_id": "fe178_00005", "date": "2024-08-15_21-27-18", "timestamp": 1723778838, "time_this_iter_s": 185.6396403312683, "time_total_s": 14829.430010557175, "pid": 25554, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2596169418873165, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.5763345662221224, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 550.782764673233, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.037358490566035, "ram_util_percent": 11.145283018867923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.29379082818826, "cur_kl_coeff": 0.8787578202041003, "cur_lr": 0.00010000000000000003, "total_loss": 2.1469266809212666, "policy_loss": -0.010409276850987225, "vf_loss": 2.147172102704644, "vf_explained_var": 0.14568918384611607, "kl": 0.011566150636161046, "entropy": -1.668722387899955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1680.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 157212, "num_env_steps_trained": 157212, "num_agent_steps_sampled": 157212, "num_agent_steps_trained": 157212}, "sampler_results": {"episode_reward_max": 368.75486735101117, "episode_reward_min": 281.9804277271551, "episode_reward_mean": 345.509600658479, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 41, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [332.1438677498188, 359.8063746970453, 340.97301129687094, 348.1847769938141, 338.1065323977468, 322.06507623080915, 360.2569201767707, 360.8154618988168, 355.94737819547925, 338.5158760331444, 360.48799917705185, 358.40849594465186, 336.7864277197996, 354.3469889319221, 348.7278808593753, 352.418325577132, 333.99466899538993, 328.81582500876374, 346.5965902362923, 335.94491563870054, 341.63127224364695, 327.8004970650215, 368.75486735101117, 354.01185013179463, 343.7730683660799, 357.3364703487511, 316.607504999036, 309.3449354993511, 342.0398404978968, 341.74880612011196, 281.9804277271551, 331.442307197373, 331.4530154487001, 357.74428180101467, 344.46302490234416, 339.9796931644981, 361.2260168553896, 327.78068973657724, 347.33091832088945, 350.5248681109963, 324.06013379711834, 318.65036772486997, 334.6653423100894, 364.70608261890396, 342.79977953239575, 360.04444053553476, 346.1236183194027, 348.8903104852122, 356.9027787145168, 327.4673292874269, 347.08861499675936, 341.1502602665687, 359.56365718655496, 336.23424506775746, 311.06700954208435, 339.9149318047625, 341.50746769388377, 334.9490338619435, 357.44548119972364, 336.2764688377101, 343.7115129306393, 349.3987300826171, 338.95042043012097, 334.374583713252, 367.32110545797326, 354.5901564360993, 346.7244773347178, 363.50168858374275, 363.1253955996249, 357.5851883795033, 347.5042413907362, 362.55205832932546, 348.1555288584613, 352.83696391668684, 362.0639022943636, 338.2779325265618, 350.06322075497326, 340.3692927091899, 366.822621681769, 353.5553464700246, 363.14955275848115, 345.1448866269947, 360.5930282895648, 359.0923286265025, 342.1955942764116, 355.93474523985356, 337.8831526287805, 337.95705775618984, 338.08031191846385, 363.90719322659953, 360.89495849609375, 339.58862276715973, 335.7315177377592, 337.0173342484024, 317.8501608851484, 351.22524414062536, 358.83579547467593, 364.76807618306077, 362.81775261474877, 356.9832806417427], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.587090881319348, "mean_inference_ms": 1.2362017914820336, "mean_action_processing_ms": 0.20484683031526493, "mean_env_wait_ms": 489.03967059186624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009911060333251953, "StateBufferConnector_ms": 0.005979776382446289, "ViewRequirementAgentConnector_ms": 0.16262269020080566}, "num_episodes": 41, "episode_return_max": 368.75486735101117, "episode_return_min": 281.9804277271551, "episode_return_mean": 345.509600658479}, "env_runner_results": {"episode_reward_max": 368.75486735101117, "episode_reward_min": 281.9804277271551, "episode_reward_mean": 345.509600658479, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 41, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [332.1438677498188, 359.8063746970453, 340.97301129687094, 348.1847769938141, 338.1065323977468, 322.06507623080915, 360.2569201767707, 360.8154618988168, 355.94737819547925, 338.5158760331444, 360.48799917705185, 358.40849594465186, 336.7864277197996, 354.3469889319221, 348.7278808593753, 352.418325577132, 333.99466899538993, 328.81582500876374, 346.5965902362923, 335.94491563870054, 341.63127224364695, 327.8004970650215, 368.75486735101117, 354.01185013179463, 343.7730683660799, 357.3364703487511, 316.607504999036, 309.3449354993511, 342.0398404978968, 341.74880612011196, 281.9804277271551, 331.442307197373, 331.4530154487001, 357.74428180101467, 344.46302490234416, 339.9796931644981, 361.2260168553896, 327.78068973657724, 347.33091832088945, 350.5248681109963, 324.06013379711834, 318.65036772486997, 334.6653423100894, 364.70608261890396, 342.79977953239575, 360.04444053553476, 346.1236183194027, 348.8903104852122, 356.9027787145168, 327.4673292874269, 347.08861499675936, 341.1502602665687, 359.56365718655496, 336.23424506775746, 311.06700954208435, 339.9149318047625, 341.50746769388377, 334.9490338619435, 357.44548119972364, 336.2764688377101, 343.7115129306393, 349.3987300826171, 338.95042043012097, 334.374583713252, 367.32110545797326, 354.5901564360993, 346.7244773347178, 363.50168858374275, 363.1253955996249, 357.5851883795033, 347.5042413907362, 362.55205832932546, 348.1555288584613, 352.83696391668684, 362.0639022943636, 338.2779325265618, 350.06322075497326, 340.3692927091899, 366.822621681769, 353.5553464700246, 363.14955275848115, 345.1448866269947, 360.5930282895648, 359.0923286265025, 342.1955942764116, 355.93474523985356, 337.8831526287805, 337.95705775618984, 338.08031191846385, 363.90719322659953, 360.89495849609375, 339.58862276715973, 335.7315177377592, 337.0173342484024, 317.8501608851484, 351.22524414062536, 358.83579547467593, 364.76807618306077, 362.81775261474877, 356.9832806417427], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.587090881319348, "mean_inference_ms": 1.2362017914820336, "mean_action_processing_ms": 0.20484683031526493, "mean_env_wait_ms": 489.03967059186624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009911060333251953, "StateBufferConnector_ms": 0.005979776382446289, "ViewRequirementAgentConnector_ms": 0.16262269020080566}, "num_episodes": 41, "episode_return_max": 368.75486735101117, "episode_return_min": 281.9804277271551, "episode_return_mean": 345.509600658479}, "episode_reward_max": 368.75486735101117, "episode_reward_min": 281.9804277271551, "episode_reward_mean": 345.509600658479, "episode_len_mean": 50.0, "episodes_this_iter": 41, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [332.1438677498188, 359.8063746970453, 340.97301129687094, 348.1847769938141, 338.1065323977468, 322.06507623080915, 360.2569201767707, 360.8154618988168, 355.94737819547925, 338.5158760331444, 360.48799917705185, 358.40849594465186, 336.7864277197996, 354.3469889319221, 348.7278808593753, 352.418325577132, 333.99466899538993, 328.81582500876374, 346.5965902362923, 335.94491563870054, 341.63127224364695, 327.8004970650215, 368.75486735101117, 354.01185013179463, 343.7730683660799, 357.3364703487511, 316.607504999036, 309.3449354993511, 342.0398404978968, 341.74880612011196, 281.9804277271551, 331.442307197373, 331.4530154487001, 357.74428180101467, 344.46302490234416, 339.9796931644981, 361.2260168553896, 327.78068973657724, 347.33091832088945, 350.5248681109963, 324.06013379711834, 318.65036772486997, 334.6653423100894, 364.70608261890396, 342.79977953239575, 360.04444053553476, 346.1236183194027, 348.8903104852122, 356.9027787145168, 327.4673292874269, 347.08861499675936, 341.1502602665687, 359.56365718655496, 336.23424506775746, 311.06700954208435, 339.9149318047625, 341.50746769388377, 334.9490338619435, 357.44548119972364, 336.2764688377101, 343.7115129306393, 349.3987300826171, 338.95042043012097, 334.374583713252, 367.32110545797326, 354.5901564360993, 346.7244773347178, 363.50168858374275, 363.1253955996249, 357.5851883795033, 347.5042413907362, 362.55205832932546, 348.1555288584613, 352.83696391668684, 362.0639022943636, 338.2779325265618, 350.06322075497326, 340.3692927091899, 366.822621681769, 353.5553464700246, 363.14955275848115, 345.1448866269947, 360.5930282895648, 359.0923286265025, 342.1955942764116, 355.93474523985356, 337.8831526287805, 337.95705775618984, 338.08031191846385, 363.90719322659953, 360.89495849609375, 339.58862276715973, 335.7315177377592, 337.0173342484024, 317.8501608851484, 351.22524414062536, 358.83579547467593, 364.76807618306077, 362.81775261474877, 356.9832806417427], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.587090881319348, "mean_inference_ms": 1.2362017914820336, "mean_action_processing_ms": 0.20484683031526493, "mean_env_wait_ms": 489.03967059186624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009911060333251953, "StateBufferConnector_ms": 0.005979776382446289, "ViewRequirementAgentConnector_ms": 0.16262269020080566}, "num_episodes": 41, "episode_return_max": 368.75486735101117, "episode_return_min": 281.9804277271551, "episode_return_mean": 345.509600658479, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157212, "num_agent_steps_trained": 157212, "num_env_steps_sampled": 157212, "num_env_steps_trained": 157212, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 11.127546188251852, "num_env_steps_trained_throughput_per_sec": 11.127546188251852, "timesteps_total": 157212, "num_env_steps_sampled_lifetime": 157212, "num_agent_steps_sampled_lifetime": 157212, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 157212, "timers": {"training_iteration_time_ms": 183794.849, "restore_workers_time_ms": 0.017, "training_step_time_ms": 183794.794, "sample_time_ms": 180554.357, "load_time_ms": 0.571, "load_throughput": 3593991.777, "learn_time_ms": 3223.978, "learn_throughput": 636.481, "synch_weights_time_ms": 15.491}, "counters": {"num_env_steps_sampled": 157212, "num_env_steps_trained": 157212, "num_agent_steps_sampled": 157212, "num_agent_steps_trained": 157212}, "done": false, "episodes_total": 3425, "training_iteration": 148, "trial_id": "fe178_00005", "date": "2024-08-15_21-30-22", "timestamp": 1723779022, "time_this_iter_s": 184.41125106811523, "time_total_s": 15013.84126162529, "pid": 25554, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2596169418873165, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.5763345662221224, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 735.1940157413483, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 22.53764258555133, "ram_util_percent": 11.23460076045627}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.45913162926833, "cur_kl_coeff": 0.8787578202041003, "cur_lr": 0.00010000000000000003, "total_loss": 2.080860544585933, "policy_loss": -0.002567825044388883, "vf_loss": 2.082966871249179, "vf_explained_var": 0.13717509793738525, "kl": 0.0005251878412923966, "entropy": -1.5680796225865683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2160.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 159264, "num_env_steps_trained": 159264, "num_agent_steps_sampled": 159264, "num_agent_steps_trained": 159264}, "sampler_results": {"episode_reward_max": 372.54106790526265, "episode_reward_min": 256.2331825408092, "episode_reward_mean": 348.12090484966234, "episode_len_mean": 49.96, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 4996, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.6653423100894, 364.70608261890396, 342.79977953239575, 360.04444053553476, 346.1236183194027, 348.8903104852122, 356.9027787145168, 327.4673292874269, 347.08861499675936, 341.1502602665687, 359.56365718655496, 336.23424506775746, 311.06700954208435, 339.9149318047625, 341.50746769388377, 334.9490338619435, 357.44548119972364, 336.2764688377101, 343.7115129306393, 349.3987300826171, 338.95042043012097, 334.374583713252, 367.32110545797326, 354.5901564360993, 346.7244773347178, 363.50168858374275, 363.1253955996249, 357.5851883795033, 347.5042413907362, 362.55205832932546, 348.1555288584613, 352.83696391668684, 362.0639022943636, 338.2779325265618, 350.06322075497326, 340.3692927091899, 366.822621681769, 353.5553464700246, 363.14955275848115, 345.1448866269947, 360.5930282895648, 359.0923286265025, 342.1955942764116, 355.93474523985356, 337.8831526287805, 337.95705775618984, 338.08031191846385, 363.90719322659953, 360.89495849609375, 339.58862276715973, 335.7315177377592, 337.0173342484024, 317.8501608851484, 351.22524414062536, 358.83579547467593, 364.76807618306077, 362.81775261474877, 356.9832806417427, 366.55542393951873, 366.19694561452656, 342.2349051728064, 348.47988634308155, 343.51457142587685, 364.02909293642756, 282.62821723745583, 358.3361921090724, 256.2331825408092, 359.75380086186834, 329.77027698675147, 372.54106790526265, 353.0495764581009, 294.63323395070194, 354.14386567467466, 341.1117304378516, 351.9009594373729, 352.5457863767027, 359.4628688875699, 354.74944954513455, 332.1047170228353, 349.8632261860828, 360.93711425819026, 354.3999562549911, 366.4038518477806, 355.69115983731587, 366.65873094105984, 353.03115642815567, 355.4353853846599, 354.8102768158087, 352.3322035553669, 320.67670579628884, 365.85384800070136, 347.442273669847, 361.720778626442, 350.4850814191503, 346.1214214980118, 363.93881758024077, 360.12215418813935, 341.8031134415809, 342.5641222133873, 339.8915414797585], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 49, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.612918868857532, "mean_inference_ms": 1.2347017630929833, "mean_action_processing_ms": 0.20489604509767795, "mean_env_wait_ms": 493.9832621406115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009725809097290039, "StateBufferConnector_ms": 0.005966663360595703, "ViewRequirementAgentConnector_ms": 0.16182827949523926}, "num_episodes": 42, "episode_return_max": 372.54106790526265, "episode_return_min": 256.2331825408092, "episode_return_mean": 348.12090484966234}, "env_runner_results": {"episode_reward_max": 372.54106790526265, "episode_reward_min": 256.2331825408092, "episode_reward_mean": 348.12090484966234, "episode_len_mean": 49.96, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 4996, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.6653423100894, 364.70608261890396, 342.79977953239575, 360.04444053553476, 346.1236183194027, 348.8903104852122, 356.9027787145168, 327.4673292874269, 347.08861499675936, 341.1502602665687, 359.56365718655496, 336.23424506775746, 311.06700954208435, 339.9149318047625, 341.50746769388377, 334.9490338619435, 357.44548119972364, 336.2764688377101, 343.7115129306393, 349.3987300826171, 338.95042043012097, 334.374583713252, 367.32110545797326, 354.5901564360993, 346.7244773347178, 363.50168858374275, 363.1253955996249, 357.5851883795033, 347.5042413907362, 362.55205832932546, 348.1555288584613, 352.83696391668684, 362.0639022943636, 338.2779325265618, 350.06322075497326, 340.3692927091899, 366.822621681769, 353.5553464700246, 363.14955275848115, 345.1448866269947, 360.5930282895648, 359.0923286265025, 342.1955942764116, 355.93474523985356, 337.8831526287805, 337.95705775618984, 338.08031191846385, 363.90719322659953, 360.89495849609375, 339.58862276715973, 335.7315177377592, 337.0173342484024, 317.8501608851484, 351.22524414062536, 358.83579547467593, 364.76807618306077, 362.81775261474877, 356.9832806417427, 366.55542393951873, 366.19694561452656, 342.2349051728064, 348.47988634308155, 343.51457142587685, 364.02909293642756, 282.62821723745583, 358.3361921090724, 256.2331825408092, 359.75380086186834, 329.77027698675147, 372.54106790526265, 353.0495764581009, 294.63323395070194, 354.14386567467466, 341.1117304378516, 351.9009594373729, 352.5457863767027, 359.4628688875699, 354.74944954513455, 332.1047170228353, 349.8632261860828, 360.93711425819026, 354.3999562549911, 366.4038518477806, 355.69115983731587, 366.65873094105984, 353.03115642815567, 355.4353853846599, 354.8102768158087, 352.3322035553669, 320.67670579628884, 365.85384800070136, 347.442273669847, 361.720778626442, 350.4850814191503, 346.1214214980118, 363.93881758024077, 360.12215418813935, 341.8031134415809, 342.5641222133873, 339.8915414797585], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 49, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.612918868857532, "mean_inference_ms": 1.2347017630929833, "mean_action_processing_ms": 0.20489604509767795, "mean_env_wait_ms": 493.9832621406115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009725809097290039, "StateBufferConnector_ms": 0.005966663360595703, "ViewRequirementAgentConnector_ms": 0.16182827949523926}, "num_episodes": 42, "episode_return_max": 372.54106790526265, "episode_return_min": 256.2331825408092, "episode_return_mean": 348.12090484966234}, "episode_reward_max": 372.54106790526265, "episode_reward_min": 256.2331825408092, "episode_reward_mean": 348.12090484966234, "episode_len_mean": 49.96, "episodes_this_iter": 42, "episodes_timesteps_total": 4996, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.6653423100894, 364.70608261890396, 342.79977953239575, 360.04444053553476, 346.1236183194027, 348.8903104852122, 356.9027787145168, 327.4673292874269, 347.08861499675936, 341.1502602665687, 359.56365718655496, 336.23424506775746, 311.06700954208435, 339.9149318047625, 341.50746769388377, 334.9490338619435, 357.44548119972364, 336.2764688377101, 343.7115129306393, 349.3987300826171, 338.95042043012097, 334.374583713252, 367.32110545797326, 354.5901564360993, 346.7244773347178, 363.50168858374275, 363.1253955996249, 357.5851883795033, 347.5042413907362, 362.55205832932546, 348.1555288584613, 352.83696391668684, 362.0639022943636, 338.2779325265618, 350.06322075497326, 340.3692927091899, 366.822621681769, 353.5553464700246, 363.14955275848115, 345.1448866269947, 360.5930282895648, 359.0923286265025, 342.1955942764116, 355.93474523985356, 337.8831526287805, 337.95705775618984, 338.08031191846385, 363.90719322659953, 360.89495849609375, 339.58862276715973, 335.7315177377592, 337.0173342484024, 317.8501608851484, 351.22524414062536, 358.83579547467593, 364.76807618306077, 362.81775261474877, 356.9832806417427, 366.55542393951873, 366.19694561452656, 342.2349051728064, 348.47988634308155, 343.51457142587685, 364.02909293642756, 282.62821723745583, 358.3361921090724, 256.2331825408092, 359.75380086186834, 329.77027698675147, 372.54106790526265, 353.0495764581009, 294.63323395070194, 354.14386567467466, 341.1117304378516, 351.9009594373729, 352.5457863767027, 359.4628688875699, 354.74944954513455, 332.1047170228353, 349.8632261860828, 360.93711425819026, 354.3999562549911, 366.4038518477806, 355.69115983731587, 366.65873094105984, 353.03115642815567, 355.4353853846599, 354.8102768158087, 352.3322035553669, 320.67670579628884, 365.85384800070136, 347.442273669847, 361.720778626442, 350.4850814191503, 346.1214214980118, 363.93881758024077, 360.12215418813935, 341.8031134415809, 342.5641222133873, 339.8915414797585], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 49, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.612918868857532, "mean_inference_ms": 1.2347017630929833, "mean_action_processing_ms": 0.20489604509767795, "mean_env_wait_ms": 493.9832621406115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009725809097290039, "StateBufferConnector_ms": 0.005966663360595703, "ViewRequirementAgentConnector_ms": 0.16182827949523926}, "num_episodes": 42, "episode_return_max": 372.54106790526265, "episode_return_min": 256.2331825408092, "episode_return_mean": 348.12090484966234, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159264, "num_agent_steps_trained": 159264, "num_env_steps_sampled": 159264, "num_env_steps_trained": 159264, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 10.173795088137432, "num_env_steps_trained_throughput_per_sec": 10.173795088137432, "timesteps_total": 159264, "num_env_steps_sampled_lifetime": 159264, "num_agent_steps_sampled_lifetime": 159264, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 159264, "timers": {"training_iteration_time_ms": 187374.812, "restore_workers_time_ms": 0.02, "training_step_time_ms": 187374.753, "sample_time_ms": 184247.489, "load_time_ms": 0.578, "load_throughput": 3551209.691, "learn_time_ms": 3111.244, "learn_throughput": 659.543, "synch_weights_time_ms": 15.042}, "counters": {"num_env_steps_sampled": 159264, "num_env_steps_trained": 159264, "num_agent_steps_sampled": 159264, "num_agent_steps_trained": 159264}, "done": false, "episodes_total": 3467, "training_iteration": 149, "trial_id": "fe178_00005", "date": "2024-08-15_21-33-44", "timestamp": 1723779224, "time_this_iter_s": 201.69848251342773, "time_total_s": 15215.539744138718, "pid": 25554, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2596169418873165, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.5763345662221224, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 936.892498254776, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.76388888888889, "ram_util_percent": 11.427430555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.39716919263204, "cur_kl_coeff": 0.43937891010205016, "cur_lr": 0.00010000000000000003, "total_loss": 2.047769168888529, "policy_loss": 0.003078526062502836, "vf_loss": 2.034458519332111, "vf_explained_var": 0.14636528889338177, "kl": 0.02328767424066212, "entropy": -1.6279303101201852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2640.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 161316, "num_env_steps_trained": 161316, "num_agent_steps_sampled": 161316, "num_agent_steps_trained": 161316}, "sampler_results": {"episode_reward_max": 372.54106790526265, "episode_reward_min": 256.2331825408092, "episode_reward_mean": 349.39358189728546, "episode_len_mean": 49.96, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 4996, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [342.1955942764116, 355.93474523985356, 337.8831526287805, 337.95705775618984, 338.08031191846385, 363.90719322659953, 360.89495849609375, 339.58862276715973, 335.7315177377592, 337.0173342484024, 317.8501608851484, 351.22524414062536, 358.83579547467593, 364.76807618306077, 362.81775261474877, 356.9832806417427, 366.55542393951873, 366.19694561452656, 342.2349051728064, 348.47988634308155, 343.51457142587685, 364.02909293642756, 282.62821723745583, 358.3361921090724, 256.2331825408092, 359.75380086186834, 329.77027698675147, 372.54106790526265, 353.0495764581009, 294.63323395070194, 354.14386567467466, 341.1117304378516, 351.9009594373729, 352.5457863767027, 359.4628688875699, 354.74944954513455, 332.1047170228353, 349.8632261860828, 360.93711425819026, 354.3999562549911, 366.4038518477806, 355.69115983731587, 366.65873094105984, 353.03115642815567, 355.4353853846599, 354.8102768158087, 352.3322035553669, 320.67670579628884, 365.85384800070136, 347.442273669847, 361.720778626442, 350.4850814191503, 346.1214214980118, 363.93881758024077, 360.12215418813935, 341.8031134415809, 342.5641222133873, 339.8915414797585, 347.0852949573314, 346.9282179367713, 367.5611450195313, 346.2520784022914, 358.748387030717, 320.15556767273364, 349.85812762001706, 303.04571101726003, 353.69516346793034, 366.22522545107114, 357.36218672958876, 358.58970039766547, 357.9671429252347, 353.18352032383837, 339.138389350641, 352.5418263165391, 356.7148188088734, 350.948143420026, 352.59382317493464, 364.4415150549718, 366.4782273689294, 343.59373198810835, 353.8379048990655, 343.6628669495443, 342.82694787706504, 361.2534234918273, 355.08332652757775, 353.9538759525765, 348.045445521013, 357.77149658203143, 362.34693874894754, 372.4363472777058, 369.99663073422715, 354.986106545212, 330.83626073710025, 352.79026747861525, 347.50184744003775, 359.2978532981965, 355.2622926849907, 334.68681166873455, 351.68275272458527, 362.1613796314215], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 49, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.632664854980303, "mean_inference_ms": 1.2342739920585402, "mean_action_processing_ms": 0.204935604547774, "mean_env_wait_ms": 496.96758448558785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010089397430419922, "StateBufferConnector_ms": 0.006022930145263672, "ViewRequirementAgentConnector_ms": 0.16337180137634277}, "num_episodes": 42, "episode_return_max": 372.54106790526265, "episode_return_min": 256.2331825408092, "episode_return_mean": 349.39358189728546}, "env_runner_results": {"episode_reward_max": 372.54106790526265, "episode_reward_min": 256.2331825408092, "episode_reward_mean": 349.39358189728546, "episode_len_mean": 49.96, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 4996, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [342.1955942764116, 355.93474523985356, 337.8831526287805, 337.95705775618984, 338.08031191846385, 363.90719322659953, 360.89495849609375, 339.58862276715973, 335.7315177377592, 337.0173342484024, 317.8501608851484, 351.22524414062536, 358.83579547467593, 364.76807618306077, 362.81775261474877, 356.9832806417427, 366.55542393951873, 366.19694561452656, 342.2349051728064, 348.47988634308155, 343.51457142587685, 364.02909293642756, 282.62821723745583, 358.3361921090724, 256.2331825408092, 359.75380086186834, 329.77027698675147, 372.54106790526265, 353.0495764581009, 294.63323395070194, 354.14386567467466, 341.1117304378516, 351.9009594373729, 352.5457863767027, 359.4628688875699, 354.74944954513455, 332.1047170228353, 349.8632261860828, 360.93711425819026, 354.3999562549911, 366.4038518477806, 355.69115983731587, 366.65873094105984, 353.03115642815567, 355.4353853846599, 354.8102768158087, 352.3322035553669, 320.67670579628884, 365.85384800070136, 347.442273669847, 361.720778626442, 350.4850814191503, 346.1214214980118, 363.93881758024077, 360.12215418813935, 341.8031134415809, 342.5641222133873, 339.8915414797585, 347.0852949573314, 346.9282179367713, 367.5611450195313, 346.2520784022914, 358.748387030717, 320.15556767273364, 349.85812762001706, 303.04571101726003, 353.69516346793034, 366.22522545107114, 357.36218672958876, 358.58970039766547, 357.9671429252347, 353.18352032383837, 339.138389350641, 352.5418263165391, 356.7148188088734, 350.948143420026, 352.59382317493464, 364.4415150549718, 366.4782273689294, 343.59373198810835, 353.8379048990655, 343.6628669495443, 342.82694787706504, 361.2534234918273, 355.08332652757775, 353.9538759525765, 348.045445521013, 357.77149658203143, 362.34693874894754, 372.4363472777058, 369.99663073422715, 354.986106545212, 330.83626073710025, 352.79026747861525, 347.50184744003775, 359.2978532981965, 355.2622926849907, 334.68681166873455, 351.68275272458527, 362.1613796314215], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 49, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.632664854980303, "mean_inference_ms": 1.2342739920585402, "mean_action_processing_ms": 0.204935604547774, "mean_env_wait_ms": 496.96758448558785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010089397430419922, "StateBufferConnector_ms": 0.006022930145263672, "ViewRequirementAgentConnector_ms": 0.16337180137634277}, "num_episodes": 42, "episode_return_max": 372.54106790526265, "episode_return_min": 256.2331825408092, "episode_return_mean": 349.39358189728546}, "episode_reward_max": 372.54106790526265, "episode_reward_min": 256.2331825408092, "episode_reward_mean": 349.39358189728546, "episode_len_mean": 49.96, "episodes_this_iter": 42, "episodes_timesteps_total": 4996, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [342.1955942764116, 355.93474523985356, 337.8831526287805, 337.95705775618984, 338.08031191846385, 363.90719322659953, 360.89495849609375, 339.58862276715973, 335.7315177377592, 337.0173342484024, 317.8501608851484, 351.22524414062536, 358.83579547467593, 364.76807618306077, 362.81775261474877, 356.9832806417427, 366.55542393951873, 366.19694561452656, 342.2349051728064, 348.47988634308155, 343.51457142587685, 364.02909293642756, 282.62821723745583, 358.3361921090724, 256.2331825408092, 359.75380086186834, 329.77027698675147, 372.54106790526265, 353.0495764581009, 294.63323395070194, 354.14386567467466, 341.1117304378516, 351.9009594373729, 352.5457863767027, 359.4628688875699, 354.74944954513455, 332.1047170228353, 349.8632261860828, 360.93711425819026, 354.3999562549911, 366.4038518477806, 355.69115983731587, 366.65873094105984, 353.03115642815567, 355.4353853846599, 354.8102768158087, 352.3322035553669, 320.67670579628884, 365.85384800070136, 347.442273669847, 361.720778626442, 350.4850814191503, 346.1214214980118, 363.93881758024077, 360.12215418813935, 341.8031134415809, 342.5641222133873, 339.8915414797585, 347.0852949573314, 346.9282179367713, 367.5611450195313, 346.2520784022914, 358.748387030717, 320.15556767273364, 349.85812762001706, 303.04571101726003, 353.69516346793034, 366.22522545107114, 357.36218672958876, 358.58970039766547, 357.9671429252347, 353.18352032383837, 339.138389350641, 352.5418263165391, 356.7148188088734, 350.948143420026, 352.59382317493464, 364.4415150549718, 366.4782273689294, 343.59373198810835, 353.8379048990655, 343.6628669495443, 342.82694787706504, 361.2534234918273, 355.08332652757775, 353.9538759525765, 348.045445521013, 357.77149658203143, 362.34693874894754, 372.4363472777058, 369.99663073422715, 354.986106545212, 330.83626073710025, 352.79026747861525, 347.50184744003775, 359.2978532981965, 355.2622926849907, 334.68681166873455, 351.68275272458527, 362.1613796314215], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 49, 50, 47, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.632664854980303, "mean_inference_ms": 1.2342739920585402, "mean_action_processing_ms": 0.204935604547774, "mean_env_wait_ms": 496.96758448558785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010089397430419922, "StateBufferConnector_ms": 0.006022930145263672, "ViewRequirementAgentConnector_ms": 0.16337180137634277}, "num_episodes": 42, "episode_return_max": 372.54106790526265, "episode_return_min": 256.2331825408092, "episode_return_mean": 349.39358189728546, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161316, "num_agent_steps_trained": 161316, "num_env_steps_sampled": 161316, "num_env_steps_trained": 161316, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 11.037398443396937, "num_env_steps_trained_throughput_per_sec": 11.037398443396937, "timesteps_total": 161316, "num_env_steps_sampled_lifetime": 161316, "num_agent_steps_sampled_lifetime": 161316, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 161316, "timers": {"training_iteration_time_ms": 187131.241, "restore_workers_time_ms": 0.02, "training_step_time_ms": 187131.184, "sample_time_ms": 184105.116, "load_time_ms": 0.581, "load_throughput": 3534341.992, "learn_time_ms": 3010.408, "learn_throughput": 681.635, "synch_weights_time_ms": 14.688}, "counters": {"num_env_steps_sampled": 161316, "num_env_steps_trained": 161316, "num_agent_steps_sampled": 161316, "num_agent_steps_trained": 161316}, "done": false, "episodes_total": 3509, "training_iteration": 150, "trial_id": "fe178_00005", "date": "2024-08-15_21-36-50", "timestamp": 1723779410, "time_this_iter_s": 185.91717314720154, "time_total_s": 15401.45691728592, "pid": 25554, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2596169418873165, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.5763345662221224, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1122.8096714019775, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.427924528301887, "ram_util_percent": 11.147169811320753}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.95515235563119, "cur_kl_coeff": 0.6590683651530751, "cur_lr": 0.00010000000000000003, "total_loss": 1.9075819015192488, "policy_loss": 0.001478843482133622, "vf_loss": 1.8911633438430726, "vf_explained_var": 0.19990836245318253, "kl": 0.022667927972483678, "entropy": -1.7507952195902665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3120.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 163368, "num_env_steps_trained": 163368, "num_agent_steps_sampled": 163368, "num_agent_steps_trained": 163368}, "sampler_results": {"episode_reward_max": 374.95443167521216, "episode_reward_min": 303.04571101726003, "episode_reward_mean": 351.5258215728994, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.8632261860828, 360.93711425819026, 354.3999562549911, 366.4038518477806, 355.69115983731587, 366.65873094105984, 353.03115642815567, 355.4353853846599, 354.8102768158087, 352.3322035553669, 320.67670579628884, 365.85384800070136, 347.442273669847, 361.720778626442, 350.4850814191503, 346.1214214980118, 363.93881758024077, 360.12215418813935, 341.8031134415809, 342.5641222133873, 339.8915414797585, 347.0852949573314, 346.9282179367713, 367.5611450195313, 346.2520784022914, 358.748387030717, 320.15556767273364, 349.85812762001706, 303.04571101726003, 353.69516346793034, 366.22522545107114, 357.36218672958876, 358.58970039766547, 357.9671429252347, 353.18352032383837, 339.138389350641, 352.5418263165391, 356.7148188088734, 350.948143420026, 352.59382317493464, 364.4415150549718, 366.4782273689294, 343.59373198810835, 353.8379048990655, 343.6628669495443, 342.82694787706504, 361.2534234918273, 355.08332652757775, 353.9538759525765, 348.045445521013, 357.77149658203143, 362.34693874894754, 372.4363472777058, 369.99663073422715, 354.986106545212, 330.83626073710025, 352.79026747861525, 347.50184744003775, 359.2978532981965, 355.2622926849907, 334.68681166873455, 351.68275272458527, 362.1613796314215, 347.7935302085639, 340.10575513117635, 360.19854395473806, 333.8099527688837, 374.95443167521216, 326.70740785177753, 353.5345014010372, 367.2354032794621, 354.22487344937434, 359.5840059294938, 356.4485425697046, 345.8118037265945, 308.1003857133775, 316.798828965723, 361.4133071616361, 369.46959836820986, 354.5575732002679, 365.4061081905301, 363.64558488634276, 360.8487067475689, 362.17902099107977, 348.4311698458, 331.65563629102854, 350.59094044349996, 354.96961187159667, 330.6796468554889, 335.59387544059535, 339.5297209489006, 350.4866529940661, 357.23228759636896, 358.32133496397535, 354.63977812234396, 364.6226932671776, 331.8646068419288, 361.96545509928785, 356.9014721598607, 348.5577677488389], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.620551463143536, "mean_inference_ms": 1.2330742898964668, "mean_action_processing_ms": 0.20488800971450374, "mean_env_wait_ms": 496.8718741704449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010080337524414062, "StateBufferConnector_ms": 0.005985736846923828, "ViewRequirementAgentConnector_ms": 0.1647942066192627}, "num_episodes": 37, "episode_return_max": 374.95443167521216, "episode_return_min": 303.04571101726003, "episode_return_mean": 351.5258215728994}, "env_runner_results": {"episode_reward_max": 374.95443167521216, "episode_reward_min": 303.04571101726003, "episode_reward_mean": 351.5258215728994, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.8632261860828, 360.93711425819026, 354.3999562549911, 366.4038518477806, 355.69115983731587, 366.65873094105984, 353.03115642815567, 355.4353853846599, 354.8102768158087, 352.3322035553669, 320.67670579628884, 365.85384800070136, 347.442273669847, 361.720778626442, 350.4850814191503, 346.1214214980118, 363.93881758024077, 360.12215418813935, 341.8031134415809, 342.5641222133873, 339.8915414797585, 347.0852949573314, 346.9282179367713, 367.5611450195313, 346.2520784022914, 358.748387030717, 320.15556767273364, 349.85812762001706, 303.04571101726003, 353.69516346793034, 366.22522545107114, 357.36218672958876, 358.58970039766547, 357.9671429252347, 353.18352032383837, 339.138389350641, 352.5418263165391, 356.7148188088734, 350.948143420026, 352.59382317493464, 364.4415150549718, 366.4782273689294, 343.59373198810835, 353.8379048990655, 343.6628669495443, 342.82694787706504, 361.2534234918273, 355.08332652757775, 353.9538759525765, 348.045445521013, 357.77149658203143, 362.34693874894754, 372.4363472777058, 369.99663073422715, 354.986106545212, 330.83626073710025, 352.79026747861525, 347.50184744003775, 359.2978532981965, 355.2622926849907, 334.68681166873455, 351.68275272458527, 362.1613796314215, 347.7935302085639, 340.10575513117635, 360.19854395473806, 333.8099527688837, 374.95443167521216, 326.70740785177753, 353.5345014010372, 367.2354032794621, 354.22487344937434, 359.5840059294938, 356.4485425697046, 345.8118037265945, 308.1003857133775, 316.798828965723, 361.4133071616361, 369.46959836820986, 354.5575732002679, 365.4061081905301, 363.64558488634276, 360.8487067475689, 362.17902099107977, 348.4311698458, 331.65563629102854, 350.59094044349996, 354.96961187159667, 330.6796468554889, 335.59387544059535, 339.5297209489006, 350.4866529940661, 357.23228759636896, 358.32133496397535, 354.63977812234396, 364.6226932671776, 331.8646068419288, 361.96545509928785, 356.9014721598607, 348.5577677488389], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.620551463143536, "mean_inference_ms": 1.2330742898964668, "mean_action_processing_ms": 0.20488800971450374, "mean_env_wait_ms": 496.8718741704449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010080337524414062, "StateBufferConnector_ms": 0.005985736846923828, "ViewRequirementAgentConnector_ms": 0.1647942066192627}, "num_episodes": 37, "episode_return_max": 374.95443167521216, "episode_return_min": 303.04571101726003, "episode_return_mean": 351.5258215728994}, "episode_reward_max": 374.95443167521216, "episode_reward_min": 303.04571101726003, "episode_reward_mean": 351.5258215728994, "episode_len_mean": 50.0, "episodes_this_iter": 37, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [349.8632261860828, 360.93711425819026, 354.3999562549911, 366.4038518477806, 355.69115983731587, 366.65873094105984, 353.03115642815567, 355.4353853846599, 354.8102768158087, 352.3322035553669, 320.67670579628884, 365.85384800070136, 347.442273669847, 361.720778626442, 350.4850814191503, 346.1214214980118, 363.93881758024077, 360.12215418813935, 341.8031134415809, 342.5641222133873, 339.8915414797585, 347.0852949573314, 346.9282179367713, 367.5611450195313, 346.2520784022914, 358.748387030717, 320.15556767273364, 349.85812762001706, 303.04571101726003, 353.69516346793034, 366.22522545107114, 357.36218672958876, 358.58970039766547, 357.9671429252347, 353.18352032383837, 339.138389350641, 352.5418263165391, 356.7148188088734, 350.948143420026, 352.59382317493464, 364.4415150549718, 366.4782273689294, 343.59373198810835, 353.8379048990655, 343.6628669495443, 342.82694787706504, 361.2534234918273, 355.08332652757775, 353.9538759525765, 348.045445521013, 357.77149658203143, 362.34693874894754, 372.4363472777058, 369.99663073422715, 354.986106545212, 330.83626073710025, 352.79026747861525, 347.50184744003775, 359.2978532981965, 355.2622926849907, 334.68681166873455, 351.68275272458527, 362.1613796314215, 347.7935302085639, 340.10575513117635, 360.19854395473806, 333.8099527688837, 374.95443167521216, 326.70740785177753, 353.5345014010372, 367.2354032794621, 354.22487344937434, 359.5840059294938, 356.4485425697046, 345.8118037265945, 308.1003857133775, 316.798828965723, 361.4133071616361, 369.46959836820986, 354.5575732002679, 365.4061081905301, 363.64558488634276, 360.8487067475689, 362.17902099107977, 348.4311698458, 331.65563629102854, 350.59094044349996, 354.96961187159667, 330.6796468554889, 335.59387544059535, 339.5297209489006, 350.4866529940661, 357.23228759636896, 358.32133496397535, 354.63977812234396, 364.6226932671776, 331.8646068419288, 361.96545509928785, 356.9014721598607, 348.5577677488389], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.620551463143536, "mean_inference_ms": 1.2330742898964668, "mean_action_processing_ms": 0.20488800971450374, "mean_env_wait_ms": 496.8718741704449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010080337524414062, "StateBufferConnector_ms": 0.005985736846923828, "ViewRequirementAgentConnector_ms": 0.1647942066192627}, "num_episodes": 37, "episode_return_max": 374.95443167521216, "episode_return_min": 303.04571101726003, "episode_return_mean": 351.5258215728994, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163368, "num_agent_steps_trained": 163368, "num_env_steps_sampled": 163368, "num_env_steps_trained": 163368, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 11.029186466360622, "num_env_steps_trained_throughput_per_sec": 11.029186466360622, "timesteps_total": 163368, "num_env_steps_sampled_lifetime": 163368, "num_agent_steps_sampled_lifetime": 163368, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 163368, "timers": {"training_iteration_time_ms": 186977.037, "restore_workers_time_ms": 0.019, "training_step_time_ms": 186976.981, "sample_time_ms": 184012.67, "load_time_ms": 0.576, "load_throughput": 3560906.83, "learn_time_ms": 2948.872, "learn_throughput": 695.859, "synch_weights_time_ms": 14.478}, "counters": {"num_env_steps_sampled": 163368, "num_env_steps_trained": 163368, "num_agent_steps_sampled": 163368, "num_agent_steps_trained": 163368}, "done": false, "episodes_total": 3546, "training_iteration": 151, "trial_id": "fe178_00005", "date": "2024-08-15_21-39-56", "timestamp": 1723779596, "time_this_iter_s": 186.05538940429688, "time_total_s": 15587.512306690216, "pid": 25554, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2596169418873165, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.5763345662221224, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1308.8650608062744, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 22.327819548872185, "ram_util_percent": 11.190601503759394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.89858273367087, "cur_kl_coeff": 0.9886025477296129, "cur_lr": 0.00010000000000000003, "total_loss": 1.922345123657336, "policy_loss": 0.005557848342383901, "vf_loss": 1.88984682764858, "vf_explained_var": 0.13650573107103506, "kl": 0.02725104347555388, "entropy": -1.620978808651368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3600.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 165420, "num_env_steps_trained": 165420, "num_agent_steps_sampled": 165420, "num_agent_steps_trained": 165420}, "sampler_results": {"episode_reward_max": 374.95443167521216, "episode_reward_min": 290.0963056872567, "episode_reward_mean": 350.3444336830212, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.59373198810835, 353.8379048990655, 343.6628669495443, 342.82694787706504, 361.2534234918273, 355.08332652757775, 353.9538759525765, 348.045445521013, 357.77149658203143, 362.34693874894754, 372.4363472777058, 369.99663073422715, 354.986106545212, 330.83626073710025, 352.79026747861525, 347.50184744003775, 359.2978532981965, 355.2622926849907, 334.68681166873455, 351.68275272458527, 362.1613796314215, 347.7935302085639, 340.10575513117635, 360.19854395473806, 333.8099527688837, 374.95443167521216, 326.70740785177753, 353.5345014010372, 367.2354032794621, 354.22487344937434, 359.5840059294938, 356.4485425697046, 345.8118037265945, 308.1003857133775, 316.798828965723, 361.4133071616361, 369.46959836820986, 354.5575732002679, 365.4061081905301, 363.64558488634276, 360.8487067475689, 362.17902099107977, 348.4311698458, 331.65563629102854, 350.59094044349996, 354.96961187159667, 330.6796468554889, 335.59387544059535, 339.5297209489006, 350.4866529940661, 357.23228759636896, 358.32133496397535, 354.63977812234396, 364.6226932671776, 331.8646068419288, 361.96545509928785, 356.9014721598607, 348.5577677488389, 350.6860480591354, 362.37922641672606, 354.7329539233425, 345.2298202008627, 329.4667399214868, 362.16628218568326, 347.4516313235301, 358.98184289408334, 341.1385895779535, 327.3490221944936, 344.73887549857386, 362.68029276109746, 372.82264581682966, 349.42526369249975, 354.6557995281374, 346.7989333643537, 353.51587412358265, 354.4917227213899, 349.580081484544, 342.7916798724275, 349.285224594346, 349.1308223373691, 354.71574807205985, 349.97853144590795, 359.40935953345735, 359.72531793110096, 360.1405337356115, 355.21276699847886, 354.37786733645515, 346.99303541865646, 366.0368423547283, 364.5315108979746, 339.37577461097624, 290.0963056872567, 318.3623134338899, 339.68248678373897, 334.072023860631, 348.7473228835333, 351.44712667011186, 345.3366408878106, 359.9153462637063, 353.90211558348636], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6042729140151595, "mean_inference_ms": 1.232764405352948, "mean_action_processing_ms": 0.20489692065745846, "mean_env_wait_ms": 495.04585254496027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010465860366821289, "StateBufferConnector_ms": 0.00601649284362793, "ViewRequirementAgentConnector_ms": 0.16415739059448242}, "num_episodes": 42, "episode_return_max": 374.95443167521216, "episode_return_min": 290.0963056872567, "episode_return_mean": 350.3444336830212}, "env_runner_results": {"episode_reward_max": 374.95443167521216, "episode_reward_min": 290.0963056872567, "episode_reward_mean": 350.3444336830212, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.59373198810835, 353.8379048990655, 343.6628669495443, 342.82694787706504, 361.2534234918273, 355.08332652757775, 353.9538759525765, 348.045445521013, 357.77149658203143, 362.34693874894754, 372.4363472777058, 369.99663073422715, 354.986106545212, 330.83626073710025, 352.79026747861525, 347.50184744003775, 359.2978532981965, 355.2622926849907, 334.68681166873455, 351.68275272458527, 362.1613796314215, 347.7935302085639, 340.10575513117635, 360.19854395473806, 333.8099527688837, 374.95443167521216, 326.70740785177753, 353.5345014010372, 367.2354032794621, 354.22487344937434, 359.5840059294938, 356.4485425697046, 345.8118037265945, 308.1003857133775, 316.798828965723, 361.4133071616361, 369.46959836820986, 354.5575732002679, 365.4061081905301, 363.64558488634276, 360.8487067475689, 362.17902099107977, 348.4311698458, 331.65563629102854, 350.59094044349996, 354.96961187159667, 330.6796468554889, 335.59387544059535, 339.5297209489006, 350.4866529940661, 357.23228759636896, 358.32133496397535, 354.63977812234396, 364.6226932671776, 331.8646068419288, 361.96545509928785, 356.9014721598607, 348.5577677488389, 350.6860480591354, 362.37922641672606, 354.7329539233425, 345.2298202008627, 329.4667399214868, 362.16628218568326, 347.4516313235301, 358.98184289408334, 341.1385895779535, 327.3490221944936, 344.73887549857386, 362.68029276109746, 372.82264581682966, 349.42526369249975, 354.6557995281374, 346.7989333643537, 353.51587412358265, 354.4917227213899, 349.580081484544, 342.7916798724275, 349.285224594346, 349.1308223373691, 354.71574807205985, 349.97853144590795, 359.40935953345735, 359.72531793110096, 360.1405337356115, 355.21276699847886, 354.37786733645515, 346.99303541865646, 366.0368423547283, 364.5315108979746, 339.37577461097624, 290.0963056872567, 318.3623134338899, 339.68248678373897, 334.072023860631, 348.7473228835333, 351.44712667011186, 345.3366408878106, 359.9153462637063, 353.90211558348636], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6042729140151595, "mean_inference_ms": 1.232764405352948, "mean_action_processing_ms": 0.20489692065745846, "mean_env_wait_ms": 495.04585254496027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010465860366821289, "StateBufferConnector_ms": 0.00601649284362793, "ViewRequirementAgentConnector_ms": 0.16415739059448242}, "num_episodes": 42, "episode_return_max": 374.95443167521216, "episode_return_min": 290.0963056872567, "episode_return_mean": 350.3444336830212}, "episode_reward_max": 374.95443167521216, "episode_reward_min": 290.0963056872567, "episode_reward_mean": 350.3444336830212, "episode_len_mean": 50.0, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [343.59373198810835, 353.8379048990655, 343.6628669495443, 342.82694787706504, 361.2534234918273, 355.08332652757775, 353.9538759525765, 348.045445521013, 357.77149658203143, 362.34693874894754, 372.4363472777058, 369.99663073422715, 354.986106545212, 330.83626073710025, 352.79026747861525, 347.50184744003775, 359.2978532981965, 355.2622926849907, 334.68681166873455, 351.68275272458527, 362.1613796314215, 347.7935302085639, 340.10575513117635, 360.19854395473806, 333.8099527688837, 374.95443167521216, 326.70740785177753, 353.5345014010372, 367.2354032794621, 354.22487344937434, 359.5840059294938, 356.4485425697046, 345.8118037265945, 308.1003857133775, 316.798828965723, 361.4133071616361, 369.46959836820986, 354.5575732002679, 365.4061081905301, 363.64558488634276, 360.8487067475689, 362.17902099107977, 348.4311698458, 331.65563629102854, 350.59094044349996, 354.96961187159667, 330.6796468554889, 335.59387544059535, 339.5297209489006, 350.4866529940661, 357.23228759636896, 358.32133496397535, 354.63977812234396, 364.6226932671776, 331.8646068419288, 361.96545509928785, 356.9014721598607, 348.5577677488389, 350.6860480591354, 362.37922641672606, 354.7329539233425, 345.2298202008627, 329.4667399214868, 362.16628218568326, 347.4516313235301, 358.98184289408334, 341.1385895779535, 327.3490221944936, 344.73887549857386, 362.68029276109746, 372.82264581682966, 349.42526369249975, 354.6557995281374, 346.7989333643537, 353.51587412358265, 354.4917227213899, 349.580081484544, 342.7916798724275, 349.285224594346, 349.1308223373691, 354.71574807205985, 349.97853144590795, 359.40935953345735, 359.72531793110096, 360.1405337356115, 355.21276699847886, 354.37786733645515, 346.99303541865646, 366.0368423547283, 364.5315108979746, 339.37577461097624, 290.0963056872567, 318.3623134338899, 339.68248678373897, 334.072023860631, 348.7473228835333, 351.44712667011186, 345.3366408878106, 359.9153462637063, 353.90211558348636], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6042729140151595, "mean_inference_ms": 1.232764405352948, "mean_action_processing_ms": 0.20489692065745846, "mean_env_wait_ms": 495.04585254496027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010465860366821289, "StateBufferConnector_ms": 0.00601649284362793, "ViewRequirementAgentConnector_ms": 0.16415739059448242}, "num_episodes": 42, "episode_return_max": 374.95443167521216, "episode_return_min": 290.0963056872567, "episode_return_mean": 350.3444336830212, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165420, "num_agent_steps_trained": 165420, "num_env_steps_sampled": 165420, "num_env_steps_trained": 165420, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 11.395225301097533, "num_env_steps_trained_throughput_per_sec": 11.395225301097533, "timesteps_total": 165420, "num_env_steps_sampled_lifetime": 165420, "num_agent_steps_sampled_lifetime": 165420, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 165420, "timers": {"training_iteration_time_ms": 186114.337, "restore_workers_time_ms": 0.02, "training_step_time_ms": 186114.281, "sample_time_ms": 183191.612, "load_time_ms": 0.567, "load_throughput": 3615885.646, "learn_time_ms": 2907.38, "learn_throughput": 705.79, "synch_weights_time_ms": 14.339}, "counters": {"num_env_steps_sampled": 165420, "num_env_steps_trained": 165420, "num_agent_steps_sampled": 165420, "num_agent_steps_trained": 165420}, "done": false, "episodes_total": 3588, "training_iteration": 152, "trial_id": "fe178_00005", "date": "2024-08-15_21-42-56", "timestamp": 1723779776, "time_this_iter_s": 180.07923984527588, "time_total_s": 15767.591546535492, "pid": 25554, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2596169418873165, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.5763345662221224, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 1488.9443006515503, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.939688715953306, "ram_util_percent": 11.37431906614786}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.31217572291692, "cur_kl_coeff": 1.7575156404082006, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.76442467768987, "policy_loss": 0.021032196609303354, "vf_loss": 2.6321991299589476, "vf_explained_var": 0.06857835377256076, "kl": 0.06326734793207806, "entropy": -1.6737097275753816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 168498, "num_env_steps_trained": 168498, "num_agent_steps_sampled": 168498, "num_agent_steps_trained": 168498}, "sampler_results": {"episode_reward_max": 373.08716259084866, "episode_reward_min": 312.183286046223, "episode_reward_mean": 349.39604518784364, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.5491779385306, 341.933469211205, 364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.215511072513669, "mean_inference_ms": 1.2404477411462356, "mean_action_processing_ms": 0.2038765323254489, "mean_env_wait_ms": 491.8237834475762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011940797170003256, "StateBufferConnector_ms": 0.00570482677883572, "ViewRequirementAgentConnector_ms": 0.1607060432434082}, "num_episodes": 18, "episode_return_max": 373.08716259084866, "episode_return_min": 312.183286046223, "episode_return_mean": 349.39604518784364}, "env_runner_results": {"episode_reward_max": 373.08716259084866, "episode_reward_min": 312.183286046223, "episode_reward_mean": 349.39604518784364, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.5491779385306, 341.933469211205, 364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.215511072513669, "mean_inference_ms": 1.2404477411462356, "mean_action_processing_ms": 0.2038765323254489, "mean_env_wait_ms": 491.8237834475762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011940797170003256, "StateBufferConnector_ms": 0.00570482677883572, "ViewRequirementAgentConnector_ms": 0.1607060432434082}, "num_episodes": 18, "episode_return_max": 373.08716259084866, "episode_return_min": 312.183286046223, "episode_return_mean": 349.39604518784364}, "episode_reward_max": 373.08716259084866, "episode_reward_min": 312.183286046223, "episode_reward_mean": 349.39604518784364, "episode_len_mean": 50.0, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [352.5491779385306, 341.933469211205, 364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.215511072513669, "mean_inference_ms": 1.2404477411462356, "mean_action_processing_ms": 0.2038765323254489, "mean_env_wait_ms": 491.8237834475762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011940797170003256, "StateBufferConnector_ms": 0.00570482677883572, "ViewRequirementAgentConnector_ms": 0.1607060432434082}, "num_episodes": 18, "episode_return_max": 373.08716259084866, "episode_return_min": 312.183286046223, "episode_return_mean": 349.39604518784364, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168498, "num_agent_steps_trained": 168498, "num_env_steps_sampled": 168498, "num_env_steps_trained": 168498, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.955088650598716, "num_env_steps_trained_throughput_per_sec": 10.955088650598716, "timesteps_total": 168498, "num_env_steps_sampled_lifetime": 168498, "num_agent_steps_sampled_lifetime": 168498, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 168498, "timers": {"training_iteration_time_ms": 93655.12, "restore_workers_time_ms": 0.018, "training_step_time_ms": 93655.06, "sample_time_ms": 89709.068, "load_time_ms": 0.768, "load_throughput": 1336445.933, "learn_time_ms": 3931.334, "learn_throughput": 260.98, "synch_weights_time_ms": 13.375}, "counters": {"num_env_steps_sampled": 168498, "num_env_steps_trained": 168498, "num_agent_steps_sampled": 168498, "num_agent_steps_trained": 168498}, "done": false, "episodes_total": 3653, "training_iteration": 154, "trial_id": "fe178_00005", "date": "2024-08-15_21-44-56", "timestamp": 1723779896, "time_this_iter_s": 93.65862226486206, "time_total_s": 16019.976164579391, "pid": 83044, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3549865712257006, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9809594252080035, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 93.65862226486206, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 21.6955223880597, "ram_util_percent": 11.030597014925373}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 201.25914829174678, "cur_kl_coeff": 2.6362734606123004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.832590537611395, "policy_loss": 0.01741572452398638, "vf_loss": 2.6770150239268937, "vf_explained_var": 0.05204455827673276, "kl": 0.05240722314677977, "entropy": -1.75032236824433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 169524, "num_env_steps_trained": 169524, "num_agent_steps_sampled": 169524, "num_agent_steps_trained": 169524}, "sampler_results": {"episode_reward_max": 373.8679971183117, "episode_reward_min": 312.183286046223, "episode_reward_mean": 352.37227337673653, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.5491779385306, 341.933469211205, 364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182, 360.4086133786225, 349.0431871154342, 373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.205856373189552, "mean_inference_ms": 1.238877740294704, "mean_action_processing_ms": 0.20382502099108576, "mean_env_wait_ms": 509.55871638025684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012977255715264214, "StateBufferConnector_ms": 0.005658467610677083, "ViewRequirementAgentConnector_ms": 0.15882584783766004}, "num_episodes": 18, "episode_return_max": 373.8679971183117, "episode_return_min": 312.183286046223, "episode_return_mean": 352.37227337673653}, "env_runner_results": {"episode_reward_max": 373.8679971183117, "episode_reward_min": 312.183286046223, "episode_reward_mean": 352.37227337673653, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.5491779385306, 341.933469211205, 364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182, 360.4086133786225, 349.0431871154342, 373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.205856373189552, "mean_inference_ms": 1.238877740294704, "mean_action_processing_ms": 0.20382502099108576, "mean_env_wait_ms": 509.55871638025684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012977255715264214, "StateBufferConnector_ms": 0.005658467610677083, "ViewRequirementAgentConnector_ms": 0.15882584783766004}, "num_episodes": 18, "episode_return_max": 373.8679971183117, "episode_return_min": 312.183286046223, "episode_return_mean": 352.37227337673653}, "episode_reward_max": 373.8679971183117, "episode_reward_min": 312.183286046223, "episode_reward_mean": 352.37227337673653, "episode_len_mean": 50.0, "episodes_this_iter": 18, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [352.5491779385306, 341.933469211205, 364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182, 360.4086133786225, 349.0431871154342, 373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.205856373189552, "mean_inference_ms": 1.238877740294704, "mean_action_processing_ms": 0.20382502099108576, "mean_env_wait_ms": 509.55871638025684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012977255715264214, "StateBufferConnector_ms": 0.005658467610677083, "ViewRequirementAgentConnector_ms": 0.15882584783766004}, "num_episodes": 18, "episode_return_max": 373.8679971183117, "episode_return_min": 312.183286046223, "episode_return_mean": 352.37227337673653, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169524, "num_agent_steps_trained": 169524, "num_env_steps_sampled": 169524, "num_env_steps_trained": 169524, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 9.9489657125291, "num_env_steps_trained_throughput_per_sec": 9.9489657125291, "timesteps_total": 169524, "num_env_steps_sampled_lifetime": 169524, "num_agent_steps_sampled_lifetime": 169524, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 169524, "timers": {"training_iteration_time_ms": 98390.715, "restore_workers_time_ms": 0.017, "training_step_time_ms": 98390.657, "sample_time_ms": 95745.991, "load_time_ms": 0.585, "load_throughput": 1752537.53, "learn_time_ms": 2630.323, "learn_throughput": 390.066, "synch_weights_time_ms": 13.34}, "counters": {"num_env_steps_sampled": 169524, "num_env_steps_trained": 169524, "num_agent_steps_sampled": 169524, "num_agent_steps_trained": 169524}, "done": false, "episodes_total": 3671, "training_iteration": 155, "trial_id": "fe178_00005", "date": "2024-08-15_21-46-39", "timestamp": 1723779999, "time_this_iter_s": 103.12970066070557, "time_total_s": 16123.105865240097, "pid": 83044, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3549865712257006, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9809594252080035, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 196.78832292556763, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.24829931972789, "ram_util_percent": 11.119047619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109.47479730447134, "cur_kl_coeff": 3.9544101909184515, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.795453703023183, "policy_loss": -9.929257212206721e-05, "vf_loss": 2.777030111849308, "vf_explained_var": 0.10714395195245743, "kl": 0.00468411878494936, "entropy": -1.674657692015171, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 170550, "num_env_steps_trained": 170550, "num_agent_steps_sampled": 170550, "num_agent_steps_trained": 170550}, "sampler_results": {"episode_reward_max": 373.8679971183117, "episode_reward_min": 312.183286046223, "episode_reward_mean": 353.6192479170135, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.5491779385306, 341.933469211205, 364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182, 360.4086133786225, 349.0431871154342, 373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602, 351.58023612589824, 370.51063700757123, 355.0327969371318, 366.1723550259766, 371.28527351713853, 360.1185629534002, 368.6204963691526, 331.9387765841649, 356.58064174132056, 330.7067664518354, 327.303651487214, 352.6716300673621, 361.82850092490844, 348.2355932253303, 339.25509082544687, 368.4827464053774, 362.2141063073791, 356.43649574391816, 362.7940263899675, 351.8917551412783, 352.34087104790086, 372.405482662359, 361.07537841280646, 352.27116210346014], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.34005075153894, "mean_inference_ms": 1.2376456668836426, "mean_action_processing_ms": 0.20382056039903246, "mean_env_wait_ms": 502.60463246496795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013033548990885416, "StateBufferConnector_ms": 0.005772908528645833, "ViewRequirementAgentConnector_ms": 0.15975435574849448}, "num_episodes": 24, "episode_return_max": 373.8679971183117, "episode_return_min": 312.183286046223, "episode_return_mean": 353.6192479170135}, "env_runner_results": {"episode_reward_max": 373.8679971183117, "episode_reward_min": 312.183286046223, "episode_reward_mean": 353.6192479170135, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.5491779385306, 341.933469211205, 364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182, 360.4086133786225, 349.0431871154342, 373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602, 351.58023612589824, 370.51063700757123, 355.0327969371318, 366.1723550259766, 371.28527351713853, 360.1185629534002, 368.6204963691526, 331.9387765841649, 356.58064174132056, 330.7067664518354, 327.303651487214, 352.6716300673621, 361.82850092490844, 348.2355932253303, 339.25509082544687, 368.4827464053774, 362.2141063073791, 356.43649574391816, 362.7940263899675, 351.8917551412783, 352.34087104790086, 372.405482662359, 361.07537841280646, 352.27116210346014], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.34005075153894, "mean_inference_ms": 1.2376456668836426, "mean_action_processing_ms": 0.20382056039903246, "mean_env_wait_ms": 502.60463246496795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013033548990885416, "StateBufferConnector_ms": 0.005772908528645833, "ViewRequirementAgentConnector_ms": 0.15975435574849448}, "num_episodes": 24, "episode_return_max": 373.8679971183117, "episode_return_min": 312.183286046223, "episode_return_mean": 353.6192479170135}, "episode_reward_max": 373.8679971183117, "episode_reward_min": 312.183286046223, "episode_reward_mean": 353.6192479170135, "episode_len_mean": 50.0, "episodes_this_iter": 24, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [352.5491779385306, 341.933469211205, 364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182, 360.4086133786225, 349.0431871154342, 373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602, 351.58023612589824, 370.51063700757123, 355.0327969371318, 366.1723550259766, 371.28527351713853, 360.1185629534002, 368.6204963691526, 331.9387765841649, 356.58064174132056, 330.7067664518354, 327.303651487214, 352.6716300673621, 361.82850092490844, 348.2355932253303, 339.25509082544687, 368.4827464053774, 362.2141063073791, 356.43649574391816, 362.7940263899675, 351.8917551412783, 352.34087104790086, 372.405482662359, 361.07537841280646, 352.27116210346014], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.34005075153894, "mean_inference_ms": 1.2376456668836426, "mean_action_processing_ms": 0.20382056039903246, "mean_env_wait_ms": 502.60463246496795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013033548990885416, "StateBufferConnector_ms": 0.005772908528645833, "ViewRequirementAgentConnector_ms": 0.15975435574849448}, "num_episodes": 24, "episode_return_max": 373.8679971183117, "episode_return_min": 312.183286046223, "episode_return_mean": 353.6192479170135, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 170550, "num_agent_steps_trained": 170550, "num_env_steps_sampled": 170550, "num_env_steps_trained": 170550, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.897005193372161, "num_env_steps_trained_throughput_per_sec": 11.897005193372161, "timesteps_total": 170550, "num_env_steps_sampled_lifetime": 170550, "num_agent_steps_sampled_lifetime": 170550, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 170550, "timers": {"training_iteration_time_ms": 94340.544, "restore_workers_time_ms": 0.02, "training_step_time_ms": 94340.485, "sample_time_ms": 92024.781, "load_time_ms": 0.539, "load_throughput": 1905263.83, "learn_time_ms": 2301.428, "learn_throughput": 445.81, "synch_weights_time_ms": 13.343}, "counters": {"num_env_steps_sampled": 170550, "num_env_steps_trained": 170550, "num_agent_steps_sampled": 170550, "num_agent_steps_trained": 170550}, "done": false, "episodes_total": 3695, "training_iteration": 156, "trial_id": "fe178_00005", "date": "2024-08-15_21-48-05", "timestamp": 1723780085, "time_this_iter_s": 86.24349117279053, "time_total_s": 16209.349356412888, "pid": 83044, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3549865712257006, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9809594252080035, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 283.03181409835815, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.757258064516126, "ram_util_percent": 11.21048387096774}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.825458550453185, "cur_kl_coeff": 1.9772050954592257, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.761127942513364, "policy_loss": -0.004908632351240764, "vf_loss": 2.761126032844186, "vf_explained_var": 0.0508467177549998, "kl": 0.002483586889745008, "entropy": -1.6870216409365335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 171576, "num_env_steps_trained": 171576, "num_agent_steps_sampled": 171576, "num_agent_steps_trained": 171576}, "sampler_results": {"episode_reward_max": 375.51234133541374, "episode_reward_min": 312.183286046223, "episode_reward_mean": 353.2915412541115, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.5491779385306, 341.933469211205, 364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182, 360.4086133786225, 349.0431871154342, 373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602, 351.58023612589824, 370.51063700757123, 355.0327969371318, 366.1723550259766, 371.28527351713853, 360.1185629534002, 368.6204963691526, 331.9387765841649, 356.58064174132056, 330.7067664518354, 327.303651487214, 352.6716300673621, 361.82850092490844, 348.2355932253303, 339.25509082544687, 368.4827464053774, 362.2141063073791, 356.43649574391816, 362.7940263899675, 351.8917551412783, 352.34087104790086, 372.405482662359, 361.07537841280646, 352.27116210346014, 357.74903064604445, 365.2077016684287, 347.9679700801187, 341.42114226439, 349.2277545576299, 355.3096122585993, 362.10508421621785, 340.38122811807847, 355.2449284074409, 375.51234133541374, 335.92420134392614, 350.80147367292096, 355.6768059973544, 319.4790125732422, 357.90815014616095, 360.92090000145055, 354.94406618488995, 353.80393932757903], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.36200008674988, "mean_inference_ms": 1.2363393777323113, "mean_action_processing_ms": 0.20374038749789966, "mean_env_wait_ms": 502.2404170855443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012188080029609876, "StateBufferConnector_ms": 0.005711958958552434, "ViewRequirementAgentConnector_ms": 0.15909763482900766}, "num_episodes": 18, "episode_return_max": 375.51234133541374, "episode_return_min": 312.183286046223, "episode_return_mean": 353.2915412541115}, "env_runner_results": {"episode_reward_max": 375.51234133541374, "episode_reward_min": 312.183286046223, "episode_reward_mean": 353.2915412541115, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.5491779385306, 341.933469211205, 364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182, 360.4086133786225, 349.0431871154342, 373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602, 351.58023612589824, 370.51063700757123, 355.0327969371318, 366.1723550259766, 371.28527351713853, 360.1185629534002, 368.6204963691526, 331.9387765841649, 356.58064174132056, 330.7067664518354, 327.303651487214, 352.6716300673621, 361.82850092490844, 348.2355932253303, 339.25509082544687, 368.4827464053774, 362.2141063073791, 356.43649574391816, 362.7940263899675, 351.8917551412783, 352.34087104790086, 372.405482662359, 361.07537841280646, 352.27116210346014, 357.74903064604445, 365.2077016684287, 347.9679700801187, 341.42114226439, 349.2277545576299, 355.3096122585993, 362.10508421621785, 340.38122811807847, 355.2449284074409, 375.51234133541374, 335.92420134392614, 350.80147367292096, 355.6768059973544, 319.4790125732422, 357.90815014616095, 360.92090000145055, 354.94406618488995, 353.80393932757903], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.36200008674988, "mean_inference_ms": 1.2363393777323113, "mean_action_processing_ms": 0.20374038749789966, "mean_env_wait_ms": 502.2404170855443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012188080029609876, "StateBufferConnector_ms": 0.005711958958552434, "ViewRequirementAgentConnector_ms": 0.15909763482900766}, "num_episodes": 18, "episode_return_max": 375.51234133541374, "episode_return_min": 312.183286046223, "episode_return_mean": 353.2915412541115}, "episode_reward_max": 375.51234133541374, "episode_reward_min": 312.183286046223, "episode_reward_mean": 353.2915412541115, "episode_len_mean": 50.0, "episodes_this_iter": 18, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [352.5491779385306, 341.933469211205, 364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182, 360.4086133786225, 349.0431871154342, 373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602, 351.58023612589824, 370.51063700757123, 355.0327969371318, 366.1723550259766, 371.28527351713853, 360.1185629534002, 368.6204963691526, 331.9387765841649, 356.58064174132056, 330.7067664518354, 327.303651487214, 352.6716300673621, 361.82850092490844, 348.2355932253303, 339.25509082544687, 368.4827464053774, 362.2141063073791, 356.43649574391816, 362.7940263899675, 351.8917551412783, 352.34087104790086, 372.405482662359, 361.07537841280646, 352.27116210346014, 357.74903064604445, 365.2077016684287, 347.9679700801187, 341.42114226439, 349.2277545576299, 355.3096122585993, 362.10508421621785, 340.38122811807847, 355.2449284074409, 375.51234133541374, 335.92420134392614, 350.80147367292096, 355.6768059973544, 319.4790125732422, 357.90815014616095, 360.92090000145055, 354.94406618488995, 353.80393932757903], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.36200008674988, "mean_inference_ms": 1.2363393777323113, "mean_action_processing_ms": 0.20374038749789966, "mean_env_wait_ms": 502.2404170855443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012188080029609876, "StateBufferConnector_ms": 0.005711958958552434, "ViewRequirementAgentConnector_ms": 0.15909763482900766}, "num_episodes": 18, "episode_return_max": 375.51234133541374, "episode_return_min": 312.183286046223, "episode_return_mean": 353.2915412541115, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171576, "num_agent_steps_trained": 171576, "num_env_steps_sampled": 171576, "num_env_steps_trained": 171576, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.541723425608621, "num_env_steps_trained_throughput_per_sec": 10.541723425608621, "timesteps_total": 171576, "num_env_steps_sampled_lifetime": 171576, "num_agent_steps_sampled_lifetime": 171576, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 171576, "timers": {"training_iteration_time_ms": 95087.298, "restore_workers_time_ms": 0.021, "training_step_time_ms": 95087.233, "sample_time_ms": 92884.173, "load_time_ms": 0.52, "load_throughput": 1974242.874, "learn_time_ms": 2188.831, "learn_throughput": 468.743, "synch_weights_time_ms": 13.338}, "counters": {"num_env_steps_sampled": 171576, "num_env_steps_trained": 171576, "num_agent_steps_sampled": 171576, "num_agent_steps_trained": 171576}, "done": false, "episodes_total": 3713, "training_iteration": 157, "trial_id": "fe178_00005", "date": "2024-08-15_21-49-43", "timestamp": 1723780183, "time_this_iter_s": 97.33087825775146, "time_total_s": 16306.680234670639, "pid": 83044, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3549865712257006, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9809594252080035, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 380.3626923561096, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.020863309352517, "ram_util_percent": 11.30143884892086}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.80757227540016, "cur_kl_coeff": 0.9886025477296129, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7134225234408706, "policy_loss": -0.00726381903514266, "vf_loss": 2.7185817544658977, "vf_explained_var": 0.08022951458891232, "kl": 0.002128842341215904, "entropy": -1.80722027271986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 172602, "num_env_steps_trained": 172602, "num_agent_steps_sampled": 172602, "num_agent_steps_trained": 172602}, "sampler_results": {"episode_reward_max": 375.51234133541374, "episode_reward_min": 304.07443555500197, "episode_reward_mean": 353.5355426516778, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182, 360.4086133786225, 349.0431871154342, 373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602, 351.58023612589824, 370.51063700757123, 355.0327969371318, 366.1723550259766, 371.28527351713853, 360.1185629534002, 368.6204963691526, 331.9387765841649, 356.58064174132056, 330.7067664518354, 327.303651487214, 352.6716300673621, 361.82850092490844, 348.2355932253303, 339.25509082544687, 368.4827464053774, 362.2141063073791, 356.43649574391816, 362.7940263899675, 351.8917551412783, 352.34087104790086, 372.405482662359, 361.07537841280646, 352.27116210346014, 357.74903064604445, 365.2077016684287, 347.9679700801187, 341.42114226439, 349.2277545576299, 355.3096122585993, 362.10508421621785, 340.38122811807847, 355.2449284074409, 375.51234133541374, 335.92420134392614, 350.80147367292096, 355.6768059973544, 319.4790125732422, 357.90815014616095, 360.92090000145055, 354.94406618488995, 353.80393932757903, 356.84479408238394, 362.3413481309775, 357.5655614816397, 349.3060967350845, 356.86263447695484, 363.0064678664355, 365.9193601485767, 348.46761130908874, 374.3699078711397, 357.98473397878087, 348.37455839068207, 347.4055186865187, 355.32600091553263, 304.07443555500197, 361.3352453976142, 346.6901944889847, 351.2450412044247, 346.3517370132128, 328.30605662766743, 357.412953531549, 362.51904884787206, 361.17376859970415, 364.23633259225966, 364.1772865647365], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.420120743937156, "mean_inference_ms": 1.235331474508879, "mean_action_processing_ms": 0.20374640327808835, "mean_env_wait_ms": 501.65690399155136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011557579040527344, "StateBufferConnector_ms": 0.005704641342163086, "ViewRequirementAgentConnector_ms": 0.15971684455871582}, "num_episodes": 24, "episode_return_max": 375.51234133541374, "episode_return_min": 304.07443555500197, "episode_return_mean": 353.5355426516778}, "env_runner_results": {"episode_reward_max": 375.51234133541374, "episode_reward_min": 304.07443555500197, "episode_reward_mean": 353.5355426516778, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182, 360.4086133786225, 349.0431871154342, 373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602, 351.58023612589824, 370.51063700757123, 355.0327969371318, 366.1723550259766, 371.28527351713853, 360.1185629534002, 368.6204963691526, 331.9387765841649, 356.58064174132056, 330.7067664518354, 327.303651487214, 352.6716300673621, 361.82850092490844, 348.2355932253303, 339.25509082544687, 368.4827464053774, 362.2141063073791, 356.43649574391816, 362.7940263899675, 351.8917551412783, 352.34087104790086, 372.405482662359, 361.07537841280646, 352.27116210346014, 357.74903064604445, 365.2077016684287, 347.9679700801187, 341.42114226439, 349.2277545576299, 355.3096122585993, 362.10508421621785, 340.38122811807847, 355.2449284074409, 375.51234133541374, 335.92420134392614, 350.80147367292096, 355.6768059973544, 319.4790125732422, 357.90815014616095, 360.92090000145055, 354.94406618488995, 353.80393932757903, 356.84479408238394, 362.3413481309775, 357.5655614816397, 349.3060967350845, 356.86263447695484, 363.0064678664355, 365.9193601485767, 348.46761130908874, 374.3699078711397, 357.98473397878087, 348.37455839068207, 347.4055186865187, 355.32600091553263, 304.07443555500197, 361.3352453976142, 346.6901944889847, 351.2450412044247, 346.3517370132128, 328.30605662766743, 357.412953531549, 362.51904884787206, 361.17376859970415, 364.23633259225966, 364.1772865647365], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.420120743937156, "mean_inference_ms": 1.235331474508879, "mean_action_processing_ms": 0.20374640327808835, "mean_env_wait_ms": 501.65690399155136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011557579040527344, "StateBufferConnector_ms": 0.005704641342163086, "ViewRequirementAgentConnector_ms": 0.15971684455871582}, "num_episodes": 24, "episode_return_max": 375.51234133541374, "episode_return_min": 304.07443555500197, "episode_return_mean": 353.5355426516778}, "episode_reward_max": 375.51234133541374, "episode_reward_min": 304.07443555500197, "episode_reward_mean": 353.5355426516778, "episode_len_mean": 50.0, "episodes_this_iter": 24, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [364.32009925676874, 365.8338998281349, 312.183286046223, 373.08716259084866, 357.9554854133584, 355.29133868530414, 335.11506295489556, 344.4463343679373, 347.3485941883901, 339.1014118917483, 345.5917459442494, 355.8102172962222, 353.57334856600994, 360.1181086576025, 346.31849403163903, 338.5515765121182, 360.4086133786225, 349.0431871154342, 373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602, 351.58023612589824, 370.51063700757123, 355.0327969371318, 366.1723550259766, 371.28527351713853, 360.1185629534002, 368.6204963691526, 331.9387765841649, 356.58064174132056, 330.7067664518354, 327.303651487214, 352.6716300673621, 361.82850092490844, 348.2355932253303, 339.25509082544687, 368.4827464053774, 362.2141063073791, 356.43649574391816, 362.7940263899675, 351.8917551412783, 352.34087104790086, 372.405482662359, 361.07537841280646, 352.27116210346014, 357.74903064604445, 365.2077016684287, 347.9679700801187, 341.42114226439, 349.2277545576299, 355.3096122585993, 362.10508421621785, 340.38122811807847, 355.2449284074409, 375.51234133541374, 335.92420134392614, 350.80147367292096, 355.6768059973544, 319.4790125732422, 357.90815014616095, 360.92090000145055, 354.94406618488995, 353.80393932757903, 356.84479408238394, 362.3413481309775, 357.5655614816397, 349.3060967350845, 356.86263447695484, 363.0064678664355, 365.9193601485767, 348.46761130908874, 374.3699078711397, 357.98473397878087, 348.37455839068207, 347.4055186865187, 355.32600091553263, 304.07443555500197, 361.3352453976142, 346.6901944889847, 351.2450412044247, 346.3517370132128, 328.30605662766743, 357.412953531549, 362.51904884787206, 361.17376859970415, 364.23633259225966, 364.1772865647365], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.420120743937156, "mean_inference_ms": 1.235331474508879, "mean_action_processing_ms": 0.20374640327808835, "mean_env_wait_ms": 501.65690399155136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011557579040527344, "StateBufferConnector_ms": 0.005704641342163086, "ViewRequirementAgentConnector_ms": 0.15971684455871582}, "num_episodes": 24, "episode_return_max": 375.51234133541374, "episode_return_min": 304.07443555500197, "episode_return_mean": 353.5355426516778, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172602, "num_agent_steps_trained": 172602, "num_env_steps_sampled": 172602, "num_env_steps_trained": 172602, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 11.351170710347473, "num_env_steps_trained_throughput_per_sec": 11.351170710347473, "timesteps_total": 172602, "num_env_steps_sampled_lifetime": 172602, "num_agent_steps_sampled_lifetime": 172602, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 172602, "timers": {"training_iteration_time_ms": 94147.272, "restore_workers_time_ms": 0.021, "training_step_time_ms": 94147.209, "sample_time_ms": 92092.789, "load_time_ms": 0.499, "load_throughput": 2057446.885, "learn_time_ms": 2040.349, "learn_throughput": 502.855, "synch_weights_time_ms": 13.223}, "counters": {"num_env_steps_sampled": 172602, "num_env_steps_trained": 172602, "num_agent_steps_sampled": 172602, "num_agent_steps_trained": 172602}, "done": false, "episodes_total": 3737, "training_iteration": 158, "trial_id": "fe178_00005", "date": "2024-08-15_21-51-13", "timestamp": 1723780273, "time_this_iter_s": 90.39058518409729, "time_total_s": 16397.070819854736, "pid": 83044, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3549865712257006, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9809594252080035, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 470.7532775402069, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 22.96511627906977, "ram_util_percent": 11.398449612403102}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.23181880116463, "cur_kl_coeff": 0.49430127386480643, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.822109687747434, "policy_loss": -0.004308284803604086, "vf_loss": 2.8238431697090465, "vf_explained_var": 0.05852480828762054, "kl": 0.00520899119575823, "entropy": -1.715296131869157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 173628, "num_env_steps_trained": 173628, "num_agent_steps_sampled": 173628, "num_agent_steps_trained": 173628}, "sampler_results": {"episode_reward_max": 375.51234133541374, "episode_reward_min": 304.07443555500197, "episode_reward_mean": 354.3141565822269, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602, 351.58023612589824, 370.51063700757123, 355.0327969371318, 366.1723550259766, 371.28527351713853, 360.1185629534002, 368.6204963691526, 331.9387765841649, 356.58064174132056, 330.7067664518354, 327.303651487214, 352.6716300673621, 361.82850092490844, 348.2355932253303, 339.25509082544687, 368.4827464053774, 362.2141063073791, 356.43649574391816, 362.7940263899675, 351.8917551412783, 352.34087104790086, 372.405482662359, 361.07537841280646, 352.27116210346014, 357.74903064604445, 365.2077016684287, 347.9679700801187, 341.42114226439, 349.2277545576299, 355.3096122585993, 362.10508421621785, 340.38122811807847, 355.2449284074409, 375.51234133541374, 335.92420134392614, 350.80147367292096, 355.6768059973544, 319.4790125732422, 357.90815014616095, 360.92090000145055, 354.94406618488995, 353.80393932757903, 356.84479408238394, 362.3413481309775, 357.5655614816397, 349.3060967350845, 356.86263447695484, 363.0064678664355, 365.9193601485767, 348.46761130908874, 374.3699078711397, 357.98473397878087, 348.37455839068207, 347.4055186865187, 355.32600091553263, 304.07443555500197, 361.3352453976142, 346.6901944889847, 351.2450412044247, 346.3517370132128, 328.30605662766743, 357.412953531549, 362.51904884787206, 361.17376859970415, 364.23633259225966, 364.1772865647365, 367.447504106955, 350.3558282968812, 352.35932848073514, 357.80924117398706, 311.58051728562924, 358.91218252950733, 362.8333749260225, 361.5031576455109, 359.26371021822365, 355.960060847666, 367.7092843062452, 358.66064787946885, 347.64536976879174, 345.72336001344615, 356.38243408203175, 341.46975533555127, 355.5052991834104, 370.83830370034804], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.475956126598445, "mean_inference_ms": 1.2340240329036627, "mean_action_processing_ms": 0.20376407639832128, "mean_env_wait_ms": 502.8056765596822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011164188385009766, "StateBufferConnector_ms": 0.005736351013183594, "ViewRequirementAgentConnector_ms": 0.16008448600769043}, "num_episodes": 18, "episode_return_max": 375.51234133541374, "episode_return_min": 304.07443555500197, "episode_return_mean": 354.3141565822269}, "env_runner_results": {"episode_reward_max": 375.51234133541374, "episode_reward_min": 304.07443555500197, "episode_reward_mean": 354.3141565822269, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602, 351.58023612589824, 370.51063700757123, 355.0327969371318, 366.1723550259766, 371.28527351713853, 360.1185629534002, 368.6204963691526, 331.9387765841649, 356.58064174132056, 330.7067664518354, 327.303651487214, 352.6716300673621, 361.82850092490844, 348.2355932253303, 339.25509082544687, 368.4827464053774, 362.2141063073791, 356.43649574391816, 362.7940263899675, 351.8917551412783, 352.34087104790086, 372.405482662359, 361.07537841280646, 352.27116210346014, 357.74903064604445, 365.2077016684287, 347.9679700801187, 341.42114226439, 349.2277545576299, 355.3096122585993, 362.10508421621785, 340.38122811807847, 355.2449284074409, 375.51234133541374, 335.92420134392614, 350.80147367292096, 355.6768059973544, 319.4790125732422, 357.90815014616095, 360.92090000145055, 354.94406618488995, 353.80393932757903, 356.84479408238394, 362.3413481309775, 357.5655614816397, 349.3060967350845, 356.86263447695484, 363.0064678664355, 365.9193601485767, 348.46761130908874, 374.3699078711397, 357.98473397878087, 348.37455839068207, 347.4055186865187, 355.32600091553263, 304.07443555500197, 361.3352453976142, 346.6901944889847, 351.2450412044247, 346.3517370132128, 328.30605662766743, 357.412953531549, 362.51904884787206, 361.17376859970415, 364.23633259225966, 364.1772865647365, 367.447504106955, 350.3558282968812, 352.35932848073514, 357.80924117398706, 311.58051728562924, 358.91218252950733, 362.8333749260225, 361.5031576455109, 359.26371021822365, 355.960060847666, 367.7092843062452, 358.66064787946885, 347.64536976879174, 345.72336001344615, 356.38243408203175, 341.46975533555127, 355.5052991834104, 370.83830370034804], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.475956126598445, "mean_inference_ms": 1.2340240329036627, "mean_action_processing_ms": 0.20376407639832128, "mean_env_wait_ms": 502.8056765596822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011164188385009766, "StateBufferConnector_ms": 0.005736351013183594, "ViewRequirementAgentConnector_ms": 0.16008448600769043}, "num_episodes": 18, "episode_return_max": 375.51234133541374, "episode_return_min": 304.07443555500197, "episode_return_mean": 354.3141565822269}, "episode_reward_max": 375.51234133541374, "episode_reward_min": 304.07443555500197, "episode_reward_mean": 354.3141565822269, "episode_len_mean": 50.0, "episodes_this_iter": 18, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [373.8679971183117, 343.4109944123556, 364.2292735698389, 357.59354212940246, 364.30398104487165, 356.2385301138384, 350.03422505567374, 357.39715975755314, 332.92447156188643, 362.0736400225983, 359.90325380482295, 327.2427919053314, 370.1855957031255, 362.270637912785, 348.2078910622161, 356.9372425126602, 351.58023612589824, 370.51063700757123, 355.0327969371318, 366.1723550259766, 371.28527351713853, 360.1185629534002, 368.6204963691526, 331.9387765841649, 356.58064174132056, 330.7067664518354, 327.303651487214, 352.6716300673621, 361.82850092490844, 348.2355932253303, 339.25509082544687, 368.4827464053774, 362.2141063073791, 356.43649574391816, 362.7940263899675, 351.8917551412783, 352.34087104790086, 372.405482662359, 361.07537841280646, 352.27116210346014, 357.74903064604445, 365.2077016684287, 347.9679700801187, 341.42114226439, 349.2277545576299, 355.3096122585993, 362.10508421621785, 340.38122811807847, 355.2449284074409, 375.51234133541374, 335.92420134392614, 350.80147367292096, 355.6768059973544, 319.4790125732422, 357.90815014616095, 360.92090000145055, 354.94406618488995, 353.80393932757903, 356.84479408238394, 362.3413481309775, 357.5655614816397, 349.3060967350845, 356.86263447695484, 363.0064678664355, 365.9193601485767, 348.46761130908874, 374.3699078711397, 357.98473397878087, 348.37455839068207, 347.4055186865187, 355.32600091553263, 304.07443555500197, 361.3352453976142, 346.6901944889847, 351.2450412044247, 346.3517370132128, 328.30605662766743, 357.412953531549, 362.51904884787206, 361.17376859970415, 364.23633259225966, 364.1772865647365, 367.447504106955, 350.3558282968812, 352.35932848073514, 357.80924117398706, 311.58051728562924, 358.91218252950733, 362.8333749260225, 361.5031576455109, 359.26371021822365, 355.960060847666, 367.7092843062452, 358.66064787946885, 347.64536976879174, 345.72336001344615, 356.38243408203175, 341.46975533555127, 355.5052991834104, 370.83830370034804], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.475956126598445, "mean_inference_ms": 1.2340240329036627, "mean_action_processing_ms": 0.20376407639832128, "mean_env_wait_ms": 502.8056765596822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011164188385009766, "StateBufferConnector_ms": 0.005736351013183594, "ViewRequirementAgentConnector_ms": 0.16008448600769043}, "num_episodes": 18, "episode_return_max": 375.51234133541374, "episode_return_min": 304.07443555500197, "episode_return_mean": 354.3141565822269, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173628, "num_agent_steps_trained": 173628, "num_env_steps_sampled": 173628, "num_env_steps_trained": 173628, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 10.707038935105222, "num_env_steps_trained_throughput_per_sec": 10.707038935105222, "timesteps_total": 173628, "num_env_steps_sampled_lifetime": 173628, "num_agent_steps_sampled_lifetime": 173628, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 173628, "timers": {"training_iteration_time_ms": 94426.864, "restore_workers_time_ms": 0.02, "training_step_time_ms": 94426.804, "sample_time_ms": 92470.556, "load_time_ms": 0.49, "load_throughput": 2095620.114, "learn_time_ms": 1942.251, "learn_throughput": 528.253, "synch_weights_time_ms": 13.175}, "counters": {"num_env_steps_sampled": 173628, "num_env_steps_trained": 173628, "num_agent_steps_sampled": 173628, "num_agent_steps_trained": 173628}, "done": false, "episodes_total": 3755, "training_iteration": 159, "trial_id": "fe178_00005", "date": "2024-08-15_21-52-49", "timestamp": 1723780369, "time_this_iter_s": 95.82872605323792, "time_total_s": 16492.899545907974, "pid": 83044, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3549865712257006, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9809594252080035, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 566.5820035934448, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 21.290510948905112, "ram_util_percent": 11.481751824817518}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 273.1207402865092, "cur_kl_coeff": 5.931615286377677, "cur_lr": 0.0005000000000000002, "total_loss": 4.942155213157336, "policy_loss": 0.012395678072546918, "vf_loss": 4.826298003395398, "vf_explained_var": 0.06488504856824875, "kl": 0.017442388810259488, "entropy": -1.6261802315711975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 172092, "num_env_steps_trained": 172092, "num_agent_steps_sampled": 172092, "num_agent_steps_trained": 172092}, "sampler_results": {"episode_reward_max": 356.65350474321394, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 345.754169877569, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.024612035787881, "mean_inference_ms": 1.2271765091410085, "mean_action_processing_ms": 0.20145136734534952, "mean_env_wait_ms": 529.3190949721354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009882450103759766, "StateBufferConnector_ms": 0.0061194101969401045, "ViewRequirementAgentConnector_ms": 0.1663645108540853}, "num_episodes": 6, "episode_return_max": 356.65350474321394, "episode_return_min": 325.4918536224242, "episode_return_mean": 345.754169877569}, "env_runner_results": {"episode_reward_max": 356.65350474321394, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 345.754169877569, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.024612035787881, "mean_inference_ms": 1.2271765091410085, "mean_action_processing_ms": 0.20145136734534952, "mean_env_wait_ms": 529.3190949721354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009882450103759766, "StateBufferConnector_ms": 0.0061194101969401045, "ViewRequirementAgentConnector_ms": 0.1663645108540853}, "num_episodes": 6, "episode_return_max": 356.65350474321394, "episode_return_min": 325.4918536224242, "episode_return_mean": 345.754169877569}, "episode_reward_max": 356.65350474321394, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 345.754169877569, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.024612035787881, "mean_inference_ms": 1.2271765091410085, "mean_action_processing_ms": 0.20145136734534952, "mean_env_wait_ms": 529.3190949721354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009882450103759766, "StateBufferConnector_ms": 0.0061194101969401045, "ViewRequirementAgentConnector_ms": 0.1663645108540853}, "num_episodes": 6, "episode_return_max": 356.65350474321394, "episode_return_min": 325.4918536224242, "episode_return_mean": 345.754169877569, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172092, "num_agent_steps_trained": 172092, "num_env_steps_sampled": 172092, "num_env_steps_trained": 172092, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.801648172210687, "num_env_steps_trained_throughput_per_sec": 9.801648172210687, "timesteps_total": 172092, "num_env_steps_sampled_lifetime": 172092, "num_agent_steps_sampled_lifetime": 172092, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 172092, "timers": {"training_iteration_time_ms": 52644.219, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52644.166, "sample_time_ms": 49199.262, "load_time_ms": 0.728, "load_throughput": 708664.33, "learn_time_ms": 3430.058, "learn_throughput": 150.435, "synch_weights_time_ms": 13.64}, "counters": {"num_env_steps_sampled": 172092, "num_env_steps_trained": 172092, "num_agent_steps_sampled": 172092, "num_agent_steps_trained": 172092}, "done": false, "episodes_total": 3719, "training_iteration": 158, "trial_id": "fe178_00005", "date": "2024-08-15_21-54-00", "timestamp": 1723780440, "time_this_iter_s": 52.64703631401062, "time_total_s": 16362.243711471558, "pid": 43585, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3115403302647798, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.261067652977698, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 52.64703631401062, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 21.171052631578945, "ram_util_percent": 11.426315789473685}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178.38879013061523, "cur_kl_coeff": 5.931615286377677, "cur_lr": 0.0005000000000000002, "total_loss": 4.9074359426895775, "policy_loss": -0.007167192548513413, "vf_loss": 4.879073029756546, "vf_explained_var": 0.028336559732755024, "kl": 0.005989953779745418, "entropy": -1.7960776309172313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 172608, "num_env_steps_trained": 172608, "num_agent_steps_sampled": 172608, "num_agent_steps_trained": 172608}, "sampler_results": {"episode_reward_max": 369.47916305779745, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 354.5577479413408, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.731191400682235, "mean_inference_ms": 1.2265015116970603, "mean_action_processing_ms": 0.20146678563983667, "mean_env_wait_ms": 526.6659448767055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012163321177164713, "StateBufferConnector_ms": 0.006212128533257378, "ViewRequirementAgentConnector_ms": 0.16348626878526476}, "num_episodes": 12, "episode_return_max": 369.47916305779745, "episode_return_min": 325.4918536224242, "episode_return_mean": 354.5577479413408}, "env_runner_results": {"episode_reward_max": 369.47916305779745, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 354.5577479413408, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.731191400682235, "mean_inference_ms": 1.2265015116970603, "mean_action_processing_ms": 0.20146678563983667, "mean_env_wait_ms": 526.6659448767055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012163321177164713, "StateBufferConnector_ms": 0.006212128533257378, "ViewRequirementAgentConnector_ms": 0.16348626878526476}, "num_episodes": 12, "episode_return_max": 369.47916305779745, "episode_return_min": 325.4918536224242, "episode_return_mean": 354.5577479413408}, "episode_reward_max": 369.47916305779745, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 354.5577479413408, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.731191400682235, "mean_inference_ms": 1.2265015116970603, "mean_action_processing_ms": 0.20146678563983667, "mean_env_wait_ms": 526.6659448767055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012163321177164713, "StateBufferConnector_ms": 0.006212128533257378, "ViewRequirementAgentConnector_ms": 0.16348626878526476}, "num_episodes": 12, "episode_return_max": 369.47916305779745, "episode_return_min": 325.4918536224242, "episode_return_mean": 354.5577479413408, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172608, "num_agent_steps_trained": 172608, "num_env_steps_sampled": 172608, "num_env_steps_trained": 172608, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.662063522533806, "num_env_steps_trained_throughput_per_sec": 10.662063522533806, "timesteps_total": 172608, "num_env_steps_sampled_lifetime": 172608, "num_agent_steps_sampled_lifetime": 172608, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 172608, "timers": {"training_iteration_time_ms": 50520.058, "restore_workers_time_ms": 0.016, "training_step_time_ms": 50520.003, "sample_time_ms": 48470.997, "load_time_ms": 0.538, "load_throughput": 959548.155, "learn_time_ms": 2034.695, "learn_throughput": 253.601, "synch_weights_time_ms": 13.406}, "counters": {"num_env_steps_sampled": 172608, "num_env_steps_trained": 172608, "num_agent_steps_sampled": 172608, "num_agent_steps_trained": 172608}, "done": false, "episodes_total": 3731, "training_iteration": 159, "trial_id": "fe178_00005", "date": "2024-08-15_21-54-49", "timestamp": 1723780489, "time_this_iter_s": 48.39875650405884, "time_total_s": 16410.642467975616, "pid": 43585, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3115403302647798, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.261067652977698, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 101.04579281806946, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 21.417391304347827, "ram_util_percent": 11.501449275362319}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 130.86338464419046, "cur_kl_coeff": 5.931615286377677, "cur_lr": 0.0005000000000000002, "total_loss": 5.894833792249361, "policy_loss": -0.00876968630279104, "vf_loss": 5.885777978102366, "vf_explained_var": 0.040853434801101686, "kl": 0.0030051648078976236, "entropy": -1.8900268614292144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 173124, "num_env_steps_trained": 173124, "num_agent_steps_sampled": 173124, "num_agent_steps_trained": 173124}, "sampler_results": {"episode_reward_max": 372.8450711747536, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 356.4071763468854, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.029088173980687, "mean_inference_ms": 1.2292211659062746, "mean_action_processing_ms": 0.20217602007525168, "mean_env_wait_ms": 504.83787632083033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012640158335367838, "StateBufferConnector_ms": 0.006132920583089192, "ViewRequirementAgentConnector_ms": 0.16223827997843424}, "num_episodes": 12, "episode_return_max": 372.8450711747536, "episode_return_min": 325.4918536224242, "episode_return_mean": 356.4071763468854}, "env_runner_results": {"episode_reward_max": 372.8450711747536, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 356.4071763468854, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.029088173980687, "mean_inference_ms": 1.2292211659062746, "mean_action_processing_ms": 0.20217602007525168, "mean_env_wait_ms": 504.83787632083033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012640158335367838, "StateBufferConnector_ms": 0.006132920583089192, "ViewRequirementAgentConnector_ms": 0.16223827997843424}, "num_episodes": 12, "episode_return_max": 372.8450711747536, "episode_return_min": 325.4918536224242, "episode_return_mean": 356.4071763468854}, "episode_reward_max": 372.8450711747536, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 356.4071763468854, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.029088173980687, "mean_inference_ms": 1.2292211659062746, "mean_action_processing_ms": 0.20217602007525168, "mean_env_wait_ms": 504.83787632083033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012640158335367838, "StateBufferConnector_ms": 0.006132920583089192, "ViewRequirementAgentConnector_ms": 0.16223827997843424}, "num_episodes": 12, "episode_return_max": 372.8450711747536, "episode_return_min": 325.4918536224242, "episode_return_mean": 356.4071763468854, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173124, "num_agent_steps_trained": 173124, "num_env_steps_sampled": 173124, "num_env_steps_trained": 173124, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.941038364265609, "num_env_steps_trained_throughput_per_sec": 14.941038364265609, "timesteps_total": 173124, "num_env_steps_sampled_lifetime": 173124, "num_agent_steps_sampled_lifetime": 173124, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 173124, "timers": {"training_iteration_time_ms": 45191.96, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45191.907, "sample_time_ms": 43610.464, "load_time_ms": 0.466, "load_throughput": 1107794.334, "learn_time_ms": 1567.462, "learn_throughput": 329.195, "synch_weights_time_ms": 13.192}, "counters": {"num_env_steps_sampled": 173124, "num_env_steps_trained": 173124, "num_agent_steps_sampled": 173124, "num_agent_steps_trained": 173124}, "done": false, "episodes_total": 3743, "training_iteration": 160, "trial_id": "fe178_00005", "date": "2024-08-15_21-55-23", "timestamp": 1723780523, "time_this_iter_s": 34.53889012336731, "time_total_s": 16445.181358098984, "pid": 43585, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3115403302647798, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.261067652977698, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 135.58468294143677, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.43061224489796, "ram_util_percent": 11.54081632653061}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 139.4202690601349, "cur_kl_coeff": 2.9658076431888385, "cur_lr": 0.0005000000000000002, "total_loss": 4.597823293010394, "policy_loss": 0.009417019318789244, "vf_loss": 4.552561461925507, "vf_explained_var": 0.02173702816168467, "kl": 0.012086035813752736, "entropy": -1.5848875522613526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 173640, "num_env_steps_trained": 173640, "num_agent_steps_sampled": 173640, "num_agent_steps_trained": 173640}, "sampler_results": {"episode_reward_max": 372.8450711747536, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 355.9244153356723, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.043696456300405, "mean_inference_ms": 1.229144910088664, "mean_action_processing_ms": 0.20228884624118165, "mean_env_wait_ms": 500.29920851053674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013394488228691949, "StateBufferConnector_ms": 0.006171067555745442, "ViewRequirementAgentConnector_ms": 0.16263127326965332}, "num_episodes": 6, "episode_return_max": 372.8450711747536, "episode_return_min": 325.4918536224242, "episode_return_mean": 355.9244153356723}, "env_runner_results": {"episode_reward_max": 372.8450711747536, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 355.9244153356723, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.043696456300405, "mean_inference_ms": 1.229144910088664, "mean_action_processing_ms": 0.20228884624118165, "mean_env_wait_ms": 500.29920851053674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013394488228691949, "StateBufferConnector_ms": 0.006171067555745442, "ViewRequirementAgentConnector_ms": 0.16263127326965332}, "num_episodes": 6, "episode_return_max": 372.8450711747536, "episode_return_min": 325.4918536224242, "episode_return_mean": 355.9244153356723}, "episode_reward_max": 372.8450711747536, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 355.9244153356723, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.043696456300405, "mean_inference_ms": 1.229144910088664, "mean_action_processing_ms": 0.20228884624118165, "mean_env_wait_ms": 500.29920851053674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013394488228691949, "StateBufferConnector_ms": 0.006171067555745442, "ViewRequirementAgentConnector_ms": 0.16263127326965332}, "num_episodes": 6, "episode_return_max": 372.8450711747536, "episode_return_min": 325.4918536224242, "episode_return_mean": 355.9244153356723, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173640, "num_agent_steps_trained": 173640, "num_env_steps_sampled": 173640, "num_env_steps_trained": 173640, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 11.202204999027405, "num_env_steps_trained_throughput_per_sec": 11.202204999027405, "timesteps_total": 173640, "num_env_steps_sampled_lifetime": 173640, "num_agent_steps_sampled_lifetime": 173640, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 173640, "timers": {"training_iteration_time_ms": 45409.563, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45409.509, "sample_time_ms": 44063.848, "load_time_ms": 0.428, "load_throughput": 1205045.024, "learn_time_ms": 1331.828, "learn_throughput": 387.437, "synch_weights_time_ms": 13.105}, "counters": {"num_env_steps_sampled": 173640, "num_env_steps_trained": 173640, "num_agent_steps_sampled": 173640, "num_agent_steps_trained": 173640}, "done": false, "episodes_total": 3749, "training_iteration": 161, "trial_id": "fe178_00005", "date": "2024-08-15_21-56-09", "timestamp": 1723780569, "time_this_iter_s": 46.065826177597046, "time_total_s": 16491.24718427658, "pid": 43585, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3115403302647798, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.261067652977698, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 181.6505091190338, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.943939393939395, "ram_util_percent": 11.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 64.38438167572022, "cur_kl_coeff": 2.9658076431888385, "cur_lr": 0.0005000000000000002, "total_loss": 4.61704929570357, "policy_loss": -0.003392920394738515, "vf_loss": 4.6158775399128595, "vf_explained_var": 0.02272534966468811, "kl": 0.0015391015315837295, "entropy": -1.6224555919567745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 174156, "num_env_steps_trained": 174156, "num_agent_steps_sampled": 174156, "num_agent_steps_trained": 174156}, "sampler_results": {"episode_reward_max": 372.8450711747536, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 353.44854734290965, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.11314713775104, "mean_inference_ms": 1.2277972695855783, "mean_action_processing_ms": 0.20229299664169043, "mean_env_wait_ms": 496.1854830817368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013423959414164225, "StateBufferConnector_ms": 0.006113946437835693, "ViewRequirementAgentConnector_ms": 0.1613969604174296}, "num_episodes": 12, "episode_return_max": 372.8450711747536, "episode_return_min": 325.4918536224242, "episode_return_mean": 353.44854734290965}, "env_runner_results": {"episode_reward_max": 372.8450711747536, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 353.44854734290965, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.11314713775104, "mean_inference_ms": 1.2277972695855783, "mean_action_processing_ms": 0.20229299664169043, "mean_env_wait_ms": 496.1854830817368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013423959414164225, "StateBufferConnector_ms": 0.006113946437835693, "ViewRequirementAgentConnector_ms": 0.1613969604174296}, "num_episodes": 12, "episode_return_max": 372.8450711747536, "episode_return_min": 325.4918536224242, "episode_return_mean": 353.44854734290965}, "episode_reward_max": 372.8450711747536, "episode_reward_min": 325.4918536224242, "episode_reward_mean": 353.44854734290965, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.11314713775104, "mean_inference_ms": 1.2277972695855783, "mean_action_processing_ms": 0.20229299664169043, "mean_env_wait_ms": 496.1854830817368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013423959414164225, "StateBufferConnector_ms": 0.006113946437835693, "ViewRequirementAgentConnector_ms": 0.1613969604174296}, "num_episodes": 12, "episode_return_max": 372.8450711747536, "episode_return_min": 325.4918536224242, "episode_return_mean": 353.44854734290965, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174156, "num_agent_steps_trained": 174156, "num_env_steps_sampled": 174156, "num_env_steps_trained": 174156, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.964559135895854, "num_env_steps_trained_throughput_per_sec": 10.964559135895854, "timesteps_total": 174156, "num_env_steps_sampled_lifetime": 174156, "num_agent_steps_sampled_lifetime": 174156, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 174156, "timers": {"training_iteration_time_ms": 45739.796, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45739.743, "sample_time_ms": 44523.565, "load_time_ms": 0.411, "load_throughput": 1256537.891, "learn_time_ms": 1202.31, "learn_throughput": 429.174, "synch_weights_time_ms": 13.159}, "counters": {"num_env_steps_sampled": 174156, "num_env_steps_trained": 174156, "num_agent_steps_sampled": 174156, "num_agent_steps_trained": 174156}, "done": false, "episodes_total": 3761, "training_iteration": 162, "trial_id": "fe178_00005", "date": "2024-08-15_21-56-56", "timestamp": 1723780616, "time_this_iter_s": 47.06440877914429, "time_total_s": 16538.311593055725, "pid": 43585, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3115403302647798, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.261067652977698, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 228.7149178981781, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.97761194029851, "ram_util_percent": 11.341791044776118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 61.300936190287274, "cur_kl_coeff": 1.4829038215944192, "cur_lr": 0.0005000000000000002, "total_loss": 4.9820737133423485, "policy_loss": -0.012939192447811365, "vf_loss": 4.991055544217428, "vf_explained_var": 0.015078239639600118, "kl": 0.0026686703952434197, "entropy": -1.7273933231830596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 174672, "num_env_steps_trained": 174672, "num_agent_steps_sampled": 174672, "num_agent_steps_trained": 174672}, "sampler_results": {"episode_reward_max": 372.8450711747536, "episode_reward_min": 316.9058023063109, "episode_reward_mean": 351.97507825699176, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745, 335.4634390116374, 316.9058023063109, 351.29169303835033, 350.37608251325884, 363.3657616078132, 354.45358583789806, 356.87662706250075, 338.09664664765825, 352.9216409740781, 345.1632066194408, 360.0690254145084, 327.990911926388], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.186178452955002, "mean_inference_ms": 1.2273830421771683, "mean_action_processing_ms": 0.20241216344158738, "mean_env_wait_ms": 498.75815274105236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013626019159952799, "StateBufferConnector_ms": 0.006108681360880534, "ViewRequirementAgentConnector_ms": 0.16220966974894205}, "num_episodes": 12, "episode_return_max": 372.8450711747536, "episode_return_min": 316.9058023063109, "episode_return_mean": 351.97507825699176}, "env_runner_results": {"episode_reward_max": 372.8450711747536, "episode_reward_min": 316.9058023063109, "episode_reward_mean": 351.97507825699176, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745, 335.4634390116374, 316.9058023063109, 351.29169303835033, 350.37608251325884, 363.3657616078132, 354.45358583789806, 356.87662706250075, 338.09664664765825, 352.9216409740781, 345.1632066194408, 360.0690254145084, 327.990911926388], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.186178452955002, "mean_inference_ms": 1.2273830421771683, "mean_action_processing_ms": 0.20241216344158738, "mean_env_wait_ms": 498.75815274105236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013626019159952799, "StateBufferConnector_ms": 0.006108681360880534, "ViewRequirementAgentConnector_ms": 0.16220966974894205}, "num_episodes": 12, "episode_return_max": 372.8450711747536, "episode_return_min": 316.9058023063109, "episode_return_mean": 351.97507825699176}, "episode_reward_max": 372.8450711747536, "episode_reward_min": 316.9058023063109, "episode_reward_mean": 351.97507825699176, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745, 335.4634390116374, 316.9058023063109, 351.29169303835033, 350.37608251325884, 363.3657616078132, 354.45358583789806, 356.87662706250075, 338.09664664765825, 352.9216409740781, 345.1632066194408, 360.0690254145084, 327.990911926388], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.186178452955002, "mean_inference_ms": 1.2273830421771683, "mean_action_processing_ms": 0.20241216344158738, "mean_env_wait_ms": 498.75815274105236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013626019159952799, "StateBufferConnector_ms": 0.006108681360880534, "ViewRequirementAgentConnector_ms": 0.16220966974894205}, "num_episodes": 12, "episode_return_max": 372.8450711747536, "episode_return_min": 316.9058023063109, "episode_return_mean": 351.97507825699176, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174672, "num_agent_steps_trained": 174672, "num_env_steps_sampled": 174672, "num_env_steps_trained": 174672, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.845036823919564, "num_env_steps_trained_throughput_per_sec": 8.845036823919564, "timesteps_total": 174672, "num_env_steps_sampled_lifetime": 174672, "num_agent_steps_sampled_lifetime": 174672, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 174672, "timers": {"training_iteration_time_ms": 47839.466, "restore_workers_time_ms": 0.017, "training_step_time_ms": 47839.412, "sample_time_ms": 46715.726, "load_time_ms": 0.402, "load_throughput": 1283412.254, "learn_time_ms": 1109.818, "learn_throughput": 464.941, "synch_weights_time_ms": 13.171}, "counters": {"num_env_steps_sampled": 174672, "num_env_steps_trained": 174672, "num_agent_steps_sampled": 174672, "num_agent_steps_trained": 174672}, "done": false, "episodes_total": 3773, "training_iteration": 163, "trial_id": "fe178_00005", "date": "2024-08-15_21-57-55", "timestamp": 1723780675, "time_this_iter_s": 58.34126663208008, "time_total_s": 16596.652859687805, "pid": 43585, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3115403302647798, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.261067652977698, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 287.0561845302582, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.771428571428572, "ram_util_percent": 11.26428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.274811840057374, "cur_kl_coeff": 0.7414519107972096, "cur_lr": 0.0005000000000000002, "total_loss": 5.036957163612048, "policy_loss": -0.002753522495428721, "vf_loss": 5.036991074681282, "vf_explained_var": 0.009585923453172048, "kl": 0.0036678879649169956, "entropy": -1.873412773013115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 175188, "num_env_steps_trained": 175188, "num_agent_steps_sampled": 175188, "num_agent_steps_trained": 175188}, "sampler_results": {"episode_reward_max": 373.28834927295463, "episode_reward_min": 316.9058023063109, "episode_reward_mean": 352.70863038323193, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745, 335.4634390116374, 316.9058023063109, 351.29169303835033, 350.37608251325884, 363.3657616078132, 354.45358583789806, 356.87662706250075, 338.09664664765825, 352.9216409740781, 345.1632066194408, 360.0690254145084, 327.990911926388, 340.62266817869363, 360.6358854090409, 350.56127225969277, 373.28834927295463, 358.67376864603233, 354.8330165702076, 349.0254882081631, 362.9202490679437, 353.73644287669777, 349.98162023800285, 363.4798509509952, 358.7580804947663], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2525653982293, "mean_inference_ms": 1.2269158844434889, "mean_action_processing_ms": 0.20250869358642604, "mean_env_wait_ms": 501.0488614370883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012981891632080078, "StateBufferConnector_ms": 0.006088283326890733, "ViewRequirementAgentConnector_ms": 0.16175740294986302}, "num_episodes": 12, "episode_return_max": 373.28834927295463, "episode_return_min": 316.9058023063109, "episode_return_mean": 352.70863038323193}, "env_runner_results": {"episode_reward_max": 373.28834927295463, "episode_reward_min": 316.9058023063109, "episode_reward_mean": 352.70863038323193, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745, 335.4634390116374, 316.9058023063109, 351.29169303835033, 350.37608251325884, 363.3657616078132, 354.45358583789806, 356.87662706250075, 338.09664664765825, 352.9216409740781, 345.1632066194408, 360.0690254145084, 327.990911926388, 340.62266817869363, 360.6358854090409, 350.56127225969277, 373.28834927295463, 358.67376864603233, 354.8330165702076, 349.0254882081631, 362.9202490679437, 353.73644287669777, 349.98162023800285, 363.4798509509952, 358.7580804947663], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2525653982293, "mean_inference_ms": 1.2269158844434889, "mean_action_processing_ms": 0.20250869358642604, "mean_env_wait_ms": 501.0488614370883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012981891632080078, "StateBufferConnector_ms": 0.006088283326890733, "ViewRequirementAgentConnector_ms": 0.16175740294986302}, "num_episodes": 12, "episode_return_max": 373.28834927295463, "episode_return_min": 316.9058023063109, "episode_return_mean": 352.70863038323193}, "episode_reward_max": 373.28834927295463, "episode_reward_min": 316.9058023063109, "episode_reward_mean": 352.70863038323193, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 3600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745, 335.4634390116374, 316.9058023063109, 351.29169303835033, 350.37608251325884, 363.3657616078132, 354.45358583789806, 356.87662706250075, 338.09664664765825, 352.9216409740781, 345.1632066194408, 360.0690254145084, 327.990911926388, 340.62266817869363, 360.6358854090409, 350.56127225969277, 373.28834927295463, 358.67376864603233, 354.8330165702076, 349.0254882081631, 362.9202490679437, 353.73644287669777, 349.98162023800285, 363.4798509509952, 358.7580804947663], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2525653982293, "mean_inference_ms": 1.2269158844434889, "mean_action_processing_ms": 0.20250869358642604, "mean_env_wait_ms": 501.0488614370883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012981891632080078, "StateBufferConnector_ms": 0.006088283326890733, "ViewRequirementAgentConnector_ms": 0.16175740294986302}, "num_episodes": 12, "episode_return_max": 373.28834927295463, "episode_return_min": 316.9058023063109, "episode_return_mean": 352.70863038323193, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175188, "num_agent_steps_trained": 175188, "num_env_steps_sampled": 175188, "num_env_steps_trained": 175188, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.5137898963047, "num_env_steps_trained_throughput_per_sec": 10.5137898963047, "timesteps_total": 175188, "num_env_steps_sampled_lifetime": 175188, "num_agent_steps_sampled_lifetime": 175188, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 175188, "timers": {"training_iteration_time_ms": 48016.459, "restore_workers_time_ms": 0.017, "training_step_time_ms": 48016.406, "sample_time_ms": 46955.787, "load_time_ms": 0.394, "load_throughput": 1308162.166, "learn_time_ms": 1046.842, "learn_throughput": 492.911, "synch_weights_time_ms": 13.099}, "counters": {"num_env_steps_sampled": 175188, "num_env_steps_trained": 175188, "num_agent_steps_sampled": 175188, "num_agent_steps_trained": 175188}, "done": false, "episodes_total": 3785, "training_iteration": 164, "trial_id": "fe178_00005", "date": "2024-08-15_21-58-44", "timestamp": 1723780724, "time_this_iter_s": 49.08189272880554, "time_total_s": 16645.73475241661, "pid": 43585, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3115403302647798, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.261067652977698, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 336.1380772590637, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.335714285714282, "ram_util_percent": 11.395714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.74314707120259, "cur_kl_coeff": 0.3707259553986048, "cur_lr": 0.0005000000000000002, "total_loss": 4.690235340595246, "policy_loss": -0.009690340980887413, "vf_loss": 4.69749831656615, "vf_explained_var": 0.013433361053466797, "kl": 0.0065476648312872915, "entropy": -1.730981935063998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 175704, "num_env_steps_trained": 175704, "num_agent_steps_sampled": 175704, "num_agent_steps_trained": 175704}, "sampler_results": {"episode_reward_max": 373.28834927295463, "episode_reward_min": 316.9058023063109, "episode_reward_mean": 352.1768542003749, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745, 335.4634390116374, 316.9058023063109, 351.29169303835033, 350.37608251325884, 363.3657616078132, 354.45358583789806, 356.87662706250075, 338.09664664765825, 352.9216409740781, 345.1632066194408, 360.0690254145084, 327.990911926388, 340.62266817869363, 360.6358854090409, 350.56127225969277, 373.28834927295463, 358.67376864603233, 354.8330165702076, 349.0254882081631, 362.9202490679437, 353.73644287669777, 349.98162023800285, 363.4798509509952, 358.7580804947663, 356.81337231721204, 343.9048833613238, 350.50520233085257, 337.8295641689913, 336.28361446429454, 349.43660339387054], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.262774666373097, "mean_inference_ms": 1.2265030123957732, "mean_action_processing_ms": 0.20251097201248136, "mean_env_wait_ms": 500.97859412651377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012708321595803285, "StateBufferConnector_ms": 0.006052163931039663, "ViewRequirementAgentConnector_ms": 0.16136903029221755}, "num_episodes": 6, "episode_return_max": 373.28834927295463, "episode_return_min": 316.9058023063109, "episode_return_mean": 352.1768542003749}, "env_runner_results": {"episode_reward_max": 373.28834927295463, "episode_reward_min": 316.9058023063109, "episode_reward_mean": 352.1768542003749, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745, 335.4634390116374, 316.9058023063109, 351.29169303835033, 350.37608251325884, 363.3657616078132, 354.45358583789806, 356.87662706250075, 338.09664664765825, 352.9216409740781, 345.1632066194408, 360.0690254145084, 327.990911926388, 340.62266817869363, 360.6358854090409, 350.56127225969277, 373.28834927295463, 358.67376864603233, 354.8330165702076, 349.0254882081631, 362.9202490679437, 353.73644287669777, 349.98162023800285, 363.4798509509952, 358.7580804947663, 356.81337231721204, 343.9048833613238, 350.50520233085257, 337.8295641689913, 336.28361446429454, 349.43660339387054], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.262774666373097, "mean_inference_ms": 1.2265030123957732, "mean_action_processing_ms": 0.20251097201248136, "mean_env_wait_ms": 500.97859412651377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012708321595803285, "StateBufferConnector_ms": 0.006052163931039663, "ViewRequirementAgentConnector_ms": 0.16136903029221755}, "num_episodes": 6, "episode_return_max": 373.28834927295463, "episode_return_min": 316.9058023063109, "episode_return_mean": 352.1768542003749}, "episode_reward_max": 373.28834927295463, "episode_reward_min": 316.9058023063109, "episode_reward_mean": 352.1768542003749, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745, 335.4634390116374, 316.9058023063109, 351.29169303835033, 350.37608251325884, 363.3657616078132, 354.45358583789806, 356.87662706250075, 338.09664664765825, 352.9216409740781, 345.1632066194408, 360.0690254145084, 327.990911926388, 340.62266817869363, 360.6358854090409, 350.56127225969277, 373.28834927295463, 358.67376864603233, 354.8330165702076, 349.0254882081631, 362.9202490679437, 353.73644287669777, 349.98162023800285, 363.4798509509952, 358.7580804947663, 356.81337231721204, 343.9048833613238, 350.50520233085257, 337.8295641689913, 336.28361446429454, 349.43660339387054], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.262774666373097, "mean_inference_ms": 1.2265030123957732, "mean_action_processing_ms": 0.20251097201248136, "mean_env_wait_ms": 500.97859412651377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012708321595803285, "StateBufferConnector_ms": 0.006052163931039663, "ViewRequirementAgentConnector_ms": 0.16136903029221755}, "num_episodes": 6, "episode_return_max": 373.28834927295463, "episode_return_min": 316.9058023063109, "episode_return_mean": 352.1768542003749, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175704, "num_agent_steps_trained": 175704, "num_env_steps_sampled": 175704, "num_env_steps_trained": 175704, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.303462979296148, "num_env_steps_trained_throughput_per_sec": 13.303462979296148, "timesteps_total": 175704, "num_env_steps_sampled_lifetime": 175704, "num_agent_steps_sampled_lifetime": 175704, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 175704, "timers": {"training_iteration_time_ms": 46862.765, "restore_workers_time_ms": 0.017, "training_step_time_ms": 46862.713, "sample_time_ms": 45852.805, "load_time_ms": 0.387, "load_throughput": 1333288.689, "learn_time_ms": 996.22, "learn_throughput": 517.958, "synch_weights_time_ms": 13.028}, "counters": {"num_env_steps_sampled": 175704, "num_env_steps_trained": 175704, "num_agent_steps_sampled": 175704, "num_agent_steps_trained": 175704}, "done": false, "episodes_total": 3791, "training_iteration": 165, "trial_id": "fe178_00005", "date": "2024-08-15_21-59-23", "timestamp": 1723780763, "time_this_iter_s": 38.790353775024414, "time_total_s": 16684.525106191635, "pid": 43585, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3115403302647798, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.261067652977698, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 374.92843103408813, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.416363636363638, "ram_util_percent": 11.405454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 55.52559757232666, "cur_kl_coeff": 0.3707259553986048, "cur_lr": 0.0005000000000000002, "total_loss": 4.804331986109416, "policy_loss": -0.014306310440103213, "vf_loss": 4.816884829600652, "vf_explained_var": 0.027653873960177103, "kl": 0.004729822065811728, "entropy": -1.8011770447095234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 176220, "num_env_steps_trained": 176220, "num_agent_steps_sampled": 176220, "num_agent_steps_trained": 176220}, "sampler_results": {"episode_reward_max": 373.28834927295463, "episode_reward_min": 316.9058023063109, "episode_reward_mean": 352.21023188886585, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745, 335.4634390116374, 316.9058023063109, 351.29169303835033, 350.37608251325884, 363.3657616078132, 354.45358583789806, 356.87662706250075, 338.09664664765825, 352.9216409740781, 345.1632066194408, 360.0690254145084, 327.990911926388, 340.62266817869363, 360.6358854090409, 350.56127225969277, 373.28834927295463, 358.67376864603233, 354.8330165702076, 349.0254882081631, 362.9202490679437, 353.73644287669777, 349.98162023800285, 363.4798509509952, 358.7580804947663, 356.81337231721204, 343.9048833613238, 350.50520233085257, 337.8295641689913, 336.28361446429454, 349.43660339387054, 346.05929669655507, 332.8206838598536, 349.3169668671585, 349.1949959271463, 358.5781465113364, 335.7305211726007, 370.0988738782515, 367.12153687003007, 359.1817564811736, 355.79319180719176, 348.5986489357952, 356.63162336158405], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.291406066209053, "mean_inference_ms": 1.2257047754893595, "mean_action_processing_ms": 0.20248401278947137, "mean_env_wait_ms": 500.5750256409165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012240144941541884, "StateBufferConnector_ms": 0.006017420026991103, "ViewRequirementAgentConnector_ms": 0.16093863381279838}, "num_episodes": 12, "episode_return_max": 373.28834927295463, "episode_return_min": 316.9058023063109, "episode_return_mean": 352.21023188886585}, "env_runner_results": {"episode_reward_max": 373.28834927295463, "episode_reward_min": 316.9058023063109, "episode_reward_mean": 352.21023188886585, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745, 335.4634390116374, 316.9058023063109, 351.29169303835033, 350.37608251325884, 363.3657616078132, 354.45358583789806, 356.87662706250075, 338.09664664765825, 352.9216409740781, 345.1632066194408, 360.0690254145084, 327.990911926388, 340.62266817869363, 360.6358854090409, 350.56127225969277, 373.28834927295463, 358.67376864603233, 354.8330165702076, 349.0254882081631, 362.9202490679437, 353.73644287669777, 349.98162023800285, 363.4798509509952, 358.7580804947663, 356.81337231721204, 343.9048833613238, 350.50520233085257, 337.8295641689913, 336.28361446429454, 349.43660339387054, 346.05929669655507, 332.8206838598536, 349.3169668671585, 349.1949959271463, 358.5781465113364, 335.7305211726007, 370.0988738782515, 367.12153687003007, 359.1817564811736, 355.79319180719176, 348.5986489357952, 356.63162336158405], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.291406066209053, "mean_inference_ms": 1.2257047754893595, "mean_action_processing_ms": 0.20248401278947137, "mean_env_wait_ms": 500.5750256409165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012240144941541884, "StateBufferConnector_ms": 0.006017420026991103, "ViewRequirementAgentConnector_ms": 0.16093863381279838}, "num_episodes": 12, "episode_return_max": 373.28834927295463, "episode_return_min": 316.9058023063109, "episode_return_mean": 352.21023188886585}, "episode_reward_max": 373.28834927295463, "episode_reward_min": 316.9058023063109, "episode_reward_mean": 352.21023188886585, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 4500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [354.34365234375036, 325.4918536224242, 349.8508335344974, 356.65350474321394, 351.81424640527507, 336.3709286162531, 340.3999542369397, 361.5283971132528, 368.33255938097324, 369.47916305779745, 354.42910220029813, 350.39205509289, 358.53176146626464, 364.13179988117975, 366.81623033047384, 362.4842811190069, 366.1589287502082, 344.83021104943543, 365.81572766295477, 372.8450711747536, 355.286421633961, 348.45206051947383, 364.50557551630527, 343.197883281929, 344.5463259580609, 358.5255717378628, 365.0736750999572, 358.7985420641759, 369.70119625741535, 363.4277765555803, 356.10068215494346, 341.7336254770367, 370.42324069350855, 344.1172609424985, 357.9446783696998, 350.7441740399472, 350.3968444264262, 328.51696336556824, 346.89389106464415, 350.6023527744601, 330.20279391051537, 372.7941284179685, 342.9154050658669, 342.0682010588546, 326.6069647691656, 341.0150045742854, 367.7914133644137, 352.44735758329745, 335.4634390116374, 316.9058023063109, 351.29169303835033, 350.37608251325884, 363.3657616078132, 354.45358583789806, 356.87662706250075, 338.09664664765825, 352.9216409740781, 345.1632066194408, 360.0690254145084, 327.990911926388, 340.62266817869363, 360.6358854090409, 350.56127225969277, 373.28834927295463, 358.67376864603233, 354.8330165702076, 349.0254882081631, 362.9202490679437, 353.73644287669777, 349.98162023800285, 363.4798509509952, 358.7580804947663, 356.81337231721204, 343.9048833613238, 350.50520233085257, 337.8295641689913, 336.28361446429454, 349.43660339387054, 346.05929669655507, 332.8206838598536, 349.3169668671585, 349.1949959271463, 358.5781465113364, 335.7305211726007, 370.0988738782515, 367.12153687003007, 359.1817564811736, 355.79319180719176, 348.5986489357952, 356.63162336158405], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.291406066209053, "mean_inference_ms": 1.2257047754893595, "mean_action_processing_ms": 0.20248401278947137, "mean_env_wait_ms": 500.5750256409165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012240144941541884, "StateBufferConnector_ms": 0.006017420026991103, "ViewRequirementAgentConnector_ms": 0.16093863381279838}, "num_episodes": 12, "episode_return_max": 373.28834927295463, "episode_return_min": 316.9058023063109, "episode_return_mean": 352.21023188886585, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176220, "num_agent_steps_trained": 176220, "num_env_steps_sampled": 176220, "num_env_steps_trained": 176220, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.853555388498037, "num_env_steps_trained_throughput_per_sec": 10.853555388498037, "timesteps_total": 176220, "num_env_steps_sampled_lifetime": 176220, "num_agent_steps_sampled_lifetime": 176220, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 176220, "timers": {"training_iteration_time_ms": 46938.239, "restore_workers_time_ms": 0.016, "training_step_time_ms": 46938.189, "sample_time_ms": 45970.611, "load_time_ms": 0.379, "load_throughput": 1363266.222, "learn_time_ms": 953.869, "learn_throughput": 540.955, "synch_weights_time_ms": 13.062}, "counters": {"num_env_steps_sampled": 176220, "num_env_steps_trained": 176220, "num_agent_steps_sampled": 176220, "num_agent_steps_trained": 176220}, "done": false, "episodes_total": 3803, "training_iteration": 166, "trial_id": "fe178_00005", "date": "2024-08-15_22-00-10", "timestamp": 1723780810, "time_this_iter_s": 47.545528411865234, "time_total_s": 16732.0706346035, "pid": 43585, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3115403302647798, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.261067652977698, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 422.47395944595337, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.36470588235294, "ram_util_percent": 11.46470588235294}}
