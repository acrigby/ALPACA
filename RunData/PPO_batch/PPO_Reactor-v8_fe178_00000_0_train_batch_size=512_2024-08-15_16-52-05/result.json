{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4523233900467556, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.381730405489604, "policy_loss": -0.04318840399694939, "vf_loss": 7.415445001920064, "vf_explained_var": 0.006163447598616282, "kl": 0.009473775809359118, "entropy": 1.3627780497074127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 516, "num_env_steps_trained": 516, "num_agent_steps_sampled": 516, "num_agent_steps_trained": 516}, "sampler_results": {"episode_reward_max": 47.67670261326104, "episode_reward_min": -34.13398437500007, "episode_reward_mean": -6.702261942011475, "episode_len_mean": 6.904109589041096, "episode_media": {}, "episodes_this_iter": 73, "episodes_timesteps_total": 504, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.521820424376912, 0.6889736495175356, -30.502697753906318, -3.3700195312500227, 15.63959893921691, -3.1211970076572015, 15.250449828825069, -12.102586027908615, -1.0635864257811818, -10.988447416529269, -8.632946777343818, -24.436263941651077, -1.6624537896281595, -10.02839362789922, -28.496447753906182, -10.97042641956807, -0.968798218329141, -8.425451660156341, 21.63529877969347, -33.42725830078132, 5.897741243979496, -26.458850097656182, -26.789624023437568, 12.294726562499818, -1.8161010742186363, 7.136604725456948, 4.900318863277107, 4.097574368889411, -25.608276367187386, -6.85563547673992, -12.427548903264167, -13.413589477196297, 47.67670261326104, -22.97343934348845, -22.98626922638175, -7.882300942305619, -25.759338378906136, -3.5241429727212363, -9.043968434548276, 3.2502969929167875, -34.13398437500007, -28.395700634894993, 36.44919631532994, -22.845141601562432, 16.869122721728843, 8.395374043199737, -20.9066162109375, 4.962346498878787, -24.777038574218636, -3.740576171875091, -25.208813476562568, -24.632998517996953, -11.948662476654889, 8.745788489309291, -0.4059361072257843, -3.699816894531182, -22.109359660076507, -1.057809711941971, -21.090180619203693, -0.46989626289871467, -10.411459236797455, -8.092319422773414, 23.590794097689454, -17.903163086695827, -13.721057817951248, -22.95303955078134, -8.424328613281432, -15.025220220653068, -15.914282805349629, -4.167183390306107, -14.616357421875023, 8.286621093750114, 6.83253021375873], "episode_lengths": [18, 5, 3, 7, 18, 4, 6, 11, 3, 8, 3, 4, 7, 5, 3, 3, 10, 4, 9, 3, 7, 3, 3, 8, 5, 5, 6, 9, 5, 14, 6, 3, 26, 13, 3, 8, 5, 5, 5, 5, 3, 6, 23, 3, 8, 5, 6, 10, 5, 4, 3, 9, 8, 7, 3, 13, 4, 7, 4, 9, 4, 3, 12, 3, 3, 10, 8, 11, 3, 6, 5, 7, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.128110485890772, "mean_inference_ms": 1.3131162835338737, "mean_action_processing_ms": 0.21351466796807722, "mean_env_wait_ms": 695.3759891294978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010424879587948594, "StateBufferConnector_ms": 0.02810642962404945, "ViewRequirementAgentConnector_ms": 0.1945501048815305}, "num_episodes": 73, "episode_return_max": 47.67670261326104, "episode_return_min": -34.13398437500007, "episode_return_mean": -6.702261942011475}, "env_runner_results": {"episode_reward_max": 47.67670261326104, "episode_reward_min": -34.13398437500007, "episode_reward_mean": -6.702261942011475, "episode_len_mean": 6.904109589041096, "episode_media": {}, "episodes_this_iter": 73, "episodes_timesteps_total": 504, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.521820424376912, 0.6889736495175356, -30.502697753906318, -3.3700195312500227, 15.63959893921691, -3.1211970076572015, 15.250449828825069, -12.102586027908615, -1.0635864257811818, -10.988447416529269, -8.632946777343818, -24.436263941651077, -1.6624537896281595, -10.02839362789922, -28.496447753906182, -10.97042641956807, -0.968798218329141, -8.425451660156341, 21.63529877969347, -33.42725830078132, 5.897741243979496, -26.458850097656182, -26.789624023437568, 12.294726562499818, -1.8161010742186363, 7.136604725456948, 4.900318863277107, 4.097574368889411, -25.608276367187386, -6.85563547673992, -12.427548903264167, -13.413589477196297, 47.67670261326104, -22.97343934348845, -22.98626922638175, -7.882300942305619, -25.759338378906136, -3.5241429727212363, -9.043968434548276, 3.2502969929167875, -34.13398437500007, -28.395700634894993, 36.44919631532994, -22.845141601562432, 16.869122721728843, 8.395374043199737, -20.9066162109375, 4.962346498878787, -24.777038574218636, -3.740576171875091, -25.208813476562568, -24.632998517996953, -11.948662476654889, 8.745788489309291, -0.4059361072257843, -3.699816894531182, -22.109359660076507, -1.057809711941971, -21.090180619203693, -0.46989626289871467, -10.411459236797455, -8.092319422773414, 23.590794097689454, -17.903163086695827, -13.721057817951248, -22.95303955078134, -8.424328613281432, -15.025220220653068, -15.914282805349629, -4.167183390306107, -14.616357421875023, 8.286621093750114, 6.83253021375873], "episode_lengths": [18, 5, 3, 7, 18, 4, 6, 11, 3, 8, 3, 4, 7, 5, 3, 3, 10, 4, 9, 3, 7, 3, 3, 8, 5, 5, 6, 9, 5, 14, 6, 3, 26, 13, 3, 8, 5, 5, 5, 5, 3, 6, 23, 3, 8, 5, 6, 10, 5, 4, 3, 9, 8, 7, 3, 13, 4, 7, 4, 9, 4, 3, 12, 3, 3, 10, 8, 11, 3, 6, 5, 7, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.128110485890772, "mean_inference_ms": 1.3131162835338737, "mean_action_processing_ms": 0.21351466796807722, "mean_env_wait_ms": 695.3759891294978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010424879587948594, "StateBufferConnector_ms": 0.02810642962404945, "ViewRequirementAgentConnector_ms": 0.1945501048815305}, "num_episodes": 73, "episode_return_max": 47.67670261326104, "episode_return_min": -34.13398437500007, "episode_return_mean": -6.702261942011475}, "episode_reward_max": 47.67670261326104, "episode_reward_min": -34.13398437500007, "episode_reward_mean": -6.702261942011475, "episode_len_mean": 6.904109589041096, "episodes_this_iter": 73, "episodes_timesteps_total": 504, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.521820424376912, 0.6889736495175356, -30.502697753906318, -3.3700195312500227, 15.63959893921691, -3.1211970076572015, 15.250449828825069, -12.102586027908615, -1.0635864257811818, -10.988447416529269, -8.632946777343818, -24.436263941651077, -1.6624537896281595, -10.02839362789922, -28.496447753906182, -10.97042641956807, -0.968798218329141, -8.425451660156341, 21.63529877969347, -33.42725830078132, 5.897741243979496, -26.458850097656182, -26.789624023437568, 12.294726562499818, -1.8161010742186363, 7.136604725456948, 4.900318863277107, 4.097574368889411, -25.608276367187386, -6.85563547673992, -12.427548903264167, -13.413589477196297, 47.67670261326104, -22.97343934348845, -22.98626922638175, -7.882300942305619, -25.759338378906136, -3.5241429727212363, -9.043968434548276, 3.2502969929167875, -34.13398437500007, -28.395700634894993, 36.44919631532994, -22.845141601562432, 16.869122721728843, 8.395374043199737, -20.9066162109375, 4.962346498878787, -24.777038574218636, -3.740576171875091, -25.208813476562568, -24.632998517996953, -11.948662476654889, 8.745788489309291, -0.4059361072257843, -3.699816894531182, -22.109359660076507, -1.057809711941971, -21.090180619203693, -0.46989626289871467, -10.411459236797455, -8.092319422773414, 23.590794097689454, -17.903163086695827, -13.721057817951248, -22.95303955078134, -8.424328613281432, -15.025220220653068, -15.914282805349629, -4.167183390306107, -14.616357421875023, 8.286621093750114, 6.83253021375873], "episode_lengths": [18, 5, 3, 7, 18, 4, 6, 11, 3, 8, 3, 4, 7, 5, 3, 3, 10, 4, 9, 3, 7, 3, 3, 8, 5, 5, 6, 9, 5, 14, 6, 3, 26, 13, 3, 8, 5, 5, 5, 5, 3, 6, 23, 3, 8, 5, 6, 10, 5, 4, 3, 9, 8, 7, 3, 13, 4, 7, 4, 9, 4, 3, 12, 3, 3, 10, 8, 11, 3, 6, 5, 7, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.128110485890772, "mean_inference_ms": 1.3131162835338737, "mean_action_processing_ms": 0.21351466796807722, "mean_env_wait_ms": 695.3759891294978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010424879587948594, "StateBufferConnector_ms": 0.02810642962404945, "ViewRequirementAgentConnector_ms": 0.1945501048815305}, "num_episodes": 73, "episode_return_max": 47.67670261326104, "episode_return_min": -34.13398437500007, "episode_return_mean": -6.702261942011475, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516, "num_agent_steps_trained": 516, "num_env_steps_sampled": 516, "num_env_steps_trained": 516, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.066968573145244, "num_env_steps_trained_throughput_per_sec": 7.066968573145244, "timesteps_total": 516, "num_env_steps_sampled_lifetime": 516, "num_agent_steps_sampled_lifetime": 516, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 516, "timers": {"training_iteration_time_ms": 73015.764, "restore_workers_time_ms": 0.026, "training_step_time_ms": 73015.689, "sample_time_ms": 72061.779, "load_time_ms": 0.781, "load_throughput": 661044.858, "learn_time_ms": 939.127, "learn_throughput": 549.446, "synch_weights_time_ms": 13.483}, "counters": {"num_env_steps_sampled": 516, "num_env_steps_trained": 516, "num_agent_steps_sampled": 516, "num_agent_steps_trained": 516}, "done": false, "episodes_total": 73, "training_iteration": 1, "trial_id": "fe178_00000", "date": "2024-08-15_16-53-40", "timestamp": 1723762420, "time_this_iter_s": 73.01975846290588, "time_total_s": 73.01975846290588, "pid": 67484, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 73.01975846290588, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.860952380952384, "ram_util_percent": 12.292380952380952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7336604168017704, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.083250602086385, "policy_loss": -0.03828567638993263, "vf_loss": 7.11163254181544, "vf_explained_var": 0.028956809639930726, "kl": 0.009903802626369446, "entropy": 1.31749147772789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1032, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 1032, "num_agent_steps_trained": 1032}, "sampler_results": {"episode_reward_max": 72.8124319704919, "episode_reward_min": -42.830932617187045, "episode_reward_mean": -6.466569515149655, "episode_len_mean": 7.5, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 750, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.97343934348845, -22.98626922638175, -7.882300942305619, -25.759338378906136, -3.5241429727212363, -9.043968434548276, 3.2502969929167875, -34.13398437500007, -28.395700634894993, 36.44919631532994, -22.845141601562432, 16.869122721728843, 8.395374043199737, -20.9066162109375, 4.962346498878787, -24.777038574218636, -3.740576171875091, -25.208813476562568, -24.632998517996953, -11.948662476654889, 8.745788489309291, -0.4059361072257843, -3.699816894531182, -22.109359660076507, -1.057809711941971, -21.090180619203693, -0.46989626289871467, -10.411459236797455, -8.092319422773414, 23.590794097689454, -17.903163086695827, -13.721057817951248, -22.95303955078134, -8.424328613281432, -15.025220220653068, -15.914282805349629, -4.167183390306107, -14.616357421875023, 8.286621093750114, 6.83253021375873, -23.501538085937568, -13.923865006940389, -18.396811433297614, -29.715747070312432, -42.830932617187045, -24.263745117187568, -28.155468750000068, 59.315777527928674, -5.2745082866205735, -1.851325604459774, -5.268041992187591, 6.6382934570312955, -32.754455566406136, -4.911118097349487, -7.951977955992504, -5.4353784362984925, -21.460192871093682, -24.20331236492575, -25.555126953125068, 6.992260742187796, -12.726185896774624, 63.20070399713147, -11.81943169394566, -30.84524440090871, 11.214725069775284, -22.57115478515641, -21.450917396140085, -10.305617167474963, 4.213439941406364, -10.512143915796642, -5.689099121093818, -34.73566894531257, -8.351596834755696, -7.772158565893847, -0.8912181793999281, -23.352907278468138, 8.057294548859602, -24.927520664511178, 2.8261953630159695, -12.29913244350405, -11.183789062500182, -12.970042486966463, 48.784502795076264, 31.366674336463433, 16.146679687500068, 72.8124319704919, 18.53391571175763, 0.32889274161357207, 13.023513264960386, -1.0449054466437957, -11.682614502311424, -5.887634828041499, 8.62942032400349, -25.721008300781477, 0.9729869715632731, 0.1427491180017313, 24.515356882470257, -30.917187500000068, -32.39027099609382, -7.4334376505718325], "episode_lengths": [13, 3, 8, 5, 5, 5, 5, 3, 6, 23, 3, 8, 5, 6, 10, 5, 4, 3, 9, 8, 7, 3, 13, 4, 7, 4, 9, 4, 3, 12, 3, 3, 10, 8, 11, 3, 6, 5, 7, 11, 3, 4, 3, 3, 20, 3, 3, 28, 5, 10, 14, 24, 5, 4, 5, 5, 3, 4, 3, 17, 5, 32, 3, 9, 6, 7, 4, 5, 5, 5, 3, 3, 3, 5, 6, 4, 7, 6, 4, 4, 8, 3, 25, 13, 9, 23, 19, 8, 8, 5, 5, 8, 5, 10, 5, 9, 10, 3, 3, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.681036940762134, "mean_inference_ms": 1.307000405811707, "mean_action_processing_ms": 0.21157680718290958, "mean_env_wait_ms": 662.519900604432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010468324025472004, "StateBufferConnector_ms": 0.02684770690070258, "ViewRequirementAgentConnector_ms": 0.18886105219523114}, "num_episodes": 60, "episode_return_max": 72.8124319704919, "episode_return_min": -42.830932617187045, "episode_return_mean": -6.466569515149655}, "env_runner_results": {"episode_reward_max": 72.8124319704919, "episode_reward_min": -42.830932617187045, "episode_reward_mean": -6.466569515149655, "episode_len_mean": 7.5, "episode_media": {}, "episodes_this_iter": 60, "episodes_timesteps_total": 750, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.97343934348845, -22.98626922638175, -7.882300942305619, -25.759338378906136, -3.5241429727212363, -9.043968434548276, 3.2502969929167875, -34.13398437500007, -28.395700634894993, 36.44919631532994, -22.845141601562432, 16.869122721728843, 8.395374043199737, -20.9066162109375, 4.962346498878787, -24.777038574218636, -3.740576171875091, -25.208813476562568, -24.632998517996953, -11.948662476654889, 8.745788489309291, -0.4059361072257843, -3.699816894531182, -22.109359660076507, -1.057809711941971, -21.090180619203693, -0.46989626289871467, -10.411459236797455, -8.092319422773414, 23.590794097689454, -17.903163086695827, -13.721057817951248, -22.95303955078134, -8.424328613281432, -15.025220220653068, -15.914282805349629, -4.167183390306107, -14.616357421875023, 8.286621093750114, 6.83253021375873, -23.501538085937568, -13.923865006940389, -18.396811433297614, -29.715747070312432, -42.830932617187045, -24.263745117187568, -28.155468750000068, 59.315777527928674, -5.2745082866205735, -1.851325604459774, -5.268041992187591, 6.6382934570312955, -32.754455566406136, -4.911118097349487, -7.951977955992504, -5.4353784362984925, -21.460192871093682, -24.20331236492575, -25.555126953125068, 6.992260742187796, -12.726185896774624, 63.20070399713147, -11.81943169394566, -30.84524440090871, 11.214725069775284, -22.57115478515641, -21.450917396140085, -10.305617167474963, 4.213439941406364, -10.512143915796642, -5.689099121093818, -34.73566894531257, -8.351596834755696, -7.772158565893847, -0.8912181793999281, -23.352907278468138, 8.057294548859602, -24.927520664511178, 2.8261953630159695, -12.29913244350405, -11.183789062500182, -12.970042486966463, 48.784502795076264, 31.366674336463433, 16.146679687500068, 72.8124319704919, 18.53391571175763, 0.32889274161357207, 13.023513264960386, -1.0449054466437957, -11.682614502311424, -5.887634828041499, 8.62942032400349, -25.721008300781477, 0.9729869715632731, 0.1427491180017313, 24.515356882470257, -30.917187500000068, -32.39027099609382, -7.4334376505718325], "episode_lengths": [13, 3, 8, 5, 5, 5, 5, 3, 6, 23, 3, 8, 5, 6, 10, 5, 4, 3, 9, 8, 7, 3, 13, 4, 7, 4, 9, 4, 3, 12, 3, 3, 10, 8, 11, 3, 6, 5, 7, 11, 3, 4, 3, 3, 20, 3, 3, 28, 5, 10, 14, 24, 5, 4, 5, 5, 3, 4, 3, 17, 5, 32, 3, 9, 6, 7, 4, 5, 5, 5, 3, 3, 3, 5, 6, 4, 7, 6, 4, 4, 8, 3, 25, 13, 9, 23, 19, 8, 8, 5, 5, 8, 5, 10, 5, 9, 10, 3, 3, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.681036940762134, "mean_inference_ms": 1.307000405811707, "mean_action_processing_ms": 0.21157680718290958, "mean_env_wait_ms": 662.519900604432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010468324025472004, "StateBufferConnector_ms": 0.02684770690070258, "ViewRequirementAgentConnector_ms": 0.18886105219523114}, "num_episodes": 60, "episode_return_max": 72.8124319704919, "episode_return_min": -42.830932617187045, "episode_return_mean": -6.466569515149655}, "episode_reward_max": 72.8124319704919, "episode_reward_min": -42.830932617187045, "episode_reward_mean": -6.466569515149655, "episode_len_mean": 7.5, "episodes_this_iter": 60, "episodes_timesteps_total": 750, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22.97343934348845, -22.98626922638175, -7.882300942305619, -25.759338378906136, -3.5241429727212363, -9.043968434548276, 3.2502969929167875, -34.13398437500007, -28.395700634894993, 36.44919631532994, -22.845141601562432, 16.869122721728843, 8.395374043199737, -20.9066162109375, 4.962346498878787, -24.777038574218636, -3.740576171875091, -25.208813476562568, -24.632998517996953, -11.948662476654889, 8.745788489309291, -0.4059361072257843, -3.699816894531182, -22.109359660076507, -1.057809711941971, -21.090180619203693, -0.46989626289871467, -10.411459236797455, -8.092319422773414, 23.590794097689454, -17.903163086695827, -13.721057817951248, -22.95303955078134, -8.424328613281432, -15.025220220653068, -15.914282805349629, -4.167183390306107, -14.616357421875023, 8.286621093750114, 6.83253021375873, -23.501538085937568, -13.923865006940389, -18.396811433297614, -29.715747070312432, -42.830932617187045, -24.263745117187568, -28.155468750000068, 59.315777527928674, -5.2745082866205735, -1.851325604459774, -5.268041992187591, 6.6382934570312955, -32.754455566406136, -4.911118097349487, -7.951977955992504, -5.4353784362984925, -21.460192871093682, -24.20331236492575, -25.555126953125068, 6.992260742187796, -12.726185896774624, 63.20070399713147, -11.81943169394566, -30.84524440090871, 11.214725069775284, -22.57115478515641, -21.450917396140085, -10.305617167474963, 4.213439941406364, -10.512143915796642, -5.689099121093818, -34.73566894531257, -8.351596834755696, -7.772158565893847, -0.8912181793999281, -23.352907278468138, 8.057294548859602, -24.927520664511178, 2.8261953630159695, -12.29913244350405, -11.183789062500182, -12.970042486966463, 48.784502795076264, 31.366674336463433, 16.146679687500068, 72.8124319704919, 18.53391571175763, 0.32889274161357207, 13.023513264960386, -1.0449054466437957, -11.682614502311424, -5.887634828041499, 8.62942032400349, -25.721008300781477, 0.9729869715632731, 0.1427491180017313, 24.515356882470257, -30.917187500000068, -32.39027099609382, -7.4334376505718325], "episode_lengths": [13, 3, 8, 5, 5, 5, 5, 3, 6, 23, 3, 8, 5, 6, 10, 5, 4, 3, 9, 8, 7, 3, 13, 4, 7, 4, 9, 4, 3, 12, 3, 3, 10, 8, 11, 3, 6, 5, 7, 11, 3, 4, 3, 3, 20, 3, 3, 28, 5, 10, 14, 24, 5, 4, 5, 5, 3, 4, 3, 17, 5, 32, 3, 9, 6, 7, 4, 5, 5, 5, 3, 3, 3, 5, 6, 4, 7, 6, 4, 4, 8, 3, 25, 13, 9, 23, 19, 8, 8, 5, 5, 8, 5, 10, 5, 9, 10, 3, 3, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.681036940762134, "mean_inference_ms": 1.307000405811707, "mean_action_processing_ms": 0.21157680718290958, "mean_env_wait_ms": 662.519900604432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010468324025472004, "StateBufferConnector_ms": 0.02684770690070258, "ViewRequirementAgentConnector_ms": 0.18886105219523114}, "num_episodes": 60, "episode_return_max": 72.8124319704919, "episode_return_min": -42.830932617187045, "episode_return_mean": -6.466569515149655, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032, "num_agent_steps_trained": 1032, "num_env_steps_sampled": 1032, "num_env_steps_trained": 1032, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.145769906831227, "num_env_steps_trained_throughput_per_sec": 8.145769906831227, "timesteps_total": 1032, "num_env_steps_sampled_lifetime": 1032, "num_agent_steps_sampled_lifetime": 1032, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 1032, "timers": {"training_iteration_time_ms": 68180.77, "restore_workers_time_ms": 0.036, "training_step_time_ms": 68180.687, "sample_time_ms": 67359.874, "load_time_ms": 0.58, "load_throughput": 889909.895, "learn_time_ms": 805.727, "learn_throughput": 640.415, "synch_weights_time_ms": 14.096}, "counters": {"num_env_steps_sampled": 1032, "num_env_steps_trained": 1032, "num_agent_steps_sampled": 1032, "num_agent_steps_trained": 1032}, "done": false, "episodes_total": 133, "training_iteration": 2, "trial_id": "fe178_00000", "date": "2024-08-15_16-54-44", "timestamp": 1723762484, "time_this_iter_s": 63.35025668144226, "time_total_s": 136.37001514434814, "pid": 67484, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 136.37001514434814, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.50111111111111, "ram_util_percent": 12.781111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5893093784650167, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.150896751880646, "policy_loss": -0.047051913244649766, "vf_loss": 7.1879691998163855, "vf_explained_var": 0.06667959143718084, "kl": 0.00997947875096846, "entropy": 1.2906546662251155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1548, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 1548, "num_agent_steps_trained": 1548}, "sampler_results": {"episode_reward_max": 141.11639887458404, "episode_reward_min": -42.830932617187045, "episode_reward_mean": 0.3912167424903735, "episode_len_mean": 9.88, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 988, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.396811433297614, -29.715747070312432, -42.830932617187045, -24.263745117187568, -28.155468750000068, 59.315777527928674, -5.2745082866205735, -1.851325604459774, -5.268041992187591, 6.6382934570312955, -32.754455566406136, -4.911118097349487, -7.951977955992504, -5.4353784362984925, -21.460192871093682, -24.20331236492575, -25.555126953125068, 6.992260742187796, -12.726185896774624, 63.20070399713147, -11.81943169394566, -30.84524440090871, 11.214725069775284, -22.57115478515641, -21.450917396140085, -10.305617167474963, 4.213439941406364, -10.512143915796642, -5.689099121093818, -34.73566894531257, -8.351596834755696, -7.772158565893847, -0.8912181793999281, -23.352907278468138, 8.057294548859602, -24.927520664511178, 2.8261953630159695, -12.29913244350405, -11.183789062500182, -12.970042486966463, 48.784502795076264, 31.366674336463433, 16.146679687500068, 72.8124319704919, 18.53391571175763, 0.32889274161357207, 13.023513264960386, -1.0449054466437957, -11.682614502311424, -5.887634828041499, 8.62942032400349, -25.721008300781477, 0.9729869715632731, 0.1427491180017313, 24.515356882470257, -30.917187500000068, -32.39027099609382, -7.4334376505718325, 4.468430618175816, -4.841163083255836, 18.614482868587046, 21.213623046875227, -19.663083651074047, -24.307629394531318, 1.6010648648496613, -9.167226087285371, 84.80578902739416, 7.103052017485524, -16.792663574218636, -14.797821115321952, 35.03755966852461, -28.821215820312432, -18.864989848529433, 2.7225173666096225, 11.909029710656455, 82.33224150794337, -11.66316418838261, -23.859726707767962, 0.5705078124998408, -33.268188476562614, -1.0755737304688182, 32.74718029224931, -26.637524414062568, 141.11639887458404, 17.805006865912333, 35.909220106470045, -29.222705078124932, -25.862438964843818, -1.3211277623068014, -13.25626140059974, -25.947003829829498, 10.04415941974031, 50.36724638851575, 34.68526415743543, 51.34193564323181, -30.501635742187432, 8.311102386726759, 22.8722987378507, -3.5833794495214306, -15.208698085840979], "episode_lengths": [3, 3, 20, 3, 3, 28, 5, 10, 14, 24, 5, 4, 5, 5, 3, 4, 3, 17, 5, 32, 3, 9, 6, 7, 4, 5, 5, 5, 3, 3, 3, 5, 6, 4, 7, 6, 4, 4, 8, 3, 25, 13, 9, 23, 19, 8, 8, 5, 5, 8, 5, 10, 5, 9, 10, 3, 3, 9, 35, 6, 13, 36, 6, 3, 7, 8, 38, 7, 5, 1, 14, 7, 4, 9, 5, 40, 4, 3, 15, 5, 3, 16, 3, 39, 8, 25, 3, 3, 10, 7, 11, 13, 27, 21, 16, 3, 6, 21, 5, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.50409383522865, "mean_inference_ms": 1.3013744634665374, "mean_action_processing_ms": 0.2112992093933795, "mean_env_wait_ms": 628.0416439166307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010652780532836914, "StateBufferConnector_ms": 0.02303147315979004, "ViewRequirementAgentConnector_ms": 0.18378281593322754}, "num_episodes": 42, "episode_return_max": 141.11639887458404, "episode_return_min": -42.830932617187045, "episode_return_mean": 0.3912167424903735}, "env_runner_results": {"episode_reward_max": 141.11639887458404, "episode_reward_min": -42.830932617187045, "episode_reward_mean": 0.3912167424903735, "episode_len_mean": 9.88, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 988, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.396811433297614, -29.715747070312432, -42.830932617187045, -24.263745117187568, -28.155468750000068, 59.315777527928674, -5.2745082866205735, -1.851325604459774, -5.268041992187591, 6.6382934570312955, -32.754455566406136, -4.911118097349487, -7.951977955992504, -5.4353784362984925, -21.460192871093682, -24.20331236492575, -25.555126953125068, 6.992260742187796, -12.726185896774624, 63.20070399713147, -11.81943169394566, -30.84524440090871, 11.214725069775284, -22.57115478515641, -21.450917396140085, -10.305617167474963, 4.213439941406364, -10.512143915796642, -5.689099121093818, -34.73566894531257, -8.351596834755696, -7.772158565893847, -0.8912181793999281, -23.352907278468138, 8.057294548859602, -24.927520664511178, 2.8261953630159695, -12.29913244350405, -11.183789062500182, -12.970042486966463, 48.784502795076264, 31.366674336463433, 16.146679687500068, 72.8124319704919, 18.53391571175763, 0.32889274161357207, 13.023513264960386, -1.0449054466437957, -11.682614502311424, -5.887634828041499, 8.62942032400349, -25.721008300781477, 0.9729869715632731, 0.1427491180017313, 24.515356882470257, -30.917187500000068, -32.39027099609382, -7.4334376505718325, 4.468430618175816, -4.841163083255836, 18.614482868587046, 21.213623046875227, -19.663083651074047, -24.307629394531318, 1.6010648648496613, -9.167226087285371, 84.80578902739416, 7.103052017485524, -16.792663574218636, -14.797821115321952, 35.03755966852461, -28.821215820312432, -18.864989848529433, 2.7225173666096225, 11.909029710656455, 82.33224150794337, -11.66316418838261, -23.859726707767962, 0.5705078124998408, -33.268188476562614, -1.0755737304688182, 32.74718029224931, -26.637524414062568, 141.11639887458404, 17.805006865912333, 35.909220106470045, -29.222705078124932, -25.862438964843818, -1.3211277623068014, -13.25626140059974, -25.947003829829498, 10.04415941974031, 50.36724638851575, 34.68526415743543, 51.34193564323181, -30.501635742187432, 8.311102386726759, 22.8722987378507, -3.5833794495214306, -15.208698085840979], "episode_lengths": [3, 3, 20, 3, 3, 28, 5, 10, 14, 24, 5, 4, 5, 5, 3, 4, 3, 17, 5, 32, 3, 9, 6, 7, 4, 5, 5, 5, 3, 3, 3, 5, 6, 4, 7, 6, 4, 4, 8, 3, 25, 13, 9, 23, 19, 8, 8, 5, 5, 8, 5, 10, 5, 9, 10, 3, 3, 9, 35, 6, 13, 36, 6, 3, 7, 8, 38, 7, 5, 1, 14, 7, 4, 9, 5, 40, 4, 3, 15, 5, 3, 16, 3, 39, 8, 25, 3, 3, 10, 7, 11, 13, 27, 21, 16, 3, 6, 21, 5, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.50409383522865, "mean_inference_ms": 1.3013744634665374, "mean_action_processing_ms": 0.2112992093933795, "mean_env_wait_ms": 628.0416439166307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010652780532836914, "StateBufferConnector_ms": 0.02303147315979004, "ViewRequirementAgentConnector_ms": 0.18378281593322754}, "num_episodes": 42, "episode_return_max": 141.11639887458404, "episode_return_min": -42.830932617187045, "episode_return_mean": 0.3912167424903735}, "episode_reward_max": 141.11639887458404, "episode_reward_min": -42.830932617187045, "episode_reward_mean": 0.3912167424903735, "episode_len_mean": 9.88, "episodes_this_iter": 42, "episodes_timesteps_total": 988, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-18.396811433297614, -29.715747070312432, -42.830932617187045, -24.263745117187568, -28.155468750000068, 59.315777527928674, -5.2745082866205735, -1.851325604459774, -5.268041992187591, 6.6382934570312955, -32.754455566406136, -4.911118097349487, -7.951977955992504, -5.4353784362984925, -21.460192871093682, -24.20331236492575, -25.555126953125068, 6.992260742187796, -12.726185896774624, 63.20070399713147, -11.81943169394566, -30.84524440090871, 11.214725069775284, -22.57115478515641, -21.450917396140085, -10.305617167474963, 4.213439941406364, -10.512143915796642, -5.689099121093818, -34.73566894531257, -8.351596834755696, -7.772158565893847, -0.8912181793999281, -23.352907278468138, 8.057294548859602, -24.927520664511178, 2.8261953630159695, -12.29913244350405, -11.183789062500182, -12.970042486966463, 48.784502795076264, 31.366674336463433, 16.146679687500068, 72.8124319704919, 18.53391571175763, 0.32889274161357207, 13.023513264960386, -1.0449054466437957, -11.682614502311424, -5.887634828041499, 8.62942032400349, -25.721008300781477, 0.9729869715632731, 0.1427491180017313, 24.515356882470257, -30.917187500000068, -32.39027099609382, -7.4334376505718325, 4.468430618175816, -4.841163083255836, 18.614482868587046, 21.213623046875227, -19.663083651074047, -24.307629394531318, 1.6010648648496613, -9.167226087285371, 84.80578902739416, 7.103052017485524, -16.792663574218636, -14.797821115321952, 35.03755966852461, -28.821215820312432, -18.864989848529433, 2.7225173666096225, 11.909029710656455, 82.33224150794337, -11.66316418838261, -23.859726707767962, 0.5705078124998408, -33.268188476562614, -1.0755737304688182, 32.74718029224931, -26.637524414062568, 141.11639887458404, 17.805006865912333, 35.909220106470045, -29.222705078124932, -25.862438964843818, -1.3211277623068014, -13.25626140059974, -25.947003829829498, 10.04415941974031, 50.36724638851575, 34.68526415743543, 51.34193564323181, -30.501635742187432, 8.311102386726759, 22.8722987378507, -3.5833794495214306, -15.208698085840979], "episode_lengths": [3, 3, 20, 3, 3, 28, 5, 10, 14, 24, 5, 4, 5, 5, 3, 4, 3, 17, 5, 32, 3, 9, 6, 7, 4, 5, 5, 5, 3, 3, 3, 5, 6, 4, 7, 6, 4, 4, 8, 3, 25, 13, 9, 23, 19, 8, 8, 5, 5, 8, 5, 10, 5, 9, 10, 3, 3, 9, 35, 6, 13, 36, 6, 3, 7, 8, 38, 7, 5, 1, 14, 7, 4, 9, 5, 40, 4, 3, 15, 5, 3, 16, 3, 39, 8, 25, 3, 3, 10, 7, 11, 13, 27, 21, 16, 3, 6, 21, 5, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.50409383522865, "mean_inference_ms": 1.3013744634665374, "mean_action_processing_ms": 0.2112992093933795, "mean_env_wait_ms": 628.0416439166307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010652780532836914, "StateBufferConnector_ms": 0.02303147315979004, "ViewRequirementAgentConnector_ms": 0.18378281593322754}, "num_episodes": 42, "episode_return_max": 141.11639887458404, "episode_return_min": -42.830932617187045, "episode_return_mean": 0.3912167424903735, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1548, "num_agent_steps_trained": 1548, "num_env_steps_sampled": 1548, "num_env_steps_trained": 1548, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.736592014454387, "num_env_steps_trained_throughput_per_sec": 7.736592014454387, "timesteps_total": 1548, "num_env_steps_sampled_lifetime": 1548, "num_agent_steps_sampled_lifetime": 1548, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 1548, "timers": {"training_iteration_time_ms": 67685.863, "restore_workers_time_ms": 0.034, "training_step_time_ms": 67685.784, "sample_time_ms": 66912.574, "load_time_ms": 0.502, "load_throughput": 1028152.429, "learn_time_ms": 758.581, "learn_throughput": 680.217, "synch_weights_time_ms": 13.76}, "counters": {"num_env_steps_sampled": 1548, "num_env_steps_trained": 1548, "num_agent_steps_sampled": 1548, "num_agent_steps_trained": 1548}, "done": false, "episodes_total": 175, "training_iteration": 3, "trial_id": "fe178_00000", "date": "2024-08-15_16-55-51", "timestamp": 1723762551, "time_this_iter_s": 66.70012331008911, "time_total_s": 203.07013845443726, "pid": 67484, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 203.07013845443726, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.317708333333332, "ram_util_percent": 13.172916666666671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6552050709724426, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.149650065104167, "policy_loss": -0.02847818616622438, "vf_loss": 7.169773578643799, "vf_explained_var": 0.08675209432840347, "kl": 0.008354704268185742, "entropy": 1.2437925428152083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 2064, "num_agent_steps_trained": 2064}, "sampler_results": {"episode_reward_max": 141.11639887458404, "episode_reward_min": -33.268188476562614, "episode_reward_mean": 7.7173969938215885, "episode_len_mean": 11.22, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 1122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.970042486966463, 48.784502795076264, 31.366674336463433, 16.146679687500068, 72.8124319704919, 18.53391571175763, 0.32889274161357207, 13.023513264960386, -1.0449054466437957, -11.682614502311424, -5.887634828041499, 8.62942032400349, -25.721008300781477, 0.9729869715632731, 0.1427491180017313, 24.515356882470257, -30.917187500000068, -32.39027099609382, -7.4334376505718325, 4.468430618175816, -4.841163083255836, 18.614482868587046, 21.213623046875227, -19.663083651074047, -24.307629394531318, 1.6010648648496613, -9.167226087285371, 84.80578902739416, 7.103052017485524, -16.792663574218636, -14.797821115321952, 35.03755966852461, -28.821215820312432, -18.864989848529433, 2.7225173666096225, 11.909029710656455, 82.33224150794337, -11.66316418838261, -23.859726707767962, 0.5705078124998408, -33.268188476562614, -1.0755737304688182, 32.74718029224931, -26.637524414062568, 141.11639887458404, 17.805006865912333, 35.909220106470045, -29.222705078124932, -25.862438964843818, -1.3211277623068014, -13.25626140059974, -25.947003829829498, 10.04415941974031, 50.36724638851575, 34.68526415743543, 51.34193564323181, -30.501635742187432, 8.311102386726759, 22.8722987378507, -3.5833794495214306, -15.208698085840979, -22.54590125896584, -13.765683130100172, -3.1831782091009018, -6.126108096409837, 136.63932081114746, 7.192117191770478, -5.3382636772267915, 79.53336985784946, 5.951074218750023, 3.090904076661843, 2.308495852210143, 50.626661564678656, 25.04082775974547, -1.316254567473905, 4.1368503142047075, 19.92443253818317, -26.034228515624932, -16.688666283686587, 28.165537767987985, -8.245667514842467, 14.385428144838315, 25.578544746685452, -4.897517245836127, 3.483642578125, 2.5861785300882616, 1.2865763730818003, 113.2391978804971, -32.05086669921866, -16.378944087518903, 35.058015583443535, -27.291210937500068, -6.508404095117683, 21.920484126156737, 2.9369731388145937, 3.793070217672607, -18.92585411467992, -13.256078698857323, -5.099603988211413, 8.389514160156182], "episode_lengths": [3, 25, 13, 9, 23, 19, 8, 8, 5, 5, 8, 5, 10, 5, 9, 10, 3, 3, 9, 35, 6, 13, 36, 6, 3, 7, 8, 38, 7, 5, 1, 14, 7, 4, 9, 5, 40, 4, 3, 15, 5, 3, 16, 3, 39, 8, 25, 3, 3, 10, 7, 11, 13, 27, 21, 16, 3, 6, 21, 5, 4, 8, 6, 7, 6, 44, 7, 5, 46, 5, 4, 8, 25, 8, 3, 11, 19, 3, 9, 13, 3, 8, 23, 4, 6, 10, 5, 50, 4, 4, 22, 3, 5, 7, 9, 5, 4, 5, 4, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.539415300455893, "mean_inference_ms": 1.2951792344837048, "mean_action_processing_ms": 0.21082850356929825, "mean_env_wait_ms": 617.1309456795835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010837316513061523, "StateBufferConnector_ms": 0.020552396774291992, "ViewRequirementAgentConnector_ms": 0.18171381950378418}, "num_episodes": 39, "episode_return_max": 141.11639887458404, "episode_return_min": -33.268188476562614, "episode_return_mean": 7.7173969938215885}, "env_runner_results": {"episode_reward_max": 141.11639887458404, "episode_reward_min": -33.268188476562614, "episode_reward_mean": 7.7173969938215885, "episode_len_mean": 11.22, "episode_media": {}, "episodes_this_iter": 39, "episodes_timesteps_total": 1122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.970042486966463, 48.784502795076264, 31.366674336463433, 16.146679687500068, 72.8124319704919, 18.53391571175763, 0.32889274161357207, 13.023513264960386, -1.0449054466437957, -11.682614502311424, -5.887634828041499, 8.62942032400349, -25.721008300781477, 0.9729869715632731, 0.1427491180017313, 24.515356882470257, -30.917187500000068, -32.39027099609382, -7.4334376505718325, 4.468430618175816, -4.841163083255836, 18.614482868587046, 21.213623046875227, -19.663083651074047, -24.307629394531318, 1.6010648648496613, -9.167226087285371, 84.80578902739416, 7.103052017485524, -16.792663574218636, -14.797821115321952, 35.03755966852461, -28.821215820312432, -18.864989848529433, 2.7225173666096225, 11.909029710656455, 82.33224150794337, -11.66316418838261, -23.859726707767962, 0.5705078124998408, -33.268188476562614, -1.0755737304688182, 32.74718029224931, -26.637524414062568, 141.11639887458404, 17.805006865912333, 35.909220106470045, -29.222705078124932, -25.862438964843818, -1.3211277623068014, -13.25626140059974, -25.947003829829498, 10.04415941974031, 50.36724638851575, 34.68526415743543, 51.34193564323181, -30.501635742187432, 8.311102386726759, 22.8722987378507, -3.5833794495214306, -15.208698085840979, -22.54590125896584, -13.765683130100172, -3.1831782091009018, -6.126108096409837, 136.63932081114746, 7.192117191770478, -5.3382636772267915, 79.53336985784946, 5.951074218750023, 3.090904076661843, 2.308495852210143, 50.626661564678656, 25.04082775974547, -1.316254567473905, 4.1368503142047075, 19.92443253818317, -26.034228515624932, -16.688666283686587, 28.165537767987985, -8.245667514842467, 14.385428144838315, 25.578544746685452, -4.897517245836127, 3.483642578125, 2.5861785300882616, 1.2865763730818003, 113.2391978804971, -32.05086669921866, -16.378944087518903, 35.058015583443535, -27.291210937500068, -6.508404095117683, 21.920484126156737, 2.9369731388145937, 3.793070217672607, -18.92585411467992, -13.256078698857323, -5.099603988211413, 8.389514160156182], "episode_lengths": [3, 25, 13, 9, 23, 19, 8, 8, 5, 5, 8, 5, 10, 5, 9, 10, 3, 3, 9, 35, 6, 13, 36, 6, 3, 7, 8, 38, 7, 5, 1, 14, 7, 4, 9, 5, 40, 4, 3, 15, 5, 3, 16, 3, 39, 8, 25, 3, 3, 10, 7, 11, 13, 27, 21, 16, 3, 6, 21, 5, 4, 8, 6, 7, 6, 44, 7, 5, 46, 5, 4, 8, 25, 8, 3, 11, 19, 3, 9, 13, 3, 8, 23, 4, 6, 10, 5, 50, 4, 4, 22, 3, 5, 7, 9, 5, 4, 5, 4, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.539415300455893, "mean_inference_ms": 1.2951792344837048, "mean_action_processing_ms": 0.21082850356929825, "mean_env_wait_ms": 617.1309456795835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010837316513061523, "StateBufferConnector_ms": 0.020552396774291992, "ViewRequirementAgentConnector_ms": 0.18171381950378418}, "num_episodes": 39, "episode_return_max": 141.11639887458404, "episode_return_min": -33.268188476562614, "episode_return_mean": 7.7173969938215885}, "episode_reward_max": 141.11639887458404, "episode_reward_min": -33.268188476562614, "episode_reward_mean": 7.7173969938215885, "episode_len_mean": 11.22, "episodes_this_iter": 39, "episodes_timesteps_total": 1122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.970042486966463, 48.784502795076264, 31.366674336463433, 16.146679687500068, 72.8124319704919, 18.53391571175763, 0.32889274161357207, 13.023513264960386, -1.0449054466437957, -11.682614502311424, -5.887634828041499, 8.62942032400349, -25.721008300781477, 0.9729869715632731, 0.1427491180017313, 24.515356882470257, -30.917187500000068, -32.39027099609382, -7.4334376505718325, 4.468430618175816, -4.841163083255836, 18.614482868587046, 21.213623046875227, -19.663083651074047, -24.307629394531318, 1.6010648648496613, -9.167226087285371, 84.80578902739416, 7.103052017485524, -16.792663574218636, -14.797821115321952, 35.03755966852461, -28.821215820312432, -18.864989848529433, 2.7225173666096225, 11.909029710656455, 82.33224150794337, -11.66316418838261, -23.859726707767962, 0.5705078124998408, -33.268188476562614, -1.0755737304688182, 32.74718029224931, -26.637524414062568, 141.11639887458404, 17.805006865912333, 35.909220106470045, -29.222705078124932, -25.862438964843818, -1.3211277623068014, -13.25626140059974, -25.947003829829498, 10.04415941974031, 50.36724638851575, 34.68526415743543, 51.34193564323181, -30.501635742187432, 8.311102386726759, 22.8722987378507, -3.5833794495214306, -15.208698085840979, -22.54590125896584, -13.765683130100172, -3.1831782091009018, -6.126108096409837, 136.63932081114746, 7.192117191770478, -5.3382636772267915, 79.53336985784946, 5.951074218750023, 3.090904076661843, 2.308495852210143, 50.626661564678656, 25.04082775974547, -1.316254567473905, 4.1368503142047075, 19.92443253818317, -26.034228515624932, -16.688666283686587, 28.165537767987985, -8.245667514842467, 14.385428144838315, 25.578544746685452, -4.897517245836127, 3.483642578125, 2.5861785300882616, 1.2865763730818003, 113.2391978804971, -32.05086669921866, -16.378944087518903, 35.058015583443535, -27.291210937500068, -6.508404095117683, 21.920484126156737, 2.9369731388145937, 3.793070217672607, -18.92585411467992, -13.256078698857323, -5.099603988211413, 8.389514160156182], "episode_lengths": [3, 25, 13, 9, 23, 19, 8, 8, 5, 5, 8, 5, 10, 5, 9, 10, 3, 3, 9, 35, 6, 13, 36, 6, 3, 7, 8, 38, 7, 5, 1, 14, 7, 4, 9, 5, 40, 4, 3, 15, 5, 3, 16, 3, 39, 8, 25, 3, 3, 10, 7, 11, 13, 27, 21, 16, 3, 6, 21, 5, 4, 8, 6, 7, 6, 44, 7, 5, 46, 5, 4, 8, 25, 8, 3, 11, 19, 3, 9, 13, 3, 8, 23, 4, 6, 10, 5, 50, 4, 4, 22, 3, 5, 7, 9, 5, 4, 5, 4, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.539415300455893, "mean_inference_ms": 1.2951792344837048, "mean_action_processing_ms": 0.21082850356929825, "mean_env_wait_ms": 617.1309456795835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010837316513061523, "StateBufferConnector_ms": 0.020552396774291992, "ViewRequirementAgentConnector_ms": 0.18171381950378418}, "num_episodes": 39, "episode_return_max": 141.11639887458404, "episode_return_min": -33.268188476562614, "episode_return_mean": 7.7173969938215885, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064, "num_agent_steps_trained": 2064, "num_env_steps_sampled": 2064, "num_env_steps_trained": 2064, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.2711868966927, "num_env_steps_trained_throughput_per_sec": 8.2711868966927, "timesteps_total": 2064, "num_env_steps_sampled_lifetime": 2064, "num_agent_steps_sampled_lifetime": 2064, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 2064, "timers": {"training_iteration_time_ms": 66360.712, "restore_workers_time_ms": 0.031, "training_step_time_ms": 66360.637, "sample_time_ms": 65604.299, "load_time_ms": 0.465, "load_throughput": 1109166.362, "learn_time_ms": 741.958, "learn_throughput": 695.457, "synch_weights_time_ms": 13.578}, "counters": {"num_env_steps_sampled": 2064, "num_env_steps_trained": 2064, "num_agent_steps_sampled": 2064, "num_agent_steps_trained": 2064}, "done": false, "episodes_total": 214, "training_iteration": 4, "trial_id": "fe178_00000", "date": "2024-08-15_16-56-53", "timestamp": 1723762613, "time_this_iter_s": 62.38898301124573, "time_total_s": 265.459121465683, "pid": 67484, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 265.459121465683, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.22696629213483, "ram_util_percent": 13.54269662921348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.533433070778847, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.212216413021087, "policy_loss": -0.04296586481699099, "vf_loss": 7.246495668093363, "vf_explained_var": 0.1435147687792778, "kl": 0.00868664729708456, "entropy": 1.1738449474175772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2580, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 2580, "num_agent_steps_trained": 2580}, "sampler_results": {"episode_reward_max": 136.63932081114746, "episode_reward_min": -32.05086669921866, "episode_reward_mean": 15.57347972876456, "episode_len_mean": 11.98, "episode_media": {}, "episodes_this_iter": 49, "episodes_timesteps_total": 1198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.3211277623068014, -13.25626140059974, -25.947003829829498, 10.04415941974031, 50.36724638851575, 34.68526415743543, 51.34193564323181, -30.501635742187432, 8.311102386726759, 22.8722987378507, -3.5833794495214306, -15.208698085840979, -22.54590125896584, -13.765683130100172, -3.1831782091009018, -6.126108096409837, 136.63932081114746, 7.192117191770478, -5.3382636772267915, 79.53336985784946, 5.951074218750023, 3.090904076661843, 2.308495852210143, 50.626661564678656, 25.04082775974547, -1.316254567473905, 4.1368503142047075, 19.92443253818317, -26.034228515624932, -16.688666283686587, 28.165537767987985, -8.245667514842467, 14.385428144838315, 25.578544746685452, -4.897517245836127, 3.483642578125, 2.5861785300882616, 1.2865763730818003, 113.2391978804971, -32.05086669921866, -16.378944087518903, 35.058015583443535, -27.291210937500068, -6.508404095117683, 21.920484126156737, 2.9369731388145937, 3.793070217672607, -18.92585411467992, -13.256078698857323, -5.099603988211413, 8.389514160156182, 58.24929639034917, 9.82133165196933, 19.312454725251015, -1.230187988281159, -7.637056991040424, 8.309130859375045, -5.477017938718518, 9.146576132365396, -18.5702414040108, -8.199523907282298, -16.393823242187523, 112.62580776823926, 16.60871018701782, 8.343640136718705, 92.81499174987161, 5.048732149743884, -1.4205029027442038, 5.078153197047527, 43.1987346061549, 31.71340820817585, -3.7822998046874545, 12.290700767515204, -7.1988310929341, -9.772457067384892, -10.18536629722685, 12.817862812175576, 118.77602500798832, 5.25006103515625, 5.23012973248774, -24.56806971738763, 4.971248109421083, 65.0709407593007, 62.024117246472315, 129.6730652991169, 0.9312930157133792, 8.421862141498934, 14.090725133982744, 31.902214607819005, 112.85223129176234, -15.570326397254462, -3.395983886718682, -7.161273709621199, 69.44784502308248, 17.481899137626442, 6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524], "episode_lengths": [10, 7, 11, 13, 27, 21, 16, 3, 6, 21, 5, 4, 8, 6, 7, 6, 44, 7, 5, 46, 5, 4, 8, 25, 8, 3, 11, 19, 3, 9, 13, 3, 8, 23, 4, 6, 10, 5, 50, 4, 4, 22, 3, 5, 7, 9, 5, 4, 5, 4, 9, 22, 6, 10, 4, 3, 10, 4, 12, 3, 5, 7, 37, 17, 6, 22, 9, 10, 5, 24, 10, 12, 15, 1, 9, 12, 7, 50, 10, 4, 3, 8, 25, 22, 37, 8, 11, 5, 12, 30, 3, 3, 6, 34, 10, 9, 18, 20, 10, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.821453967254158, "mean_inference_ms": 1.292282155765176, "mean_action_processing_ms": 0.21119437706338565, "mean_env_wait_ms": 607.8242859992388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010869026184082031, "StateBufferConnector_ms": 0.01857447624206543, "ViewRequirementAgentConnector_ms": 0.18043088912963867}, "num_episodes": 49, "episode_return_max": 136.63932081114746, "episode_return_min": -32.05086669921866, "episode_return_mean": 15.57347972876456}, "env_runner_results": {"episode_reward_max": 136.63932081114746, "episode_reward_min": -32.05086669921866, "episode_reward_mean": 15.57347972876456, "episode_len_mean": 11.98, "episode_media": {}, "episodes_this_iter": 49, "episodes_timesteps_total": 1198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.3211277623068014, -13.25626140059974, -25.947003829829498, 10.04415941974031, 50.36724638851575, 34.68526415743543, 51.34193564323181, -30.501635742187432, 8.311102386726759, 22.8722987378507, -3.5833794495214306, -15.208698085840979, -22.54590125896584, -13.765683130100172, -3.1831782091009018, -6.126108096409837, 136.63932081114746, 7.192117191770478, -5.3382636772267915, 79.53336985784946, 5.951074218750023, 3.090904076661843, 2.308495852210143, 50.626661564678656, 25.04082775974547, -1.316254567473905, 4.1368503142047075, 19.92443253818317, -26.034228515624932, -16.688666283686587, 28.165537767987985, -8.245667514842467, 14.385428144838315, 25.578544746685452, -4.897517245836127, 3.483642578125, 2.5861785300882616, 1.2865763730818003, 113.2391978804971, -32.05086669921866, -16.378944087518903, 35.058015583443535, -27.291210937500068, -6.508404095117683, 21.920484126156737, 2.9369731388145937, 3.793070217672607, -18.92585411467992, -13.256078698857323, -5.099603988211413, 8.389514160156182, 58.24929639034917, 9.82133165196933, 19.312454725251015, -1.230187988281159, -7.637056991040424, 8.309130859375045, -5.477017938718518, 9.146576132365396, -18.5702414040108, -8.199523907282298, -16.393823242187523, 112.62580776823926, 16.60871018701782, 8.343640136718705, 92.81499174987161, 5.048732149743884, -1.4205029027442038, 5.078153197047527, 43.1987346061549, 31.71340820817585, -3.7822998046874545, 12.290700767515204, -7.1988310929341, -9.772457067384892, -10.18536629722685, 12.817862812175576, 118.77602500798832, 5.25006103515625, 5.23012973248774, -24.56806971738763, 4.971248109421083, 65.0709407593007, 62.024117246472315, 129.6730652991169, 0.9312930157133792, 8.421862141498934, 14.090725133982744, 31.902214607819005, 112.85223129176234, -15.570326397254462, -3.395983886718682, -7.161273709621199, 69.44784502308248, 17.481899137626442, 6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524], "episode_lengths": [10, 7, 11, 13, 27, 21, 16, 3, 6, 21, 5, 4, 8, 6, 7, 6, 44, 7, 5, 46, 5, 4, 8, 25, 8, 3, 11, 19, 3, 9, 13, 3, 8, 23, 4, 6, 10, 5, 50, 4, 4, 22, 3, 5, 7, 9, 5, 4, 5, 4, 9, 22, 6, 10, 4, 3, 10, 4, 12, 3, 5, 7, 37, 17, 6, 22, 9, 10, 5, 24, 10, 12, 15, 1, 9, 12, 7, 50, 10, 4, 3, 8, 25, 22, 37, 8, 11, 5, 12, 30, 3, 3, 6, 34, 10, 9, 18, 20, 10, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.821453967254158, "mean_inference_ms": 1.292282155765176, "mean_action_processing_ms": 0.21119437706338565, "mean_env_wait_ms": 607.8242859992388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010869026184082031, "StateBufferConnector_ms": 0.01857447624206543, "ViewRequirementAgentConnector_ms": 0.18043088912963867}, "num_episodes": 49, "episode_return_max": 136.63932081114746, "episode_return_min": -32.05086669921866, "episode_return_mean": 15.57347972876456}, "episode_reward_max": 136.63932081114746, "episode_reward_min": -32.05086669921866, "episode_reward_mean": 15.57347972876456, "episode_len_mean": 11.98, "episodes_this_iter": 49, "episodes_timesteps_total": 1198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.3211277623068014, -13.25626140059974, -25.947003829829498, 10.04415941974031, 50.36724638851575, 34.68526415743543, 51.34193564323181, -30.501635742187432, 8.311102386726759, 22.8722987378507, -3.5833794495214306, -15.208698085840979, -22.54590125896584, -13.765683130100172, -3.1831782091009018, -6.126108096409837, 136.63932081114746, 7.192117191770478, -5.3382636772267915, 79.53336985784946, 5.951074218750023, 3.090904076661843, 2.308495852210143, 50.626661564678656, 25.04082775974547, -1.316254567473905, 4.1368503142047075, 19.92443253818317, -26.034228515624932, -16.688666283686587, 28.165537767987985, -8.245667514842467, 14.385428144838315, 25.578544746685452, -4.897517245836127, 3.483642578125, 2.5861785300882616, 1.2865763730818003, 113.2391978804971, -32.05086669921866, -16.378944087518903, 35.058015583443535, -27.291210937500068, -6.508404095117683, 21.920484126156737, 2.9369731388145937, 3.793070217672607, -18.92585411467992, -13.256078698857323, -5.099603988211413, 8.389514160156182, 58.24929639034917, 9.82133165196933, 19.312454725251015, -1.230187988281159, -7.637056991040424, 8.309130859375045, -5.477017938718518, 9.146576132365396, -18.5702414040108, -8.199523907282298, -16.393823242187523, 112.62580776823926, 16.60871018701782, 8.343640136718705, 92.81499174987161, 5.048732149743884, -1.4205029027442038, 5.078153197047527, 43.1987346061549, 31.71340820817585, -3.7822998046874545, 12.290700767515204, -7.1988310929341, -9.772457067384892, -10.18536629722685, 12.817862812175576, 118.77602500798832, 5.25006103515625, 5.23012973248774, -24.56806971738763, 4.971248109421083, 65.0709407593007, 62.024117246472315, 129.6730652991169, 0.9312930157133792, 8.421862141498934, 14.090725133982744, 31.902214607819005, 112.85223129176234, -15.570326397254462, -3.395983886718682, -7.161273709621199, 69.44784502308248, 17.481899137626442, 6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524], "episode_lengths": [10, 7, 11, 13, 27, 21, 16, 3, 6, 21, 5, 4, 8, 6, 7, 6, 44, 7, 5, 46, 5, 4, 8, 25, 8, 3, 11, 19, 3, 9, 13, 3, 8, 23, 4, 6, 10, 5, 50, 4, 4, 22, 3, 5, 7, 9, 5, 4, 5, 4, 9, 22, 6, 10, 4, 3, 10, 4, 12, 3, 5, 7, 37, 17, 6, 22, 9, 10, 5, 24, 10, 12, 15, 1, 9, 12, 7, 50, 10, 4, 3, 8, 25, 22, 37, 8, 11, 5, 12, 30, 3, 3, 6, 34, 10, 9, 18, 20, 10, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.821453967254158, "mean_inference_ms": 1.292282155765176, "mean_action_processing_ms": 0.21119437706338565, "mean_env_wait_ms": 607.8242859992388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010869026184082031, "StateBufferConnector_ms": 0.01857447624206543, "ViewRequirementAgentConnector_ms": 0.18043088912963867}, "num_episodes": 49, "episode_return_max": 136.63932081114746, "episode_return_min": -32.05086669921866, "episode_return_mean": 15.57347972876456, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2580, "num_agent_steps_trained": 2580, "num_env_steps_sampled": 2580, "num_env_steps_trained": 2580, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.795962847063613, "num_env_steps_trained_throughput_per_sec": 8.795962847063613, "timesteps_total": 2580, "num_env_steps_sampled_lifetime": 2580, "num_agent_steps_sampled_lifetime": 2580, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 2580, "timers": {"training_iteration_time_ms": 64821.228, "restore_workers_time_ms": 0.029, "training_step_time_ms": 64821.157, "sample_time_ms": 64075.751, "load_time_ms": 0.449, "load_throughput": 1150101.426, "learn_time_ms": 731.061, "learn_throughput": 705.823, "synch_weights_time_ms": 13.57}, "counters": {"num_env_steps_sampled": 2580, "num_env_steps_trained": 2580, "num_agent_steps_sampled": 2580, "num_agent_steps_trained": 2580}, "done": false, "episodes_total": 263, "training_iteration": 5, "trial_id": "fe178_00000", "date": "2024-08-15_16-57-52", "timestamp": 1723762672, "time_this_iter_s": 58.667349100112915, "time_total_s": 324.1264705657959, "pid": 67484, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 324.1264705657959, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 27.47469879518073, "ram_util_percent": 12.19277108433735}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.627084933718046, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.547342761357625, "policy_loss": -0.03804714020807296, "vf_loss": 7.576597865422567, "vf_explained_var": 0.20638373990853628, "kl": 0.008792021689563103, "entropy": 1.1664319386084874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3096, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 3096, "num_agent_steps_trained": 3096}, "sampler_results": {"episode_reward_max": 138.4653618582825, "episode_reward_min": -32.05086669921866, "episode_reward_mean": 20.175232917128948, "episode_len_mean": 12.64, "episode_media": {}, "episodes_this_iter": 32, "episodes_timesteps_total": 1264, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.385428144838315, 25.578544746685452, -4.897517245836127, 3.483642578125, 2.5861785300882616, 1.2865763730818003, 113.2391978804971, -32.05086669921866, -16.378944087518903, 35.058015583443535, -27.291210937500068, -6.508404095117683, 21.920484126156737, 2.9369731388145937, 3.793070217672607, -18.92585411467992, -13.256078698857323, -5.099603988211413, 8.389514160156182, 58.24929639034917, 9.82133165196933, 19.312454725251015, -1.230187988281159, -7.637056991040424, 8.309130859375045, -5.477017938718518, 9.146576132365396, -18.5702414040108, -8.199523907282298, -16.393823242187523, 112.62580776823926, 16.60871018701782, 8.343640136718705, 92.81499174987161, 5.048732149743884, -1.4205029027442038, 5.078153197047527, 43.1987346061549, 31.71340820817585, -3.7822998046874545, 12.290700767515204, -7.1988310929341, -9.772457067384892, -10.18536629722685, 12.817862812175576, 118.77602500798832, 5.25006103515625, 5.23012973248774, -24.56806971738763, 4.971248109421083, 65.0709407593007, 62.024117246472315, 129.6730652991169, 0.9312930157133792, 8.421862141498934, 14.090725133982744, 31.902214607819005, 112.85223129176234, -15.570326397254462, -3.395983886718682, -7.161273709621199, 69.44784502308248, 17.481899137626442, 6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524, 128.86863618292404, 15.898986371573756, 10.585625692286271, 13.191426595579514, -14.257255224793312, 18.638301214932355, 3.187888367485982, 138.4653618582825, 21.908668016373568, 104.98047708620577, -12.866908873210832, 24.744867847883853, 2.263592185368438, -22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454], "episode_lengths": [8, 23, 4, 6, 10, 5, 50, 4, 4, 22, 3, 5, 7, 9, 5, 4, 5, 4, 9, 22, 6, 10, 4, 3, 10, 4, 12, 3, 5, 7, 37, 17, 6, 22, 9, 10, 5, 24, 10, 12, 15, 1, 9, 12, 7, 50, 10, 4, 3, 8, 25, 22, 37, 8, 11, 5, 12, 30, 3, 3, 6, 34, 10, 9, 18, 20, 10, 7, 50, 7, 5, 8, 5, 10, 10, 50, 12, 30, 4, 10, 7, 8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.331181647181747, "mean_inference_ms": 1.2910716049737976, "mean_action_processing_ms": 0.211344601359066, "mean_env_wait_ms": 603.7200405759515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010828971862792969, "StateBufferConnector_ms": 0.017920494079589844, "ViewRequirementAgentConnector_ms": 0.18015766143798828}, "num_episodes": 32, "episode_return_max": 138.4653618582825, "episode_return_min": -32.05086669921866, "episode_return_mean": 20.175232917128948}, "env_runner_results": {"episode_reward_max": 138.4653618582825, "episode_reward_min": -32.05086669921866, "episode_reward_mean": 20.175232917128948, "episode_len_mean": 12.64, "episode_media": {}, "episodes_this_iter": 32, "episodes_timesteps_total": 1264, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.385428144838315, 25.578544746685452, -4.897517245836127, 3.483642578125, 2.5861785300882616, 1.2865763730818003, 113.2391978804971, -32.05086669921866, -16.378944087518903, 35.058015583443535, -27.291210937500068, -6.508404095117683, 21.920484126156737, 2.9369731388145937, 3.793070217672607, -18.92585411467992, -13.256078698857323, -5.099603988211413, 8.389514160156182, 58.24929639034917, 9.82133165196933, 19.312454725251015, -1.230187988281159, -7.637056991040424, 8.309130859375045, -5.477017938718518, 9.146576132365396, -18.5702414040108, -8.199523907282298, -16.393823242187523, 112.62580776823926, 16.60871018701782, 8.343640136718705, 92.81499174987161, 5.048732149743884, -1.4205029027442038, 5.078153197047527, 43.1987346061549, 31.71340820817585, -3.7822998046874545, 12.290700767515204, -7.1988310929341, -9.772457067384892, -10.18536629722685, 12.817862812175576, 118.77602500798832, 5.25006103515625, 5.23012973248774, -24.56806971738763, 4.971248109421083, 65.0709407593007, 62.024117246472315, 129.6730652991169, 0.9312930157133792, 8.421862141498934, 14.090725133982744, 31.902214607819005, 112.85223129176234, -15.570326397254462, -3.395983886718682, -7.161273709621199, 69.44784502308248, 17.481899137626442, 6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524, 128.86863618292404, 15.898986371573756, 10.585625692286271, 13.191426595579514, -14.257255224793312, 18.638301214932355, 3.187888367485982, 138.4653618582825, 21.908668016373568, 104.98047708620577, -12.866908873210832, 24.744867847883853, 2.263592185368438, -22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454], "episode_lengths": [8, 23, 4, 6, 10, 5, 50, 4, 4, 22, 3, 5, 7, 9, 5, 4, 5, 4, 9, 22, 6, 10, 4, 3, 10, 4, 12, 3, 5, 7, 37, 17, 6, 22, 9, 10, 5, 24, 10, 12, 15, 1, 9, 12, 7, 50, 10, 4, 3, 8, 25, 22, 37, 8, 11, 5, 12, 30, 3, 3, 6, 34, 10, 9, 18, 20, 10, 7, 50, 7, 5, 8, 5, 10, 10, 50, 12, 30, 4, 10, 7, 8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.331181647181747, "mean_inference_ms": 1.2910716049737976, "mean_action_processing_ms": 0.211344601359066, "mean_env_wait_ms": 603.7200405759515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010828971862792969, "StateBufferConnector_ms": 0.017920494079589844, "ViewRequirementAgentConnector_ms": 0.18015766143798828}, "num_episodes": 32, "episode_return_max": 138.4653618582825, "episode_return_min": -32.05086669921866, "episode_return_mean": 20.175232917128948}, "episode_reward_max": 138.4653618582825, "episode_reward_min": -32.05086669921866, "episode_reward_mean": 20.175232917128948, "episode_len_mean": 12.64, "episodes_this_iter": 32, "episodes_timesteps_total": 1264, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.385428144838315, 25.578544746685452, -4.897517245836127, 3.483642578125, 2.5861785300882616, 1.2865763730818003, 113.2391978804971, -32.05086669921866, -16.378944087518903, 35.058015583443535, -27.291210937500068, -6.508404095117683, 21.920484126156737, 2.9369731388145937, 3.793070217672607, -18.92585411467992, -13.256078698857323, -5.099603988211413, 8.389514160156182, 58.24929639034917, 9.82133165196933, 19.312454725251015, -1.230187988281159, -7.637056991040424, 8.309130859375045, -5.477017938718518, 9.146576132365396, -18.5702414040108, -8.199523907282298, -16.393823242187523, 112.62580776823926, 16.60871018701782, 8.343640136718705, 92.81499174987161, 5.048732149743884, -1.4205029027442038, 5.078153197047527, 43.1987346061549, 31.71340820817585, -3.7822998046874545, 12.290700767515204, -7.1988310929341, -9.772457067384892, -10.18536629722685, 12.817862812175576, 118.77602500798832, 5.25006103515625, 5.23012973248774, -24.56806971738763, 4.971248109421083, 65.0709407593007, 62.024117246472315, 129.6730652991169, 0.9312930157133792, 8.421862141498934, 14.090725133982744, 31.902214607819005, 112.85223129176234, -15.570326397254462, -3.395983886718682, -7.161273709621199, 69.44784502308248, 17.481899137626442, 6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524, 128.86863618292404, 15.898986371573756, 10.585625692286271, 13.191426595579514, -14.257255224793312, 18.638301214932355, 3.187888367485982, 138.4653618582825, 21.908668016373568, 104.98047708620577, -12.866908873210832, 24.744867847883853, 2.263592185368438, -22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454], "episode_lengths": [8, 23, 4, 6, 10, 5, 50, 4, 4, 22, 3, 5, 7, 9, 5, 4, 5, 4, 9, 22, 6, 10, 4, 3, 10, 4, 12, 3, 5, 7, 37, 17, 6, 22, 9, 10, 5, 24, 10, 12, 15, 1, 9, 12, 7, 50, 10, 4, 3, 8, 25, 22, 37, 8, 11, 5, 12, 30, 3, 3, 6, 34, 10, 9, 18, 20, 10, 7, 50, 7, 5, 8, 5, 10, 10, 50, 12, 30, 4, 10, 7, 8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.331181647181747, "mean_inference_ms": 1.2910716049737976, "mean_action_processing_ms": 0.211344601359066, "mean_env_wait_ms": 603.7200405759515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010828971862792969, "StateBufferConnector_ms": 0.017920494079589844, "ViewRequirementAgentConnector_ms": 0.18015766143798828}, "num_episodes": 32, "episode_return_max": 138.4653618582825, "episode_return_min": -32.05086669921866, "episode_return_mean": 20.175232917128948, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3096, "num_agent_steps_trained": 3096, "num_env_steps_sampled": 3096, "num_env_steps_trained": 3096, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.977474663675642, "num_env_steps_trained_throughput_per_sec": 8.977474663675642, "timesteps_total": 3096, "num_env_steps_sampled_lifetime": 3096, "num_agent_steps_sampled_lifetime": 3096, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 3096, "timers": {"training_iteration_time_ms": 63597.223, "restore_workers_time_ms": 0.027, "training_step_time_ms": 63597.156, "sample_time_ms": 62860.349, "load_time_ms": 0.442, "load_throughput": 1166507.832, "learn_time_ms": 722.494, "learn_throughput": 714.193, "synch_weights_time_ms": 13.553}, "counters": {"num_env_steps_sampled": 3096, "num_env_steps_trained": 3096, "num_agent_steps_sampled": 3096, "num_agent_steps_trained": 3096}, "done": false, "episodes_total": 295, "training_iteration": 6, "trial_id": "fe178_00000", "date": "2024-08-15_16-58-49", "timestamp": 1723762729, "time_this_iter_s": 57.48080778121948, "time_total_s": 381.6072783470154, "pid": 67484, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 381.6072783470154, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 27.931707317073172, "ram_util_percent": 13.092682926829264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5414815872907637, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.200342281659444, "policy_loss": -0.02570053331243495, "vf_loss": 7.2186722954114275, "vf_explained_var": 0.1837244043747584, "kl": 0.007370564736599333, "entropy": 1.1657620052496591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3612, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 3612, "num_agent_steps_trained": 3612}, "sampler_results": {"episode_reward_max": 196.7087532348856, "episode_reward_min": -24.56806971738763, "episode_reward_mean": 29.989366355406418, "episode_len_mean": 15.17, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 1517, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.637056991040424, 8.309130859375045, -5.477017938718518, 9.146576132365396, -18.5702414040108, -8.199523907282298, -16.393823242187523, 112.62580776823926, 16.60871018701782, 8.343640136718705, 92.81499174987161, 5.048732149743884, -1.4205029027442038, 5.078153197047527, 43.1987346061549, 31.71340820817585, -3.7822998046874545, 12.290700767515204, -7.1988310929341, -9.772457067384892, -10.18536629722685, 12.817862812175576, 118.77602500798832, 5.25006103515625, 5.23012973248774, -24.56806971738763, 4.971248109421083, 65.0709407593007, 62.024117246472315, 129.6730652991169, 0.9312930157133792, 8.421862141498934, 14.090725133982744, 31.902214607819005, 112.85223129176234, -15.570326397254462, -3.395983886718682, -7.161273709621199, 69.44784502308248, 17.481899137626442, 6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524, 128.86863618292404, 15.898986371573756, 10.585625692286271, 13.191426595579514, -14.257255224793312, 18.638301214932355, 3.187888367485982, 138.4653618582825, 21.908668016373568, 104.98047708620577, -12.866908873210832, 24.744867847883853, 2.263592185368438, -22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165], "episode_lengths": [3, 10, 4, 12, 3, 5, 7, 37, 17, 6, 22, 9, 10, 5, 24, 10, 12, 15, 1, 9, 12, 7, 50, 10, 4, 3, 8, 25, 22, 37, 8, 11, 5, 12, 30, 3, 3, 6, 34, 10, 9, 18, 20, 10, 7, 50, 7, 5, 8, 5, 10, 10, 50, 12, 30, 4, 10, 7, 8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.472658636211868, "mean_inference_ms": 1.2894716896124816, "mean_action_processing_ms": 0.21118182494231366, "mean_env_wait_ms": 602.4690661983801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010721445083618164, "StateBufferConnector_ms": 0.015803098678588867, "ViewRequirementAgentConnector_ms": 0.17909693717956543}, "num_episodes": 23, "episode_return_max": 196.7087532348856, "episode_return_min": -24.56806971738763, "episode_return_mean": 29.989366355406418}, "env_runner_results": {"episode_reward_max": 196.7087532348856, "episode_reward_min": -24.56806971738763, "episode_reward_mean": 29.989366355406418, "episode_len_mean": 15.17, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 1517, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.637056991040424, 8.309130859375045, -5.477017938718518, 9.146576132365396, -18.5702414040108, -8.199523907282298, -16.393823242187523, 112.62580776823926, 16.60871018701782, 8.343640136718705, 92.81499174987161, 5.048732149743884, -1.4205029027442038, 5.078153197047527, 43.1987346061549, 31.71340820817585, -3.7822998046874545, 12.290700767515204, -7.1988310929341, -9.772457067384892, -10.18536629722685, 12.817862812175576, 118.77602500798832, 5.25006103515625, 5.23012973248774, -24.56806971738763, 4.971248109421083, 65.0709407593007, 62.024117246472315, 129.6730652991169, 0.9312930157133792, 8.421862141498934, 14.090725133982744, 31.902214607819005, 112.85223129176234, -15.570326397254462, -3.395983886718682, -7.161273709621199, 69.44784502308248, 17.481899137626442, 6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524, 128.86863618292404, 15.898986371573756, 10.585625692286271, 13.191426595579514, -14.257255224793312, 18.638301214932355, 3.187888367485982, 138.4653618582825, 21.908668016373568, 104.98047708620577, -12.866908873210832, 24.744867847883853, 2.263592185368438, -22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165], "episode_lengths": [3, 10, 4, 12, 3, 5, 7, 37, 17, 6, 22, 9, 10, 5, 24, 10, 12, 15, 1, 9, 12, 7, 50, 10, 4, 3, 8, 25, 22, 37, 8, 11, 5, 12, 30, 3, 3, 6, 34, 10, 9, 18, 20, 10, 7, 50, 7, 5, 8, 5, 10, 10, 50, 12, 30, 4, 10, 7, 8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.472658636211868, "mean_inference_ms": 1.2894716896124816, "mean_action_processing_ms": 0.21118182494231366, "mean_env_wait_ms": 602.4690661983801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010721445083618164, "StateBufferConnector_ms": 0.015803098678588867, "ViewRequirementAgentConnector_ms": 0.17909693717956543}, "num_episodes": 23, "episode_return_max": 196.7087532348856, "episode_return_min": -24.56806971738763, "episode_return_mean": 29.989366355406418}, "episode_reward_max": 196.7087532348856, "episode_reward_min": -24.56806971738763, "episode_reward_mean": 29.989366355406418, "episode_len_mean": 15.17, "episodes_this_iter": 23, "episodes_timesteps_total": 1517, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-7.637056991040424, 8.309130859375045, -5.477017938718518, 9.146576132365396, -18.5702414040108, -8.199523907282298, -16.393823242187523, 112.62580776823926, 16.60871018701782, 8.343640136718705, 92.81499174987161, 5.048732149743884, -1.4205029027442038, 5.078153197047527, 43.1987346061549, 31.71340820817585, -3.7822998046874545, 12.290700767515204, -7.1988310929341, -9.772457067384892, -10.18536629722685, 12.817862812175576, 118.77602500798832, 5.25006103515625, 5.23012973248774, -24.56806971738763, 4.971248109421083, 65.0709407593007, 62.024117246472315, 129.6730652991169, 0.9312930157133792, 8.421862141498934, 14.090725133982744, 31.902214607819005, 112.85223129176234, -15.570326397254462, -3.395983886718682, -7.161273709621199, 69.44784502308248, 17.481899137626442, 6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524, 128.86863618292404, 15.898986371573756, 10.585625692286271, 13.191426595579514, -14.257255224793312, 18.638301214932355, 3.187888367485982, 138.4653618582825, 21.908668016373568, 104.98047708620577, -12.866908873210832, 24.744867847883853, 2.263592185368438, -22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165], "episode_lengths": [3, 10, 4, 12, 3, 5, 7, 37, 17, 6, 22, 9, 10, 5, 24, 10, 12, 15, 1, 9, 12, 7, 50, 10, 4, 3, 8, 25, 22, 37, 8, 11, 5, 12, 30, 3, 3, 6, 34, 10, 9, 18, 20, 10, 7, 50, 7, 5, 8, 5, 10, 10, 50, 12, 30, 4, 10, 7, 8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.472658636211868, "mean_inference_ms": 1.2894716896124816, "mean_action_processing_ms": 0.21118182494231366, "mean_env_wait_ms": 602.4690661983801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010721445083618164, "StateBufferConnector_ms": 0.015803098678588867, "ViewRequirementAgentConnector_ms": 0.17909693717956543}, "num_episodes": 23, "episode_return_max": 196.7087532348856, "episode_return_min": -24.56806971738763, "episode_return_mean": 29.989366355406418, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3612, "num_agent_steps_trained": 3612, "num_env_steps_sampled": 3612, "num_env_steps_trained": 3612, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.498733167934569, "num_env_steps_trained_throughput_per_sec": 8.498733167934569, "timesteps_total": 3612, "num_env_steps_sampled_lifetime": 3612, "num_agent_steps_sampled_lifetime": 3612, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 3612, "timers": {"training_iteration_time_ms": 63185.47, "restore_workers_time_ms": 0.027, "training_step_time_ms": 63185.403, "sample_time_ms": 62457.126, "load_time_ms": 0.43, "load_throughput": 1200651.93, "learn_time_ms": 714.116, "learn_throughput": 722.572, "synch_weights_time_ms": 13.428}, "counters": {"num_env_steps_sampled": 3612, "num_env_steps_trained": 3612, "num_agent_steps_sampled": 3612, "num_agent_steps_trained": 3612}, "done": false, "episodes_total": 318, "training_iteration": 7, "trial_id": "fe178_00000", "date": "2024-08-15_16-59-50", "timestamp": 1723762790, "time_this_iter_s": 60.71845602989197, "time_total_s": 442.32573437690735, "pid": 67484, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 442.32573437690735, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.318390804597705, "ram_util_percent": 13.327586206896559}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.541007263461749, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.1265071074167885, "policy_loss": -0.020415540039539336, "vf_loss": 7.141800324122111, "vf_explained_var": 0.3417036637663841, "kl": 0.0051222408011313445, "entropy": 1.1670457849899927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4128, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 4128, "num_agent_steps_trained": 4128}, "sampler_results": {"episode_reward_max": 196.7087532348856, "episode_reward_min": -24.56806971738763, "episode_reward_mean": 39.246179582095294, "episode_len_mean": 17.88, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 1788, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.25006103515625, 5.23012973248774, -24.56806971738763, 4.971248109421083, 65.0709407593007, 62.024117246472315, 129.6730652991169, 0.9312930157133792, 8.421862141498934, 14.090725133982744, 31.902214607819005, 112.85223129176234, -15.570326397254462, -3.395983886718682, -7.161273709621199, 69.44784502308248, 17.481899137626442, 6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524, 128.86863618292404, 15.898986371573756, 10.585625692286271, 13.191426595579514, -14.257255224793312, 18.638301214932355, 3.187888367485982, 138.4653618582825, 21.908668016373568, 104.98047708620577, -12.866908873210832, 24.744867847883853, 2.263592185368438, -22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456], "episode_lengths": [10, 4, 3, 8, 25, 22, 37, 8, 11, 5, 12, 30, 3, 3, 6, 34, 10, 9, 18, 20, 10, 7, 50, 7, 5, 8, 5, 10, 10, 50, 12, 30, 4, 10, 7, 8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.673429391236997, "mean_inference_ms": 1.2863702856444013, "mean_action_processing_ms": 0.21028656920330413, "mean_env_wait_ms": 601.1453175341126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010777950286865234, "StateBufferConnector_ms": 0.014666080474853516, "ViewRequirementAgentConnector_ms": 0.17705535888671875}, "num_episodes": 23, "episode_return_max": 196.7087532348856, "episode_return_min": -24.56806971738763, "episode_return_mean": 39.246179582095294}, "env_runner_results": {"episode_reward_max": 196.7087532348856, "episode_reward_min": -24.56806971738763, "episode_reward_mean": 39.246179582095294, "episode_len_mean": 17.88, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 1788, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.25006103515625, 5.23012973248774, -24.56806971738763, 4.971248109421083, 65.0709407593007, 62.024117246472315, 129.6730652991169, 0.9312930157133792, 8.421862141498934, 14.090725133982744, 31.902214607819005, 112.85223129176234, -15.570326397254462, -3.395983886718682, -7.161273709621199, 69.44784502308248, 17.481899137626442, 6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524, 128.86863618292404, 15.898986371573756, 10.585625692286271, 13.191426595579514, -14.257255224793312, 18.638301214932355, 3.187888367485982, 138.4653618582825, 21.908668016373568, 104.98047708620577, -12.866908873210832, 24.744867847883853, 2.263592185368438, -22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456], "episode_lengths": [10, 4, 3, 8, 25, 22, 37, 8, 11, 5, 12, 30, 3, 3, 6, 34, 10, 9, 18, 20, 10, 7, 50, 7, 5, 8, 5, 10, 10, 50, 12, 30, 4, 10, 7, 8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.673429391236997, "mean_inference_ms": 1.2863702856444013, "mean_action_processing_ms": 0.21028656920330413, "mean_env_wait_ms": 601.1453175341126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010777950286865234, "StateBufferConnector_ms": 0.014666080474853516, "ViewRequirementAgentConnector_ms": 0.17705535888671875}, "num_episodes": 23, "episode_return_max": 196.7087532348856, "episode_return_min": -24.56806971738763, "episode_return_mean": 39.246179582095294}, "episode_reward_max": 196.7087532348856, "episode_reward_min": -24.56806971738763, "episode_reward_mean": 39.246179582095294, "episode_len_mean": 17.88, "episodes_this_iter": 23, "episodes_timesteps_total": 1788, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.25006103515625, 5.23012973248774, -24.56806971738763, 4.971248109421083, 65.0709407593007, 62.024117246472315, 129.6730652991169, 0.9312930157133792, 8.421862141498934, 14.090725133982744, 31.902214607819005, 112.85223129176234, -15.570326397254462, -3.395983886718682, -7.161273709621199, 69.44784502308248, 17.481899137626442, 6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524, 128.86863618292404, 15.898986371573756, 10.585625692286271, 13.191426595579514, -14.257255224793312, 18.638301214932355, 3.187888367485982, 138.4653618582825, 21.908668016373568, 104.98047708620577, -12.866908873210832, 24.744867847883853, 2.263592185368438, -22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456], "episode_lengths": [10, 4, 3, 8, 25, 22, 37, 8, 11, 5, 12, 30, 3, 3, 6, 34, 10, 9, 18, 20, 10, 7, 50, 7, 5, 8, 5, 10, 10, 50, 12, 30, 4, 10, 7, 8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.673429391236997, "mean_inference_ms": 1.2863702856444013, "mean_action_processing_ms": 0.21028656920330413, "mean_env_wait_ms": 601.1453175341126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010777950286865234, "StateBufferConnector_ms": 0.014666080474853516, "ViewRequirementAgentConnector_ms": 0.17705535888671875}, "num_episodes": 23, "episode_return_max": 196.7087532348856, "episode_return_min": -24.56806971738763, "episode_return_mean": 39.246179582095294, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4128, "num_agent_steps_trained": 4128, "num_env_steps_sampled": 4128, "num_env_steps_trained": 4128, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.815820042343748, "num_env_steps_trained_throughput_per_sec": 8.815820042343748, "timesteps_total": 4128, "num_env_steps_sampled_lifetime": 4128, "num_agent_steps_sampled_lifetime": 4128, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 4128, "timers": {"training_iteration_time_ms": 62603.682, "restore_workers_time_ms": 0.026, "training_step_time_ms": 62603.616, "sample_time_ms": 61885.26, "load_time_ms": 0.417, "load_throughput": 1238312.61, "learn_time_ms": 704.273, "learn_throughput": 732.671, "synch_weights_time_ms": 13.37}, "counters": {"num_env_steps_sampled": 4128, "num_env_steps_trained": 4128, "num_agent_steps_sampled": 4128, "num_agent_steps_trained": 4128}, "done": false, "episodes_total": 341, "training_iteration": 8, "trial_id": "fe178_00000", "date": "2024-08-15_17-00-49", "timestamp": 1723762849, "time_this_iter_s": 58.534765005111694, "time_total_s": 500.86049938201904, "pid": 67484, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 500.86049938201904, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 27.069047619047616, "ram_util_percent": 13.492857142857138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.687074306607246, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4019883116086325, "policy_loss": -0.021590227959677577, "vf_loss": 7.417380968729655, "vf_explained_var": 0.28498925069967906, "kl": 0.006197595228701614, "entropy": 1.1358976205190023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4644, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 4644, "num_agent_steps_trained": 4644}, "sampler_results": {"episode_reward_max": 196.7087532348856, "episode_reward_min": -24.144970703125068, "episode_reward_mean": 46.67689556005725, "episode_len_mean": 19.69, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 1969, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524, 128.86863618292404, 15.898986371573756, 10.585625692286271, 13.191426595579514, -14.257255224793312, 18.638301214932355, 3.187888367485982, 138.4653618582825, 21.908668016373568, 104.98047708620577, -12.866908873210832, 24.744867847883853, 2.263592185368438, -22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423], "episode_lengths": [9, 18, 20, 10, 7, 50, 7, 5, 8, 5, 10, 10, 50, 12, 30, 4, 10, 7, 8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.02279758213799, "mean_inference_ms": 1.2856112933222914, "mean_action_processing_ms": 0.21101243335217743, "mean_env_wait_ms": 602.4536134516164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010379314422607422, "StateBufferConnector_ms": 0.013946294784545898, "ViewRequirementAgentConnector_ms": 0.17664337158203125}, "num_episodes": 17, "episode_return_max": 196.7087532348856, "episode_return_min": -24.144970703125068, "episode_return_mean": 46.67689556005725}, "env_runner_results": {"episode_reward_max": 196.7087532348856, "episode_reward_min": -24.144970703125068, "episode_reward_mean": 46.67689556005725, "episode_len_mean": 19.69, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 1969, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524, 128.86863618292404, 15.898986371573756, 10.585625692286271, 13.191426595579514, -14.257255224793312, 18.638301214932355, 3.187888367485982, 138.4653618582825, 21.908668016373568, 104.98047708620577, -12.866908873210832, 24.744867847883853, 2.263592185368438, -22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423], "episode_lengths": [9, 18, 20, 10, 7, 50, 7, 5, 8, 5, 10, 10, 50, 12, 30, 4, 10, 7, 8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.02279758213799, "mean_inference_ms": 1.2856112933222914, "mean_action_processing_ms": 0.21101243335217743, "mean_env_wait_ms": 602.4536134516164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010379314422607422, "StateBufferConnector_ms": 0.013946294784545898, "ViewRequirementAgentConnector_ms": 0.17664337158203125}, "num_episodes": 17, "episode_return_max": 196.7087532348856, "episode_return_min": -24.144970703125068, "episode_return_mean": 46.67689556005725}, "episode_reward_max": 196.7087532348856, "episode_reward_min": -24.144970703125068, "episode_reward_mean": 46.67689556005725, "episode_len_mean": 19.69, "episodes_this_iter": 17, "episodes_timesteps_total": 1969, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.454373937882195, 36.964026790005335, 68.4311790931864, 32.343538222427185, 6.795941521443524, 128.86863618292404, 15.898986371573756, 10.585625692286271, 13.191426595579514, -14.257255224793312, 18.638301214932355, 3.187888367485982, 138.4653618582825, 21.908668016373568, 104.98047708620577, -12.866908873210832, 24.744867847883853, 2.263592185368438, -22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423], "episode_lengths": [9, 18, 20, 10, 7, 50, 7, 5, 8, 5, 10, 10, 50, 12, 30, 4, 10, 7, 8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.02279758213799, "mean_inference_ms": 1.2856112933222914, "mean_action_processing_ms": 0.21101243335217743, "mean_env_wait_ms": 602.4536134516164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010379314422607422, "StateBufferConnector_ms": 0.013946294784545898, "ViewRequirementAgentConnector_ms": 0.17664337158203125}, "num_episodes": 17, "episode_return_max": 196.7087532348856, "episode_return_min": -24.144970703125068, "episode_return_mean": 46.67689556005725, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4644, "num_agent_steps_trained": 4644, "num_env_steps_sampled": 4644, "num_env_steps_trained": 4644, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.801438140725825, "num_env_steps_trained_throughput_per_sec": 7.801438140725825, "timesteps_total": 4644, "num_env_steps_sampled_lifetime": 4644, "num_agent_steps_sampled_lifetime": 4644, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 4644, "timers": {"training_iteration_time_ms": 62996.79, "restore_workers_time_ms": 0.025, "training_step_time_ms": 62996.728, "sample_time_ms": 62280.374, "load_time_ms": 0.406, "load_throughput": 1270437.502, "learn_time_ms": 702.313, "learn_throughput": 734.715, "synch_weights_time_ms": 13.348}, "counters": {"num_env_steps_sampled": 4644, "num_env_steps_trained": 4644, "num_agent_steps_sampled": 4644, "num_agent_steps_trained": 4644}, "done": false, "episodes_total": 358, "training_iteration": 9, "trial_id": "fe178_00000", "date": "2024-08-15_17-01-55", "timestamp": 1723762915, "time_this_iter_s": 66.14480900764465, "time_total_s": 567.0053083896637, "pid": 67484, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 567.0053083896637, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.147872340425533, "ram_util_percent": 13.659574468085106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.112551435828209, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.433054876327515, "policy_loss": -0.03012565684039146, "vf_loss": 7.457942422231039, "vf_explained_var": 0.35651820798714956, "kl": 0.005238163688955157, "entropy": 1.082805163661639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5160, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 5160, "num_agent_steps_trained": 5160}, "sampler_results": {"episode_reward_max": 199.10919576622223, "episode_reward_min": -24.144970703125068, "episode_reward_mean": 58.05310946304422, "episode_len_mean": 22.84, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 2284, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423, 199.10919576622223, 195.46431119279168, 15.060530691138396, 25.024508062888955, 139.48703916990962, 136.82278370164082, 154.86882968470798, 108.27139233918915, 79.56604057224587, 1.6032164298974863, 57.67040476876275, 145.76562054580492, 11.199149326743907, 160.4521746572088, 129.99746412600604, 32.56316586571535, 84.62062536727962, 66.67366491638029], "episode_lengths": [8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50, 50, 50, 11, 11, 32, 50, 47, 50, 31, 11, 19, 50, 8, 50, 50, 9, 28, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.12386863379582, "mean_inference_ms": 1.2829754621320568, "mean_action_processing_ms": 0.21031399619624772, "mean_env_wait_ms": 606.1375305471986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010445356369018555, "StateBufferConnector_ms": 0.012706279754638672, "ViewRequirementAgentConnector_ms": 0.17444610595703125}, "num_episodes": 18, "episode_return_max": 199.10919576622223, "episode_return_min": -24.144970703125068, "episode_return_mean": 58.05310946304422}, "env_runner_results": {"episode_reward_max": 199.10919576622223, "episode_reward_min": -24.144970703125068, "episode_reward_mean": 58.05310946304422, "episode_len_mean": 22.84, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 2284, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423, 199.10919576622223, 195.46431119279168, 15.060530691138396, 25.024508062888955, 139.48703916990962, 136.82278370164082, 154.86882968470798, 108.27139233918915, 79.56604057224587, 1.6032164298974863, 57.67040476876275, 145.76562054580492, 11.199149326743907, 160.4521746572088, 129.99746412600604, 32.56316586571535, 84.62062536727962, 66.67366491638029], "episode_lengths": [8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50, 50, 50, 11, 11, 32, 50, 47, 50, 31, 11, 19, 50, 8, 50, 50, 9, 28, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.12386863379582, "mean_inference_ms": 1.2829754621320568, "mean_action_processing_ms": 0.21031399619624772, "mean_env_wait_ms": 606.1375305471986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010445356369018555, "StateBufferConnector_ms": 0.012706279754638672, "ViewRequirementAgentConnector_ms": 0.17444610595703125}, "num_episodes": 18, "episode_return_max": 199.10919576622223, "episode_return_min": -24.144970703125068, "episode_return_mean": 58.05310946304422}, "episode_reward_max": 199.10919576622223, "episode_reward_min": -24.144970703125068, "episode_reward_mean": 58.05310946304422, "episode_len_mean": 22.84, "episodes_this_iter": 18, "episodes_timesteps_total": 2284, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22.961804199218705, 61.11369722885824, 3.331164403938658, 4.581206282633843, 13.993436248419357, 3.2062444033264086, -24.144970703125068, -5.5624575800278535, 15.385417537826967, 32.42587354148543, 5.5718505859374545, -1.3403517338434767, 81.15069161385199, 42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423, 199.10919576622223, 195.46431119279168, 15.060530691138396, 25.024508062888955, 139.48703916990962, 136.82278370164082, 154.86882968470798, 108.27139233918915, 79.56604057224587, 1.6032164298974863, 57.67040476876275, 145.76562054580492, 11.199149326743907, 160.4521746572088, 129.99746412600604, 32.56316586571535, 84.62062536727962, 66.67366491638029], "episode_lengths": [8, 18, 7, 5, 6, 9, 3, 16, 10, 10, 12, 5, 31, 24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50, 50, 50, 11, 11, 32, 50, 47, 50, 31, 11, 19, 50, 8, 50, 50, 9, 28, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.12386863379582, "mean_inference_ms": 1.2829754621320568, "mean_action_processing_ms": 0.21031399619624772, "mean_env_wait_ms": 606.1375305471986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010445356369018555, "StateBufferConnector_ms": 0.012706279754638672, "ViewRequirementAgentConnector_ms": 0.17444610595703125}, "num_episodes": 18, "episode_return_max": 199.10919576622223, "episode_return_min": -24.144970703125068, "episode_return_mean": 58.05310946304422, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160, "num_agent_steps_trained": 5160, "num_env_steps_sampled": 5160, "num_env_steps_trained": 5160, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.761017862899267, "num_env_steps_trained_throughput_per_sec": 7.761017862899267, "timesteps_total": 5160, "num_env_steps_sampled_lifetime": 5160, "num_agent_steps_sampled_lifetime": 5160, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 5160, "timers": {"training_iteration_time_ms": 63345.725, "restore_workers_time_ms": 0.023, "training_step_time_ms": 63345.665, "sample_time_ms": 62632.007, "load_time_ms": 0.396, "load_throughput": 1303693.069, "learn_time_ms": 699.613, "learn_throughput": 737.551, "synch_weights_time_ms": 13.364}, "counters": {"num_env_steps_sampled": 5160, "num_env_steps_trained": 5160, "num_agent_steps_sampled": 5160, "num_agent_steps_trained": 5160}, "done": false, "episodes_total": 376, "training_iteration": 10, "trial_id": "fe178_00000", "date": "2024-08-15_17-03-01", "timestamp": 1723762981, "time_this_iter_s": 66.49016976356506, "time_total_s": 633.4954781532288, "pid": 67484, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 633.4954781532288, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 23.62105263157894, "ram_util_percent": 13.777894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.230866152048111, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.979392663637797, "policy_loss": -0.02408946251186232, "vf_loss": 6.997389789422353, "vf_explained_var": 0.46619708836078644, "kl": 0.0060923388179389805, "entropy": 1.1156974494457246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5676, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 5676, "num_agent_steps_trained": 5676}, "sampler_results": {"episode_reward_max": 204.1876413339251, "episode_reward_min": -21.660324505649214, "episode_reward_mean": 70.00323308279019, "episode_len_mean": 25.91, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 2591, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423, 199.10919576622223, 195.46431119279168, 15.060530691138396, 25.024508062888955, 139.48703916990962, 136.82278370164082, 154.86882968470798, 108.27139233918915, 79.56604057224587, 1.6032164298974863, 57.67040476876275, 145.76562054580492, 11.199149326743907, 160.4521746572088, 129.99746412600604, 32.56316586571535, 84.62062536727962, 66.67366491638029, 135.8623925366266, 103.40687742751618, 21.36065417738996, 83.14780908971278, 23.063893705443263, 199.877416258663, 182.9438649353089, 46.175842317853025, 204.1876413339251, 20.018277483972213, 160.22414453835688, 170.15672695702708, 11.336818842864474], "episode_lengths": [24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50, 50, 50, 11, 11, 32, 50, 47, 50, 31, 11, 19, 50, 8, 50, 50, 9, 28, 30, 50, 50, 8, 33, 9, 50, 50, 27, 50, 10, 50, 50, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.47067962209206, "mean_inference_ms": 1.2815913154522398, "mean_action_processing_ms": 0.2103959033717503, "mean_env_wait_ms": 609.1123313276571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01029515266418457, "StateBufferConnector_ms": 0.011661767959594727, "ViewRequirementAgentConnector_ms": 0.17419123649597168}, "num_episodes": 13, "episode_return_max": 204.1876413339251, "episode_return_min": -21.660324505649214, "episode_return_mean": 70.00323308279019}, "env_runner_results": {"episode_reward_max": 204.1876413339251, "episode_reward_min": -21.660324505649214, "episode_reward_mean": 70.00323308279019, "episode_len_mean": 25.91, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 2591, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423, 199.10919576622223, 195.46431119279168, 15.060530691138396, 25.024508062888955, 139.48703916990962, 136.82278370164082, 154.86882968470798, 108.27139233918915, 79.56604057224587, 1.6032164298974863, 57.67040476876275, 145.76562054580492, 11.199149326743907, 160.4521746572088, 129.99746412600604, 32.56316586571535, 84.62062536727962, 66.67366491638029, 135.8623925366266, 103.40687742751618, 21.36065417738996, 83.14780908971278, 23.063893705443263, 199.877416258663, 182.9438649353089, 46.175842317853025, 204.1876413339251, 20.018277483972213, 160.22414453835688, 170.15672695702708, 11.336818842864474], "episode_lengths": [24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50, 50, 50, 11, 11, 32, 50, 47, 50, 31, 11, 19, 50, 8, 50, 50, 9, 28, 30, 50, 50, 8, 33, 9, 50, 50, 27, 50, 10, 50, 50, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.47067962209206, "mean_inference_ms": 1.2815913154522398, "mean_action_processing_ms": 0.2103959033717503, "mean_env_wait_ms": 609.1123313276571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01029515266418457, "StateBufferConnector_ms": 0.011661767959594727, "ViewRequirementAgentConnector_ms": 0.17419123649597168}, "num_episodes": 13, "episode_return_max": 204.1876413339251, "episode_return_min": -21.660324505649214, "episode_return_mean": 70.00323308279019}, "episode_reward_max": 204.1876413339251, "episode_reward_min": -21.660324505649214, "episode_reward_mean": 70.00323308279019, "episode_len_mean": 25.91, "episodes_this_iter": 13, "episodes_timesteps_total": 2591, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.996270478368956, 70.30241752488467, 21.827103406382818, 39.20074663739558, 12.8313641751634, -2.1727071737383454, 140.20897918090355, 7.297222469417136, 196.7087532348856, -6.235043854635762, 7.256176757812568, 149.950832732756, 77.50832214385548, 84.2649509481004, -21.660324505649214, -12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423, 199.10919576622223, 195.46431119279168, 15.060530691138396, 25.024508062888955, 139.48703916990962, 136.82278370164082, 154.86882968470798, 108.27139233918915, 79.56604057224587, 1.6032164298974863, 57.67040476876275, 145.76562054580492, 11.199149326743907, 160.4521746572088, 129.99746412600604, 32.56316586571535, 84.62062536727962, 66.67366491638029, 135.8623925366266, 103.40687742751618, 21.36065417738996, 83.14780908971278, 23.063893705443263, 199.877416258663, 182.9438649353089, 46.175842317853025, 204.1876413339251, 20.018277483972213, 160.22414453835688, 170.15672695702708, 11.336818842864474], "episode_lengths": [24, 42, 8, 10, 7, 11, 50, 10, 50, 4, 7, 45, 35, 33, 4, 6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50, 50, 50, 11, 11, 32, 50, 47, 50, 31, 11, 19, 50, 8, 50, 50, 9, 28, 30, 50, 50, 8, 33, 9, 50, 50, 27, 50, 10, 50, 50, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.47067962209206, "mean_inference_ms": 1.2815913154522398, "mean_action_processing_ms": 0.2103959033717503, "mean_env_wait_ms": 609.1123313276571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01029515266418457, "StateBufferConnector_ms": 0.011661767959594727, "ViewRequirementAgentConnector_ms": 0.17419123649597168}, "num_episodes": 13, "episode_return_max": 204.1876413339251, "episode_return_min": -21.660324505649214, "episode_return_mean": 70.00323308279019, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5676, "num_agent_steps_trained": 5676, "num_env_steps_sampled": 5676, "num_env_steps_trained": 5676, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.710163818514074, "num_env_steps_trained_throughput_per_sec": 8.710163818514074, "timesteps_total": 5676, "num_env_steps_sampled_lifetime": 5676, "num_agent_steps_sampled_lifetime": 5676, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 5676, "timers": {"training_iteration_time_ms": 61968.263, "restore_workers_time_ms": 0.022, "training_step_time_ms": 61968.206, "sample_time_ms": 61284.468, "load_time_ms": 0.352, "load_throughput": 1464317.229, "learn_time_ms": 669.8, "learn_throughput": 770.379, "synch_weights_time_ms": 13.327}, "counters": {"num_env_steps_sampled": 5676, "num_env_steps_trained": 5676, "num_agent_steps_sampled": 5676, "num_agent_steps_trained": 5676}, "done": false, "episodes_total": 389, "training_iteration": 11, "trial_id": "fe178_00000", "date": "2024-08-15_17-04-01", "timestamp": 1723763041, "time_this_iter_s": 59.24495482444763, "time_total_s": 692.7404329776764, "pid": 67484, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 692.7404329776764, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.034117647058824, "ram_util_percent": 13.902352941176474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.744213138024012, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.185375213623047, "policy_loss": -0.03817549537246426, "vf_loss": 7.216999304294586, "vf_explained_var": 0.5052637428045272, "kl": 0.006551430158985265, "entropy": 1.0547116329272588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6192, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 6192, "num_agent_steps_trained": 6192}, "sampler_results": {"episode_reward_max": 243.60873571023495, "episode_reward_min": -17.00640478004601, "episode_reward_mean": 82.28030208626029, "episode_len_mean": 28.55, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 2855, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423, 199.10919576622223, 195.46431119279168, 15.060530691138396, 25.024508062888955, 139.48703916990962, 136.82278370164082, 154.86882968470798, 108.27139233918915, 79.56604057224587, 1.6032164298974863, 57.67040476876275, 145.76562054580492, 11.199149326743907, 160.4521746572088, 129.99746412600604, 32.56316586571535, 84.62062536727962, 66.67366491638029, 135.8623925366266, 103.40687742751618, 21.36065417738996, 83.14780908971278, 23.063893705443263, 199.877416258663, 182.9438649353089, 46.175842317853025, 204.1876413339251, 20.018277483972213, 160.22414453835688, 170.15672695702708, 11.336818842864474, 173.629752081885, 243.60873571023495, 153.9524499958619, 199.72551595697195, 138.80597049728726, 109.5125280687605, 149.10419419319004, 196.6335159384662, 163.97539473422074, 38.31121079959733, 18.841142140926877, 95.65113078717718, 94.25239140458727, 176.94525220028675, 95.0427799934602], "episode_lengths": [6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50, 50, 50, 11, 11, 32, 50, 47, 50, 31, 11, 19, 50, 8, 50, 50, 9, 28, 30, 50, 50, 8, 33, 9, 50, 50, 27, 50, 10, 50, 50, 10, 50, 50, 50, 50, 50, 44, 48, 50, 40, 11, 8, 24, 32, 50, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.7235259045877, "mean_inference_ms": 1.279520933459318, "mean_action_processing_ms": 0.21007849936265954, "mean_env_wait_ms": 611.3596373372807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010211944580078125, "StateBufferConnector_ms": 0.010869264602661133, "ViewRequirementAgentConnector_ms": 0.17364788055419922}, "num_episodes": 15, "episode_return_max": 243.60873571023495, "episode_return_min": -17.00640478004601, "episode_return_mean": 82.28030208626029}, "env_runner_results": {"episode_reward_max": 243.60873571023495, "episode_reward_min": -17.00640478004601, "episode_reward_mean": 82.28030208626029, "episode_len_mean": 28.55, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 2855, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423, 199.10919576622223, 195.46431119279168, 15.060530691138396, 25.024508062888955, 139.48703916990962, 136.82278370164082, 154.86882968470798, 108.27139233918915, 79.56604057224587, 1.6032164298974863, 57.67040476876275, 145.76562054580492, 11.199149326743907, 160.4521746572088, 129.99746412600604, 32.56316586571535, 84.62062536727962, 66.67366491638029, 135.8623925366266, 103.40687742751618, 21.36065417738996, 83.14780908971278, 23.063893705443263, 199.877416258663, 182.9438649353089, 46.175842317853025, 204.1876413339251, 20.018277483972213, 160.22414453835688, 170.15672695702708, 11.336818842864474, 173.629752081885, 243.60873571023495, 153.9524499958619, 199.72551595697195, 138.80597049728726, 109.5125280687605, 149.10419419319004, 196.6335159384662, 163.97539473422074, 38.31121079959733, 18.841142140926877, 95.65113078717718, 94.25239140458727, 176.94525220028675, 95.0427799934602], "episode_lengths": [6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50, 50, 50, 11, 11, 32, 50, 47, 50, 31, 11, 19, 50, 8, 50, 50, 9, 28, 30, 50, 50, 8, 33, 9, 50, 50, 27, 50, 10, 50, 50, 10, 50, 50, 50, 50, 50, 44, 48, 50, 40, 11, 8, 24, 32, 50, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.7235259045877, "mean_inference_ms": 1.279520933459318, "mean_action_processing_ms": 0.21007849936265954, "mean_env_wait_ms": 611.3596373372807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010211944580078125, "StateBufferConnector_ms": 0.010869264602661133, "ViewRequirementAgentConnector_ms": 0.17364788055419922}, "num_episodes": 15, "episode_return_max": 243.60873571023495, "episode_return_min": -17.00640478004601, "episode_return_mean": 82.28030208626029}, "episode_reward_max": 243.60873571023495, "episode_reward_min": -17.00640478004601, "episode_reward_mean": 82.28030208626029, "episode_len_mean": 28.55, "episodes_this_iter": 15, "episodes_timesteps_total": 2855, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.671684453310775, 99.7049471552481, 34.54831289645681, 116.53604792107853, 82.9425561673703, -17.00640478004601, 10.695382673442111, 97.53293503061035, 32.72756364994922, 10.6316145048215, 26.66314886781406, 3.2764848513529614, 31.084901774759885, 23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423, 199.10919576622223, 195.46431119279168, 15.060530691138396, 25.024508062888955, 139.48703916990962, 136.82278370164082, 154.86882968470798, 108.27139233918915, 79.56604057224587, 1.6032164298974863, 57.67040476876275, 145.76562054580492, 11.199149326743907, 160.4521746572088, 129.99746412600604, 32.56316586571535, 84.62062536727962, 66.67366491638029, 135.8623925366266, 103.40687742751618, 21.36065417738996, 83.14780908971278, 23.063893705443263, 199.877416258663, 182.9438649353089, 46.175842317853025, 204.1876413339251, 20.018277483972213, 160.22414453835688, 170.15672695702708, 11.336818842864474, 173.629752081885, 243.60873571023495, 153.9524499958619, 199.72551595697195, 138.80597049728726, 109.5125280687605, 149.10419419319004, 196.6335159384662, 163.97539473422074, 38.31121079959733, 18.841142140926877, 95.65113078717718, 94.25239140458727, 176.94525220028675, 95.0427799934602], "episode_lengths": [6, 33, 10, 42, 40, 3, 11, 26, 31, 6, 7, 10, 9, 10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50, 50, 50, 11, 11, 32, 50, 47, 50, 31, 11, 19, 50, 8, 50, 50, 9, 28, 30, 50, 50, 8, 33, 9, 50, 50, 27, 50, 10, 50, 50, 10, 50, 50, 50, 50, 50, 44, 48, 50, 40, 11, 8, 24, 32, 50, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.7235259045877, "mean_inference_ms": 1.279520933459318, "mean_action_processing_ms": 0.21007849936265954, "mean_env_wait_ms": 611.3596373372807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010211944580078125, "StateBufferConnector_ms": 0.010869264602661133, "ViewRequirementAgentConnector_ms": 0.17364788055419922}, "num_episodes": 15, "episode_return_max": 243.60873571023495, "episode_return_min": -17.00640478004601, "episode_return_mean": 82.28030208626029, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6192, "num_agent_steps_trained": 6192, "num_env_steps_sampled": 6192, "num_env_steps_trained": 6192, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.648991970990334, "num_env_steps_trained_throughput_per_sec": 8.648991970990334, "timesteps_total": 6192, "num_env_steps_sampled_lifetime": 6192, "num_agent_steps_sampled_lifetime": 6192, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 6192, "timers": {"training_iteration_time_ms": 61599.7, "restore_workers_time_ms": 0.019, "training_step_time_ms": 61599.648, "sample_time_ms": 60923.732, "load_time_ms": 0.344, "load_throughput": 1498276.818, "learn_time_ms": 662.151, "learn_throughput": 779.278, "synch_weights_time_ms": 13.171}, "counters": {"num_env_steps_sampled": 6192, "num_env_steps_trained": 6192, "num_agent_steps_sampled": 6192, "num_agent_steps_trained": 6192}, "done": false, "episodes_total": 404, "training_iteration": 12, "trial_id": "fe178_00000", "date": "2024-08-15_17-05-00", "timestamp": 1723763100, "time_this_iter_s": 59.66374135017395, "time_total_s": 752.4041743278503, "pid": 67484, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 752.4041743278503, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 26.156470588235297, "ram_util_percent": 14.024705882352935}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.3276255309581755, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.537926272551219, "policy_loss": -0.028383908172448475, "vf_loss": 7.560462741057078, "vf_explained_var": 0.44906553129355115, "kl": 0.005847471795725027, "entropy": 1.0391943509380022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6708, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 6708, "num_agent_steps_trained": 6708}, "sampler_results": {"episode_reward_max": 243.60873571023495, "episode_reward_min": -7.536816451989125, "episode_reward_mean": 93.20252002236496, "episode_len_mean": 30.98, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 3098, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423, 199.10919576622223, 195.46431119279168, 15.060530691138396, 25.024508062888955, 139.48703916990962, 136.82278370164082, 154.86882968470798, 108.27139233918915, 79.56604057224587, 1.6032164298974863, 57.67040476876275, 145.76562054580492, 11.199149326743907, 160.4521746572088, 129.99746412600604, 32.56316586571535, 84.62062536727962, 66.67366491638029, 135.8623925366266, 103.40687742751618, 21.36065417738996, 83.14780908971278, 23.063893705443263, 199.877416258663, 182.9438649353089, 46.175842317853025, 204.1876413339251, 20.018277483972213, 160.22414453835688, 170.15672695702708, 11.336818842864474, 173.629752081885, 243.60873571023495, 153.9524499958619, 199.72551595697195, 138.80597049728726, 109.5125280687605, 149.10419419319004, 196.6335159384662, 163.97539473422074, 38.31121079959733, 18.841142140926877, 95.65113078717718, 94.25239140458727, 176.94525220028675, 95.0427799934602, 129.45900001216415, 156.59953348045752, 141.43594430181992, 25.759965519310867, 171.28518111442997, 44.620734255469756, 202.30123910952577, 135.30396483696904, 111.55069968353081, 115.91110216549589, 183.60212029601928, 2.8538317610639723, 188.20428333375799], "episode_lengths": [10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50, 50, 50, 11, 11, 32, 50, 47, 50, 31, 11, 19, 50, 8, 50, 50, 9, 28, 30, 50, 50, 8, 33, 9, 50, 50, 27, 50, 10, 50, 50, 10, 50, 50, 50, 50, 50, 44, 48, 50, 40, 11, 8, 24, 32, 50, 47, 42, 50, 50, 19, 50, 11, 50, 36, 28, 30, 50, 11, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.0954891474219, "mean_inference_ms": 1.2785895846319884, "mean_action_processing_ms": 0.2103159078701546, "mean_env_wait_ms": 613.8806508517489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01011037826538086, "StateBufferConnector_ms": 0.00991201400756836, "ViewRequirementAgentConnector_ms": 0.1730968952178955}, "num_episodes": 13, "episode_return_max": 243.60873571023495, "episode_return_min": -7.536816451989125, "episode_return_mean": 93.20252002236496}, "env_runner_results": {"episode_reward_max": 243.60873571023495, "episode_reward_min": -7.536816451989125, "episode_reward_mean": 93.20252002236496, "episode_len_mean": 30.98, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 3098, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423, 199.10919576622223, 195.46431119279168, 15.060530691138396, 25.024508062888955, 139.48703916990962, 136.82278370164082, 154.86882968470798, 108.27139233918915, 79.56604057224587, 1.6032164298974863, 57.67040476876275, 145.76562054580492, 11.199149326743907, 160.4521746572088, 129.99746412600604, 32.56316586571535, 84.62062536727962, 66.67366491638029, 135.8623925366266, 103.40687742751618, 21.36065417738996, 83.14780908971278, 23.063893705443263, 199.877416258663, 182.9438649353089, 46.175842317853025, 204.1876413339251, 20.018277483972213, 160.22414453835688, 170.15672695702708, 11.336818842864474, 173.629752081885, 243.60873571023495, 153.9524499958619, 199.72551595697195, 138.80597049728726, 109.5125280687605, 149.10419419319004, 196.6335159384662, 163.97539473422074, 38.31121079959733, 18.841142140926877, 95.65113078717718, 94.25239140458727, 176.94525220028675, 95.0427799934602, 129.45900001216415, 156.59953348045752, 141.43594430181992, 25.759965519310867, 171.28518111442997, 44.620734255469756, 202.30123910952577, 135.30396483696904, 111.55069968353081, 115.91110216549589, 183.60212029601928, 2.8538317610639723, 188.20428333375799], "episode_lengths": [10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50, 50, 50, 11, 11, 32, 50, 47, 50, 31, 11, 19, 50, 8, 50, 50, 9, 28, 30, 50, 50, 8, 33, 9, 50, 50, 27, 50, 10, 50, 50, 10, 50, 50, 50, 50, 50, 44, 48, 50, 40, 11, 8, 24, 32, 50, 47, 42, 50, 50, 19, 50, 11, 50, 36, 28, 30, 50, 11, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.0954891474219, "mean_inference_ms": 1.2785895846319884, "mean_action_processing_ms": 0.2103159078701546, "mean_env_wait_ms": 613.8806508517489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01011037826538086, "StateBufferConnector_ms": 0.00991201400756836, "ViewRequirementAgentConnector_ms": 0.1730968952178955}, "num_episodes": 13, "episode_return_max": 243.60873571023495, "episode_return_min": -7.536816451989125, "episode_return_mean": 93.20252002236496}, "episode_reward_max": 243.60873571023495, "episode_reward_min": -7.536816451989125, "episode_reward_mean": 93.20252002236496, "episode_len_mean": 30.98, "episodes_this_iter": 13, "episodes_timesteps_total": 3098, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.84970885266165, 24.455482791547183, 84.61718773054841, 104.47619664920141, -7.536816451989125, 22.70985141819739, 132.30732580598135, 5.162036593613379, 5.741513223641562, 18.83957754240707, 46.744003942925815, 188.74415143984788, 4.3977573463049, 8.768775024708518, 120.11596623617783, 132.7822887001767, 41.89967989352071, 17.56233172717134, -2.373941238483553, 80.3739775641414, 10.165118976289406, 103.41665476636976, 113.85864133564449, 56.588914585116456, 184.53348516593454, 67.26619541074841, 3.18883168279541, 45.30063248907123, 127.1167228864162, 28.652942999351694, 138.35966952264394, 122.37228275978987, 17.487535782767168, 23.358867658884833, 77.06990471461427, 18.656628417968705, 22.670571169028378, 20.725461011694733, 136.93393676280374, 21.705148155197207, 164.3247600289423, 199.10919576622223, 195.46431119279168, 15.060530691138396, 25.024508062888955, 139.48703916990962, 136.82278370164082, 154.86882968470798, 108.27139233918915, 79.56604057224587, 1.6032164298974863, 57.67040476876275, 145.76562054580492, 11.199149326743907, 160.4521746572088, 129.99746412600604, 32.56316586571535, 84.62062536727962, 66.67366491638029, 135.8623925366266, 103.40687742751618, 21.36065417738996, 83.14780908971278, 23.063893705443263, 199.877416258663, 182.9438649353089, 46.175842317853025, 204.1876413339251, 20.018277483972213, 160.22414453835688, 170.15672695702708, 11.336818842864474, 173.629752081885, 243.60873571023495, 153.9524499958619, 199.72551595697195, 138.80597049728726, 109.5125280687605, 149.10419419319004, 196.6335159384662, 163.97539473422074, 38.31121079959733, 18.841142140926877, 95.65113078717718, 94.25239140458727, 176.94525220028675, 95.0427799934602, 129.45900001216415, 156.59953348045752, 141.43594430181992, 25.759965519310867, 171.28518111442997, 44.620734255469756, 202.30123910952577, 135.30396483696904, 111.55069968353081, 115.91110216549589, 183.60212029601928, 2.8538317610639723, 188.20428333375799], "episode_lengths": [10, 34, 47, 50, 6, 9, 50, 7, 11, 10, 11, 50, 7, 7, 42, 41, 22, 7, 7, 29, 6, 39, 46, 23, 50, 29, 7, 13, 50, 9, 50, 36, 11, 8, 30, 6, 11, 6, 37, 9, 50, 50, 50, 11, 11, 32, 50, 47, 50, 31, 11, 19, 50, 8, 50, 50, 9, 28, 30, 50, 50, 8, 33, 9, 50, 50, 27, 50, 10, 50, 50, 10, 50, 50, 50, 50, 50, 44, 48, 50, 40, 11, 8, 24, 32, 50, 47, 42, 50, 50, 19, 50, 11, 50, 36, 28, 30, 50, 11, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.0954891474219, "mean_inference_ms": 1.2785895846319884, "mean_action_processing_ms": 0.2103159078701546, "mean_env_wait_ms": 613.8806508517489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01011037826538086, "StateBufferConnector_ms": 0.00991201400756836, "ViewRequirementAgentConnector_ms": 0.1730968952178955}, "num_episodes": 13, "episode_return_max": 243.60873571023495, "episode_return_min": -7.536816451989125, "episode_return_mean": 93.20252002236496, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6708, "num_agent_steps_trained": 6708, "num_env_steps_sampled": 6708, "num_env_steps_trained": 6708, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.482413764473549, "num_env_steps_trained_throughput_per_sec": 8.482413764473549, "timesteps_total": 6708, "num_env_steps_sampled_lifetime": 6708, "num_agent_steps_sampled_lifetime": 6708, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 6708, "timers": {"training_iteration_time_ms": 61013.27, "restore_workers_time_ms": 0.018, "training_step_time_ms": 61013.222, "sample_time_ms": 60336.29, "load_time_ms": 0.343, "load_throughput": 1504735.357, "learn_time_ms": 663.168, "learn_throughput": 778.083, "synch_weights_time_ms": 13.179}, "counters": {"num_env_steps_sampled": 6708, "num_env_steps_trained": 6708, "num_agent_steps_sampled": 6708, "num_agent_steps_trained": 6708}, "done": false, "episodes_total": 417, "training_iteration": 13, "trial_id": "fe178_00000", "date": "2024-08-15_17-06-01", "timestamp": 1723763161, "time_this_iter_s": 60.83520746231079, "time_total_s": 813.2393817901611, "pid": 67484, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 813.2393817901611, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.632183908045977, "ram_util_percent": 13.574712643678161}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.030726567904155, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.102572516600291, "policy_loss": -0.03687618696130812, "vf_loss": 7.132740342617035, "vf_explained_var": 0.3889448975523313, "kl": 0.00670832613347276, "entropy": 0.9663272629181544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7224, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 7224, "num_agent_steps_trained": 7224}, "sampler_results": {"episode_reward_max": 183.2874911824357, "episode_reward_min": 26.907527634888595, "episode_reward_mean": 133.10415893522372, "episode_len_mean": 38.5, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 308, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6538797658065265, "mean_inference_ms": 1.2813022081879364, "mean_action_processing_ms": 0.21077949425269815, "mean_env_wait_ms": 684.1535140043018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01011192798614502, "StateBufferConnector_ms": 0.008952617645263672, "ViewRequirementAgentConnector_ms": 0.1747339963912964}, "num_episodes": 8, "episode_return_max": 183.2874911824357, "episode_return_min": 26.907527634888595, "episode_return_mean": 133.10415893522372}, "env_runner_results": {"episode_reward_max": 183.2874911824357, "episode_reward_min": 26.907527634888595, "episode_reward_mean": 133.10415893522372, "episode_len_mean": 38.5, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 308, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6538797658065265, "mean_inference_ms": 1.2813022081879364, "mean_action_processing_ms": 0.21077949425269815, "mean_env_wait_ms": 684.1535140043018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01011192798614502, "StateBufferConnector_ms": 0.008952617645263672, "ViewRequirementAgentConnector_ms": 0.1747339963912964}, "num_episodes": 8, "episode_return_max": 183.2874911824357, "episode_return_min": 26.907527634888595, "episode_return_mean": 133.10415893522372}, "episode_reward_max": 183.2874911824357, "episode_reward_min": 26.907527634888595, "episode_reward_mean": 133.10415893522372, "episode_len_mean": 38.5, "episodes_this_iter": 8, "episodes_timesteps_total": 308, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6538797658065265, "mean_inference_ms": 1.2813022081879364, "mean_action_processing_ms": 0.21077949425269815, "mean_env_wait_ms": 684.1535140043018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01011192798614502, "StateBufferConnector_ms": 0.008952617645263672, "ViewRequirementAgentConnector_ms": 0.1747339963912964}, "num_episodes": 8, "episode_return_max": 183.2874911824357, "episode_return_min": 26.907527634888595, "episode_return_mean": 133.10415893522372, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7224, "num_agent_steps_trained": 7224, "num_env_steps_sampled": 7224, "num_env_steps_trained": 7224, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.5241507914226595, "num_env_steps_trained_throughput_per_sec": 7.5241507914226595, "timesteps_total": 7224, "num_env_steps_sampled_lifetime": 7224, "num_agent_steps_sampled_lifetime": 7224, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 7224, "timers": {"training_iteration_time_ms": 68579.186, "restore_workers_time_ms": 0.022, "training_step_time_ms": 68579.113, "sample_time_ms": 63909.571, "load_time_ms": 0.702, "load_throughput": 735142.957, "learn_time_ms": 4654.515, "learn_throughput": 110.86, "synch_weights_time_ms": 13.819}, "counters": {"num_env_steps_sampled": 7224, "num_env_steps_trained": 7224, "num_agent_steps_sampled": 7224, "num_agent_steps_trained": 7224}, "done": false, "episodes_total": 425, "training_iteration": 14, "trial_id": "fe178_00000", "date": "2024-08-15_17-07-44", "timestamp": 1723763264, "time_this_iter_s": 68.58219289779663, "time_total_s": 881.8215746879578, "pid": 63685, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 68.58219289779663, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.993877551020407, "ram_util_percent": 13.289795918367346}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.276113710800807, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.699358665943146, "policy_loss": -0.033641459234058854, "vf_loss": 7.7252481341362, "vf_explained_var": 0.4870512122909228, "kl": 0.0077519522616059065, "entropy": 0.9433751583099366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7740, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 7740, "num_agent_steps_trained": 7740}, "sampler_results": {"episode_reward_max": 215.8291178020811, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 143.44177529192038, "episode_len_mean": 41.31818181818182, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 909, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.891694766741083, "mean_inference_ms": 1.275031780368701, "mean_action_processing_ms": 0.20978701432836874, "mean_env_wait_ms": 683.6105060425035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010960752313787287, "StateBufferConnector_ms": 0.007290189916437323, "ViewRequirementAgentConnector_ms": 0.17197890715165573}, "num_episodes": 14, "episode_return_max": 215.8291178020811, "episode_return_min": 7.9686179359308085, "episode_return_mean": 143.44177529192038}, "env_runner_results": {"episode_reward_max": 215.8291178020811, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 143.44177529192038, "episode_len_mean": 41.31818181818182, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 909, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.891694766741083, "mean_inference_ms": 1.275031780368701, "mean_action_processing_ms": 0.20978701432836874, "mean_env_wait_ms": 683.6105060425035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010960752313787287, "StateBufferConnector_ms": 0.007290189916437323, "ViewRequirementAgentConnector_ms": 0.17197890715165573}, "num_episodes": 14, "episode_return_max": 215.8291178020811, "episode_return_min": 7.9686179359308085, "episode_return_mean": 143.44177529192038}, "episode_reward_max": 215.8291178020811, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 143.44177529192038, "episode_len_mean": 41.31818181818182, "episodes_this_iter": 14, "episodes_timesteps_total": 909, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.891694766741083, "mean_inference_ms": 1.275031780368701, "mean_action_processing_ms": 0.20978701432836874, "mean_env_wait_ms": 683.6105060425035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010960752313787287, "StateBufferConnector_ms": 0.007290189916437323, "ViewRequirementAgentConnector_ms": 0.17197890715165573}, "num_episodes": 14, "episode_return_max": 215.8291178020811, "episode_return_min": 7.9686179359308085, "episode_return_mean": 143.44177529192038, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7740, "num_agent_steps_trained": 7740, "num_env_steps_sampled": 7740, "num_env_steps_trained": 7740, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.031518440698681, "num_env_steps_trained_throughput_per_sec": 8.031518440698681, "timesteps_total": 7740, "num_env_steps_sampled_lifetime": 7740, "num_agent_steps_sampled_lifetime": 7740, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 7740, "timers": {"training_iteration_time_ms": 66413.039, "restore_workers_time_ms": 0.021, "training_step_time_ms": 66412.972, "sample_time_ms": 63743.765, "load_time_ms": 0.501, "load_throughput": 1030600.411, "learn_time_ms": 2654.853, "learn_throughput": 194.361, "synch_weights_time_ms": 13.441}, "counters": {"num_env_steps_sampled": 7740, "num_env_steps_trained": 7740, "num_agent_steps_sampled": 7740, "num_agent_steps_trained": 7740}, "done": false, "episodes_total": 439, "training_iteration": 15, "trial_id": "fe178_00000", "date": "2024-08-15_17-08-48", "timestamp": 1723763328, "time_this_iter_s": 64.25019574165344, "time_total_s": 946.0717704296112, "pid": 63685, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 132.83238863945007, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 24.6304347826087, "ram_util_percent": 13.393478260869573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.804045015573502, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.515172493457794, "policy_loss": -0.03105416496594747, "vf_loss": 7.540428817272186, "vf_explained_var": 0.26044833262761435, "kl": 0.005797859504612959, "entropy": 0.914497967561086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8256, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 8256, "num_agent_steps_trained": 8256}, "sampler_results": {"episode_reward_max": 237.22241186444404, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 160.71054573860698, "episode_len_mean": 44.03125, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1409, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.801993325571209, "mean_inference_ms": 1.2725981266921456, "mean_action_processing_ms": 0.20929581597283006, "mean_env_wait_ms": 678.2952563492222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010780245065689087, "StateBufferConnector_ms": 0.006962567567825317, "ViewRequirementAgentConnector_ms": 0.17116516828536987}, "num_episodes": 10, "episode_return_max": 237.22241186444404, "episode_return_min": 7.9686179359308085, "episode_return_mean": 160.71054573860698}, "env_runner_results": {"episode_reward_max": 237.22241186444404, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 160.71054573860698, "episode_len_mean": 44.03125, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1409, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.801993325571209, "mean_inference_ms": 1.2725981266921456, "mean_action_processing_ms": 0.20929581597283006, "mean_env_wait_ms": 678.2952563492222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010780245065689087, "StateBufferConnector_ms": 0.006962567567825317, "ViewRequirementAgentConnector_ms": 0.17116516828536987}, "num_episodes": 10, "episode_return_max": 237.22241186444404, "episode_return_min": 7.9686179359308085, "episode_return_mean": 160.71054573860698}, "episode_reward_max": 237.22241186444404, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 160.71054573860698, "episode_len_mean": 44.03125, "episodes_this_iter": 10, "episodes_timesteps_total": 1409, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.801993325571209, "mean_inference_ms": 1.2725981266921456, "mean_action_processing_ms": 0.20929581597283006, "mean_env_wait_ms": 678.2952563492222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010780245065689087, "StateBufferConnector_ms": 0.006962567567825317, "ViewRequirementAgentConnector_ms": 0.17116516828536987}, "num_episodes": 10, "episode_return_max": 237.22241186444404, "episode_return_min": 7.9686179359308085, "episode_return_mean": 160.71054573860698, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8256, "num_agent_steps_trained": 8256, "num_env_steps_sampled": 8256, "num_env_steps_trained": 8256, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.534654832903811, "num_env_steps_trained_throughput_per_sec": 8.534654832903811, "timesteps_total": 8256, "num_env_steps_sampled_lifetime": 8256, "num_agent_steps_sampled_lifetime": 8256, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 8256, "timers": {"training_iteration_time_ms": 64428.493, "restore_workers_time_ms": 0.023, "training_step_time_ms": 64428.426, "sample_time_ms": 62420.385, "load_time_ms": 0.454, "load_throughput": 1137288.946, "learn_time_ms": 1993.945, "learn_throughput": 258.783, "synch_weights_time_ms": 13.284}, "counters": {"num_env_steps_sampled": 8256, "num_env_steps_trained": 8256, "num_agent_steps_sampled": 8256, "num_agent_steps_trained": 8256}, "done": false, "episodes_total": 449, "training_iteration": 16, "trial_id": "fe178_00000", "date": "2024-08-15_17-09-48", "timestamp": 1723763388, "time_this_iter_s": 60.46239638328552, "time_total_s": 1006.5341668128967, "pid": 63685, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 193.2947850227356, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.47586206896552, "ram_util_percent": 13.010344827586206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.002207593123119, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.796701991558075, "policy_loss": -0.025318065534035365, "vf_loss": 7.816806856791178, "vf_explained_var": 0.40747109105189644, "kl": 0.005213258898402273, "entropy": 0.9150677800178528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8772, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 8772, "num_agent_steps_trained": 8772}, "sampler_results": {"episode_reward_max": 246.27281637740782, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 165.7901541650684, "episode_len_mean": 44.54761904761905, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1871, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574, 122.41668843677428, 61.232631218119366, 226.16640111690458, 213.75995600616113, 197.04029809692787, 213.3840021602373, 122.07768220846032, 198.4617125663255, 246.27281637740782, 219.63682311012948], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 20, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.788439119826678, "mean_inference_ms": 1.2706497783654005, "mean_action_processing_ms": 0.20884009820044133, "mean_env_wait_ms": 680.716628087607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011076245989118303, "StateBufferConnector_ms": 0.006822177342006138, "ViewRequirementAgentConnector_ms": 0.17122427622477213}, "num_episodes": 10, "episode_return_max": 246.27281637740782, "episode_return_min": 7.9686179359308085, "episode_return_mean": 165.7901541650684}, "env_runner_results": {"episode_reward_max": 246.27281637740782, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 165.7901541650684, "episode_len_mean": 44.54761904761905, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1871, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574, 122.41668843677428, 61.232631218119366, 226.16640111690458, 213.75995600616113, 197.04029809692787, 213.3840021602373, 122.07768220846032, 198.4617125663255, 246.27281637740782, 219.63682311012948], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 20, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.788439119826678, "mean_inference_ms": 1.2706497783654005, "mean_action_processing_ms": 0.20884009820044133, "mean_env_wait_ms": 680.716628087607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011076245989118303, "StateBufferConnector_ms": 0.006822177342006138, "ViewRequirementAgentConnector_ms": 0.17122427622477213}, "num_episodes": 10, "episode_return_max": 246.27281637740782, "episode_return_min": 7.9686179359308085, "episode_return_mean": 165.7901541650684}, "episode_reward_max": 246.27281637740782, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 165.7901541650684, "episode_len_mean": 44.54761904761905, "episodes_this_iter": 10, "episodes_timesteps_total": 1871, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574, 122.41668843677428, 61.232631218119366, 226.16640111690458, 213.75995600616113, 197.04029809692787, 213.3840021602373, 122.07768220846032, 198.4617125663255, 246.27281637740782, 219.63682311012948], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 20, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.788439119826678, "mean_inference_ms": 1.2706497783654005, "mean_action_processing_ms": 0.20884009820044133, "mean_env_wait_ms": 680.716628087607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011076245989118303, "StateBufferConnector_ms": 0.006822177342006138, "ViewRequirementAgentConnector_ms": 0.17122427622477213}, "num_episodes": 10, "episode_return_max": 246.27281637740782, "episode_return_min": 7.9686179359308085, "episode_return_mean": 165.7901541650684, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8772, "num_agent_steps_trained": 8772, "num_env_steps_sampled": 8772, "num_env_steps_trained": 8772, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 7.0437365661150615, "num_env_steps_trained_throughput_per_sec": 7.0437365661150615, "timesteps_total": 8772, "num_env_steps_sampled_lifetime": 8772, "num_agent_steps_sampled_lifetime": 8772, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 8772, "timers": {"training_iteration_time_ms": 66635.517, "restore_workers_time_ms": 0.022, "training_step_time_ms": 66635.45, "sample_time_ms": 64980.689, "load_time_ms": 0.434, "load_throughput": 1189317.689, "learn_time_ms": 1640.726, "learn_throughput": 314.495, "synch_weights_time_ms": 13.26}, "counters": {"num_env_steps_sampled": 8772, "num_env_steps_trained": 8772, "num_agent_steps_sampled": 8772, "num_agent_steps_trained": 8772}, "done": false, "episodes_total": 459, "training_iteration": 17, "trial_id": "fe178_00000", "date": "2024-08-15_17-11-02", "timestamp": 1723763462, "time_this_iter_s": 73.26003694534302, "time_total_s": 1079.7942037582397, "pid": 63685, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 266.5548219680786, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.420192307692307, "ram_util_percent": 12.634615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.27534453868866, "cur_kl_coeff": 1.0, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.832192516326904, "policy_loss": -0.022072312825669845, "vf_loss": 7.851275722185771, "vf_explained_var": 0.2502291426062584, "kl": 0.0029890742536890346, "entropy": 0.8382546827197075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9288, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 9288, "num_agent_steps_trained": 9288}, "sampler_results": {"episode_reward_max": 246.27281637740782, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 159.62177597655548, "episode_len_mean": 43.280701754385966, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 2467, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574, 122.41668843677428, 61.232631218119366, 226.16640111690458, 213.75995600616113, 197.04029809692787, 213.3840021602373, 122.07768220846032, 198.4617125663255, 246.27281637740782, 219.63682311012948, 172.8413032138667, 219.7946627427046, 18.564288358646237, 197.3478360026458, 190.5096103401878, 53.25358263397035, 142.51028553277587, 203.3806485644301, 33.22043790012631, 182.19279886973055, 225.3751993933434, 196.42022657520204, 17.810440544136938, 90.35398282157227, 191.67945223745198], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 17, 50, 50, 11, 50, 50, 50, 8, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.830826412244443, "mean_inference_ms": 1.2691508943069214, "mean_action_processing_ms": 0.20874043225657646, "mean_env_wait_ms": 679.548998977383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011281799851802358, "StateBufferConnector_ms": 0.007006996556332237, "ViewRequirementAgentConnector_ms": 0.17173917669998973}, "num_episodes": 15, "episode_return_max": 246.27281637740782, "episode_return_min": 7.9686179359308085, "episode_return_mean": 159.62177597655548}, "env_runner_results": {"episode_reward_max": 246.27281637740782, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 159.62177597655548, "episode_len_mean": 43.280701754385966, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 2467, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574, 122.41668843677428, 61.232631218119366, 226.16640111690458, 213.75995600616113, 197.04029809692787, 213.3840021602373, 122.07768220846032, 198.4617125663255, 246.27281637740782, 219.63682311012948, 172.8413032138667, 219.7946627427046, 18.564288358646237, 197.3478360026458, 190.5096103401878, 53.25358263397035, 142.51028553277587, 203.3806485644301, 33.22043790012631, 182.19279886973055, 225.3751993933434, 196.42022657520204, 17.810440544136938, 90.35398282157227, 191.67945223745198], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 17, 50, 50, 11, 50, 50, 50, 8, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.830826412244443, "mean_inference_ms": 1.2691508943069214, "mean_action_processing_ms": 0.20874043225657646, "mean_env_wait_ms": 679.548998977383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011281799851802358, "StateBufferConnector_ms": 0.007006996556332237, "ViewRequirementAgentConnector_ms": 0.17173917669998973}, "num_episodes": 15, "episode_return_max": 246.27281637740782, "episode_return_min": 7.9686179359308085, "episode_return_mean": 159.62177597655548}, "episode_reward_max": 246.27281637740782, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 159.62177597655548, "episode_len_mean": 43.280701754385966, "episodes_this_iter": 15, "episodes_timesteps_total": 2467, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574, 122.41668843677428, 61.232631218119366, 226.16640111690458, 213.75995600616113, 197.04029809692787, 213.3840021602373, 122.07768220846032, 198.4617125663255, 246.27281637740782, 219.63682311012948, 172.8413032138667, 219.7946627427046, 18.564288358646237, 197.3478360026458, 190.5096103401878, 53.25358263397035, 142.51028553277587, 203.3806485644301, 33.22043790012631, 182.19279886973055, 225.3751993933434, 196.42022657520204, 17.810440544136938, 90.35398282157227, 191.67945223745198], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 17, 50, 50, 11, 50, 50, 50, 8, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.830826412244443, "mean_inference_ms": 1.2691508943069214, "mean_action_processing_ms": 0.20874043225657646, "mean_env_wait_ms": 679.548998977383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011281799851802358, "StateBufferConnector_ms": 0.007006996556332237, "ViewRequirementAgentConnector_ms": 0.17173917669998973}, "num_episodes": 15, "episode_return_max": 246.27281637740782, "episode_return_min": 7.9686179359308085, "episode_return_mean": 159.62177597655548, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9288, "num_agent_steps_trained": 9288, "num_env_steps_sampled": 9288, "num_env_steps_trained": 9288, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.368024702586506, "num_env_steps_trained_throughput_per_sec": 8.368024702586506, "timesteps_total": 9288, "num_env_steps_sampled_lifetime": 9288, "num_agent_steps_sampled_lifetime": 9288, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 9288, "timers": {"training_iteration_time_ms": 65641.076, "restore_workers_time_ms": 0.023, "training_step_time_ms": 65641.01, "sample_time_ms": 64175.69, "load_time_ms": 0.426, "load_throughput": 1210843.048, "learn_time_ms": 1451.355, "learn_throughput": 355.53, "synch_weights_time_ms": 13.214}, "counters": {"num_env_steps_sampled": 9288, "num_env_steps_trained": 9288, "num_agent_steps_sampled": 9288, "num_agent_steps_trained": 9288}, "done": false, "episodes_total": 474, "training_iteration": 18, "trial_id": "fe178_00000", "date": "2024-08-15_17-12-03", "timestamp": 1723763523, "time_this_iter_s": 61.66665983200073, "time_total_s": 1141.4608635902405, "pid": 63685, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 328.22148180007935, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.861363636363638, "ram_util_percent": 12.869318181818185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.77418981194496, "cur_kl_coeff": 0.5, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.117991773287455, "policy_loss": -0.023522001939515272, "vf_loss": 8.137747053305308, "vf_explained_var": 0.3759158377846082, "kl": 0.007533484249487963, "entropy": 0.8654777094721794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9804, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 9804, "num_agent_steps_trained": 9804}, "sampler_results": {"episode_reward_max": 246.27281637740782, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 161.45802267179266, "episode_len_mean": 43.89705882352941, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2985, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574, 122.41668843677428, 61.232631218119366, 226.16640111690458, 213.75995600616113, 197.04029809692787, 213.3840021602373, 122.07768220846032, 198.4617125663255, 246.27281637740782, 219.63682311012948, 172.8413032138667, 219.7946627427046, 18.564288358646237, 197.3478360026458, 190.5096103401878, 53.25358263397035, 142.51028553277587, 203.3806485644301, 33.22043790012631, 182.19279886973055, 225.3751993933434, 196.42022657520204, 17.810440544136938, 90.35398282157227, 191.67945223745198, 164.81729292011124, 162.1028544468293, 185.30554819360418, 170.03961286816946, 240.86961610953313, 174.9008402352934, 189.5920156422818, 53.27916394953343, 122.0206017943118, 216.34965370849613, 201.4271111500753], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 17, 50, 50, 11, 50, 50, 50, 8, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.855452331036362, "mean_inference_ms": 1.268648117205628, "mean_action_processing_ms": 0.20874912670811585, "mean_env_wait_ms": 676.49951210823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01120286829331342, "StateBufferConnector_ms": 0.0069355263429529525, "ViewRequirementAgentConnector_ms": 0.17184650196748621}, "num_episodes": 11, "episode_return_max": 246.27281637740782, "episode_return_min": 7.9686179359308085, "episode_return_mean": 161.45802267179266}, "env_runner_results": {"episode_reward_max": 246.27281637740782, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 161.45802267179266, "episode_len_mean": 43.89705882352941, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2985, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574, 122.41668843677428, 61.232631218119366, 226.16640111690458, 213.75995600616113, 197.04029809692787, 213.3840021602373, 122.07768220846032, 198.4617125663255, 246.27281637740782, 219.63682311012948, 172.8413032138667, 219.7946627427046, 18.564288358646237, 197.3478360026458, 190.5096103401878, 53.25358263397035, 142.51028553277587, 203.3806485644301, 33.22043790012631, 182.19279886973055, 225.3751993933434, 196.42022657520204, 17.810440544136938, 90.35398282157227, 191.67945223745198, 164.81729292011124, 162.1028544468293, 185.30554819360418, 170.03961286816946, 240.86961610953313, 174.9008402352934, 189.5920156422818, 53.27916394953343, 122.0206017943118, 216.34965370849613, 201.4271111500753], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 17, 50, 50, 11, 50, 50, 50, 8, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.855452331036362, "mean_inference_ms": 1.268648117205628, "mean_action_processing_ms": 0.20874912670811585, "mean_env_wait_ms": 676.49951210823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01120286829331342, "StateBufferConnector_ms": 0.0069355263429529525, "ViewRequirementAgentConnector_ms": 0.17184650196748621}, "num_episodes": 11, "episode_return_max": 246.27281637740782, "episode_return_min": 7.9686179359308085, "episode_return_mean": 161.45802267179266}, "episode_reward_max": 246.27281637740782, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 161.45802267179266, "episode_len_mean": 43.89705882352941, "episodes_this_iter": 11, "episodes_timesteps_total": 2985, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574, 122.41668843677428, 61.232631218119366, 226.16640111690458, 213.75995600616113, 197.04029809692787, 213.3840021602373, 122.07768220846032, 198.4617125663255, 246.27281637740782, 219.63682311012948, 172.8413032138667, 219.7946627427046, 18.564288358646237, 197.3478360026458, 190.5096103401878, 53.25358263397035, 142.51028553277587, 203.3806485644301, 33.22043790012631, 182.19279886973055, 225.3751993933434, 196.42022657520204, 17.810440544136938, 90.35398282157227, 191.67945223745198, 164.81729292011124, 162.1028544468293, 185.30554819360418, 170.03961286816946, 240.86961610953313, 174.9008402352934, 189.5920156422818, 53.27916394953343, 122.0206017943118, 216.34965370849613, 201.4271111500753], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 17, 50, 50, 11, 50, 50, 50, 8, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.855452331036362, "mean_inference_ms": 1.268648117205628, "mean_action_processing_ms": 0.20874912670811585, "mean_env_wait_ms": 676.49951210823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01120286829331342, "StateBufferConnector_ms": 0.0069355263429529525, "ViewRequirementAgentConnector_ms": 0.17184650196748621}, "num_episodes": 11, "episode_return_max": 246.27281637740782, "episode_return_min": 7.9686179359308085, "episode_return_mean": 161.45802267179266, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9804, "num_agent_steps_trained": 9804, "num_env_steps_sampled": 9804, "num_env_steps_trained": 9804, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.146616970853707, "num_env_steps_trained_throughput_per_sec": 9.146616970853707, "timesteps_total": 9804, "num_env_steps_sampled_lifetime": 9804, "num_agent_steps_sampled_lifetime": 9804, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 9804, "timers": {"training_iteration_time_ms": 64103.282, "restore_workers_time_ms": 0.022, "training_step_time_ms": 64103.219, "sample_time_ms": 62766.566, "load_time_ms": 0.414, "load_throughput": 1247053.22, "learn_time_ms": 1322.717, "learn_throughput": 390.106, "synch_weights_time_ms": 13.214}, "counters": {"num_env_steps_sampled": 9804, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 9804, "num_agent_steps_trained": 9804}, "done": false, "episodes_total": 485, "training_iteration": 19, "trial_id": "fe178_00000", "date": "2024-08-15_17-13-00", "timestamp": 1723763580, "time_this_iter_s": 56.417651891708374, "time_total_s": 1197.8785154819489, "pid": 63685, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 384.6391336917877, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 27.622222222222224, "ram_util_percent": 12.979012345679015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.529134173194567, "cur_kl_coeff": 0.5, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.179084058602651, "policy_loss": -0.017984505587567885, "vf_loss": 8.19411149819692, "vf_explained_var": 0.24982034762700397, "kl": 0.005913983098647198, "entropy": 0.7701712985833485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10320, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 10320, "num_agent_steps_trained": 10320}, "sampler_results": {"episode_reward_max": 246.27281637740782, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 161.67595308955444, "episode_len_mean": 43.717948717948715, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 3410, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574, 122.41668843677428, 61.232631218119366, 226.16640111690458, 213.75995600616113, 197.04029809692787, 213.3840021602373, 122.07768220846032, 198.4617125663255, 246.27281637740782, 219.63682311012948, 172.8413032138667, 219.7946627427046, 18.564288358646237, 197.3478360026458, 190.5096103401878, 53.25358263397035, 142.51028553277587, 203.3806485644301, 33.22043790012631, 182.19279886973055, 225.3751993933434, 196.42022657520204, 17.810440544136938, 90.35398282157227, 191.67945223745198, 164.81729292011124, 162.1028544468293, 185.30554819360418, 170.03961286816946, 240.86961610953313, 174.9008402352934, 189.5920156422818, 53.27916394953343, 122.0206017943118, 216.34965370849613, 201.4271111500753, 57.41470711728789, 190.5856743073607, 179.69699108968155, 201.20492517910586, 219.38606777096675, 154.99390430030098, 207.61562127593675, 231.5780168649709, 18.358733882004785, 170.74415751572738], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 17, 50, 50, 11, 50, 50, 50, 8, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 7, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.871147327569777, "mean_inference_ms": 1.2678471885713094, "mean_action_processing_ms": 0.20865831179796268, "mean_env_wait_ms": 671.8425445190048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011039391542092348, "StateBufferConnector_ms": 0.007172731252817007, "ViewRequirementAgentConnector_ms": 0.1725912094116211}, "num_episodes": 10, "episode_return_max": 246.27281637740782, "episode_return_min": 7.9686179359308085, "episode_return_mean": 161.67595308955444}, "env_runner_results": {"episode_reward_max": 246.27281637740782, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 161.67595308955444, "episode_len_mean": 43.717948717948715, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 3410, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574, 122.41668843677428, 61.232631218119366, 226.16640111690458, 213.75995600616113, 197.04029809692787, 213.3840021602373, 122.07768220846032, 198.4617125663255, 246.27281637740782, 219.63682311012948, 172.8413032138667, 219.7946627427046, 18.564288358646237, 197.3478360026458, 190.5096103401878, 53.25358263397035, 142.51028553277587, 203.3806485644301, 33.22043790012631, 182.19279886973055, 225.3751993933434, 196.42022657520204, 17.810440544136938, 90.35398282157227, 191.67945223745198, 164.81729292011124, 162.1028544468293, 185.30554819360418, 170.03961286816946, 240.86961610953313, 174.9008402352934, 189.5920156422818, 53.27916394953343, 122.0206017943118, 216.34965370849613, 201.4271111500753, 57.41470711728789, 190.5856743073607, 179.69699108968155, 201.20492517910586, 219.38606777096675, 154.99390430030098, 207.61562127593675, 231.5780168649709, 18.358733882004785, 170.74415751572738], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 17, 50, 50, 11, 50, 50, 50, 8, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 7, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.871147327569777, "mean_inference_ms": 1.2678471885713094, "mean_action_processing_ms": 0.20865831179796268, "mean_env_wait_ms": 671.8425445190048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011039391542092348, "StateBufferConnector_ms": 0.007172731252817007, "ViewRequirementAgentConnector_ms": 0.1725912094116211}, "num_episodes": 10, "episode_return_max": 246.27281637740782, "episode_return_min": 7.9686179359308085, "episode_return_mean": 161.67595308955444}, "episode_reward_max": 246.27281637740782, "episode_reward_min": 7.9686179359308085, "episode_reward_mean": 161.67595308955444, "episode_len_mean": 43.717948717948715, "episodes_this_iter": 10, "episodes_timesteps_total": 3410, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [137.29438840762128, 157.6050212461744, 172.42076313009647, 51.67511913143147, 26.907527634888595, 181.4788311472828, 183.2874911824357, 154.16412960185897, 110.54871544331802, 169.12446062045626, 157.4742739090447, 197.74501232431209, 121.34579543117582, 214.33849149741036, 180.7117064226996, 110.12263702128064, 172.56286624234775, 215.8291178020811, 204.75514472550987, 7.9686179359308085, 33.04186839405058, 195.31707717084032, 211.6282414405468, 209.58853099412133, 237.22241186444404, 181.45817823178675, 145.60514734265513, 186.42850566749806, 204.4987431827825, 191.96971043819684, 216.26399425357928, 202.35494379756574, 122.41668843677428, 61.232631218119366, 226.16640111690458, 213.75995600616113, 197.04029809692787, 213.3840021602373, 122.07768220846032, 198.4617125663255, 246.27281637740782, 219.63682311012948, 172.8413032138667, 219.7946627427046, 18.564288358646237, 197.3478360026458, 190.5096103401878, 53.25358263397035, 142.51028553277587, 203.3806485644301, 33.22043790012631, 182.19279886973055, 225.3751993933434, 196.42022657520204, 17.810440544136938, 90.35398282157227, 191.67945223745198, 164.81729292011124, 162.1028544468293, 185.30554819360418, 170.03961286816946, 240.86961610953313, 174.9008402352934, 189.5920156422818, 53.27916394953343, 122.0206017943118, 216.34965370849613, 201.4271111500753, 57.41470711728789, 190.5856743073607, 179.69699108968155, 201.20492517910586, 219.38606777096675, 154.99390430030098, 207.61562127593675, 231.5780168649709, 18.358733882004785, 170.74415751572738], "episode_lengths": [43, 45, 50, 12, 8, 50, 50, 50, 46, 50, 50, 50, 50, 50, 50, 34, 50, 50, 50, 10, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 42, 20, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 10, 50, 50, 17, 50, 50, 11, 50, 50, 50, 8, 50, 50, 50, 50, 50, 50, 50, 50, 50, 18, 50, 50, 50, 18, 50, 50, 50, 50, 50, 50, 50, 7, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.871147327569777, "mean_inference_ms": 1.2678471885713094, "mean_action_processing_ms": 0.20865831179796268, "mean_env_wait_ms": 671.8425445190048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011039391542092348, "StateBufferConnector_ms": 0.007172731252817007, "ViewRequirementAgentConnector_ms": 0.1725912094116211}, "num_episodes": 10, "episode_return_max": 246.27281637740782, "episode_return_min": 7.9686179359308085, "episode_return_mean": 161.67595308955444, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10320, "num_agent_steps_trained": 10320, "num_env_steps_sampled": 10320, "num_env_steps_trained": 10320, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.397160725846684, "num_env_steps_trained_throughput_per_sec": 10.397160725846684, "timesteps_total": 10320, "num_env_steps_sampled_lifetime": 10320, "num_agent_steps_sampled_lifetime": 10320, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 10320, "timers": {"training_iteration_time_ms": 62035.52, "restore_workers_time_ms": 0.021, "training_step_time_ms": 62035.459, "sample_time_ms": 60798.498, "load_time_ms": 0.399, "load_throughput": 1293309.377, "learn_time_ms": 1223.131, "learn_throughput": 421.868, "synch_weights_time_ms": 13.138}, "counters": {"num_env_steps_sampled": 10320, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 10320, "num_agent_steps_trained": 10320}, "done": false, "episodes_total": 495, "training_iteration": 20, "trial_id": "fe178_00000", "date": "2024-08-15_17-13-49", "timestamp": 1723763629, "time_this_iter_s": 49.632267236709595, "time_total_s": 1247.5107827186584, "pid": 63685, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 434.2714009284973, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 31.29859154929578, "ram_util_percent": 13.042253521126762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.225807682673137, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.277579530080159, "policy_loss": -0.026810706313699483, "vf_loss": 8.299938456217449, "vf_explained_var": 0.310822157561779, "kl": 0.008903473898416411, "entropy": 0.6491259862979253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9804, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 9804, "num_agent_steps_trained": 9804}, "sampler_results": {"episode_reward_max": 232.437029963707, "episode_reward_min": 212.58902318058153, "episode_reward_mean": 221.24238311202657, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.153983346347151, "mean_inference_ms": 1.2591899126425556, "mean_action_processing_ms": 0.20958591695032813, "mean_env_wait_ms": 630.6772985677609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00938574473063151, "StateBufferConnector_ms": 0.0057061513264973955, "ViewRequirementAgentConnector_ms": 0.16972621281941733}, "num_episodes": 6, "episode_return_max": 232.437029963707, "episode_return_min": 212.58902318058153, "episode_return_mean": 221.24238311202657}, "env_runner_results": {"episode_reward_max": 232.437029963707, "episode_reward_min": 212.58902318058153, "episode_reward_mean": 221.24238311202657, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.153983346347151, "mean_inference_ms": 1.2591899126425556, "mean_action_processing_ms": 0.20958591695032813, "mean_env_wait_ms": 630.6772985677609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00938574473063151, "StateBufferConnector_ms": 0.0057061513264973955, "ViewRequirementAgentConnector_ms": 0.16972621281941733}, "num_episodes": 6, "episode_return_max": 232.437029963707, "episode_return_min": 212.58902318058153, "episode_return_mean": 221.24238311202657}, "episode_reward_max": 232.437029963707, "episode_reward_min": 212.58902318058153, "episode_reward_mean": 221.24238311202657, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.153983346347151, "mean_inference_ms": 1.2591899126425556, "mean_action_processing_ms": 0.20958591695032813, "mean_env_wait_ms": 630.6772985677609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00938574473063151, "StateBufferConnector_ms": 0.0057061513264973955, "ViewRequirementAgentConnector_ms": 0.16972621281941733}, "num_episodes": 6, "episode_return_max": 232.437029963707, "episode_return_min": 212.58902318058153, "episode_return_mean": 221.24238311202657, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9804, "num_agent_steps_trained": 9804, "num_env_steps_sampled": 9804, "num_env_steps_trained": 9804, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.602068120358602, "num_env_steps_trained_throughput_per_sec": 8.602068120358602, "timesteps_total": 9804, "num_env_steps_sampled_lifetime": 9804, "num_agent_steps_sampled_lifetime": 9804, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 9804, "timers": {"training_iteration_time_ms": 59985.587, "restore_workers_time_ms": 0.024, "training_step_time_ms": 59985.52, "sample_time_ms": 58170.859, "load_time_ms": 0.792, "load_throughput": 651689.51, "learn_time_ms": 1800.404, "learn_throughput": 286.602, "synch_weights_time_ms": 12.98}, "counters": {"num_env_steps_sampled": 9804, "num_env_steps_trained": 9804, "num_agent_steps_sampled": 9804, "num_agent_steps_trained": 9804}, "done": false, "episodes_total": 472, "training_iteration": 19, "trial_id": "fe178_00000", "date": "2024-08-15_17-15-09", "timestamp": 1723763709, "time_this_iter_s": 59.98809313774109, "time_total_s": 1219.773464679718, "pid": 17282, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 59.98809313774109, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.897674418604655, "ram_util_percent": 13.056976744186038}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.985458586613337, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.418271203835806, "policy_loss": -0.02855773487438758, "vf_loss": 8.441102290153504, "vf_explained_var": 0.1959892491499583, "kl": 0.011453160069020248, "entropy": 0.5613614824910959, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10320, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 10320, "num_agent_steps_trained": 10320}, "sampler_results": {"episode_reward_max": 268.70501973371324, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 207.87607149937713, "episode_len_mean": 45.2, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.187802134649388, "mean_inference_ms": 1.2588937467423382, "mean_action_processing_ms": 0.20930957227091912, "mean_env_wait_ms": 636.5889601696052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012222528457641602, "StateBufferConnector_ms": 0.005862712860107422, "ViewRequirementAgentConnector_ms": 0.16924738883972168}, "num_episodes": 14, "episode_return_max": 268.70501973371324, "episode_return_min": 39.06970038618431, "episode_return_mean": 207.87607149937713}, "env_runner_results": {"episode_reward_max": 268.70501973371324, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 207.87607149937713, "episode_len_mean": 45.2, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.187802134649388, "mean_inference_ms": 1.2588937467423382, "mean_action_processing_ms": 0.20930957227091912, "mean_env_wait_ms": 636.5889601696052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012222528457641602, "StateBufferConnector_ms": 0.005862712860107422, "ViewRequirementAgentConnector_ms": 0.16924738883972168}, "num_episodes": 14, "episode_return_max": 268.70501973371324, "episode_return_min": 39.06970038618431, "episode_return_mean": 207.87607149937713}, "episode_reward_max": 268.70501973371324, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 207.87607149937713, "episode_len_mean": 45.2, "episodes_this_iter": 14, "episodes_timesteps_total": 904, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.187802134649388, "mean_inference_ms": 1.2588937467423382, "mean_action_processing_ms": 0.20930957227091912, "mean_env_wait_ms": 636.5889601696052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012222528457641602, "StateBufferConnector_ms": 0.005862712860107422, "ViewRequirementAgentConnector_ms": 0.16924738883972168}, "num_episodes": 14, "episode_return_max": 268.70501973371324, "episode_return_min": 39.06970038618431, "episode_return_mean": 207.87607149937713, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10320, "num_agent_steps_trained": 10320, "num_env_steps_sampled": 10320, "num_env_steps_trained": 10320, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.417230629631437, "num_env_steps_trained_throughput_per_sec": 8.417230629631437, "timesteps_total": 10320, "num_env_steps_sampled_lifetime": 10320, "num_agent_steps_sampled_lifetime": 10320, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 10320, "timers": {"training_iteration_time_ms": 60644.21, "restore_workers_time_ms": 0.021, "training_step_time_ms": 60644.151, "sample_time_ms": 59381.534, "load_time_ms": 0.59, "load_throughput": 874979.124, "learn_time_ms": 1248.571, "learn_throughput": 413.272, "synch_weights_time_ms": 13.08}, "counters": {"num_env_steps_sampled": 10320, "num_env_steps_trained": 10320, "num_agent_steps_sampled": 10320, "num_agent_steps_trained": 10320}, "done": false, "episodes_total": 486, "training_iteration": 20, "trial_id": "fe178_00000", "date": "2024-08-15_17-16-11", "timestamp": 1723763771, "time_this_iter_s": 61.306230545043945, "time_total_s": 1281.079695224762, "pid": 17282, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 121.29432368278503, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.114772727272726, "ram_util_percent": 13.139772727272724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.688640455404917, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.37822235027949, "policy_loss": -0.03235292080789805, "vf_loss": 8.406918470064799, "vf_explained_var": 0.18832142353057862, "kl": 0.0073135622857084725, "entropy": 0.5856509583691756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10836, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 10836, "num_agent_steps_trained": 10836}, "sampler_results": {"episode_reward_max": 291.7949233998268, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 216.65554278172672, "episode_len_mean": 46.8, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1404, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.296328803804536, "mean_inference_ms": 1.257718831926344, "mean_action_processing_ms": 0.2091729139818213, "mean_env_wait_ms": 638.7876231984962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01226345698038737, "StateBufferConnector_ms": 0.0058968861897786455, "ViewRequirementAgentConnector_ms": 0.16904195149739584}, "num_episodes": 10, "episode_return_max": 291.7949233998268, "episode_return_min": 39.06970038618431, "episode_return_mean": 216.65554278172672}, "env_runner_results": {"episode_reward_max": 291.7949233998268, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 216.65554278172672, "episode_len_mean": 46.8, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1404, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.296328803804536, "mean_inference_ms": 1.257718831926344, "mean_action_processing_ms": 0.2091729139818213, "mean_env_wait_ms": 638.7876231984962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01226345698038737, "StateBufferConnector_ms": 0.0058968861897786455, "ViewRequirementAgentConnector_ms": 0.16904195149739584}, "num_episodes": 10, "episode_return_max": 291.7949233998268, "episode_return_min": 39.06970038618431, "episode_return_mean": 216.65554278172672}, "episode_reward_max": 291.7949233998268, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 216.65554278172672, "episode_len_mean": 46.8, "episodes_this_iter": 10, "episodes_timesteps_total": 1404, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.296328803804536, "mean_inference_ms": 1.257718831926344, "mean_action_processing_ms": 0.2091729139818213, "mean_env_wait_ms": 638.7876231984962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01226345698038737, "StateBufferConnector_ms": 0.0058968861897786455, "ViewRequirementAgentConnector_ms": 0.16904195149739584}, "num_episodes": 10, "episode_return_max": 291.7949233998268, "episode_return_min": 39.06970038618431, "episode_return_mean": 216.65554278172672, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10836, "num_agent_steps_trained": 10836, "num_env_steps_sampled": 10836, "num_env_steps_trained": 10836, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.394796819920694, "num_env_steps_trained_throughput_per_sec": 8.394796819920694, "timesteps_total": 10836, "num_env_steps_sampled_lifetime": 10836, "num_agent_steps_sampled_lifetime": 10836, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 10836, "timers": {"training_iteration_time_ms": 60918.359, "restore_workers_time_ms": 0.02, "training_step_time_ms": 60918.3, "sample_time_ms": 59849.802, "load_time_ms": 0.517, "load_throughput": 998582.373, "learn_time_ms": 1054.433, "learn_throughput": 489.363, "synch_weights_time_ms": 13.206}, "counters": {"num_env_steps_sampled": 10836, "num_env_steps_trained": 10836, "num_agent_steps_sampled": 10836, "num_agent_steps_trained": 10836}, "done": false, "episodes_total": 496, "training_iteration": 21, "trial_id": "fe178_00000", "date": "2024-08-15_17-17-12", "timestamp": 1723763832, "time_this_iter_s": 61.469677686691284, "time_total_s": 1342.5493729114532, "pid": 17282, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 182.76400136947632, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.311363636363634, "ram_util_percent": 12.015909090909089}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.625541174411774, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.16281095345815, "policy_loss": -0.02400026476631562, "vf_loss": 8.183199532826741, "vf_explained_var": 0.23153940637906392, "kl": 0.007223416168108088, "entropy": 0.5617731474339962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11352, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 11352, "num_agent_steps_trained": 11352}, "sampler_results": {"episode_reward_max": 291.7949233998268, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 217.37758349474484, "episode_len_mean": 47.53846153846154, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 1854, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268, 184.0302177775879, 231.9268141106778, 224.85136768701727, 229.5195991886045, 177.11365951682524, 234.71959778777557, 250.11050473896904, 188.74728160446375, 257.0404304313254], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.348185515707021, "mean_inference_ms": 1.257385450433831, "mean_action_processing_ms": 0.2092646041794995, "mean_env_wait_ms": 638.4296143717793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01233968979273087, "StateBufferConnector_ms": 0.00598308367606921, "ViewRequirementAgentConnector_ms": 0.1694954358614408}, "num_episodes": 9, "episode_return_max": 291.7949233998268, "episode_return_min": 39.06970038618431, "episode_return_mean": 217.37758349474484}, "env_runner_results": {"episode_reward_max": 291.7949233998268, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 217.37758349474484, "episode_len_mean": 47.53846153846154, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 1854, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268, 184.0302177775879, 231.9268141106778, 224.85136768701727, 229.5195991886045, 177.11365951682524, 234.71959778777557, 250.11050473896904, 188.74728160446375, 257.0404304313254], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.348185515707021, "mean_inference_ms": 1.257385450433831, "mean_action_processing_ms": 0.2092646041794995, "mean_env_wait_ms": 638.4296143717793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01233968979273087, "StateBufferConnector_ms": 0.00598308367606921, "ViewRequirementAgentConnector_ms": 0.1694954358614408}, "num_episodes": 9, "episode_return_max": 291.7949233998268, "episode_return_min": 39.06970038618431, "episode_return_mean": 217.37758349474484}, "episode_reward_max": 291.7949233998268, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 217.37758349474484, "episode_len_mean": 47.53846153846154, "episodes_this_iter": 9, "episodes_timesteps_total": 1854, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268, 184.0302177775879, 231.9268141106778, 224.85136768701727, 229.5195991886045, 177.11365951682524, 234.71959778777557, 250.11050473896904, 188.74728160446375, 257.0404304313254], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.348185515707021, "mean_inference_ms": 1.257385450433831, "mean_action_processing_ms": 0.2092646041794995, "mean_env_wait_ms": 638.4296143717793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01233968979273087, "StateBufferConnector_ms": 0.00598308367606921, "ViewRequirementAgentConnector_ms": 0.1694954358614408}, "num_episodes": 9, "episode_return_max": 291.7949233998268, "episode_return_min": 39.06970038618431, "episode_return_mean": 217.37758349474484, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11352, "num_agent_steps_trained": 11352, "num_env_steps_sampled": 11352, "num_env_steps_trained": 11352, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.837610256520655, "num_env_steps_trained_throughput_per_sec": 8.837610256520655, "timesteps_total": 11352, "num_env_steps_sampled_lifetime": 11352, "num_agent_steps_sampled_lifetime": 11352, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 11352, "timers": {"training_iteration_time_ms": 60285.479, "restore_workers_time_ms": 0.021, "training_step_time_ms": 60285.418, "sample_time_ms": 59311.669, "load_time_ms": 0.467, "load_throughput": 1105342.627, "learn_time_ms": 959.907, "learn_throughput": 537.552, "synch_weights_time_ms": 13.059}, "counters": {"num_env_steps_sampled": 11352, "num_env_steps_trained": 11352, "num_agent_steps_sampled": 11352, "num_agent_steps_trained": 11352}, "done": false, "episodes_total": 505, "training_iteration": 22, "trial_id": "fe178_00000", "date": "2024-08-15_17-18-11", "timestamp": 1723763891, "time_this_iter_s": 58.390395402908325, "time_total_s": 1400.9397683143616, "pid": 17282, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 241.15439677238464, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.238554216867467, "ram_util_percent": 12.615662650602408}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.236895656585693, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.25365996758143, "policy_loss": -0.025211775302886964, "vf_loss": 8.275458745161693, "vf_explained_var": 0.28673702279726665, "kl": 0.006826061770455757, "entropy": 0.5066538132727146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11868, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 11868, "num_agent_steps_trained": 11868}, "sampler_results": {"episode_reward_max": 296.73060631339945, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 218.29029523502612, "episode_len_mean": 47.588235294117645, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2427, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268, 184.0302177775879, 231.9268141106778, 224.85136768701727, 229.5195991886045, 177.11365951682524, 234.71959778777557, 250.11050473896904, 188.74728160446375, 257.0404304313254, 296.73060631339945, 230.7138827952169, 206.8084107524441, 205.1444896299554, 237.98287659229112, 205.78333336132198, 211.81153826872065, 117.30237319908963, 268.5228765171003, 253.54048103974216, 211.5636938004784, 209.1747384215239], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4158738959251735, "mean_inference_ms": 1.2561737198645315, "mean_action_processing_ms": 0.20933108758308108, "mean_env_wait_ms": 638.7315958185216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012160749996409696, "StateBufferConnector_ms": 0.0060305875890395225, "ViewRequirementAgentConnector_ms": 0.170287898942536}, "num_episodes": 12, "episode_return_max": 296.73060631339945, "episode_return_min": 39.06970038618431, "episode_return_mean": 218.29029523502612}, "env_runner_results": {"episode_reward_max": 296.73060631339945, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 218.29029523502612, "episode_len_mean": 47.588235294117645, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2427, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268, 184.0302177775879, 231.9268141106778, 224.85136768701727, 229.5195991886045, 177.11365951682524, 234.71959778777557, 250.11050473896904, 188.74728160446375, 257.0404304313254, 296.73060631339945, 230.7138827952169, 206.8084107524441, 205.1444896299554, 237.98287659229112, 205.78333336132198, 211.81153826872065, 117.30237319908963, 268.5228765171003, 253.54048103974216, 211.5636938004784, 209.1747384215239], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4158738959251735, "mean_inference_ms": 1.2561737198645315, "mean_action_processing_ms": 0.20933108758308108, "mean_env_wait_ms": 638.7315958185216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012160749996409696, "StateBufferConnector_ms": 0.0060305875890395225, "ViewRequirementAgentConnector_ms": 0.170287898942536}, "num_episodes": 12, "episode_return_max": 296.73060631339945, "episode_return_min": 39.06970038618431, "episode_return_mean": 218.29029523502612}, "episode_reward_max": 296.73060631339945, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 218.29029523502612, "episode_len_mean": 47.588235294117645, "episodes_this_iter": 12, "episodes_timesteps_total": 2427, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268, 184.0302177775879, 231.9268141106778, 224.85136768701727, 229.5195991886045, 177.11365951682524, 234.71959778777557, 250.11050473896904, 188.74728160446375, 257.0404304313254, 296.73060631339945, 230.7138827952169, 206.8084107524441, 205.1444896299554, 237.98287659229112, 205.78333336132198, 211.81153826872065, 117.30237319908963, 268.5228765171003, 253.54048103974216, 211.5636938004784, 209.1747384215239], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4158738959251735, "mean_inference_ms": 1.2561737198645315, "mean_action_processing_ms": 0.20933108758308108, "mean_env_wait_ms": 638.7315958185216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012160749996409696, "StateBufferConnector_ms": 0.0060305875890395225, "ViewRequirementAgentConnector_ms": 0.170287898942536}, "num_episodes": 12, "episode_return_max": 296.73060631339945, "episode_return_min": 39.06970038618431, "episode_return_mean": 218.29029523502612, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11868, "num_agent_steps_trained": 11868, "num_env_steps_sampled": 11868, "num_env_steps_trained": 11868, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.465847505060276, "num_env_steps_trained_throughput_per_sec": 8.465847505060276, "timesteps_total": 11868, "num_env_steps_sampled_lifetime": 11868, "num_agent_steps_sampled_lifetime": 11868, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 11868, "timers": {"training_iteration_time_ms": 60418.541, "restore_workers_time_ms": 0.02, "training_step_time_ms": 60418.483, "sample_time_ms": 59502.429, "load_time_ms": 0.438, "load_throughput": 1177252.428, "learn_time_ms": 902.263, "learn_throughput": 571.895, "synch_weights_time_ms": 13.052}, "counters": {"num_env_steps_sampled": 11868, "num_env_steps_trained": 11868, "num_agent_steps_sampled": 11868, "num_agent_steps_trained": 11868}, "done": false, "episodes_total": 517, "training_iteration": 23, "trial_id": "fe178_00000", "date": "2024-08-15_17-19-12", "timestamp": 1723763952, "time_this_iter_s": 60.953927516937256, "time_total_s": 1461.8936958312988, "pid": 17282, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 302.1083242893219, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.645977011494256, "ram_util_percent": 12.704597701149428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.6899081548055, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.19978240331014, "policy_loss": -0.021441042819060386, "vf_loss": 8.217158806324004, "vf_explained_var": 0.054434154431025186, "kl": 0.008129441562536149, "entropy": 0.43199648161729176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12384, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 12384, "num_agent_steps_trained": 12384}, "sampler_results": {"episode_reward_max": 296.73060631339945, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 222.47609365411913, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2976, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268, 184.0302177775879, 231.9268141106778, 224.85136768701727, 229.5195991886045, 177.11365951682524, 234.71959778777557, 250.11050473896904, 188.74728160446375, 257.0404304313254, 296.73060631339945, 230.7138827952169, 206.8084107524441, 205.1444896299554, 237.98287659229112, 205.78333336132198, 211.81153826872065, 117.30237319908963, 268.5228765171003, 253.54048103974216, 211.5636938004784, 209.1747384215239, 253.92681389617815, 233.17090026624584, 236.4062395638109, 168.13823823437454, 176.26100037692783, 268.4144614331777, 271.1770480752136, 254.72892090960391, 290.9285131054536, 226.99514917862825, 280.56546452944013], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 49, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.456909136082926, "mean_inference_ms": 1.2557577827418105, "mean_action_processing_ms": 0.20928788851062893, "mean_env_wait_ms": 639.0995744103404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012055904634537236, "StateBufferConnector_ms": 0.006023914583267704, "ViewRequirementAgentConnector_ms": 0.1700770470403856}, "num_episodes": 11, "episode_return_max": 296.73060631339945, "episode_return_min": 39.06970038618431, "episode_return_mean": 222.47609365411913}, "env_runner_results": {"episode_reward_max": 296.73060631339945, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 222.47609365411913, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2976, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268, 184.0302177775879, 231.9268141106778, 224.85136768701727, 229.5195991886045, 177.11365951682524, 234.71959778777557, 250.11050473896904, 188.74728160446375, 257.0404304313254, 296.73060631339945, 230.7138827952169, 206.8084107524441, 205.1444896299554, 237.98287659229112, 205.78333336132198, 211.81153826872065, 117.30237319908963, 268.5228765171003, 253.54048103974216, 211.5636938004784, 209.1747384215239, 253.92681389617815, 233.17090026624584, 236.4062395638109, 168.13823823437454, 176.26100037692783, 268.4144614331777, 271.1770480752136, 254.72892090960391, 290.9285131054536, 226.99514917862825, 280.56546452944013], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 49, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.456909136082926, "mean_inference_ms": 1.2557577827418105, "mean_action_processing_ms": 0.20928788851062893, "mean_env_wait_ms": 639.0995744103404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012055904634537236, "StateBufferConnector_ms": 0.006023914583267704, "ViewRequirementAgentConnector_ms": 0.1700770470403856}, "num_episodes": 11, "episode_return_max": 296.73060631339945, "episode_return_min": 39.06970038618431, "episode_return_mean": 222.47609365411913}, "episode_reward_max": 296.73060631339945, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 222.47609365411913, "episode_len_mean": 48.0, "episodes_this_iter": 11, "episodes_timesteps_total": 2976, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268, 184.0302177775879, 231.9268141106778, 224.85136768701727, 229.5195991886045, 177.11365951682524, 234.71959778777557, 250.11050473896904, 188.74728160446375, 257.0404304313254, 296.73060631339945, 230.7138827952169, 206.8084107524441, 205.1444896299554, 237.98287659229112, 205.78333336132198, 211.81153826872065, 117.30237319908963, 268.5228765171003, 253.54048103974216, 211.5636938004784, 209.1747384215239, 253.92681389617815, 233.17090026624584, 236.4062395638109, 168.13823823437454, 176.26100037692783, 268.4144614331777, 271.1770480752136, 254.72892090960391, 290.9285131054536, 226.99514917862825, 280.56546452944013], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 49, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.456909136082926, "mean_inference_ms": 1.2557577827418105, "mean_action_processing_ms": 0.20928788851062893, "mean_env_wait_ms": 639.0995744103404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012055904634537236, "StateBufferConnector_ms": 0.006023914583267704, "ViewRequirementAgentConnector_ms": 0.1700770470403856}, "num_episodes": 11, "episode_return_max": 296.73060631339945, "episode_return_min": 39.06970038618431, "episode_return_mean": 222.47609365411913, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12384, "num_agent_steps_trained": 12384, "num_env_steps_sampled": 12384, "num_env_steps_trained": 12384, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.574116249861659, "num_env_steps_trained_throughput_per_sec": 8.574116249861659, "timesteps_total": 12384, "num_env_steps_sampled_lifetime": 12384, "num_agent_steps_sampled_lifetime": 12384, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 12384, "timers": {"training_iteration_time_ms": 60378.975, "restore_workers_time_ms": 0.019, "training_step_time_ms": 60378.919, "sample_time_ms": 59505.621, "load_time_ms": 0.417, "load_throughput": 1237663.475, "learn_time_ms": 859.488, "learn_throughput": 600.357, "synch_weights_time_ms": 13.099}, "counters": {"num_env_steps_sampled": 12384, "num_env_steps_trained": 12384, "num_agent_steps_sampled": 12384, "num_agent_steps_trained": 12384}, "done": false, "episodes_total": 528, "training_iteration": 24, "trial_id": "fe178_00000", "date": "2024-08-15_17-20-12", "timestamp": 1723764012, "time_this_iter_s": 60.18475127220154, "time_total_s": 1522.0784471035004, "pid": 17282, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 362.29307556152344, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.4406976744186, "ram_util_percent": 12.789534883720926}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.176120525598526, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.376798768838247, "policy_loss": -0.02089800965040922, "vf_loss": 8.394516758124034, "vf_explained_var": 0.2538214400410652, "kl": 0.00636003100468521, "entropy": 0.45596271281441053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12900, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 12900, "num_agent_steps_trained": 12900}, "sampler_results": {"episode_reward_max": 296.73060631339945, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 225.98808107599075, "episode_len_mean": 47.78082191780822, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3488, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268, 184.0302177775879, 231.9268141106778, 224.85136768701727, 229.5195991886045, 177.11365951682524, 234.71959778777557, 250.11050473896904, 188.74728160446375, 257.0404304313254, 296.73060631339945, 230.7138827952169, 206.8084107524441, 205.1444896299554, 237.98287659229112, 205.78333336132198, 211.81153826872065, 117.30237319908963, 268.5228765171003, 253.54048103974216, 211.5636938004784, 209.1747384215239, 253.92681389617815, 233.17090026624584, 236.4062395638109, 168.13823823437454, 176.26100037692783, 268.4144614331777, 271.1770480752136, 254.72892090960391, 290.9285131054536, 226.99514917862825, 280.56546452944013, 257.6433337012915, 283.4109734970321, 257.1795436986872, 257.2354765544988, 273.1345131818862, 261.54564757908355, 271.2805682429619, 239.36099264897342, 52.037182617187455, 274.37134446590613, 276.412535804429], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 49, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.494341626038947, "mean_inference_ms": 1.2548069775931663, "mean_action_processing_ms": 0.20925371000154108, "mean_env_wait_ms": 644.6047516102523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011933013184429847, "StateBufferConnector_ms": 0.006045380683794414, "ViewRequirementAgentConnector_ms": 0.17120380924172598}, "num_episodes": 11, "episode_return_max": 296.73060631339945, "episode_return_min": 39.06970038618431, "episode_return_mean": 225.98808107599075}, "env_runner_results": {"episode_reward_max": 296.73060631339945, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 225.98808107599075, "episode_len_mean": 47.78082191780822, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3488, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268, 184.0302177775879, 231.9268141106778, 224.85136768701727, 229.5195991886045, 177.11365951682524, 234.71959778777557, 250.11050473896904, 188.74728160446375, 257.0404304313254, 296.73060631339945, 230.7138827952169, 206.8084107524441, 205.1444896299554, 237.98287659229112, 205.78333336132198, 211.81153826872065, 117.30237319908963, 268.5228765171003, 253.54048103974216, 211.5636938004784, 209.1747384215239, 253.92681389617815, 233.17090026624584, 236.4062395638109, 168.13823823437454, 176.26100037692783, 268.4144614331777, 271.1770480752136, 254.72892090960391, 290.9285131054536, 226.99514917862825, 280.56546452944013, 257.6433337012915, 283.4109734970321, 257.1795436986872, 257.2354765544988, 273.1345131818862, 261.54564757908355, 271.2805682429619, 239.36099264897342, 52.037182617187455, 274.37134446590613, 276.412535804429], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 49, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.494341626038947, "mean_inference_ms": 1.2548069775931663, "mean_action_processing_ms": 0.20925371000154108, "mean_env_wait_ms": 644.6047516102523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011933013184429847, "StateBufferConnector_ms": 0.006045380683794414, "ViewRequirementAgentConnector_ms": 0.17120380924172598}, "num_episodes": 11, "episode_return_max": 296.73060631339945, "episode_return_min": 39.06970038618431, "episode_return_mean": 225.98808107599075}, "episode_reward_max": 296.73060631339945, "episode_reward_min": 39.06970038618431, "episode_reward_mean": 225.98808107599075, "episode_len_mean": 47.78082191780822, "episodes_this_iter": 11, "episodes_timesteps_total": 3488, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [230.10749996369583, 232.437029963707, 212.58902318058153, 221.36912698524213, 213.08872274656233, 217.86289583237055, 264.39800361903076, 210.73023396642378, 227.1592066459226, 39.06970038618431, 251.20642662138886, 230.01772988945612, 268.70501973371324, 221.70977144821612, 253.2486480432055, 233.62058696627702, 129.9104890312039, 212.12824342005325, 245.11385500586238, 43.04921653844531, 236.13801931957698, 232.67852869919835, 213.99644268313006, 262.0564264897432, 202.56845260713567, 218.12303146780005, 220.89024040948442, 218.42712529764088, 245.4716630907235, 291.7949233998268, 184.0302177775879, 231.9268141106778, 224.85136768701727, 229.5195991886045, 177.11365951682524, 234.71959778777557, 250.11050473896904, 188.74728160446375, 257.0404304313254, 296.73060631339945, 230.7138827952169, 206.8084107524441, 205.1444896299554, 237.98287659229112, 205.78333336132198, 211.81153826872065, 117.30237319908963, 268.5228765171003, 253.54048103974216, 211.5636938004784, 209.1747384215239, 253.92681389617815, 233.17090026624584, 236.4062395638109, 168.13823823437454, 176.26100037692783, 268.4144614331777, 271.1770480752136, 254.72892090960391, 290.9285131054536, 226.99514917862825, 280.56546452944013, 257.6433337012915, 283.4109734970321, 257.1795436986872, 257.2354765544988, 273.1345131818862, 261.54564757908355, 271.2805682429619, 239.36099264897342, 52.037182617187455, 274.37134446590613, 276.412535804429], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50, 50, 50, 50, 50, 31, 50, 50, 11, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 49, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 12, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.494341626038947, "mean_inference_ms": 1.2548069775931663, "mean_action_processing_ms": 0.20925371000154108, "mean_env_wait_ms": 644.6047516102523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011933013184429847, "StateBufferConnector_ms": 0.006045380683794414, "ViewRequirementAgentConnector_ms": 0.17120380924172598}, "num_episodes": 11, "episode_return_max": 296.73060631339945, "episode_return_min": 39.06970038618431, "episode_return_mean": 225.98808107599075, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12900, "num_agent_steps_trained": 12900, "num_env_steps_sampled": 12900, "num_env_steps_trained": 12900, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 6.089294194177421, "num_env_steps_trained_throughput_per_sec": 6.089294194177421, "timesteps_total": 12900, "num_env_steps_sampled_lifetime": 12900, "num_agent_steps_sampled_lifetime": 12900, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 12900, "timers": {"training_iteration_time_ms": 63858.963, "restore_workers_time_ms": 0.019, "training_step_time_ms": 63858.908, "sample_time_ms": 63011.646, "load_time_ms": 0.407, "load_throughput": 1267873.968, "learn_time_ms": 833.523, "learn_throughput": 619.059, "synch_weights_time_ms": 13.048}, "counters": {"num_env_steps_sampled": 12900, "num_env_steps_trained": 12900, "num_agent_steps_sampled": 12900, "num_agent_steps_trained": 12900}, "done": false, "episodes_total": 539, "training_iteration": 25, "trial_id": "fe178_00000", "date": "2024-08-15_17-21-36", "timestamp": 1723764096, "time_this_iter_s": 84.74249339103699, "time_total_s": 1606.8209404945374, "pid": 17282, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 447.0355689525604, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 16.41074380165289, "ram_util_percent": 11.314876033057852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.421244104703267, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.939671365420024, "policy_loss": -0.022072650926808515, "vf_loss": 8.958136796951294, "vf_explained_var": 0.2100972185532252, "kl": 0.007214683731218614, "entropy": 0.32880939352714145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13416, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 13416, "num_agent_steps_trained": 13416}, "sampler_results": {"episode_reward_max": 274.2623330182722, "episode_reward_min": 214.15535435750695, "episode_reward_mean": 244.98768839284108, "episode_len_mean": 48.666666666666664, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 292, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586], "episode_lengths": [50, 50, 42, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.119671167541738, "mean_inference_ms": 1.2675697319352306, "mean_action_processing_ms": 0.20988782246907553, "mean_env_wait_ms": 573.2320643019401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008900960286458334, "StateBufferConnector_ms": 0.005630652109781901, "ViewRequirementAgentConnector_ms": 0.1620213190714518}, "num_episodes": 6, "episode_return_max": 274.2623330182722, "episode_return_min": 214.15535435750695, "episode_return_mean": 244.98768839284108}, "env_runner_results": {"episode_reward_max": 274.2623330182722, "episode_reward_min": 214.15535435750695, "episode_reward_mean": 244.98768839284108, "episode_len_mean": 48.666666666666664, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 292, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586], "episode_lengths": [50, 50, 42, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.119671167541738, "mean_inference_ms": 1.2675697319352306, "mean_action_processing_ms": 0.20988782246907553, "mean_env_wait_ms": 573.2320643019401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008900960286458334, "StateBufferConnector_ms": 0.005630652109781901, "ViewRequirementAgentConnector_ms": 0.1620213190714518}, "num_episodes": 6, "episode_return_max": 274.2623330182722, "episode_return_min": 214.15535435750695, "episode_return_mean": 244.98768839284108}, "episode_reward_max": 274.2623330182722, "episode_reward_min": 214.15535435750695, "episode_reward_mean": 244.98768839284108, "episode_len_mean": 48.666666666666664, "episodes_this_iter": 6, "episodes_timesteps_total": 292, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586], "episode_lengths": [50, 50, 42, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.119671167541738, "mean_inference_ms": 1.2675697319352306, "mean_action_processing_ms": 0.20988782246907553, "mean_env_wait_ms": 573.2320643019401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008900960286458334, "StateBufferConnector_ms": 0.005630652109781901, "ViewRequirementAgentConnector_ms": 0.1620213190714518}, "num_episodes": 6, "episode_return_max": 274.2623330182722, "episode_return_min": 214.15535435750695, "episode_return_mean": 244.98768839284108, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13416, "num_agent_steps_trained": 13416, "num_env_steps_sampled": 13416, "num_env_steps_trained": 13416, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.138772615941813, "num_env_steps_trained_throughput_per_sec": 9.138772615941813, "timesteps_total": 13416, "num_env_steps_sampled_lifetime": 13416, "num_agent_steps_sampled_lifetime": 13416, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 13416, "timers": {"training_iteration_time_ms": 56462.738, "restore_workers_time_ms": 0.018, "training_step_time_ms": 56462.679, "sample_time_ms": 52984.614, "load_time_ms": 0.769, "load_throughput": 671088.64, "learn_time_ms": 3463.962, "learn_throughput": 148.962, "synch_weights_time_ms": 12.873}, "counters": {"num_env_steps_sampled": 13416, "num_env_steps_trained": 13416, "num_agent_steps_sampled": 13416, "num_agent_steps_trained": 13416}, "done": false, "episodes_total": 545, "training_iteration": 26, "trial_id": "fe178_00000", "date": "2024-08-15_17-22-55", "timestamp": 1723764175, "time_this_iter_s": 56.465665102005005, "time_total_s": 1663.2866055965424, "pid": 69744, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 56.465665102005005, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 26.08641975308642, "ram_util_percent": 10.676543209876543}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.962988130251567, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.474219739437103, "policy_loss": -0.017583121778443456, "vf_loss": 8.487202676137288, "vf_explained_var": 0.02981828103462855, "kl": 0.0092004232047057, "entropy": 0.37220732054362693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13932, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 13932, "num_agent_steps_trained": 13932}, "sampler_results": {"episode_reward_max": 296.75001322112865, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 248.2783560035387, "episode_len_mean": 47.421052631578945, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 901, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.019957153961785, "mean_inference_ms": 1.260696776356303, "mean_action_processing_ms": 0.2090073589282011, "mean_env_wait_ms": 574.4487121367491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011342450192100123, "StateBufferConnector_ms": 0.007224082946777344, "ViewRequirementAgentConnector_ms": 0.16790314724570826}, "num_episodes": 13, "episode_return_max": 296.75001322112865, "episode_return_min": 36.13765753595652, "episode_return_mean": 248.2783560035387}, "env_runner_results": {"episode_reward_max": 296.75001322112865, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 248.2783560035387, "episode_len_mean": 47.421052631578945, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 901, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.019957153961785, "mean_inference_ms": 1.260696776356303, "mean_action_processing_ms": 0.2090073589282011, "mean_env_wait_ms": 574.4487121367491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011342450192100123, "StateBufferConnector_ms": 0.007224082946777344, "ViewRequirementAgentConnector_ms": 0.16790314724570826}, "num_episodes": 13, "episode_return_max": 296.75001322112865, "episode_return_min": 36.13765753595652, "episode_return_mean": 248.2783560035387}, "episode_reward_max": 296.75001322112865, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 248.2783560035387, "episode_len_mean": 47.421052631578945, "episodes_this_iter": 13, "episodes_timesteps_total": 901, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.019957153961785, "mean_inference_ms": 1.260696776356303, "mean_action_processing_ms": 0.2090073589282011, "mean_env_wait_ms": 574.4487121367491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011342450192100123, "StateBufferConnector_ms": 0.007224082946777344, "ViewRequirementAgentConnector_ms": 0.16790314724570826}, "num_episodes": 13, "episode_return_max": 296.75001322112865, "episode_return_min": 36.13765753595652, "episode_return_mean": 248.2783560035387, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13932, "num_agent_steps_trained": 13932, "num_env_steps_sampled": 13932, "num_env_steps_trained": 13932, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.86781830171821, "num_env_steps_trained_throughput_per_sec": 8.86781830171821, "timesteps_total": 13932, "num_env_steps_sampled_lifetime": 13932, "num_agent_steps_sampled_lifetime": 13932, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 13932, "timers": {"training_iteration_time_ms": 57325.34, "restore_workers_time_ms": 0.017, "training_step_time_ms": 57325.285, "sample_time_ms": 55260.764, "load_time_ms": 0.564, "load_throughput": 915507.98, "learn_time_ms": 2050.685, "learn_throughput": 251.623, "synch_weights_time_ms": 12.914}, "counters": {"num_env_steps_sampled": 13932, "num_env_steps_trained": 13932, "num_agent_steps_sampled": 13932, "num_agent_steps_trained": 13932}, "done": false, "episodes_total": 558, "training_iteration": 27, "trial_id": "fe178_00000", "date": "2024-08-15_17-23-54", "timestamp": 1723764234, "time_this_iter_s": 58.19089484214783, "time_total_s": 1721.4775004386902, "pid": 69744, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 114.65655994415283, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.896385542168677, "ram_util_percent": 12.273493975903609}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.078908280531566, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.825877054532368, "policy_loss": -0.02150783365747581, "vf_loss": 8.844025015830994, "vf_explained_var": 0.17687848607699078, "kl": 0.006719536026261458, "entropy": 0.3337945926934481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "sampler_results": {"episode_reward_max": 305.17563702035295, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 247.20493315895388, "episode_len_mean": 47.4, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1422, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226, 208.08248055498365, 260.57024024468166, 271.21040955692047, 239.97978889069054, 305.17563702035295, 283.07944942254994, 272.8364484898814, 283.9337181712878, 205.58210055251828, 254.90292681394692, 113.50603098356736], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.206713098668627, "mean_inference_ms": 1.2579996080249718, "mean_action_processing_ms": 0.20901130176066035, "mean_env_wait_ms": 581.7803591709918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011800924936930338, "StateBufferConnector_ms": 0.0067901611328125, "ViewRequirementAgentConnector_ms": 0.16994714736938477}, "num_episodes": 11, "episode_return_max": 305.17563702035295, "episode_return_min": 36.13765753595652, "episode_return_mean": 247.20493315895388}, "env_runner_results": {"episode_reward_max": 305.17563702035295, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 247.20493315895388, "episode_len_mean": 47.4, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1422, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226, 208.08248055498365, 260.57024024468166, 271.21040955692047, 239.97978889069054, 305.17563702035295, 283.07944942254994, 272.8364484898814, 283.9337181712878, 205.58210055251828, 254.90292681394692, 113.50603098356736], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.206713098668627, "mean_inference_ms": 1.2579996080249718, "mean_action_processing_ms": 0.20901130176066035, "mean_env_wait_ms": 581.7803591709918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011800924936930338, "StateBufferConnector_ms": 0.0067901611328125, "ViewRequirementAgentConnector_ms": 0.16994714736938477}, "num_episodes": 11, "episode_return_max": 305.17563702035295, "episode_return_min": 36.13765753595652, "episode_return_mean": 247.20493315895388}, "episode_reward_max": 305.17563702035295, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 247.20493315895388, "episode_len_mean": 47.4, "episodes_this_iter": 11, "episodes_timesteps_total": 1422, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226, 208.08248055498365, 260.57024024468166, 271.21040955692047, 239.97978889069054, 305.17563702035295, 283.07944942254994, 272.8364484898814, 283.9337181712878, 205.58210055251828, 254.90292681394692, 113.50603098356736], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.206713098668627, "mean_inference_ms": 1.2579996080249718, "mean_action_processing_ms": 0.20901130176066035, "mean_env_wait_ms": 581.7803591709918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011800924936930338, "StateBufferConnector_ms": 0.0067901611328125, "ViewRequirementAgentConnector_ms": 0.16994714736938477}, "num_episodes": 11, "episode_return_max": 305.17563702035295, "episode_return_min": 36.13765753595652, "episode_return_mean": 247.20493315895388, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448, "num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.479517531920312, "num_env_steps_trained_throughput_per_sec": 8.479517531920312, "timesteps_total": 14448, "num_env_steps_sampled_lifetime": 14448, "num_agent_steps_sampled_lifetime": 14448, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 14448, "timers": {"training_iteration_time_ms": 58501.07, "restore_workers_time_ms": 0.017, "training_step_time_ms": 58501.016, "sample_time_ms": 56897.881, "load_time_ms": 0.486, "load_throughput": 1062300.817, "learn_time_ms": 1589.337, "learn_throughput": 324.664, "synch_weights_time_ms": 12.98}, "counters": {"num_env_steps_sampled": 14448, "num_env_steps_trained": 14448, "num_agent_steps_sampled": 14448, "num_agent_steps_trained": 14448}, "done": false, "episodes_total": 569, "training_iteration": 28, "trial_id": "fe178_00000", "date": "2024-08-15_17-24-54", "timestamp": 1723764294, "time_this_iter_s": 60.85549545288086, "time_total_s": 1782.332995891571, "pid": 69744, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 175.5120553970337, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.232183908045975, "ram_util_percent": 12.36436781609196}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.450950558980306, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 8.317889829476675, "policy_loss": -0.017742411761234204, "vf_loss": 8.33340052763621, "vf_explained_var": 0.0788510670264562, "kl": 0.004463199254467061, "entropy": 0.3428728457540274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14964, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 14964, "num_agent_steps_trained": 14964}, "sampler_results": {"episode_reward_max": 305.17563702035295, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 249.83438725164183, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 1872, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226, 208.08248055498365, 260.57024024468166, 271.21040955692047, 239.97978889069054, 305.17563702035295, 283.07944942254994, 272.8364484898814, 283.9337181712878, 205.58210055251828, 254.90292681394692, 113.50603098356736, 260.414332828114, 283.5834093682661, 222.15686959441325, 234.56232727097108, 245.24670056109778, 281.26139902906004, 247.31414122882933, 254.25188311615506, 298.6020450485108], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.278053870528775, "mean_inference_ms": 1.2568043998900043, "mean_action_processing_ms": 0.20902014751243714, "mean_env_wait_ms": 588.0656811807485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011891585129957933, "StateBufferConnector_ms": 0.0066378177740635015, "ViewRequirementAgentConnector_ms": 0.17052369240002754}, "num_episodes": 9, "episode_return_max": 305.17563702035295, "episode_return_min": 36.13765753595652, "episode_return_mean": 249.83438725164183}, "env_runner_results": {"episode_reward_max": 305.17563702035295, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 249.83438725164183, "episode_len_mean": 48.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 1872, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226, 208.08248055498365, 260.57024024468166, 271.21040955692047, 239.97978889069054, 305.17563702035295, 283.07944942254994, 272.8364484898814, 283.9337181712878, 205.58210055251828, 254.90292681394692, 113.50603098356736, 260.414332828114, 283.5834093682661, 222.15686959441325, 234.56232727097108, 245.24670056109778, 281.26139902906004, 247.31414122882933, 254.25188311615506, 298.6020450485108], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.278053870528775, "mean_inference_ms": 1.2568043998900043, "mean_action_processing_ms": 0.20902014751243714, "mean_env_wait_ms": 588.0656811807485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011891585129957933, "StateBufferConnector_ms": 0.0066378177740635015, "ViewRequirementAgentConnector_ms": 0.17052369240002754}, "num_episodes": 9, "episode_return_max": 305.17563702035295, "episode_return_min": 36.13765753595652, "episode_return_mean": 249.83438725164183}, "episode_reward_max": 305.17563702035295, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 249.83438725164183, "episode_len_mean": 48.0, "episodes_this_iter": 9, "episodes_timesteps_total": 1872, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226, 208.08248055498365, 260.57024024468166, 271.21040955692047, 239.97978889069054, 305.17563702035295, 283.07944942254994, 272.8364484898814, 283.9337181712878, 205.58210055251828, 254.90292681394692, 113.50603098356736, 260.414332828114, 283.5834093682661, 222.15686959441325, 234.56232727097108, 245.24670056109778, 281.26139902906004, 247.31414122882933, 254.25188311615506, 298.6020450485108], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.278053870528775, "mean_inference_ms": 1.2568043998900043, "mean_action_processing_ms": 0.20902014751243714, "mean_env_wait_ms": 588.0656811807485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011891585129957933, "StateBufferConnector_ms": 0.0066378177740635015, "ViewRequirementAgentConnector_ms": 0.17052369240002754}, "num_episodes": 9, "episode_return_max": 305.17563702035295, "episode_return_min": 36.13765753595652, "episode_return_mean": 249.83438725164183, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14964, "num_agent_steps_trained": 14964, "num_env_steps_sampled": 14964, "num_env_steps_trained": 14964, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.472139121342373, "num_env_steps_trained_throughput_per_sec": 8.472139121342373, "timesteps_total": 14964, "num_env_steps_sampled_lifetime": 14964, "num_agent_steps_sampled_lifetime": 14964, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 14964, "timers": {"training_iteration_time_ms": 59102.184, "restore_workers_time_ms": 0.018, "training_step_time_ms": 59102.13, "sample_time_ms": 57718.727, "load_time_ms": 0.443, "load_throughput": 1163893.984, "learn_time_ms": 1369.718, "learn_throughput": 376.72, "synch_weights_time_ms": 12.927}, "counters": {"num_env_steps_sampled": 14964, "num_env_steps_trained": 14964, "num_agent_steps_sampled": 14964, "num_agent_steps_trained": 14964}, "done": false, "episodes_total": 578, "training_iteration": 29, "trial_id": "fe178_00000", "date": "2024-08-15_17-25-55", "timestamp": 1723764355, "time_this_iter_s": 60.90833139419556, "time_total_s": 1843.2413272857666, "pid": 69744, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 236.42038679122925, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.718390804597707, "ram_util_percent": 11.171264367816093}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.311537230014801, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 8.540628019968668, "policy_loss": -0.019167395137871305, "vf_loss": 8.55806219180425, "vf_explained_var": 0.07783491959174474, "kl": 0.006932762727714468, "entropy": 0.2531444133569797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15480, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 15480, "num_agent_steps_trained": 15480}, "sampler_results": {"episode_reward_max": 308.98389305746434, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 251.47229717837862, "episode_len_mean": 48.44, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2422, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226, 208.08248055498365, 260.57024024468166, 271.21040955692047, 239.97978889069054, 305.17563702035295, 283.07944942254994, 272.8364484898814, 283.9337181712878, 205.58210055251828, 254.90292681394692, 113.50603098356736, 260.414332828114, 283.5834093682661, 222.15686959441325, 234.56232727097108, 245.24670056109778, 281.26139902906004, 247.31414122882933, 254.25188311615506, 298.6020450485108, 308.98389305746434, 240.29647753440105, 252.36166357205963, 307.3986825155476, 229.87466471939342, 214.06710262745503, 299.1822633699488, 213.89129307631413, 285.4398786144867, 268.4361252926021, 210.14171172522427], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.338911182789028, "mean_inference_ms": 1.2550981094738278, "mean_action_processing_ms": 0.20907596901976383, "mean_env_wait_ms": 591.7006552097367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011891841888427734, "StateBufferConnector_ms": 0.006559848785400391, "ViewRequirementAgentConnector_ms": 0.17178869247436523}, "num_episodes": 11, "episode_return_max": 308.98389305746434, "episode_return_min": 36.13765753595652, "episode_return_mean": 251.47229717837862}, "env_runner_results": {"episode_reward_max": 308.98389305746434, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 251.47229717837862, "episode_len_mean": 48.44, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2422, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226, 208.08248055498365, 260.57024024468166, 271.21040955692047, 239.97978889069054, 305.17563702035295, 283.07944942254994, 272.8364484898814, 283.9337181712878, 205.58210055251828, 254.90292681394692, 113.50603098356736, 260.414332828114, 283.5834093682661, 222.15686959441325, 234.56232727097108, 245.24670056109778, 281.26139902906004, 247.31414122882933, 254.25188311615506, 298.6020450485108, 308.98389305746434, 240.29647753440105, 252.36166357205963, 307.3986825155476, 229.87466471939342, 214.06710262745503, 299.1822633699488, 213.89129307631413, 285.4398786144867, 268.4361252926021, 210.14171172522427], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.338911182789028, "mean_inference_ms": 1.2550981094738278, "mean_action_processing_ms": 0.20907596901976383, "mean_env_wait_ms": 591.7006552097367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011891841888427734, "StateBufferConnector_ms": 0.006559848785400391, "ViewRequirementAgentConnector_ms": 0.17178869247436523}, "num_episodes": 11, "episode_return_max": 308.98389305746434, "episode_return_min": 36.13765753595652, "episode_return_mean": 251.47229717837862}, "episode_reward_max": 308.98389305746434, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 251.47229717837862, "episode_len_mean": 48.44, "episodes_this_iter": 11, "episodes_timesteps_total": 2422, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226, 208.08248055498365, 260.57024024468166, 271.21040955692047, 239.97978889069054, 305.17563702035295, 283.07944942254994, 272.8364484898814, 283.9337181712878, 205.58210055251828, 254.90292681394692, 113.50603098356736, 260.414332828114, 283.5834093682661, 222.15686959441325, 234.56232727097108, 245.24670056109778, 281.26139902906004, 247.31414122882933, 254.25188311615506, 298.6020450485108, 308.98389305746434, 240.29647753440105, 252.36166357205963, 307.3986825155476, 229.87466471939342, 214.06710262745503, 299.1822633699488, 213.89129307631413, 285.4398786144867, 268.4361252926021, 210.14171172522427], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.338911182789028, "mean_inference_ms": 1.2550981094738278, "mean_action_processing_ms": 0.20907596901976383, "mean_env_wait_ms": 591.7006552097367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011891841888427734, "StateBufferConnector_ms": 0.006559848785400391, "ViewRequirementAgentConnector_ms": 0.17178869247436523}, "num_episodes": 11, "episode_return_max": 308.98389305746434, "episode_return_min": 36.13765753595652, "episode_return_mean": 251.47229717837862, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15480, "num_agent_steps_trained": 15480, "num_env_steps_sampled": 15480, "num_env_steps_trained": 15480, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.252938427556462, "num_env_steps_trained_throughput_per_sec": 9.252938427556462, "timesteps_total": 15480, "num_env_steps_sampled_lifetime": 15480, "num_agent_steps_sampled_lifetime": 15480, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 15480, "timers": {"training_iteration_time_ms": 58434.964, "restore_workers_time_ms": 0.018, "training_step_time_ms": 58434.911, "sample_time_ms": 57193.121, "load_time_ms": 0.415, "load_throughput": 1243685.13, "learn_time_ms": 1228.207, "learn_throughput": 420.125, "synch_weights_time_ms": 12.865}, "counters": {"num_env_steps_sampled": 15480, "num_env_steps_trained": 15480, "num_agent_steps_sampled": 15480, "num_agent_steps_trained": 15480}, "done": false, "episodes_total": 589, "training_iteration": 30, "trial_id": "fe178_00000", "date": "2024-08-15_17-26-51", "timestamp": 1723764411, "time_this_iter_s": 55.76931190490723, "time_total_s": 1899.0106391906738, "pid": 69744, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 292.1896986961365, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 28.055, "ram_util_percent": 12.371250000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.891012720266978, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 8.46974521080653, "policy_loss": -0.021612044353969396, "vf_loss": 8.489025290807088, "vf_explained_var": 0.14103643546501796, "kl": 0.009328143527577047, "entropy": 0.24671848209885258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15996, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 15996, "num_agent_steps_trained": 15996}, "sampler_results": {"episode_reward_max": 308.98389305746434, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 253.30013489355156, "episode_len_mean": 48.721311475409834, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2972, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226, 208.08248055498365, 260.57024024468166, 271.21040955692047, 239.97978889069054, 305.17563702035295, 283.07944942254994, 272.8364484898814, 283.9337181712878, 205.58210055251828, 254.90292681394692, 113.50603098356736, 260.414332828114, 283.5834093682661, 222.15686959441325, 234.56232727097108, 245.24670056109778, 281.26139902906004, 247.31414122882933, 254.25188311615506, 298.6020450485108, 308.98389305746434, 240.29647753440105, 252.36166357205963, 307.3986825155476, 229.87466471939342, 214.06710262745503, 299.1822633699488, 213.89129307631413, 285.4398786144867, 268.4361252926021, 210.14171172522427, 274.5524893029182, 287.73525997421405, 214.64089263770597, 224.99833503176495, 244.5430804003334, 275.2071176006599, 276.6479915893212, 280.39310954983847, 284.48541110537747, 258.40582815481724, 256.0838542407639], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.386336922374111, "mean_inference_ms": 1.254557755010128, "mean_action_processing_ms": 0.20911139107315782, "mean_env_wait_ms": 590.9891235205608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011920928955078125, "StateBufferConnector_ms": 0.006455671591836898, "ViewRequirementAgentConnector_ms": 0.171920901439229}, "num_episodes": 11, "episode_return_max": 308.98389305746434, "episode_return_min": 36.13765753595652, "episode_return_mean": 253.30013489355156}, "env_runner_results": {"episode_reward_max": 308.98389305746434, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 253.30013489355156, "episode_len_mean": 48.721311475409834, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2972, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226, 208.08248055498365, 260.57024024468166, 271.21040955692047, 239.97978889069054, 305.17563702035295, 283.07944942254994, 272.8364484898814, 283.9337181712878, 205.58210055251828, 254.90292681394692, 113.50603098356736, 260.414332828114, 283.5834093682661, 222.15686959441325, 234.56232727097108, 245.24670056109778, 281.26139902906004, 247.31414122882933, 254.25188311615506, 298.6020450485108, 308.98389305746434, 240.29647753440105, 252.36166357205963, 307.3986825155476, 229.87466471939342, 214.06710262745503, 299.1822633699488, 213.89129307631413, 285.4398786144867, 268.4361252926021, 210.14171172522427, 274.5524893029182, 287.73525997421405, 214.64089263770597, 224.99833503176495, 244.5430804003334, 275.2071176006599, 276.6479915893212, 280.39310954983847, 284.48541110537747, 258.40582815481724, 256.0838542407639], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.386336922374111, "mean_inference_ms": 1.254557755010128, "mean_action_processing_ms": 0.20911139107315782, "mean_env_wait_ms": 590.9891235205608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011920928955078125, "StateBufferConnector_ms": 0.006455671591836898, "ViewRequirementAgentConnector_ms": 0.171920901439229}, "num_episodes": 11, "episode_return_max": 308.98389305746434, "episode_return_min": 36.13765753595652, "episode_return_mean": 253.30013489355156}, "episode_reward_max": 308.98389305746434, "episode_reward_min": 36.13765753595652, "episode_reward_mean": 253.30013489355156, "episode_len_mean": 48.721311475409834, "episodes_this_iter": 11, "episodes_timesteps_total": 2972, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [229.99388158659326, 265.9400255992177, 214.15535435750695, 274.2623330182722, 223.30127680887057, 262.273258986586, 296.75001322112865, 294.760671636513, 268.4885975465372, 36.13765753595652, 252.30493652577724, 285.789276571354, 287.89536570331484, 211.84125993688497, 263.30786544684963, 269.33746445613286, 242.0837665428311, 294.2465075351666, 244.41925105174226, 208.08248055498365, 260.57024024468166, 271.21040955692047, 239.97978889069054, 305.17563702035295, 283.07944942254994, 272.8364484898814, 283.9337181712878, 205.58210055251828, 254.90292681394692, 113.50603098356736, 260.414332828114, 283.5834093682661, 222.15686959441325, 234.56232727097108, 245.24670056109778, 281.26139902906004, 247.31414122882933, 254.25188311615506, 298.6020450485108, 308.98389305746434, 240.29647753440105, 252.36166357205963, 307.3986825155476, 229.87466471939342, 214.06710262745503, 299.1822633699488, 213.89129307631413, 285.4398786144867, 268.4361252926021, 210.14171172522427, 274.5524893029182, 287.73525997421405, 214.64089263770597, 224.99833503176495, 244.5430804003334, 275.2071176006599, 276.6479915893212, 280.39310954983847, 284.48541110537747, 258.40582815481724, 256.0838542407639], "episode_lengths": [50, 50, 42, 50, 50, 50, 50, 50, 50, 9, 50, 50, 50, 50, 50, 50, 50, 50, 50, 48, 50, 50, 50, 50, 50, 50, 50, 50, 50, 23, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.386336922374111, "mean_inference_ms": 1.254557755010128, "mean_action_processing_ms": 0.20911139107315782, "mean_env_wait_ms": 590.9891235205608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011920928955078125, "StateBufferConnector_ms": 0.006455671591836898, "ViewRequirementAgentConnector_ms": 0.171920901439229}, "num_episodes": 11, "episode_return_max": 308.98389305746434, "episode_return_min": 36.13765753595652, "episode_return_mean": 253.30013489355156, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15996, "num_agent_steps_trained": 15996, "num_env_steps_sampled": 15996, "num_env_steps_trained": 15996, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.771229305806479, "num_env_steps_trained_throughput_per_sec": 10.771229305806479, "timesteps_total": 15996, "num_env_steps_sampled_lifetime": 15996, "num_agent_steps_sampled_lifetime": 15996, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 15996, "timers": {"training_iteration_time_ms": 56680.038, "restore_workers_time_ms": 0.018, "training_step_time_ms": 56679.984, "sample_time_ms": 55537.785, "load_time_ms": 0.405, "load_throughput": 1273344.301, "learn_time_ms": 1128.529, "learn_throughput": 457.232, "synch_weights_time_ms": 12.969}, "counters": {"num_env_steps_sampled": 15996, "num_env_steps_trained": 15996, "num_agent_steps_sampled": 15996, "num_agent_steps_trained": 15996}, "done": false, "episodes_total": 600, "training_iteration": 31, "trial_id": "fe178_00000", "date": "2024-08-15_17-27-39", "timestamp": 1723764459, "time_this_iter_s": 47.90860962867737, "time_total_s": 1946.9192488193512, "pid": 69744, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 340.09830832481384, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 31.63382352941177, "ram_util_percent": 12.439705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.956845096747081, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 8.954783399899801, "policy_loss": 0.0035415434588988623, "vf_loss": 8.9493558883667, "vf_explained_var": 0.07308289408683777, "kl": 0.007544196100207716, "entropy": 0.23395958781863252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16512, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 16512, "num_agent_steps_trained": 16512}, "sampler_results": {"episode_reward_max": 294.7597645946321, "episode_reward_min": 223.075902853123, "episode_reward_mean": 270.5256899328016, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.51962330239263, 256.2533432749254, 223.075902853123, 294.7597645946321, 268.8258583222825, 294.71964724945377], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.166128534923567, "mean_inference_ms": 1.2661730192630225, "mean_action_processing_ms": 0.2132791212235374, "mean_env_wait_ms": 565.7883174574694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009218851725260416, "StateBufferConnector_ms": 0.005976359049479167, "ViewRequirementAgentConnector_ms": 0.16262531280517578}, "num_episodes": 6, "episode_return_max": 294.7597645946321, "episode_return_min": 223.075902853123, "episode_return_mean": 270.5256899328016}, "env_runner_results": {"episode_reward_max": 294.7597645946321, "episode_reward_min": 223.075902853123, "episode_reward_mean": 270.5256899328016, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.51962330239263, 256.2533432749254, 223.075902853123, 294.7597645946321, 268.8258583222825, 294.71964724945377], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.166128534923567, "mean_inference_ms": 1.2661730192630225, "mean_action_processing_ms": 0.2132791212235374, "mean_env_wait_ms": 565.7883174574694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009218851725260416, "StateBufferConnector_ms": 0.005976359049479167, "ViewRequirementAgentConnector_ms": 0.16262531280517578}, "num_episodes": 6, "episode_return_max": 294.7597645946321, "episode_return_min": 223.075902853123, "episode_return_mean": 270.5256899328016}, "episode_reward_max": 294.7597645946321, "episode_reward_min": 223.075902853123, "episode_reward_mean": 270.5256899328016, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [285.51962330239263, 256.2533432749254, 223.075902853123, 294.7597645946321, 268.8258583222825, 294.71964724945377], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.166128534923567, "mean_inference_ms": 1.2661730192630225, "mean_action_processing_ms": 0.2132791212235374, "mean_env_wait_ms": 565.7883174574694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009218851725260416, "StateBufferConnector_ms": 0.005976359049479167, "ViewRequirementAgentConnector_ms": 0.16262531280517578}, "num_episodes": 6, "episode_return_max": 294.7597645946321, "episode_return_min": 223.075902853123, "episode_return_mean": 270.5256899328016, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16512, "num_agent_steps_trained": 16512, "num_env_steps_sampled": 16512, "num_env_steps_trained": 16512, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.599989482092738, "num_env_steps_trained_throughput_per_sec": 9.599989482092738, "timesteps_total": 16512, "num_env_steps_sampled_lifetime": 16512, "num_agent_steps_sampled_lifetime": 16512, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 16512, "timers": {"training_iteration_time_ms": 53750.073, "restore_workers_time_ms": 0.027, "training_step_time_ms": 53749.998, "sample_time_ms": 52232.588, "load_time_ms": 0.849, "load_throughput": 607426.569, "learn_time_ms": 1502.864, "learn_throughput": 343.345, "synch_weights_time_ms": 13.232}, "counters": {"num_env_steps_sampled": 16512, "num_env_steps_trained": 16512, "num_agent_steps_sampled": 16512, "num_agent_steps_trained": 16512}, "done": false, "episodes_total": 606, "training_iteration": 32, "trial_id": "fe178_00000", "date": "2024-08-15_17-29-09", "timestamp": 1723764549, "time_this_iter_s": 53.75289964675903, "time_total_s": 2000.6721484661102, "pid": 17255, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 53.75289964675903, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.548051948051945, "ram_util_percent": 12.187012987012986}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.846548173824946, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 8.972992106278737, "policy_loss": -0.019322869243721168, "vf_loss": 8.989673578739167, "vf_explained_var": 0.1664802854259809, "kl": 0.010565466226642284, "entropy": 0.09993102630445112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17028, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 17028, "num_agent_steps_trained": 17028}, "sampler_results": {"episode_reward_max": 334.44392285897885, "episode_reward_min": 57.02960091075248, "episode_reward_mean": 248.3987763938896, "episode_len_mean": 45.5, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 910, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.51962330239263, 256.2533432749254, 223.075902853123, 294.7597645946321, 268.8258583222825, 294.71964724945377, 296.46684610617586, 247.93865474413934, 229.47877550500476, 295.14074061973577, 113.11743359577154, 334.44392285897885, 265.65919170704797, 255.43262818760257, 288.7275690111177, 252.8856786180229, 288.9376374952424, 308.35830732772024, 57.02960091075248, 111.20440159366944], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 12, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.215132025799222, "mean_inference_ms": 1.2647206185624558, "mean_action_processing_ms": 0.21187326502747714, "mean_env_wait_ms": 561.417370296049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012240409851074219, "StateBufferConnector_ms": 0.006070137023925781, "ViewRequirementAgentConnector_ms": 0.15996456146240234}, "num_episodes": 14, "episode_return_max": 334.44392285897885, "episode_return_min": 57.02960091075248, "episode_return_mean": 248.3987763938896}, "env_runner_results": {"episode_reward_max": 334.44392285897885, "episode_reward_min": 57.02960091075248, "episode_reward_mean": 248.3987763938896, "episode_len_mean": 45.5, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 910, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.51962330239263, 256.2533432749254, 223.075902853123, 294.7597645946321, 268.8258583222825, 294.71964724945377, 296.46684610617586, 247.93865474413934, 229.47877550500476, 295.14074061973577, 113.11743359577154, 334.44392285897885, 265.65919170704797, 255.43262818760257, 288.7275690111177, 252.8856786180229, 288.9376374952424, 308.35830732772024, 57.02960091075248, 111.20440159366944], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 12, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.215132025799222, "mean_inference_ms": 1.2647206185624558, "mean_action_processing_ms": 0.21187326502747714, "mean_env_wait_ms": 561.417370296049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012240409851074219, "StateBufferConnector_ms": 0.006070137023925781, "ViewRequirementAgentConnector_ms": 0.15996456146240234}, "num_episodes": 14, "episode_return_max": 334.44392285897885, "episode_return_min": 57.02960091075248, "episode_return_mean": 248.3987763938896}, "episode_reward_max": 334.44392285897885, "episode_reward_min": 57.02960091075248, "episode_reward_mean": 248.3987763938896, "episode_len_mean": 45.5, "episodes_this_iter": 14, "episodes_timesteps_total": 910, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [285.51962330239263, 256.2533432749254, 223.075902853123, 294.7597645946321, 268.8258583222825, 294.71964724945377, 296.46684610617586, 247.93865474413934, 229.47877550500476, 295.14074061973577, 113.11743359577154, 334.44392285897885, 265.65919170704797, 255.43262818760257, 288.7275690111177, 252.8856786180229, 288.9376374952424, 308.35830732772024, 57.02960091075248, 111.20440159366944], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 12, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.215132025799222, "mean_inference_ms": 1.2647206185624558, "mean_action_processing_ms": 0.21187326502747714, "mean_env_wait_ms": 561.417370296049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012240409851074219, "StateBufferConnector_ms": 0.006070137023925781, "ViewRequirementAgentConnector_ms": 0.15996456146240234}, "num_episodes": 14, "episode_return_max": 334.44392285897885, "episode_return_min": 57.02960091075248, "episode_return_mean": 248.3987763938896, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17028, "num_agent_steps_trained": 17028, "num_env_steps_sampled": 17028, "num_env_steps_trained": 17028, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.687345938178566, "num_env_steps_trained_throughput_per_sec": 9.687345938178566, "timesteps_total": 17028, "num_env_steps_sampled_lifetime": 17028, "num_agent_steps_sampled_lifetime": 17028, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 17028, "timers": {"training_iteration_time_ms": 53507.726, "restore_workers_time_ms": 0.023, "training_step_time_ms": 53507.656, "sample_time_ms": 52430.314, "load_time_ms": 0.585, "load_throughput": 881752.236, "learn_time_ms": 1062.937, "learn_throughput": 485.447, "synch_weights_time_ms": 13.444}, "counters": {"num_env_steps_sampled": 17028, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 17028, "num_agent_steps_trained": 17028}, "done": false, "episodes_total": 620, "training_iteration": 33, "trial_id": "fe178_00000", "date": "2024-08-15_17-30-03", "timestamp": 1723764603, "time_this_iter_s": 53.2686243057251, "time_total_s": 2053.9407727718353, "pid": 17255, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 107.02152395248413, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.84605263157895, "ram_util_percent": 12.478947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.14361448486646, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 8.70306847890218, "policy_loss": -0.013642831969385346, "vf_loss": 8.715110194683074, "vf_explained_var": 0.2841245844960213, "kl": 0.006404144229358523, "entropy": 0.2237292361135284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17544, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 17544, "num_agent_steps_trained": 17544}, "sampler_results": {"episode_reward_max": 334.44392285897885, "episode_reward_min": 57.02960091075248, "episode_reward_mean": 244.66471415602572, "episode_len_mean": 45.38709677419355, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1407, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.51962330239263, 256.2533432749254, 223.075902853123, 294.7597645946321, 268.8258583222825, 294.71964724945377, 296.46684610617586, 247.93865474413934, 229.47877550500476, 295.14074061973577, 113.11743359577154, 334.44392285897885, 265.65919170704797, 255.43262818760257, 288.7275690111177, 252.8856786180229, 288.9376374952424, 308.35830732772024, 57.02960091075248, 111.20440159366944, 277.0529228937346, 278.33771771423363, 253.76909564676146, 273.1092840497338, 238.10324806575903, 114.20352616833645, 277.056996068332, 266.7314616116841, 88.5634795220711, 262.405122030589, 287.29775718777086], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 12, 27, 50, 50, 50, 50, 50, 23, 50, 50, 24, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.378712853027429, "mean_inference_ms": 1.2631785972482235, "mean_action_processing_ms": 0.21185156250310733, "mean_env_wait_ms": 561.9790101040459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01209320560578377, "StateBufferConnector_ms": 0.006074290121755292, "ViewRequirementAgentConnector_ms": 0.16471032173402847}, "num_episodes": 11, "episode_return_max": 334.44392285897885, "episode_return_min": 57.02960091075248, "episode_return_mean": 244.66471415602572}, "env_runner_results": {"episode_reward_max": 334.44392285897885, "episode_reward_min": 57.02960091075248, "episode_reward_mean": 244.66471415602572, "episode_len_mean": 45.38709677419355, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 1407, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.51962330239263, 256.2533432749254, 223.075902853123, 294.7597645946321, 268.8258583222825, 294.71964724945377, 296.46684610617586, 247.93865474413934, 229.47877550500476, 295.14074061973577, 113.11743359577154, 334.44392285897885, 265.65919170704797, 255.43262818760257, 288.7275690111177, 252.8856786180229, 288.9376374952424, 308.35830732772024, 57.02960091075248, 111.20440159366944, 277.0529228937346, 278.33771771423363, 253.76909564676146, 273.1092840497338, 238.10324806575903, 114.20352616833645, 277.056996068332, 266.7314616116841, 88.5634795220711, 262.405122030589, 287.29775718777086], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 12, 27, 50, 50, 50, 50, 50, 23, 50, 50, 24, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.378712853027429, "mean_inference_ms": 1.2631785972482235, "mean_action_processing_ms": 0.21185156250310733, "mean_env_wait_ms": 561.9790101040459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01209320560578377, "StateBufferConnector_ms": 0.006074290121755292, "ViewRequirementAgentConnector_ms": 0.16471032173402847}, "num_episodes": 11, "episode_return_max": 334.44392285897885, "episode_return_min": 57.02960091075248, "episode_return_mean": 244.66471415602572}, "episode_reward_max": 334.44392285897885, "episode_reward_min": 57.02960091075248, "episode_reward_mean": 244.66471415602572, "episode_len_mean": 45.38709677419355, "episodes_this_iter": 11, "episodes_timesteps_total": 1407, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [285.51962330239263, 256.2533432749254, 223.075902853123, 294.7597645946321, 268.8258583222825, 294.71964724945377, 296.46684610617586, 247.93865474413934, 229.47877550500476, 295.14074061973577, 113.11743359577154, 334.44392285897885, 265.65919170704797, 255.43262818760257, 288.7275690111177, 252.8856786180229, 288.9376374952424, 308.35830732772024, 57.02960091075248, 111.20440159366944, 277.0529228937346, 278.33771771423363, 253.76909564676146, 273.1092840497338, 238.10324806575903, 114.20352616833645, 277.056996068332, 266.7314616116841, 88.5634795220711, 262.405122030589, 287.29775718777086], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 21, 50, 50, 50, 50, 50, 50, 50, 12, 27, 50, 50, 50, 50, 50, 23, 50, 50, 24, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.378712853027429, "mean_inference_ms": 1.2631785972482235, "mean_action_processing_ms": 0.21185156250310733, "mean_env_wait_ms": 561.9790101040459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01209320560578377, "StateBufferConnector_ms": 0.006074290121755292, "ViewRequirementAgentConnector_ms": 0.16471032173402847}, "num_episodes": 11, "episode_return_max": 334.44392285897885, "episode_return_min": 57.02960091075248, "episode_return_mean": 244.66471415602572, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17544, "num_agent_steps_trained": 17544, "num_env_steps_sampled": 17544, "num_env_steps_trained": 17544, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.331855818112007, "num_env_steps_trained_throughput_per_sec": 9.331855818112007, "timesteps_total": 17544, "num_env_steps_sampled_lifetime": 17544, "num_agent_steps_sampled_lifetime": 17544, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 17544, "timers": {"training_iteration_time_ms": 54103.312, "restore_workers_time_ms": 0.024, "training_step_time_ms": 54103.243, "sample_time_ms": 53151.224, "load_time_ms": 0.5, "load_throughput": 1032403.02, "learn_time_ms": 937.851, "learn_throughput": 550.194, "synch_weights_time_ms": 13.33}, "counters": {"num_env_steps_sampled": 17544, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 17544, "num_agent_steps_trained": 17544}, "done": false, "episodes_total": 631, "training_iteration": 34, "trial_id": "fe178_00000", "date": "2024-08-15_17-30-58", "timestamp": 1723764658, "time_this_iter_s": 55.29785966873169, "time_total_s": 2109.238632440567, "pid": 17255, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.39490455655990103, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.5897112637403022, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 162.31938362121582, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 27.603797468354422, "ram_util_percent": 12.555696202531646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.213195766011873, "cur_kl_coeff": 0.5, "cur_lr": 5e-06, "total_loss": 9.19114581743876, "policy_loss": -0.013837222987785936, "vf_loss": 9.195067318280538, "vf_explained_var": 0.11138824522495269, "kl": 0.0198316879760882, "entropy": -0.18747684303671122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17028, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 17028, "num_agent_steps_trained": 17028}, "sampler_results": {"episode_reward_max": 320.4871798718041, "episode_reward_min": 103.84174691718708, "episode_reward_mean": 252.94126412824676, "episode_len_mean": 43.625, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 349, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.217461750425141, "mean_inference_ms": 1.2732733940256051, "mean_action_processing_ms": 0.21101928305351872, "mean_env_wait_ms": 535.4374499841667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009652972221374512, "StateBufferConnector_ms": 0.0063359737396240234, "ViewRequirementAgentConnector_ms": 0.17899274826049805}, "num_episodes": 8, "episode_return_max": 320.4871798718041, "episode_return_min": 103.84174691718708, "episode_return_mean": 252.94126412824676}, "env_runner_results": {"episode_reward_max": 320.4871798718041, "episode_reward_min": 103.84174691718708, "episode_reward_mean": 252.94126412824676, "episode_len_mean": 43.625, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 349, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.217461750425141, "mean_inference_ms": 1.2732733940256051, "mean_action_processing_ms": 0.21101928305351872, "mean_env_wait_ms": 535.4374499841667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009652972221374512, "StateBufferConnector_ms": 0.0063359737396240234, "ViewRequirementAgentConnector_ms": 0.17899274826049805}, "num_episodes": 8, "episode_return_max": 320.4871798718041, "episode_return_min": 103.84174691718708, "episode_return_mean": 252.94126412824676}, "episode_reward_max": 320.4871798718041, "episode_reward_min": 103.84174691718708, "episode_reward_mean": 252.94126412824676, "episode_len_mean": 43.625, "episodes_this_iter": 8, "episodes_timesteps_total": 349, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.217461750425141, "mean_inference_ms": 1.2732733940256051, "mean_action_processing_ms": 0.21101928305351872, "mean_env_wait_ms": 535.4374499841667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009652972221374512, "StateBufferConnector_ms": 0.0063359737396240234, "ViewRequirementAgentConnector_ms": 0.17899274826049805}, "num_episodes": 8, "episode_return_max": 320.4871798718041, "episode_return_min": 103.84174691718708, "episode_return_mean": 252.94126412824676, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17028, "num_agent_steps_trained": 17028, "num_env_steps_sampled": 17028, "num_env_steps_trained": 17028, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.672760453561315, "num_env_steps_trained_throughput_per_sec": 9.672760453561315, "timesteps_total": 17028, "num_env_steps_sampled_lifetime": 17028, "num_agent_steps_sampled_lifetime": 17028, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 17028, "timers": {"training_iteration_time_ms": 53345.693, "restore_workers_time_ms": 0.018, "training_step_time_ms": 53345.635, "sample_time_ms": 49851.4, "load_time_ms": 0.721, "load_throughput": 716168.386, "learn_time_ms": 3480.7, "learn_throughput": 148.246, "synch_weights_time_ms": 12.383}, "counters": {"num_env_steps_sampled": 17028, "num_env_steps_trained": 17028, "num_agent_steps_sampled": 17028, "num_agent_steps_trained": 17028}, "done": false, "episodes_total": 610, "training_iteration": 33, "trial_id": "fe178_00000", "date": "2024-08-15_17-32-10", "timestamp": 1723764730, "time_this_iter_s": 53.3487503528595, "time_total_s": 2014.9153616428375, "pid": 40829, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12800000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.6080000000000001, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 53.3487503528595, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.458441558441557, "ram_util_percent": 11.372727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.990555481115978, "cur_kl_coeff": 0.5, "cur_lr": 5e-06, "total_loss": 9.17012554804484, "policy_loss": -0.017760141985490918, "vf_loss": 9.18376665910085, "vf_explained_var": 0.15246408184369406, "kl": 0.008238011486842998, "entropy": -0.19873632558931906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17544, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 17544, "num_agent_steps_trained": 17544}, "sampler_results": {"episode_reward_max": 327.3198601578052, "episode_reward_min": 103.84174691718708, "episode_reward_mean": 278.0629640119628, "episode_len_mean": 47.31578947368421, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 899, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.329236386174284, "mean_inference_ms": 1.2663631504839563, "mean_action_processing_ms": 0.21049099181871933, "mean_env_wait_ms": 526.8544548359513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011120344463147615, "StateBufferConnector_ms": 0.006206412064401727, "ViewRequirementAgentConnector_ms": 0.1753242392289011}, "num_episodes": 11, "episode_return_max": 327.3198601578052, "episode_return_min": 103.84174691718708, "episode_return_mean": 278.0629640119628}, "env_runner_results": {"episode_reward_max": 327.3198601578052, "episode_reward_min": 103.84174691718708, "episode_reward_mean": 278.0629640119628, "episode_len_mean": 47.31578947368421, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 899, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.329236386174284, "mean_inference_ms": 1.2663631504839563, "mean_action_processing_ms": 0.21049099181871933, "mean_env_wait_ms": 526.8544548359513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011120344463147615, "StateBufferConnector_ms": 0.006206412064401727, "ViewRequirementAgentConnector_ms": 0.1753242392289011}, "num_episodes": 11, "episode_return_max": 327.3198601578052, "episode_return_min": 103.84174691718708, "episode_return_mean": 278.0629640119628}, "episode_reward_max": 327.3198601578052, "episode_reward_min": 103.84174691718708, "episode_reward_mean": 278.0629640119628, "episode_len_mean": 47.31578947368421, "episodes_this_iter": 11, "episodes_timesteps_total": 899, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.329236386174284, "mean_inference_ms": 1.2663631504839563, "mean_action_processing_ms": 0.21049099181871933, "mean_env_wait_ms": 526.8544548359513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011120344463147615, "StateBufferConnector_ms": 0.006206412064401727, "ViewRequirementAgentConnector_ms": 0.1753242392289011}, "num_episodes": 11, "episode_return_max": 327.3198601578052, "episode_return_min": 103.84174691718708, "episode_return_mean": 278.0629640119628, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17544, "num_agent_steps_trained": 17544, "num_env_steps_sampled": 17544, "num_env_steps_trained": 17544, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.757542697015671, "num_env_steps_trained_throughput_per_sec": 10.757542697015671, "timesteps_total": 17544, "num_env_steps_sampled_lifetime": 17544, "num_agent_steps_sampled_lifetime": 17544, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 17544, "timers": {"training_iteration_time_ms": 50656.024, "restore_workers_time_ms": 0.017, "training_step_time_ms": 50655.968, "sample_time_ms": 48579.389, "load_time_ms": 0.523, "load_throughput": 985995.838, "learn_time_ms": 2062.833, "learn_throughput": 250.141, "synch_weights_time_ms": 12.859}, "counters": {"num_env_steps_sampled": 17544, "num_env_steps_trained": 17544, "num_agent_steps_sampled": 17544, "num_agent_steps_trained": 17544}, "done": false, "episodes_total": 621, "training_iteration": 34, "trial_id": "fe178_00000", "date": "2024-08-15_17-32-58", "timestamp": 1723764778, "time_this_iter_s": 47.96923065185547, "time_total_s": 2062.884592294693, "pid": 40829, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12800000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.6080000000000001, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 101.31798100471497, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.83823529411765, "ram_util_percent": 11.470588235294114}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.661357007424037, "cur_kl_coeff": 0.5, "cur_lr": 5e-06, "total_loss": 8.784005498886108, "policy_loss": -0.011372272949665784, "vf_loss": 8.792211822668712, "vf_explained_var": 0.2300425817569097, "kl": 0.0063319216948016805, "entropy": -0.18533041731764874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18060, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 18060, "num_agent_steps_trained": 18060}, "sampler_results": {"episode_reward_max": 327.3198601578052, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 274.7281678714941, "episode_len_mean": 47.16129032258065, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1462, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.481448677012718, "mean_inference_ms": 1.2641736019847736, "mean_action_processing_ms": 0.20997009210943837, "mean_env_wait_ms": 534.8727974991342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011667897624354209, "StateBufferConnector_ms": 0.006183501212827621, "ViewRequirementAgentConnector_ms": 0.17405171548166581}, "num_episodes": 12, "episode_return_max": 327.3198601578052, "episode_return_min": 59.948700569592575, "episode_return_mean": 274.7281678714941}, "env_runner_results": {"episode_reward_max": 327.3198601578052, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 274.7281678714941, "episode_len_mean": 47.16129032258065, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1462, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.481448677012718, "mean_inference_ms": 1.2641736019847736, "mean_action_processing_ms": 0.20997009210943837, "mean_env_wait_ms": 534.8727974991342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011667897624354209, "StateBufferConnector_ms": 0.006183501212827621, "ViewRequirementAgentConnector_ms": 0.17405171548166581}, "num_episodes": 12, "episode_return_max": 327.3198601578052, "episode_return_min": 59.948700569592575, "episode_return_mean": 274.7281678714941}, "episode_reward_max": 327.3198601578052, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 274.7281678714941, "episode_len_mean": 47.16129032258065, "episodes_this_iter": 12, "episodes_timesteps_total": 1462, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.481448677012718, "mean_inference_ms": 1.2641736019847736, "mean_action_processing_ms": 0.20997009210943837, "mean_env_wait_ms": 534.8727974991342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011667897624354209, "StateBufferConnector_ms": 0.006183501212827621, "ViewRequirementAgentConnector_ms": 0.17405171548166581}, "num_episodes": 12, "episode_return_max": 327.3198601578052, "episode_return_min": 59.948700569592575, "episode_return_mean": 274.7281678714941, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18060, "num_agent_steps_trained": 18060, "num_env_steps_sampled": 18060, "num_env_steps_trained": 18060, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.196815365240855, "num_env_steps_trained_throughput_per_sec": 9.196815365240855, "timesteps_total": 18060, "num_env_steps_sampled_lifetime": 18060, "num_agent_steps_sampled_lifetime": 18060, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 18060, "timers": {"training_iteration_time_ms": 52472.813, "restore_workers_time_ms": 0.017, "training_step_time_ms": 52472.759, "sample_time_ms": 50878.543, "load_time_ms": 0.447, "load_throughput": 1155504.999, "learn_time_ms": 1580.553, "learn_throughput": 326.468, "synch_weights_time_ms": 12.901}, "counters": {"num_env_steps_sampled": 18060, "num_env_steps_trained": 18060, "num_agent_steps_sampled": 18060, "num_agent_steps_trained": 18060}, "done": false, "episodes_total": 633, "training_iteration": 35, "trial_id": "fe178_00000", "date": "2024-08-15_17-33-54", "timestamp": 1723764834, "time_this_iter_s": 56.10981559753418, "time_total_s": 2118.994407892227, "pid": 40829, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12800000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.6080000000000001, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 157.42779660224915, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.98125, "ram_util_percent": 12.3175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.94446630080541, "cur_kl_coeff": 0.5, "cur_lr": 5e-06, "total_loss": 9.131837598482768, "policy_loss": -0.029209061587850253, "vf_loss": 9.154796592394511, "vf_explained_var": 0.2845196361343066, "kl": 0.012500193826177283, "entropy": -0.22194995621684938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18576, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 18576, "num_agent_steps_trained": 18576}, "sampler_results": {"episode_reward_max": 339.44085766903333, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 282.9402294175963, "episode_len_mean": 47.743589743589745, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 1862, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.502254327414426, "mean_inference_ms": 1.2632966828295458, "mean_action_processing_ms": 0.2097299126117617, "mean_env_wait_ms": 540.6540083677369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012111052488669371, "StateBufferConnector_ms": 0.0062270042223808095, "ViewRequirementAgentConnector_ms": 0.17405289870042068}, "num_episodes": 8, "episode_return_max": 339.44085766903333, "episode_return_min": 59.948700569592575, "episode_return_mean": 282.9402294175963}, "env_runner_results": {"episode_reward_max": 339.44085766903333, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 282.9402294175963, "episode_len_mean": 47.743589743589745, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 1862, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.502254327414426, "mean_inference_ms": 1.2632966828295458, "mean_action_processing_ms": 0.2097299126117617, "mean_env_wait_ms": 540.6540083677369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012111052488669371, "StateBufferConnector_ms": 0.0062270042223808095, "ViewRequirementAgentConnector_ms": 0.17405289870042068}, "num_episodes": 8, "episode_return_max": 339.44085766903333, "episode_return_min": 59.948700569592575, "episode_return_mean": 282.9402294175963}, "episode_reward_max": 339.44085766903333, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 282.9402294175963, "episode_len_mean": 47.743589743589745, "episodes_this_iter": 8, "episodes_timesteps_total": 1862, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.502254327414426, "mean_inference_ms": 1.2632966828295458, "mean_action_processing_ms": 0.2097299126117617, "mean_env_wait_ms": 540.6540083677369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012111052488669371, "StateBufferConnector_ms": 0.0062270042223808095, "ViewRequirementAgentConnector_ms": 0.17405289870042068}, "num_episodes": 8, "episode_return_max": 339.44085766903333, "episode_return_min": 59.948700569592575, "episode_return_mean": 282.9402294175963, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18576, "num_agent_steps_trained": 18576, "num_env_steps_sampled": 18576, "num_env_steps_trained": 18576, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.047769991636713, "num_env_steps_trained_throughput_per_sec": 9.047769991636713, "timesteps_total": 18576, "num_env_steps_sampled_lifetime": 18576, "num_agent_steps_sampled_lifetime": 18576, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 18576, "timers": {"training_iteration_time_ms": 53612.269, "restore_workers_time_ms": 0.019, "training_step_time_ms": 53612.213, "sample_time_ms": 52251.091, "load_time_ms": 0.408, "load_throughput": 1263433.079, "learn_time_ms": 1347.432, "learn_throughput": 382.951, "synch_weights_time_ms": 12.971}, "counters": {"num_env_steps_sampled": 18576, "num_env_steps_trained": 18576, "num_agent_steps_sampled": 18576, "num_agent_steps_trained": 18576}, "done": false, "episodes_total": 641, "training_iteration": 36, "trial_id": "fe178_00000", "date": "2024-08-15_17-34-51", "timestamp": 1723764891, "time_this_iter_s": 57.033759117126465, "time_total_s": 2176.0281670093536, "pid": 40829, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12800000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.6080000000000001, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 214.4615557193756, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.358024691358025, "ram_util_percent": 12.409876543209878}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.63902290860812, "cur_kl_coeff": 0.5, "cur_lr": 5e-06, "total_loss": 9.065956830978394, "policy_loss": -0.013598430808633566, "vf_loss": 9.07612771987915, "vf_explained_var": 0.3438453401128451, "kl": 0.006854752304208895, "entropy": -0.28906489655685924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19092, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 19092, "num_agent_steps_trained": 19092}, "sampler_results": {"episode_reward_max": 339.44085766903333, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 282.1109760126072, "episode_len_mean": 47.76470588235294, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2436, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.531160879127213, "mean_inference_ms": 1.2619384799793003, "mean_action_processing_ms": 0.2096300756219966, "mean_env_wait_ms": 541.1044352424224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012352419834510953, "StateBufferConnector_ms": 0.006225062351600796, "ViewRequirementAgentConnector_ms": 0.17352898915608725}, "num_episodes": 12, "episode_return_max": 339.44085766903333, "episode_return_min": 59.948700569592575, "episode_return_mean": 282.1109760126072}, "env_runner_results": {"episode_reward_max": 339.44085766903333, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 282.1109760126072, "episode_len_mean": 47.76470588235294, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2436, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.531160879127213, "mean_inference_ms": 1.2619384799793003, "mean_action_processing_ms": 0.2096300756219966, "mean_env_wait_ms": 541.1044352424224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012352419834510953, "StateBufferConnector_ms": 0.006225062351600796, "ViewRequirementAgentConnector_ms": 0.17352898915608725}, "num_episodes": 12, "episode_return_max": 339.44085766903333, "episode_return_min": 59.948700569592575, "episode_return_mean": 282.1109760126072}, "episode_reward_max": 339.44085766903333, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 282.1109760126072, "episode_len_mean": 47.76470588235294, "episodes_this_iter": 12, "episodes_timesteps_total": 2436, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.531160879127213, "mean_inference_ms": 1.2619384799793003, "mean_action_processing_ms": 0.2096300756219966, "mean_env_wait_ms": 541.1044352424224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012352419834510953, "StateBufferConnector_ms": 0.006225062351600796, "ViewRequirementAgentConnector_ms": 0.17352898915608725}, "num_episodes": 12, "episode_return_max": 339.44085766903333, "episode_return_min": 59.948700569592575, "episode_return_mean": 282.1109760126072, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19092, "num_agent_steps_trained": 19092, "num_env_steps_sampled": 19092, "num_env_steps_trained": 19092, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.662103242236903, "num_env_steps_trained_throughput_per_sec": 9.662103242236903, "timesteps_total": 19092, "num_env_steps_sampled_lifetime": 19092, "num_agent_steps_sampled_lifetime": 19092, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 19092, "timers": {"training_iteration_time_ms": 53570.722, "restore_workers_time_ms": 0.019, "training_step_time_ms": 53570.668, "sample_time_ms": 52362.856, "load_time_ms": 0.384, "load_throughput": 1343426.98, "learn_time_ms": 1194.183, "learn_throughput": 432.095, "synch_weights_time_ms": 12.943}, "counters": {"num_env_steps_sampled": 19092, "num_env_steps_trained": 19092, "num_agent_steps_sampled": 19092, "num_agent_steps_trained": 19092}, "done": false, "episodes_total": 653, "training_iteration": 37, "trial_id": "fe178_00000", "date": "2024-08-15_17-35-45", "timestamp": 1723764945, "time_this_iter_s": 53.40804934501648, "time_total_s": 2229.43621635437, "pid": 40829, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12800000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.6080000000000001, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 267.8696050643921, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.158441558441556, "ram_util_percent": 12.185714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.220576937993368, "cur_kl_coeff": 0.5, "cur_lr": 5e-06, "total_loss": 9.109060780207317, "policy_loss": -0.0194241480048125, "vf_loss": 9.125279132525126, "vf_explained_var": 0.18454603453477222, "kl": 0.006411625286276527, "entropy": -0.34370763301849366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19608, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 19608, "num_agent_steps_trained": 19608}, "sampler_results": {"episode_reward_max": 352.65557855825125, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 282.01103674120185, "episode_len_mean": 47.58064516129032, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2950, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554, 328.77612633919506, 319.3626492297898, 323.2115448544439, 279.1574683018925, 272.18981180008194, 352.65557855825125, 331.0678479612107, 269.3598697856255, 60.46338345401688, 296.851948440264, 263.92827258677414], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.562769821926238, "mean_inference_ms": 1.2608038517726807, "mean_action_processing_ms": 0.2095666171160687, "mean_env_wait_ms": 543.6574900826919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012385845184326172, "StateBufferConnector_ms": 0.006250027687318863, "ViewRequirementAgentConnector_ms": 0.1738263714698053}, "num_episodes": 11, "episode_return_max": 352.65557855825125, "episode_return_min": 59.948700569592575, "episode_return_mean": 282.01103674120185}, "env_runner_results": {"episode_reward_max": 352.65557855825125, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 282.01103674120185, "episode_len_mean": 47.58064516129032, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2950, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554, 328.77612633919506, 319.3626492297898, 323.2115448544439, 279.1574683018925, 272.18981180008194, 352.65557855825125, 331.0678479612107, 269.3598697856255, 60.46338345401688, 296.851948440264, 263.92827258677414], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.562769821926238, "mean_inference_ms": 1.2608038517726807, "mean_action_processing_ms": 0.2095666171160687, "mean_env_wait_ms": 543.6574900826919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012385845184326172, "StateBufferConnector_ms": 0.006250027687318863, "ViewRequirementAgentConnector_ms": 0.1738263714698053}, "num_episodes": 11, "episode_return_max": 352.65557855825125, "episode_return_min": 59.948700569592575, "episode_return_mean": 282.01103674120185}, "episode_reward_max": 352.65557855825125, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 282.01103674120185, "episode_len_mean": 47.58064516129032, "episodes_this_iter": 11, "episodes_timesteps_total": 2950, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554, 328.77612633919506, 319.3626492297898, 323.2115448544439, 279.1574683018925, 272.18981180008194, 352.65557855825125, 331.0678479612107, 269.3598697856255, 60.46338345401688, 296.851948440264, 263.92827258677414], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.562769821926238, "mean_inference_ms": 1.2608038517726807, "mean_action_processing_ms": 0.2095666171160687, "mean_env_wait_ms": 543.6574900826919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012385845184326172, "StateBufferConnector_ms": 0.006250027687318863, "ViewRequirementAgentConnector_ms": 0.1738263714698053}, "num_episodes": 11, "episode_return_max": 352.65557855825125, "episode_return_min": 59.948700569592575, "episode_return_mean": 282.01103674120185, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19608, "num_agent_steps_trained": 19608, "num_env_steps_sampled": 19608, "num_env_steps_trained": 19608, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.071683891364456, "num_env_steps_trained_throughput_per_sec": 9.071683891364456, "timesteps_total": 19608, "num_env_steps_sampled_lifetime": 19608, "num_agent_steps_sampled_lifetime": 19608, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 19608, "timers": {"training_iteration_time_ms": 54122.318, "restore_workers_time_ms": 0.018, "training_step_time_ms": 54122.266, "sample_time_ms": 53005.636, "load_time_ms": 0.374, "load_throughput": 1378071.228, "learn_time_ms": 1103.073, "learn_throughput": 467.784, "synch_weights_time_ms": 12.891}, "counters": {"num_env_steps_sampled": 19608, "num_env_steps_trained": 19608, "num_agent_steps_sampled": 19608, "num_agent_steps_trained": 19608}, "done": false, "episodes_total": 664, "training_iteration": 38, "trial_id": "fe178_00000", "date": "2024-08-15_17-36-42", "timestamp": 1723765002, "time_this_iter_s": 56.88385725021362, "time_total_s": 2286.3200736045837, "pid": 40829, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12800000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.6080000000000001, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 324.7534623146057, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 27.58765432098766, "ram_util_percent": 12.040740740740743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.043312354882557, "cur_kl_coeff": 0.5, "cur_lr": 5e-06, "total_loss": 8.885981210072835, "policy_loss": -0.01812452174878369, "vf_loss": 8.900747895240784, "vf_explained_var": 0.17271385540564854, "kl": 0.006715768236163577, "entropy": -0.3461220438281695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20124, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 20124, "num_agent_steps_trained": 20124}, "sampler_results": {"episode_reward_max": 352.65557855825125, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 277.86417142169773, "episode_len_mean": 46.86486486486486, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3468, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554, 328.77612633919506, 319.3626492297898, 323.2115448544439, 279.1574683018925, 272.18981180008194, 352.65557855825125, 331.0678479612107, 269.3598697856255, 60.46338345401688, 296.851948440264, 263.92827258677414, 290.28311064912003, 305.1755115113525, 300.71278026948, 97.87965539639967, 290.91583832123723, 318.4612432492238, 132.6628212681942, 105.60340036306415, 302.1573802423016, 293.25965055293096, 301.8320625443791, 338.32095288343675], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 50, 50, 21, 50, 50, 25, 22, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5967136630712755, "mean_inference_ms": 1.2599406655638354, "mean_action_processing_ms": 0.20942888647856245, "mean_env_wait_ms": 546.3668879933253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01217416814855627, "StateBufferConnector_ms": 0.0062546214541873415, "ViewRequirementAgentConnector_ms": 0.1742214769930453}, "num_episodes": 12, "episode_return_max": 352.65557855825125, "episode_return_min": 59.948700569592575, "episode_return_mean": 277.86417142169773}, "env_runner_results": {"episode_reward_max": 352.65557855825125, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 277.86417142169773, "episode_len_mean": 46.86486486486486, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3468, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554, 328.77612633919506, 319.3626492297898, 323.2115448544439, 279.1574683018925, 272.18981180008194, 352.65557855825125, 331.0678479612107, 269.3598697856255, 60.46338345401688, 296.851948440264, 263.92827258677414, 290.28311064912003, 305.1755115113525, 300.71278026948, 97.87965539639967, 290.91583832123723, 318.4612432492238, 132.6628212681942, 105.60340036306415, 302.1573802423016, 293.25965055293096, 301.8320625443791, 338.32095288343675], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 50, 50, 21, 50, 50, 25, 22, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5967136630712755, "mean_inference_ms": 1.2599406655638354, "mean_action_processing_ms": 0.20942888647856245, "mean_env_wait_ms": 546.3668879933253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01217416814855627, "StateBufferConnector_ms": 0.0062546214541873415, "ViewRequirementAgentConnector_ms": 0.1742214769930453}, "num_episodes": 12, "episode_return_max": 352.65557855825125, "episode_return_min": 59.948700569592575, "episode_return_mean": 277.86417142169773}, "episode_reward_max": 352.65557855825125, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 277.86417142169773, "episode_len_mean": 46.86486486486486, "episodes_this_iter": 12, "episodes_timesteps_total": 3468, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554, 328.77612633919506, 319.3626492297898, 323.2115448544439, 279.1574683018925, 272.18981180008194, 352.65557855825125, 331.0678479612107, 269.3598697856255, 60.46338345401688, 296.851948440264, 263.92827258677414, 290.28311064912003, 305.1755115113525, 300.71278026948, 97.87965539639967, 290.91583832123723, 318.4612432492238, 132.6628212681942, 105.60340036306415, 302.1573802423016, 293.25965055293096, 301.8320625443791, 338.32095288343675], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 50, 50, 21, 50, 50, 25, 22, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5967136630712755, "mean_inference_ms": 1.2599406655638354, "mean_action_processing_ms": 0.20942888647856245, "mean_env_wait_ms": 546.3668879933253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01217416814855627, "StateBufferConnector_ms": 0.0062546214541873415, "ViewRequirementAgentConnector_ms": 0.1742214769930453}, "num_episodes": 12, "episode_return_max": 352.65557855825125, "episode_return_min": 59.948700569592575, "episode_return_mean": 277.86417142169773, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20124, "num_agent_steps_trained": 20124, "num_env_steps_sampled": 20124, "num_env_steps_trained": 20124, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.111308055548974, "num_env_steps_trained_throughput_per_sec": 9.111308055548974, "timesteps_total": 20124, "num_env_steps_sampled_lifetime": 20124, "num_agent_steps_sampled_lifetime": 20124, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 20124, "timers": {"training_iteration_time_ms": 54480.977, "restore_workers_time_ms": 0.018, "training_step_time_ms": 54480.926, "sample_time_ms": 53429.08, "load_time_ms": 0.365, "load_throughput": 1415210.28, "learn_time_ms": 1038.349, "learn_throughput": 496.943, "synch_weights_time_ms": 12.854}, "counters": {"num_env_steps_sampled": 20124, "num_env_steps_trained": 20124, "num_agent_steps_sampled": 20124, "num_agent_steps_trained": 20124}, "done": false, "episodes_total": 676, "training_iteration": 39, "trial_id": "fe178_00000", "date": "2024-08-15_17-37-38", "timestamp": 1723765058, "time_this_iter_s": 56.636494159698486, "time_total_s": 2342.956567764282, "pid": 40829, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12800000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.6080000000000001, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 381.3899564743042, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 27.63086419753086, "ram_util_percent": 12.482716049382717}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.595278495550156, "cur_kl_coeff": 0.5, "cur_lr": 5e-06, "total_loss": 8.833148845036824, "policy_loss": -0.01676541476820906, "vf_loss": 8.84733999967575, "vf_explained_var": 0.2217534532149633, "kl": 0.005148463260656144, "entropy": -0.287748598800196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20640, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 20640, "num_agent_steps_trained": 20640}, "sampler_results": {"episode_reward_max": 352.65557855825125, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 277.71965921083955, "episode_len_mean": 46.976470588235294, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3993, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554, 328.77612633919506, 319.3626492297898, 323.2115448544439, 279.1574683018925, 272.18981180008194, 352.65557855825125, 331.0678479612107, 269.3598697856255, 60.46338345401688, 296.851948440264, 263.92827258677414, 290.28311064912003, 305.1755115113525, 300.71278026948, 97.87965539639967, 290.91583832123723, 318.4612432492238, 132.6628212681942, 105.60340036306415, 302.1573802423016, 293.25965055293096, 301.8320625443791, 338.32095288343675, 260.66368280572544, 306.173965321606, 320.94809471810623, 257.3138085541176, 325.5435221320261, 295.07841993829373, 139.87977957550916, 325.64598891099484, 313.6259906829063, 267.92680588380097, 231.42228919264323], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 50, 50, 21, 50, 50, 25, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6200001868891665, "mean_inference_ms": 1.2594959907535124, "mean_action_processing_ms": 0.2094745738253051, "mean_env_wait_ms": 548.2795049809472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011897648082059972, "StateBufferConnector_ms": 0.0062662012436810665, "ViewRequirementAgentConnector_ms": 0.1746101940379423}, "num_episodes": 11, "episode_return_max": 352.65557855825125, "episode_return_min": 59.948700569592575, "episode_return_mean": 277.71965921083955}, "env_runner_results": {"episode_reward_max": 352.65557855825125, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 277.71965921083955, "episode_len_mean": 46.976470588235294, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 3993, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554, 328.77612633919506, 319.3626492297898, 323.2115448544439, 279.1574683018925, 272.18981180008194, 352.65557855825125, 331.0678479612107, 269.3598697856255, 60.46338345401688, 296.851948440264, 263.92827258677414, 290.28311064912003, 305.1755115113525, 300.71278026948, 97.87965539639967, 290.91583832123723, 318.4612432492238, 132.6628212681942, 105.60340036306415, 302.1573802423016, 293.25965055293096, 301.8320625443791, 338.32095288343675, 260.66368280572544, 306.173965321606, 320.94809471810623, 257.3138085541176, 325.5435221320261, 295.07841993829373, 139.87977957550916, 325.64598891099484, 313.6259906829063, 267.92680588380097, 231.42228919264323], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 50, 50, 21, 50, 50, 25, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6200001868891665, "mean_inference_ms": 1.2594959907535124, "mean_action_processing_ms": 0.2094745738253051, "mean_env_wait_ms": 548.2795049809472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011897648082059972, "StateBufferConnector_ms": 0.0062662012436810665, "ViewRequirementAgentConnector_ms": 0.1746101940379423}, "num_episodes": 11, "episode_return_max": 352.65557855825125, "episode_return_min": 59.948700569592575, "episode_return_mean": 277.71965921083955}, "episode_reward_max": 352.65557855825125, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 277.71965921083955, "episode_len_mean": 46.976470588235294, "episodes_this_iter": 11, "episodes_timesteps_total": 3993, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554, 328.77612633919506, 319.3626492297898, 323.2115448544439, 279.1574683018925, 272.18981180008194, 352.65557855825125, 331.0678479612107, 269.3598697856255, 60.46338345401688, 296.851948440264, 263.92827258677414, 290.28311064912003, 305.1755115113525, 300.71278026948, 97.87965539639967, 290.91583832123723, 318.4612432492238, 132.6628212681942, 105.60340036306415, 302.1573802423016, 293.25965055293096, 301.8320625443791, 338.32095288343675, 260.66368280572544, 306.173965321606, 320.94809471810623, 257.3138085541176, 325.5435221320261, 295.07841993829373, 139.87977957550916, 325.64598891099484, 313.6259906829063, 267.92680588380097, 231.42228919264323], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 50, 50, 21, 50, 50, 25, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6200001868891665, "mean_inference_ms": 1.2594959907535124, "mean_action_processing_ms": 0.2094745738253051, "mean_env_wait_ms": 548.2795049809472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011897648082059972, "StateBufferConnector_ms": 0.0062662012436810665, "ViewRequirementAgentConnector_ms": 0.1746101940379423}, "num_episodes": 11, "episode_return_max": 352.65557855825125, "episode_return_min": 59.948700569592575, "episode_return_mean": 277.71965921083955, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20640, "num_agent_steps_trained": 20640, "num_env_steps_sampled": 20640, "num_env_steps_trained": 20640, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.955511748537957, "num_env_steps_trained_throughput_per_sec": 8.955511748537957, "timesteps_total": 20640, "num_env_steps_sampled_lifetime": 20640, "num_agent_steps_sampled_lifetime": 20640, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 20640, "timers": {"training_iteration_time_ms": 54873.126, "restore_workers_time_ms": 0.018, "training_step_time_ms": 54873.073, "sample_time_ms": 53868.344, "load_time_ms": 0.363, "load_throughput": 1421634.528, "learn_time_ms": 991.216, "learn_throughput": 520.573, "synch_weights_time_ms": 12.874}, "counters": {"num_env_steps_sampled": 20640, "num_env_steps_trained": 20640, "num_agent_steps_sampled": 20640, "num_agent_steps_trained": 20640}, "done": false, "episodes_total": 687, "training_iteration": 40, "trial_id": "fe178_00000", "date": "2024-08-15_17-38-36", "timestamp": 1723765116, "time_this_iter_s": 57.621508836746216, "time_total_s": 2400.5780766010284, "pid": 40829, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12800000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.6080000000000001, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 439.0114653110504, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 27.249999999999993, "ram_util_percent": 12.575609756097558}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.747042312224705, "cur_kl_coeff": 0.5, "cur_lr": 5e-06, "total_loss": 9.193922670682271, "policy_loss": -0.01166307603319486, "vf_loss": 9.202901315689086, "vf_explained_var": 0.12037299126386643, "kl": 0.005368864049283221, "entropy": -0.4159473981708288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 21156, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 21156, "num_agent_steps_trained": 21156}, "sampler_results": {"episode_reward_max": 353.4027184457852, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 276.8488264784135, "episode_len_mean": 46.744897959183675, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 4581, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554, 328.77612633919506, 319.3626492297898, 323.2115448544439, 279.1574683018925, 272.18981180008194, 352.65557855825125, 331.0678479612107, 269.3598697856255, 60.46338345401688, 296.851948440264, 263.92827258677414, 290.28311064912003, 305.1755115113525, 300.71278026948, 97.87965539639967, 290.91583832123723, 318.4612432492238, 132.6628212681942, 105.60340036306415, 302.1573802423016, 293.25965055293096, 301.8320625443791, 338.32095288343675, 260.66368280572544, 306.173965321606, 320.94809471810623, 257.3138085541176, 325.5435221320261, 295.07841993829373, 139.87977957550916, 325.64598891099484, 313.6259906829063, 267.92680588380097, 231.42228919264323, 323.17383980786747, 273.216646370405, 344.97471895095066, 322.38597912955123, 306.61865227126435, 253.37946096333525, 301.7490667131787, 283.40553953161606, 295.60707821123253, 91.55886308471837, 300.9052354530768, 353.4027184457852, 74.6361630301846], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 50, 50, 21, 50, 50, 25, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.652788191605854, "mean_inference_ms": 1.2591356195788026, "mean_action_processing_ms": 0.20945468594206176, "mean_env_wait_ms": 548.9140234804265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011677401406424386, "StateBufferConnector_ms": 0.006246810056725327, "ViewRequirementAgentConnector_ms": 0.17437083380562918}, "num_episodes": 13, "episode_return_max": 353.4027184457852, "episode_return_min": 59.948700569592575, "episode_return_mean": 276.8488264784135}, "env_runner_results": {"episode_reward_max": 353.4027184457852, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 276.8488264784135, "episode_len_mean": 46.744897959183675, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 4581, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554, 328.77612633919506, 319.3626492297898, 323.2115448544439, 279.1574683018925, 272.18981180008194, 352.65557855825125, 331.0678479612107, 269.3598697856255, 60.46338345401688, 296.851948440264, 263.92827258677414, 290.28311064912003, 305.1755115113525, 300.71278026948, 97.87965539639967, 290.91583832123723, 318.4612432492238, 132.6628212681942, 105.60340036306415, 302.1573802423016, 293.25965055293096, 301.8320625443791, 338.32095288343675, 260.66368280572544, 306.173965321606, 320.94809471810623, 257.3138085541176, 325.5435221320261, 295.07841993829373, 139.87977957550916, 325.64598891099484, 313.6259906829063, 267.92680588380097, 231.42228919264323, 323.17383980786747, 273.216646370405, 344.97471895095066, 322.38597912955123, 306.61865227126435, 253.37946096333525, 301.7490667131787, 283.40553953161606, 295.60707821123253, 91.55886308471837, 300.9052354530768, 353.4027184457852, 74.6361630301846], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 50, 50, 21, 50, 50, 25, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.652788191605854, "mean_inference_ms": 1.2591356195788026, "mean_action_processing_ms": 0.20945468594206176, "mean_env_wait_ms": 548.9140234804265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011677401406424386, "StateBufferConnector_ms": 0.006246810056725327, "ViewRequirementAgentConnector_ms": 0.17437083380562918}, "num_episodes": 13, "episode_return_max": 353.4027184457852, "episode_return_min": 59.948700569592575, "episode_return_mean": 276.8488264784135}, "episode_reward_max": 353.4027184457852, "episode_reward_min": 59.948700569592575, "episode_reward_mean": 276.8488264784135, "episode_len_mean": 46.744897959183675, "episodes_this_iter": 13, "episodes_timesteps_total": 4581, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [279.0740547140553, 103.84174691718708, 295.8636708076905, 307.7760493699564, 320.4871798718041, 251.41344488610468, 313.7042624021691, 151.36970405700677, 291.61683748519226, 314.5718283052982, 297.82025022256073, 327.3198601578052, 295.37329983539536, 312.37236249634867, 278.59009323281276, 240.42381755039253, 295.09303492457076, 300.13439164926956, 306.35042734167246, 316.99188805440104, 310.0714953828274, 286.10397979290286, 302.92071728338607, 293.4232885118497, 324.67713982555335, 267.8548951971606, 323.764840260769, 220.93476991748133, 243.20047158089255, 59.948700569592575, 283.4847014122091, 281.26355649617796, 328.5059965039644, 313.94325125566877, 339.44085766903333, 323.87786158788055, 321.4310268248301, 337.4854555896213, 272.1477373427646, 272.89082436009835, 324.04652436948436, 330.65576427179775, 306.119854135215, 298.5643008103523, 282.67934241890686, 120.87453712677979, 229.64684832208638, 274.96076698791364, 270.6330750914114, 314.61091859691584, 327.30807286574554, 328.77612633919506, 319.3626492297898, 323.2115448544439, 279.1574683018925, 272.18981180008194, 352.65557855825125, 331.0678479612107, 269.3598697856255, 60.46338345401688, 296.851948440264, 263.92827258677414, 290.28311064912003, 305.1755115113525, 300.71278026948, 97.87965539639967, 290.91583832123723, 318.4612432492238, 132.6628212681942, 105.60340036306415, 302.1573802423016, 293.25965055293096, 301.8320625443791, 338.32095288343675, 260.66368280572544, 306.173965321606, 320.94809471810623, 257.3138085541176, 325.5435221320261, 295.07841993829373, 139.87977957550916, 325.64598891099484, 313.6259906829063, 267.92680588380097, 231.42228919264323, 323.17383980786747, 273.216646370405, 344.97471895095066, 322.38597912955123, 306.61865227126435, 253.37946096333525, 301.7490667131787, 283.40553953161606, 295.60707821123253, 91.55886308471837, 300.9052354530768, 353.4027184457852, 74.6361630301846], "episode_lengths": [50, 20, 50, 50, 50, 50, 50, 29, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 13, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 24, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 14, 50, 50, 50, 50, 50, 21, 50, 50, 25, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 20, 50, 50, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.652788191605854, "mean_inference_ms": 1.2591356195788026, "mean_action_processing_ms": 0.20945468594206176, "mean_env_wait_ms": 548.9140234804265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011677401406424386, "StateBufferConnector_ms": 0.006246810056725327, "ViewRequirementAgentConnector_ms": 0.17437083380562918}, "num_episodes": 13, "episode_return_max": 353.4027184457852, "episode_return_min": 59.948700569592575, "episode_return_mean": 276.8488264784135, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21156, "num_agent_steps_trained": 21156, "num_env_steps_sampled": 21156, "num_env_steps_trained": 21156, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 11.213410484595236, "num_env_steps_trained_throughput_per_sec": 11.213410484595236, "timesteps_total": 21156, "num_env_steps_sampled_lifetime": 21156, "num_agent_steps_sampled_lifetime": 21156, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 21156, "timers": {"training_iteration_time_ms": 53889.038, "restore_workers_time_ms": 0.018, "training_step_time_ms": 53888.988, "sample_time_ms": 52921.907, "load_time_ms": 0.355, "load_throughput": 1452415.761, "learn_time_ms": 953.545, "learn_throughput": 541.139, "synch_weights_time_ms": 12.909}, "counters": {"num_env_steps_sampled": 21156, "num_env_steps_trained": 21156, "num_agent_steps_sampled": 21156, "num_agent_steps_trained": 21156}, "done": false, "episodes_total": 700, "training_iteration": 41, "trial_id": "fe178_00000", "date": "2024-08-15_17-39-22", "timestamp": 1723765162, "time_this_iter_s": 46.01985502243042, "time_total_s": 2446.597931623459, "pid": 40829, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12800000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.6080000000000001, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 485.03132033348083, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 34.343939393939394, "ram_util_percent": 12.34090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.909943848848343, "cur_kl_coeff": 0.25, "cur_lr": 5e-06, "total_loss": 9.148012924194337, "policy_loss": -0.012960523987809816, "vf_loss": 9.15341424147288, "vf_explained_var": -0.021118070185184478, "kl": 0.030236551221851087, "entropy": -0.42508817187820874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22188, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 22188, "num_agent_steps_trained": 22188}, "sampler_results": {"episode_reward_max": 332.6032599133641, "episode_reward_min": 78.55232557304667, "episode_reward_mean": 269.516548745368, "episode_len_mean": 45.0, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 315, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.5463820680589, 259.2618128261435, 282.22023464759, 327.04794337770096, 287.38388281167204, 332.6032599133641, 78.55232557304667], "episode_lengths": [50, 50, 50, 50, 50, 50, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.791451205173736, "mean_inference_ms": 1.2776139138758869, "mean_action_processing_ms": 0.21514829939417845, "mean_env_wait_ms": 589.2060570333196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010016986301967077, "StateBufferConnector_ms": 0.0059877123151506695, "ViewRequirementAgentConnector_ms": 0.17218930380684988}, "num_episodes": 7, "episode_return_max": 332.6032599133641, "episode_return_min": 78.55232557304667, "episode_return_mean": 269.516548745368}, "env_runner_results": {"episode_reward_max": 332.6032599133641, "episode_reward_min": 78.55232557304667, "episode_reward_mean": 269.516548745368, "episode_len_mean": 45.0, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 315, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.5463820680589, 259.2618128261435, 282.22023464759, 327.04794337770096, 287.38388281167204, 332.6032599133641, 78.55232557304667], "episode_lengths": [50, 50, 50, 50, 50, 50, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.791451205173736, "mean_inference_ms": 1.2776139138758869, "mean_action_processing_ms": 0.21514829939417845, "mean_env_wait_ms": 589.2060570333196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010016986301967077, "StateBufferConnector_ms": 0.0059877123151506695, "ViewRequirementAgentConnector_ms": 0.17218930380684988}, "num_episodes": 7, "episode_return_max": 332.6032599133641, "episode_return_min": 78.55232557304667, "episode_return_mean": 269.516548745368}, "episode_reward_max": 332.6032599133641, "episode_reward_min": 78.55232557304667, "episode_reward_mean": 269.516548745368, "episode_len_mean": 45.0, "episodes_this_iter": 7, "episodes_timesteps_total": 315, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [319.5463820680589, 259.2618128261435, 282.22023464759, 327.04794337770096, 287.38388281167204, 332.6032599133641, 78.55232557304667], "episode_lengths": [50, 50, 50, 50, 50, 50, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.791451205173736, "mean_inference_ms": 1.2776139138758869, "mean_action_processing_ms": 0.21514829939417845, "mean_env_wait_ms": 589.2060570333196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010016986301967077, "StateBufferConnector_ms": 0.0059877123151506695, "ViewRequirementAgentConnector_ms": 0.17218930380684988}, "num_episodes": 7, "episode_return_max": 332.6032599133641, "episode_return_min": 78.55232557304667, "episode_return_mean": 269.516548745368, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22188, "num_agent_steps_trained": 22188, "num_env_steps_sampled": 22188, "num_env_steps_trained": 22188, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.17562450150652, "num_env_steps_trained_throughput_per_sec": 9.17562450150652, "timesteps_total": 22188, "num_env_steps_sampled_lifetime": 22188, "num_agent_steps_sampled_lifetime": 22188, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 22188, "timers": {"training_iteration_time_ms": 56235.965, "restore_workers_time_ms": 0.017, "training_step_time_ms": 56235.913, "sample_time_ms": 55045.363, "load_time_ms": 0.832, "load_throughput": 620132.053, "learn_time_ms": 1176.36, "learn_throughput": 438.641, "synch_weights_time_ms": 12.907}, "counters": {"num_env_steps_sampled": 22188, "num_env_steps_trained": 22188, "num_agent_steps_sampled": 22188, "num_agent_steps_trained": 22188}, "done": false, "episodes_total": 735, "training_iteration": 43, "trial_id": "fe178_00000", "date": "2024-08-15_17-40-36", "timestamp": 1723765236, "time_this_iter_s": 56.23900532722473, "time_total_s": 2539.9554731845856, "pid": 7504, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.288, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9161944907288566, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 56.23900532722473, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.417283950617282, "ram_util_percent": 12.246913580246913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.01899493932724, "cur_kl_coeff": 0.375, "cur_lr": 5e-06, "total_loss": 9.229164592425029, "policy_loss": -0.010860118642449379, "vf_loss": 9.236678314208984, "vf_explained_var": 0.1016728013753891, "kl": 0.008923996209828134, "entropy": -0.34441113920571903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22704, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 22704, "num_agent_steps_trained": 22704}, "sampler_results": {"episode_reward_max": 337.5640907053535, "episode_reward_min": 78.55232557304667, "episode_reward_mean": 257.1232922319526, "episode_len_mean": 43.80952380952381, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 920, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.5463820680589, 259.2618128261435, 282.22023464759, 327.04794337770096, 287.38388281167204, 332.6032599133641, 78.55232557304667, 259.48917543834057, 318.42879378824955, 322.8960668368724, 229.9090743749736, 337.5640907053535, 91.34590039464541, 263.36649612716326, 313.7700791126507, 265.92953789401264, 295.15317180501705, 92.62368783259367, 117.56226605559175, 294.85206532999416, 310.08288995796903], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 16, 50, 50, 50, 50, 17, 22, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.500948358842786, "mean_inference_ms": 1.2776140330583976, "mean_action_processing_ms": 0.213776363106546, "mean_env_wait_ms": 512.601369197535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012195677984328497, "StateBufferConnector_ms": 0.006143252054850261, "ViewRequirementAgentConnector_ms": 0.17313162485758463}, "num_episodes": 14, "episode_return_max": 337.5640907053535, "episode_return_min": 78.55232557304667, "episode_return_mean": 257.1232922319526}, "env_runner_results": {"episode_reward_max": 337.5640907053535, "episode_reward_min": 78.55232557304667, "episode_reward_mean": 257.1232922319526, "episode_len_mean": 43.80952380952381, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 920, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.5463820680589, 259.2618128261435, 282.22023464759, 327.04794337770096, 287.38388281167204, 332.6032599133641, 78.55232557304667, 259.48917543834057, 318.42879378824955, 322.8960668368724, 229.9090743749736, 337.5640907053535, 91.34590039464541, 263.36649612716326, 313.7700791126507, 265.92953789401264, 295.15317180501705, 92.62368783259367, 117.56226605559175, 294.85206532999416, 310.08288995796903], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 16, 50, 50, 50, 50, 17, 22, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.500948358842786, "mean_inference_ms": 1.2776140330583976, "mean_action_processing_ms": 0.213776363106546, "mean_env_wait_ms": 512.601369197535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012195677984328497, "StateBufferConnector_ms": 0.006143252054850261, "ViewRequirementAgentConnector_ms": 0.17313162485758463}, "num_episodes": 14, "episode_return_max": 337.5640907053535, "episode_return_min": 78.55232557304667, "episode_return_mean": 257.1232922319526}, "episode_reward_max": 337.5640907053535, "episode_reward_min": 78.55232557304667, "episode_reward_mean": 257.1232922319526, "episode_len_mean": 43.80952380952381, "episodes_this_iter": 14, "episodes_timesteps_total": 920, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [319.5463820680589, 259.2618128261435, 282.22023464759, 327.04794337770096, 287.38388281167204, 332.6032599133641, 78.55232557304667, 259.48917543834057, 318.42879378824955, 322.8960668368724, 229.9090743749736, 337.5640907053535, 91.34590039464541, 263.36649612716326, 313.7700791126507, 265.92953789401264, 295.15317180501705, 92.62368783259367, 117.56226605559175, 294.85206532999416, 310.08288995796903], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 16, 50, 50, 50, 50, 17, 22, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.500948358842786, "mean_inference_ms": 1.2776140330583976, "mean_action_processing_ms": 0.213776363106546, "mean_env_wait_ms": 512.601369197535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012195677984328497, "StateBufferConnector_ms": 0.006143252054850261, "ViewRequirementAgentConnector_ms": 0.17313162485758463}, "num_episodes": 14, "episode_return_max": 337.5640907053535, "episode_return_min": 78.55232557304667, "episode_return_mean": 257.1232922319526, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22704, "num_agent_steps_trained": 22704, "num_env_steps_sampled": 22704, "num_env_steps_trained": 22704, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.722399515204378, "num_env_steps_trained_throughput_per_sec": 14.722399515204378, "timesteps_total": 22704, "num_env_steps_sampled_lifetime": 22704, "num_agent_steps_sampled_lifetime": 22704, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 22704, "timers": {"training_iteration_time_ms": 45642.305, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45642.254, "sample_time_ms": 44703.994, "load_time_ms": 0.578, "load_throughput": 892478.707, "learn_time_ms": 924.532, "learn_throughput": 558.12, "synch_weights_time_ms": 12.816}, "counters": {"num_env_steps_sampled": 22704, "num_env_steps_trained": 22704, "num_agent_steps_sampled": 22704, "num_agent_steps_trained": 22704}, "done": false, "episodes_total": 749, "training_iteration": 44, "trial_id": "fe178_00000", "date": "2024-08-15_17-41-11", "timestamp": 1723765271, "time_this_iter_s": 35.0516140460968, "time_total_s": 2575.0070872306824, "pid": 7504, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.288, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9161944907288566, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 91.29061937332153, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.768, "ram_util_percent": 12.522000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.451357724269231, "cur_kl_coeff": 0.375, "cur_lr": 5e-06, "total_loss": 9.33207623163859, "policy_loss": -0.017796013007561364, "vf_loss": 9.346787985165914, "vf_explained_var": -0.011758375167846679, "kl": 0.008224834523088993, "entropy": -0.5730178472896417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220}, "sampler_results": {"episode_reward_max": 349.3415579986343, "episode_reward_min": 78.55232557304667, "episode_reward_mean": 279.0024658636903, "episode_len_mean": 45.806451612903224, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1420, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.5463820680589, 259.2618128261435, 282.22023464759, 327.04794337770096, 287.38388281167204, 332.6032599133641, 78.55232557304667, 259.48917543834057, 318.42879378824955, 322.8960668368724, 229.9090743749736, 337.5640907053535, 91.34590039464541, 263.36649612716326, 313.7700791126507, 265.92953789401264, 295.15317180501705, 92.62368783259367, 117.56226605559175, 294.85206532999416, 310.08288995796903, 334.1101362064389, 310.94162627113076, 325.85948116457115, 349.3415579986343, 310.59163405460623, 326.4578567742005, 320.27023442055827, 335.87469093144364, 331.8680030359813, 304.1720840458309], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 16, 50, 50, 50, 50, 17, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.575713303248603, "mean_inference_ms": 1.276126113700286, "mean_action_processing_ms": 0.2130767115624294, "mean_env_wait_ms": 504.1407349368815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012563120934271043, "StateBufferConnector_ms": 0.006258872247511341, "ViewRequirementAgentConnector_ms": 0.17439088513774256}, "num_episodes": 10, "episode_return_max": 349.3415579986343, "episode_return_min": 78.55232557304667, "episode_return_mean": 279.0024658636903}, "env_runner_results": {"episode_reward_max": 349.3415579986343, "episode_reward_min": 78.55232557304667, "episode_reward_mean": 279.0024658636903, "episode_len_mean": 45.806451612903224, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1420, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.5463820680589, 259.2618128261435, 282.22023464759, 327.04794337770096, 287.38388281167204, 332.6032599133641, 78.55232557304667, 259.48917543834057, 318.42879378824955, 322.8960668368724, 229.9090743749736, 337.5640907053535, 91.34590039464541, 263.36649612716326, 313.7700791126507, 265.92953789401264, 295.15317180501705, 92.62368783259367, 117.56226605559175, 294.85206532999416, 310.08288995796903, 334.1101362064389, 310.94162627113076, 325.85948116457115, 349.3415579986343, 310.59163405460623, 326.4578567742005, 320.27023442055827, 335.87469093144364, 331.8680030359813, 304.1720840458309], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 16, 50, 50, 50, 50, 17, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.575713303248603, "mean_inference_ms": 1.276126113700286, "mean_action_processing_ms": 0.2130767115624294, "mean_env_wait_ms": 504.1407349368815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012563120934271043, "StateBufferConnector_ms": 0.006258872247511341, "ViewRequirementAgentConnector_ms": 0.17439088513774256}, "num_episodes": 10, "episode_return_max": 349.3415579986343, "episode_return_min": 78.55232557304667, "episode_return_mean": 279.0024658636903}, "episode_reward_max": 349.3415579986343, "episode_reward_min": 78.55232557304667, "episode_reward_mean": 279.0024658636903, "episode_len_mean": 45.806451612903224, "episodes_this_iter": 10, "episodes_timesteps_total": 1420, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [319.5463820680589, 259.2618128261435, 282.22023464759, 327.04794337770096, 287.38388281167204, 332.6032599133641, 78.55232557304667, 259.48917543834057, 318.42879378824955, 322.8960668368724, 229.9090743749736, 337.5640907053535, 91.34590039464541, 263.36649612716326, 313.7700791126507, 265.92953789401264, 295.15317180501705, 92.62368783259367, 117.56226605559175, 294.85206532999416, 310.08288995796903, 334.1101362064389, 310.94162627113076, 325.85948116457115, 349.3415579986343, 310.59163405460623, 326.4578567742005, 320.27023442055827, 335.87469093144364, 331.8680030359813, 304.1720840458309], "episode_lengths": [50, 50, 50, 50, 50, 50, 15, 50, 50, 50, 50, 50, 16, 50, 50, 50, 50, 17, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.575713303248603, "mean_inference_ms": 1.276126113700286, "mean_action_processing_ms": 0.2130767115624294, "mean_env_wait_ms": 504.1407349368815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012563120934271043, "StateBufferConnector_ms": 0.006258872247511341, "ViewRequirementAgentConnector_ms": 0.17439088513774256}, "num_episodes": 10, "episode_return_max": 349.3415579986343, "episode_return_min": 78.55232557304667, "episode_return_mean": 279.0024658636903, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220, "num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.894993778701053, "num_env_steps_trained_throughput_per_sec": 9.894993778701053, "timesteps_total": 23220, "num_env_steps_sampled_lifetime": 23220, "num_agent_steps_sampled_lifetime": 23220, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 23220, "timers": {"training_iteration_time_ms": 47810.734, "restore_workers_time_ms": 0.016, "training_step_time_ms": 47810.684, "sample_time_ms": 46967.669, "load_time_ms": 0.496, "load_throughput": 1040676.806, "learn_time_ms": 829.21, "learn_throughput": 622.279, "synch_weights_time_ms": 13.001}, "counters": {"num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220}, "done": false, "episodes_total": 759, "training_iteration": 45, "trial_id": "fe178_00000", "date": "2024-08-15_17-42-03", "timestamp": 1723765323, "time_this_iter_s": 52.151148319244385, "time_total_s": 2627.1582355499268, "pid": 7504, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.288, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9161944907288566, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 143.44176769256592, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.347297297297303, "ram_util_percent": 12.602702702702702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.183535321553547, "cur_kl_coeff": 0.375, "cur_lr": 5e-06, "total_loss": 9.22805609703064, "policy_loss": -0.016487481334479526, "vf_loss": 9.240660325686138, "vf_explained_var": 0.21731150050957998, "kl": 0.010355175010471833, "entropy": -0.713969757159551, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220}, "sampler_results": {"episode_reward_max": 362.8366795062906, "episode_reward_min": 94.2497254412956, "episode_reward_mean": 215.43825161121157, "episode_len_mean": 35.1, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 351, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.5693033439701, 111.42930886369008, 314.93836442481813, 114.8556701792877, 362.8366795062906, 268.36271919259946, 332.643790414308, 94.2497254412956, 311.827936191169, 103.66901855468734], "episode_lengths": [25, 20, 50, 20, 50, 50, 50, 17, 50, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.805259189386478, "mean_inference_ms": 1.2844729697567292, "mean_action_processing_ms": 0.2110577177727359, "mean_env_wait_ms": 514.9051277116798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010840892791748047, "StateBufferConnector_ms": 0.006825923919677734, "ViewRequirementAgentConnector_ms": 0.17867088317871094}, "num_episodes": 10, "episode_return_max": 362.8366795062906, "episode_return_min": 94.2497254412956, "episode_return_mean": 215.43825161121157}, "env_runner_results": {"episode_reward_max": 362.8366795062906, "episode_reward_min": 94.2497254412956, "episode_reward_mean": 215.43825161121157, "episode_len_mean": 35.1, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 351, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.5693033439701, 111.42930886369008, 314.93836442481813, 114.8556701792877, 362.8366795062906, 268.36271919259946, 332.643790414308, 94.2497254412956, 311.827936191169, 103.66901855468734], "episode_lengths": [25, 20, 50, 20, 50, 50, 50, 17, 50, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.805259189386478, "mean_inference_ms": 1.2844729697567292, "mean_action_processing_ms": 0.2110577177727359, "mean_env_wait_ms": 514.9051277116798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010840892791748047, "StateBufferConnector_ms": 0.006825923919677734, "ViewRequirementAgentConnector_ms": 0.17867088317871094}, "num_episodes": 10, "episode_return_max": 362.8366795062906, "episode_return_min": 94.2497254412956, "episode_return_mean": 215.43825161121157}, "episode_reward_max": 362.8366795062906, "episode_reward_min": 94.2497254412956, "episode_reward_mean": 215.43825161121157, "episode_len_mean": 35.1, "episodes_this_iter": 10, "episodes_timesteps_total": 351, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [139.5693033439701, 111.42930886369008, 314.93836442481813, 114.8556701792877, 362.8366795062906, 268.36271919259946, 332.643790414308, 94.2497254412956, 311.827936191169, 103.66901855468734], "episode_lengths": [25, 20, 50, 20, 50, 50, 50, 17, 50, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.805259189386478, "mean_inference_ms": 1.2844729697567292, "mean_action_processing_ms": 0.2110577177727359, "mean_env_wait_ms": 514.9051277116798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010840892791748047, "StateBufferConnector_ms": 0.006825923919677734, "ViewRequirementAgentConnector_ms": 0.17867088317871094}, "num_episodes": 10, "episode_return_max": 362.8366795062906, "episode_return_min": 94.2497254412956, "episode_return_mean": 215.43825161121157, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220, "num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.15693274701168, "num_env_steps_trained_throughput_per_sec": 10.15693274701168, "timesteps_total": 23220, "num_env_steps_sampled_lifetime": 23220, "num_agent_steps_sampled_lifetime": 23220, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 23220, "timers": {"training_iteration_time_ms": 50802.747, "restore_workers_time_ms": 0.015, "training_step_time_ms": 50802.696, "sample_time_ms": 48322.577, "load_time_ms": 0.777, "load_throughput": 664291.241, "learn_time_ms": 2465.236, "learn_throughput": 209.311, "synch_weights_time_ms": 13.587}, "counters": {"num_env_steps_sampled": 23220, "num_env_steps_trained": 23220, "num_agent_steps_sampled": 23220, "num_agent_steps_trained": 23220}, "done": false, "episodes_total": 732, "training_iteration": 45, "trial_id": "fe178_00000", "date": "2024-08-15_17-43-12", "timestamp": 1723765392, "time_this_iter_s": 50.806440114974976, "time_total_s": 2640.063722372055, "pid": 29558, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.10240000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7296, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 50.806440114974976, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.19041095890411, "ram_util_percent": 11.706849315068494}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.95122971932093, "cur_kl_coeff": 0.375, "cur_lr": 5e-06, "total_loss": 9.520522443453471, "policy_loss": -3.0095378557840983e-06, "vf_loss": 9.51650505065918, "vf_explained_var": 0.06816889693339666, "kl": 0.010721436611859304, "entropy": -0.7179990800718467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23736, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 23736, "num_agent_steps_trained": 23736}, "sampler_results": {"episode_reward_max": 362.8366795062906, "episode_reward_min": 94.2497254412956, "episode_reward_mean": 273.5694867480086, "episode_len_mean": 43.22727272727273, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 951, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.5693033439701, 111.42930886369008, 314.93836442481813, 114.8556701792877, 362.8366795062906, 268.36271919259946, 332.643790414308, 94.2497254412956, 311.827936191169, 103.66901855468734, 321.7808871294336, 294.2494970814867, 322.97763556302743, 289.25239203015917, 316.4720061489663, 343.96753323365107, 311.5497762861765, 351.11913215056313, 292.62656008783046, 345.85628146529996, 332.46296623214215, 341.83152493533726], "episode_lengths": [25, 20, 50, 20, 50, 50, 50, 17, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.850147949265431, "mean_inference_ms": 1.279780273295337, "mean_action_processing_ms": 0.2105904826790392, "mean_env_wait_ms": 518.7214266315601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011101636019620028, "StateBufferConnector_ms": 0.006735324859619141, "ViewRequirementAgentConnector_ms": 0.17864704132080078}, "num_episodes": 12, "episode_return_max": 362.8366795062906, "episode_return_min": 94.2497254412956, "episode_return_mean": 273.5694867480086}, "env_runner_results": {"episode_reward_max": 362.8366795062906, "episode_reward_min": 94.2497254412956, "episode_reward_mean": 273.5694867480086, "episode_len_mean": 43.22727272727273, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 951, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.5693033439701, 111.42930886369008, 314.93836442481813, 114.8556701792877, 362.8366795062906, 268.36271919259946, 332.643790414308, 94.2497254412956, 311.827936191169, 103.66901855468734, 321.7808871294336, 294.2494970814867, 322.97763556302743, 289.25239203015917, 316.4720061489663, 343.96753323365107, 311.5497762861765, 351.11913215056313, 292.62656008783046, 345.85628146529996, 332.46296623214215, 341.83152493533726], "episode_lengths": [25, 20, 50, 20, 50, 50, 50, 17, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.850147949265431, "mean_inference_ms": 1.279780273295337, "mean_action_processing_ms": 0.2105904826790392, "mean_env_wait_ms": 518.7214266315601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011101636019620028, "StateBufferConnector_ms": 0.006735324859619141, "ViewRequirementAgentConnector_ms": 0.17864704132080078}, "num_episodes": 12, "episode_return_max": 362.8366795062906, "episode_return_min": 94.2497254412956, "episode_return_mean": 273.5694867480086}, "episode_reward_max": 362.8366795062906, "episode_reward_min": 94.2497254412956, "episode_reward_mean": 273.5694867480086, "episode_len_mean": 43.22727272727273, "episodes_this_iter": 12, "episodes_timesteps_total": 951, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [139.5693033439701, 111.42930886369008, 314.93836442481813, 114.8556701792877, 362.8366795062906, 268.36271919259946, 332.643790414308, 94.2497254412956, 311.827936191169, 103.66901855468734, 321.7808871294336, 294.2494970814867, 322.97763556302743, 289.25239203015917, 316.4720061489663, 343.96753323365107, 311.5497762861765, 351.11913215056313, 292.62656008783046, 345.85628146529996, 332.46296623214215, 341.83152493533726], "episode_lengths": [25, 20, 50, 20, 50, 50, 50, 17, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.850147949265431, "mean_inference_ms": 1.279780273295337, "mean_action_processing_ms": 0.2105904826790392, "mean_env_wait_ms": 518.7214266315601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011101636019620028, "StateBufferConnector_ms": 0.006735324859619141, "ViewRequirementAgentConnector_ms": 0.17864704132080078}, "num_episodes": 12, "episode_return_max": 362.8366795062906, "episode_return_min": 94.2497254412956, "episode_return_mean": 273.5694867480086, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23736, "num_agent_steps_trained": 23736, "num_env_steps_sampled": 23736, "num_env_steps_trained": 23736, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 10.146700672144927, "num_env_steps_trained_throughput_per_sec": 10.146700672144927, "timesteps_total": 23736, "num_env_steps_sampled_lifetime": 23736, "num_agent_steps_sampled_lifetime": 23736, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 23736, "timers": {"training_iteration_time_ms": 50828.366, "restore_workers_time_ms": 0.018, "training_step_time_ms": 50828.308, "sample_time_ms": 49238.843, "load_time_ms": 0.564, "load_throughput": 914927.442, "learn_time_ms": 1575.109, "learn_throughput": 327.596, "synch_weights_time_ms": 13.39}, "counters": {"num_env_steps_sampled": 23736, "num_env_steps_trained": 23736, "num_agent_steps_sampled": 23736, "num_agent_steps_trained": 23736}, "done": false, "episodes_total": 744, "training_iteration": 46, "trial_id": "fe178_00000", "date": "2024-08-15_17-44-03", "timestamp": 1723765443, "time_this_iter_s": 50.85710859298706, "time_total_s": 2690.920830965042, "pid": 29558, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.10240000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7296, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 101.66354870796204, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.380821917808223, "ram_util_percent": 12.219178082191782}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.556098902225495, "cur_kl_coeff": 0.375, "cur_lr": 5e-06, "total_loss": 9.34065438111623, "policy_loss": -0.010134218074381352, "vf_loss": 9.349413069089254, "vf_explained_var": 0.07116812417904536, "kl": 0.003667731120333841, "entropy": -0.7735337058703105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24252, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 24252, "num_agent_steps_trained": 24252}, "sampler_results": {"episode_reward_max": 362.8366795062906, "episode_reward_min": 72.7830456580305, "episode_reward_mean": 281.98321138100516, "episode_len_mean": 44.25, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1416, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.5693033439701, 111.42930886369008, 314.93836442481813, 114.8556701792877, 362.8366795062906, 268.36271919259946, 332.643790414308, 94.2497254412956, 311.827936191169, 103.66901855468734, 321.7808871294336, 294.2494970814867, 322.97763556302743, 289.25239203015917, 316.4720061489663, 343.96753323365107, 311.5497762861765, 351.11913215056313, 292.62656008783046, 345.85628146529996, 332.46296623214215, 341.83152493533726, 343.5322576011357, 315.8326999635792, 306.4561086500757, 303.3530277658922, 325.17143898006674, 338.4846460331927, 330.95264212580224, 72.7830456580305, 348.6473213439456, 319.7208676142561], "episode_lengths": [25, 20, 50, 20, 50, 50, 50, 17, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.84175056196167, "mean_inference_ms": 1.2789303411147084, "mean_action_processing_ms": 0.21048756959266973, "mean_env_wait_ms": 532.2339717298057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01125633716583252, "StateBufferConnector_ms": 0.0066220760345458984, "ViewRequirementAgentConnector_ms": 0.1772962510585785}, "num_episodes": 10, "episode_return_max": 362.8366795062906, "episode_return_min": 72.7830456580305, "episode_return_mean": 281.98321138100516}, "env_runner_results": {"episode_reward_max": 362.8366795062906, "episode_reward_min": 72.7830456580305, "episode_reward_mean": 281.98321138100516, "episode_len_mean": 44.25, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 1416, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.5693033439701, 111.42930886369008, 314.93836442481813, 114.8556701792877, 362.8366795062906, 268.36271919259946, 332.643790414308, 94.2497254412956, 311.827936191169, 103.66901855468734, 321.7808871294336, 294.2494970814867, 322.97763556302743, 289.25239203015917, 316.4720061489663, 343.96753323365107, 311.5497762861765, 351.11913215056313, 292.62656008783046, 345.85628146529996, 332.46296623214215, 341.83152493533726, 343.5322576011357, 315.8326999635792, 306.4561086500757, 303.3530277658922, 325.17143898006674, 338.4846460331927, 330.95264212580224, 72.7830456580305, 348.6473213439456, 319.7208676142561], "episode_lengths": [25, 20, 50, 20, 50, 50, 50, 17, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.84175056196167, "mean_inference_ms": 1.2789303411147084, "mean_action_processing_ms": 0.21048756959266973, "mean_env_wait_ms": 532.2339717298057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01125633716583252, "StateBufferConnector_ms": 0.0066220760345458984, "ViewRequirementAgentConnector_ms": 0.1772962510585785}, "num_episodes": 10, "episode_return_max": 362.8366795062906, "episode_return_min": 72.7830456580305, "episode_return_mean": 281.98321138100516}, "episode_reward_max": 362.8366795062906, "episode_reward_min": 72.7830456580305, "episode_reward_mean": 281.98321138100516, "episode_len_mean": 44.25, "episodes_this_iter": 10, "episodes_timesteps_total": 1416, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [139.5693033439701, 111.42930886369008, 314.93836442481813, 114.8556701792877, 362.8366795062906, 268.36271919259946, 332.643790414308, 94.2497254412956, 311.827936191169, 103.66901855468734, 321.7808871294336, 294.2494970814867, 322.97763556302743, 289.25239203015917, 316.4720061489663, 343.96753323365107, 311.5497762861765, 351.11913215056313, 292.62656008783046, 345.85628146529996, 332.46296623214215, 341.83152493533726, 343.5322576011357, 315.8326999635792, 306.4561086500757, 303.3530277658922, 325.17143898006674, 338.4846460331927, 330.95264212580224, 72.7830456580305, 348.6473213439456, 319.7208676142561], "episode_lengths": [25, 20, 50, 20, 50, 50, 50, 17, 50, 19, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 15, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.84175056196167, "mean_inference_ms": 1.2789303411147084, "mean_action_processing_ms": 0.21048756959266973, "mean_env_wait_ms": 532.2339717298057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01125633716583252, "StateBufferConnector_ms": 0.0066220760345458984, "ViewRequirementAgentConnector_ms": 0.1772962510585785}, "num_episodes": 10, "episode_return_max": 362.8366795062906, "episode_return_min": 72.7830456580305, "episode_return_mean": 281.98321138100516, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24252, "num_agent_steps_trained": 24252, "num_env_steps_sampled": 24252, "num_env_steps_trained": 24252, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 8.439447131386366, "num_env_steps_trained_throughput_per_sec": 8.439447131386366, "timesteps_total": 24252, "num_env_steps_sampled_lifetime": 24252, "num_agent_steps_sampled_lifetime": 24252, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 24252, "timers": {"training_iteration_time_ms": 54266.064, "restore_workers_time_ms": 0.018, "training_step_time_ms": 54266.006, "sample_time_ms": 52974.255, "load_time_ms": 0.48, "load_throughput": 1073897.22, "learn_time_ms": 1277.407, "learn_throughput": 403.943, "synch_weights_time_ms": 13.499}, "counters": {"num_env_steps_sampled": 24252, "num_env_steps_trained": 24252, "num_agent_steps_sampled": 24252, "num_agent_steps_trained": 24252}, "done": false, "episodes_total": 754, "training_iteration": 47, "trial_id": "fe178_00000", "date": "2024-08-15_17-45-04", "timestamp": 1723765504, "time_this_iter_s": 61.144736766815186, "time_total_s": 2752.0655677318573, "pid": 29558, "hostname": "r8i1n3", "node_ip": "10.159.28.42", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f86f8c9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.10240000000000003, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7296, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 162.80828547477722, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.595402298850583, "ram_util_percent": 12.512643678160913}}
