{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.462884777720678, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3348139405250548, "policy_loss": -0.015076516894623637, "vf_loss": 2.346573648850123, "vf_explained_var": 0.6558090666929881, "kl": 0.007165542069803897, "entropy": -1.8134131938219071, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 219708, "num_env_steps_trained": 219708, "num_agent_steps_sampled": 219708, "num_agent_steps_trained": 219708}, "sampler_results": {"episode_reward_max": 358.1499475849931, "episode_reward_min": 330.3725055344223, "episode_reward_mean": 345.5583049294266, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2511841346477635, "mean_inference_ms": 1.3093911825011972, "mean_action_processing_ms": 0.2173135107047713, "mean_env_wait_ms": 299.3040728843075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009675820668538412, "StateBufferConnector_ms": 0.005964438120524089, "ViewRequirementAgentConnector_ms": 0.17348925272623697}, "num_episodes": 6, "episode_return_max": 358.1499475849931, "episode_return_min": 330.3725055344223, "episode_return_mean": 345.5583049294266}, "env_runner_results": {"episode_reward_max": 358.1499475849931, "episode_reward_min": 330.3725055344223, "episode_reward_mean": 345.5583049294266, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2511841346477635, "mean_inference_ms": 1.3093911825011972, "mean_action_processing_ms": 0.2173135107047713, "mean_env_wait_ms": 299.3040728843075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009675820668538412, "StateBufferConnector_ms": 0.005964438120524089, "ViewRequirementAgentConnector_ms": 0.17348925272623697}, "num_episodes": 6, "episode_return_max": 358.1499475849931, "episode_return_min": 330.3725055344223, "episode_return_mean": 345.5583049294266}, "episode_reward_max": 358.1499475849931, "episode_reward_min": 330.3725055344223, "episode_reward_mean": 345.5583049294266, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2511841346477635, "mean_inference_ms": 1.3093911825011972, "mean_action_processing_ms": 0.2173135107047713, "mean_env_wait_ms": 299.3040728843075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009675820668538412, "StateBufferConnector_ms": 0.005964438120524089, "ViewRequirementAgentConnector_ms": 0.17348925272623697}, "num_episodes": 6, "episode_return_max": 358.1499475849931, "episode_return_min": 330.3725055344223, "episode_return_mean": 345.5583049294266, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 219708, "num_agent_steps_trained": 219708, "num_env_steps_sampled": 219708, "num_env_steps_trained": 219708, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 17.264537275669934, "num_env_steps_trained_throughput_per_sec": 17.264537275669934, "timesteps_total": 219708, "num_env_steps_sampled_lifetime": 219708, "num_agent_steps_sampled_lifetime": 219708, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 219708, "timers": {"training_iteration_time_ms": 29887.873, "restore_workers_time_ms": 0.025, "training_step_time_ms": 29887.795, "sample_time_ms": 28994.501, "load_time_ms": 1.384, "load_throughput": 372762.808, "learn_time_ms": 877.839, "learn_throughput": 587.807, "synch_weights_time_ms": 13.653}, "counters": {"num_env_steps_sampled": 219708, "num_env_steps_trained": 219708, "num_agent_steps_sampled": 219708, "num_agent_steps_trained": 219708}, "done": false, "episodes_total": 4577, "training_iteration": 170, "trial_id": "fd033_00000", "date": "2024-06-11_13-20-05", "timestamp": 1718133605, "time_this_iter_s": 29.890814065933228, "time_total_s": 15117.9606487751, "pid": 63446, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 29.890814065933228, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 51.05681818181818, "ram_util_percent": 13.525000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.462884777720678, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9487519244352975, "policy_loss": -0.028668188645193975, "vf_loss": 1.9731058140595754, "vf_explained_var": 0.2581234072645505, "kl": 0.00932052914771096, "entropy": -1.831567425529162, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 220224, "num_env_steps_trained": 220224, "num_agent_steps_sampled": 220224, "num_agent_steps_trained": 220224}, "sampler_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 330.3725055344223, "episode_reward_mean": 350.5053237907014, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9986916966732196, "mean_inference_ms": 1.3094248563379702, "mean_action_processing_ms": 0.21681965710009543, "mean_env_wait_ms": 326.127662546856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012544790903727213, "StateBufferConnector_ms": 0.006230672200520833, "ViewRequirementAgentConnector_ms": 0.17625225914849174}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 330.3725055344223, "episode_return_mean": 350.5053237907014}, "env_runner_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 330.3725055344223, "episode_reward_mean": 350.5053237907014, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9986916966732196, "mean_inference_ms": 1.3094248563379702, "mean_action_processing_ms": 0.21681965710009543, "mean_env_wait_ms": 326.127662546856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012544790903727213, "StateBufferConnector_ms": 0.006230672200520833, "ViewRequirementAgentConnector_ms": 0.17625225914849174}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 330.3725055344223, "episode_return_mean": 350.5053237907014}, "episode_reward_max": 373.49257905669543, "episode_reward_min": 330.3725055344223, "episode_reward_mean": 350.5053237907014, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9986916966732196, "mean_inference_ms": 1.3094248563379702, "mean_action_processing_ms": 0.21681965710009543, "mean_env_wait_ms": 326.127662546856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012544790903727213, "StateBufferConnector_ms": 0.006230672200520833, "ViewRequirementAgentConnector_ms": 0.17625225914849174}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 330.3725055344223, "episode_return_mean": 350.5053237907014, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220224, "num_agent_steps_trained": 220224, "num_env_steps_sampled": 220224, "num_env_steps_trained": 220224, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.04447485345588, "num_env_steps_trained_throughput_per_sec": 14.04447485345588, "timesteps_total": 220224, "num_env_steps_sampled_lifetime": 220224, "num_agent_steps_sampled_lifetime": 220224, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 220224, "timers": {"training_iteration_time_ms": 33314.157, "restore_workers_time_ms": 0.022, "training_step_time_ms": 33314.087, "sample_time_ms": 32449.181, "load_time_ms": 1.282, "load_throughput": 402353.758, "learn_time_ms": 849.457, "learn_throughput": 607.447, "synch_weights_time_ms": 13.816}, "counters": {"num_env_steps_sampled": 220224, "num_env_steps_trained": 220224, "num_agent_steps_sampled": 220224, "num_agent_steps_trained": 220224}, "done": false, "episodes_total": 4589, "training_iteration": 171, "trial_id": "fd033_00000", "date": "2024-06-11_13-20-41", "timestamp": 1718133641, "time_this_iter_s": 36.74393630027771, "time_total_s": 15154.704585075378, "pid": 63446, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 66.63475036621094, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.94230769230769, "ram_util_percent": 13.740384615384611}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.462884777720678, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3305250252286593, "policy_loss": -0.01371373115107417, "vf_loss": 2.3409922540187837, "vf_explained_var": 0.68058922290802, "kl": 0.007013618672500463, "entropy": -1.7333930591742197, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 220740, "num_env_steps_trained": 220740, "num_agent_steps_sampled": 220740, "num_agent_steps_trained": 220740}, "sampler_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 306.3323289018541, "episode_reward_mean": 347.59725614434603, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2789461007974525, "mean_inference_ms": 1.3083069789276862, "mean_action_processing_ms": 0.2163734221752911, "mean_env_wait_ms": 333.3088467490316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013022422790527344, "StateBufferConnector_ms": 0.006223519643147786, "ViewRequirementAgentConnector_ms": 0.1771402359008789}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 306.3323289018541, "episode_return_mean": 347.59725614434603}, "env_runner_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 306.3323289018541, "episode_reward_mean": 347.59725614434603, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2789461007974525, "mean_inference_ms": 1.3083069789276862, "mean_action_processing_ms": 0.2163734221752911, "mean_env_wait_ms": 333.3088467490316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013022422790527344, "StateBufferConnector_ms": 0.006223519643147786, "ViewRequirementAgentConnector_ms": 0.1771402359008789}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 306.3323289018541, "episode_return_mean": 347.59725614434603}, "episode_reward_max": 373.49257905669543, "episode_reward_min": 306.3323289018541, "episode_reward_mean": 347.59725614434603, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2789461007974525, "mean_inference_ms": 1.3083069789276862, "mean_action_processing_ms": 0.2163734221752911, "mean_env_wait_ms": 333.3088467490316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013022422790527344, "StateBufferConnector_ms": 0.006223519643147786, "ViewRequirementAgentConnector_ms": 0.1771402359008789}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 306.3323289018541, "episode_return_mean": 347.59725614434603, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220740, "num_agent_steps_trained": 220740, "num_env_steps_sampled": 220740, "num_env_steps_trained": 220740, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.425028476166304, "num_env_steps_trained_throughput_per_sec": 14.425028476166304, "timesteps_total": 220740, "num_env_steps_sampled_lifetime": 220740, "num_agent_steps_sampled_lifetime": 220740, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 220740, "timers": {"training_iteration_time_ms": 34133.162, "restore_workers_time_ms": 0.021, "training_step_time_ms": 34133.097, "sample_time_ms": 33298.562, "load_time_ms": 1.218, "load_throughput": 423534.416, "learn_time_ms": 819.362, "learn_throughput": 629.758, "synch_weights_time_ms": 13.643}, "counters": {"num_env_steps_sampled": 220740, "num_env_steps_trained": 220740, "num_agent_steps_sampled": 220740, "num_agent_steps_trained": 220740}, "done": false, "episodes_total": 4601, "training_iteration": 172, "trial_id": "fd033_00000", "date": "2024-06-11_13-21-17", "timestamp": 1718133677, "time_this_iter_s": 35.77473163604736, "time_total_s": 15190.479316711426, "pid": 63446, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 102.4094820022583, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 41.91960784313726, "ram_util_percent": 13.829411764705881}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.462884777720678, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9762512353559336, "policy_loss": -0.014325868850573898, "vf_loss": 1.9862098346153896, "vf_explained_var": 0.07855274031559627, "kl": 0.009434906240009392, "entropy": -1.7906088848908743, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 221256, "num_env_steps_trained": 221256, "num_agent_steps_sampled": 221256, "num_agent_steps_trained": 221256}, "sampler_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 306.3323289018541, "episode_reward_mean": 348.8330100397638, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.286502706156401, "mean_inference_ms": 1.3066924322375852, "mean_action_processing_ms": 0.21597551396845907, "mean_env_wait_ms": 343.4249699932117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013584560818142362, "StateBufferConnector_ms": 0.006176365746392144, "ViewRequirementAgentConnector_ms": 0.17633305655585396}, "num_episodes": 6, "episode_return_max": 373.49257905669543, "episode_return_min": 306.3323289018541, "episode_return_mean": 348.8330100397638}, "env_runner_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 306.3323289018541, "episode_reward_mean": 348.8330100397638, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.286502706156401, "mean_inference_ms": 1.3066924322375852, "mean_action_processing_ms": 0.21597551396845907, "mean_env_wait_ms": 343.4249699932117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013584560818142362, "StateBufferConnector_ms": 0.006176365746392144, "ViewRequirementAgentConnector_ms": 0.17633305655585396}, "num_episodes": 6, "episode_return_max": 373.49257905669543, "episode_return_min": 306.3323289018541, "episode_return_mean": 348.8330100397638}, "episode_reward_max": 373.49257905669543, "episode_reward_min": 306.3323289018541, "episode_reward_mean": 348.8330100397638, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.286502706156401, "mean_inference_ms": 1.3066924322375852, "mean_action_processing_ms": 0.21597551396845907, "mean_env_wait_ms": 343.4249699932117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013584560818142362, "StateBufferConnector_ms": 0.006176365746392144, "ViewRequirementAgentConnector_ms": 0.17633305655585396}, "num_episodes": 6, "episode_return_max": 373.49257905669543, "episode_return_min": 306.3323289018541, "episode_return_mean": 348.8330100397638, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221256, "num_agent_steps_trained": 221256, "num_env_steps_sampled": 221256, "num_env_steps_trained": 221256, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 9.252245319604679, "num_env_steps_trained_throughput_per_sec": 9.252245319604679, "timesteps_total": 221256, "num_env_steps_sampled_lifetime": 221256, "num_agent_steps_sampled_lifetime": 221256, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 221256, "timers": {"training_iteration_time_ms": 39542.437, "restore_workers_time_ms": 0.02, "training_step_time_ms": 39542.371, "sample_time_ms": 38725.711, "load_time_ms": 1.205, "load_throughput": 428057.924, "learn_time_ms": 801.636, "learn_throughput": 643.684, "synch_weights_time_ms": 13.528}, "counters": {"num_env_steps_sampled": 221256, "num_env_steps_trained": 221256, "num_agent_steps_sampled": 221256, "num_agent_steps_trained": 221256}, "done": false, "episodes_total": 4607, "training_iteration": 173, "trial_id": "fd033_00000", "date": "2024-06-11_13-22-13", "timestamp": 1718133733, "time_this_iter_s": 55.77336883544922, "time_total_s": 15246.252685546875, "pid": 63446, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 158.18285083770752, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 27.672499999999996, "ram_util_percent": 13.901250000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.462884777720678, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1109800075491267, "policy_loss": -0.01056397594511509, "vf_loss": 2.1178706670800844, "vf_explained_var": 0.6168856670459112, "kl": 0.007935701695533459, "entropy": -1.82950665752093, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 221772, "num_env_steps_trained": 221772, "num_agent_steps_sampled": 221772, "num_agent_steps_trained": 221772}, "sampler_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 306.3323289018541, "episode_reward_mean": 349.2944677773301, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837, 342.77504078602396, 340.4421890282811, 363.2233084130168, 354.33194500888817, 355.3796032936516, 346.2131525761825, 338.4705662264543, 354.0563207790294, 353.8175865391203, 358.8543105424049, 366.9800933124082, 333.601975374886], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.349036857716304, "mean_inference_ms": 1.3048174108579176, "mean_action_processing_ms": 0.21550483171370635, "mean_env_wait_ms": 355.2194508121074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013581415017445883, "StateBufferConnector_ms": 0.006160140037536621, "ViewRequirementAgentConnector_ms": 0.1756380001703898}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 306.3323289018541, "episode_return_mean": 349.2944677773301}, "env_runner_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 306.3323289018541, "episode_reward_mean": 349.2944677773301, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837, 342.77504078602396, 340.4421890282811, 363.2233084130168, 354.33194500888817, 355.3796032936516, 346.2131525761825, 338.4705662264543, 354.0563207790294, 353.8175865391203, 358.8543105424049, 366.9800933124082, 333.601975374886], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.349036857716304, "mean_inference_ms": 1.3048174108579176, "mean_action_processing_ms": 0.21550483171370635, "mean_env_wait_ms": 355.2194508121074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013581415017445883, "StateBufferConnector_ms": 0.006160140037536621, "ViewRequirementAgentConnector_ms": 0.1756380001703898}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 306.3323289018541, "episode_return_mean": 349.2944677773301}, "episode_reward_max": 373.49257905669543, "episode_reward_min": 306.3323289018541, "episode_reward_mean": 349.2944677773301, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837, 342.77504078602396, 340.4421890282811, 363.2233084130168, 354.33194500888817, 355.3796032936516, 346.2131525761825, 338.4705662264543, 354.0563207790294, 353.8175865391203, 358.8543105424049, 366.9800933124082, 333.601975374886], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.349036857716304, "mean_inference_ms": 1.3048174108579176, "mean_action_processing_ms": 0.21550483171370635, "mean_env_wait_ms": 355.2194508121074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013581415017445883, "StateBufferConnector_ms": 0.006160140037536621, "ViewRequirementAgentConnector_ms": 0.1756380001703898}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 306.3323289018541, "episode_return_mean": 349.2944677773301, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221772, "num_agent_steps_trained": 221772, "num_env_steps_sampled": 221772, "num_env_steps_trained": 221772, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.137113181816465, "num_env_steps_trained_throughput_per_sec": 14.137113181816465, "timesteps_total": 221772, "num_env_steps_sampled_lifetime": 221772, "num_agent_steps_sampled_lifetime": 221772, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 221772, "timers": {"training_iteration_time_ms": 38933.887, "restore_workers_time_ms": 0.021, "training_step_time_ms": 38933.822, "sample_time_ms": 38122.915, "load_time_ms": 1.187, "load_throughput": 434747.673, "learn_time_ms": 795.869, "learn_throughput": 648.348, "synch_weights_time_ms": 13.569}, "counters": {"num_env_steps_sampled": 221772, "num_env_steps_trained": 221772, "num_agent_steps_sampled": 221772, "num_agent_steps_trained": 221772}, "done": false, "episodes_total": 4619, "training_iteration": 174, "trial_id": "fd033_00000", "date": "2024-06-11_13-22-50", "timestamp": 1718133770, "time_this_iter_s": 36.5033004283905, "time_total_s": 15282.755985975266, "pid": 63446, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 194.68615126609802, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.88846153846154, "ram_util_percent": 13.459615384615386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.462884777720678, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.384699753423532, "policy_loss": -0.01273962315171957, "vf_loss": 2.388057722647985, "vf_explained_var": 0.705776094396909, "kl": 0.0202677995073221, "entropy": -1.8215921799341837, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 222288, "num_env_steps_trained": 222288, "num_agent_steps_sampled": 222288, "num_agent_steps_trained": 222288}, "sampler_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 306.3323289018541, "episode_reward_mean": 348.84126049405677, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837, 342.77504078602396, 340.4421890282811, 363.2233084130168, 354.33194500888817, 355.3796032936516, 346.2131525761825, 338.4705662264543, 354.0563207790294, 353.8175865391203, 358.8543105424049, 366.9800933124082, 333.601975374886, 348.1659617621157, 335.089043678277, 336.4325815132557, 343.2241575997363, 346.74785434050153, 355.4955390528246, 339.09545322549343, 341.3151387894809, 345.55441312961335, 365.9554945696822, 366.2338367133456, 341.0317019572303], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.415257399663205, "mean_inference_ms": 1.3036899054597617, "mean_action_processing_ms": 0.21525138866978816, "mean_env_wait_ms": 361.9491183827457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013683636983235678, "StateBufferConnector_ms": 0.00614166259765625, "ViewRequirementAgentConnector_ms": 0.17702698707580566}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 306.3323289018541, "episode_return_mean": 348.84126049405677}, "env_runner_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 306.3323289018541, "episode_reward_mean": 348.84126049405677, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837, 342.77504078602396, 340.4421890282811, 363.2233084130168, 354.33194500888817, 355.3796032936516, 346.2131525761825, 338.4705662264543, 354.0563207790294, 353.8175865391203, 358.8543105424049, 366.9800933124082, 333.601975374886, 348.1659617621157, 335.089043678277, 336.4325815132557, 343.2241575997363, 346.74785434050153, 355.4955390528246, 339.09545322549343, 341.3151387894809, 345.55441312961335, 365.9554945696822, 366.2338367133456, 341.0317019572303], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.415257399663205, "mean_inference_ms": 1.3036899054597617, "mean_action_processing_ms": 0.21525138866978816, "mean_env_wait_ms": 361.9491183827457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013683636983235678, "StateBufferConnector_ms": 0.00614166259765625, "ViewRequirementAgentConnector_ms": 0.17702698707580566}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 306.3323289018541, "episode_return_mean": 348.84126049405677}, "episode_reward_max": 373.49257905669543, "episode_reward_min": 306.3323289018541, "episode_reward_mean": 348.84126049405677, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837, 342.77504078602396, 340.4421890282811, 363.2233084130168, 354.33194500888817, 355.3796032936516, 346.2131525761825, 338.4705662264543, 354.0563207790294, 353.8175865391203, 358.8543105424049, 366.9800933124082, 333.601975374886, 348.1659617621157, 335.089043678277, 336.4325815132557, 343.2241575997363, 346.74785434050153, 355.4955390528246, 339.09545322549343, 341.3151387894809, 345.55441312961335, 365.9554945696822, 366.2338367133456, 341.0317019572303], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.415257399663205, "mean_inference_ms": 1.3036899054597617, "mean_action_processing_ms": 0.21525138866978816, "mean_env_wait_ms": 361.9491183827457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013683636983235678, "StateBufferConnector_ms": 0.00614166259765625, "ViewRequirementAgentConnector_ms": 0.17702698707580566}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 306.3323289018541, "episode_return_mean": 348.84126049405677, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222288, "num_agent_steps_trained": 222288, "num_env_steps_sampled": 222288, "num_env_steps_trained": 222288, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.942948273909034, "num_env_steps_trained_throughput_per_sec": 13.942948273909034, "timesteps_total": 222288, "num_env_steps_sampled_lifetime": 222288, "num_agent_steps_sampled_lifetime": 222288, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 222288, "timers": {"training_iteration_time_ms": 38612.901, "restore_workers_time_ms": 0.021, "training_step_time_ms": 38612.837, "sample_time_ms": 37793.108, "load_time_ms": 1.193, "load_throughput": 432650.269, "learn_time_ms": 804.646, "learn_throughput": 641.276, "synch_weights_time_ms": 13.612}, "counters": {"num_env_steps_sampled": 222288, "num_env_steps_trained": 222288, "num_agent_steps_sampled": 222288, "num_agent_steps_trained": 222288}, "done": false, "episodes_total": 4631, "training_iteration": 175, "trial_id": "fd033_00000", "date": "2024-06-11_13-23-27", "timestamp": 1718133807, "time_this_iter_s": 37.01158118247986, "time_total_s": 15319.767567157745, "pid": 63446, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 231.69773244857788, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 40.87924528301887, "ram_util_percent": 13.90754716981132}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.694327166581017, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2468006645639735, "policy_loss": 0.018672033969778568, "vf_loss": 2.2083198462923366, "vf_explained_var": -0.041035998860994974, "kl": 0.028529432123954552, "entropy": -1.766979342699051, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 222804, "num_env_steps_trained": 222804, "num_agent_steps_sampled": 222804, "num_agent_steps_trained": 222804}, "sampler_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 303.84134030833536, "episode_reward_mean": 348.1393263091513, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837, 342.77504078602396, 340.4421890282811, 363.2233084130168, 354.33194500888817, 355.3796032936516, 346.2131525761825, 338.4705662264543, 354.0563207790294, 353.8175865391203, 358.8543105424049, 366.9800933124082, 333.601975374886, 348.1659617621157, 335.089043678277, 336.4325815132557, 343.2241575997363, 346.74785434050153, 355.4955390528246, 339.09545322549343, 341.3151387894809, 345.55441312961335, 365.9554945696822, 366.2338367133456, 341.0317019572303, 338.1988424565956, 339.64622025572896, 347.96873724143734, 357.8616261378385, 333.75951676353407, 353.59887641376497, 365.83008704784623, 343.15071214836814, 303.84134030833536, 351.96669827676794, 350.3724816119926, 349.3607259532794], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.476554708445964, "mean_inference_ms": 1.3028260310930426, "mean_action_processing_ms": 0.21507783477671158, "mean_env_wait_ms": 364.22827654435207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012966328197055392, "StateBufferConnector_ms": 0.0061111317740546334, "ViewRequirementAgentConnector_ms": 0.1763883564207289}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 303.84134030833536, "episode_return_mean": 348.1393263091513}, "env_runner_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 303.84134030833536, "episode_reward_mean": 348.1393263091513, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837, 342.77504078602396, 340.4421890282811, 363.2233084130168, 354.33194500888817, 355.3796032936516, 346.2131525761825, 338.4705662264543, 354.0563207790294, 353.8175865391203, 358.8543105424049, 366.9800933124082, 333.601975374886, 348.1659617621157, 335.089043678277, 336.4325815132557, 343.2241575997363, 346.74785434050153, 355.4955390528246, 339.09545322549343, 341.3151387894809, 345.55441312961335, 365.9554945696822, 366.2338367133456, 341.0317019572303, 338.1988424565956, 339.64622025572896, 347.96873724143734, 357.8616261378385, 333.75951676353407, 353.59887641376497, 365.83008704784623, 343.15071214836814, 303.84134030833536, 351.96669827676794, 350.3724816119926, 349.3607259532794], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.476554708445964, "mean_inference_ms": 1.3028260310930426, "mean_action_processing_ms": 0.21507783477671158, "mean_env_wait_ms": 364.22827654435207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012966328197055392, "StateBufferConnector_ms": 0.0061111317740546334, "ViewRequirementAgentConnector_ms": 0.1763883564207289}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 303.84134030833536, "episode_return_mean": 348.1393263091513}, "episode_reward_max": 373.49257905669543, "episode_reward_min": 303.84134030833536, "episode_reward_mean": 348.1393263091513, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 3600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837, 342.77504078602396, 340.4421890282811, 363.2233084130168, 354.33194500888817, 355.3796032936516, 346.2131525761825, 338.4705662264543, 354.0563207790294, 353.8175865391203, 358.8543105424049, 366.9800933124082, 333.601975374886, 348.1659617621157, 335.089043678277, 336.4325815132557, 343.2241575997363, 346.74785434050153, 355.4955390528246, 339.09545322549343, 341.3151387894809, 345.55441312961335, 365.9554945696822, 366.2338367133456, 341.0317019572303, 338.1988424565956, 339.64622025572896, 347.96873724143734, 357.8616261378385, 333.75951676353407, 353.59887641376497, 365.83008704784623, 343.15071214836814, 303.84134030833536, 351.96669827676794, 350.3724816119926, 349.3607259532794], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.476554708445964, "mean_inference_ms": 1.3028260310930426, "mean_action_processing_ms": 0.21507783477671158, "mean_env_wait_ms": 364.22827654435207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012966328197055392, "StateBufferConnector_ms": 0.0061111317740546334, "ViewRequirementAgentConnector_ms": 0.1763883564207289}, "num_episodes": 12, "episode_return_max": 373.49257905669543, "episode_return_min": 303.84134030833536, "episode_return_mean": 348.1393263091513, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222804, "num_agent_steps_trained": 222804, "num_env_steps_sampled": 222804, "num_env_steps_trained": 222804, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 17.4052860157269, "num_env_steps_trained_throughput_per_sec": 17.4052860157269, "timesteps_total": 222804, "num_env_steps_sampled_lifetime": 222804, "num_agent_steps_sampled_lifetime": 222804, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 222804, "timers": {"training_iteration_time_ms": 37331.941, "restore_workers_time_ms": 0.021, "training_step_time_ms": 37331.878, "sample_time_ms": 36519.702, "load_time_ms": 1.183, "load_throughput": 436104.265, "learn_time_ms": 797.123, "learn_throughput": 647.328, "synch_weights_time_ms": 13.591}, "counters": {"num_env_steps_sampled": 222804, "num_env_steps_trained": 222804, "num_agent_steps_sampled": 222804, "num_agent_steps_trained": 222804}, "done": false, "episodes_total": 4643, "training_iteration": 176, "trial_id": "fd033_00000", "date": "2024-06-11_13-23-56", "timestamp": 1718133836, "time_this_iter_s": 29.64969801902771, "time_total_s": 15349.417265176773, "pid": 63446, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 261.3474304676056, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 48.89523809523809, "ram_util_percent": 13.859523809523807}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.041490749871526, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.363421069085598, "policy_loss": -0.019084017910063266, "vf_loss": 2.3634563773870467, "vf_explained_var": 0.5369367316365242, "kl": 0.018289847086028505, "entropy": -1.6264532734950383, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "sampler_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 299.06068662754035, "episode_reward_mean": 346.9058948080536, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837, 342.77504078602396, 340.4421890282811, 363.2233084130168, 354.33194500888817, 355.3796032936516, 346.2131525761825, 338.4705662264543, 354.0563207790294, 353.8175865391203, 358.8543105424049, 366.9800933124082, 333.601975374886, 348.1659617621157, 335.089043678277, 336.4325815132557, 343.2241575997363, 346.74785434050153, 355.4955390528246, 339.09545322549343, 341.3151387894809, 345.55441312961335, 365.9554945696822, 366.2338367133456, 341.0317019572303, 338.1988424565956, 339.64622025572896, 347.96873724143734, 357.8616261378385, 333.75951676353407, 353.59887641376497, 365.83008704784623, 343.15071214836814, 303.84134030833536, 351.96669827676794, 350.3724816119926, 349.3607259532794, 345.9228648130514, 339.11894399106245, 352.498351337072, 299.06068662754035, 329.3421245480746, 326.68532945248444], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.485295471019242, "mean_inference_ms": 1.3025242710203349, "mean_action_processing_ms": 0.21502734934710313, "mean_env_wait_ms": 364.84772567928366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012771899883563701, "StateBufferConnector_ms": 0.0061316367907401845, "ViewRequirementAgentConnector_ms": 0.17702487798837516}, "num_episodes": 6, "episode_return_max": 373.49257905669543, "episode_return_min": 299.06068662754035, "episode_return_mean": 346.9058948080536}, "env_runner_results": {"episode_reward_max": 373.49257905669543, "episode_reward_min": 299.06068662754035, "episode_reward_mean": 346.9058948080536, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837, 342.77504078602396, 340.4421890282811, 363.2233084130168, 354.33194500888817, 355.3796032936516, 346.2131525761825, 338.4705662264543, 354.0563207790294, 353.8175865391203, 358.8543105424049, 366.9800933124082, 333.601975374886, 348.1659617621157, 335.089043678277, 336.4325815132557, 343.2241575997363, 346.74785434050153, 355.4955390528246, 339.09545322549343, 341.3151387894809, 345.55441312961335, 365.9554945696822, 366.2338367133456, 341.0317019572303, 338.1988424565956, 339.64622025572896, 347.96873724143734, 357.8616261378385, 333.75951676353407, 353.59887641376497, 365.83008704784623, 343.15071214836814, 303.84134030833536, 351.96669827676794, 350.3724816119926, 349.3607259532794, 345.9228648130514, 339.11894399106245, 352.498351337072, 299.06068662754035, 329.3421245480746, 326.68532945248444], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.485295471019242, "mean_inference_ms": 1.3025242710203349, "mean_action_processing_ms": 0.21502734934710313, "mean_env_wait_ms": 364.84772567928366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012771899883563701, "StateBufferConnector_ms": 0.0061316367907401845, "ViewRequirementAgentConnector_ms": 0.17702487798837516}, "num_episodes": 6, "episode_return_max": 373.49257905669543, "episode_return_min": 299.06068662754035, "episode_return_mean": 346.9058948080536}, "episode_reward_max": 373.49257905669543, "episode_reward_min": 299.06068662754035, "episode_reward_mean": 346.9058948080536, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.3725055344223, 355.18564044306714, 358.1499475849931, 347.630780561144, 346.5034611678187, 335.5074942851144, 335.893779123037, 353.4521826665321, 342.6302258096522, 357.16933591727286, 362.14379651008164, 347.9564658730647, 373.49257905669543, 349.6279782127997, 342.9153975970511, 348.66271314935915, 369.92055321664174, 351.8809915238782, 323.18256158324016, 349.3309146792423, 359.02381945055544, 346.14270184965835, 335.73193029143005, 349.3250448326066, 344.68647877101165, 347.82342845999096, 353.9294258130806, 349.5574395279552, 353.7557819371321, 306.3323289018541, 352.6937528450036, 353.0798812822679, 353.7094662787855, 361.67157004543895, 351.0553930295344, 357.8606136200837, 342.77504078602396, 340.4421890282811, 363.2233084130168, 354.33194500888817, 355.3796032936516, 346.2131525761825, 338.4705662264543, 354.0563207790294, 353.8175865391203, 358.8543105424049, 366.9800933124082, 333.601975374886, 348.1659617621157, 335.089043678277, 336.4325815132557, 343.2241575997363, 346.74785434050153, 355.4955390528246, 339.09545322549343, 341.3151387894809, 345.55441312961335, 365.9554945696822, 366.2338367133456, 341.0317019572303, 338.1988424565956, 339.64622025572896, 347.96873724143734, 357.8616261378385, 333.75951676353407, 353.59887641376497, 365.83008704784623, 343.15071214836814, 303.84134030833536, 351.96669827676794, 350.3724816119926, 349.3607259532794, 345.9228648130514, 339.11894399106245, 352.498351337072, 299.06068662754035, 329.3421245480746, 326.68532945248444], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.485295471019242, "mean_inference_ms": 1.3025242710203349, "mean_action_processing_ms": 0.21502734934710313, "mean_env_wait_ms": 364.84772567928366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012771899883563701, "StateBufferConnector_ms": 0.0061316367907401845, "ViewRequirementAgentConnector_ms": 0.17702487798837516}, "num_episodes": 6, "episode_return_max": 373.49257905669543, "episode_return_min": 299.06068662754035, "episode_return_mean": 346.9058948080536, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 15.44893467986217, "num_env_steps_trained_throughput_per_sec": 15.44893467986217, "timesteps_total": 223320, "num_env_steps_sampled_lifetime": 223320, "num_agent_steps_sampled_lifetime": 223320, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 223320, "timers": {"training_iteration_time_ms": 36840.496, "restore_workers_time_ms": 0.021, "training_step_time_ms": 36840.432, "sample_time_ms": 36034.114, "load_time_ms": 1.177, "load_throughput": 438242.556, "learn_time_ms": 791.36, "learn_throughput": 652.042, "synch_weights_time_ms": 13.512}, "counters": {"num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "done": false, "episodes_total": 4649, "training_iteration": 177, "trial_id": "fd033_00000", "date": "2024-06-11_13-24-30", "timestamp": 1718133870, "time_this_iter_s": 33.404035329818726, "time_total_s": 15382.821300506592, "pid": 63446, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 294.7514657974243, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 42.68333333333334, "ram_util_percent": 13.204166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.041490749871526, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1917156050602595, "policy_loss": -0.0037216143682599068, "vf_loss": 2.1753686636686327, "vf_explained_var": 0.6668156305948894, "kl": 0.019269075635627526, "entropy": -1.7353113780419032, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 223836, "num_env_steps_trained": 223836, "num_agent_steps_sampled": 223836, "num_agent_steps_trained": 223836}, "sampler_results": {"episode_reward_max": 358.1637503741854, "episode_reward_min": 329.9985407145843, "episode_reward_mean": 343.0299064969134, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.287306376343942, "mean_inference_ms": 1.2953500638062925, "mean_action_processing_ms": 0.2142346225022356, "mean_env_wait_ms": 382.31672866134346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00959634780883789, "StateBufferConnector_ms": 0.006004174550374349, "ViewRequirementAgentConnector_ms": 0.17436345418294272}, "num_episodes": 6, "episode_return_max": 358.1637503741854, "episode_return_min": 329.9985407145843, "episode_return_mean": 343.0299064969134}, "env_runner_results": {"episode_reward_max": 358.1637503741854, "episode_reward_min": 329.9985407145843, "episode_reward_mean": 343.0299064969134, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.287306376343942, "mean_inference_ms": 1.2953500638062925, "mean_action_processing_ms": 0.2142346225022356, "mean_env_wait_ms": 382.31672866134346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00959634780883789, "StateBufferConnector_ms": 0.006004174550374349, "ViewRequirementAgentConnector_ms": 0.17436345418294272}, "num_episodes": 6, "episode_return_max": 358.1637503741854, "episode_return_min": 329.9985407145843, "episode_return_mean": 343.0299064969134}, "episode_reward_max": 358.1637503741854, "episode_reward_min": 329.9985407145843, "episode_reward_mean": 343.0299064969134, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.287306376343942, "mean_inference_ms": 1.2953500638062925, "mean_action_processing_ms": 0.2142346225022356, "mean_env_wait_ms": 382.31672866134346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00959634780883789, "StateBufferConnector_ms": 0.006004174550374349, "ViewRequirementAgentConnector_ms": 0.17436345418294272}, "num_episodes": 6, "episode_return_max": 358.1637503741854, "episode_return_min": 329.9985407145843, "episode_return_mean": 343.0299064969134, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223836, "num_agent_steps_trained": 223836, "num_env_steps_sampled": 223836, "num_env_steps_trained": 223836, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.827779561414488, "num_env_steps_trained_throughput_per_sec": 13.827779561414488, "timesteps_total": 223836, "num_env_steps_sampled_lifetime": 223836, "num_agent_steps_sampled_lifetime": 223836, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 223836, "timers": {"training_iteration_time_ms": 37316.202, "restore_workers_time_ms": 0.026, "training_step_time_ms": 37316.129, "sample_time_ms": 36422.597, "load_time_ms": 1.514, "load_throughput": 340828.483, "learn_time_ms": 877.656, "learn_throughput": 587.93, "synch_weights_time_ms": 13.91}, "counters": {"num_env_steps_sampled": 223836, "num_env_steps_trained": 223836, "num_agent_steps_sampled": 223836, "num_agent_steps_trained": 223836}, "done": false, "episodes_total": 4655, "training_iteration": 178, "trial_id": "fd033_00000", "date": "2024-06-11_13-25-27", "timestamp": 1718133927, "time_this_iter_s": 37.318995237350464, "time_total_s": 15420.140295743942, "pid": 23154, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 37.318995237350464, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.007407407407406, "ram_util_percent": 12.687037037037042}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.041490749871526, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.297547588745753, "policy_loss": -0.016747296523923674, "vf_loss": 2.296219477057457, "vf_explained_var": 0.6496241465210915, "kl": 0.017355318424719577, "entropy": -1.6997185409069062, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 224352, "num_env_steps_trained": 224352, "num_agent_steps_sampled": 224352, "num_agent_steps_trained": 224352}, "sampler_results": {"episode_reward_max": 363.5943814788376, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 345.7086105503275, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.041948893189572, "mean_inference_ms": 1.2967534031769874, "mean_action_processing_ms": 0.21421048829515715, "mean_env_wait_ms": 352.30352259128256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01272492938571506, "StateBufferConnector_ms": 0.006250540415445964, "ViewRequirementAgentConnector_ms": 0.1795013745625814}, "num_episodes": 12, "episode_return_max": 363.5943814788376, "episode_return_min": 319.93016848299715, "episode_return_mean": 345.7086105503275}, "env_runner_results": {"episode_reward_max": 363.5943814788376, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 345.7086105503275, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.041948893189572, "mean_inference_ms": 1.2967534031769874, "mean_action_processing_ms": 0.21421048829515715, "mean_env_wait_ms": 352.30352259128256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01272492938571506, "StateBufferConnector_ms": 0.006250540415445964, "ViewRequirementAgentConnector_ms": 0.1795013745625814}, "num_episodes": 12, "episode_return_max": 363.5943814788376, "episode_return_min": 319.93016848299715, "episode_return_mean": 345.7086105503275}, "episode_reward_max": 363.5943814788376, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 345.7086105503275, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.041948893189572, "mean_inference_ms": 1.2967534031769874, "mean_action_processing_ms": 0.21421048829515715, "mean_env_wait_ms": 352.30352259128256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01272492938571506, "StateBufferConnector_ms": 0.006250540415445964, "ViewRequirementAgentConnector_ms": 0.1795013745625814}, "num_episodes": 12, "episode_return_max": 363.5943814788376, "episode_return_min": 319.93016848299715, "episode_return_mean": 345.7086105503275, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224352, "num_agent_steps_trained": 224352, "num_env_steps_sampled": 224352, "num_env_steps_trained": 224352, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 17.65130953219351, "num_env_steps_trained_throughput_per_sec": 17.65130953219351, "timesteps_total": 224352, "num_env_steps_sampled_lifetime": 224352, "num_agent_steps_sampled_lifetime": 224352, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 224352, "timers": {"training_iteration_time_ms": 33274.587, "restore_workers_time_ms": 0.024, "training_step_time_ms": 33274.517, "sample_time_ms": 32417.863, "load_time_ms": 1.355, "load_throughput": 380730.207, "learn_time_ms": 841.179, "learn_throughput": 613.425, "synch_weights_time_ms": 13.75}, "counters": {"num_env_steps_sampled": 224352, "num_env_steps_trained": 224352, "num_agent_steps_sampled": 224352, "num_agent_steps_trained": 224352}, "done": false, "episodes_total": 4667, "training_iteration": 179, "trial_id": "fd033_00000", "date": "2024-06-11_13-25-57", "timestamp": 1718133957, "time_this_iter_s": 29.23629379272461, "time_total_s": 15449.376589536667, "pid": 23154, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 66.55528903007507, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 51.67142857142858, "ram_util_percent": 13.178571428571425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.041490749871526, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0539238288998605, "policy_loss": -0.010190263801875214, "vf_loss": 2.056152442594369, "vf_explained_var": 0.5410732706387837, "kl": 0.007644474429738752, "entropy": -1.8354291766881943, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 224868, "num_env_steps_trained": 224868, "num_agent_steps_sampled": 224868, "num_agent_steps_trained": 224868}, "sampler_results": {"episode_reward_max": 366.9594168833004, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 347.91608961018113, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.343716436241086, "mean_inference_ms": 1.2960736316002217, "mean_action_processing_ms": 0.21417176980070224, "mean_env_wait_ms": 349.848151209278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013489723205566406, "StateBufferConnector_ms": 0.006374518076578776, "ViewRequirementAgentConnector_ms": 0.1810296376546224}, "num_episodes": 12, "episode_return_max": 366.9594168833004, "episode_return_min": 319.93016848299715, "episode_return_mean": 347.91608961018113}, "env_runner_results": {"episode_reward_max": 366.9594168833004, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 347.91608961018113, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.343716436241086, "mean_inference_ms": 1.2960736316002217, "mean_action_processing_ms": 0.21417176980070224, "mean_env_wait_ms": 349.848151209278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013489723205566406, "StateBufferConnector_ms": 0.006374518076578776, "ViewRequirementAgentConnector_ms": 0.1810296376546224}, "num_episodes": 12, "episode_return_max": 366.9594168833004, "episode_return_min": 319.93016848299715, "episode_return_mean": 347.91608961018113}, "episode_reward_max": 366.9594168833004, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 347.91608961018113, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.343716436241086, "mean_inference_ms": 1.2960736316002217, "mean_action_processing_ms": 0.21417176980070224, "mean_env_wait_ms": 349.848151209278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013489723205566406, "StateBufferConnector_ms": 0.006374518076578776, "ViewRequirementAgentConnector_ms": 0.1810296376546224}, "num_episodes": 12, "episode_return_max": 366.9594168833004, "episode_return_min": 319.93016848299715, "episode_return_mean": 347.91608961018113, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224868, "num_agent_steps_trained": 224868, "num_env_steps_sampled": 224868, "num_env_steps_trained": 224868, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.528282372381197, "num_env_steps_trained_throughput_per_sec": 13.528282372381197, "timesteps_total": 224868, "num_env_steps_sampled_lifetime": 224868, "num_agent_steps_sampled_lifetime": 224868, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 224868, "timers": {"training_iteration_time_ms": 34897.167, "restore_workers_time_ms": 0.022, "training_step_time_ms": 34897.101, "sample_time_ms": 34051.951, "load_time_ms": 1.316, "load_throughput": 392170.971, "learn_time_ms": 829.838, "learn_throughput": 621.808, "synch_weights_time_ms": 13.665}, "counters": {"num_env_steps_sampled": 224868, "num_env_steps_trained": 224868, "num_agent_steps_sampled": 224868, "num_agent_steps_trained": 224868}, "done": false, "episodes_total": 4679, "training_iteration": 180, "trial_id": "fd033_00000", "date": "2024-06-11_13-26-35", "timestamp": 1718133995, "time_this_iter_s": 38.145606994628906, "time_total_s": 15487.522196531296, "pid": 23154, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 104.70089602470398, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.903703703703705, "ram_util_percent": 13.170370370370371}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.041490749871526, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.069476572175821, "policy_loss": -0.012040144018828868, "vf_loss": 2.064991954465707, "vf_explained_var": 0.2997702012459437, "kl": 0.01586643787838281, "entropy": -1.6621233681837717, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 225384, "num_env_steps_trained": 225384, "num_agent_steps_sampled": 225384, "num_agent_steps_trained": 225384}, "sampler_results": {"episode_reward_max": 366.9594168833004, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 347.29600011632886, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.358635019413407, "mean_inference_ms": 1.2959279599246143, "mean_action_processing_ms": 0.21426485042426904, "mean_env_wait_ms": 347.32745613453244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01415146721733941, "StateBufferConnector_ms": 0.006432665718926324, "ViewRequirementAgentConnector_ms": 0.1807199584113227}, "num_episodes": 6, "episode_return_max": 366.9594168833004, "episode_return_min": 319.93016848299715, "episode_return_mean": 347.29600011632886}, "env_runner_results": {"episode_reward_max": 366.9594168833004, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 347.29600011632886, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.358635019413407, "mean_inference_ms": 1.2959279599246143, "mean_action_processing_ms": 0.21426485042426904, "mean_env_wait_ms": 347.32745613453244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01415146721733941, "StateBufferConnector_ms": 0.006432665718926324, "ViewRequirementAgentConnector_ms": 0.1807199584113227}, "num_episodes": 6, "episode_return_max": 366.9594168833004, "episode_return_min": 319.93016848299715, "episode_return_mean": 347.29600011632886}, "episode_reward_max": 366.9594168833004, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 347.29600011632886, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.358635019413407, "mean_inference_ms": 1.2959279599246143, "mean_action_processing_ms": 0.21426485042426904, "mean_env_wait_ms": 347.32745613453244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01415146721733941, "StateBufferConnector_ms": 0.006432665718926324, "ViewRequirementAgentConnector_ms": 0.1807199584113227}, "num_episodes": 6, "episode_return_max": 366.9594168833004, "episode_return_min": 319.93016848299715, "episode_return_mean": 347.29600011632886, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225384, "num_agent_steps_trained": 225384, "num_env_steps_sampled": 225384, "num_env_steps_trained": 225384, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 17.189021926172153, "num_env_steps_trained_throughput_per_sec": 17.189021926172153, "timesteps_total": 225384, "num_env_steps_sampled_lifetime": 225384, "num_agent_steps_sampled_lifetime": 225384, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 225384, "timers": {"training_iteration_time_ms": 33677.669, "restore_workers_time_ms": 0.023, "training_step_time_ms": 33677.601, "sample_time_ms": 32852.582, "load_time_ms": 1.289, "load_throughput": 400436.813, "learn_time_ms": 809.736, "learn_throughput": 637.244, "synch_weights_time_ms": 13.674}, "counters": {"num_env_steps_sampled": 225384, "num_env_steps_trained": 225384, "num_agent_steps_sampled": 225384, "num_agent_steps_trained": 225384}, "done": false, "episodes_total": 4685, "training_iteration": 181, "trial_id": "fd033_00000", "date": "2024-06-11_13-27-05", "timestamp": 1718134025, "time_this_iter_s": 30.022705554962158, "time_total_s": 15517.544902086258, "pid": 23154, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 134.72360157966614, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 48.33720930232558, "ram_util_percent": 13.009302325581395}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.041490749871526, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.741414794822534, "policy_loss": -0.010215574378768603, "vf_loss": 1.7427894562482833, "vf_explained_var": 0.23540139148632686, "kl": 0.008488702613492416, "entropy": -1.7711789349714915, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 225900, "num_env_steps_trained": 225900, "num_agent_steps_sampled": 225900, "num_agent_steps_trained": 225900}, "sampler_results": {"episode_reward_max": 367.60699294006736, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 348.05231945483234, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827, 345.24979409769634, 345.5066927407373, 339.674083108279, 353.16399247039095, 367.60699294006736, 347.1032050103439, 357.11307539343323, 349.58442677949307, 350.8959724347676, 351.0647663561483, 353.16013864991515, 343.73218966284736], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.432305605486697, "mean_inference_ms": 1.2952764132527048, "mean_action_processing_ms": 0.21432656858992546, "mean_env_wait_ms": 343.80392566505435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01418242851893107, "StateBufferConnector_ms": 0.006434321403503418, "ViewRequirementAgentConnector_ms": 0.1802171270052592}, "num_episodes": 12, "episode_return_max": 367.60699294006736, "episode_return_min": 319.93016848299715, "episode_return_mean": 348.05231945483234}, "env_runner_results": {"episode_reward_max": 367.60699294006736, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 348.05231945483234, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827, 345.24979409769634, 345.5066927407373, 339.674083108279, 353.16399247039095, 367.60699294006736, 347.1032050103439, 357.11307539343323, 349.58442677949307, 350.8959724347676, 351.0647663561483, 353.16013864991515, 343.73218966284736], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.432305605486697, "mean_inference_ms": 1.2952764132527048, "mean_action_processing_ms": 0.21432656858992546, "mean_env_wait_ms": 343.80392566505435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01418242851893107, "StateBufferConnector_ms": 0.006434321403503418, "ViewRequirementAgentConnector_ms": 0.1802171270052592}, "num_episodes": 12, "episode_return_max": 367.60699294006736, "episode_return_min": 319.93016848299715, "episode_return_mean": 348.05231945483234}, "episode_reward_max": 367.60699294006736, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 348.05231945483234, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827, 345.24979409769634, 345.5066927407373, 339.674083108279, 353.16399247039095, 367.60699294006736, 347.1032050103439, 357.11307539343323, 349.58442677949307, 350.8959724347676, 351.0647663561483, 353.16013864991515, 343.73218966284736], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.432305605486697, "mean_inference_ms": 1.2952764132527048, "mean_action_processing_ms": 0.21432656858992546, "mean_env_wait_ms": 343.80392566505435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01418242851893107, "StateBufferConnector_ms": 0.006434321403503418, "ViewRequirementAgentConnector_ms": 0.1802171270052592}, "num_episodes": 12, "episode_return_max": 367.60699294006736, "episode_return_min": 319.93016848299715, "episode_return_mean": 348.05231945483234, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225900, "num_agent_steps_trained": 225900, "num_env_steps_sampled": 225900, "num_env_steps_trained": 225900, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.543878868335797, "num_env_steps_trained_throughput_per_sec": 13.543878868335797, "timesteps_total": 225900, "num_env_steps_sampled_lifetime": 225900, "num_agent_steps_sampled_lifetime": 225900, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 225900, "timers": {"training_iteration_time_ms": 34561.817, "restore_workers_time_ms": 0.022, "training_step_time_ms": 34561.751, "sample_time_ms": 33748.359, "load_time_ms": 1.226, "load_throughput": 420915.023, "learn_time_ms": 798.185, "learn_throughput": 646.466, "synch_weights_time_ms": 13.67}, "counters": {"num_env_steps_sampled": 225900, "num_env_steps_trained": 225900, "num_agent_steps_sampled": 225900, "num_agent_steps_trained": 225900}, "done": false, "episodes_total": 4697, "training_iteration": 182, "trial_id": "fd033_00000", "date": "2024-06-11_13-27-43", "timestamp": 1718134063, "time_this_iter_s": 38.10185647010803, "time_total_s": 15555.646758556366, "pid": 23154, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 172.82545804977417, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.574074074074076, "ram_util_percent": 13.601851851851855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.041490749871526, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7400709281365077, "policy_loss": -0.00670196283608675, "vf_loss": 1.7305981993675232, "vf_explained_var": 0.11205377082029978, "kl": 0.015530338104388173, "entropy": -1.8814037283261618, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 226416, "num_env_steps_trained": 226416, "num_agent_steps_sampled": 226416, "num_agent_steps_trained": 226416}, "sampler_results": {"episode_reward_max": 367.60699294006736, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 348.6584545598858, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827, 345.24979409769634, 345.5066927407373, 339.674083108279, 353.16399247039095, 367.60699294006736, 347.1032050103439, 357.11307539343323, 349.58442677949307, 350.8959724347676, 351.0647663561483, 353.16013864991515, 343.73218966284736, 345.98125362385053, 352.7840565193602, 355.78628006492244, 351.5048158533623, 346.54510613537775, 354.77720840190943, 352.1790118262225, 343.7436030252398, 349.12195691955094, 347.29928063021015, 356.93785548561215, 356.3355112755746], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.504927889520655, "mean_inference_ms": 1.2945611114943427, "mean_action_processing_ms": 0.21437547695959142, "mean_env_wait_ms": 341.0026899280246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014139811197916666, "StateBufferConnector_ms": 0.006344715754191081, "ViewRequirementAgentConnector_ms": 0.17980138460795084}, "num_episodes": 12, "episode_return_max": 367.60699294006736, "episode_return_min": 319.93016848299715, "episode_return_mean": 348.6584545598858}, "env_runner_results": {"episode_reward_max": 367.60699294006736, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 348.6584545598858, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827, 345.24979409769634, 345.5066927407373, 339.674083108279, 353.16399247039095, 367.60699294006736, 347.1032050103439, 357.11307539343323, 349.58442677949307, 350.8959724347676, 351.0647663561483, 353.16013864991515, 343.73218966284736, 345.98125362385053, 352.7840565193602, 355.78628006492244, 351.5048158533623, 346.54510613537775, 354.77720840190943, 352.1790118262225, 343.7436030252398, 349.12195691955094, 347.29928063021015, 356.93785548561215, 356.3355112755746], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.504927889520655, "mean_inference_ms": 1.2945611114943427, "mean_action_processing_ms": 0.21437547695959142, "mean_env_wait_ms": 341.0026899280246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014139811197916666, "StateBufferConnector_ms": 0.006344715754191081, "ViewRequirementAgentConnector_ms": 0.17980138460795084}, "num_episodes": 12, "episode_return_max": 367.60699294006736, "episode_return_min": 319.93016848299715, "episode_return_mean": 348.6584545598858}, "episode_reward_max": 367.60699294006736, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 348.6584545598858, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827, 345.24979409769634, 345.5066927407373, 339.674083108279, 353.16399247039095, 367.60699294006736, 347.1032050103439, 357.11307539343323, 349.58442677949307, 350.8959724347676, 351.0647663561483, 353.16013864991515, 343.73218966284736, 345.98125362385053, 352.7840565193602, 355.78628006492244, 351.5048158533623, 346.54510613537775, 354.77720840190943, 352.1790118262225, 343.7436030252398, 349.12195691955094, 347.29928063021015, 356.93785548561215, 356.3355112755746], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.504927889520655, "mean_inference_ms": 1.2945611114943427, "mean_action_processing_ms": 0.21437547695959142, "mean_env_wait_ms": 341.0026899280246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014139811197916666, "StateBufferConnector_ms": 0.006344715754191081, "ViewRequirementAgentConnector_ms": 0.17980138460795084}, "num_episodes": 12, "episode_return_max": 367.60699294006736, "episode_return_min": 319.93016848299715, "episode_return_mean": 348.6584545598858, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226416, "num_agent_steps_trained": 226416, "num_env_steps_sampled": 226416, "num_env_steps_trained": 226416, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 16.443195678714158, "num_env_steps_trained_throughput_per_sec": 16.443195678714158, "timesteps_total": 226416, "num_env_steps_sampled_lifetime": 226416, "num_agent_steps_sampled_lifetime": 226416, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 226416, "timers": {"training_iteration_time_ms": 34031.643, "restore_workers_time_ms": 0.021, "training_step_time_ms": 34031.58, "sample_time_ms": 33223.207, "load_time_ms": 1.203, "load_throughput": 428991.252, "learn_time_ms": 793.224, "learn_throughput": 650.509, "synch_weights_time_ms": 13.644}, "counters": {"num_env_steps_sampled": 226416, "num_env_steps_trained": 226416, "num_agent_steps_sampled": 226416, "num_agent_steps_trained": 226416}, "done": false, "episodes_total": 4709, "training_iteration": 183, "trial_id": "fd033_00000", "date": "2024-06-11_13-28-14", "timestamp": 1718134094, "time_this_iter_s": 31.384546518325806, "time_total_s": 15587.031305074692, "pid": 23154, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 204.21000456809998, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 45.81555555555555, "ram_util_percent": 13.128888888888886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.041490749871526, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9140705645084382, "policy_loss": -0.007647970877587795, "vf_loss": 1.9115221182505289, "vf_explained_var": 0.4398950546979904, "kl": 0.00979020589293292, "entropy": -1.725123044848442, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 226932, "num_env_steps_trained": 226932, "num_agent_steps_sampled": 226932, "num_agent_steps_trained": 226932}, "sampler_results": {"episode_reward_max": 367.60699294006736, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 348.5193728973136, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827, 345.24979409769634, 345.5066927407373, 339.674083108279, 353.16399247039095, 367.60699294006736, 347.1032050103439, 357.11307539343323, 349.58442677949307, 350.8959724347676, 351.0647663561483, 353.16013864991515, 343.73218966284736, 345.98125362385053, 352.7840565193602, 355.78628006492244, 351.5048158533623, 346.54510613537775, 354.77720840190943, 352.1790118262225, 343.7436030252398, 349.12195691955094, 347.29928063021015, 356.93785548561215, 356.3355112755746, 352.37332768839167, 336.2594090044607, 353.48041883025724, 355.1232612842787, 327.39854978799985, 347.4024590026975, 355.93477330820724, 342.80848406583215, 351.9328054662353, 356.26505843625387, 340.9679264110295, 353.9411017277861], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5687049585031705, "mean_inference_ms": 1.2939604923397583, "mean_action_processing_ms": 0.21441305940236902, "mean_env_wait_ms": 340.8677252759668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013552109400431315, "StateBufferConnector_ms": 0.00635120603773329, "ViewRequirementAgentConnector_ms": 0.18062757121192086}, "num_episodes": 12, "episode_return_max": 367.60699294006736, "episode_return_min": 319.93016848299715, "episode_return_mean": 348.5193728973136}, "env_runner_results": {"episode_reward_max": 367.60699294006736, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 348.5193728973136, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827, 345.24979409769634, 345.5066927407373, 339.674083108279, 353.16399247039095, 367.60699294006736, 347.1032050103439, 357.11307539343323, 349.58442677949307, 350.8959724347676, 351.0647663561483, 353.16013864991515, 343.73218966284736, 345.98125362385053, 352.7840565193602, 355.78628006492244, 351.5048158533623, 346.54510613537775, 354.77720840190943, 352.1790118262225, 343.7436030252398, 349.12195691955094, 347.29928063021015, 356.93785548561215, 356.3355112755746, 352.37332768839167, 336.2594090044607, 353.48041883025724, 355.1232612842787, 327.39854978799985, 347.4024590026975, 355.93477330820724, 342.80848406583215, 351.9328054662353, 356.26505843625387, 340.9679264110295, 353.9411017277861], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5687049585031705, "mean_inference_ms": 1.2939604923397583, "mean_action_processing_ms": 0.21441305940236902, "mean_env_wait_ms": 340.8677252759668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013552109400431315, "StateBufferConnector_ms": 0.00635120603773329, "ViewRequirementAgentConnector_ms": 0.18062757121192086}, "num_episodes": 12, "episode_return_max": 367.60699294006736, "episode_return_min": 319.93016848299715, "episode_return_mean": 348.5193728973136}, "episode_reward_max": 367.60699294006736, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 348.5193728973136, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 3600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827, 345.24979409769634, 345.5066927407373, 339.674083108279, 353.16399247039095, 367.60699294006736, 347.1032050103439, 357.11307539343323, 349.58442677949307, 350.8959724347676, 351.0647663561483, 353.16013864991515, 343.73218966284736, 345.98125362385053, 352.7840565193602, 355.78628006492244, 351.5048158533623, 346.54510613537775, 354.77720840190943, 352.1790118262225, 343.7436030252398, 349.12195691955094, 347.29928063021015, 356.93785548561215, 356.3355112755746, 352.37332768839167, 336.2594090044607, 353.48041883025724, 355.1232612842787, 327.39854978799985, 347.4024590026975, 355.93477330820724, 342.80848406583215, 351.9328054662353, 356.26505843625387, 340.9679264110295, 353.9411017277861], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5687049585031705, "mean_inference_ms": 1.2939604923397583, "mean_action_processing_ms": 0.21441305940236902, "mean_env_wait_ms": 340.8677252759668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013552109400431315, "StateBufferConnector_ms": 0.00635120603773329, "ViewRequirementAgentConnector_ms": 0.18062757121192086}, "num_episodes": 12, "episode_return_max": 367.60699294006736, "episode_return_min": 319.93016848299715, "episode_return_mean": 348.5193728973136, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226932, "num_agent_steps_trained": 226932, "num_env_steps_sampled": 226932, "num_env_steps_trained": 226932, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.225497800685767, "num_env_steps_trained_throughput_per_sec": 13.225497800685767, "timesteps_total": 226932, "num_env_steps_sampled_lifetime": 226932, "num_agent_steps_sampled_lifetime": 226932, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 226932, "timers": {"training_iteration_time_ms": 34743.631, "restore_workers_time_ms": 0.022, "training_step_time_ms": 34743.568, "sample_time_ms": 33938.991, "load_time_ms": 1.185, "load_throughput": 435402.387, "learn_time_ms": 789.515, "learn_throughput": 653.566, "synch_weights_time_ms": 13.589}, "counters": {"num_env_steps_sampled": 226932, "num_env_steps_trained": 226932, "num_agent_steps_sampled": 226932, "num_agent_steps_trained": 226932}, "done": false, "episodes_total": 4721, "training_iteration": 184, "trial_id": "fd033_00000", "date": "2024-06-11_13-28-53", "timestamp": 1718134133, "time_this_iter_s": 39.01939582824707, "time_total_s": 15626.050700902939, "pid": 23154, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 243.22940039634705, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 39.767857142857146, "ram_util_percent": 13.692857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.041490749871526, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0155202488104504, "policy_loss": -0.012384963035583497, "vf_loss": 2.0232216984033586, "vf_explained_var": 0.3858515833814939, "kl": 0.004496925580315974, "entropy": -1.6914177229007086, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 227448, "num_env_steps_trained": 227448, "num_agent_steps_sampled": 227448, "num_agent_steps_trained": 227448}, "sampler_results": {"episode_reward_max": 367.60699294006736, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 347.9796666661592, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827, 345.24979409769634, 345.5066927407373, 339.674083108279, 353.16399247039095, 367.60699294006736, 347.1032050103439, 357.11307539343323, 349.58442677949307, 350.8959724347676, 351.0647663561483, 353.16013864991515, 343.73218966284736, 345.98125362385053, 352.7840565193602, 355.78628006492244, 351.5048158533623, 346.54510613537775, 354.77720840190943, 352.1790118262225, 343.7436030252398, 349.12195691955094, 347.29928063021015, 356.93785548561215, 356.3355112755746, 352.37332768839167, 336.2594090044607, 353.48041883025724, 355.1232612842787, 327.39854978799985, 347.4024590026975, 355.93477330820724, 342.80848406583215, 351.9328054662353, 356.26505843625387, 340.9679264110295, 353.9411017277861, 347.90589383834066, 333.397802924296, 347.10251842696476, 346.16901870067403, 340.1195553419705, 334.3243621215884], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.577860686721591, "mean_inference_ms": 1.2936711443762714, "mean_action_processing_ms": 0.21442168710592938, "mean_env_wait_ms": 341.3349142493059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013341964819492439, "StateBufferConnector_ms": 0.0063663873917017225, "ViewRequirementAgentConnector_ms": 0.18109572239411184}, "num_episodes": 6, "episode_return_max": 367.60699294006736, "episode_return_min": 319.93016848299715, "episode_return_mean": 347.9796666661592}, "env_runner_results": {"episode_reward_max": 367.60699294006736, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 347.9796666661592, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827, 345.24979409769634, 345.5066927407373, 339.674083108279, 353.16399247039095, 367.60699294006736, 347.1032050103439, 357.11307539343323, 349.58442677949307, 350.8959724347676, 351.0647663561483, 353.16013864991515, 343.73218966284736, 345.98125362385053, 352.7840565193602, 355.78628006492244, 351.5048158533623, 346.54510613537775, 354.77720840190943, 352.1790118262225, 343.7436030252398, 349.12195691955094, 347.29928063021015, 356.93785548561215, 356.3355112755746, 352.37332768839167, 336.2594090044607, 353.48041883025724, 355.1232612842787, 327.39854978799985, 347.4024590026975, 355.93477330820724, 342.80848406583215, 351.9328054662353, 356.26505843625387, 340.9679264110295, 353.9411017277861, 347.90589383834066, 333.397802924296, 347.10251842696476, 346.16901870067403, 340.1195553419705, 334.3243621215884], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.577860686721591, "mean_inference_ms": 1.2936711443762714, "mean_action_processing_ms": 0.21442168710592938, "mean_env_wait_ms": 341.3349142493059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013341964819492439, "StateBufferConnector_ms": 0.0063663873917017225, "ViewRequirementAgentConnector_ms": 0.18109572239411184}, "num_episodes": 6, "episode_return_max": 367.60699294006736, "episode_return_min": 319.93016848299715, "episode_return_mean": 347.9796666661592}, "episode_reward_max": 367.60699294006736, "episode_reward_min": 319.93016848299715, "episode_reward_mean": 347.9796666661592, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [329.9985407145843, 358.1637503741854, 330.32692911519297, 356.10594943959643, 352.83609317983576, 330.74817615808547, 356.6601636954576, 339.1847700273615, 338.45672823098795, 349.823968540495, 363.5943814788376, 341.58964441659697, 334.1254183164187, 348.11545822772973, 359.40514837787725, 358.5508127725832, 319.93016848299715, 355.1388883570719, 350.8893537042825, 345.60990722264, 361.0946631494208, 353.22028338143684, 344.6324549371005, 350.48222817747796, 366.9594168833004, 346.71086094137837, 331.2149059074447, 364.21218024570305, 346.8439735416404, 352.8574703077139, 329.60991239572246, 346.60311559124693, 351.3448657283763, 349.4026726866182, 348.954735732229, 339.25801374820827, 345.24979409769634, 345.5066927407373, 339.674083108279, 353.16399247039095, 367.60699294006736, 347.1032050103439, 357.11307539343323, 349.58442677949307, 350.8959724347676, 351.0647663561483, 353.16013864991515, 343.73218966284736, 345.98125362385053, 352.7840565193602, 355.78628006492244, 351.5048158533623, 346.54510613537775, 354.77720840190943, 352.1790118262225, 343.7436030252398, 349.12195691955094, 347.29928063021015, 356.93785548561215, 356.3355112755746, 352.37332768839167, 336.2594090044607, 353.48041883025724, 355.1232612842787, 327.39854978799985, 347.4024590026975, 355.93477330820724, 342.80848406583215, 351.9328054662353, 356.26505843625387, 340.9679264110295, 353.9411017277861, 347.90589383834066, 333.397802924296, 347.10251842696476, 346.16901870067403, 340.1195553419705, 334.3243621215884], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.577860686721591, "mean_inference_ms": 1.2936711443762714, "mean_action_processing_ms": 0.21442168710592938, "mean_env_wait_ms": 341.3349142493059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013341964819492439, "StateBufferConnector_ms": 0.0063663873917017225, "ViewRequirementAgentConnector_ms": 0.18109572239411184}, "num_episodes": 6, "episode_return_max": 367.60699294006736, "episode_return_min": 319.93016848299715, "episode_return_mean": 347.9796666661592, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227448, "num_agent_steps_trained": 227448, "num_env_steps_sampled": 227448, "num_env_steps_trained": 227448, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.423537048190154, "num_env_steps_trained_throughput_per_sec": 13.423537048190154, "timesteps_total": 227448, "num_env_steps_sampled_lifetime": 227448, "num_agent_steps_sampled_lifetime": 227448, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 227448, "timers": {"training_iteration_time_ms": 35205.672, "restore_workers_time_ms": 0.022, "training_step_time_ms": 35205.61, "sample_time_ms": 34404.552, "load_time_ms": 1.175, "load_throughput": 439232.018, "learn_time_ms": 786.026, "learn_throughput": 656.467, "synch_weights_time_ms": 13.569}, "counters": {"num_env_steps_sampled": 227448, "num_env_steps_trained": 227448, "num_agent_steps_sampled": 227448, "num_agent_steps_trained": 227448}, "done": false, "episodes_total": 4727, "training_iteration": 185, "trial_id": "fd033_00000", "date": "2024-06-11_13-29-32", "timestamp": 1718134172, "time_this_iter_s": 38.44882416725159, "time_total_s": 15664.49952507019, "pid": 23154, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 281.67822456359863, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 38.78545454545454, "ram_util_percent": 13.872727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.520745374935763, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.891543128589789, "policy_loss": -0.006823226111009717, "vf_loss": 1.887384320795536, "vf_explained_var": 0.6038103704651197, "kl": 0.02108905432299626, "entropy": -1.6790694018205008, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 227964, "num_env_steps_trained": 227964, "num_agent_steps_sampled": 227964, "num_agent_steps_trained": 227964}, "sampler_results": {"episode_reward_max": 354.7107156853635, "episode_reward_min": 336.45196594041107, "episode_reward_mean": 345.77775611213383, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.280830708500069, "mean_inference_ms": 1.3141568136397905, "mean_action_processing_ms": 0.2174628648721395, "mean_env_wait_ms": 292.3670294641078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010101000467936197, "StateBufferConnector_ms": 0.007108847300211589, "ViewRequirementAgentConnector_ms": 0.17495950063069662}, "num_episodes": 6, "episode_return_max": 354.7107156853635, "episode_return_min": 336.45196594041107, "episode_return_mean": 345.77775611213383}, "env_runner_results": {"episode_reward_max": 354.7107156853635, "episode_reward_min": 336.45196594041107, "episode_reward_mean": 345.77775611213383, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.280830708500069, "mean_inference_ms": 1.3141568136397905, "mean_action_processing_ms": 0.2174628648721395, "mean_env_wait_ms": 292.3670294641078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010101000467936197, "StateBufferConnector_ms": 0.007108847300211589, "ViewRequirementAgentConnector_ms": 0.17495950063069662}, "num_episodes": 6, "episode_return_max": 354.7107156853635, "episode_return_min": 336.45196594041107, "episode_return_mean": 345.77775611213383}, "episode_reward_max": 354.7107156853635, "episode_reward_min": 336.45196594041107, "episode_reward_mean": 345.77775611213383, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.280830708500069, "mean_inference_ms": 1.3141568136397905, "mean_action_processing_ms": 0.2174628648721395, "mean_env_wait_ms": 292.3670294641078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010101000467936197, "StateBufferConnector_ms": 0.007108847300211589, "ViewRequirementAgentConnector_ms": 0.17495950063069662}, "num_episodes": 6, "episode_return_max": 354.7107156853635, "episode_return_min": 336.45196594041107, "episode_return_mean": 345.77775611213383, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227964, "num_agent_steps_trained": 227964, "num_env_steps_sampled": 227964, "num_env_steps_trained": 227964, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 17.700352500433663, "num_env_steps_trained_throughput_per_sec": 17.700352500433663, "timesteps_total": 227964, "num_env_steps_sampled_lifetime": 227964, "num_agent_steps_sampled_lifetime": 227964, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 227964, "timers": {"training_iteration_time_ms": 29151.976, "restore_workers_time_ms": 0.021, "training_step_time_ms": 29151.909, "sample_time_ms": 28217.422, "load_time_ms": 1.46, "load_throughput": 353406.411, "learn_time_ms": 918.543, "learn_throughput": 561.759, "synch_weights_time_ms": 14.021}, "counters": {"num_env_steps_sampled": 227964, "num_env_steps_trained": 227964, "num_agent_steps_sampled": 227964, "num_agent_steps_trained": 227964}, "done": false, "episodes_total": 4733, "training_iteration": 186, "trial_id": "fd033_00000", "date": "2024-06-11_13-30-57", "timestamp": 1718134257, "time_this_iter_s": 29.155125379562378, "time_total_s": 15693.654650449753, "pid": 90436, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 29.155125379562378, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 48.595238095238095, "ram_util_percent": 13.100000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7811180624036443, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8662344152728716, "policy_loss": -0.020942068565636872, "vf_loss": 1.8812426880002022, "vf_explained_var": 0.6328616534670194, "kl": 0.007596536922696236, "entropy": -1.7774676789840063, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 228480, "num_env_steps_trained": 228480, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 228480}, "sampler_results": {"episode_reward_max": 362.69862613171426, "episode_reward_min": 332.77939435851493, "episode_reward_mean": 347.1798027772794, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.999646283590732, "mean_inference_ms": 1.3087396187527747, "mean_action_processing_ms": 0.2161771551198423, "mean_env_wait_ms": 321.99078341157474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012845463222927518, "StateBufferConnector_ms": 0.006949901580810547, "ViewRequirementAgentConnector_ms": 0.17485353681776258}, "num_episodes": 12, "episode_return_max": 362.69862613171426, "episode_return_min": 332.77939435851493, "episode_return_mean": 347.1798027772794}, "env_runner_results": {"episode_reward_max": 362.69862613171426, "episode_reward_min": 332.77939435851493, "episode_reward_mean": 347.1798027772794, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.999646283590732, "mean_inference_ms": 1.3087396187527747, "mean_action_processing_ms": 0.2161771551198423, "mean_env_wait_ms": 321.99078341157474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012845463222927518, "StateBufferConnector_ms": 0.006949901580810547, "ViewRequirementAgentConnector_ms": 0.17485353681776258}, "num_episodes": 12, "episode_return_max": 362.69862613171426, "episode_return_min": 332.77939435851493, "episode_return_mean": 347.1798027772794}, "episode_reward_max": 362.69862613171426, "episode_reward_min": 332.77939435851493, "episode_reward_mean": 347.1798027772794, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.999646283590732, "mean_inference_ms": 1.3087396187527747, "mean_action_processing_ms": 0.2161771551198423, "mean_env_wait_ms": 321.99078341157474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012845463222927518, "StateBufferConnector_ms": 0.006949901580810547, "ViewRequirementAgentConnector_ms": 0.17485353681776258}, "num_episodes": 12, "episode_return_max": 362.69862613171426, "episode_return_min": 332.77939435851493, "episode_return_mean": 347.1798027772794, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 228480, "num_env_steps_sampled": 228480, "num_env_steps_trained": 228480, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.09624329267572, "num_env_steps_trained_throughput_per_sec": 14.09624329267572, "timesteps_total": 228480, "num_env_steps_sampled_lifetime": 228480, "num_agent_steps_sampled_lifetime": 228480, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 228480, "timers": {"training_iteration_time_ms": 32878.744, "restore_workers_time_ms": 0.021, "training_step_time_ms": 32878.675, "sample_time_ms": 32028.854, "load_time_ms": 1.32, "load_throughput": 390801.889, "learn_time_ms": 834.115, "learn_throughput": 618.62, "synch_weights_time_ms": 14.006}, "counters": {"num_env_steps_sampled": 228480, "num_env_steps_trained": 228480, "num_agent_steps_sampled": 228480, "num_agent_steps_trained": 228480}, "done": false, "episodes_total": 4745, "training_iteration": 187, "trial_id": "fd033_00000", "date": "2024-06-11_13-31-34", "timestamp": 1718134294, "time_this_iter_s": 36.60889530181885, "time_total_s": 15730.263545751572, "pid": 90436, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 65.76402068138123, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.36923076923077, "ram_util_percent": 13.669230769230772}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7811180624036443, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.684539679189523, "policy_loss": -0.010844919458031654, "vf_loss": 1.692425430814425, "vf_explained_var": 0.6966664279500644, "kl": 0.0037883659975098756, "entropy": -1.713940449555715, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 228996, "num_env_steps_trained": 228996, "num_agent_steps_sampled": 228996, "num_agent_steps_trained": 228996}, "sampler_results": {"episode_reward_max": 362.69862613171426, "episode_reward_min": 327.6172641261566, "episode_reward_mean": 346.3851399976246, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2827282063617815, "mean_inference_ms": 1.307399606613219, "mean_action_processing_ms": 0.2159760154004351, "mean_env_wait_ms": 323.5315430919857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013361771901448568, "StateBufferConnector_ms": 0.006833871205647786, "ViewRequirementAgentConnector_ms": 0.17454942067464194}, "num_episodes": 12, "episode_return_max": 362.69862613171426, "episode_return_min": 327.6172641261566, "episode_return_mean": 346.3851399976246}, "env_runner_results": {"episode_reward_max": 362.69862613171426, "episode_reward_min": 327.6172641261566, "episode_reward_mean": 346.3851399976246, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2827282063617815, "mean_inference_ms": 1.307399606613219, "mean_action_processing_ms": 0.2159760154004351, "mean_env_wait_ms": 323.5315430919857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013361771901448568, "StateBufferConnector_ms": 0.006833871205647786, "ViewRequirementAgentConnector_ms": 0.17454942067464194}, "num_episodes": 12, "episode_return_max": 362.69862613171426, "episode_return_min": 327.6172641261566, "episode_return_mean": 346.3851399976246}, "episode_reward_max": 362.69862613171426, "episode_reward_min": 327.6172641261566, "episode_reward_mean": 346.3851399976246, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.2827282063617815, "mean_inference_ms": 1.307399606613219, "mean_action_processing_ms": 0.2159760154004351, "mean_env_wait_ms": 323.5315430919857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013361771901448568, "StateBufferConnector_ms": 0.006833871205647786, "ViewRequirementAgentConnector_ms": 0.17454942067464194}, "num_episodes": 12, "episode_return_max": 362.69862613171426, "episode_return_min": 327.6172641261566, "episode_return_mean": 346.3851399976246, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228996, "num_agent_steps_trained": 228996, "num_env_steps_sampled": 228996, "num_env_steps_trained": 228996, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 17.28970455568267, "num_env_steps_trained_throughput_per_sec": 17.28970455568267, "timesteps_total": 228996, "num_env_steps_sampled_lifetime": 228996, "num_agent_steps_sampled_lifetime": 228996, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 228996, "timers": {"training_iteration_time_ms": 31867.285, "restore_workers_time_ms": 0.021, "training_step_time_ms": 31867.217, "sample_time_ms": 31033.07, "load_time_ms": 1.305, "load_throughput": 395491.417, "learn_time_ms": 818.616, "learn_throughput": 630.332, "synch_weights_time_ms": 13.891}, "counters": {"num_env_steps_sampled": 228996, "num_env_steps_trained": 228996, "num_agent_steps_sampled": 228996, "num_agent_steps_trained": 228996}, "done": false, "episodes_total": 4757, "training_iteration": 188, "trial_id": "fd033_00000", "date": "2024-06-11_13-32-04", "timestamp": 1718134324, "time_this_iter_s": 29.847419261932373, "time_total_s": 15760.110965013504, "pid": 90436, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 95.6114399433136, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 50.04186046511629, "ram_util_percent": 13.839534883720932}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.39055903120182217, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6960204695661862, "policy_loss": -0.014372460326800745, "vf_loss": 1.70740923533837, "vf_explained_var": 0.13769952555497486, "kl": 0.00763951686017208, "entropy": -1.5762227296829223, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 229512, "num_env_steps_trained": 229512, "num_agent_steps_sampled": 229512, "num_agent_steps_trained": 229512}, "sampler_results": {"episode_reward_max": 362.69862613171426, "episode_reward_min": 327.6172641261566, "episode_reward_mean": 346.36852791957403, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.28938194950921, "mean_inference_ms": 1.3067319578600045, "mean_action_processing_ms": 0.21593992694440484, "mean_env_wait_ms": 325.838827031626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014270014233059354, "StateBufferConnector_ms": 0.006867117351955838, "ViewRequirementAgentConnector_ms": 0.17637809117635092}, "num_episodes": 6, "episode_return_max": 362.69862613171426, "episode_return_min": 327.6172641261566, "episode_return_mean": 346.36852791957403}, "env_runner_results": {"episode_reward_max": 362.69862613171426, "episode_reward_min": 327.6172641261566, "episode_reward_mean": 346.36852791957403, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.28938194950921, "mean_inference_ms": 1.3067319578600045, "mean_action_processing_ms": 0.21593992694440484, "mean_env_wait_ms": 325.838827031626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014270014233059354, "StateBufferConnector_ms": 0.006867117351955838, "ViewRequirementAgentConnector_ms": 0.17637809117635092}, "num_episodes": 6, "episode_return_max": 362.69862613171426, "episode_return_min": 327.6172641261566, "episode_return_mean": 346.36852791957403}, "episode_reward_max": 362.69862613171426, "episode_reward_min": 327.6172641261566, "episode_reward_mean": 346.36852791957403, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.28938194950921, "mean_inference_ms": 1.3067319578600045, "mean_action_processing_ms": 0.21593992694440484, "mean_env_wait_ms": 325.838827031626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014270014233059354, "StateBufferConnector_ms": 0.006867117351955838, "ViewRequirementAgentConnector_ms": 0.17637809117635092}, "num_episodes": 6, "episode_return_max": 362.69862613171426, "episode_return_min": 327.6172641261566, "episode_return_mean": 346.36852791957403, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229512, "num_agent_steps_trained": 229512, "num_env_steps_sampled": 229512, "num_env_steps_trained": 229512, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.380811410045617, "num_env_steps_trained_throughput_per_sec": 14.380811410045617, "timesteps_total": 229512, "num_env_steps_sampled_lifetime": 229512, "num_agent_steps_sampled_lifetime": 229512, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 229512, "timers": {"training_iteration_time_ms": 32870.754, "restore_workers_time_ms": 0.021, "training_step_time_ms": 32870.685, "sample_time_ms": 32054.279, "load_time_ms": 1.248, "load_throughput": 413559.617, "learn_time_ms": 800.998, "learn_throughput": 644.197, "synch_weights_time_ms": 13.833}, "counters": {"num_env_steps_sampled": 229512, "num_env_steps_trained": 229512, "num_agent_steps_sampled": 229512, "num_agent_steps_trained": 229512}, "done": false, "episodes_total": 4763, "training_iteration": 189, "trial_id": "fd033_00000", "date": "2024-06-11_13-32-40", "timestamp": 1718134360, "time_this_iter_s": 35.88422131538391, "time_total_s": 15795.995186328888, "pid": 90436, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 131.4956612586975, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.38235294117648, "ram_util_percent": 13.376470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.39055903120182217, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.688389949997266, "policy_loss": -0.012126708527406056, "vf_loss": 1.6936660180489223, "vf_explained_var": 0.23203160911798476, "kl": 0.017540568309293618, "entropy": -1.6394065370162327, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 230028, "num_env_steps_trained": 230028, "num_agent_steps_sampled": 230028, "num_agent_steps_trained": 230028}, "sampler_results": {"episode_reward_max": 362.69862613171426, "episode_reward_min": 326.387761435488, "episode_reward_mean": 346.4225580607262, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216, 331.43344516426527, 352.52702274679865, 352.60607288124737, 346.13643644763033, 344.8041079099034, 339.88824122890344, 355.3836781072544, 359.69615837232743, 354.1432903553987, 326.387761435488, 341.84923282842993, 354.16033433254626], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.352266523204945, "mean_inference_ms": 1.3057901499124251, "mean_action_processing_ms": 0.2158782024740363, "mean_env_wait_ms": 327.9506638234364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014030436674753824, "StateBufferConnector_ms": 0.006835659344991048, "ViewRequirementAgentConnector_ms": 0.1753106713294983}, "num_episodes": 12, "episode_return_max": 362.69862613171426, "episode_return_min": 326.387761435488, "episode_return_mean": 346.4225580607262}, "env_runner_results": {"episode_reward_max": 362.69862613171426, "episode_reward_min": 326.387761435488, "episode_reward_mean": 346.4225580607262, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216, 331.43344516426527, 352.52702274679865, 352.60607288124737, 346.13643644763033, 344.8041079099034, 339.88824122890344, 355.3836781072544, 359.69615837232743, 354.1432903553987, 326.387761435488, 341.84923282842993, 354.16033433254626], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.352266523204945, "mean_inference_ms": 1.3057901499124251, "mean_action_processing_ms": 0.2158782024740363, "mean_env_wait_ms": 327.9506638234364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014030436674753824, "StateBufferConnector_ms": 0.006835659344991048, "ViewRequirementAgentConnector_ms": 0.1753106713294983}, "num_episodes": 12, "episode_return_max": 362.69862613171426, "episode_return_min": 326.387761435488, "episode_return_mean": 346.4225580607262}, "episode_reward_max": 362.69862613171426, "episode_reward_min": 326.387761435488, "episode_reward_mean": 346.4225580607262, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 2400, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216, 331.43344516426527, 352.52702274679865, 352.60607288124737, 346.13643644763033, 344.8041079099034, 339.88824122890344, 355.3836781072544, 359.69615837232743, 354.1432903553987, 326.387761435488, 341.84923282842993, 354.16033433254626], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.352266523204945, "mean_inference_ms": 1.3057901499124251, "mean_action_processing_ms": 0.2158782024740363, "mean_env_wait_ms": 327.9506638234364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014030436674753824, "StateBufferConnector_ms": 0.006835659344991048, "ViewRequirementAgentConnector_ms": 0.1753106713294983}, "num_episodes": 12, "episode_return_max": 362.69862613171426, "episode_return_min": 326.387761435488, "episode_return_mean": 346.4225580607262, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230028, "num_agent_steps_trained": 230028, "num_env_steps_sampled": 230028, "num_env_steps_trained": 230028, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 16.240554310654833, "num_env_steps_trained_throughput_per_sec": 16.240554310654833, "timesteps_total": 230028, "num_env_steps_sampled_lifetime": 230028, "num_agent_steps_sampled_lifetime": 230028, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 230028, "timers": {"training_iteration_time_ms": 32651.069, "restore_workers_time_ms": 0.02, "training_step_time_ms": 32651.003, "sample_time_ms": 31842.735, "load_time_ms": 1.226, "load_throughput": 420898.651, "learn_time_ms": 792.945, "learn_throughput": 650.739, "synch_weights_time_ms": 13.778}, "counters": {"num_env_steps_sampled": 230028, "num_env_steps_trained": 230028, "num_agent_steps_sampled": 230028, "num_agent_steps_trained": 230028}, "done": false, "episodes_total": 4775, "training_iteration": 190, "trial_id": "fd033_00000", "date": "2024-06-11_13-33-12", "timestamp": 1718134392, "time_this_iter_s": 31.775524616241455, "time_total_s": 15827.77071094513, "pid": 90436, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 163.27118587493896, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 47.93695652173913, "ram_util_percent": 13.880434782608694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.39055903120182217, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6570471545060477, "policy_loss": -0.011971270541350047, "vf_loss": 1.6664110913872718, "vf_explained_var": 0.7046243558327357, "kl": 0.006675915761541153, "entropy": -1.7331724752982458, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 230544, "num_env_steps_trained": 230544, "num_agent_steps_sampled": 230544, "num_agent_steps_trained": 230544}, "sampler_results": {"episode_reward_max": 365.12686395199694, "episode_reward_min": 326.387761435488, "episode_reward_mean": 346.5797436328235, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216, 331.43344516426527, 352.52702274679865, 352.60607288124737, 346.13643644763033, 344.8041079099034, 339.88824122890344, 355.3836781072544, 359.69615837232743, 354.1432903553987, 326.387761435488, 341.84923282842993, 354.16033433254626, 337.0164619692914, 343.4803617623084, 344.47324115933503, 365.12686395199694, 333.21351769081565, 333.59607695464297, 355.3034750561255, 356.5072762751873, 347.4057671866012, 340.0074337613306, 352.03451600822115, 358.3368392786966], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.418373016080907, "mean_inference_ms": 1.3050535057780241, "mean_action_processing_ms": 0.21578272401281182, "mean_env_wait_ms": 331.48088077983994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013954639434814453, "StateBufferConnector_ms": 0.0067929426829020185, "ViewRequirementAgentConnector_ms": 0.17553329467773438}, "num_episodes": 12, "episode_return_max": 365.12686395199694, "episode_return_min": 326.387761435488, "episode_return_mean": 346.5797436328235}, "env_runner_results": {"episode_reward_max": 365.12686395199694, "episode_reward_min": 326.387761435488, "episode_reward_mean": 346.5797436328235, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216, 331.43344516426527, 352.52702274679865, 352.60607288124737, 346.13643644763033, 344.8041079099034, 339.88824122890344, 355.3836781072544, 359.69615837232743, 354.1432903553987, 326.387761435488, 341.84923282842993, 354.16033433254626, 337.0164619692914, 343.4803617623084, 344.47324115933503, 365.12686395199694, 333.21351769081565, 333.59607695464297, 355.3034750561255, 356.5072762751873, 347.4057671866012, 340.0074337613306, 352.03451600822115, 358.3368392786966], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.418373016080907, "mean_inference_ms": 1.3050535057780241, "mean_action_processing_ms": 0.21578272401281182, "mean_env_wait_ms": 331.48088077983994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013954639434814453, "StateBufferConnector_ms": 0.0067929426829020185, "ViewRequirementAgentConnector_ms": 0.17553329467773438}, "num_episodes": 12, "episode_return_max": 365.12686395199694, "episode_return_min": 326.387761435488, "episode_return_mean": 346.5797436328235}, "episode_reward_max": 365.12686395199694, "episode_reward_min": 326.387761435488, "episode_reward_mean": 346.5797436328235, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 3000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216, 331.43344516426527, 352.52702274679865, 352.60607288124737, 346.13643644763033, 344.8041079099034, 339.88824122890344, 355.3836781072544, 359.69615837232743, 354.1432903553987, 326.387761435488, 341.84923282842993, 354.16033433254626, 337.0164619692914, 343.4803617623084, 344.47324115933503, 365.12686395199694, 333.21351769081565, 333.59607695464297, 355.3034750561255, 356.5072762751873, 347.4057671866012, 340.0074337613306, 352.03451600822115, 358.3368392786966], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.418373016080907, "mean_inference_ms": 1.3050535057780241, "mean_action_processing_ms": 0.21578272401281182, "mean_env_wait_ms": 331.48088077983994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013954639434814453, "StateBufferConnector_ms": 0.0067929426829020185, "ViewRequirementAgentConnector_ms": 0.17553329467773438}, "num_episodes": 12, "episode_return_max": 365.12686395199694, "episode_return_min": 326.387761435488, "episode_return_mean": 346.5797436328235, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230544, "num_agent_steps_trained": 230544, "num_env_steps_sampled": 230544, "num_env_steps_trained": 230544, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.414635964092481, "num_env_steps_trained_throughput_per_sec": 13.414635964092481, "timesteps_total": 230544, "num_env_steps_sampled_lifetime": 230544, "num_agent_steps_sampled_lifetime": 230544, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 230544, "timers": {"training_iteration_time_ms": 33620.135, "restore_workers_time_ms": 0.021, "training_step_time_ms": 33620.069, "sample_time_ms": 32817.611, "load_time_ms": 1.201, "load_throughput": 429558.888, "learn_time_ms": 787.224, "learn_throughput": 655.468, "synch_weights_time_ms": 13.731}, "counters": {"num_env_steps_sampled": 230544, "num_env_steps_trained": 230544, "num_agent_steps_sampled": 230544, "num_agent_steps_trained": 230544}, "done": false, "episodes_total": 4787, "training_iteration": 191, "trial_id": "fd033_00000", "date": "2024-06-11_13-33-50", "timestamp": 1718134430, "time_this_iter_s": 38.46922159194946, "time_total_s": 15866.239932537079, "pid": 90436, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 201.74040746688843, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 36.87090909090909, "ram_util_percent": 13.432727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.39055903120182217, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8574408183495204, "policy_loss": -0.02312130999440948, "vf_loss": 1.8766735648115476, "vf_explained_var": 0.4784050613641739, "kl": 0.0099563525169902, "entropy": -1.6507732530434926, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 231060, "num_env_steps_trained": 231060, "num_agent_steps_sampled": 231060, "num_agent_steps_trained": 231060}, "sampler_results": {"episode_reward_max": 368.41835971651346, "episode_reward_min": 325.9753851938088, "episode_reward_mean": 346.24055836630566, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216, 331.43344516426527, 352.52702274679865, 352.60607288124737, 346.13643644763033, 344.8041079099034, 339.88824122890344, 355.3836781072544, 359.69615837232743, 354.1432903553987, 326.387761435488, 341.84923282842993, 354.16033433254626, 337.0164619692914, 343.4803617623084, 344.47324115933503, 365.12686395199694, 333.21351769081565, 333.59607695464297, 355.3034750561255, 356.5072762751873, 347.4057671866012, 340.0074337613306, 352.03451600822115, 358.3368392786966, 345.2173286685312, 325.9753851938088, 355.28161226573894, 331.8089101589728, 327.2006857643926, 349.50657968973735, 357.1379498197399, 329.5956041819378, 344.29382856532595, 348.8299984306883, 351.2693419492101, 368.41835971651346], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.479521236878102, "mean_inference_ms": 1.3045460003693845, "mean_action_processing_ms": 0.21572234964755344, "mean_env_wait_ms": 334.9293491227002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013305081261528863, "StateBufferConnector_ms": 0.006795591778225369, "ViewRequirementAgentConnector_ms": 0.17644233173794216}, "num_episodes": 12, "episode_return_max": 368.41835971651346, "episode_return_min": 325.9753851938088, "episode_return_mean": 346.24055836630566}, "env_runner_results": {"episode_reward_max": 368.41835971651346, "episode_reward_min": 325.9753851938088, "episode_reward_mean": 346.24055836630566, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216, 331.43344516426527, 352.52702274679865, 352.60607288124737, 346.13643644763033, 344.8041079099034, 339.88824122890344, 355.3836781072544, 359.69615837232743, 354.1432903553987, 326.387761435488, 341.84923282842993, 354.16033433254626, 337.0164619692914, 343.4803617623084, 344.47324115933503, 365.12686395199694, 333.21351769081565, 333.59607695464297, 355.3034750561255, 356.5072762751873, 347.4057671866012, 340.0074337613306, 352.03451600822115, 358.3368392786966, 345.2173286685312, 325.9753851938088, 355.28161226573894, 331.8089101589728, 327.2006857643926, 349.50657968973735, 357.1379498197399, 329.5956041819378, 344.29382856532595, 348.8299984306883, 351.2693419492101, 368.41835971651346], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.479521236878102, "mean_inference_ms": 1.3045460003693845, "mean_action_processing_ms": 0.21572234964755344, "mean_env_wait_ms": 334.9293491227002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013305081261528863, "StateBufferConnector_ms": 0.006795591778225369, "ViewRequirementAgentConnector_ms": 0.17644233173794216}, "num_episodes": 12, "episode_return_max": 368.41835971651346, "episode_return_min": 325.9753851938088, "episode_return_mean": 346.24055836630566}, "episode_reward_max": 368.41835971651346, "episode_reward_min": 325.9753851938088, "episode_reward_mean": 346.24055836630566, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 3600, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216, 331.43344516426527, 352.52702274679865, 352.60607288124737, 346.13643644763033, 344.8041079099034, 339.88824122890344, 355.3836781072544, 359.69615837232743, 354.1432903553987, 326.387761435488, 341.84923282842993, 354.16033433254626, 337.0164619692914, 343.4803617623084, 344.47324115933503, 365.12686395199694, 333.21351769081565, 333.59607695464297, 355.3034750561255, 356.5072762751873, 347.4057671866012, 340.0074337613306, 352.03451600822115, 358.3368392786966, 345.2173286685312, 325.9753851938088, 355.28161226573894, 331.8089101589728, 327.2006857643926, 349.50657968973735, 357.1379498197399, 329.5956041819378, 344.29382856532595, 348.8299984306883, 351.2693419492101, 368.41835971651346], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.479521236878102, "mean_inference_ms": 1.3045460003693845, "mean_action_processing_ms": 0.21572234964755344, "mean_env_wait_ms": 334.9293491227002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013305081261528863, "StateBufferConnector_ms": 0.006795591778225369, "ViewRequirementAgentConnector_ms": 0.17644233173794216}, "num_episodes": 12, "episode_return_max": 368.41835971651346, "episode_return_min": 325.9753851938088, "episode_return_mean": 346.24055836630566, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231060, "num_agent_steps_trained": 231060, "num_env_steps_sampled": 231060, "num_env_steps_trained": 231060, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.74289050045568, "num_env_steps_trained_throughput_per_sec": 13.74289050045568, "timesteps_total": 231060, "num_env_steps_sampled_lifetime": 231060, "num_agent_steps_sampled_lifetime": 231060, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 231060, "timers": {"training_iteration_time_ms": 34181.073, "restore_workers_time_ms": 0.021, "training_step_time_ms": 34181.009, "sample_time_ms": 33380.246, "load_time_ms": 1.186, "load_throughput": 434902.427, "learn_time_ms": 785.568, "learn_throughput": 656.85, "synch_weights_time_ms": 13.716}, "counters": {"num_env_steps_sampled": 231060, "num_env_steps_trained": 231060, "num_agent_steps_sampled": 231060, "num_agent_steps_trained": 231060}, "done": false, "episodes_total": 4799, "training_iteration": 192, "trial_id": "fd033_00000", "date": "2024-06-11_13-34-28", "timestamp": 1718134468, "time_this_iter_s": 37.55053734779358, "time_total_s": 15903.790469884872, "pid": 90436, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 239.290944814682, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 38.369811320754714, "ram_util_percent": 13.207547169811322}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.39055903120182217, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7717823296785356, "policy_loss": -0.0032735375066598256, "vf_loss": 1.7745441630482675, "vf_explained_var": 0.4883829911549886, "kl": 0.0013102241181825588, "entropy": -1.5763988574345906, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 231576, "num_env_steps_trained": 231576, "num_agent_steps_sampled": 231576, "num_agent_steps_trained": 231576}, "sampler_results": {"episode_reward_max": 368.41835971651346, "episode_reward_min": 194.47249574831443, "episode_reward_mean": 343.6305049887963, "episode_len_mean": 49.78481012658228, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 3933, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216, 331.43344516426527, 352.52702274679865, 352.60607288124737, 346.13643644763033, 344.8041079099034, 339.88824122890344, 355.3836781072544, 359.69615837232743, 354.1432903553987, 326.387761435488, 341.84923282842993, 354.16033433254626, 337.0164619692914, 343.4803617623084, 344.47324115933503, 365.12686395199694, 333.21351769081565, 333.59607695464297, 355.3034750561255, 356.5072762751873, 347.4057671866012, 340.0074337613306, 352.03451600822115, 358.3368392786966, 345.2173286685312, 325.9753851938088, 355.28161226573894, 331.8089101589728, 327.2006857643926, 349.50657968973735, 357.1379498197399, 329.5956041819378, 344.29382856532595, 348.8299984306883, 351.2693419492101, 368.41835971651346, 338.3137759994696, 334.35924646521477, 353.7359209098135, 194.47249574831443, 327.0437065770261, 331.02348091542973, 338.5410651256328], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.495565638476318, "mean_inference_ms": 1.304212771196475, "mean_action_processing_ms": 0.2156977282680739, "mean_env_wait_ms": 335.7510856492638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012992303582686411, "StateBufferConnector_ms": 0.0067819522905953325, "ViewRequirementAgentConnector_ms": 0.17611799360830574}, "num_episodes": 7, "episode_return_max": 368.41835971651346, "episode_return_min": 194.47249574831443, "episode_return_mean": 343.6305049887963}, "env_runner_results": {"episode_reward_max": 368.41835971651346, "episode_reward_min": 194.47249574831443, "episode_reward_mean": 343.6305049887963, "episode_len_mean": 49.78481012658228, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 3933, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216, 331.43344516426527, 352.52702274679865, 352.60607288124737, 346.13643644763033, 344.8041079099034, 339.88824122890344, 355.3836781072544, 359.69615837232743, 354.1432903553987, 326.387761435488, 341.84923282842993, 354.16033433254626, 337.0164619692914, 343.4803617623084, 344.47324115933503, 365.12686395199694, 333.21351769081565, 333.59607695464297, 355.3034750561255, 356.5072762751873, 347.4057671866012, 340.0074337613306, 352.03451600822115, 358.3368392786966, 345.2173286685312, 325.9753851938088, 355.28161226573894, 331.8089101589728, 327.2006857643926, 349.50657968973735, 357.1379498197399, 329.5956041819378, 344.29382856532595, 348.8299984306883, 351.2693419492101, 368.41835971651346, 338.3137759994696, 334.35924646521477, 353.7359209098135, 194.47249574831443, 327.0437065770261, 331.02348091542973, 338.5410651256328], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.495565638476318, "mean_inference_ms": 1.304212771196475, "mean_action_processing_ms": 0.2156977282680739, "mean_env_wait_ms": 335.7510856492638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012992303582686411, "StateBufferConnector_ms": 0.0067819522905953325, "ViewRequirementAgentConnector_ms": 0.17611799360830574}, "num_episodes": 7, "episode_return_max": 368.41835971651346, "episode_return_min": 194.47249574831443, "episode_return_mean": 343.6305049887963}, "episode_reward_max": 368.41835971651346, "episode_reward_min": 194.47249574831443, "episode_reward_mean": 343.6305049887963, "episode_len_mean": 49.78481012658228, "episodes_this_iter": 7, "episodes_timesteps_total": 3933, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.69792111006683, 354.7107156853635, 339.0831333282025, 336.45196594041107, 348.8907761394944, 344.8320244692649, 347.0238059751299, 351.35446697778997, 353.23859608071757, 338.6356938609127, 362.69862613171426, 339.49447101514, 356.7834353033567, 346.33961725084595, 332.77939435851493, 341.11562024136725, 357.75638804833795, 347.3497980743995, 345.17375461865134, 351.4465412470126, 330.8870247515904, 338.43058149238976, 351.26930207349744, 342.28982840587213, 353.01329933200435, 327.6172641261566, 351.31754046106505, 346.7409248896019, 344.8999657922578, 359.23172274761106, 341.8679559499641, 357.3810746198851, 329.2682638469761, 362.45912403484186, 349.5258706595947, 337.21051606466216, 331.43344516426527, 352.52702274679865, 352.60607288124737, 346.13643644763033, 344.8041079099034, 339.88824122890344, 355.3836781072544, 359.69615837232743, 354.1432903553987, 326.387761435488, 341.84923282842993, 354.16033433254626, 337.0164619692914, 343.4803617623084, 344.47324115933503, 365.12686395199694, 333.21351769081565, 333.59607695464297, 355.3034750561255, 356.5072762751873, 347.4057671866012, 340.0074337613306, 352.03451600822115, 358.3368392786966, 345.2173286685312, 325.9753851938088, 355.28161226573894, 331.8089101589728, 327.2006857643926, 349.50657968973735, 357.1379498197399, 329.5956041819378, 344.29382856532595, 348.8299984306883, 351.2693419492101, 368.41835971651346, 338.3137759994696, 334.35924646521477, 353.7359209098135, 194.47249574831443, 327.0437065770261, 331.02348091542973, 338.5410651256328], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 33, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.495565638476318, "mean_inference_ms": 1.304212771196475, "mean_action_processing_ms": 0.2156977282680739, "mean_env_wait_ms": 335.7510856492638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012992303582686411, "StateBufferConnector_ms": 0.0067819522905953325, "ViewRequirementAgentConnector_ms": 0.17611799360830574}, "num_episodes": 7, "episode_return_max": 368.41835971651346, "episode_return_min": 194.47249574831443, "episode_return_mean": 343.6305049887963, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231576, "num_agent_steps_trained": 231576, "num_env_steps_sampled": 231576, "num_env_steps_trained": 231576, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 18.033388276877467, "num_env_steps_trained_throughput_per_sec": 18.033388276877467, "timesteps_total": 231576, "num_env_steps_sampled_lifetime": 231576, "num_agent_steps_sampled_lifetime": 231576, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 231576, "timers": {"training_iteration_time_ms": 33485.14, "restore_workers_time_ms": 0.021, "training_step_time_ms": 33485.076, "sample_time_ms": 32685.96, "load_time_ms": 1.191, "load_throughput": 433198.732, "learn_time_ms": 783.983, "learn_throughput": 658.178, "synch_weights_time_ms": 13.658}, "counters": {"num_env_steps_sampled": 231576, "num_env_steps_trained": 231576, "num_agent_steps_sampled": 231576, "num_agent_steps_trained": 231576}, "done": false, "episodes_total": 4806, "training_iteration": 193, "trial_id": "fd033_00000", "date": "2024-06-11_13-34-56", "timestamp": 1718134496, "time_this_iter_s": 28.61724328994751, "time_total_s": 15932.40771317482, "pid": 90436, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.015480141836385838, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7277068678621134, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 267.9081881046295, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 47.360975609756096, "ram_util_percent": 12.846341463414632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7575156404082006, "cur_lr": 5e-06, "total_loss": 1.4763718056182067, "policy_loss": 0.0023043900883446137, "vf_loss": 1.4396724353233974, "vf_explained_var": 0.24881221801042558, "kl": 0.01957022023319427, "entropy": -1.7926107029120126, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 231984, "num_env_steps_trained": 231984, "num_agent_steps_sampled": 231984, "num_agent_steps_trained": 231984}, "sampler_results": {"episode_reward_max": 362.13830444432523, "episode_reward_min": 334.38409216627053, "episode_reward_mean": 354.5440091842026, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.13830444432523, 361.1795785360059, 353.7785403991011, 354.0302489881779, 334.38409216627053, 361.75329057133456], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2474242462508975, "mean_inference_ms": 1.3033430238336436, "mean_action_processing_ms": 0.2161954097820881, "mean_env_wait_ms": 308.2798924939386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00947713851928711, "StateBufferConnector_ms": 0.006135304768880208, "ViewRequirementAgentConnector_ms": 0.18092791239420572}, "num_episodes": 6, "episode_return_max": 362.13830444432523, "episode_return_min": 334.38409216627053, "episode_return_mean": 354.5440091842026}, "env_runner_results": {"episode_reward_max": 362.13830444432523, "episode_reward_min": 334.38409216627053, "episode_reward_mean": 354.5440091842026, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.13830444432523, 361.1795785360059, 353.7785403991011, 354.0302489881779, 334.38409216627053, 361.75329057133456], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2474242462508975, "mean_inference_ms": 1.3033430238336436, "mean_action_processing_ms": 0.2161954097820881, "mean_env_wait_ms": 308.2798924939386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00947713851928711, "StateBufferConnector_ms": 0.006135304768880208, "ViewRequirementAgentConnector_ms": 0.18092791239420572}, "num_episodes": 6, "episode_return_max": 362.13830444432523, "episode_return_min": 334.38409216627053, "episode_return_mean": 354.5440091842026}, "episode_reward_max": 362.13830444432523, "episode_reward_min": 334.38409216627053, "episode_reward_mean": 354.5440091842026, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [362.13830444432523, 361.1795785360059, 353.7785403991011, 354.0302489881779, 334.38409216627053, 361.75329057133456], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2474242462508975, "mean_inference_ms": 1.3033430238336436, "mean_action_processing_ms": 0.2161954097820881, "mean_env_wait_ms": 308.2798924939386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00947713851928711, "StateBufferConnector_ms": 0.006135304768880208, "ViewRequirementAgentConnector_ms": 0.18092791239420572}, "num_episodes": 6, "episode_return_max": 362.13830444432523, "episode_return_min": 334.38409216627053, "episode_return_mean": 354.5440091842026, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231984, "num_agent_steps_trained": 231984, "num_env_steps_sampled": 231984, "num_env_steps_trained": 231984, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 16.580326169097884, "num_env_steps_trained_throughput_per_sec": 16.580326169097884, "timesteps_total": 231984, "num_env_steps_sampled_lifetime": 231984, "num_agent_steps_sampled_lifetime": 231984, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 231984, "timers": {"training_iteration_time_ms": 31121.236, "restore_workers_time_ms": 0.021, "training_step_time_ms": 31121.17, "sample_time_ms": 30154.286, "load_time_ms": 1.648, "load_throughput": 313116.444, "learn_time_ms": 950.509, "learn_throughput": 542.867, "synch_weights_time_ms": 14.243}, "counters": {"num_env_steps_sampled": 231984, "num_env_steps_trained": 231984, "num_agent_steps_sampled": 231984, "num_agent_steps_trained": 231984}, "done": false, "episodes_total": 4811, "training_iteration": 176, "trial_id": "fd033_00000", "date": "2024-06-11_13-35-55", "timestamp": 1718134555, "time_this_iter_s": 31.12427544593811, "time_total_s": 15948.217013120651, "pid": 50518, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2786077259694819, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.16194868772046, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 31.12427544593811, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 47.82444444444445, "ram_util_percent": 13.56444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7575156404082006, "cur_lr": 5e-06, "total_loss": 1.5924084166064858, "policy_loss": -0.02037458059688409, "vf_loss": 1.6083364568650722, "vf_explained_var": 0.6838885520895323, "kl": 0.002530014141182371, "entropy": -1.8620254158973695, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 232500, "num_env_steps_trained": 232500, "num_agent_steps_sampled": 232500, "num_agent_steps_trained": 232500}, "sampler_results": {"episode_reward_max": 365.6738133883857, "episode_reward_min": 328.6948463078967, "episode_reward_mean": 350.7559123921526, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.13830444432523, 361.1795785360059, 353.7785403991011, 354.0302489881779, 334.38409216627053, 361.75329057133456, 346.8708753259075, 328.6948463078967, 336.1567860253485, 364.31746450772016, 344.4364973500942, 355.12671365979634, 365.6738133883857, 361.60695291351226, 357.29886189219167, 333.0087476175052, 350.7782161844479, 342.3725927807264], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.945186449993362, "mean_inference_ms": 1.2967248335701251, "mean_action_processing_ms": 0.21445646025448603, "mean_env_wait_ms": 333.78371938825796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01228385501437717, "StateBufferConnector_ms": 0.006234645843505859, "ViewRequirementAgentConnector_ms": 0.17895963456895617}, "num_episodes": 12, "episode_return_max": 365.6738133883857, "episode_return_min": 328.6948463078967, "episode_return_mean": 350.7559123921526}, "env_runner_results": {"episode_reward_max": 365.6738133883857, "episode_reward_min": 328.6948463078967, "episode_reward_mean": 350.7559123921526, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.13830444432523, 361.1795785360059, 353.7785403991011, 354.0302489881779, 334.38409216627053, 361.75329057133456, 346.8708753259075, 328.6948463078967, 336.1567860253485, 364.31746450772016, 344.4364973500942, 355.12671365979634, 365.6738133883857, 361.60695291351226, 357.29886189219167, 333.0087476175052, 350.7782161844479, 342.3725927807264], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.945186449993362, "mean_inference_ms": 1.2967248335701251, "mean_action_processing_ms": 0.21445646025448603, "mean_env_wait_ms": 333.78371938825796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01228385501437717, "StateBufferConnector_ms": 0.006234645843505859, "ViewRequirementAgentConnector_ms": 0.17895963456895617}, "num_episodes": 12, "episode_return_max": 365.6738133883857, "episode_return_min": 328.6948463078967, "episode_return_mean": 350.7559123921526}, "episode_reward_max": 365.6738133883857, "episode_reward_min": 328.6948463078967, "episode_reward_mean": 350.7559123921526, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [362.13830444432523, 361.1795785360059, 353.7785403991011, 354.0302489881779, 334.38409216627053, 361.75329057133456, 346.8708753259075, 328.6948463078967, 336.1567860253485, 364.31746450772016, 344.4364973500942, 355.12671365979634, 365.6738133883857, 361.60695291351226, 357.29886189219167, 333.0087476175052, 350.7782161844479, 342.3725927807264], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.945186449993362, "mean_inference_ms": 1.2967248335701251, "mean_action_processing_ms": 0.21445646025448603, "mean_env_wait_ms": 333.78371938825796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01228385501437717, "StateBufferConnector_ms": 0.006234645843505859, "ViewRequirementAgentConnector_ms": 0.17895963456895617}, "num_episodes": 12, "episode_return_max": 365.6738133883857, "episode_return_min": 328.6948463078967, "episode_return_mean": 350.7559123921526, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232500, "num_agent_steps_trained": 232500, "num_env_steps_sampled": 232500, "num_env_steps_trained": 232500, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.890507435002394, "num_env_steps_trained_throughput_per_sec": 13.890507435002394, "timesteps_total": 232500, "num_env_steps_sampled_lifetime": 232500, "num_agent_steps_sampled_lifetime": 232500, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 232500, "timers": {"training_iteration_time_ms": 34134.46, "restore_workers_time_ms": 0.02, "training_step_time_ms": 34134.395, "sample_time_ms": 33243.053, "load_time_ms": 1.433, "load_throughput": 359960.227, "learn_time_ms": 875.325, "learn_throughput": 589.495, "synch_weights_time_ms": 14.196}, "counters": {"num_env_steps_sampled": 232500, "num_env_steps_trained": 232500, "num_agent_steps_sampled": 232500, "num_agent_steps_trained": 232500}, "done": false, "episodes_total": 4823, "training_iteration": 177, "trial_id": "fd033_00000", "date": "2024-06-11_13-36-32", "timestamp": 1718134592, "time_this_iter_s": 37.15118908882141, "time_total_s": 15985.368202209473, "pid": 50518, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2786077259694819, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.16194868772046, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 68.27546453475952, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.83396226415094, "ram_util_percent": 13.760377358490562}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.8787578202041003, "cur_lr": 5e-06, "total_loss": 1.7352579236030579, "policy_loss": -0.011616982395450275, "vf_loss": 1.7426115413506826, "vf_explained_var": 0.9529008110364278, "kl": 0.004851556957661766, "entropy": -1.8735778719186782, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 233016, "num_env_steps_trained": 233016, "num_agent_steps_sampled": 233016, "num_agent_steps_trained": 233016}, "sampler_results": {"episode_reward_max": 370.86370709846415, "episode_reward_min": 328.6948463078967, "episode_reward_mean": 350.96606851228654, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.13830444432523, 361.1795785360059, 353.7785403991011, 354.0302489881779, 334.38409216627053, 361.75329057133456, 346.8708753259075, 328.6948463078967, 336.1567860253485, 364.31746450772016, 344.4364973500942, 355.12671365979634, 365.6738133883857, 361.60695291351226, 357.29886189219167, 333.0087476175052, 350.7782161844479, 342.3725927807264, 352.3683078624003, 346.66800480574364, 343.22831934948385, 347.87252101855955, 335.8576729386872, 332.4683585069223, 370.86370709846415, 364.37361998480617, 356.46172695578156, 366.3212575451504, 338.92041261496547, 359.97172362888585], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.227418067546631, "mean_inference_ms": 1.2947224504352008, "mean_action_processing_ms": 0.21410928687687486, "mean_env_wait_ms": 334.4345313462466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012982686360677084, "StateBufferConnector_ms": 0.006213188171386719, "ViewRequirementAgentConnector_ms": 0.17891248067220053}, "num_episodes": 12, "episode_return_max": 370.86370709846415, "episode_return_min": 328.6948463078967, "episode_return_mean": 350.96606851228654}, "env_runner_results": {"episode_reward_max": 370.86370709846415, "episode_reward_min": 328.6948463078967, "episode_reward_mean": 350.96606851228654, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.13830444432523, 361.1795785360059, 353.7785403991011, 354.0302489881779, 334.38409216627053, 361.75329057133456, 346.8708753259075, 328.6948463078967, 336.1567860253485, 364.31746450772016, 344.4364973500942, 355.12671365979634, 365.6738133883857, 361.60695291351226, 357.29886189219167, 333.0087476175052, 350.7782161844479, 342.3725927807264, 352.3683078624003, 346.66800480574364, 343.22831934948385, 347.87252101855955, 335.8576729386872, 332.4683585069223, 370.86370709846415, 364.37361998480617, 356.46172695578156, 366.3212575451504, 338.92041261496547, 359.97172362888585], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.227418067546631, "mean_inference_ms": 1.2947224504352008, "mean_action_processing_ms": 0.21410928687687486, "mean_env_wait_ms": 334.4345313462466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012982686360677084, "StateBufferConnector_ms": 0.006213188171386719, "ViewRequirementAgentConnector_ms": 0.17891248067220053}, "num_episodes": 12, "episode_return_max": 370.86370709846415, "episode_return_min": 328.6948463078967, "episode_return_mean": 350.96606851228654}, "episode_reward_max": 370.86370709846415, "episode_reward_min": 328.6948463078967, "episode_reward_mean": 350.96606851228654, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [362.13830444432523, 361.1795785360059, 353.7785403991011, 354.0302489881779, 334.38409216627053, 361.75329057133456, 346.8708753259075, 328.6948463078967, 336.1567860253485, 364.31746450772016, 344.4364973500942, 355.12671365979634, 365.6738133883857, 361.60695291351226, 357.29886189219167, 333.0087476175052, 350.7782161844479, 342.3725927807264, 352.3683078624003, 346.66800480574364, 343.22831934948385, 347.87252101855955, 335.8576729386872, 332.4683585069223, 370.86370709846415, 364.37361998480617, 356.46172695578156, 366.3212575451504, 338.92041261496547, 359.97172362888585], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.227418067546631, "mean_inference_ms": 1.2947224504352008, "mean_action_processing_ms": 0.21410928687687486, "mean_env_wait_ms": 334.4345313462466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012982686360677084, "StateBufferConnector_ms": 0.006213188171386719, "ViewRequirementAgentConnector_ms": 0.17891248067220053}, "num_episodes": 12, "episode_return_max": 370.86370709846415, "episode_return_min": 328.6948463078967, "episode_return_mean": 350.96606851228654, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233016, "num_agent_steps_trained": 233016, "num_env_steps_sampled": 233016, "num_env_steps_trained": 233016, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 16.631948564413563, "num_env_steps_trained_throughput_per_sec": 16.631948564413563, "timesteps_total": 233016, "num_env_steps_sampled_lifetime": 233016, "num_agent_steps_sampled_lifetime": 233016, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 233016, "timers": {"training_iteration_time_ms": 33097.855, "restore_workers_time_ms": 0.022, "training_step_time_ms": 33097.786, "sample_time_ms": 32251.868, "load_time_ms": 1.328, "load_throughput": 388696.276, "learn_time_ms": 830.176, "learn_throughput": 621.555, "synch_weights_time_ms": 14.07}, "counters": {"num_env_steps_sampled": 233016, "num_env_steps_trained": 233016, "num_agent_steps_sampled": 233016, "num_agent_steps_trained": 233016}, "done": false, "episodes_total": 4835, "training_iteration": 178, "trial_id": "fd033_00000", "date": "2024-06-11_13-37-03", "timestamp": 1718134623, "time_this_iter_s": 31.02758026123047, "time_total_s": 16016.395782470703, "pid": 50518, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2786077259694819, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.16194868772046, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 99.30304479598999, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 48.025000000000006, "ram_util_percent": 13.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.43937891010205016, "cur_lr": 5e-06, "total_loss": 1.701918185998996, "policy_loss": -0.013393859627346199, "vf_loss": 1.7124340151747068, "vf_explained_var": 0.5504620244105657, "kl": 0.006550217194126162, "entropy": -1.8000343988339107, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 233532, "num_env_steps_trained": 233532, "num_agent_steps_sampled": 233532, "num_agent_steps_trained": 233532}, "sampler_results": {"episode_reward_max": 370.86370709846415, "episode_reward_min": 328.6948463078967, "episode_reward_mean": 350.91926641564237, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.13830444432523, 361.1795785360059, 353.7785403991011, 354.0302489881779, 334.38409216627053, 361.75329057133456, 346.8708753259075, 328.6948463078967, 336.1567860253485, 364.31746450772016, 344.4364973500942, 355.12671365979634, 365.6738133883857, 361.60695291351226, 357.29886189219167, 333.0087476175052, 350.7782161844479, 342.3725927807264, 352.3683078624003, 346.66800480574364, 343.22831934948385, 347.87252101855955, 335.8576729386872, 332.4683585069223, 370.86370709846415, 364.37361998480617, 356.46172695578156, 366.3212575451504, 338.92041261496547, 359.97172362888585, 353.2178911157047, 349.6594112335787, 351.41661848705417, 358.2232424455315, 350.1207133237635, 341.4736589888929], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.237638015149394, "mean_inference_ms": 1.293737883939532, "mean_action_processing_ms": 0.21393510622070086, "mean_env_wait_ms": 333.6767451973193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013660060034857856, "StateBufferConnector_ms": 0.006204843521118164, "ViewRequirementAgentConnector_ms": 0.17781654993693033}, "num_episodes": 6, "episode_return_max": 370.86370709846415, "episode_return_min": 328.6948463078967, "episode_return_mean": 350.91926641564237}, "env_runner_results": {"episode_reward_max": 370.86370709846415, "episode_reward_min": 328.6948463078967, "episode_reward_mean": 350.91926641564237, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.13830444432523, 361.1795785360059, 353.7785403991011, 354.0302489881779, 334.38409216627053, 361.75329057133456, 346.8708753259075, 328.6948463078967, 336.1567860253485, 364.31746450772016, 344.4364973500942, 355.12671365979634, 365.6738133883857, 361.60695291351226, 357.29886189219167, 333.0087476175052, 350.7782161844479, 342.3725927807264, 352.3683078624003, 346.66800480574364, 343.22831934948385, 347.87252101855955, 335.8576729386872, 332.4683585069223, 370.86370709846415, 364.37361998480617, 356.46172695578156, 366.3212575451504, 338.92041261496547, 359.97172362888585, 353.2178911157047, 349.6594112335787, 351.41661848705417, 358.2232424455315, 350.1207133237635, 341.4736589888929], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.237638015149394, "mean_inference_ms": 1.293737883939532, "mean_action_processing_ms": 0.21393510622070086, "mean_env_wait_ms": 333.6767451973193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013660060034857856, "StateBufferConnector_ms": 0.006204843521118164, "ViewRequirementAgentConnector_ms": 0.17781654993693033}, "num_episodes": 6, "episode_return_max": 370.86370709846415, "episode_return_min": 328.6948463078967, "episode_return_mean": 350.91926641564237}, "episode_reward_max": 370.86370709846415, "episode_reward_min": 328.6948463078967, "episode_reward_mean": 350.91926641564237, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [362.13830444432523, 361.1795785360059, 353.7785403991011, 354.0302489881779, 334.38409216627053, 361.75329057133456, 346.8708753259075, 328.6948463078967, 336.1567860253485, 364.31746450772016, 344.4364973500942, 355.12671365979634, 365.6738133883857, 361.60695291351226, 357.29886189219167, 333.0087476175052, 350.7782161844479, 342.3725927807264, 352.3683078624003, 346.66800480574364, 343.22831934948385, 347.87252101855955, 335.8576729386872, 332.4683585069223, 370.86370709846415, 364.37361998480617, 356.46172695578156, 366.3212575451504, 338.92041261496547, 359.97172362888585, 353.2178911157047, 349.6594112335787, 351.41661848705417, 358.2232424455315, 350.1207133237635, 341.4736589888929], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.237638015149394, "mean_inference_ms": 1.293737883939532, "mean_action_processing_ms": 0.21393510622070086, "mean_env_wait_ms": 333.6767451973193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013660060034857856, "StateBufferConnector_ms": 0.006204843521118164, "ViewRequirementAgentConnector_ms": 0.17781654993693033}, "num_episodes": 6, "episode_return_max": 370.86370709846415, "episode_return_min": 328.6948463078967, "episode_return_mean": 350.91926641564237, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233532, "num_agent_steps_trained": 233532, "num_env_steps_sampled": 233532, "num_env_steps_trained": 233532, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.07857000201955, "num_env_steps_trained_throughput_per_sec": 14.07857000201955, "timesteps_total": 233532, "num_env_steps_sampled_lifetime": 233532, "num_agent_steps_sampled_lifetime": 233532, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 233532, "timers": {"training_iteration_time_ms": 33986.257, "restore_workers_time_ms": 0.024, "training_step_time_ms": 33986.187, "sample_time_ms": 33154.838, "load_time_ms": 1.286, "load_throughput": 401216.27, "learn_time_ms": 815.867, "learn_throughput": 632.456, "synch_weights_time_ms": 13.88}, "counters": {"num_env_steps_sampled": 233532, "num_env_steps_trained": 233532, "num_agent_steps_sampled": 233532, "num_agent_steps_trained": 233532}, "done": false, "episodes_total": 4841, "training_iteration": 179, "trial_id": "fd033_00000", "date": "2024-06-11_13-37-40", "timestamp": 1718134660, "time_this_iter_s": 36.654802560806274, "time_total_s": 16053.05058503151, "pid": 50518, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2786077259694819, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.16194868772046, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 135.95784735679626, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 37.73396226415095, "ram_util_percent": 13.090566037735849}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.43937891010205016, "cur_lr": 5e-06, "total_loss": 1.501152973373731, "policy_loss": -0.017141551120827596, "vf_loss": 1.5157136445244153, "vf_explained_var": 0.5170337597529093, "kl": 0.005873911286714673, "entropy": -1.801583723227183, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 234048, "num_env_steps_trained": 234048, "num_agent_steps_sampled": 234048, "num_agent_steps_trained": 234048}, "sampler_results": {"episode_reward_max": 361.67056238335203, "episode_reward_min": 336.22488803649713, "episode_reward_mean": 350.7781791408852, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.50832440644865, 361.67056238335203, 345.4730207323383, 354.6704825391748, 352.1217967474999, 336.22488803649713], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.250745206957119, "mean_inference_ms": 1.3210545097731081, "mean_action_processing_ms": 0.21558520437657147, "mean_env_wait_ms": 379.9486617018893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009806950887044271, "StateBufferConnector_ms": 0.006496906280517578, "ViewRequirementAgentConnector_ms": 0.1805265744527181}, "num_episodes": 6, "episode_return_max": 361.67056238335203, "episode_return_min": 336.22488803649713, "episode_return_mean": 350.7781791408852}, "env_runner_results": {"episode_reward_max": 361.67056238335203, "episode_reward_min": 336.22488803649713, "episode_reward_mean": 350.7781791408852, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.50832440644865, 361.67056238335203, 345.4730207323383, 354.6704825391748, 352.1217967474999, 336.22488803649713], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.250745206957119, "mean_inference_ms": 1.3210545097731081, "mean_action_processing_ms": 0.21558520437657147, "mean_env_wait_ms": 379.9486617018893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009806950887044271, "StateBufferConnector_ms": 0.006496906280517578, "ViewRequirementAgentConnector_ms": 0.1805265744527181}, "num_episodes": 6, "episode_return_max": 361.67056238335203, "episode_return_min": 336.22488803649713, "episode_return_mean": 350.7781791408852}, "episode_reward_max": 361.67056238335203, "episode_reward_min": 336.22488803649713, "episode_reward_mean": 350.7781791408852, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [354.50832440644865, 361.67056238335203, 345.4730207323383, 354.6704825391748, 352.1217967474999, 336.22488803649713], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.250745206957119, "mean_inference_ms": 1.3210545097731081, "mean_action_processing_ms": 0.21558520437657147, "mean_env_wait_ms": 379.9486617018893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009806950887044271, "StateBufferConnector_ms": 0.006496906280517578, "ViewRequirementAgentConnector_ms": 0.1805265744527181}, "num_episodes": 6, "episode_return_max": 361.67056238335203, "episode_return_min": 336.22488803649713, "episode_return_mean": 350.7781791408852, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234048, "num_agent_steps_trained": 234048, "num_env_steps_sampled": 234048, "num_env_steps_trained": 234048, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.916884455625109, "num_env_steps_trained_throughput_per_sec": 13.916884455625109, "timesteps_total": 234048, "num_env_steps_sampled_lifetime": 234048, "num_agent_steps_sampled_lifetime": 234048, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 234048, "timers": {"training_iteration_time_ms": 37077.28, "restore_workers_time_ms": 0.025, "training_step_time_ms": 37077.207, "sample_time_ms": 36157.282, "load_time_ms": 1.565, "load_throughput": 329767.007, "learn_time_ms": 903.366, "learn_throughput": 571.197, "synch_weights_time_ms": 14.513}, "counters": {"num_env_steps_sampled": 234048, "num_env_steps_trained": 234048, "num_agent_steps_sampled": 234048, "num_agent_steps_trained": 234048}, "done": false, "episodes_total": 4847, "training_iteration": 180, "trial_id": "fd033_00000", "date": "2024-06-11_13-38-53", "timestamp": 1718134733, "time_this_iter_s": 37.08000135421753, "time_total_s": 16090.130586385727, "pid": 83397, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2786077259694819, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.16194868772046, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 37.08000135421753, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.04074074074074, "ram_util_percent": 11.72222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.43937891010205016, "cur_lr": 5e-06, "total_loss": 1.5025173944731554, "policy_loss": -0.023751274806757768, "vf_loss": 1.521462627997001, "vf_explained_var": 0.4493980055054029, "kl": 0.010938232693418589, "entropy": -1.798225670059522, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 234564, "num_env_steps_trained": 234564, "num_agent_steps_sampled": 234564, "num_agent_steps_trained": 234564}, "sampler_results": {"episode_reward_max": 368.99948349637776, "episode_reward_min": 330.54844432632837, "episode_reward_mean": 352.72911118148517, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.50832440644865, 361.67056238335203, 345.4730207323383, 354.6704825391748, 352.1217967474999, 336.22488803649713, 360.35501111892125, 368.99948349637776, 345.364252751832, 368.79328826117796, 363.846704405208, 345.3325241846158, 348.7973956678212, 330.54844432632837, 355.78439240200305, 346.1261006799115, 357.945400509726, 352.5619286174998], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.969896263718901, "mean_inference_ms": 1.3180474688867951, "mean_action_processing_ms": 0.2153793067823145, "mean_env_wait_ms": 361.6837544746386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012824270460340712, "StateBufferConnector_ms": 0.0065008799235026045, "ViewRequirementAgentConnector_ms": 0.17794900470309788}, "num_episodes": 12, "episode_return_max": 368.99948349637776, "episode_return_min": 330.54844432632837, "episode_return_mean": 352.72911118148517}, "env_runner_results": {"episode_reward_max": 368.99948349637776, "episode_reward_min": 330.54844432632837, "episode_reward_mean": 352.72911118148517, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.50832440644865, 361.67056238335203, 345.4730207323383, 354.6704825391748, 352.1217967474999, 336.22488803649713, 360.35501111892125, 368.99948349637776, 345.364252751832, 368.79328826117796, 363.846704405208, 345.3325241846158, 348.7973956678212, 330.54844432632837, 355.78439240200305, 346.1261006799115, 357.945400509726, 352.5619286174998], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.969896263718901, "mean_inference_ms": 1.3180474688867951, "mean_action_processing_ms": 0.2153793067823145, "mean_env_wait_ms": 361.6837544746386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012824270460340712, "StateBufferConnector_ms": 0.0065008799235026045, "ViewRequirementAgentConnector_ms": 0.17794900470309788}, "num_episodes": 12, "episode_return_max": 368.99948349637776, "episode_return_min": 330.54844432632837, "episode_return_mean": 352.72911118148517}, "episode_reward_max": 368.99948349637776, "episode_reward_min": 330.54844432632837, "episode_reward_mean": 352.72911118148517, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [354.50832440644865, 361.67056238335203, 345.4730207323383, 354.6704825391748, 352.1217967474999, 336.22488803649713, 360.35501111892125, 368.99948349637776, 345.364252751832, 368.79328826117796, 363.846704405208, 345.3325241846158, 348.7973956678212, 330.54844432632837, 355.78439240200305, 346.1261006799115, 357.945400509726, 352.5619286174998], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.969896263718901, "mean_inference_ms": 1.3180474688867951, "mean_action_processing_ms": 0.2153793067823145, "mean_env_wait_ms": 361.6837544746386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012824270460340712, "StateBufferConnector_ms": 0.0065008799235026045, "ViewRequirementAgentConnector_ms": 0.17794900470309788}, "num_episodes": 12, "episode_return_max": 368.99948349637776, "episode_return_min": 330.54844432632837, "episode_return_mean": 352.72911118148517, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234564, "num_agent_steps_trained": 234564, "num_env_steps_sampled": 234564, "num_env_steps_trained": 234564, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.069806811616793, "num_env_steps_trained_throughput_per_sec": 14.069806811616793, "timesteps_total": 234564, "num_env_steps_sampled_lifetime": 234564, "num_agent_steps_sampled_lifetime": 234564, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 234564, "timers": {"training_iteration_time_ms": 36875.784, "restore_workers_time_ms": 0.022, "training_step_time_ms": 36875.718, "sample_time_ms": 35989.787, "load_time_ms": 1.455, "load_throughput": 354535.321, "learn_time_ms": 869.9, "learn_throughput": 593.172, "synch_weights_time_ms": 14.205}, "counters": {"num_env_steps_sampled": 234564, "num_env_steps_trained": 234564, "num_agent_steps_sampled": 234564, "num_agent_steps_trained": 234564}, "done": false, "episodes_total": 4859, "training_iteration": 181, "trial_id": "fd033_00000", "date": "2024-06-11_13-39-29", "timestamp": 1718134769, "time_this_iter_s": 36.677757024765015, "time_total_s": 16126.808343410492, "pid": 83397, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2786077259694819, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.16194868772046, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 73.75775837898254, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.51538461538462, "ram_util_percent": 12.998076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.43937891010205016, "cur_lr": 5e-06, "total_loss": 1.6793082962433497, "policy_loss": -0.018264801567420365, "vf_loss": 1.6938092241684595, "vf_explained_var": 0.6133851662278176, "kl": 0.008566358372628405, "entropy": -1.8358885437250136, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 235080, "num_env_steps_trained": 235080, "num_agent_steps_sampled": 235080, "num_agent_steps_trained": 235080}, "sampler_results": {"episode_reward_max": 375.2049085454643, "episode_reward_min": 330.54844432632837, "episode_reward_mean": 352.40712240282727, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.50832440644865, 361.67056238335203, 345.4730207323383, 354.6704825391748, 352.1217967474999, 336.22488803649713, 360.35501111892125, 368.99948349637776, 345.364252751832, 368.79328826117796, 363.846704405208, 345.3325241846158, 348.7973956678212, 330.54844432632837, 355.78439240200305, 346.1261006799115, 357.945400509726, 352.5619286174998, 345.4699782015347, 352.6686202027869, 349.5352922623243, 351.0817274408073, 340.90168580610305, 358.1066261513132, 355.2179835237533, 375.2049085454643, 353.92634478869894, 341.9297116582448, 348.65519610615286, 350.39159613090203], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.254163657356959, "mean_inference_ms": 1.314087547271883, "mean_action_processing_ms": 0.21504765570832332, "mean_env_wait_ms": 351.2156164849497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013319651285807291, "StateBufferConnector_ms": 0.006455580393473308, "ViewRequirementAgentConnector_ms": 0.17816781997680664}, "num_episodes": 12, "episode_return_max": 375.2049085454643, "episode_return_min": 330.54844432632837, "episode_return_mean": 352.40712240282727}, "env_runner_results": {"episode_reward_max": 375.2049085454643, "episode_reward_min": 330.54844432632837, "episode_reward_mean": 352.40712240282727, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.50832440644865, 361.67056238335203, 345.4730207323383, 354.6704825391748, 352.1217967474999, 336.22488803649713, 360.35501111892125, 368.99948349637776, 345.364252751832, 368.79328826117796, 363.846704405208, 345.3325241846158, 348.7973956678212, 330.54844432632837, 355.78439240200305, 346.1261006799115, 357.945400509726, 352.5619286174998, 345.4699782015347, 352.6686202027869, 349.5352922623243, 351.0817274408073, 340.90168580610305, 358.1066261513132, 355.2179835237533, 375.2049085454643, 353.92634478869894, 341.9297116582448, 348.65519610615286, 350.39159613090203], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.254163657356959, "mean_inference_ms": 1.314087547271883, "mean_action_processing_ms": 0.21504765570832332, "mean_env_wait_ms": 351.2156164849497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013319651285807291, "StateBufferConnector_ms": 0.006455580393473308, "ViewRequirementAgentConnector_ms": 0.17816781997680664}, "num_episodes": 12, "episode_return_max": 375.2049085454643, "episode_return_min": 330.54844432632837, "episode_return_mean": 352.40712240282727}, "episode_reward_max": 375.2049085454643, "episode_reward_min": 330.54844432632837, "episode_reward_mean": 352.40712240282727, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [354.50832440644865, 361.67056238335203, 345.4730207323383, 354.6704825391748, 352.1217967474999, 336.22488803649713, 360.35501111892125, 368.99948349637776, 345.364252751832, 368.79328826117796, 363.846704405208, 345.3325241846158, 348.7973956678212, 330.54844432632837, 355.78439240200305, 346.1261006799115, 357.945400509726, 352.5619286174998, 345.4699782015347, 352.6686202027869, 349.5352922623243, 351.0817274408073, 340.90168580610305, 358.1066261513132, 355.2179835237533, 375.2049085454643, 353.92634478869894, 341.9297116582448, 348.65519610615286, 350.39159613090203], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.254163657356959, "mean_inference_ms": 1.314087547271883, "mean_action_processing_ms": 0.21504765570832332, "mean_env_wait_ms": 351.2156164849497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013319651285807291, "StateBufferConnector_ms": 0.006455580393473308, "ViewRequirementAgentConnector_ms": 0.17816781997680664}, "num_episodes": 12, "episode_return_max": 375.2049085454643, "episode_return_min": 330.54844432632837, "episode_return_mean": 352.40712240282727, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235080, "num_agent_steps_trained": 235080, "num_env_steps_sampled": 235080, "num_env_steps_trained": 235080, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 17.210911216812036, "num_env_steps_trained_throughput_per_sec": 17.210911216812036, "timesteps_total": 235080, "num_env_steps_sampled_lifetime": 235080, "num_agent_steps_sampled_lifetime": 235080, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 235080, "timers": {"training_iteration_time_ms": 34577.521, "restore_workers_time_ms": 0.022, "training_step_time_ms": 34577.456, "sample_time_ms": 33727.788, "load_time_ms": 1.333, "load_throughput": 387051.123, "learn_time_ms": 834.021, "learn_throughput": 618.69, "synch_weights_time_ms": 13.993}, "counters": {"num_env_steps_sampled": 235080, "num_env_steps_trained": 235080, "num_agent_steps_sampled": 235080, "num_agent_steps_trained": 235080}, "done": false, "episodes_total": 4871, "training_iteration": 182, "trial_id": "fd033_00000", "date": "2024-06-11_13-39-59", "timestamp": 1718134799, "time_this_iter_s": 29.984102964401245, "time_total_s": 16156.792446374893, "pid": 83397, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "m{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.21137842561804157, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0276348821818828, "policy_loss": -0.01350857517682016, "vf_loss": 1.0387841030955314, "vf_explained_var": 0.30415928984681767, "kl": 0.011161759708678663, "entropy": -1.5370225345094999, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 281934, "num_env_steps_trained": 281934, "num_agent_steps_sampled": 281934, "num_agent_steps_trained": 281934}, "sampler_results": {"episode_reward_max": 375.7049898371393, "episode_reward_min": 260.0378396092383, "episode_reward_mean": 338.781476350613, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [273.3091312563894, 372.4892969717914, 301.68929498957107, 345.1631045617211, 361.6509457540881, 369.8152204190261, 329.35409958859105, 260.0378396092383, 352.4823159583965, 299.46692043785134, 334.63710199099626, 347.4268307518587, 340.5395312788216, 375.7049898371393, 348.62776431780657, 363.4145685527279, 350.99683558407503, 371.2607824509453], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.358631989752599, "mean_inference_ms": 1.309223646341368, "mean_action_processing_ms": 0.21560848221298334, "mean_env_wait_ms": 300.69024502768997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012311670515272353, "StateBufferConnector_ms": 0.006454520755343967, "ViewRequirementAgentConnector_ms": 0.17928812238905165}, "num_episodes": 18, "episode_return_max": 375.7049898371393, "episode_return_min": 260.0378396092383, "episode_return_mean": 338.781476350613}, "env_runner_results": {"episode_reward_max": 375.7049898371393, "episode_reward_min": 260.0378396092383, "episode_reward_mean": 338.781476350613, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [273.3091312563894, 372.4892969717914, 301.68929498957107, 345.1631045617211, 361.6509457540881, 369.8152204190261, 329.35409958859105, 260.0378396092383, 352.4823159583965, 299.46692043785134, 334.63710199099626, 347.4268307518587, 340.5395312788216, 375.7049898371393, 348.62776431780657, 363.4145685527279, 350.99683558407503, 371.2607824509453], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.358631989752599, "mean_inference_ms": 1.309223646341368, "mean_action_processing_ms": 0.21560848221298334, "mean_env_wait_ms": 300.69024502768997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012311670515272353, "StateBufferConnector_ms": 0.006454520755343967, "ViewRequirementAgentConnector_ms": 0.17928812238905165}, "num_episodes": 18, "episode_return_max": 375.7049898371393, "episode_return_min": 260.0378396092383, "episode_return_mean": 338.781476350613}, "episode_reward_max": 375.7049898371393, "episode_reward_min": 260.0378396092383, "episode_reward_mean": 338.781476350613, "episode_len_mean": 50.0, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [273.3091312563894, 372.4892969717914, 301.68929498957107, 345.1631045617211, 361.6509457540881, 369.8152204190261, 329.35409958859105, 260.0378396092383, 352.4823159583965, 299.46692043785134, 334.63710199099626, 347.4268307518587, 340.5395312788216, 375.7049898371393, 348.62776431780657, 363.4145685527279, 350.99683558407503, 371.2607824509453], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.358631989752599, "mean_inference_ms": 1.309223646341368, "mean_action_processing_ms": 0.21560848221298334, "mean_env_wait_ms": 300.69024502768997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012311670515272353, "StateBufferConnector_ms": 0.006454520755343967, "ViewRequirementAgentConnector_ms": 0.17928812238905165}, "num_episodes": 18, "episode_return_max": 375.7049898371393, "episode_return_min": 260.0378396092383, "episode_return_mean": 338.781476350613, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 281934, "num_agent_steps_trained": 281934, "num_env_steps_sampled": 281934, "num_env_steps_trained": 281934, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 15.72316240881521, "num_env_steps_trained_throughput_per_sec": 15.72316240881521, "timesteps_total": 281934, "num_env_steps_sampled_lifetime": 281934, "num_agent_steps_sampled_lifetime": 281934, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 281934, "timers": {"training_iteration_time_ms": 65254.064, "restore_workers_time_ms": 0.021, "training_step_time_ms": 65253.994, "sample_time_ms": 63611.099, "load_time_ms": 1.579, "load_throughput": 649955.581, "learn_time_ms": 1626.485, "learn_throughput": 630.808, "synch_weights_time_ms": 14.292}, "counters": {"num_env_steps_sampled": 281934, "num_env_steps_trained": 281934, "num_agent_steps_sampled": 281934, "num_agent_steps_trained": 281934}, "done": false, "episodes_total": 5765, "training_iteration": 256, "trial_id": "fd033_00000", "date": "2024-06-11_14-49-10", "timestamp": 1718138950, "time_this_iter_s": 65.25728392601013, "time_total_s": 19359.285576105118, "pid": 2923, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.798641483540407, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9134699248008252, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 65.25728392601013, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.415957446808505, "ram_util_percent": 13.223404255319144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.21137842561804157, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9798667040963968, "policy_loss": -0.015015778403418759, "vf_loss": 0.9921227214237054, "vf_explained_var": 0.7619442003468673, "kl": 0.013056007327638024, "entropy": -1.7087241778771083, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 282960, "num_env_steps_trained": 282960, "num_agent_steps_sampled": 282960, "num_agent_steps_trained": 282960}, "sampler_results": {"episode_reward_max": 377.7370887804586, "episode_reward_min": 260.0378396092383, "episode_reward_mean": 344.7914392105655, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [273.3091312563894, 372.4892969717914, 301.68929498957107, 345.1631045617211, 361.6509457540881, 369.8152204190261, 329.35409958859105, 260.0378396092383, 352.4823159583965, 299.46692043785134, 334.63710199099626, 347.4268307518587, 340.5395312788216, 375.7049898371393, 348.62776431780657, 363.4145685527279, 350.99683558407503, 371.2607824509453, 362.47179285038834, 336.2191801029, 365.92641852362055, 337.6741511439062, 356.8708115347967, 326.0885303663518, 340.37442594834295, 340.570090466427, 364.94842193329475, 359.64702962310344, 315.58829172742963, 377.7370887804586, 356.73080719301095, 352.5298268123897, 358.2082395106333, 352.37900948409913, 342.6815532260279, 367.7795680421411], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.354252200459431, "mean_inference_ms": 1.308382965509325, "mean_action_processing_ms": 0.2153843111201626, "mean_env_wait_ms": 309.4625718169076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013589859008789062, "StateBufferConnector_ms": 0.006422069337632921, "ViewRequirementAgentConnector_ms": 0.17761455641852486}, "num_episodes": 18, "episode_return_max": 377.7370887804586, "episode_return_min": 260.0378396092383, "episode_return_mean": 344.7914392105655}, "env_runner_results": {"episode_reward_max": 377.7370887804586, "episode_reward_min": 260.0378396092383, "episode_reward_mean": 344.7914392105655, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [273.3091312563894, 372.4892969717914, 301.68929498957107, 345.1631045617211, 361.6509457540881, 369.8152204190261, 329.35409958859105, 260.0378396092383, 352.4823159583965, 299.46692043785134, 334.63710199099626, 347.4268307518587, 340.5395312788216, 375.7049898371393, 348.62776431780657, 363.4145685527279, 350.99683558407503, 371.2607824509453, 362.47179285038834, 336.2191801029, 365.92641852362055, 337.6741511439062, 356.8708115347967, 326.0885303663518, 340.37442594834295, 340.570090466427, 364.94842193329475, 359.64702962310344, 315.58829172742963, 377.7370887804586, 356.73080719301095, 352.5298268123897, 358.2082395106333, 352.37900948409913, 342.6815532260279, 367.7795680421411], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.354252200459431, "mean_inference_ms": 1.308382965509325, "mean_action_processing_ms": 0.2153843111201626, "mean_env_wait_ms": 309.4625718169076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013589859008789062, "StateBufferConnector_ms": 0.006422069337632921, "ViewRequirementAgentConnector_ms": 0.17761455641852486}, "num_episodes": 18, "episode_return_max": 377.7370887804586, "episode_return_min": 260.0378396092383, "episode_return_mean": 344.7914392105655}, "episode_reward_max": 377.7370887804586, "episode_reward_min": 260.0378396092383, "episode_reward_mean": 344.7914392105655, "episode_len_mean": 50.0, "episodes_this_iter": 18, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [273.3091312563894, 372.4892969717914, 301.68929498957107, 345.1631045617211, 361.6509457540881, 369.8152204190261, 329.35409958859105, 260.0378396092383, 352.4823159583965, 299.46692043785134, 334.63710199099626, 347.4268307518587, 340.5395312788216, 375.7049898371393, 348.62776431780657, 363.4145685527279, 350.99683558407503, 371.2607824509453, 362.47179285038834, 336.2191801029, 365.92641852362055, 337.6741511439062, 356.8708115347967, 326.0885303663518, 340.37442594834295, 340.570090466427, 364.94842193329475, 359.64702962310344, 315.58829172742963, 377.7370887804586, 356.73080719301095, 352.5298268123897, 358.2082395106333, 352.37900948409913, 342.6815532260279, 367.7795680421411], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.354252200459431, "mean_inference_ms": 1.308382965509325, "mean_action_processing_ms": 0.2153843111201626, "mean_env_wait_ms": 309.4625718169076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013589859008789062, "StateBufferConnector_ms": 0.006422069337632921, "ViewRequirementAgentConnector_ms": 0.17761455641852486}, "num_episodes": 18, "episode_return_max": 377.7370887804586, "episode_return_min": 260.0378396092383, "episode_return_mean": 344.7914392105655, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 282960, "num_agent_steps_trained": 282960, "num_env_steps_sampled": 282960, "num_env_steps_trained": 282960, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 15.685313277796025, "num_env_steps_trained_throughput_per_sec": 15.685313277796025, "timesteps_total": 282960, "num_env_steps_sampled_lifetime": 282960, "num_agent_steps_sampled_lifetime": 282960, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 282960, "timers": {"training_iteration_time_ms": 65332.796, "restore_workers_time_ms": 0.026, "training_step_time_ms": 65332.718, "sample_time_ms": 63760.713, "load_time_ms": 1.38, "load_throughput": 743431.961, "learn_time_ms": 1556.093, "learn_throughput": 659.343, "synch_weights_time_ms": 14.088}, "counters": {"num_env_steps_sampled": 282960, "num_env_steps_trained": 282960, "num_agent_steps_sampled": 282960, "num_agent_steps_trained": 282960}, "done": false, "episodes_total": 5783, "training_iteration": 257, "trial_id": "fd033_00000", "date": "2024-06-11_14-50-15", "timestamp": 1718139015, "time_this_iter_s": 65.41464352607727, "time_total_s": 19424.700219631195, "pid": 2923, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.798641483540407, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9134699248008252, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 130.6719274520874, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.73829787234041, "ram_util_percent": 13.892553191489363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4012887298842509, "cur_lr": 0.00010000000000000003, "total_loss": 0.9929369730254014, "policy_loss": -0.0049092807341367005, "vf_loss": 0.9973415608828267, "vf_explained_var": 0.6462931271642447, "kl": 0.0012576850338217845, "entropy": -1.7722668528556824, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 287076, "num_env_steps_trained": 287076, "num_agent_steps_sampled": 287076, "num_agent_steps_trained": 287076}, "sampler_results": {"episode_reward_max": 371.1000870836982, "episode_reward_min": 204.38332780937833, "episode_reward_mean": 343.8259516886546, "episode_len_mean": 49.67567567567568, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 1838, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.26212296362456, 349.95668925346905, 322.3994498137257, 336.1172600863036, 337.5581519713638, 347.4187577321498, 204.38332780937833, 366.81797250366515, 339.345677463983, 358.57484015513904, 367.8410431912268, 354.19467114269986, 325.2552040522656, 371.1000870836982, 350.08148937069143, 345.1867382315657, 352.89977442986554, 335.9613445570951, 349.9507921105858, 340.0714951162769, 352.9436300536642, 351.8797331871807, 358.16739023171726, 296.8854289110387, 349.18522799901655, 337.28435468467643, 317.51092884658, 361.29095420852684, 366.6029098672704, 345.91796243235206, 344.3435261226521, 368.65072201510054, 353.45469182985926, 359.89807220948614, 328.1194336306821, 356.3209421804311, 359.72741503121534], "episode_lengths": [50, 50, 50, 50, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.461935248933646, "mean_inference_ms": 1.3049517330872737, "mean_action_processing_ms": 0.21609051290879847, "mean_env_wait_ms": 340.01248969262235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013964240615432328, "StateBufferConnector_ms": 0.006419259148675042, "ViewRequirementAgentConnector_ms": 0.1786167557175095}, "num_episodes": 37, "episode_return_max": 371.1000870836982, "episode_return_min": 204.38332780937833, "episode_return_mean": 343.8259516886546}, "env_runner_results": {"episode_reward_max": 371.1000870836982, "episode_reward_min": 204.38332780937833, "episode_reward_mean": 343.8259516886546, "episode_len_mean": 49.67567567567568, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 1838, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.26212296362456, 349.95668925346905, 322.3994498137257, 336.1172600863036, 337.5581519713638, 347.4187577321498, 204.38332780937833, 366.81797250366515, 339.345677463983, 358.57484015513904, 367.8410431912268, 354.19467114269986, 325.2552040522656, 371.1000870836982, 350.08148937069143, 345.1867382315657, 352.89977442986554, 335.9613445570951, 349.9507921105858, 340.0714951162769, 352.9436300536642, 351.8797331871807, 358.16739023171726, 296.8854289110387, 349.18522799901655, 337.28435468467643, 317.51092884658, 361.29095420852684, 366.6029098672704, 345.91796243235206, 344.3435261226521, 368.65072201510054, 353.45469182985926, 359.89807220948614, 328.1194336306821, 356.3209421804311, 359.72741503121534], "episode_lengths": [50, 50, 50, 50, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.461935248933646, "mean_inference_ms": 1.3049517330872737, "mean_action_processing_ms": 0.21609051290879847, "mean_env_wait_ms": 340.01248969262235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013964240615432328, "StateBufferConnector_ms": 0.006419259148675042, "ViewRequirementAgentConnector_ms": 0.1786167557175095}, "num_episodes": 37, "episode_return_max": 371.1000870836982, "episode_return_min": 204.38332780937833, "episode_return_mean": 343.8259516886546}, "episode_reward_max": 371.1000870836982, "episode_reward_min": 204.38332780937833, "episode_reward_mean": 343.8259516886546, "episode_len_mean": 49.67567567567568, "episodes_this_iter": 37, "episodes_timesteps_total": 1838, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [358.26212296362456, 349.95668925346905, 322.3994498137257, 336.1172600863036, 337.5581519713638, 347.4187577321498, 204.38332780937833, 366.81797250366515, 339.345677463983, 358.57484015513904, 367.8410431912268, 354.19467114269986, 325.2552040522656, 371.1000870836982, 350.08148937069143, 345.1867382315657, 352.89977442986554, 335.9613445570951, 349.9507921105858, 340.0714951162769, 352.9436300536642, 351.8797331871807, 358.16739023171726, 296.8854289110387, 349.18522799901655, 337.28435468467643, 317.51092884658, 361.29095420852684, 366.6029098672704, 345.91796243235206, 344.3435261226521, 368.65072201510054, 353.45469182985926, 359.89807220948614, 328.1194336306821, 356.3209421804311, 359.72741503121534], "episode_lengths": [50, 50, 50, 50, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.461935248933646, "mean_inference_ms": 1.3049517330872737, "mean_action_processing_ms": 0.21609051290879847, "mean_env_wait_ms": 340.01248969262235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013964240615432328, "StateBufferConnector_ms": 0.006419259148675042, "ViewRequirementAgentConnector_ms": 0.1786167557175095}, "num_episodes": 37, "episode_return_max": 371.1000870836982, "episode_return_min": 204.38332780937833, "episode_return_mean": 343.8259516886546, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287076, "num_agent_steps_trained": 287076, "num_env_steps_sampled": 287076, "num_env_steps_trained": 287076, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 15.572584827978206, "num_env_steps_trained_throughput_per_sec": 15.572584827978206, "timesteps_total": 287076, "num_env_steps_sampled_lifetime": 287076, "num_agent_steps_sampled_lifetime": 287076, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 287076, "timers": {"training_iteration_time_ms": 131770.048, "restore_workers_time_ms": 0.031, "training_step_time_ms": 131769.966, "sample_time_ms": 128684.926, "load_time_ms": 1.623, "load_throughput": 1264391.334, "learn_time_ms": 3069.221, "learn_throughput": 668.574, "synch_weights_time_ms": 13.648}, "counters": {"num_env_steps_sampled": 287076, "num_env_steps_trained": 287076, "num_agent_steps_sampled": 287076, "num_agent_steps_trained": 287076}, "done": false, "episodes_total": 5868, "training_iteration": 262, "trial_id": "fd033_00000", "date": "2024-06-11_14-52-55", "timestamp": 1718139175, "time_this_iter_s": 131.7737798690796, "time_total_s": 19690.827382802963, "pid": 36108, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.6655345696170059, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629546587633159, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 131.7737798690796, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 43.668253968253964, "ram_util_percent": 13.370370370370372}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20064436494212545, "cur_lr": 0.00010000000000000003, "total_loss": 0.8938835218238333, "policy_loss": -0.004709299401535342, "vf_loss": 0.8967767416809996, "vf_explained_var": 0.482843912144502, "kl": 0.009051228547590226, "entropy": -1.878406090537707, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 720.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 289128, "num_env_steps_trained": 289128, "num_agent_steps_sampled": 289128, "num_agent_steps_trained": 289128}, "sampler_results": {"episode_reward_max": 378.0302241843853, "episode_reward_min": 204.38332780937833, "episode_reward_mean": 349.22397928737416, "episode_len_mean": 49.84615384615385, "episode_media": {}, "episodes_this_iter": 41, "episodes_timesteps_total": 3888, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.26212296362456, 349.95668925346905, 322.3994498137257, 336.1172600863036, 337.5581519713638, 347.4187577321498, 204.38332780937833, 366.81797250366515, 339.345677463983, 358.57484015513904, 367.8410431912268, 354.19467114269986, 325.2552040522656, 371.1000870836982, 350.08148937069143, 345.1867382315657, 352.89977442986554, 335.9613445570951, 349.9507921105858, 340.0714951162769, 352.9436300536642, 351.8797331871807, 358.16739023171726, 296.8854289110387, 349.18522799901655, 337.28435468467643, 317.51092884658, 361.29095420852684, 366.6029098672704, 345.91796243235206, 344.3435261226521, 368.65072201510054, 353.45469182985926, 359.89807220948614, 328.1194336306821, 356.3209421804311, 359.72741503121534, 339.7613296203304, 345.60178775959554, 350.3575933836407, 363.0378154349011, 367.18790921760797, 365.36370893152537, 368.699238569882, 358.9711078164547, 350.2805193138825, 335.91089362467255, 373.75150193163216, 378.0302241843853, 347.2954051174946, 373.3521231486436, 347.84852269450505, 350.6517561730513, 343.4680409385797, 351.34390569327246, 362.7370912014568, 354.68116532888877, 358.4052963424116, 365.6223854929534, 365.4991289859867, 344.75751709166144, 358.63523367074663, 345.3648744934628, 369.1653889623811, 370.04058259491416, 352.3868283273794, 352.164797825629, 311.47971541860886, 353.11610456613647, 352.4117540281413, 352.44352050861386, 332.0374475952084, 350.32554262875175, 371.80730970536064, 348.676771622045, 351.53702203753596, 326.7617297594166, 356.9395801932166], "episode_lengths": [50, 50, 50, 50, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.545550101200488, "mean_inference_ms": 1.3043704895982393, "mean_action_processing_ms": 0.21605957532005654, "mean_env_wait_ms": 340.17668914694065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013109659537290916, "StateBufferConnector_ms": 0.006466339796017378, "ViewRequirementAgentConnector_ms": 0.1806959127768492}, "num_episodes": 41, "episode_return_max": 378.0302241843853, "episode_return_min": 204.38332780937833, "episode_return_mean": 349.22397928737416}, "env_runner_results": {"episode_reward_max": 378.0302241843853, "episode_reward_min": 204.38332780937833, "episode_reward_mean": 349.22397928737416, "episode_len_mean": 49.84615384615385, "episode_media": {}, "episodes_this_iter": 41, "episodes_timesteps_total": 3888, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.26212296362456, 349.95668925346905, 322.3994498137257, 336.1172600863036, 337.5581519713638, 347.4187577321498, 204.38332780937833, 366.81797250366515, 339.345677463983, 358.57484015513904, 367.8410431912268, 354.19467114269986, 325.2552040522656, 371.1000870836982, 350.08148937069143, 345.1867382315657, 352.89977442986554, 335.9613445570951, 349.9507921105858, 340.0714951162769, 352.9436300536642, 351.8797331871807, 358.16739023171726, 296.8854289110387, 349.18522799901655, 337.28435468467643, 317.51092884658, 361.29095420852684, 366.6029098672704, 345.91796243235206, 344.3435261226521, 368.65072201510054, 353.45469182985926, 359.89807220948614, 328.1194336306821, 356.3209421804311, 359.72741503121534, 339.7613296203304, 345.60178775959554, 350.3575933836407, 363.0378154349011, 367.18790921760797, 365.36370893152537, 368.699238569882, 358.9711078164547, 350.2805193138825, 335.91089362467255, 373.75150193163216, 378.0302241843853, 347.2954051174946, 373.3521231486436, 347.84852269450505, 350.6517561730513, 343.4680409385797, 351.34390569327246, 362.7370912014568, 354.68116532888877, 358.4052963424116, 365.6223854929534, 365.4991289859867, 344.75751709166144, 358.63523367074663, 345.3648744934628, 369.1653889623811, 370.04058259491416, 352.3868283273794, 352.164797825629, 311.47971541860886, 353.11610456613647, 352.4117540281413, 352.44352050861386, 332.0374475952084, 350.32554262875175, 371.80730970536064, 348.676771622045, 351.53702203753596, 326.7617297594166, 356.9395801932166], "episode_lengths": [50, 50, 50, 50, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.545550101200488, "mean_inference_ms": 1.3043704895982393, "mean_action_processing_ms": 0.21605957532005654, "mean_env_wait_ms": 340.17668914694065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013109659537290916, "StateBufferConnector_ms": 0.006466339796017378, "ViewRequirementAgentConnector_ms": 0.1806959127768492}, "num_episodes": 41, "episode_return_max": 378.0302241843853, "episode_return_min": 204.38332780937833, "episode_return_mean": 349.22397928737416}, "episode_reward_max": 378.0302241843853, "episode_reward_min": 204.38332780937833, "episode_reward_mean": 349.22397928737416, "episode_len_mean": 49.84615384615385, "episodes_this_iter": 41, "episodes_timesteps_total": 3888, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [358.26212296362456, 349.95668925346905, 322.3994498137257, 336.1172600863036, 337.5581519713638, 347.4187577321498, 204.38332780937833, 366.81797250366515, 339.345677463983, 358.57484015513904, 367.8410431912268, 354.19467114269986, 325.2552040522656, 371.1000870836982, 350.08148937069143, 345.1867382315657, 352.89977442986554, 335.9613445570951, 349.9507921105858, 340.0714951162769, 352.9436300536642, 351.8797331871807, 358.16739023171726, 296.8854289110387, 349.18522799901655, 337.28435468467643, 317.51092884658, 361.29095420852684, 366.6029098672704, 345.91796243235206, 344.3435261226521, 368.65072201510054, 353.45469182985926, 359.89807220948614, 328.1194336306821, 356.3209421804311, 359.72741503121534, 339.7613296203304, 345.60178775959554, 350.3575933836407, 363.0378154349011, 367.18790921760797, 365.36370893152537, 368.699238569882, 358.9711078164547, 350.2805193138825, 335.91089362467255, 373.75150193163216, 378.0302241843853, 347.2954051174946, 373.3521231486436, 347.84852269450505, 350.6517561730513, 343.4680409385797, 351.34390569327246, 362.7370912014568, 354.68116532888877, 358.4052963424116, 365.6223854929534, 365.4991289859867, 344.75751709166144, 358.63523367074663, 345.3648744934628, 369.1653889623811, 370.04058259491416, 352.3868283273794, 352.164797825629, 311.47971541860886, 353.11610456613647, 352.4117540281413, 352.44352050861386, 332.0374475952084, 350.32554262875175, 371.80730970536064, 348.676771622045, 351.53702203753596, 326.7617297594166, 356.9395801932166], "episode_lengths": [50, 50, 50, 50, 50, 50, 38, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.545550101200488, "mean_inference_ms": 1.3043704895982393, "mean_action_processing_ms": 0.21605957532005654, "mean_env_wait_ms": 340.17668914694065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013109659537290916, "StateBufferConnector_ms": 0.006466339796017378, "ViewRequirementAgentConnector_ms": 0.1806959127768492}, "num_episodes": 41, "episode_return_max": 378.0302241843853, "episode_return_min": 204.38332780937833, "episode_return_mean": 349.22397928737416, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 289128, "num_agent_steps_trained": 289128, "num_env_steps_sampled": 289128, "num_env_steps_trained": 289128, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 15.405901096599116, "num_env_steps_trained_throughput_per_sec": 15.405901096599116, "timesteps_total": 289128, "num_env_steps_sampled_lifetime": 289128, "num_agent_steps_sampled_lifetime": 289128, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 289128, "timers": {"training_iteration_time_ms": 132482.887, "restore_workers_time_ms": 0.027, "training_step_time_ms": 132482.812, "sample_time_ms": 129395.528, "load_time_ms": 1.605, "load_throughput": 1278477.69, "learn_time_ms": 3071.645, "learn_throughput": 668.046, "synch_weights_time_ms": 13.565}, "counters": {"num_env_steps_sampled": 289128, "num_env_steps_trained": 289128, "num_agent_steps_sampled": 289128, "num_agent_steps_trained": 289128}, "done": false, "episodes_total": 5909, "training_iteration": 263, "trial_id": "fd033_00000", "date": "2024-06-11_14-55-08", "timestamp": 1718139308, "time_this_iter_s": 133.19963240623474, "time_total_s": 19824.027015209198, "pid": 36108, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.6655345696170059, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629546587633159, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 264.97341227531433, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.916842105263164, "ram_util_percent": 13.465263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20064436494212545, "cur_lr": 0.00010000000000000003, "total_loss": 0.9951935993817945, "policy_loss": -0.005202161986380816, "vf_loss": 0.9965041505172849, "vf_explained_var": 0.4923421166837215, "kl": 0.019395552690548615, "entropy": -1.8609158071378866, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1200.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 291180, "num_env_steps_trained": 291180, "num_agent_steps_sampled": 291180, "num_agent_steps_trained": 291180}, "sampler_results": {"episode_reward_max": 378.0302241843853, "episode_reward_min": 295.88980037733666, "episode_reward_mean": 352.17162005443913, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.9436300536642, 351.8797331871807, 358.16739023171726, 296.8854289110387, 349.18522799901655, 337.28435468467643, 317.51092884658, 361.29095420852684, 366.6029098672704, 345.91796243235206, 344.3435261226521, 368.65072201510054, 353.45469182985926, 359.89807220948614, 328.1194336306821, 356.3209421804311, 359.72741503121534, 339.7613296203304, 345.60178775959554, 350.3575933836407, 363.0378154349011, 367.18790921760797, 365.36370893152537, 368.699238569882, 358.9711078164547, 350.2805193138825, 335.91089362467255, 373.75150193163216, 378.0302241843853, 347.2954051174946, 373.3521231486436, 347.84852269450505, 350.6517561730513, 343.4680409385797, 351.34390569327246, 362.7370912014568, 354.68116532888877, 358.4052963424116, 365.6223854929534, 365.4991289859867, 344.75751709166144, 358.63523367074663, 345.3648744934628, 369.1653889623811, 370.04058259491416, 352.3868283273794, 352.164797825629, 311.47971541860886, 353.11610456613647, 352.4117540281413, 352.44352050861386, 332.0374475952084, 350.32554262875175, 371.80730970536064, 348.676771622045, 351.53702203753596, 326.7617297594166, 356.9395801932166, 334.83762226599913, 295.88980037733666, 366.90803800828303, 299.8388203272873, 356.1251369371211, 362.8704591538462, 370.8729549335064, 339.4817742171724, 327.12021818458385, 357.0004869732461, 321.8683904292834, 359.7879900777056, 363.35542713703023, 369.97995290658156, 352.5061551830794, 354.5123767816654, 348.93490226864685, 343.55377218056674, 371.7915456103583, 327.37693161292475, 369.69336808150115, 370.1028125182946, 332.0918992752472, 364.10993925078134, 354.83876768952, 365.4083986913186, 337.0385603044133, 366.21048012953554, 366.1376344013488, 365.16368107083747, 358.2459075327064, 341.26366095628816, 351.96058590240085, 367.2753917292221, 336.98791502493714, 373.520037246935, 369.5227006291535, 366.12840259592167, 318.35050587553826, 357.55841381318413, 357.0172949236684, 377.82939685852295], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.611113912475644, "mean_inference_ms": 1.3013107088160272, "mean_action_processing_ms": 0.2159018622761232, "mean_env_wait_ms": 343.05412724637904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01204538345336914, "StateBufferConnector_ms": 0.006401538848876953, "ViewRequirementAgentConnector_ms": 0.17941761016845703}, "num_episodes": 42, "episode_return_max": 378.0302241843853, "episode_return_min": 295.88980037733666, "episode_return_mean": 352.17162005443913}, "env_runner_results": {"episode_reward_max": 378.0302241843853, "episode_reward_min": 295.88980037733666, "episode_reward_mean": 352.17162005443913, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.9436300536642, 351.8797331871807, 358.16739023171726, 296.8854289110387, 349.18522799901655, 337.28435468467643, 317.51092884658, 361.29095420852684, 366.6029098672704, 345.91796243235206, 344.3435261226521, 368.65072201510054, 353.45469182985926, 359.89807220948614, 328.1194336306821, 356.3209421804311, 359.72741503121534, 339.7613296203304, 345.60178775959554, 350.3575933836407, 363.0378154349011, 367.18790921760797, 365.36370893152537, 368.699238569882, 358.9711078164547, 350.2805193138825, 335.91089362467255, 373.75150193163216, 378.0302241843853, 347.2954051174946, 373.3521231486436, 347.84852269450505, 350.6517561730513, 343.4680409385797, 351.34390569327246, 362.7370912014568, 354.68116532888877, 358.4052963424116, 365.6223854929534, 365.4991289859867, 344.75751709166144, 358.63523367074663, 345.3648744934628, 369.1653889623811, 370.04058259491416, 352.3868283273794, 352.164797825629, 311.47971541860886, 353.11610456613647, 352.4117540281413, 352.44352050861386, 332.0374475952084, 350.32554262875175, 371.80730970536064, 348.676771622045, 351.53702203753596, 326.7617297594166, 356.9395801932166, 334.83762226599913, 295.88980037733666, 366.90803800828303, 299.8388203272873, 356.1251369371211, 362.8704591538462, 370.8729549335064, 339.4817742171724, 327.12021818458385, 357.0004869732461, 321.8683904292834, 359.7879900777056, 363.35542713703023, 369.97995290658156, 352.5061551830794, 354.5123767816654, 348.93490226864685, 343.55377218056674, 371.7915456103583, 327.37693161292475, 369.69336808150115, 370.1028125182946, 332.0918992752472, 364.10993925078134, 354.83876768952, 365.4083986913186, 337.0385603044133, 366.21048012953554, 366.1376344013488, 365.16368107083747, 358.2459075327064, 341.26366095628816, 351.96058590240085, 367.2753917292221, 336.98791502493714, 373.520037246935, 369.5227006291535, 366.12840259592167, 318.35050587553826, 357.55841381318413, 357.0172949236684, 377.82939685852295], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.611113912475644, "mean_inference_ms": 1.3013107088160272, "mean_action_processing_ms": 0.2159018622761232, "mean_env_wait_ms": 343.05412724637904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01204538345336914, "StateBufferConnector_ms": 0.006401538848876953, "ViewRequirementAgentConnector_ms": 0.17941761016845703}, "num_episodes": 42, "episode_return_max": 378.0302241843853, "episode_return_min": 295.88980037733666, "episode_return_mean": 352.17162005443913}, "episode_reward_max": 378.0302241843853, "episode_reward_min": 295.88980037733666, "episode_reward_mean": 352.17162005443913, "episode_len_mean": 50.0, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [352.9436300536642, 351.8797331871807, 358.16739023171726, 296.8854289110387, 349.18522799901655, 337.28435468467643, 317.51092884658, 361.29095420852684, 366.6029098672704, 345.91796243235206, 344.3435261226521, 368.65072201510054, 353.45469182985926, 359.89807220948614, 328.1194336306821, 356.3209421804311, 359.72741503121534, 339.7613296203304, 345.60178775959554, 350.3575933836407, 363.0378154349011, 367.18790921760797, 365.36370893152537, 368.699238569882, 358.9711078164547, 350.2805193138825, 335.91089362467255, 373.75150193163216, 378.0302241843853, 347.2954051174946, 373.3521231486436, 347.84852269450505, 350.6517561730513, 343.4680409385797, 351.34390569327246, 362.7370912014568, 354.68116532888877, 358.4052963424116, 365.6223854929534, 365.4991289859867, 344.75751709166144, 358.63523367074663, 345.3648744934628, 369.1653889623811, 370.04058259491416, 352.3868283273794, 352.164797825629, 311.47971541860886, 353.11610456613647, 352.4117540281413, 352.44352050861386, 332.0374475952084, 350.32554262875175, 371.80730970536064, 348.676771622045, 351.53702203753596, 326.7617297594166, 356.9395801932166, 334.83762226599913, 295.88980037733666, 366.90803800828303, 299.8388203272873, 356.1251369371211, 362.8704591538462, 370.8729549335064, 339.4817742171724, 327.12021818458385, 357.0004869732461, 321.8683904292834, 359.7879900777056, 363.35542713703023, 369.97995290658156, 352.5061551830794, 354.5123767816654, 348.93490226864685, 343.55377218056674, 371.7915456103583, 327.37693161292475, 369.69336808150115, 370.1028125182946, 332.0918992752472, 364.10993925078134, 354.83876768952, 365.4083986913186, 337.0385603044133, 366.21048012953554, 366.1376344013488, 365.16368107083747, 358.2459075327064, 341.26366095628816, 351.96058590240085, 367.2753917292221, 336.98791502493714, 373.520037246935, 369.5227006291535, 366.12840259592167, 318.35050587553826, 357.55841381318413, 357.0172949236684, 377.82939685852295], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.611113912475644, "mean_inference_ms": 1.3013107088160272, "mean_action_processing_ms": 0.2159018622761232, "mean_env_wait_ms": 343.05412724637904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01204538345336914, "StateBufferConnector_ms": 0.006401538848876953, "ViewRequirementAgentConnector_ms": 0.17941761016845703}, "num_episodes": 42, "episode_return_max": 378.0302241843853, "episode_return_min": 295.88980037733666, "episode_return_mean": 352.17162005443913, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 291180, "num_agent_steps_trained": 291180, "num_env_steps_sampled": 291180, "num_env_steps_trained": 291180, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 14.067735966668062, "num_env_steps_trained_throughput_per_sec": 14.067735966668062, "timesteps_total": 291180, "num_env_steps_sampled_lifetime": 291180, "num_agent_steps_sampled_lifetime": 291180, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 291180, "timers": {"training_iteration_time_ms": 136943.827, "restore_workers_time_ms": 0.027, "training_step_time_ms": 136943.752, "sample_time_ms": 133842.399, "load_time_ms": 1.57, "load_throughput": 1307216.253, "learn_time_ms": 3085.649, "learn_throughput": 665.014, "synch_weights_time_ms": 13.695}, "counters": {"num_env_steps_sampled": 291180, "num_env_steps_trained": 291180, "num_agent_steps_sampled": 291180, "num_agent_steps_trained": 291180}, "done": false, "episodes_total": 5951, "training_iteration": 264, "trial_id": "fd033_00000", "date": "2024-06-11_14-57-34", "timestamp": 1718139454, "time_this_iter_s": 145.86949062347412, "time_total_s": 19969.896505832672, "pid": 36108, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.6655345696170059, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629546587633159, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 410.84290289878845, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 41.5298076923077, "ram_util_percent": 14.020673076923076}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20064436494212545, "cur_lr": 0.00010000000000000003, "total_loss": 0.8760291842743755, "policy_loss": -0.007020501090058436, "vf_loss": 0.8762233261018991, "vf_explained_var": 0.487834711248676, "kl": 0.03402216953933643, "entropy": -1.8223793553809324, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1680.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 293232, "num_env_steps_trained": 293232, "num_agent_steps_sampled": 293232, "num_agent_steps_trained": 293232}, "sampler_results": {"episode_reward_max": 377.82939685852295, "episode_reward_min": 295.88980037733666, "episode_reward_mean": 351.87306331153115, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [345.3648744934628, 369.1653889623811, 370.04058259491416, 352.3868283273794, 352.164797825629, 311.47971541860886, 353.11610456613647, 352.4117540281413, 352.44352050861386, 332.0374475952084, 350.32554262875175, 371.80730970536064, 348.676771622045, 351.53702203753596, 326.7617297594166, 356.9395801932166, 334.83762226599913, 295.88980037733666, 366.90803800828303, 299.8388203272873, 356.1251369371211, 362.8704591538462, 370.8729549335064, 339.4817742171724, 327.12021818458385, 357.0004869732461, 321.8683904292834, 359.7879900777056, 363.35542713703023, 369.97995290658156, 352.5061551830794, 354.5123767816654, 348.93490226864685, 343.55377218056674, 371.7915456103583, 327.37693161292475, 369.69336808150115, 370.1028125182946, 332.0918992752472, 364.10993925078134, 354.83876768952, 365.4083986913186, 337.0385603044133, 366.21048012953554, 366.1376344013488, 365.16368107083747, 358.2459075327064, 341.26366095628816, 351.96058590240085, 367.2753917292221, 336.98791502493714, 373.520037246935, 369.5227006291535, 366.12840259592167, 318.35050587553826, 357.55841381318413, 357.0172949236684, 377.82939685852295, 340.75449101010696, 362.09855154513605, 336.6153703093221, 367.14678242389647, 356.72537422898995, 334.95786158074327, 354.86749857431846, 366.7011280241801, 337.05686401585507, 365.07767258829324, 335.26815434190877, 335.560694389274, 348.9515973150593, 360.00393490282863, 335.73542473733636, 330.59500885209576, 351.38044994918675, 368.64662500746596, 359.63365437832636, 353.361624994229, 338.05692829836727, 323.20480731808135, 361.42173966336486, 350.6695997116711, 366.33547697882176, 372.360795776699, 340.20646680181966, 371.22001850979694, 373.97734796927193, 362.06616210937545, 364.4826489079002, 345.82752851079584, 355.3223042161492, 367.81546915152774, 364.760694973268, 319.001923247495, 345.22450892209673, 365.01942587499053, 349.9721844508944, 323.9002323615213, 365.40450339866896, 372.1893204976703], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.708061250328403, "mean_inference_ms": 1.2989996064685707, "mean_action_processing_ms": 0.21575410280674462, "mean_env_wait_ms": 343.7836158661892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010946273803710938, "StateBufferConnector_ms": 0.006412982940673828, "ViewRequirementAgentConnector_ms": 0.1791527271270752}, "num_episodes": 42, "episode_return_max": 377.82939685852295, "episode_return_min": 295.88980037733666, "episode_return_mean": 351.87306331153115}, "env_runner_results": {"episode_reward_max": 377.82939685852295, "episode_reward_min": 295.88980037733666, "episode_reward_mean": 351.87306331153115, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [345.3648744934628, 369.1653889623811, 370.04058259491416, 352.3868283273794, 352.164797825629, 311.47971541860886, 353.11610456613647, 352.4117540281413, 352.44352050861386, 332.0374475952084, 350.32554262875175, 371.80730970536064, 348.676771622045, 351.53702203753596, 326.7617297594166, 356.9395801932166, 334.83762226599913, 295.88980037733666, 366.90803800828303, 299.8388203272873, 356.1251369371211, 362.8704591538462, 370.8729549335064, 339.4817742171724, 327.12021818458385, 357.0004869732461, 321.8683904292834, 359.7879900777056, 363.35542713703023, 369.97995290658156, 352.5061551830794, 354.5123767816654, 348.93490226864685, 343.55377218056674, 371.7915456103583, 327.37693161292475, 369.69336808150115, 370.1028125182946, 332.0918992752472, 364.10993925078134, 354.83876768952, 365.4083986913186, 337.0385603044133, 366.21048012953554, 366.1376344013488, 365.16368107083747, 358.2459075327064, 341.26366095628816, 351.96058590240085, 367.2753917292221, 336.98791502493714, 373.520037246935, 369.5227006291535, 366.12840259592167, 318.35050587553826, 357.55841381318413, 357.0172949236684, 377.82939685852295, 340.75449101010696, 362.09855154513605, 336.6153703093221, 367.14678242389647, 356.72537422898995, 334.95786158074327, 354.86749857431846, 366.7011280241801, 337.05686401585507, 365.07767258829324, 335.26815434190877, 335.560694389274, 348.9515973150593, 360.00393490282863, 335.73542473733636, 330.59500885209576, 351.38044994918675, 368.64662500746596, 359.63365437832636, 353.361624994229, 338.05692829836727, 323.20480731808135, 361.42173966336486, 350.6695997116711, 366.33547697882176, 372.360795776699, 340.20646680181966, 371.22001850979694, 373.97734796927193, 362.06616210937545, 364.4826489079002, 345.82752851079584, 355.3223042161492, 367.81546915152774, 364.760694973268, 319.001923247495, 345.22450892209673, 365.01942587499053, 349.9721844508944, 323.9002323615213, 365.40450339866896, 372.1893204976703], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.708061250328403, "mean_inference_ms": 1.2989996064685707, "mean_action_processing_ms": 0.21575410280674462, "mean_env_wait_ms": 343.7836158661892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010946273803710938, "StateBufferConnector_ms": 0.006412982940673828, "ViewRequirementAgentConnector_ms": 0.1791527271270752}, "num_episodes": 42, "episode_return_max": 377.82939685852295, "episode_return_min": 295.88980037733666, "episode_return_mean": 351.87306331153115}, "episode_reward_max": 377.82939685852295, "episode_reward_min": 295.88980037733666, "episode_reward_mean": 351.87306331153115, "episode_len_mean": 50.0, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [345.3648744934628, 369.1653889623811, 370.04058259491416, 352.3868283273794, 352.164797825629, 311.47971541860886, 353.11610456613647, 352.4117540281413, 352.44352050861386, 332.0374475952084, 350.32554262875175, 371.80730970536064, 348.676771622045, 351.53702203753596, 326.7617297594166, 356.9395801932166, 334.83762226599913, 295.88980037733666, 366.90803800828303, 299.8388203272873, 356.1251369371211, 362.8704591538462, 370.8729549335064, 339.4817742171724, 327.12021818458385, 357.0004869732461, 321.8683904292834, 359.7879900777056, 363.35542713703023, 369.97995290658156, 352.5061551830794, 354.5123767816654, 348.93490226864685, 343.55377218056674, 371.7915456103583, 327.37693161292475, 369.69336808150115, 370.1028125182946, 332.0918992752472, 364.10993925078134, 354.83876768952, 365.4083986913186, 337.0385603044133, 366.21048012953554, 366.1376344013488, 365.16368107083747, 358.2459075327064, 341.26366095628816, 351.96058590240085, 367.2753917292221, 336.98791502493714, 373.520037246935, 369.5227006291535, 366.12840259592167, 318.35050587553826, 357.55841381318413, 357.0172949236684, 377.82939685852295, 340.75449101010696, 362.09855154513605, 336.6153703093221, 367.14678242389647, 356.72537422898995, 334.95786158074327, 354.86749857431846, 366.7011280241801, 337.05686401585507, 365.07767258829324, 335.26815434190877, 335.560694389274, 348.9515973150593, 360.00393490282863, 335.73542473733636, 330.59500885209576, 351.38044994918675, 368.64662500746596, 359.63365437832636, 353.361624994229, 338.05692829836727, 323.20480731808135, 361.42173966336486, 350.6695997116711, 366.33547697882176, 372.360795776699, 340.20646680181966, 371.22001850979694, 373.97734796927193, 362.06616210937545, 364.4826489079002, 345.82752851079584, 355.3223042161492, 367.81546915152774, 364.760694973268, 319.001923247495, 345.22450892209673, 365.01942587499053, 349.9721844508944, 323.9002323615213, 365.40450339866896, 372.1893204976703], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.708061250328403, "mean_inference_ms": 1.2989996064685707, "mean_action_processing_ms": 0.21575410280674462, "mean_env_wait_ms": 343.7836158661892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010946273803710938, "StateBufferConnector_ms": 0.006412982940673828, "ViewRequirementAgentConnector_ms": 0.1791527271270752}, "num_episodes": 42, "episode_return_max": 377.82939685852295, "episode_return_min": 295.88980037733666, "episode_return_mean": 351.87306331153115, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 293232, "num_agent_steps_trained": 293232, "num_env_steps_sampled": 293232, "num_env_steps_trained": 293232, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 15.332368928823035, "num_env_steps_trained_throughput_per_sec": 15.332368928823035, "timesteps_total": 293232, "num_env_steps_sampled_lifetime": 293232, "num_agent_steps_sampled_lifetime": 293232, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 293232, "timers": {"training_iteration_time_ms": 136166.501, "restore_workers_time_ms": 0.027, "training_step_time_ms": 136166.424, "sample_time_ms": 133075.799, "load_time_ms": 1.551, "load_throughput": 1323142.597, "learn_time_ms": 3074.869, "learn_throughput": 667.346, "synch_weights_time_ms": 13.774}, "counters": {"num_env_steps_sampled": 293232, "num_env_steps_trained": 293232, "num_agent_steps_sampled": 293232, "num_agent_steps_trained": 293232}, "done": false, "episodes_total": 5993, "training_iteration": 265, "trial_id": "fd033_00000", "date": "2024-06-11_14-59-48", "timestamp": 1718139588, "time_this_iter_s": 133.83838033676147, "time_total_s": 20103.734886169434, "pid": 36108, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.6655345696170059, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629546587633159, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 544.6812832355499, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.317277486910996, "ram_util_percent": 13.794764397905755}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3009665474131883, "cur_lr": 0.00010000000000000003, "total_loss": 0.9327552138827742, "policy_loss": -0.007573284527946574, "vf_loss": 0.9356380828966697, "vf_explained_var": 0.6909188717603684, "kl": 0.015584510958191104, "entropy": -1.8170053996145725, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2160.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 295284, "num_env_steps_trained": 295284, "num_agent_steps_sampled": 295284, "num_agent_steps_trained": 295284}, "sampler_results": {"episode_reward_max": 377.82939685852295, "episode_reward_min": 318.35050587553826, "episode_reward_mean": 353.0295448761166, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0385603044133, 366.21048012953554, 366.1376344013488, 365.16368107083747, 358.2459075327064, 341.26366095628816, 351.96058590240085, 367.2753917292221, 336.98791502493714, 373.520037246935, 369.5227006291535, 366.12840259592167, 318.35050587553826, 357.55841381318413, 357.0172949236684, 377.82939685852295, 340.75449101010696, 362.09855154513605, 336.6153703093221, 367.14678242389647, 356.72537422898995, 334.95786158074327, 354.86749857431846, 366.7011280241801, 337.05686401585507, 365.07767258829324, 335.26815434190877, 335.560694389274, 348.9515973150593, 360.00393490282863, 335.73542473733636, 330.59500885209576, 351.38044994918675, 368.64662500746596, 359.63365437832636, 353.361624994229, 338.05692829836727, 323.20480731808135, 361.42173966336486, 350.6695997116711, 366.33547697882176, 372.360795776699, 340.20646680181966, 371.22001850979694, 373.97734796927193, 362.06616210937545, 364.4826489079002, 345.82752851079584, 355.3223042161492, 367.81546915152774, 364.760694973268, 319.001923247495, 345.22450892209673, 365.01942587499053, 349.9721844508944, 323.9002323615213, 365.40450339866896, 372.1893204976703, 357.8944516165164, 326.00710473996236, 364.7084402861163, 364.9395457596173, 371.43782229825507, 343.8374012431464, 353.71338104389673, 346.93668386068225, 371.06692774720796, 356.3545804056191, 377.1012791064892, 372.1858131315175, 337.8441215225802, 337.6228118805271, 348.5760088346416, 345.34582667653865, 356.62639726238694, 369.824517493768, 366.705277291074, 340.34164659853275, 367.9635505283804, 353.47960769268303, 340.8032147851799, 337.97837074147077, 326.1022460616871, 330.4120178730824, 352.3983033899977, 328.1823508664024, 354.77749699711654, 333.7842248234623, 356.64621746855073, 345.16402936896986, 344.83517281178626, 340.1007843126927, 367.3141869391785, 372.3795389120212, 334.83711415000124, 367.5020906750229, 373.2965452808179, 366.75627195934305, 325.8466228209652, 363.535070540358], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.740023217188329, "mean_inference_ms": 1.2956308360369115, "mean_action_processing_ms": 0.21517192129727347, "mean_env_wait_ms": 341.8810162897686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01007223129272461, "StateBufferConnector_ms": 0.006406545639038086, "ViewRequirementAgentConnector_ms": 0.17847299575805664}, "num_episodes": 42, "episode_return_max": 377.82939685852295, "episode_return_min": 318.35050587553826, "episode_return_mean": 353.0295448761166}, "env_runner_results": {"episode_reward_max": 377.82939685852295, "episode_reward_min": 318.35050587553826, "episode_reward_mean": 353.0295448761166, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0385603044133, 366.21048012953554, 366.1376344013488, 365.16368107083747, 358.2459075327064, 341.26366095628816, 351.96058590240085, 367.2753917292221, 336.98791502493714, 373.520037246935, 369.5227006291535, 366.12840259592167, 318.35050587553826, 357.55841381318413, 357.0172949236684, 377.82939685852295, 340.75449101010696, 362.09855154513605, 336.6153703093221, 367.14678242389647, 356.72537422898995, 334.95786158074327, 354.86749857431846, 366.7011280241801, 337.05686401585507, 365.07767258829324, 335.26815434190877, 335.560694389274, 348.9515973150593, 360.00393490282863, 335.73542473733636, 330.59500885209576, 351.38044994918675, 368.64662500746596, 359.63365437832636, 353.361624994229, 338.05692829836727, 323.20480731808135, 361.42173966336486, 350.6695997116711, 366.33547697882176, 372.360795776699, 340.20646680181966, 371.22001850979694, 373.97734796927193, 362.06616210937545, 364.4826489079002, 345.82752851079584, 355.3223042161492, 367.81546915152774, 364.760694973268, 319.001923247495, 345.22450892209673, 365.01942587499053, 349.9721844508944, 323.9002323615213, 365.40450339866896, 372.1893204976703, 357.8944516165164, 326.00710473996236, 364.7084402861163, 364.9395457596173, 371.43782229825507, 343.8374012431464, 353.71338104389673, 346.93668386068225, 371.06692774720796, 356.3545804056191, 377.1012791064892, 372.1858131315175, 337.8441215225802, 337.6228118805271, 348.5760088346416, 345.34582667653865, 356.62639726238694, 369.824517493768, 366.705277291074, 340.34164659853275, 367.9635505283804, 353.47960769268303, 340.8032147851799, 337.97837074147077, 326.1022460616871, 330.4120178730824, 352.3983033899977, 328.1823508664024, 354.77749699711654, 333.7842248234623, 356.64621746855073, 345.16402936896986, 344.83517281178626, 340.1007843126927, 367.3141869391785, 372.3795389120212, 334.83711415000124, 367.5020906750229, 373.2965452808179, 366.75627195934305, 325.8466228209652, 363.535070540358], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.740023217188329, "mean_inference_ms": 1.2956308360369115, "mean_action_processing_ms": 0.21517192129727347, "mean_env_wait_ms": 341.8810162897686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01007223129272461, "StateBufferConnector_ms": 0.006406545639038086, "ViewRequirementAgentConnector_ms": 0.17847299575805664}, "num_episodes": 42, "episode_return_max": 377.82939685852295, "episode_return_min": 318.35050587553826, "episode_return_mean": 353.0295448761166}, "episode_reward_max": 377.82939685852295, "episode_reward_min": 318.35050587553826, "episode_reward_mean": 353.0295448761166, "episode_len_mean": 50.0, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [337.0385603044133, 366.21048012953554, 366.1376344013488, 365.16368107083747, 358.2459075327064, 341.26366095628816, 351.96058590240085, 367.2753917292221, 336.98791502493714, 373.520037246935, 369.5227006291535, 366.12840259592167, 318.35050587553826, 357.55841381318413, 357.0172949236684, 377.82939685852295, 340.75449101010696, 362.09855154513605, 336.6153703093221, 367.14678242389647, 356.72537422898995, 334.95786158074327, 354.86749857431846, 366.7011280241801, 337.05686401585507, 365.07767258829324, 335.26815434190877, 335.560694389274, 348.9515973150593, 360.00393490282863, 335.73542473733636, 330.59500885209576, 351.38044994918675, 368.64662500746596, 359.63365437832636, 353.361624994229, 338.05692829836727, 323.20480731808135, 361.42173966336486, 350.6695997116711, 366.33547697882176, 372.360795776699, 340.20646680181966, 371.22001850979694, 373.97734796927193, 362.06616210937545, 364.4826489079002, 345.82752851079584, 355.3223042161492, 367.81546915152774, 364.760694973268, 319.001923247495, 345.22450892209673, 365.01942587499053, 349.9721844508944, 323.9002323615213, 365.40450339866896, 372.1893204976703, 357.8944516165164, 326.00710473996236, 364.7084402861163, 364.9395457596173, 371.43782229825507, 343.8374012431464, 353.71338104389673, 346.93668386068225, 371.06692774720796, 356.3545804056191, 377.1012791064892, 372.1858131315175, 337.8441215225802, 337.6228118805271, 348.5760088346416, 345.34582667653865, 356.62639726238694, 369.824517493768, 366.705277291074, 340.34164659853275, 367.9635505283804, 353.47960769268303, 340.8032147851799, 337.97837074147077, 326.1022460616871, 330.4120178730824, 352.3983033899977, 328.1823508664024, 354.77749699711654, 333.7842248234623, 356.64621746855073, 345.16402936896986, 344.83517281178626, 340.1007843126927, 367.3141869391785, 372.3795389120212, 334.83711415000124, 367.5020906750229, 373.2965452808179, 366.75627195934305, 325.8466228209652, 363.535070540358], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.740023217188329, "mean_inference_ms": 1.2956308360369115, "mean_action_processing_ms": 0.21517192129727347, "mean_env_wait_ms": 341.8810162897686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01007223129272461, "StateBufferConnector_ms": 0.006406545639038086, "ViewRequirementAgentConnector_ms": 0.17847299575805664}, "num_episodes": 42, "episode_return_max": 377.82939685852295, "episode_return_min": 318.35050587553826, "episode_return_mean": 353.0295448761166, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 295284, "num_agent_steps_trained": 295284, "num_env_steps_sampled": 295284, "num_env_steps_trained": 295284, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 15.8200972775743, "num_env_steps_trained_throughput_per_sec": 15.8200972775743, "timesteps_total": 295284, "num_env_steps_sampled_lifetime": 295284, "num_agent_steps_sampled_lifetime": 295284, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 295284, "timers": {"training_iteration_time_ms": 134874.89, "restore_workers_time_ms": 0.028, "training_step_time_ms": 134874.814, "sample_time_ms": 131804.26, "load_time_ms": 1.541, "load_throughput": 1331525.079, "learn_time_ms": 3054.86, "learn_throughput": 671.717, "synch_weights_time_ms": 13.735}, "counters": {"num_env_steps_sampled": 295284, "num_env_steps_trained": 295284, "num_agent_steps_sampled": 295284, "num_agent_steps_trained": 295284}, "done": false, "episodes_total": 6035, "training_iteration": 266, "trial_id": "fd033_00000", "date": "2024-06-11_15-01-57", "timestamp": 1718139717, "time_this_iter_s": 129.7127468585968, "time_total_s": 20233.44763302803, "pid": 36108, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.6655345696170059, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629546587633159, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 674.3940300941467, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 37.05567567567568, "ram_util_percent": 12.434594594594598}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3009665474131883, "cur_lr": 0.00010000000000000003, "total_loss": 0.9165788629713157, "policy_loss": -0.004886232401865224, "vf_loss": 0.920850750245154, "vf_explained_var": 0.43813258223235607, "kl": 0.0020412296339602422, "entropy": -1.7521971240639687, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 297336, "num_env_steps_trained": 297336, "num_agent_steps_sampled": 297336, "num_agent_steps_trained": 297336}, "sampler_results": {"episode_reward_max": 373.747112984236, "episode_reward_min": 151.1814987734633, "episode_reward_mean": 347.1382708696487, "episode_len_mean": 49.4054054054054, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 1828, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [363.2062845978859, 362.35700061581366, 325.9474383902875, 338.9214779218181, 366.544184652995, 332.838168519208, 357.4443490997685, 328.91453968679167, 366.89038590228694, 364.9825023213745, 355.90833767744095, 331.28275804990943, 373.6933338790822, 350.07791027481187, 371.7444691756632, 350.14574555798265, 351.1542262538831, 347.7237476382047, 345.633925599025, 369.3304713511482, 359.97006843759465, 372.7434604374379, 343.94902193176466, 321.68115188483495, 339.0908376905948, 340.15006115506196, 363.79414532287404, 365.2157536691156, 340.69562648041966, 358.61208739211344, 348.5368716086797, 373.747112984236, 151.1814987734633, 356.1987756877086, 339.9674724989886, 364.4194598617003, 349.42135919503454], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.452599614499335, "mean_inference_ms": 1.2919208455072606, "mean_action_processing_ms": 0.21564084092791638, "mean_env_wait_ms": 314.60593120772444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013855341318491343, "StateBufferConnector_ms": 0.006652522731471706, "ViewRequirementAgentConnector_ms": 0.17820822226034627}, "num_episodes": 37, "episode_return_max": 373.747112984236, "episode_return_min": 151.1814987734633, "episode_return_mean": 347.1382708696487}, "env_runner_results": {"episode_reward_max": 373.747112984236, "episode_reward_min": 151.1814987734633, "episode_reward_mean": 347.1382708696487, "episode_len_mean": 49.4054054054054, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 1828, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [363.2062845978859, 362.35700061581366, 325.9474383902875, 338.9214779218181, 366.544184652995, 332.838168519208, 357.4443490997685, 328.91453968679167, 366.89038590228694, 364.9825023213745, 355.90833767744095, 331.28275804990943, 373.6933338790822, 350.07791027481187, 371.7444691756632, 350.14574555798265, 351.1542262538831, 347.7237476382047, 345.633925599025, 369.3304713511482, 359.97006843759465, 372.7434604374379, 343.94902193176466, 321.68115188483495, 339.0908376905948, 340.15006115506196, 363.79414532287404, 365.2157536691156, 340.69562648041966, 358.61208739211344, 348.5368716086797, 373.747112984236, 151.1814987734633, 356.1987756877086, 339.9674724989886, 364.4194598617003, 349.42135919503454], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.452599614499335, "mean_inference_ms": 1.2919208455072606, "mean_action_processing_ms": 0.21564084092791638, "mean_env_wait_ms": 314.60593120772444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013855341318491343, "StateBufferConnector_ms": 0.006652522731471706, "ViewRequirementAgentConnector_ms": 0.17820822226034627}, "num_episodes": 37, "episode_return_max": 373.747112984236, "episode_return_min": 151.1814987734633, "episode_return_mean": 347.1382708696487}, "episode_reward_max": 373.747112984236, "episode_reward_min": 151.1814987734633, "episode_reward_mean": 347.1382708696487, "episode_len_mean": 49.4054054054054, "episodes_this_iter": 37, "episodes_timesteps_total": 1828, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [363.2062845978859, 362.35700061581366, 325.9474383902875, 338.9214779218181, 366.544184652995, 332.838168519208, 357.4443490997685, 328.91453968679167, 366.89038590228694, 364.9825023213745, 355.90833767744095, 331.28275804990943, 373.6933338790822, 350.07791027481187, 371.7444691756632, 350.14574555798265, 351.1542262538831, 347.7237476382047, 345.633925599025, 369.3304713511482, 359.97006843759465, 372.7434604374379, 343.94902193176466, 321.68115188483495, 339.0908376905948, 340.15006115506196, 363.79414532287404, 365.2157536691156, 340.69562648041966, 358.61208739211344, 348.5368716086797, 373.747112984236, 151.1814987734633, 356.1987756877086, 339.9674724989886, 364.4194598617003, 349.42135919503454], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 28, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.452599614499335, "mean_inference_ms": 1.2919208455072606, "mean_action_processing_ms": 0.21564084092791638, "mean_env_wait_ms": 314.60593120772444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013855341318491343, "StateBufferConnector_ms": 0.006652522731471706, "ViewRequirementAgentConnector_ms": 0.17820822226034627}, "num_episodes": 37, "episode_return_max": 373.747112984236, "episode_return_min": 151.1814987734633, "episode_return_mean": 347.1382708696487, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 297336, "num_agent_steps_trained": 297336, "num_env_steps_sampled": 297336, "num_env_steps_trained": 297336, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 15.955155506002471, "num_env_steps_trained_throughput_per_sec": 15.955155506002471, "timesteps_total": 297336, "num_env_steps_sampled_lifetime": 297336, "num_agent_steps_sampled_lifetime": 297336, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 297336, "timers": {"training_iteration_time_ms": 128610.481, "restore_workers_time_ms": 0.024, "training_step_time_ms": 128610.408, "sample_time_ms": 125311.182, "load_time_ms": 1.675, "load_throughput": 1224980.331, "learn_time_ms": 3282.815, "learn_throughput": 625.073, "synch_weights_time_ms": 14.098}, "counters": {"num_env_steps_sampled": 297336, "num_env_steps_trained": 297336, "num_agent_steps_sampled": 297336, "num_agent_steps_trained": 297336}, "done": false, "episodes_total": 6072, "training_iteration": 267, "trial_id": "fd033_00000", "date": "2024-06-11_15-04-44", "timestamp": 1718139884, "time_this_iter_s": 128.6138837337494, "time_total_s": 20362.06151676178, "pid": 76874, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.6655345696170059, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.7629546587633159, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 128.6138837337494, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.35978260869565, "ram_util_percent": 13.43913043478261}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0157620975195099, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7400764206113915, "policy_loss": -0.005060232671288152, "vf_loss": 0.744104518617193, "vf_explained_var": 0.46894419317444164, "kl": 0.0010161153709459152, "entropy": -1.906638183693091, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 297360, "num_env_steps_trained": 297360, "num_agent_steps_sampled": 297360, "num_agent_steps_trained": 297360}, "sampler_results": {"episode_reward_max": 378.92988258137785, "episode_reward_min": 203.70788946993486, "episode_reward_mean": 355.3861260398121, "episode_len_mean": 49.5945945945946, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 1835, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.0215955548498, 374.2432982573254, 344.7197903268969, 335.59687637996, 378.92988258137785, 358.18172434593254, 374.7329588476977, 332.4190381245191, 364.91925893166695, 360.30100321542346, 368.35669508160214, 367.10259582428876, 353.4820330209687, 375.09835205078184, 352.40894276803107, 354.6539063774572, 378.6710178155556, 347.43933635727166, 203.70788946993486, 354.4737892867677, 360.5324699823075, 365.57522047577777, 372.6813828307943, 350.6027255098175, 319.18081176201355, 355.5942753482043, 373.0673723095157, 366.69798855763696, 368.68037315287245, 328.1282862288457, 358.72246717334787, 372.932503027515, 375.8209017871717, 363.25415514216974, 378.6207949378101, 355.7705071520193, 352.96444347691994], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.427424859403202, "mean_inference_ms": 1.2993769540111186, "mean_action_processing_ms": 0.213412056483235, "mean_env_wait_ms": 349.2193498206414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013885626921782622, "StateBufferConnector_ms": 0.006477897231643264, "ViewRequirementAgentConnector_ms": 0.17966644184009448}, "num_episodes": 37, "episode_return_max": 378.92988258137785, "episode_return_min": 203.70788946993486, "episode_return_mean": 355.3861260398121}, "env_runner_results": {"episode_reward_max": 378.92988258137785, "episode_reward_min": 203.70788946993486, "episode_reward_mean": 355.3861260398121, "episode_len_mean": 49.5945945945946, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 1835, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.0215955548498, 374.2432982573254, 344.7197903268969, 335.59687637996, 378.92988258137785, 358.18172434593254, 374.7329588476977, 332.4190381245191, 364.91925893166695, 360.30100321542346, 368.35669508160214, 367.10259582428876, 353.4820330209687, 375.09835205078184, 352.40894276803107, 354.6539063774572, 378.6710178155556, 347.43933635727166, 203.70788946993486, 354.4737892867677, 360.5324699823075, 365.57522047577777, 372.6813828307943, 350.6027255098175, 319.18081176201355, 355.5942753482043, 373.0673723095157, 366.69798855763696, 368.68037315287245, 328.1282862288457, 358.72246717334787, 372.932503027515, 375.8209017871717, 363.25415514216974, 378.6207949378101, 355.7705071520193, 352.96444347691994], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.427424859403202, "mean_inference_ms": 1.2993769540111186, "mean_action_processing_ms": 0.213412056483235, "mean_env_wait_ms": 349.2193498206414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013885626921782622, "StateBufferConnector_ms": 0.006477897231643264, "ViewRequirementAgentConnector_ms": 0.17966644184009448}, "num_episodes": 37, "episode_return_max": 378.92988258137785, "episode_return_min": 203.70788946993486, "episode_return_mean": 355.3861260398121}, "episode_reward_max": 378.92988258137785, "episode_reward_min": 203.70788946993486, "episode_reward_mean": 355.3861260398121, "episode_len_mean": 49.5945945945946, "episodes_this_iter": 37, "episodes_timesteps_total": 1835, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [351.0215955548498, 374.2432982573254, 344.7197903268969, 335.59687637996, 378.92988258137785, 358.18172434593254, 374.7329588476977, 332.4190381245191, 364.91925893166695, 360.30100321542346, 368.35669508160214, 367.10259582428876, 353.4820330209687, 375.09835205078184, 352.40894276803107, 354.6539063774572, 378.6710178155556, 347.43933635727166, 203.70788946993486, 354.4737892867677, 360.5324699823075, 365.57522047577777, 372.6813828307943, 350.6027255098175, 319.18081176201355, 355.5942753482043, 373.0673723095157, 366.69798855763696, 368.68037315287245, 328.1282862288457, 358.72246717334787, 372.932503027515, 375.8209017871717, 363.25415514216974, 378.6207949378101, 355.7705071520193, 352.96444347691994], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.427424859403202, "mean_inference_ms": 1.2993769540111186, "mean_action_processing_ms": 0.213412056483235, "mean_env_wait_ms": 349.2193498206414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013885626921782622, "StateBufferConnector_ms": 0.006477897231643264, "ViewRequirementAgentConnector_ms": 0.17966644184009448}, "num_episodes": 37, "episode_return_max": 378.92988258137785, "episode_return_min": 203.70788946993486, "episode_return_mean": 355.3861260398121, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 297360, "num_agent_steps_trained": 297360, "num_env_steps_sampled": 297360, "num_env_steps_trained": 297360, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 15.092875803258059, "num_env_steps_trained_throughput_per_sec": 15.092875803258059, "timesteps_total": 297360, "num_env_steps_sampled_lifetime": 297360, "num_agent_steps_sampled_lifetime": 297360, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 297360, "timers": {"training_iteration_time_ms": 135958.197, "restore_workers_time_ms": 0.024, "training_step_time_ms": 135958.132, "sample_time_ms": 132772.387, "load_time_ms": 1.636, "load_throughput": 1254257.04, "learn_time_ms": 3170.123, "learn_throughput": 647.294, "synch_weights_time_ms": 13.428}, "counters": {"num_env_steps_sampled": 297360, "num_env_steps_trained": 297360, "num_agent_steps_sampled": 297360, "num_agent_steps_trained": 297360}, "done": false, "episodes_total": 6060, "training_iteration": 275, "trial_id": "fd033_00000", "date": "2024-06-11_15-07-19", "timestamp": 1718140039, "time_this_iter_s": 135.96163868904114, "time_total_s": 20359.228331565857, "pid": 8136, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23171368767382208, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1708838928496141, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 135.96163868904114, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.296410256410255, "ram_util_percent": 13.905128205128205}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5078810487597549, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.817831628335019, "policy_loss": -0.0060214204655494544, "vf_loss": 0.8196498597661654, "vf_explained_var": 0.6540978853901227, "kl": 0.00827593669079481, "entropy": -1.8366992371777693, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 720.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 299412, "num_env_steps_trained": 299412, "num_agent_steps_sampled": 299412, "num_agent_steps_trained": 299412}, "sampler_results": {"episode_reward_max": 379.9823036995573, "episode_reward_min": 203.70788946993486, "episode_reward_mean": 354.17478368257235, "episode_len_mean": 49.80769230769231, "episode_media": {}, "episodes_this_iter": 41, "episodes_timesteps_total": 3885, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.0215955548498, 374.2432982573254, 344.7197903268969, 335.59687637996, 378.92988258137785, 358.18172434593254, 374.7329588476977, 332.4190381245191, 364.91925893166695, 360.30100321542346, 368.35669508160214, 367.10259582428876, 353.4820330209687, 375.09835205078184, 352.40894276803107, 354.6539063774572, 378.6710178155556, 347.43933635727166, 203.70788946993486, 354.4737892867677, 360.5324699823075, 365.57522047577777, 372.6813828307943, 350.6027255098175, 319.18081176201355, 355.5942753482043, 373.0673723095157, 366.69798855763696, 368.68037315287245, 328.1282862288457, 358.72246717334787, 372.932503027515, 375.8209017871717, 363.25415514216974, 378.6207949378101, 355.7705071520193, 352.96444347691994, 379.9823036995573, 337.71980412208313, 366.50634475359266, 347.4677235733185, 372.4957078227241, 319.37663094421265, 372.20842550609717, 355.18676213327865, 363.90273946372076, 359.65054329411424, 365.2091451797399, 336.1083940794738, 360.2721962988279, 342.8067584206838, 369.7506271486052, 365.8658833236397, 333.48745215704474, 348.8015766399583, 371.39827657149294, 355.00636920804385, 355.6844560150603, 339.23186277589167, 346.23846324351547, 347.6183794761584, 358.4552414805432, 347.86759521978934, 347.31902540552215, 325.7099411954439, 367.2535978599268, 364.9396140344439, 366.1271012867745, 360.6264850452419, 361.3573955231772, 330.98355984042183, 337.4863677887807, 354.0653965749258, 334.7876073118583, 357.19027610194433, 354.6423856065411, 348.25487803129636, 347.30316961012943], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5101689966501475, "mean_inference_ms": 1.2983247965954159, "mean_action_processing_ms": 0.21318434305028716, "mean_env_wait_ms": 352.35303006374005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01272146518413837, "StateBufferConnector_ms": 0.006392368903526893, "ViewRequirementAgentConnector_ms": 0.17949342727661133}, "num_episodes": 41, "episode_return_max": 379.9823036995573, "episode_return_min": 203.70788946993486, "episode_return_mean": 354.17478368257235}, "env_runner_results": {"episode_reward_max": 379.9823036995573, "episode_reward_min": 203.70788946993486, "episode_reward_mean": 354.17478368257235, "episode_len_mean": 49.80769230769231, "episode_media": {}, "episodes_this_iter": 41, "episodes_timesteps_total": 3885, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.0215955548498, 374.2432982573254, 344.7197903268969, 335.59687637996, 378.92988258137785, 358.18172434593254, 374.7329588476977, 332.4190381245191, 364.91925893166695, 360.30100321542346, 368.35669508160214, 367.10259582428876, 353.4820330209687, 375.09835205078184, 352.40894276803107, 354.6539063774572, 378.6710178155556, 347.43933635727166, 203.70788946993486, 354.4737892867677, 360.5324699823075, 365.57522047577777, 372.6813828307943, 350.6027255098175, 319.18081176201355, 355.5942753482043, 373.0673723095157, 366.69798855763696, 368.68037315287245, 328.1282862288457, 358.72246717334787, 372.932503027515, 375.8209017871717, 363.25415514216974, 378.6207949378101, 355.7705071520193, 352.96444347691994, 379.9823036995573, 337.71980412208313, 366.50634475359266, 347.4677235733185, 372.4957078227241, 319.37663094421265, 372.20842550609717, 355.18676213327865, 363.90273946372076, 359.65054329411424, 365.2091451797399, 336.1083940794738, 360.2721962988279, 342.8067584206838, 369.7506271486052, 365.8658833236397, 333.48745215704474, 348.8015766399583, 371.39827657149294, 355.00636920804385, 355.6844560150603, 339.23186277589167, 346.23846324351547, 347.6183794761584, 358.4552414805432, 347.86759521978934, 347.31902540552215, 325.7099411954439, 367.2535978599268, 364.9396140344439, 366.1271012867745, 360.6264850452419, 361.3573955231772, 330.98355984042183, 337.4863677887807, 354.0653965749258, 334.7876073118583, 357.19027610194433, 354.6423856065411, 348.25487803129636, 347.30316961012943], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5101689966501475, "mean_inference_ms": 1.2983247965954159, "mean_action_processing_ms": 0.21318434305028716, "mean_env_wait_ms": 352.35303006374005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01272146518413837, "StateBufferConnector_ms": 0.006392368903526893, "ViewRequirementAgentConnector_ms": 0.17949342727661133}, "num_episodes": 41, "episode_return_max": 379.9823036995573, "episode_return_min": 203.70788946993486, "episode_return_mean": 354.17478368257235}, "episode_reward_max": 379.9823036995573, "episode_reward_min": 203.70788946993486, "episode_reward_mean": 354.17478368257235, "episode_len_mean": 49.80769230769231, "episodes_this_iter": 41, "episodes_timesteps_total": 3885, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [351.0215955548498, 374.2432982573254, 344.7197903268969, 335.59687637996, 378.92988258137785, 358.18172434593254, 374.7329588476977, 332.4190381245191, 364.91925893166695, 360.30100321542346, 368.35669508160214, 367.10259582428876, 353.4820330209687, 375.09835205078184, 352.40894276803107, 354.6539063774572, 378.6710178155556, 347.43933635727166, 203.70788946993486, 354.4737892867677, 360.5324699823075, 365.57522047577777, 372.6813828307943, 350.6027255098175, 319.18081176201355, 355.5942753482043, 373.0673723095157, 366.69798855763696, 368.68037315287245, 328.1282862288457, 358.72246717334787, 372.932503027515, 375.8209017871717, 363.25415514216974, 378.6207949378101, 355.7705071520193, 352.96444347691994, 379.9823036995573, 337.71980412208313, 366.50634475359266, 347.4677235733185, 372.4957078227241, 319.37663094421265, 372.20842550609717, 355.18676213327865, 363.90273946372076, 359.65054329411424, 365.2091451797399, 336.1083940794738, 360.2721962988279, 342.8067584206838, 369.7506271486052, 365.8658833236397, 333.48745215704474, 348.8015766399583, 371.39827657149294, 355.00636920804385, 355.6844560150603, 339.23186277589167, 346.23846324351547, 347.6183794761584, 358.4552414805432, 347.86759521978934, 347.31902540552215, 325.7099411954439, 367.2535978599268, 364.9396140344439, 366.1271012867745, 360.6264850452419, 361.3573955231772, 330.98355984042183, 337.4863677887807, 354.0653965749258, 334.7876073118583, 357.19027610194433, 354.6423856065411, 348.25487803129636, 347.30316961012943], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 35, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5101689966501475, "mean_inference_ms": 1.2983247965954159, "mean_action_processing_ms": 0.21318434305028716, "mean_env_wait_ms": 352.35303006374005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01272146518413837, "StateBufferConnector_ms": 0.006392368903526893, "ViewRequirementAgentConnector_ms": 0.17949342727661133}, "num_episodes": 41, "episode_return_max": 379.9823036995573, "episode_return_min": 203.70788946993486, "episode_return_mean": 354.17478368257235, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 299412, "num_agent_steps_trained": 299412, "num_env_steps_sampled": 299412, "num_env_steps_trained": 299412, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 14.622824592144603, "num_env_steps_trained_throughput_per_sec": 14.622824592144603, "timesteps_total": 299412, "num_env_steps_sampled_lifetime": 299412, "num_agent_steps_sampled_lifetime": 299412, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 299412, "timers": {"training_iteration_time_ms": 138143.387, "restore_workers_time_ms": 0.022, "training_step_time_ms": 138143.324, "sample_time_ms": 134938.733, "load_time_ms": 1.586, "load_throughput": 1293950.509, "learn_time_ms": 3188.578, "learn_throughput": 643.547, "synch_weights_time_ms": 13.945}, "counters": {"num_env_steps_sampled": 299412, "num_env_steps_trained": 299412, "num_agent_steps_sampled": 299412, "num_agent_steps_trained": 299412}, "done": false, "episodes_total": 6101, "training_iteration": 276, "trial_id": "fd033_00000", "date": "2024-06-11_15-09-39", "timestamp": 1718140179, "time_this_iter_s": 140.33253502845764, "time_total_s": 20499.560866594315, "pid": 8136, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23171368767382208, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1708838928496141, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 276.2941737174988, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.913999999999994, "ram_util_percent": 13.099499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5078810487597549, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8818855875482162, "policy_loss": -0.006764668940256039, "vf_loss": 0.8825375240917007, "vf_explained_var": 0.5302592627704144, "kl": 0.012035753965271326, "entropy": -1.8381496941049893, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1200.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 301464, "num_env_steps_trained": 301464, "num_agent_steps_sampled": 301464, "num_agent_steps_trained": 301464}, "sampler_results": {"episode_reward_max": 379.9823036995573, "episode_reward_min": 224.39386553604055, "episode_reward_mean": 351.438634630142, "episode_len_mean": 49.89, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 4989, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.5324699823075, 365.57522047577777, 372.6813828307943, 350.6027255098175, 319.18081176201355, 355.5942753482043, 373.0673723095157, 366.69798855763696, 368.68037315287245, 328.1282862288457, 358.72246717334787, 372.932503027515, 375.8209017871717, 363.25415514216974, 378.6207949378101, 355.7705071520193, 352.96444347691994, 379.9823036995573, 337.71980412208313, 366.50634475359266, 347.4677235733185, 372.4957078227241, 319.37663094421265, 372.20842550609717, 355.18676213327865, 363.90273946372076, 359.65054329411424, 365.2091451797399, 336.1083940794738, 360.2721962988279, 342.8067584206838, 369.7506271486052, 365.8658833236397, 333.48745215704474, 348.8015766399583, 371.39827657149294, 355.00636920804385, 355.6844560150603, 339.23186277589167, 346.23846324351547, 347.6183794761584, 358.4552414805432, 347.86759521978934, 347.31902540552215, 325.7099411954439, 367.2535978599268, 364.9396140344439, 366.1271012867745, 360.6264850452419, 361.3573955231772, 330.98355984042183, 337.4863677887807, 354.0653965749258, 334.7876073118583, 357.19027610194433, 354.6423856065411, 348.25487803129636, 347.30316961012943, 344.1218606844792, 348.236927011152, 346.5521911397295, 341.57722356957373, 336.815466495497, 348.2556160066801, 224.39386553604055, 309.4127506433494, 370.5566289011797, 372.8102714726812, 333.013812372855, 330.97545607242694, 349.18761340019034, 338.836948482233, 329.86688798117285, 356.0111056731688, 326.0052678132645, 355.65384163791714, 354.09113963672434, 332.8075732645322, 375.042369905429, 343.64068818897283, 362.2695784775814, 365.72192005296273, 364.4854341575117, 342.59766961304786, 352.2957675391811, 358.97493428174386, 356.76675623116336, 357.5092642494686, 360.17130532336205, 339.54273527130044, 360.9068941735314, 327.3927959993621, 342.39403089374395, 353.52833538190725, 357.3698839960746, 350.45279516571406, 328.42414839628145, 374.5429058339786, 376.00447998046934, 349.47317948422744], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 39, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.622487773715392, "mean_inference_ms": 1.2950661338810052, "mean_action_processing_ms": 0.2128219328175223, "mean_env_wait_ms": 370.9386146338454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011526346206665039, "StateBufferConnector_ms": 0.006289005279541016, "ViewRequirementAgentConnector_ms": 0.1784071922302246}, "num_episodes": 42, "episode_return_max": 379.9823036995573, "episode_return_min": 224.39386553604055, "episode_return_mean": 351.438634630142}, "env_runner_results": {"episode_reward_max": 379.9823036995573, "episode_reward_min": 224.39386553604055, "episode_reward_mean": 351.438634630142, "episode_len_mean": 49.89, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 4989, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.5324699823075, 365.57522047577777, 372.6813828307943, 350.6027255098175, 319.18081176201355, 355.5942753482043, 373.0673723095157, 366.69798855763696, 368.68037315287245, 328.1282862288457, 358.72246717334787, 372.932503027515, 375.8209017871717, 363.25415514216974, 378.6207949378101, 355.7705071520193, 352.96444347691994, 379.9823036995573, 337.71980412208313, 366.50634475359266, 347.4677235733185, 372.4957078227241, 319.37663094421265, 372.20842550609717, 355.18676213327865, 363.90273946372076, 359.65054329411424, 365.2091451797399, 336.1083940794738, 360.2721962988279, 342.8067584206838, 369.7506271486052, 365.8658833236397, 333.48745215704474, 348.8015766399583, 371.39827657149294, 355.00636920804385, 355.6844560150603, 339.23186277589167, 346.23846324351547, 347.6183794761584, 358.4552414805432, 347.86759521978934, 347.31902540552215, 325.7099411954439, 367.2535978599268, 364.9396140344439, 366.1271012867745, 360.6264850452419, 361.3573955231772, 330.98355984042183, 337.4863677887807, 354.0653965749258, 334.7876073118583, 357.19027610194433, 354.6423856065411, 348.25487803129636, 347.30316961012943, 344.1218606844792, 348.236927011152, 346.5521911397295, 341.57722356957373, 336.815466495497, 348.2556160066801, 224.39386553604055, 309.4127506433494, 370.5566289011797, 372.8102714726812, 333.013812372855, 330.97545607242694, 349.18761340019034, 338.836948482233, 329.86688798117285, 356.0111056731688, 326.0052678132645, 355.65384163791714, 354.09113963672434, 332.8075732645322, 375.042369905429, 343.64068818897283, 362.2695784775814, 365.72192005296273, 364.4854341575117, 342.59766961304786, 352.2957675391811, 358.97493428174386, 356.76675623116336, 357.5092642494686, 360.17130532336205, 339.54273527130044, 360.9068941735314, 327.3927959993621, 342.39403089374395, 353.52833538190725, 357.3698839960746, 350.45279516571406, 328.42414839628145, 374.5429058339786, 376.00447998046934, 349.47317948422744], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 39, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.622487773715392, "mean_inference_ms": 1.2950661338810052, "mean_action_processing_ms": 0.2128219328175223, "mean_env_wait_ms": 370.9386146338454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011526346206665039, "StateBufferConnector_ms": 0.006289005279541016, "ViewRequirementAgentConnector_ms": 0.1784071922302246}, "num_episodes": 42, "episode_return_max": 379.9823036995573, "episode_return_min": 224.39386553604055, "episode_return_mean": 351.438634630142}, "episode_reward_max": 379.9823036995573, "episode_reward_min": 224.39386553604055, "episode_reward_mean": 351.438634630142, "episode_len_mean": 49.89, "episodes_this_iter": 42, "episodes_timesteps_total": 4989, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [360.5324699823075, 365.57522047577777, 372.6813828307943, 350.6027255098175, 319.18081176201355, 355.5942753482043, 373.0673723095157, 366.69798855763696, 368.68037315287245, 328.1282862288457, 358.72246717334787, 372.932503027515, 375.8209017871717, 363.25415514216974, 378.6207949378101, 355.7705071520193, 352.96444347691994, 379.9823036995573, 337.71980412208313, 366.50634475359266, 347.4677235733185, 372.4957078227241, 319.37663094421265, 372.20842550609717, 355.18676213327865, 363.90273946372076, 359.65054329411424, 365.2091451797399, 336.1083940794738, 360.2721962988279, 342.8067584206838, 369.7506271486052, 365.8658833236397, 333.48745215704474, 348.8015766399583, 371.39827657149294, 355.00636920804385, 355.6844560150603, 339.23186277589167, 346.23846324351547, 347.6183794761584, 358.4552414805432, 347.86759521978934, 347.31902540552215, 325.7099411954439, 367.2535978599268, 364.9396140344439, 366.1271012867745, 360.6264850452419, 361.3573955231772, 330.98355984042183, 337.4863677887807, 354.0653965749258, 334.7876073118583, 357.19027610194433, 354.6423856065411, 348.25487803129636, 347.30316961012943, 344.1218606844792, 348.236927011152, 346.5521911397295, 341.57722356957373, 336.815466495497, 348.2556160066801, 224.39386553604055, 309.4127506433494, 370.5566289011797, 372.8102714726812, 333.013812372855, 330.97545607242694, 349.18761340019034, 338.836948482233, 329.86688798117285, 356.0111056731688, 326.0052678132645, 355.65384163791714, 354.09113963672434, 332.8075732645322, 375.042369905429, 343.64068818897283, 362.2695784775814, 365.72192005296273, 364.4854341575117, 342.59766961304786, 352.2957675391811, 358.97493428174386, 356.76675623116336, 357.5092642494686, 360.17130532336205, 339.54273527130044, 360.9068941735314, 327.3927959993621, 342.39403089374395, 353.52833538190725, 357.3698839960746, 350.45279516571406, 328.42414839628145, 374.5429058339786, 376.00447998046934, 349.47317948422744], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 39, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.622487773715392, "mean_inference_ms": 1.2950661338810052, "mean_action_processing_ms": 0.2128219328175223, "mean_env_wait_ms": 370.9386146338454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011526346206665039, "StateBufferConnector_ms": 0.006289005279541016, "ViewRequirementAgentConnector_ms": 0.1784071922302246}, "num_episodes": 42, "episode_return_max": 379.9823036995573, "episode_return_min": 224.39386553604055, "episode_return_mean": 351.438634630142, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 301464, "num_agent_steps_trained": 301464, "num_env_steps_sampled": 301464, "num_env_steps_trained": 301464, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 10.554839107299577, "num_env_steps_trained_throughput_per_sec": 10.554839107299577, "timesteps_total": 301464, "num_env_steps_sampled_lifetime": 301464, "num_agent_steps_sampled_lifetime": 301464, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 301464, "timers": {"training_iteration_time_ms": 156899.995, "restore_workers_time_ms": 0.024, "training_step_time_ms": 156899.929, "sample_time_ms": 153723.607, "load_time_ms": 1.565, "load_throughput": 1311066.082, "learn_time_ms": 3160.303, "learn_throughput": 649.305, "synch_weights_time_ms": 13.998}, "counters": {"num_env_steps_sampled": 301464, "num_env_steps_trained": 301464, "num_agent_steps_sampled": 301464, "num_agent_steps_trained": 301464}, "done": false, "episodes_total": 6143, "training_iteration": 277, "trial_id": "fd033_00000", "date": "2024-06-11_15-12-54", "timestamp": 1718140374, "time_this_iter_s": 194.41711378097534, "time_total_s": 20693.97798037529, "pid": 8136, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23171368767382208, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1708838928496141, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 470.7112874984741, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.902158273381293, "ram_util_percent": 13.613669064748203}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5078810487597549, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7275709790798525, "policy_loss": -0.0022242356855713295, "vf_loss": 0.7173013533776005, "vf_explained_var": 0.7493818453202645, "kl": 0.02459997887196269, "entropy": -1.956777839610974, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 303516, "num_env_steps_trained": 303516, "num_agent_steps_sampled": 303516, "num_agent_steps_trained": 303516}, "sampler_results": {"episode_reward_max": 374.7177819701975, "episode_reward_min": 311.7117110705493, "episode_reward_mean": 357.3178119476695, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 36, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [365.34794901068767, 372.5847086980834, 344.7712044405691, 370.72714898487095, 374.7177819701975, 311.7117110705493, 331.0746952717101, 355.3771575325305, 365.44931503461135, 350.50744274101163, 368.76181494985985, 368.3269362480509, 358.8876237592558, 361.23751970328294, 365.33753852181013, 367.70189761279437, 367.33254453896296, 364.6853675938779, 345.5340763165568, 364.156718436729, 367.1023982158028, 366.7630653906211, 368.85268498346414, 365.58125725639144, 343.2991255479762, 365.49878175896635, 361.9377867320707, 364.0241858375689, 347.82076471601727, 344.2002317346697, 336.8902024071223, 363.3266626108077, 362.4593190732046, 343.13002633427874, 357.5766406019667, 330.7469444791712], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.336846508252261, "mean_inference_ms": 1.316960629499341, "mean_action_processing_ms": 0.2162746136575445, "mean_env_wait_ms": 327.76601008701596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01395212279425727, "StateBufferConnector_ms": 0.006481011708577474, "ViewRequirementAgentConnector_ms": 0.17942587534586588}, "num_episodes": 36, "episode_return_max": 374.7177819701975, "episode_return_min": 311.7117110705493, "episode_return_mean": 357.3178119476695}, "env_runner_results": {"episode_reward_max": 374.7177819701975, "episode_reward_min": 311.7117110705493, "episode_reward_mean": 357.3178119476695, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 36, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [365.34794901068767, 372.5847086980834, 344.7712044405691, 370.72714898487095, 374.7177819701975, 311.7117110705493, 331.0746952717101, 355.3771575325305, 365.44931503461135, 350.50744274101163, 368.76181494985985, 368.3269362480509, 358.8876237592558, 361.23751970328294, 365.33753852181013, 367.70189761279437, 367.33254453896296, 364.6853675938779, 345.5340763165568, 364.156718436729, 367.1023982158028, 366.7630653906211, 368.85268498346414, 365.58125725639144, 343.2991255479762, 365.49878175896635, 361.9377867320707, 364.0241858375689, 347.82076471601727, 344.2002317346697, 336.8902024071223, 363.3266626108077, 362.4593190732046, 343.13002633427874, 357.5766406019667, 330.7469444791712], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.336846508252261, "mean_inference_ms": 1.316960629499341, "mean_action_processing_ms": 0.2162746136575445, "mean_env_wait_ms": 327.76601008701596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01395212279425727, "StateBufferConnector_ms": 0.006481011708577474, "ViewRequirementAgentConnector_ms": 0.17942587534586588}, "num_episodes": 36, "episode_return_max": 374.7177819701975, "episode_return_min": 311.7117110705493, "episode_return_mean": 357.3178119476695}, "episode_reward_max": 374.7177819701975, "episode_reward_min": 311.7117110705493, "episode_reward_mean": 357.3178119476695, "episode_len_mean": 50.0, "episodes_this_iter": 36, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [365.34794901068767, 372.5847086980834, 344.7712044405691, 370.72714898487095, 374.7177819701975, 311.7117110705493, 331.0746952717101, 355.3771575325305, 365.44931503461135, 350.50744274101163, 368.76181494985985, 368.3269362480509, 358.8876237592558, 361.23751970328294, 365.33753852181013, 367.70189761279437, 367.33254453896296, 364.6853675938779, 345.5340763165568, 364.156718436729, 367.1023982158028, 366.7630653906211, 368.85268498346414, 365.58125725639144, 343.2991255479762, 365.49878175896635, 361.9377867320707, 364.0241858375689, 347.82076471601727, 344.2002317346697, 336.8902024071223, 363.3266626108077, 362.4593190732046, 343.13002633427874, 357.5766406019667, 330.7469444791712], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.336846508252261, "mean_inference_ms": 1.316960629499341, "mean_action_processing_ms": 0.2162746136575445, "mean_env_wait_ms": 327.76601008701596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01395212279425727, "StateBufferConnector_ms": 0.006481011708577474, "ViewRequirementAgentConnector_ms": 0.17942587534586588}, "num_episodes": 36, "episode_return_max": 374.7177819701975, "episode_return_min": 311.7117110705493, "episode_return_mean": 357.3178119476695, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303516, "num_agent_steps_trained": 303516, "num_env_steps_sampled": 303516, "num_env_steps_trained": 303516, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 16.074801899074608, "num_env_steps_trained_throughput_per_sec": 16.074801899074608, "timesteps_total": 303516, "num_env_steps_sampled_lifetime": 303516, "num_agent_steps_sampled_lifetime": 303516, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 303516, "timers": {"training_iteration_time_ms": 127653.224, "restore_workers_time_ms": 0.03, "training_step_time_ms": 127653.14, "sample_time_ms": 124443.32, "load_time_ms": 1.814, "load_throughput": 1131271.268, "learn_time_ms": 3193.723, "learn_throughput": 642.51, "synch_weights_time_ms": 13.699}, "counters": {"num_env_steps_sampled": 303516, "num_env_steps_trained": 303516, "num_agent_steps_sampled": 303516, "num_agent_steps_trained": 303516}, "done": false, "episodes_total": 6179, "training_iteration": 278, "trial_id": "fd033_00000", "date": "2024-06-11_15-15-43", "timestamp": 1718140543, "time_this_iter_s": 127.65658926963806, "time_total_s": 20821.634569644928, "pid": 99130, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23171368767382208, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1708838928496141, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 127.65658926963806, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.585245901639354, "ram_util_percent": 13.769945355191258}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7618215731396328, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6888595217271358, "policy_loss": 0.003307772842041838, "vf_loss": 0.6622995804374416, "vf_explained_var": 0.3921554643660784, "kl": 0.030521806213922524, "entropy": -1.9124909502764542, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 305568, "num_env_steps_trained": 305568, "num_agent_steps_sampled": 305568, "num_agent_steps_trained": 305568}, "sampler_results": {"episode_reward_max": 381.98397615388154, "episode_reward_min": 316.91867820775434, "episode_reward_mean": 359.5613320116739, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 36, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.56980350602475, 350.27278145402755, 376.806262207032, 360.3508682437735, 360.3274017589874, 364.433167747742, 379.30903033726844, 364.8802745626953, 364.37355561426705, 381.98397615388154, 360.72530144360456, 376.73786621093814, 372.5146252139865, 358.1835528709706, 352.69720434231937, 316.91867820775434, 362.5448610545513, 348.6266438453064, 362.04317244884504, 366.51893759371353, 375.98050864794, 372.9886916119016, 341.7180188994136, 372.95645969731873, 351.3440881429282, 366.6442289154637, 371.55116212701006, 345.93967168732416, 369.6011062142008, 371.5434462982168, 370.5570713942735, 363.690953263839, 328.73534279850014, 344.4284486328161, 352.69401769830347, 343.0167715731249], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.350505181952977, "mean_inference_ms": 1.3089551870051348, "mean_action_processing_ms": 0.2151742736846064, "mean_env_wait_ms": 354.7058119370709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014443529976738824, "StateBufferConnector_ms": 0.006389617919921875, "ViewRequirementAgentConnector_ms": 0.1799835099114312}, "num_episodes": 36, "episode_return_max": 381.98397615388154, "episode_return_min": 316.91867820775434, "episode_return_mean": 359.5613320116739}, "env_runner_results": {"episode_reward_max": 381.98397615388154, "episode_reward_min": 316.91867820775434, "episode_reward_mean": 359.5613320116739, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 36, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.56980350602475, 350.27278145402755, 376.806262207032, 360.3508682437735, 360.3274017589874, 364.433167747742, 379.30903033726844, 364.8802745626953, 364.37355561426705, 381.98397615388154, 360.72530144360456, 376.73786621093814, 372.5146252139865, 358.1835528709706, 352.69720434231937, 316.91867820775434, 362.5448610545513, 348.6266438453064, 362.04317244884504, 366.51893759371353, 375.98050864794, 372.9886916119016, 341.7180188994136, 372.95645969731873, 351.3440881429282, 366.6442289154637, 371.55116212701006, 345.93967168732416, 369.6011062142008, 371.5434462982168, 370.5570713942735, 363.690953263839, 328.73534279850014, 344.4284486328161, 352.69401769830347, 343.0167715731249], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.350505181952977, "mean_inference_ms": 1.3089551870051348, "mean_action_processing_ms": 0.2151742736846064, "mean_env_wait_ms": 354.7058119370709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014443529976738824, "StateBufferConnector_ms": 0.006389617919921875, "ViewRequirementAgentConnector_ms": 0.1799835099114312}, "num_episodes": 36, "episode_return_max": 381.98397615388154, "episode_return_min": 316.91867820775434, "episode_return_mean": 359.5613320116739}, "episode_reward_max": 381.98397615388154, "episode_reward_min": 316.91867820775434, "episode_reward_mean": 359.5613320116739, "episode_len_mean": 50.0, "episodes_this_iter": 36, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [320.56980350602475, 350.27278145402755, 376.806262207032, 360.3508682437735, 360.3274017589874, 364.433167747742, 379.30903033726844, 364.8802745626953, 364.37355561426705, 381.98397615388154, 360.72530144360456, 376.73786621093814, 372.5146252139865, 358.1835528709706, 352.69720434231937, 316.91867820775434, 362.5448610545513, 348.6266438453064, 362.04317244884504, 366.51893759371353, 375.98050864794, 372.9886916119016, 341.7180188994136, 372.95645969731873, 351.3440881429282, 366.6442289154637, 371.55116212701006, 345.93967168732416, 369.6011062142008, 371.5434462982168, 370.5570713942735, 363.690953263839, 328.73534279850014, 344.4284486328161, 352.69401769830347, 343.0167715731249], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.350505181952977, "mean_inference_ms": 1.3089551870051348, "mean_action_processing_ms": 0.2151742736846064, "mean_env_wait_ms": 354.7058119370709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014443529976738824, "StateBufferConnector_ms": 0.006389617919921875, "ViewRequirementAgentConnector_ms": 0.1799835099114312}, "num_episodes": 36, "episode_return_max": 381.98397615388154, "episode_return_min": 316.91867820775434, "episode_return_mean": 359.5613320116739, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 305568, "num_agent_steps_trained": 305568, "num_env_steps_sampled": 305568, "num_env_steps_trained": 305568, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 14.628837997656925, "num_env_steps_trained_throughput_per_sec": 14.628837997656925, "timesteps_total": 305568, "num_env_steps_sampled_lifetime": 305568, "num_agent_steps_sampled_lifetime": 305568, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 305568, "timers": {"training_iteration_time_ms": 140270.897, "restore_workers_time_ms": 0.028, "training_step_time_ms": 140270.818, "sample_time_ms": 137066.569, "load_time_ms": 1.765, "load_throughput": 1162912.013, "learn_time_ms": 3187.546, "learn_throughput": 643.755, "synch_weights_time_ms": 14.337}, "counters": {"num_env_steps_sampled": 305568, "num_env_steps_trained": 305568, "num_agent_steps_sampled": 305568, "num_agent_steps_trained": 305568}, "done": false, "episodes_total": 6215, "training_iteration": 279, "trial_id": "fd033_00000", "date": "2024-06-11_15-18-29", "timestamp": 1718140709, "time_this_iter_s": 140.27429246902466, "time_total_s": 20961.908862113953, "pid": 33073, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23171368767382208, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1708838928496141, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 140.27429246902466, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.35572139303483, "ram_util_percent": 13.80049751243781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1427323597094488, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6585035532712936, "policy_loss": -0.002880533541125866, "vf_loss": 0.6483191650981704, "vf_explained_var": 0.5696395248174667, "kl": 0.011433051761802652, "entropy": -1.9274283317228158, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 720.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 307620, "num_env_steps_trained": 307620, "num_agent_steps_sampled": 307620, "num_agent_steps_trained": 307620}, "sampler_results": {"episode_reward_max": 381.98397615388154, "episode_reward_min": 316.91867820775434, "episode_reward_mean": 356.5870951677234, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.56980350602475, 350.27278145402755, 376.806262207032, 360.3508682437735, 360.3274017589874, 364.433167747742, 379.30903033726844, 364.8802745626953, 364.37355561426705, 381.98397615388154, 360.72530144360456, 376.73786621093814, 372.5146252139865, 358.1835528709706, 352.69720434231937, 316.91867820775434, 362.5448610545513, 348.6266438453064, 362.04317244884504, 366.51893759371353, 375.98050864794, 372.9886916119016, 341.7180188994136, 372.95645969731873, 351.3440881429282, 366.6442289154637, 371.55116212701006, 345.93967168732416, 369.6011062142008, 371.5434462982168, 370.5570713942735, 363.690953263839, 328.73534279850014, 344.4284486328161, 352.69401769830347, 343.0167715731249, 325.26873879083774, 377.0363952881416, 362.59274423002506, 367.3324642514483, 334.9082311496891, 367.78939555192346, 364.5969423247407, 351.41604966165346, 346.996737415847, 339.8906133787113, 359.44443940892296, 381.9301107253082, 338.017467988232, 364.25917265818987, 319.7139828851359, 357.0141253263183, 372.1176275092873, 369.54476773288224, 359.35593303944, 362.99170256524957, 327.92086836089265, 351.0673657865959, 352.8516957203812, 375.6993390445032, 340.2789390276949, 376.55112944087523, 367.2708940723307, 345.83699485608537, 340.9816813521994, 351.02550334034675, 338.27809476997044, 350.57044827720586, 370.9103814066006, 362.0955161535798, 360.7662251135438, 341.1888819617937, 371.28959983803395, 348.40053650073895, 325.1069084818206, 319.41425365871754, 366.2061899916188, 363.6563816246523], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.493531452766898, "mean_inference_ms": 1.3086171509189228, "mean_action_processing_ms": 0.21497420941846165, "mean_env_wait_ms": 342.2055199010622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013277469537197014, "StateBufferConnector_ms": 0.0063981765355819314, "ViewRequirementAgentConnector_ms": 0.17896921206743288}, "num_episodes": 42, "episode_return_max": 381.98397615388154, "episode_return_min": 316.91867820775434, "episode_return_mean": 356.5870951677234}, "env_runner_results": {"episode_reward_max": 381.98397615388154, "episode_reward_min": 316.91867820775434, "episode_reward_mean": 356.5870951677234, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.56980350602475, 350.27278145402755, 376.806262207032, 360.3508682437735, 360.3274017589874, 364.433167747742, 379.30903033726844, 364.8802745626953, 364.37355561426705, 381.98397615388154, 360.72530144360456, 376.73786621093814, 372.5146252139865, 358.1835528709706, 352.69720434231937, 316.91867820775434, 362.5448610545513, 348.6266438453064, 362.04317244884504, 366.51893759371353, 375.98050864794, 372.9886916119016, 341.7180188994136, 372.95645969731873, 351.3440881429282, 366.6442289154637, 371.55116212701006, 345.93967168732416, 369.6011062142008, 371.5434462982168, 370.5570713942735, 363.690953263839, 328.73534279850014, 344.4284486328161, 352.69401769830347, 343.0167715731249, 325.26873879083774, 377.0363952881416, 362.59274423002506, 367.3324642514483, 334.9082311496891, 367.78939555192346, 364.5969423247407, 351.41604966165346, 346.996737415847, 339.8906133787113, 359.44443940892296, 381.9301107253082, 338.017467988232, 364.25917265818987, 319.7139828851359, 357.0141253263183, 372.1176275092873, 369.54476773288224, 359.35593303944, 362.99170256524957, 327.92086836089265, 351.0673657865959, 352.8516957203812, 375.6993390445032, 340.2789390276949, 376.55112944087523, 367.2708940723307, 345.83699485608537, 340.9816813521994, 351.02550334034675, 338.27809476997044, 350.57044827720586, 370.9103814066006, 362.0955161535798, 360.7662251135438, 341.1888819617937, 371.28959983803395, 348.40053650073895, 325.1069084818206, 319.41425365871754, 366.2061899916188, 363.6563816246523], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.493531452766898, "mean_inference_ms": 1.3086171509189228, "mean_action_processing_ms": 0.21497420941846165, "mean_env_wait_ms": 342.2055199010622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013277469537197014, "StateBufferConnector_ms": 0.0063981765355819314, "ViewRequirementAgentConnector_ms": 0.17896921206743288}, "num_episodes": 42, "episode_return_max": 381.98397615388154, "episode_return_min": 316.91867820775434, "episode_return_mean": 356.5870951677234}, "episode_reward_max": 381.98397615388154, "episode_reward_min": 316.91867820775434, "episode_reward_mean": 356.5870951677234, "episode_len_mean": 50.0, "episodes_this_iter": 42, "episodes_timesteps_total": 3900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [320.56980350602475, 350.27278145402755, 376.806262207032, 360.3508682437735, 360.3274017589874, 364.433167747742, 379.30903033726844, 364.8802745626953, 364.37355561426705, 381.98397615388154, 360.72530144360456, 376.73786621093814, 372.5146252139865, 358.1835528709706, 352.69720434231937, 316.91867820775434, 362.5448610545513, 348.6266438453064, 362.04317244884504, 366.51893759371353, 375.98050864794, 372.9886916119016, 341.7180188994136, 372.95645969731873, 351.3440881429282, 366.6442289154637, 371.55116212701006, 345.93967168732416, 369.6011062142008, 371.5434462982168, 370.5570713942735, 363.690953263839, 328.73534279850014, 344.4284486328161, 352.69401769830347, 343.0167715731249, 325.26873879083774, 377.0363952881416, 362.59274423002506, 367.3324642514483, 334.9082311496891, 367.78939555192346, 364.5969423247407, 351.41604966165346, 346.996737415847, 339.8906133787113, 359.44443940892296, 381.9301107253082, 338.017467988232, 364.25917265818987, 319.7139828851359, 357.0141253263183, 372.1176275092873, 369.54476773288224, 359.35593303944, 362.99170256524957, 327.92086836089265, 351.0673657865959, 352.8516957203812, 375.6993390445032, 340.2789390276949, 376.55112944087523, 367.2708940723307, 345.83699485608537, 340.9816813521994, 351.02550334034675, 338.27809476997044, 350.57044827720586, 370.9103814066006, 362.0955161535798, 360.7662251135438, 341.1888819617937, 371.28959983803395, 348.40053650073895, 325.1069084818206, 319.41425365871754, 366.2061899916188, 363.6563816246523], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.493531452766898, "mean_inference_ms": 1.3086171509189228, "mean_action_processing_ms": 0.21497420941846165, "mean_env_wait_ms": 342.2055199010622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013277469537197014, "StateBufferConnector_ms": 0.0063981765355819314, "ViewRequirementAgentConnector_ms": 0.17896921206743288}, "num_episodes": 42, "episode_return_max": 381.98397615388154, "episode_return_min": 316.91867820775434, "episode_return_mean": 356.5870951677234, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 307620, "num_agent_steps_trained": 307620, "num_env_steps_sampled": 307620, "num_env_steps_trained": 307620, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 16.25803369504643, "num_env_steps_trained_throughput_per_sec": 16.25803369504643, "timesteps_total": 307620, "num_env_steps_sampled_lifetime": 307620, "num_agent_steps_sampled_lifetime": 307620, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 307620, "timers": {"training_iteration_time_ms": 133242.718, "restore_workers_time_ms": 0.026, "training_step_time_ms": 133242.641, "sample_time_ms": 130059.231, "load_time_ms": 1.616, "load_throughput": 1269520.143, "learn_time_ms": 3167.134, "learn_throughput": 647.904, "synch_weights_time_ms": 14.149}, "counters": {"num_env_steps_sampled": 307620, "num_env_steps_trained": 307620, "num_agent_steps_sampled": 307620, "num_agent_steps_trained": 307620}, "done": false, "episodes_total": 6257, "training_iteration": 280, "trial_id": "fd033_00000", "date": "2024-06-11_15-20-35", "timestamp": 1718140835, "time_this_iter_s": 126.21878266334534, "time_total_s": 21088.127644777298, "pid": 33073, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23171368767382208, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1708838928496141, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 266.49307513237, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.07333333333333, "ram_util_percent": 12.869999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1427323597094488, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6964960507117212, "policy_loss": -0.0057587359799072145, "vf_loss": 0.6913429654513796, "vf_explained_var": 0.42485089028875034, "kl": 0.009548884529916505, "entropy": -1.8816308396557966, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1200.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 309672, "num_env_steps_trained": 309672, "num_agent_steps_sampled": 309672, "num_agent_steps_trained": 309672}, "sampler_results": {"episode_reward_max": 381.9301107253082, "episode_reward_min": 316.17987903864474, "episode_reward_mean": 355.86879701931554, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.98050864794, 372.9886916119016, 341.7180188994136, 372.95645969731873, 351.3440881429282, 366.6442289154637, 371.55116212701006, 345.93967168732416, 369.6011062142008, 371.5434462982168, 370.5570713942735, 363.690953263839, 328.73534279850014, 344.4284486328161, 352.69401769830347, 343.0167715731249, 325.26873879083774, 377.0363952881416, 362.59274423002506, 367.3324642514483, 334.9082311496891, 367.78939555192346, 364.5969423247407, 351.41604966165346, 346.996737415847, 339.8906133787113, 359.44443940892296, 381.9301107253082, 338.017467988232, 364.25917265818987, 319.7139828851359, 357.0141253263183, 372.1176275092873, 369.54476773288224, 359.35593303944, 362.99170256524957, 327.92086836089265, 351.0673657865959, 352.8516957203812, 375.6993390445032, 340.2789390276949, 376.55112944087523, 367.2708940723307, 345.83699485608537, 340.9816813521994, 351.02550334034675, 338.27809476997044, 350.57044827720586, 370.9103814066006, 362.0955161535798, 360.7662251135438, 341.1888819617937, 371.28959983803395, 348.40053650073895, 325.1069084818206, 319.41425365871754, 366.2061899916188, 363.6563816246523, 377.08352664226635, 335.83929580948944, 353.39385722374084, 358.8342258747065, 346.00847068302915, 369.12403033746455, 338.74641031638794, 375.77774935297606, 368.3646806408234, 378.8311107664766, 373.92565120050784, 365.702981526742, 373.96823078399547, 336.63545923194334, 355.725201677738, 365.8245153163851, 334.4426783872304, 377.34098211888323, 327.24435527869593, 316.17987903864474, 368.83763394539847, 350.75780056677826, 358.4608842482006, 381.37813448425356, 377.77784377456044, 355.21131367995986, 337.7574572479621, 352.75417518447375, 358.38025304160885, 380.2965431299301, 331.20982639752003, 347.20803705860914, 357.92306006790966, 378.84882297645504, 349.96514934851035, 350.407957723363, 339.7483200277657, 359.6079859797851, 345.81962479012526, 340.5078021981128, 362.7491303122011, 359.30319527519725], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.604837346201428, "mean_inference_ms": 1.3041802667430946, "mean_action_processing_ms": 0.21444140183409047, "mean_env_wait_ms": 340.69326556295607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011725664138793945, "StateBufferConnector_ms": 0.006383180618286133, "ViewRequirementAgentConnector_ms": 0.1793498992919922}, "num_episodes": 42, "episode_return_max": 381.9301107253082, "episode_return_min": 316.17987903864474, "episode_return_mean": 355.86879701931554}, "env_runner_results": {"episode_reward_max": 381.9301107253082, "episode_reward_min": 316.17987903864474, "episode_reward_mean": 355.86879701931554, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.98050864794, 372.9886916119016, 341.7180188994136, 372.95645969731873, 351.3440881429282, 366.6442289154637, 371.55116212701006, 345.93967168732416, 369.6011062142008, 371.5434462982168, 370.5570713942735, 363.690953263839, 328.73534279850014, 344.4284486328161, 352.69401769830347, 343.0167715731249, 325.26873879083774, 377.0363952881416, 362.59274423002506, 367.3324642514483, 334.9082311496891, 367.78939555192346, 364.5969423247407, 351.41604966165346, 346.996737415847, 339.8906133787113, 359.44443940892296, 381.9301107253082, 338.017467988232, 364.25917265818987, 319.7139828851359, 357.0141253263183, 372.1176275092873, 369.54476773288224, 359.35593303944, 362.99170256524957, 327.92086836089265, 351.0673657865959, 352.8516957203812, 375.6993390445032, 340.2789390276949, 376.55112944087523, 367.2708940723307, 345.83699485608537, 340.9816813521994, 351.02550334034675, 338.27809476997044, 350.57044827720586, 370.9103814066006, 362.0955161535798, 360.7662251135438, 341.1888819617937, 371.28959983803395, 348.40053650073895, 325.1069084818206, 319.41425365871754, 366.2061899916188, 363.6563816246523, 377.08352664226635, 335.83929580948944, 353.39385722374084, 358.8342258747065, 346.00847068302915, 369.12403033746455, 338.74641031638794, 375.77774935297606, 368.3646806408234, 378.8311107664766, 373.92565120050784, 365.702981526742, 373.96823078399547, 336.63545923194334, 355.725201677738, 365.8245153163851, 334.4426783872304, 377.34098211888323, 327.24435527869593, 316.17987903864474, 368.83763394539847, 350.75780056677826, 358.4608842482006, 381.37813448425356, 377.77784377456044, 355.21131367995986, 337.7574572479621, 352.75417518447375, 358.38025304160885, 380.2965431299301, 331.20982639752003, 347.20803705860914, 357.92306006790966, 378.84882297645504, 349.96514934851035, 350.407957723363, 339.7483200277657, 359.6079859797851, 345.81962479012526, 340.5078021981128, 362.7491303122011, 359.30319527519725], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.604837346201428, "mean_inference_ms": 1.3041802667430946, "mean_action_processing_ms": 0.21444140183409047, "mean_env_wait_ms": 340.69326556295607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011725664138793945, "StateBufferConnector_ms": 0.006383180618286133, "ViewRequirementAgentConnector_ms": 0.1793498992919922}, "num_episodes": 42, "episode_return_max": 381.9301107253082, "episode_return_min": 316.17987903864474, "episode_return_mean": 355.86879701931554}, "episode_reward_max": 381.9301107253082, "episode_reward_min": 316.17987903864474, "episode_reward_mean": 355.86879701931554, "episode_len_mean": 50.0, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [375.98050864794, 372.9886916119016, 341.7180188994136, 372.95645969731873, 351.3440881429282, 366.6442289154637, 371.55116212701006, 345.93967168732416, 369.6011062142008, 371.5434462982168, 370.5570713942735, 363.690953263839, 328.73534279850014, 344.4284486328161, 352.69401769830347, 343.0167715731249, 325.26873879083774, 377.0363952881416, 362.59274423002506, 367.3324642514483, 334.9082311496891, 367.78939555192346, 364.5969423247407, 351.41604966165346, 346.996737415847, 339.8906133787113, 359.44443940892296, 381.9301107253082, 338.017467988232, 364.25917265818987, 319.7139828851359, 357.0141253263183, 372.1176275092873, 369.54476773288224, 359.35593303944, 362.99170256524957, 327.92086836089265, 351.0673657865959, 352.8516957203812, 375.6993390445032, 340.2789390276949, 376.55112944087523, 367.2708940723307, 345.83699485608537, 340.9816813521994, 351.02550334034675, 338.27809476997044, 350.57044827720586, 370.9103814066006, 362.0955161535798, 360.7662251135438, 341.1888819617937, 371.28959983803395, 348.40053650073895, 325.1069084818206, 319.41425365871754, 366.2061899916188, 363.6563816246523, 377.08352664226635, 335.83929580948944, 353.39385722374084, 358.8342258747065, 346.00847068302915, 369.12403033746455, 338.74641031638794, 375.77774935297606, 368.3646806408234, 378.8311107664766, 373.92565120050784, 365.702981526742, 373.96823078399547, 336.63545923194334, 355.725201677738, 365.8245153163851, 334.4426783872304, 377.34098211888323, 327.24435527869593, 316.17987903864474, 368.83763394539847, 350.75780056677826, 358.4608842482006, 381.37813448425356, 377.77784377456044, 355.21131367995986, 337.7574572479621, 352.75417518447375, 358.38025304160885, 380.2965431299301, 331.20982639752003, 347.20803705860914, 357.92306006790966, 378.84882297645504, 349.96514934851035, 350.407957723363, 339.7483200277657, 359.6079859797851, 345.81962479012526, 340.5078021981128, 362.7491303122011, 359.30319527519725], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.604837346201428, "mean_inference_ms": 1.3041802667430946, "mean_action_processing_ms": 0.21444140183409047, "mean_env_wait_ms": 340.69326556295607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011725664138793945, "StateBufferConnector_ms": 0.006383180618286133, "ViewRequirementAgentConnector_ms": 0.1793498992919922}, "num_episodes": 42, "episode_return_max": 381.9301107253082, "episode_return_min": 316.17987903864474, "episode_return_mean": 355.86879701931554, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 309672, "num_agent_steps_trained": 309672, "num_env_steps_sampled": 309672, "num_env_steps_trained": 309672, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 14.54424653356812, "num_env_steps_trained_throughput_per_sec": 14.54424653356812, "timesteps_total": 309672, "num_env_steps_sampled_lifetime": 309672, "num_agent_steps_sampled_lifetime": 309672, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 309672, "timers": {"training_iteration_time_ms": 135857.39, "restore_workers_time_ms": 0.026, "training_step_time_ms": 135857.316, "sample_time_ms": 132738.617, "load_time_ms": 1.54, "load_throughput": 1332102.122, "learn_time_ms": 3102.73, "learn_throughput": 661.353, "synch_weights_time_ms": 13.973}, "counters": {"num_env_steps_sampled": 309672, "num_env_steps_trained": 309672, "num_agent_steps_sampled": 309672, "num_agent_steps_trained": 309672}, "done": false, "episodes_total": 6299, "training_iteration": 281, "trial_id": "fd033_00000", "date": "2024-06-11_15-22-56", "timestamp": 1718140976, "time_this_iter_s": 141.09043169021606, "time_total_s": 21229.218076467514, "pid": 33073, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23171368767382208, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1708838928496141, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 407.58350682258606, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 41.788059701492536, "ram_util_percent": 13.643781094527366}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1427323597094488, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7217180790845305, "policy_loss": -0.0051982765959110114, "vf_loss": 0.7004644888142745, "vf_explained_var": 0.5214505606641372, "kl": 0.02314791136050216, "entropy": -1.90500896970431, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1680.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 311724, "num_env_steps_trained": 311724, "num_agent_steps_sampled": 311724, "num_agent_steps_trained": 311724}, "sampler_results": {"episode_reward_max": 383.63138024811906, "episode_reward_min": 316.17987903864474, "episode_reward_mean": 355.4475613886609, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.2708940723307, 345.83699485608537, 340.9816813521994, 351.02550334034675, 338.27809476997044, 350.57044827720586, 370.9103814066006, 362.0955161535798, 360.7662251135438, 341.1888819617937, 371.28959983803395, 348.40053650073895, 325.1069084818206, 319.41425365871754, 366.2061899916188, 363.6563816246523, 377.08352664226635, 335.83929580948944, 353.39385722374084, 358.8342258747065, 346.00847068302915, 369.12403033746455, 338.74641031638794, 375.77774935297606, 368.3646806408234, 378.8311107664766, 373.92565120050784, 365.702981526742, 373.96823078399547, 336.63545923194334, 355.725201677738, 365.8245153163851, 334.4426783872304, 377.34098211888323, 327.24435527869593, 316.17987903864474, 368.83763394539847, 350.75780056677826, 358.4608842482006, 381.37813448425356, 377.77784377456044, 355.21131367995986, 337.7574572479621, 352.75417518447375, 358.38025304160885, 380.2965431299301, 331.20982639752003, 347.20803705860914, 357.92306006790966, 378.84882297645504, 349.96514934851035, 350.407957723363, 339.7483200277657, 359.6079859797851, 345.81962479012526, 340.5078021981128, 362.7491303122011, 359.30319527519725, 335.98940811218966, 355.64284157673626, 352.23025305656046, 362.14150418730475, 358.53340016230766, 369.82992281231026, 344.4871776601145, 364.59871303279704, 374.17968369519264, 363.7036233493188, 335.9846232891778, 344.30093681130205, 362.52747281879425, 370.8050211940801, 364.93404987720766, 366.9556350992321, 367.5265101829518, 342.66127885645284, 376.491688203037, 371.9772078865118, 376.76588278626144, 356.9228251431504, 375.0726577834843, 361.39838936218086, 336.52646761163135, 346.9240552977347, 327.42305190278165, 373.0179795811643, 360.2773133153477, 380.8282272438522, 383.63138024811906, 344.25081910619525, 345.00110602368295, 348.0183867158004, 336.1125252299117, 328.76010400918784, 325.96080017810664, 352.47085672514186, 362.79923862768453, 337.5512900327532, 354.05665815515147, 348.5824368571426], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.698610820842601, "mean_inference_ms": 1.3011870156715286, "mean_action_processing_ms": 0.21426628073313342, "mean_env_wait_ms": 338.0863978189822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010411977767944336, "StateBufferConnector_ms": 0.006291866302490234, "ViewRequirementAgentConnector_ms": 0.17774415016174316}, "num_episodes": 42, "episode_return_max": 383.63138024811906, "episode_return_min": 316.17987903864474, "episode_return_mean": 355.4475613886609}, "env_runner_results": {"episode_reward_max": 383.63138024811906, "episode_reward_min": 316.17987903864474, "episode_reward_mean": 355.4475613886609, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.2708940723307, 345.83699485608537, 340.9816813521994, 351.02550334034675, 338.27809476997044, 350.57044827720586, 370.9103814066006, 362.0955161535798, 360.7662251135438, 341.1888819617937, 371.28959983803395, 348.40053650073895, 325.1069084818206, 319.41425365871754, 366.2061899916188, 363.6563816246523, 377.08352664226635, 335.83929580948944, 353.39385722374084, 358.8342258747065, 346.00847068302915, 369.12403033746455, 338.74641031638794, 375.77774935297606, 368.3646806408234, 378.8311107664766, 373.92565120050784, 365.702981526742, 373.96823078399547, 336.63545923194334, 355.725201677738, 365.8245153163851, 334.4426783872304, 377.34098211888323, 327.24435527869593, 316.17987903864474, 368.83763394539847, 350.75780056677826, 358.4608842482006, 381.37813448425356, 377.77784377456044, 355.21131367995986, 337.7574572479621, 352.75417518447375, 358.38025304160885, 380.2965431299301, 331.20982639752003, 347.20803705860914, 357.92306006790966, 378.84882297645504, 349.96514934851035, 350.407957723363, 339.7483200277657, 359.6079859797851, 345.81962479012526, 340.5078021981128, 362.7491303122011, 359.30319527519725, 335.98940811218966, 355.64284157673626, 352.23025305656046, 362.14150418730475, 358.53340016230766, 369.82992281231026, 344.4871776601145, 364.59871303279704, 374.17968369519264, 363.7036233493188, 335.9846232891778, 344.30093681130205, 362.52747281879425, 370.8050211940801, 364.93404987720766, 366.9556350992321, 367.5265101829518, 342.66127885645284, 376.491688203037, 371.9772078865118, 376.76588278626144, 356.9228251431504, 375.0726577834843, 361.39838936218086, 336.52646761163135, 346.9240552977347, 327.42305190278165, 373.0179795811643, 360.2773133153477, 380.8282272438522, 383.63138024811906, 344.25081910619525, 345.00110602368295, 348.0183867158004, 336.1125252299117, 328.76010400918784, 325.96080017810664, 352.47085672514186, 362.79923862768453, 337.5512900327532, 354.05665815515147, 348.5824368571426], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.698610820842601, "mean_inference_ms": 1.3011870156715286, "mean_action_processing_ms": 0.21426628073313342, "mean_env_wait_ms": 338.0863978189822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010411977767944336, "StateBufferConnector_ms": 0.006291866302490234, "ViewRequirementAgentConnector_ms": 0.17774415016174316}, "num_episodes": 42, "episode_return_max": 383.63138024811906, "episode_return_min": 316.17987903864474, "episode_return_mean": 355.4475613886609}, "episode_reward_max": 383.63138024811906, "episode_reward_min": 316.17987903864474, "episode_reward_mean": 355.4475613886609, "episode_len_mean": 50.0, "episodes_this_iter": 42, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [367.2708940723307, 345.83699485608537, 340.9816813521994, 351.02550334034675, 338.27809476997044, 350.57044827720586, 370.9103814066006, 362.0955161535798, 360.7662251135438, 341.1888819617937, 371.28959983803395, 348.40053650073895, 325.1069084818206, 319.41425365871754, 366.2061899916188, 363.6563816246523, 377.08352664226635, 335.83929580948944, 353.39385722374084, 358.8342258747065, 346.00847068302915, 369.12403033746455, 338.74641031638794, 375.77774935297606, 368.3646806408234, 378.8311107664766, 373.92565120050784, 365.702981526742, 373.96823078399547, 336.63545923194334, 355.725201677738, 365.8245153163851, 334.4426783872304, 377.34098211888323, 327.24435527869593, 316.17987903864474, 368.83763394539847, 350.75780056677826, 358.4608842482006, 381.37813448425356, 377.77784377456044, 355.21131367995986, 337.7574572479621, 352.75417518447375, 358.38025304160885, 380.2965431299301, 331.20982639752003, 347.20803705860914, 357.92306006790966, 378.84882297645504, 349.96514934851035, 350.407957723363, 339.7483200277657, 359.6079859797851, 345.81962479012526, 340.5078021981128, 362.7491303122011, 359.30319527519725, 335.98940811218966, 355.64284157673626, 352.23025305656046, 362.14150418730475, 358.53340016230766, 369.82992281231026, 344.4871776601145, 364.59871303279704, 374.17968369519264, 363.7036233493188, 335.9846232891778, 344.30093681130205, 362.52747281879425, 370.8050211940801, 364.93404987720766, 366.9556350992321, 367.5265101829518, 342.66127885645284, 376.491688203037, 371.9772078865118, 376.76588278626144, 356.9228251431504, 375.0726577834843, 361.39838936218086, 336.52646761163135, 346.9240552977347, 327.42305190278165, 373.0179795811643, 360.2773133153477, 380.8282272438522, 383.63138024811906, 344.25081910619525, 345.00110602368295, 348.0183867158004, 336.1125252299117, 328.76010400918784, 325.96080017810664, 352.47085672514186, 362.79923862768453, 337.5512900327532, 354.05665815515147, 348.5824368571426], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.698610820842601, "mean_inference_ms": 1.3011870156715286, "mean_action_processing_ms": 0.21426628073313342, "mean_env_wait_ms": 338.0863978189822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010411977767944336, "StateBufferConnector_ms": 0.006291866302490234, "ViewRequirementAgentConnector_ms": 0.17774415016174316}, "num_episodes": 42, "episode_return_max": 383.63138024811906, "episode_return_min": 316.17987903864474, "episode_return_mean": 355.4475613886609, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 311724, "num_agent_steps_trained": 311724, "num_env_steps_sampled": 311724, "num_env_steps_trained": 311724, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 16.260288895894043, "num_env_steps_trained_throughput_per_sec": 16.260288895894043, "timesteps_total": 311724, "num_env_steps_sampled_lifetime": 311724, "num_agent_steps_sampled_lifetime": 311724, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 311724, "timers": {"training_iteration_time_ms": 133442.301, "restore_workers_time_ms": 0.025, "training_step_time_ms": 133442.229, "sample_time_ms": 130357.07, "load_time_ms": 1.535, "load_throughput": 1336601.593, "learn_time_ms": 3069.272, "learn_throughput": 668.562, "synch_weights_time_ms": 13.905}, "counters": {"num_env_steps_sampled": 311724, "num_env_steps_trained": 311724, "num_agent_steps_sampled": 311724, "num_agent_steps_trained": 311724}, "done": false, "episodes_total": 6341, "training_iteration": 282, "trial_id": "fd033_00000", "date": "2024-06-11_15-25-02", "timestamp": 1718141102, "time_this_iter_s": 126.20087480545044, "time_total_s": 21355.418951272964, "pid": 33073, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23171368767382208, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1708838928496141, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 533.7843816280365, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.633701657458566, "ram_util_percent": 13.712707182320441}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.714098539564173, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7451798347911487, "policy_loss": -0.0031370509811191973, "vf_loss": 0.7166206837321322, "vf_explained_var": 0.6232161366691192, "kl": 0.018491470152090222, "entropy": -1.8654226496815682, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 313776, "num_env_steps_trained": 313776, "num_agent_steps_sampled": 313776, "num_agent_steps_trained": 313776}, "sampler_results": {"episode_reward_max": 382.40671499980635, "episode_reward_min": 186.67619134200322, "episode_reward_mean": 350.66720865459394, "episode_len_mean": 49.513513513513516, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 1832, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.0100335294308, 358.1380042368343, 356.35945571483904, 365.9717163085943, 363.9388549840759, 334.29764760904305, 345.62855727911995, 341.5296400860716, 335.7379244736998, 363.7706766777552, 371.27664000940234, 337.0809219700954, 361.3928383653405, 354.04027891389694, 376.62729830883006, 352.8712632961513, 186.67619134200322, 330.949641052096, 285.79119180704146, 350.13074356337245, 378.51882908354935, 362.4997244223384, 362.93868003347825, 360.49642132232964, 368.01960323677287, 382.40671499980635, 342.669472412748, 366.87135698816553, 360.06081667462735, 348.1582352811564, 343.8052245794871, 374.20365564668265, 372.43477932252654, 369.83772852367207, 367.2571726703646, 339.12889351316926, 375.15989198140727], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.424506406338441, "mean_inference_ms": 1.307591959128433, "mean_action_processing_ms": 0.21459686024402594, "mean_env_wait_ms": 333.39060695165153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013794125737370672, "StateBufferConnector_ms": 0.006570042790593328, "ViewRequirementAgentConnector_ms": 0.17923599964863546}, "num_episodes": 37, "episode_return_max": 382.40671499980635, "episode_return_min": 186.67619134200322, "episode_return_mean": 350.66720865459394}, "env_runner_results": {"episode_reward_max": 382.40671499980635, "episode_reward_min": 186.67619134200322, "episode_reward_mean": 350.66720865459394, "episode_len_mean": 49.513513513513516, "episode_media": {}, "episodes_this_iter": 37, "episodes_timesteps_total": 1832, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.0100335294308, 358.1380042368343, 356.35945571483904, 365.9717163085943, 363.9388549840759, 334.29764760904305, 345.62855727911995, 341.5296400860716, 335.7379244736998, 363.7706766777552, 371.27664000940234, 337.0809219700954, 361.3928383653405, 354.04027891389694, 376.62729830883006, 352.8712632961513, 186.67619134200322, 330.949641052096, 285.79119180704146, 350.13074356337245, 378.51882908354935, 362.4997244223384, 362.93868003347825, 360.49642132232964, 368.01960323677287, 382.40671499980635, 342.669472412748, 366.87135698816553, 360.06081667462735, 348.1582352811564, 343.8052245794871, 374.20365564668265, 372.43477932252654, 369.83772852367207, 367.2571726703646, 339.12889351316926, 375.15989198140727], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.424506406338441, "mean_inference_ms": 1.307591959128433, "mean_action_processing_ms": 0.21459686024402594, "mean_env_wait_ms": 333.39060695165153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013794125737370672, "StateBufferConnector_ms": 0.006570042790593328, "ViewRequirementAgentConnector_ms": 0.17923599964863546}, "num_episodes": 37, "episode_return_max": 382.40671499980635, "episode_return_min": 186.67619134200322, "episode_return_mean": 350.66720865459394}, "episode_reward_max": 382.40671499980635, "episode_reward_min": 186.67619134200322, "episode_reward_mean": 350.66720865459394, "episode_len_mean": 49.513513513513516, "episodes_this_iter": 37, "episodes_timesteps_total": 1832, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [328.0100335294308, 358.1380042368343, 356.35945571483904, 365.9717163085943, 363.9388549840759, 334.29764760904305, 345.62855727911995, 341.5296400860716, 335.7379244736998, 363.7706766777552, 371.27664000940234, 337.0809219700954, 361.3928383653405, 354.04027891389694, 376.62729830883006, 352.8712632961513, 186.67619134200322, 330.949641052096, 285.79119180704146, 350.13074356337245, 378.51882908354935, 362.4997244223384, 362.93868003347825, 360.49642132232964, 368.01960323677287, 382.40671499980635, 342.669472412748, 366.87135698816553, 360.06081667462735, 348.1582352811564, 343.8052245794871, 374.20365564668265, 372.43477932252654, 369.83772852367207, 367.2571726703646, 339.12889351316926, 375.15989198140727], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.424506406338441, "mean_inference_ms": 1.307591959128433, "mean_action_processing_ms": 0.21459686024402594, "mean_env_wait_ms": 333.39060695165153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013794125737370672, "StateBufferConnector_ms": 0.006570042790593328, "ViewRequirementAgentConnector_ms": 0.17923599964863546}, "num_episodes": 37, "episode_return_max": 382.40671499980635, "episode_return_min": 186.67619134200322, "episode_return_mean": 350.66720865459394, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 313776, "num_agent_steps_trained": 313776, "num_env_steps_sampled": 313776, "num_env_steps_trained": 313776, "num_env_steps_sampled_this_iter": 2052, "num_env_steps_trained_this_iter": 2052, "num_env_steps_sampled_throughput_per_sec": 15.796457001631161, "num_env_steps_trained_throughput_per_sec": 15.796457001631161, "timesteps_total": 313776, "num_env_steps_sampled_lifetime": 313776, "num_agent_steps_sampled_lifetime": 313776, "num_steps_trained_this_iter": 2052, "agent_timesteps_total": 313776, "timers": {"training_iteration_time_ms": 129902.563, "restore_workers_time_ms": 0.026, "training_step_time_ms": 129902.481, "sample_time_ms": 126709.268, "load_time_ms": 1.791, "load_throughput": 1145575.909, "learn_time_ms": 3176.755, "learn_throughput": 645.942, "synch_weights_time_ms": 14.056}, "counters": {"num_env_steps_sampled": 313776, "num_env_steps_trained": 313776, "num_agent_steps_sampled": 313776, "num_agent_steps_trained": 313776}, "done": false, "episodes_total": 6378, "training_iteration": 283, "trial_id": "fd033_00000", "date": "2024-06-11_15-27-47", "timestamp": 1718141267, "time_this_iter_s": 129.90616488456726, "time_total_s": 21485.32511615753, "pid": 48324, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23171368767382208, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.1708838928496141, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 129.90616488456726, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.793010752688176, "ram_util_percent": 13.437634408602149}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9283608570096957, "cur_lr": 5e-06, "total_loss": 0.7625485348204771, "policy_loss": -0.007510054809972644, "vf_loss": 0.7669646746168534, "vf_explained_var": 0.47980332722266517, "kl": 0.0016044262898508596, "entropy": -1.6718789209922156, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 310710, "num_env_steps_trained": 310710, "num_agent_steps_sampled": 310710, "num_agent_steps_trained": 310710}, "sampler_results": {"episode_reward_max": 381.50004314276725, "episode_reward_min": 322.76440085484893, "episode_reward_mean": 353.55620704834973, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.5272790128511, 361.6731042816067, 338.1412574758579, 371.19525403209127, 362.09519294805045, 322.76440085484893, 355.8485774217833, 355.62922158467745, 358.81533666625717, 338.25956350276783, 342.77740657538374, 373.41363865674805, 333.53234152412745, 334.6459952724246, 381.50004314276725, 351.0803251704932, 359.38743540869234, 374.7253533388663], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.30923891437146, "mean_inference_ms": 1.2941023176030593, "mean_action_processing_ms": 0.21357892095580583, "mean_env_wait_ms": 349.0984479124232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012547439999050565, "StateBufferConnector_ms": 0.006300873226589627, "ViewRequirementAgentConnector_ms": 0.17890797721015084}, "num_episodes": 18, "episode_return_max": 381.50004314276725, "episode_return_min": 322.76440085484893, "episode_return_mean": 353.55620704834973}, "env_runner_results": {"episode_reward_max": 381.50004314276725, "episode_reward_min": 322.76440085484893, "episode_reward_mean": 353.55620704834973, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.5272790128511, 361.6731042816067, 338.1412574758579, 371.19525403209127, 362.09519294805045, 322.76440085484893, 355.8485774217833, 355.62922158467745, 358.81533666625717, 338.25956350276783, 342.77740657538374, 373.41363865674805, 333.53234152412745, 334.6459952724246, 381.50004314276725, 351.0803251704932, 359.38743540869234, 374.7253533388663], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.30923891437146, "mean_inference_ms": 1.2941023176030593, "mean_action_processing_ms": 0.21357892095580583, "mean_env_wait_ms": 349.0984479124232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012547439999050565, "StateBufferConnector_ms": 0.006300873226589627, "ViewRequirementAgentConnector_ms": 0.17890797721015084}, "num_episodes": 18, "episode_return_max": 381.50004314276725, "episode_return_min": 322.76440085484893, "episode_return_mean": 353.55620704834973}, "episode_reward_max": 381.50004314276725, "episode_reward_min": 322.76440085484893, "episode_reward_mean": 353.55620704834973, "episode_len_mean": 50.0, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [348.5272790128511, 361.6731042816067, 338.1412574758579, 371.19525403209127, 362.09519294805045, 322.76440085484893, 355.8485774217833, 355.62922158467745, 358.81533666625717, 338.25956350276783, 342.77740657538374, 373.41363865674805, 333.53234152412745, 334.6459952724246, 381.50004314276725, 351.0803251704932, 359.38743540869234, 374.7253533388663], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.30923891437146, "mean_inference_ms": 1.2941023176030593, "mean_action_processing_ms": 0.21357892095580583, "mean_env_wait_ms": 349.0984479124232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012547439999050565, "StateBufferConnector_ms": 0.006300873226589627, "ViewRequirementAgentConnector_ms": 0.17890797721015084}, "num_episodes": 18, "episode_return_max": 381.50004314276725, "episode_return_min": 322.76440085484893, "episode_return_mean": 353.55620704834973, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 310710, "num_agent_steps_trained": 310710, "num_env_steps_sampled": 310710, "num_env_steps_trained": 310710, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 15.128125359243487, "num_env_steps_trained_throughput_per_sec": 15.128125359243487, "timesteps_total": 310710, "num_env_steps_sampled_lifetime": 310710, "num_agent_steps_sampled_lifetime": 310710, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 310710, "timers": {"training_iteration_time_ms": 67820.709, "restore_workers_time_ms": 0.021, "training_step_time_ms": 67820.646, "sample_time_ms": 66151.904, "load_time_ms": 1.565, "load_throughput": 655599.62, "learn_time_ms": 1652.404, "learn_throughput": 620.914, "synch_weights_time_ms": 14.239}, "counters": {"num_env_steps_sampled": 310710, "num_env_steps_trained": 310710, "num_agent_steps_sampled": 310710, "num_agent_steps_trained": 310710}, "done": false, "episodes_total": 6311, "training_iteration": 288, "trial_id": "fd033_00000", "date": "2024-06-11_15-29-13", "timestamp": 1718141353, "time_this_iter_s": 67.82434797286987, "time_total_s": 21217.42551445961, "pid": 78561, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.479594042511202, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 67.82434797286987, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 43.99896907216495, "ram_util_percent": 13.861855670103095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.9641804285048479, "cur_lr": 5e-06, "total_loss": 0.8754240327825149, "policy_loss": -0.009160043043084442, "vf_loss": 0.8808187750478585, "vf_explained_var": 0.6038516633212566, "kl": 0.0039051838324064914, "entropy": -1.7239108622074126, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 311736, "num_env_steps_trained": 311736, "num_agent_steps_sampled": 311736, "num_agent_steps_trained": 311736}, "sampler_results": {"episode_reward_max": 381.50004314276725, "episode_reward_min": 286.5889024654628, "episode_reward_mean": 351.00756549000806, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.5272790128511, 361.6731042816067, 338.1412574758579, 371.19525403209127, 362.09519294805045, 322.76440085484893, 355.8485774217833, 355.62922158467745, 358.81533666625717, 338.25956350276783, 342.77740657538374, 373.41363865674805, 333.53234152412745, 334.6459952724246, 381.50004314276725, 351.0803251704932, 359.38743540869234, 374.7253533388663, 360.11427001953166, 362.6676598077372, 373.67273781825116, 329.91950649160685, 351.77763174806535, 356.1397973791132, 329.2579856131569, 344.6074357661614, 353.45250778178075, 369.2037048992112, 376.11817428419295, 351.3184756348879, 341.2697141761989, 286.5889024654628, 338.7026775761437, 330.56727884880945, 375.66817865633146, 341.21399180335084], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.309695151845438, "mean_inference_ms": 1.2973948892535232, "mean_action_processing_ms": 0.21394013376492663, "mean_env_wait_ms": 347.50195598585856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014095173941718208, "StateBufferConnector_ms": 0.006292263666788737, "ViewRequirementAgentConnector_ms": 0.17794370651245117}, "num_episodes": 18, "episode_return_max": 381.50004314276725, "episode_return_min": 286.5889024654628, "episode_return_mean": 351.00756549000806}, "env_runner_results": {"episode_reward_max": 381.50004314276725, "episode_reward_min": 286.5889024654628, "episode_reward_mean": 351.00756549000806, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.5272790128511, 361.6731042816067, 338.1412574758579, 371.19525403209127, 362.09519294805045, 322.76440085484893, 355.8485774217833, 355.62922158467745, 358.81533666625717, 338.25956350276783, 342.77740657538374, 373.41363865674805, 333.53234152412745, 334.6459952724246, 381.50004314276725, 351.0803251704932, 359.38743540869234, 374.7253533388663, 360.11427001953166, 362.6676598077372, 373.67273781825116, 329.91950649160685, 351.77763174806535, 356.1397973791132, 329.2579856131569, 344.6074357661614, 353.45250778178075, 369.2037048992112, 376.11817428419295, 351.3184756348879, 341.2697141761989, 286.5889024654628, 338.7026775761437, 330.56727884880945, 375.66817865633146, 341.21399180335084], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.309695151845438, "mean_inference_ms": 1.2973948892535232, "mean_action_processing_ms": 0.21394013376492663, "mean_env_wait_ms": 347.50195598585856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014095173941718208, "StateBufferConnector_ms": 0.006292263666788737, "ViewRequirementAgentConnector_ms": 0.17794370651245117}, "num_episodes": 18, "episode_return_max": 381.50004314276725, "episode_return_min": 286.5889024654628, "episode_return_mean": 351.00756549000806}, "episode_reward_max": 381.50004314276725, "episode_reward_min": 286.5889024654628, "episode_reward_mean": 351.00756549000806, "episode_len_mean": 50.0, "episodes_this_iter": 18, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [348.5272790128511, 361.6731042816067, 338.1412574758579, 371.19525403209127, 362.09519294805045, 322.76440085484893, 355.8485774217833, 355.62922158467745, 358.81533666625717, 338.25956350276783, 342.77740657538374, 373.41363865674805, 333.53234152412745, 334.6459952724246, 381.50004314276725, 351.0803251704932, 359.38743540869234, 374.7253533388663, 360.11427001953166, 362.6676598077372, 373.67273781825116, 329.91950649160685, 351.77763174806535, 356.1397973791132, 329.2579856131569, 344.6074357661614, 353.45250778178075, 369.2037048992112, 376.11817428419295, 351.3184756348879, 341.2697141761989, 286.5889024654628, 338.7026775761437, 330.56727884880945, 375.66817865633146, 341.21399180335084], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.309695151845438, "mean_inference_ms": 1.2973948892535232, "mean_action_processing_ms": 0.21394013376492663, "mean_env_wait_ms": 347.50195598585856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014095173941718208, "StateBufferConnector_ms": 0.006292263666788737, "ViewRequirementAgentConnector_ms": 0.17794370651245117}, "num_episodes": 18, "episode_return_max": 381.50004314276725, "episode_return_min": 286.5889024654628, "episode_return_mean": 351.00756549000806, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 311736, "num_agent_steps_trained": 311736, "num_env_steps_sampled": 311736, "num_env_steps_trained": 311736, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 15.529415030344937, "num_env_steps_trained_throughput_per_sec": 15.529415030344937, "timesteps_total": 311736, "num_env_steps_sampled_lifetime": 311736, "num_agent_steps_sampled_lifetime": 311736, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 311736, "timers": {"training_iteration_time_ms": 66944.445, "restore_workers_time_ms": 0.021, "training_step_time_ms": 66944.381, "sample_time_ms": 65373.552, "load_time_ms": 1.339, "load_throughput": 766267.077, "learn_time_ms": 1555.204, "learn_throughput": 659.721, "synch_weights_time_ms": 13.861}, "counters": {"num_env_steps_sampled": 311736, "num_env_steps_trained": 311736, "num_agent_steps_sampled": 311736, "num_agent_steps_trained": 311736}, "done": false, "episodes_total": 6329, "training_iteration": 289, "trial_id": "fd033_00000", "date": "2024-06-11_15-30-19", "timestamp": 1718141419, "time_this_iter_s": 66.07143497467041, "time_total_s": 21283.49694943428, "pid": 78561, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.479594042511202, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 133.89578294754028, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.30842105263157, "ram_util_percent": 13.797894736842103}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9283608570096957, "cur_lr": 0.00010000000000000003, "total_loss": 0.8926467020064592, "policy_loss": -0.0032390814992443967, "vf_loss": 0.8820509605109692, "vf_explained_var": 0.44657535925507547, "kl": 0.007174398277372488, "entropy": -1.7089582527677218, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 312762, "num_env_steps_trained": 312762, "num_agent_steps_sampled": 312762, "num_agent_steps_trained": 312762}, "sampler_results": {"episode_reward_max": 380.8942342697694, "episode_reward_min": 325.41553255111813, "episode_reward_mean": 352.5226043208004, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.0921643346784, 380.8942342697694, 340.507080174251, 372.5272564255669, 340.3524126238399, 338.756388444452, 343.0213204079479, 373.00364110130903, 339.3847905103128, 336.56466645998506, 367.8717725445267, 376.9103389399058, 332.7753687631568, 344.91431407897363, 370.17071420533176, 325.41553255111813, 365.99942818759575, 339.2454537516849], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.406628976496615, "mean_inference_ms": 1.3053343277568965, "mean_action_processing_ms": 0.21459705145784128, "mean_env_wait_ms": 329.4308931790581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013298458523220487, "StateBufferConnector_ms": 0.006473064422607422, "ViewRequirementAgentConnector_ms": 0.18041001425849068}, "num_episodes": 18, "episode_return_max": 380.8942342697694, "episode_return_min": 325.41553255111813, "episode_return_mean": 352.5226043208004}, "env_runner_results": {"episode_reward_max": 380.8942342697694, "episode_reward_min": 325.41553255111813, "episode_reward_mean": 352.5226043208004, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.0921643346784, 380.8942342697694, 340.507080174251, 372.5272564255669, 340.3524126238399, 338.756388444452, 343.0213204079479, 373.00364110130903, 339.3847905103128, 336.56466645998506, 367.8717725445267, 376.9103389399058, 332.7753687631568, 344.91431407897363, 370.17071420533176, 325.41553255111813, 365.99942818759575, 339.2454537516849], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.406628976496615, "mean_inference_ms": 1.3053343277568965, "mean_action_processing_ms": 0.21459705145784128, "mean_env_wait_ms": 329.4308931790581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013298458523220487, "StateBufferConnector_ms": 0.006473064422607422, "ViewRequirementAgentConnector_ms": 0.18041001425849068}, "num_episodes": 18, "episode_return_max": 380.8942342697694, "episode_return_min": 325.41553255111813, "episode_return_mean": 352.5226043208004}, "episode_reward_max": 380.8942342697694, "episode_reward_min": 325.41553255111813, "episode_reward_mean": 352.5226043208004, "episode_len_mean": 50.0, "episodes_this_iter": 18, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [357.0921643346784, 380.8942342697694, 340.507080174251, 372.5272564255669, 340.3524126238399, 338.756388444452, 343.0213204079479, 373.00364110130903, 339.3847905103128, 336.56466645998506, 367.8717725445267, 376.9103389399058, 332.7753687631568, 344.91431407897363, 370.17071420533176, 325.41553255111813, 365.99942818759575, 339.2454537516849], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.406628976496615, "mean_inference_ms": 1.3053343277568965, "mean_action_processing_ms": 0.21459705145784128, "mean_env_wait_ms": 329.4308931790581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013298458523220487, "StateBufferConnector_ms": 0.006473064422607422, "ViewRequirementAgentConnector_ms": 0.18041001425849068}, "num_episodes": 18, "episode_return_max": 380.8942342697694, "episode_return_min": 325.41553255111813, "episode_return_mean": 352.5226043208004, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312762, "num_agent_steps_trained": 312762, "num_env_steps_sampled": 312762, "num_env_steps_trained": 312762, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 16.00821248984964, "num_env_steps_trained_throughput_per_sec": 16.00821248984964, "timesteps_total": 312762, "num_env_steps_sampled_lifetime": 312762, "num_agent_steps_sampled_lifetime": 312762, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 312762, "timers": {"training_iteration_time_ms": 64092.122, "restore_workers_time_ms": 0.029, "training_step_time_ms": 64092.041, "sample_time_ms": 62415.287, "load_time_ms": 1.728, "load_throughput": 593812.047, "learn_time_ms": 1660.559, "learn_throughput": 617.864, "synch_weights_time_ms": 13.959}, "counters": {"num_env_steps_sampled": 312762, "num_env_steps_trained": 312762, "num_agent_steps_sampled": 312762, "num_agent_steps_trained": 312762}, "done": false, "episodes_total": 6347, "training_iteration": 289, "trial_id": "fd033_00000", "date": "2024-06-11_15-31-42", "timestamp": 1718141502, "time_this_iter_s": 64.0952308177948, "time_total_s": 21348.91325235367, "pid": 10780, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.44621209756639024, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.8632692765201635, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 64.0952308177948, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.53804347826087, "ram_util_percent": 13.138043478260867}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9283608570096957, "cur_lr": 0.00010000000000000003, "total_loss": 0.8357288916905721, "policy_loss": -0.0054428888795276485, "vf_loss": 0.8332761774460474, "vf_explained_var": 0.4427460787196954, "kl": 0.004094462817011441, "entropy": -1.7762553130586942, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 313788, "num_env_steps_trained": 313788, "num_agent_steps_sampled": 313788, "num_agent_steps_trained": 313788}, "sampler_results": {"episode_reward_max": 381.24233833579376, "episode_reward_min": 321.9055347841989, "episode_reward_mean": 351.9925521649876, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.0921643346784, 380.8942342697694, 340.507080174251, 372.5272564255669, 340.3524126238399, 338.756388444452, 343.0213204079479, 373.00364110130903, 339.3847905103128, 336.56466645998506, 367.8717725445267, 376.9103389399058, 332.7753687631568, 344.91431407897363, 370.17071420533176, 325.41553255111813, 365.99942818759575, 339.2454537516849, 326.48513524322834, 373.0037477708367, 370.00483904721966, 335.7754117049336, 349.430335932057, 352.90658121001655, 375.35013181356004, 338.34293169851054, 381.24233833579376, 367.0563890218609, 321.9055347841989, 335.8968528509343, 342.8990462249464, 351.7129991815161, 358.7259963459688, 335.9548036997993, 351.6011240896062, 358.03080121016177], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.397100590335626, "mean_inference_ms": 1.300631574224714, "mean_action_processing_ms": 0.21410054949514443, "mean_env_wait_ms": 331.2202287787304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014444854524400499, "StateBufferConnector_ms": 0.0064584943983289934, "ViewRequirementAgentConnector_ms": 0.1787616146935357}, "num_episodes": 18, "episode_return_max": 381.24233833579376, "episode_return_min": 321.9055347841989, "episode_return_mean": 351.9925521649876}, "env_runner_results": {"episode_reward_max": 381.24233833579376, "episode_reward_min": 321.9055347841989, "episode_reward_mean": 351.9925521649876, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.0921643346784, 380.8942342697694, 340.507080174251, 372.5272564255669, 340.3524126238399, 338.756388444452, 343.0213204079479, 373.00364110130903, 339.3847905103128, 336.56466645998506, 367.8717725445267, 376.9103389399058, 332.7753687631568, 344.91431407897363, 370.17071420533176, 325.41553255111813, 365.99942818759575, 339.2454537516849, 326.48513524322834, 373.0037477708367, 370.00483904721966, 335.7754117049336, 349.430335932057, 352.90658121001655, 375.35013181356004, 338.34293169851054, 381.24233833579376, 367.0563890218609, 321.9055347841989, 335.8968528509343, 342.8990462249464, 351.7129991815161, 358.7259963459688, 335.9548036997993, 351.6011240896062, 358.03080121016177], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.397100590335626, "mean_inference_ms": 1.300631574224714, "mean_action_processing_ms": 0.21410054949514443, "mean_env_wait_ms": 331.2202287787304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014444854524400499, "StateBufferConnector_ms": 0.0064584943983289934, "ViewRequirementAgentConnector_ms": 0.1787616146935357}, "num_episodes": 18, "episode_return_max": 381.24233833579376, "episode_return_min": 321.9055347841989, "episode_return_mean": 351.9925521649876}, "episode_reward_max": 381.24233833579376, "episode_reward_min": 321.9055347841989, "episode_reward_mean": 351.9925521649876, "episode_len_mean": 50.0, "episodes_this_iter": 18, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [357.0921643346784, 380.8942342697694, 340.507080174251, 372.5272564255669, 340.3524126238399, 338.756388444452, 343.0213204079479, 373.00364110130903, 339.3847905103128, 336.56466645998506, 367.8717725445267, 376.9103389399058, 332.7753687631568, 344.91431407897363, 370.17071420533176, 325.41553255111813, 365.99942818759575, 339.2454537516849, 326.48513524322834, 373.0037477708367, 370.00483904721966, 335.7754117049336, 349.430335932057, 352.90658121001655, 375.35013181356004, 338.34293169851054, 381.24233833579376, 367.0563890218609, 321.9055347841989, 335.8968528509343, 342.8990462249464, 351.7129991815161, 358.7259963459688, 335.9548036997993, 351.6011240896062, 358.03080121016177], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.397100590335626, "mean_inference_ms": 1.300631574224714, "mean_action_processing_ms": 0.21410054949514443, "mean_env_wait_ms": 331.2202287787304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014444854524400499, "StateBufferConnector_ms": 0.0064584943983289934, "ViewRequirementAgentConnector_ms": 0.1787616146935357}, "num_episodes": 18, "episode_return_max": 381.24233833579376, "episode_return_min": 321.9055347841989, "episode_return_mean": 351.9925521649876, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 313788, "num_agent_steps_trained": 313788, "num_env_steps_sampled": 313788, "num_env_steps_trained": 313788, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 15.764003973196845, "num_env_steps_trained_throughput_per_sec": 15.764003973196845, "timesteps_total": 313788, "num_env_steps_sampled_lifetime": 313788, "num_agent_steps_sampled_lifetime": 313788, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 313788, "timers": {"training_iteration_time_ms": 64588.563, "restore_workers_time_ms": 0.027, "training_step_time_ms": 64588.484, "sample_time_ms": 62974.014, "load_time_ms": 1.481, "load_throughput": 692860.393, "learn_time_ms": 1598.633, "learn_throughput": 641.798, "synch_weights_time_ms": 13.942}, "counters": {"num_env_steps_sampled": 313788, "num_env_steps_trained": 313788, "num_agent_steps_sampled": 313788, "num_agent_steps_trained": 313788}, "done": false, "episodes_total": 6365, "training_iteration": 290, "trial_id": "fd033_00000", "date": "2024-06-11_15-32-47", "timestamp": 1718141567, "time_this_iter_s": 65.08869647979736, "time_total_s": 21414.001948833466, "pid": 10780, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.44621209756639024, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.8632692765201635, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 129.18392729759216, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 46.18279569892474, "ram_util_percent": 13.924731182795702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3615676606893177, "cur_lr": 1e-05, "total_loss": 0.7764314060409864, "policy_loss": -0.020704608255376417, "vf_loss": 0.794225537776947, "vf_explained_var": 0.4862845396002134, "kl": 0.008049608562821822, "entropy": -1.7091155538956324, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 312252, "num_env_steps_trained": 312252, "num_agent_steps_sampled": 312252, "num_agent_steps_trained": 312252}, "sampler_results": {"episode_reward_max": 370.25189737895573, "episode_reward_min": 334.06584119415237, "episode_reward_mean": 359.62836254686675, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.06584119415237, 362.35658114779744, 360.83972086290004, 366.8090641655552, 370.25189737895573, 363.4470705318393], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2569335849805805, "mean_inference_ms": 1.3159239429166945, "mean_action_processing_ms": 0.2146260491732893, "mean_env_wait_ms": 363.3131761660521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00938574473063151, "StateBufferConnector_ms": 0.006111462910970052, "ViewRequirementAgentConnector_ms": 0.1762827237447103}, "num_episodes": 6, "episode_return_max": 370.25189737895573, "episode_return_min": 334.06584119415237, "episode_return_mean": 359.62836254686675}, "env_runner_results": {"episode_reward_max": 370.25189737895573, "episode_reward_min": 334.06584119415237, "episode_reward_mean": 359.62836254686675, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.06584119415237, 362.35658114779744, 360.83972086290004, 366.8090641655552, 370.25189737895573, 363.4470705318393], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2569335849805805, "mean_inference_ms": 1.3159239429166945, "mean_action_processing_ms": 0.2146260491732893, "mean_env_wait_ms": 363.3131761660521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00938574473063151, "StateBufferConnector_ms": 0.006111462910970052, "ViewRequirementAgentConnector_ms": 0.1762827237447103}, "num_episodes": 6, "episode_return_max": 370.25189737895573, "episode_return_min": 334.06584119415237, "episode_return_mean": 359.62836254686675}, "episode_reward_max": 370.25189737895573, "episode_reward_min": 334.06584119415237, "episode_reward_mean": 359.62836254686675, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.06584119415237, 362.35658114779744, 360.83972086290004, 366.8090641655552, 370.25189737895573, 363.4470705318393], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2569335849805805, "mean_inference_ms": 1.3159239429166945, "mean_action_processing_ms": 0.2146260491732893, "mean_env_wait_ms": 363.3131761660521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00938574473063151, "StateBufferConnector_ms": 0.006111462910970052, "ViewRequirementAgentConnector_ms": 0.1762827237447103}, "num_episodes": 6, "episode_return_max": 370.25189737895573, "episode_return_min": 334.06584119415237, "episode_return_mean": 359.62836254686675, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312252, "num_agent_steps_trained": 312252, "num_env_steps_sampled": 312252, "num_env_steps_trained": 312252, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.535732570244729, "num_env_steps_trained_throughput_per_sec": 14.535732570244729, "timesteps_total": 312252, "num_env_steps_sampled_lifetime": 312252, "num_agent_steps_sampled_lifetime": 312252, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 312252, "timers": {"training_iteration_time_ms": 35498.739, "restore_workers_time_ms": 0.022, "training_step_time_ms": 35498.671, "sample_time_ms": 34579.623, "load_time_ms": 1.491, "load_throughput": 346115.603, "learn_time_ms": 902.547, "learn_throughput": 571.715, "synch_weights_time_ms": 14.55}, "counters": {"num_env_steps_sampled": 312252, "num_env_steps_trained": 312252, "num_agent_steps_sampled": 312252, "num_agent_steps_trained": 312252}, "done": false, "episodes_total": 6341, "training_iteration": 291, "trial_id": "fd033_00000", "date": "2024-06-11_15-33-42", "timestamp": 1718141622, "time_this_iter_s": 35.50213980674744, "time_total_s": 21331.30809521675, "pid": 41836, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24789560975910574, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9968393729010825, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 35.50213980674744, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.501960784313724, "ram_util_percent": 13.18823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3615676606893177, "cur_lr": 1e-05, "total_loss": 0.7280811076362927, "policy_loss": -0.01065428601577878, "vf_loss": 0.7378745011985302, "vf_explained_var": 0.40493452896674476, "kl": 0.0023810134388137765, "entropy": -1.6905089636643729, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 312768, "num_env_steps_trained": 312768, "num_agent_steps_sampled": 312768, "num_agent_steps_trained": 312768}, "sampler_results": {"episode_reward_max": 372.19439306771903, "episode_reward_min": 317.4100825864741, "episode_reward_mean": 355.51248248336714, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.06584119415237, 362.35658114779744, 360.83972086290004, 366.8090641655552, 370.25189737895573, 363.4470705318393, 343.57272636784654, 365.20028753352017, 347.3393360362352, 369.27264992876786, 324.2737545630414, 362.2536464444443, 367.1454523298911, 317.4100825864741, 363.6614352506247, 360.39049930257016, 372.19439306771903, 348.7402460082726], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.992326771257523, "mean_inference_ms": 1.315697362630826, "mean_action_processing_ms": 0.2148641984602611, "mean_env_wait_ms": 339.4379504423475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012569957309299044, "StateBufferConnector_ms": 0.006400214301215278, "ViewRequirementAgentConnector_ms": 0.18128024207221138}, "num_episodes": 12, "episode_return_max": 372.19439306771903, "episode_return_min": 317.4100825864741, "episode_return_mean": 355.51248248336714}, "env_runner_results": {"episode_reward_max": 372.19439306771903, "episode_reward_min": 317.4100825864741, "episode_reward_mean": 355.51248248336714, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.06584119415237, 362.35658114779744, 360.83972086290004, 366.8090641655552, 370.25189737895573, 363.4470705318393, 343.57272636784654, 365.20028753352017, 347.3393360362352, 369.27264992876786, 324.2737545630414, 362.2536464444443, 367.1454523298911, 317.4100825864741, 363.6614352506247, 360.39049930257016, 372.19439306771903, 348.7402460082726], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.992326771257523, "mean_inference_ms": 1.315697362630826, "mean_action_processing_ms": 0.2148641984602611, "mean_env_wait_ms": 339.4379504423475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012569957309299044, "StateBufferConnector_ms": 0.006400214301215278, "ViewRequirementAgentConnector_ms": 0.18128024207221138}, "num_episodes": 12, "episode_return_max": 372.19439306771903, "episode_return_min": 317.4100825864741, "episode_return_mean": 355.51248248336714}, "episode_reward_max": 372.19439306771903, "episode_reward_min": 317.4100825864741, "episode_reward_mean": 355.51248248336714, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.06584119415237, 362.35658114779744, 360.83972086290004, 366.8090641655552, 370.25189737895573, 363.4470705318393, 343.57272636784654, 365.20028753352017, 347.3393360362352, 369.27264992876786, 324.2737545630414, 362.2536464444443, 367.1454523298911, 317.4100825864741, 363.6614352506247, 360.39049930257016, 372.19439306771903, 348.7402460082726], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.992326771257523, "mean_inference_ms": 1.315697362630826, "mean_action_processing_ms": 0.2148641984602611, "mean_env_wait_ms": 339.4379504423475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012569957309299044, "StateBufferConnector_ms": 0.006400214301215278, "ViewRequirementAgentConnector_ms": 0.18128024207221138}, "num_episodes": 12, "episode_return_max": 372.19439306771903, "episode_return_min": 317.4100825864741, "episode_return_mean": 355.51248248336714, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312768, "num_agent_steps_trained": 312768, "num_env_steps_sampled": 312768, "num_env_steps_trained": 312768, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 17.80357308041531, "num_env_steps_trained_throughput_per_sec": 17.80357308041531, "timesteps_total": 312768, "num_env_steps_sampled_lifetime": 312768, "num_agent_steps_sampled_lifetime": 312768, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 312768, "timers": {"training_iteration_time_ms": 32240.85, "restore_workers_time_ms": 0.022, "training_step_time_ms": 32240.781, "sample_time_ms": 31393.984, "load_time_ms": 1.327, "load_throughput": 388870.877, "learn_time_ms": 830.876, "learn_throughput": 621.031, "synch_weights_time_ms": 14.232}, "counters": {"num_env_steps_sampled": 312768, "num_env_steps_trained": 312768, "num_agent_steps_sampled": 312768, "num_agent_steps_trained": 312768}, "done": false, "episodes_total": 6353, "training_iteration": 292, "trial_id": "fd033_00000", "date": "2024-06-11_15-34-11", "timestamp": 1718141651, "time_this_iter_s": 28.98596167564392, "time_total_s": 21360.294056892395, "pid": 41836, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24789560975910574, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9968393729010825, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 64.48810148239136, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 50.973809523809514, "ram_util_percent": 13.90952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.18078383034465886, "cur_lr": 1e-05, "total_loss": 0.8433067495624225, "policy_loss": -0.011208100461711485, "vf_loss": 0.8530123755335808, "vf_explained_var": 0.12001285950342815, "kl": 0.008310924861629479, "entropy": -1.753544615705808, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 313284, "num_env_steps_trained": 313284, "num_agent_steps_sampled": 313284, "num_agent_steps_trained": 313284}, "sampler_results": {"episode_reward_max": 377.512416337164, "episode_reward_min": 294.7255272872156, "episode_reward_mean": 353.57978922349844, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.06584119415237, 362.35658114779744, 360.83972086290004, 366.8090641655552, 370.25189737895573, 363.4470705318393, 343.57272636784654, 365.20028753352017, 347.3393360362352, 369.27264992876786, 324.2737545630414, 362.2536464444443, 367.1454523298911, 317.4100825864741, 363.6614352506247, 360.39049930257016, 372.19439306771903, 348.7402460082726, 328.8101919873389, 370.196494448684, 294.7255272872156, 335.76537646476834, 372.00803096480934, 371.6148242705994, 336.1335755079898, 360.6514350562111, 372.5125753241248, 328.6306019206064, 377.512416337164, 359.6079424348363], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.279615735842518, "mean_inference_ms": 1.3142004780813814, "mean_action_processing_ms": 0.21488452620572274, "mean_env_wait_ms": 342.22825362869384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01319726308186849, "StateBufferConnector_ms": 0.006464322408040364, "ViewRequirementAgentConnector_ms": 0.18032471338907877}, "num_episodes": 12, "episode_return_max": 377.512416337164, "episode_return_min": 294.7255272872156, "episode_return_mean": 353.57978922349844}, "env_runner_results": {"episode_reward_max": 377.512416337164, "episode_reward_min": 294.7255272872156, "episode_reward_mean": 353.57978922349844, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.06584119415237, 362.35658114779744, 360.83972086290004, 366.8090641655552, 370.25189737895573, 363.4470705318393, 343.57272636784654, 365.20028753352017, 347.3393360362352, 369.27264992876786, 324.2737545630414, 362.2536464444443, 367.1454523298911, 317.4100825864741, 363.6614352506247, 360.39049930257016, 372.19439306771903, 348.7402460082726, 328.8101919873389, 370.196494448684, 294.7255272872156, 335.76537646476834, 372.00803096480934, 371.6148242705994, 336.1335755079898, 360.6514350562111, 372.5125753241248, 328.6306019206064, 377.512416337164, 359.6079424348363], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.279615735842518, "mean_inference_ms": 1.3142004780813814, "mean_action_processing_ms": 0.21488452620572274, "mean_env_wait_ms": 342.22825362869384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01319726308186849, "StateBufferConnector_ms": 0.006464322408040364, "ViewRequirementAgentConnector_ms": 0.18032471338907877}, "num_episodes": 12, "episode_return_max": 377.512416337164, "episode_return_min": 294.7255272872156, "episode_return_mean": 353.57978922349844}, "episode_reward_max": 377.512416337164, "episode_reward_min": 294.7255272872156, "episode_reward_mean": 353.57978922349844, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.06584119415237, 362.35658114779744, 360.83972086290004, 366.8090641655552, 370.25189737895573, 363.4470705318393, 343.57272636784654, 365.20028753352017, 347.3393360362352, 369.27264992876786, 324.2737545630414, 362.2536464444443, 367.1454523298911, 317.4100825864741, 363.6614352506247, 360.39049930257016, 372.19439306771903, 348.7402460082726, 328.8101919873389, 370.196494448684, 294.7255272872156, 335.76537646476834, 372.00803096480934, 371.6148242705994, 336.1335755079898, 360.6514350562111, 372.5125753241248, 328.6306019206064, 377.512416337164, 359.6079424348363], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.279615735842518, "mean_inference_ms": 1.3142004780813814, "mean_action_processing_ms": 0.21488452620572274, "mean_env_wait_ms": 342.22825362869384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01319726308186849, "StateBufferConnector_ms": 0.006464322408040364, "ViewRequirementAgentConnector_ms": 0.18032471338907877}, "num_episodes": 12, "episode_return_max": 377.512416337164, "episode_return_min": 294.7255272872156, "episode_return_mean": 353.57978922349844, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 313284, "num_agent_steps_trained": 313284, "num_env_steps_sampled": 313284, "num_env_steps_trained": 313284, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.91979975501404, "num_env_steps_trained_throughput_per_sec": 13.91979975501404, "timesteps_total": 313284, "num_env_steps_sampled_lifetime": 313284, "num_agent_steps_sampled_lifetime": 313284, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 313284, "timers": {"training_iteration_time_ms": 33850.404, "restore_workers_time_ms": 0.022, "training_step_time_ms": 33850.337, "sample_time_ms": 33028.272, "load_time_ms": 1.266, "load_throughput": 407633.262, "learn_time_ms": 806.584, "learn_throughput": 639.735, "synch_weights_time_ms": 13.888}, "counters": {"num_env_steps_sampled": 313284, "num_env_steps_trained": 313284, "num_agent_steps_sampled": 313284, "num_agent_steps_trained": 313284}, "done": false, "episodes_total": 6365, "training_iteration": 293, "trial_id": "fd033_00000", "date": "2024-06-11_15-34-48", "timestamp": 1718141688, "time_this_iter_s": 37.072577714920044, "time_total_s": 21397.366634607315, "pid": 41836, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24789560975910574, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9968393729010825, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 101.5606791973114, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.486792452830194, "ram_util_percent": 14.060377358490566}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.18078383034465886, "cur_lr": 1e-05, "total_loss": 0.8152474537491798, "policy_loss": 0.019128368251646558, "vf_loss": 0.7913399363557497, "vf_explained_var": 0.5747835124532382, "kl": 0.02643568940924022, "entropy": -1.7430773774782817, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 313800, "num_env_steps_trained": 313800, "num_agent_steps_sampled": 313800, "num_agent_steps_trained": 313800}, "sampler_results": {"episode_reward_max": 377.512416337164, "episode_reward_min": 294.7255272872156, "episode_reward_mean": 354.03503443714675, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.06584119415237, 362.35658114779744, 360.83972086290004, 366.8090641655552, 370.25189737895573, 363.4470705318393, 343.57272636784654, 365.20028753352017, 347.3393360362352, 369.27264992876786, 324.2737545630414, 362.2536464444443, 367.1454523298911, 317.4100825864741, 363.6614352506247, 360.39049930257016, 372.19439306771903, 348.7402460082726, 328.8101919873389, 370.196494448684, 294.7255272872156, 335.76537646476834, 372.00803096480934, 371.6148242705994, 336.1335755079898, 360.6514350562111, 372.5125753241248, 328.6306019206064, 377.512416337164, 359.6079424348363, 359.94697373342353, 365.17341469677456, 340.3510715223185, 369.43277583949146, 339.5335472406038, 363.42977999971674], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.290029699346096, "mean_inference_ms": 1.3136782303120014, "mean_action_processing_ms": 0.21491957052047025, "mean_env_wait_ms": 340.19774936950523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01402033699883355, "StateBufferConnector_ms": 0.0064644548628065325, "ViewRequirementAgentConnector_ms": 0.18015503883361816}, "num_episodes": 6, "episode_return_max": 377.512416337164, "episode_return_min": 294.7255272872156, "episode_return_mean": 354.03503443714675}, "env_runner_results": {"episode_reward_max": 377.512416337164, "episode_reward_min": 294.7255272872156, "episode_reward_mean": 354.03503443714675, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.06584119415237, 362.35658114779744, 360.83972086290004, 366.8090641655552, 370.25189737895573, 363.4470705318393, 343.57272636784654, 365.20028753352017, 347.3393360362352, 369.27264992876786, 324.2737545630414, 362.2536464444443, 367.1454523298911, 317.4100825864741, 363.6614352506247, 360.39049930257016, 372.19439306771903, 348.7402460082726, 328.8101919873389, 370.196494448684, 294.7255272872156, 335.76537646476834, 372.00803096480934, 371.6148242705994, 336.1335755079898, 360.6514350562111, 372.5125753241248, 328.6306019206064, 377.512416337164, 359.6079424348363, 359.94697373342353, 365.17341469677456, 340.3510715223185, 369.43277583949146, 339.5335472406038, 363.42977999971674], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.290029699346096, "mean_inference_ms": 1.3136782303120014, "mean_action_processing_ms": 0.21491957052047025, "mean_env_wait_ms": 340.19774936950523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01402033699883355, "StateBufferConnector_ms": 0.0064644548628065325, "ViewRequirementAgentConnector_ms": 0.18015503883361816}, "num_episodes": 6, "episode_return_max": 377.512416337164, "episode_return_min": 294.7255272872156, "episode_return_mean": 354.03503443714675}, "episode_reward_max": 377.512416337164, "episode_reward_min": 294.7255272872156, "episode_reward_mean": 354.03503443714675, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [334.06584119415237, 362.35658114779744, 360.83972086290004, 366.8090641655552, 370.25189737895573, 363.4470705318393, 343.57272636784654, 365.20028753352017, 347.3393360362352, 369.27264992876786, 324.2737545630414, 362.2536464444443, 367.1454523298911, 317.4100825864741, 363.6614352506247, 360.39049930257016, 372.19439306771903, 348.7402460082726, 328.8101919873389, 370.196494448684, 294.7255272872156, 335.76537646476834, 372.00803096480934, 371.6148242705994, 336.1335755079898, 360.6514350562111, 372.5125753241248, 328.6306019206064, 377.512416337164, 359.6079424348363, 359.94697373342353, 365.17341469677456, 340.3510715223185, 369.43277583949146, 339.5335472406038, 363.42977999971674], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.290029699346096, "mean_inference_ms": 1.3136782303120014, "mean_action_processing_ms": 0.21491957052047025, "mean_env_wait_ms": 340.19774936950523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01402033699883355, "StateBufferConnector_ms": 0.0064644548628065325, "ViewRequirementAgentConnector_ms": 0.18015503883361816}, "num_episodes": 6, "episode_return_max": 377.512416337164, "episode_return_min": 294.7255272872156, "episode_return_mean": 354.03503443714675, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 313800, "num_agent_steps_trained": 313800, "num_env_steps_sampled": 313800, "num_env_steps_trained": 313800, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 18.34105651565336, "num_env_steps_trained_throughput_per_sec": 18.34105651565336, "timesteps_total": 313800, "num_env_steps_sampled_lifetime": 313800, "num_agent_steps_sampled_lifetime": 313800, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 313800, "timers": {"training_iteration_time_ms": 32421.208, "restore_workers_time_ms": 0.022, "training_step_time_ms": 32421.14, "sample_time_ms": 31610.636, "load_time_ms": 1.243, "load_throughput": 415205.921, "learn_time_ms": 795.113, "learn_throughput": 648.964, "synch_weights_time_ms": 13.836}, "counters": {"num_env_steps_sampled": 313800, "num_env_steps_trained": 313800, "num_agent_steps_sampled": 313800, "num_agent_steps_trained": 313800}, "done": false, "episodes_total": 6371, "training_iteration": 294, "trial_id": "fd033_00000", "date": "2024-06-11_15-35-16", "timestamp": 1718141716, "time_this_iter_s": 28.13673448562622, "time_total_s": 21425.50336909294, "pid": 41836, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.24789560975910574, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9968393729010825, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 129.69741368293762, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 54.410000000000004, "ram_util_percent": 14.16}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.18078383034465886, "cur_lr": 5e-06, "total_loss": 0.8442320356766383, "policy_loss": -0.010960454388987273, "vf_loss": 0.8534466490149498, "vf_explained_var": 0.5774805386861165, "kl": 0.00965707305804369, "entropy": -1.7801794499158858, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 314304, "num_env_steps_trained": 314304, "num_agent_steps_sampled": 314304, "num_agent_steps_trained": 314304}, "sampler_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 331.7931012574107, "episode_reward_mean": 356.6686213327089, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.253601662500608, "mean_inference_ms": 1.309242285074402, "mean_action_processing_ms": 0.2162483916885551, "mean_env_wait_ms": 273.09377668461116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010494391123453775, "StateBufferConnector_ms": 0.006488958994547526, "ViewRequirementAgentConnector_ms": 0.17911195755004883}, "num_episodes": 6, "episode_return_max": 382.5117554668941, "episode_return_min": 331.7931012574107, "episode_return_mean": 356.6686213327089}, "env_runner_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 331.7931012574107, "episode_reward_mean": 356.6686213327089, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.253601662500608, "mean_inference_ms": 1.309242285074402, "mean_action_processing_ms": 0.2162483916885551, "mean_env_wait_ms": 273.09377668461116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010494391123453775, "StateBufferConnector_ms": 0.006488958994547526, "ViewRequirementAgentConnector_ms": 0.17911195755004883}, "num_episodes": 6, "episode_return_max": 382.5117554668941, "episode_return_min": 331.7931012574107, "episode_return_mean": 356.6686213327089}, "episode_reward_max": 382.5117554668941, "episode_reward_min": 331.7931012574107, "episode_reward_mean": 356.6686213327089, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 300, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941], "episode_lengths": [50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.253601662500608, "mean_inference_ms": 1.309242285074402, "mean_action_processing_ms": 0.2162483916885551, "mean_env_wait_ms": 273.09377668461116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010494391123453775, "StateBufferConnector_ms": 0.006488958994547526, "ViewRequirementAgentConnector_ms": 0.17911195755004883}, "num_episodes": 6, "episode_return_max": 382.5117554668941, "episode_return_min": 331.7931012574107, "episode_return_mean": 356.6686213327089, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 314304, "num_agent_steps_trained": 314304, "num_env_steps_sampled": 314304, "num_env_steps_trained": 314304, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 18.98579663388713, "num_env_steps_trained_throughput_per_sec": 18.98579663388713, "timesteps_total": 314304, "num_env_steps_sampled_lifetime": 314304, "num_agent_steps_sampled_lifetime": 314304, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 314304, "timers": {"training_iteration_time_ms": 27178.228, "restore_workers_time_ms": 0.022, "training_step_time_ms": 27178.161, "sample_time_ms": 26263.282, "load_time_ms": 1.586, "load_throughput": 325354.91, "learn_time_ms": 898.773, "learn_throughput": 574.116, "synch_weights_time_ms": 13.981}, "counters": {"num_env_steps_sampled": 314304, "num_env_steps_trained": 314304, "num_agent_steps_sampled": 314304, "num_agent_steps_trained": 314304}, "done": false, "episodes_total": 6377, "training_iteration": 293, "trial_id": "fd033_00000", "date": "2024-06-11_15-36-02", "timestamp": 1718141762, "time_this_iter_s": 27.18161916732788, "time_total_s": 21451.59067964554, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 27.18161916732788, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.6, "ram_util_percent": 12.212820512820514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.18078383034465886, "cur_lr": 5e-06, "total_loss": 0.5356334494271626, "policy_loss": -0.026498106059928736, "vf_loss": 0.5598624798158804, "vf_explained_var": 0.389420356353124, "kl": 0.012551305065184508, "entropy": -1.9048059205214183, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 314820, "num_env_steps_trained": 314820, "num_agent_steps_sampled": 314820, "num_agent_steps_trained": 314820}, "sampler_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 331.7931012574107, "episode_reward_mean": 359.3217176694847, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.981085101778368, "mean_inference_ms": 1.3066048520363565, "mean_action_processing_ms": 0.2157894809378122, "mean_env_wait_ms": 304.21668241941705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013087855445014106, "StateBufferConnector_ms": 0.0065432654486762155, "ViewRequirementAgentConnector_ms": 0.18114381366305882}, "num_episodes": 12, "episode_return_max": 382.5117554668941, "episode_return_min": 331.7931012574107, "episode_return_mean": 359.3217176694847}, "env_runner_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 331.7931012574107, "episode_reward_mean": 359.3217176694847, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.981085101778368, "mean_inference_ms": 1.3066048520363565, "mean_action_processing_ms": 0.2157894809378122, "mean_env_wait_ms": 304.21668241941705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013087855445014106, "StateBufferConnector_ms": 0.0065432654486762155, "ViewRequirementAgentConnector_ms": 0.18114381366305882}, "num_episodes": 12, "episode_return_max": 382.5117554668941, "episode_return_min": 331.7931012574107, "episode_return_mean": 359.3217176694847}, "episode_reward_max": 382.5117554668941, "episode_reward_min": 331.7931012574107, "episode_reward_mean": 359.3217176694847, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 900, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.981085101778368, "mean_inference_ms": 1.3066048520363565, "mean_action_processing_ms": 0.2157894809378122, "mean_env_wait_ms": 304.21668241941705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013087855445014106, "StateBufferConnector_ms": 0.0065432654486762155, "ViewRequirementAgentConnector_ms": 0.18114381366305882}, "num_episodes": 12, "episode_return_max": 382.5117554668941, "episode_return_min": 331.7931012574107, "episode_return_mean": 359.3217176694847, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 314820, "num_agent_steps_trained": 314820, "num_env_steps_sampled": 314820, "num_env_steps_trained": 314820, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.552679531069934, "num_env_steps_trained_throughput_per_sec": 14.552679531069934, "timesteps_total": 314820, "num_env_steps_sampled_lifetime": 314820, "num_agent_steps_sampled_lifetime": 314820, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 314820, "timers": {"training_iteration_time_ms": 31317.815, "restore_workers_time_ms": 0.022, "training_step_time_ms": 31317.746, "sample_time_ms": 30474.387, "load_time_ms": 1.362, "load_throughput": 378797.736, "learn_time_ms": 827.726, "learn_throughput": 623.395, "synch_weights_time_ms": 13.861}, "counters": {"num_env_steps_sampled": 314820, "num_env_steps_trained": 314820, "num_agent_steps_sampled": 314820, "num_agent_steps_trained": 314820}, "done": false, "episodes_total": 6389, "training_iteration": 294, "trial_id": "fd033_00000", "date": "2024-06-11_15-36-37", "timestamp": 1718141797, "time_this_iter_s": 35.460740089416504, "time_total_s": 21487.051419734955, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 62.642359256744385, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.3686274509804, "ram_util_percent": 12.784313725490197}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.18078383034465886, "cur_lr": 5e-06, "total_loss": 0.8491637418667476, "policy_loss": -0.010843354448055228, "vf_loss": 0.8590040142337482, "vf_explained_var": 0.3977433567245801, "kl": 0.005548515249635481, "entropy": -1.7551705231269201, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 315336, "num_env_steps_trained": 315336, "num_agent_steps_sampled": 315336, "num_agent_steps_trained": 315336}, "sampler_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 306.1879914486725, "episode_reward_mean": 355.3633266593551, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.263733994156622, "mean_inference_ms": 1.3067399236381085, "mean_action_processing_ms": 0.21557311190614448, "mean_env_wait_ms": 308.28217048256073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013333956400553385, "StateBufferConnector_ms": 0.006439685821533203, "ViewRequirementAgentConnector_ms": 0.1788489023844401}, "num_episodes": 12, "episode_return_max": 382.5117554668941, "episode_return_min": 306.1879914486725, "episode_return_mean": 355.3633266593551}, "env_runner_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 306.1879914486725, "episode_reward_mean": 355.3633266593551, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.263733994156622, "mean_inference_ms": 1.3067399236381085, "mean_action_processing_ms": 0.21557311190614448, "mean_env_wait_ms": 308.28217048256073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013333956400553385, "StateBufferConnector_ms": 0.006439685821533203, "ViewRequirementAgentConnector_ms": 0.1788489023844401}, "num_episodes": 12, "episode_return_max": 382.5117554668941, "episode_return_min": 306.1879914486725, "episode_return_mean": 355.3633266593551}, "episode_reward_max": 382.5117554668941, "episode_reward_min": 306.1879914486725, "episode_reward_mean": 355.3633266593551, "episode_len_mean": 50.0, "episodes_this_iter": 12, "episodes_timesteps_total": 1500, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.263733994156622, "mean_inference_ms": 1.3067399236381085, "mean_action_processing_ms": 0.21557311190614448, "mean_env_wait_ms": 308.28217048256073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013333956400553385, "StateBufferConnector_ms": 0.006439685821533203, "ViewRequirementAgentConnector_ms": 0.1788489023844401}, "num_episodes": 12, "episode_return_max": 382.5117554668941, "episode_return_min": 306.1879914486725, "episode_return_mean": 355.3633266593551, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315336, "num_agent_steps_trained": 315336, "num_env_steps_sampled": 315336, "num_env_steps_trained": 315336, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 17.18526492875498, "num_env_steps_trained_throughput_per_sec": 17.18526492875498, "timesteps_total": 315336, "num_env_steps_sampled_lifetime": 315336, "num_agent_steps_sampled_lifetime": 315336, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 315336, "timers": {"training_iteration_time_ms": 30887.123, "restore_workers_time_ms": 0.021, "training_step_time_ms": 30887.055, "sample_time_ms": 30067.851, "load_time_ms": 1.264, "load_throughput": 408222.734, "learn_time_ms": 803.72, "learn_throughput": 642.014, "synch_weights_time_ms": 13.862}, "counters": {"num_env_steps_sampled": 315336, "num_env_steps_trained": 315336, "num_agent_steps_sampled": 315336, "num_agent_steps_trained": 315336}, "done": false, "episodes_total": 6401, "training_iteration": 295, "trial_id": "fd033_00000", "date": "2024-06-11_15-37-07", "timestamp": 1718141827, "time_this_iter_s": 30.0290105342865, "time_total_s": 21517.08043026924, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 92.67136979103088, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 50.17441860465115, "ram_util_percent": 13.616279069767444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.18078383034465886, "cur_lr": 5e-06, "total_loss": 0.8069294100006421, "policy_loss": -0.004984059297324469, "vf_loss": 0.8106095393498739, "vf_explained_var": 0.1931165670355161, "kl": 0.00721264674454491, "entropy": -1.819929055372874, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 315852, "num_env_steps_trained": 315852, "num_agent_steps_sampled": 315852, "num_agent_steps_trained": 315852}, "sampler_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 306.1879914486725, "episode_reward_mean": 355.07078946751676, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.275523617601442, "mean_inference_ms": 1.306526066941846, "mean_action_processing_ms": 0.2154507376635138, "mean_env_wait_ms": 312.9137634100575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014032920201619467, "StateBufferConnector_ms": 0.006444586647881402, "ViewRequirementAgentConnector_ms": 0.17906559838189018}, "num_episodes": 6, "episode_return_max": 382.5117554668941, "episode_return_min": 306.1879914486725, "episode_return_mean": 355.07078946751676}, "env_runner_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 306.1879914486725, "episode_reward_mean": 355.07078946751676, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.275523617601442, "mean_inference_ms": 1.306526066941846, "mean_action_processing_ms": 0.2154507376635138, "mean_env_wait_ms": 312.9137634100575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014032920201619467, "StateBufferConnector_ms": 0.006444586647881402, "ViewRequirementAgentConnector_ms": 0.17906559838189018}, "num_episodes": 6, "episode_return_max": 382.5117554668941, "episode_return_min": 306.1879914486725, "episode_return_mean": 355.07078946751676}, "episode_reward_max": 382.5117554668941, "episode_reward_min": 306.1879914486725, "episode_reward_mean": 355.07078946751676, "episode_len_mean": 50.0, "episodes_this_iter": 6, "episodes_timesteps_total": 1800, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.275523617601442, "mean_inference_ms": 1.306526066941846, "mean_action_processing_ms": 0.2154507376635138, "mean_env_wait_ms": 312.9137634100575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014032920201619467, "StateBufferConnector_ms": 0.006444586647881402, "ViewRequirementAgentConnector_ms": 0.17906559838189018}, "num_episodes": 6, "episode_return_max": 382.5117554668941, "episode_return_min": 306.1879914486725, "episode_return_mean": 355.07078946751676, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315852, "num_agent_steps_trained": 315852, "num_env_steps_sampled": 315852, "num_env_steps_trained": 315852, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.264839750844994, "num_env_steps_trained_throughput_per_sec": 13.264839750844994, "timesteps_total": 315852, "num_env_steps_sampled_lifetime": 315852, "num_agent_steps_sampled_lifetime": 315852, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 315852, "timers": {"training_iteration_time_ms": 32890.303, "restore_workers_time_ms": 0.021, "training_step_time_ms": 32890.234, "sample_time_ms": 32083.76, "load_time_ms": 1.227, "load_throughput": 420591.918, "learn_time_ms": 791.054, "learn_throughput": 652.294, "synch_weights_time_ms": 13.862}, "counters": {"num_env_steps_sampled": 315852, "num_env_steps_trained": 315852, "num_agent_steps_sampled": 315852, "num_agent_steps_trained": 315852}, "done": false, "episodes_total": 6407, "training_iteration": 296, "trial_id": "fd033_00000", "date": "2024-06-11_15-37-46", "timestamp": 1718141866, "time_this_iter_s": 38.90312314033508, "time_total_s": 21555.983553409576, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 131.57449293136597, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.61636363636364, "ram_util_percent": 13.714545454545451}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.18078383034465886, "cur_lr": 5e-06, "total_loss": 0.7657623109718164, "policy_loss": -0.007705780149747928, "vf_loss": 0.7731631219387054, "vf_explained_var": 0.674694332977136, "kl": 0.0016869202634562717, "entropy": -1.693797160188357, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 316368, "num_env_steps_trained": 316368, "num_agent_steps_sampled": 316368, "num_agent_steps_trained": 316368}, "sampler_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 351.1473197889929, "episode_len_mean": 49.51020408163265, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 2426, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.374414929879926, "mean_inference_ms": 1.3067259895835397, "mean_action_processing_ms": 0.21536926299312936, "mean_env_wait_ms": 317.7493016603562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013959164522132096, "StateBufferConnector_ms": 0.006476713686573262, "ViewRequirementAgentConnector_ms": 0.18008193191216917}, "num_episodes": 13, "episode_return_max": 382.5117554668941, "episode_return_min": 124.05234419786365, "episode_return_mean": 351.1473197889929}, "env_runner_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 351.1473197889929, "episode_len_mean": 49.51020408163265, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 2426, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.374414929879926, "mean_inference_ms": 1.3067259895835397, "mean_action_processing_ms": 0.21536926299312936, "mean_env_wait_ms": 317.7493016603562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013959164522132096, "StateBufferConnector_ms": 0.006476713686573262, "ViewRequirementAgentConnector_ms": 0.18008193191216917}, "num_episodes": 13, "episode_return_max": 382.5117554668941, "episode_return_min": 124.05234419786365, "episode_return_mean": 351.1473197889929}, "episode_reward_max": 382.5117554668941, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 351.1473197889929, "episode_len_mean": 49.51020408163265, "episodes_this_iter": 13, "episodes_timesteps_total": 2426, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.374414929879926, "mean_inference_ms": 1.3067259895835397, "mean_action_processing_ms": 0.21536926299312936, "mean_env_wait_ms": 317.7493016603562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013959164522132096, "StateBufferConnector_ms": 0.006476713686573262, "ViewRequirementAgentConnector_ms": 0.18008193191216917}, "num_episodes": 13, "episode_return_max": 382.5117554668941, "episode_return_min": 124.05234419786365, "episode_return_mean": 351.1473197889929, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316368, "num_agent_steps_trained": 316368, "num_env_steps_sampled": 316368, "num_env_steps_trained": 316368, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 16.634461884988006, "num_env_steps_trained_throughput_per_sec": 16.634461884988006, "timesteps_total": 316368, "num_env_steps_sampled_lifetime": 316368, "num_agent_steps_sampled_lifetime": 316368, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 316368, "timers": {"training_iteration_time_ms": 32516.234, "restore_workers_time_ms": 0.022, "training_step_time_ms": 32516.165, "sample_time_ms": 31714.279, "load_time_ms": 1.207, "load_throughput": 427618.127, "learn_time_ms": 786.515, "learn_throughput": 656.058, "synch_weights_time_ms": 13.839}, "counters": {"num_env_steps_sampled": 316368, "num_env_steps_trained": 316368, "num_agent_steps_sampled": 316368, "num_agent_steps_trained": 316368}, "done": false, "episodes_total": 6420, "training_iteration": 297, "trial_id": "fd033_00000", "date": "2024-06-11_15-38-17", "timestamp": 1718141897, "time_this_iter_s": 31.023218393325806, "time_total_s": 21587.006771802902, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 162.59771132469177, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 49.635555555555555, "ram_util_percent": 13.80444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09039191517232943, "cur_lr": 5e-06, "total_loss": 0.7335544201234977, "policy_loss": -0.01891435569462677, "vf_loss": 0.7511493662993113, "vf_explained_var": 0.4664568230509758, "kl": 0.014596546719926044, "entropy": -1.890422801176707, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 316884, "num_env_steps_trained": 316884, "num_agent_steps_sampled": 316884, "num_agent_steps_trained": 316884}, "sampler_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 351.99042039829885, "episode_len_mean": 49.6, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2976, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.433485714364325, "mean_inference_ms": 1.3060387032355185, "mean_action_processing_ms": 0.21517991540759648, "mean_env_wait_ms": 320.2836967942311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013803243637084961, "StateBufferConnector_ms": 0.0063737233479817705, "ViewRequirementAgentConnector_ms": 0.17818411191304526}, "num_episodes": 11, "episode_return_max": 382.5117554668941, "episode_return_min": 124.05234419786365, "episode_return_mean": 351.99042039829885}, "env_runner_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 351.99042039829885, "episode_len_mean": 49.6, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 2976, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.433485714364325, "mean_inference_ms": 1.3060387032355185, "mean_action_processing_ms": 0.21517991540759648, "mean_env_wait_ms": 320.2836967942311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013803243637084961, "StateBufferConnector_ms": 0.0063737233479817705, "ViewRequirementAgentConnector_ms": 0.17818411191304526}, "num_episodes": 11, "episode_return_max": 382.5117554668941, "episode_return_min": 124.05234419786365, "episode_return_mean": 351.99042039829885}, "episode_reward_max": 382.5117554668941, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 351.99042039829885, "episode_len_mean": 49.6, "episodes_this_iter": 11, "episodes_timesteps_total": 2976, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.433485714364325, "mean_inference_ms": 1.3060387032355185, "mean_action_processing_ms": 0.21517991540759648, "mean_env_wait_ms": 320.2836967942311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013803243637084961, "StateBufferConnector_ms": 0.0063737233479817705, "ViewRequirementAgentConnector_ms": 0.17818411191304526}, "num_episodes": 11, "episode_return_max": 382.5117554668941, "episode_return_min": 124.05234419786365, "episode_return_mean": 351.99042039829885, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316884, "num_agent_steps_trained": 316884, "num_env_steps_sampled": 316884, "num_env_steps_trained": 316884, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.638580942511826, "num_env_steps_trained_throughput_per_sec": 14.638580942511826, "timesteps_total": 316884, "num_env_steps_sampled_lifetime": 316884, "num_agent_steps_sampled_lifetime": 316884, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 316884, "timers": {"training_iteration_time_ms": 32971.75, "restore_workers_time_ms": 0.022, "training_step_time_ms": 32971.684, "sample_time_ms": 32173.977, "load_time_ms": 1.204, "load_throughput": 428736.304, "learn_time_ms": 782.367, "learn_throughput": 659.537, "synch_weights_time_ms": 13.827}, "counters": {"num_env_steps_sampled": 316884, "num_env_steps_trained": 316884, "num_agent_steps_sampled": 316884, "num_agent_steps_trained": 316884}, "done": false, "episodes_total": 6431, "training_iteration": 298, "trial_id": "fd033_00000", "date": "2024-06-11_15-38-53", "timestamp": 1718141933, "time_this_iter_s": 35.252912759780884, "time_total_s": 21622.259684562683, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 197.85062408447266, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.012, "ram_util_percent": 13.404000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09039191517232943, "cur_lr": 5e-06, "total_loss": 0.6684315608814358, "policy_loss": 0.011855180670196811, "vf_loss": 0.645666899283727, "vf_explained_var": 0.5057154253125191, "kl": 0.12069089516201832, "entropy": -1.9066849768161773, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 317400, "num_env_steps_trained": 317400, "num_agent_steps_sampled": 317400, "num_agent_steps_trained": 317400}, "sampler_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 353.0103370928698, "episode_len_mean": 49.666666666666664, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3576, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.494269343273598, "mean_inference_ms": 1.3056706886933578, "mean_action_processing_ms": 0.21505022322030654, "mean_env_wait_ms": 323.1518425195157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013224946127997505, "StateBufferConnector_ms": 0.0063882933722602, "ViewRequirementAgentConnector_ms": 0.178464584880405}, "num_episodes": 12, "episode_return_max": 382.5117554668941, "episode_return_min": 124.05234419786365, "episode_return_mean": 353.0103370928698}, "env_runner_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 353.0103370928698, "episode_len_mean": 49.666666666666664, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 3576, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.494269343273598, "mean_inference_ms": 1.3056706886933578, "mean_action_processing_ms": 0.21505022322030654, "mean_env_wait_ms": 323.1518425195157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013224946127997505, "StateBufferConnector_ms": 0.0063882933722602, "ViewRequirementAgentConnector_ms": 0.178464584880405}, "num_episodes": 12, "episode_return_max": 382.5117554668941, "episode_return_min": 124.05234419786365, "episode_return_mean": 353.0103370928698}, "episode_reward_max": 382.5117554668941, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 353.0103370928698, "episode_len_mean": 49.666666666666664, "episodes_this_iter": 12, "episodes_timesteps_total": 3576, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.494269343273598, "mean_inference_ms": 1.3056706886933578, "mean_action_processing_ms": 0.21505022322030654, "mean_env_wait_ms": 323.1518425195157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013224946127997505, "StateBufferConnector_ms": 0.0063882933722602, "ViewRequirementAgentConnector_ms": 0.178464584880405}, "num_episodes": 12, "episode_return_max": 382.5117554668941, "episode_return_min": 124.05234419786365, "episode_return_mean": 353.0103370928698, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 317400, "num_agent_steps_trained": 317400, "num_env_steps_sampled": 317400, "num_env_steps_trained": 317400, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.084780863646248, "num_env_steps_trained_throughput_per_sec": 14.084780863646248, "timesteps_total": 317400, "num_env_steps_sampled_lifetime": 317400, "num_agent_steps_sampled_lifetime": 317400, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 317400, "timers": {"training_iteration_time_ms": 33495.115, "restore_workers_time_ms": 0.021, "training_step_time_ms": 33495.05, "sample_time_ms": 32699.963, "load_time_ms": 1.196, "load_throughput": 431287.216, "learn_time_ms": 779.66, "learn_throughput": 661.827, "synch_weights_time_ms": 13.928}, "counters": {"num_env_steps_sampled": 317400, "num_env_steps_trained": 317400, "num_agent_steps_sampled": 317400, "num_agent_steps_trained": 317400}, "done": false, "episodes_total": 6443, "training_iteration": 299, "trial_id": "fd033_00000", "date": "2024-06-11_15-39-29", "timestamp": 1718141969, "time_this_iter_s": 36.63893008232117, "time_total_s": 21658.898614645004, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 234.48955416679382, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 38.4, "ram_util_percent": 12.660377358490567}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1355878727584942, "cur_lr": 5e-06, "total_loss": 0.8745273659626643, "policy_loss": -0.013861352919290464, "vf_loss": 0.8868583778540293, "vf_explained_var": 0.7277921309073766, "kl": 0.011286678114751576, "entropy": -1.7596055110295614, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 317916, "num_env_steps_trained": 317916, "num_agent_steps_sampled": 317916, "num_agent_steps_trained": 317916}, "sampler_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 352.9572907808873, "episode_len_mean": 49.69620253164557, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 3926, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.510335920349544, "mean_inference_ms": 1.3055995904600406, "mean_action_processing_ms": 0.21501319506752778, "mean_env_wait_ms": 323.8509836654343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012943412684187104, "StateBufferConnector_ms": 0.006389617919921875, "ViewRequirementAgentConnector_ms": 0.1785643493072896}, "num_episodes": 7, "episode_return_max": 382.5117554668941, "episode_return_min": 124.05234419786365, "episode_return_mean": 352.9572907808873}, "env_runner_results": {"episode_reward_max": 382.5117554668941, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 352.9572907808873, "episode_len_mean": 49.69620253164557, "episode_media": {}, "episodes_this_iter": 7, "episodes_timesteps_total": 3926, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.510335920349544, "mean_inference_ms": 1.3055995904600406, "mean_action_processing_ms": 0.21501319506752778, "mean_env_wait_ms": 323.8509836654343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012943412684187104, "StateBufferConnector_ms": 0.006389617919921875, "ViewRequirementAgentConnector_ms": 0.1785643493072896}, "num_episodes": 7, "episode_return_max": 382.5117554668941, "episode_return_min": 124.05234419786365, "episode_return_mean": 352.9572907808873}, "episode_reward_max": 382.5117554668941, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 352.9572907808873, "episode_len_mean": 49.69620253164557, "episodes_this_iter": 7, "episodes_timesteps_total": 3926, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.510335920349544, "mean_inference_ms": 1.3055995904600406, "mean_action_processing_ms": 0.21501319506752778, "mean_env_wait_ms": 323.8509836654343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012943412684187104, "StateBufferConnector_ms": 0.006389617919921875, "ViewRequirementAgentConnector_ms": 0.1785643493072896}, "num_episodes": 7, "episode_return_max": 382.5117554668941, "episode_return_min": 124.05234419786365, "episode_return_mean": 352.9572907808873, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 317916, "num_agent_steps_trained": 317916, "num_env_steps_sampled": 317916, "num_env_steps_trained": 317916, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 17.777214787325576, "num_env_steps_trained_throughput_per_sec": 17.777214787325576, "timesteps_total": 317916, "num_env_steps_sampled_lifetime": 317916, "num_agent_steps_sampled_lifetime": 317916, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 317916, "timers": {"training_iteration_time_ms": 32936.468, "restore_workers_time_ms": 0.022, "training_step_time_ms": 32936.403, "sample_time_ms": 32141.938, "load_time_ms": 1.18, "load_throughput": 437279.629, "learn_time_ms": 779.103, "learn_throughput": 662.3, "synch_weights_time_ms": 13.887}, "counters": {"num_env_steps_sampled": 317916, "num_env_steps_trained": 317916, "num_agent_steps_sampled": 317916, "num_agent_steps_trained": 317916}, "done": false, "episodes_total": 6450, "training_iteration": 300, "trial_id": "fd033_00000", "date": "2024-06-11_15-39-58", "timestamp": 1718141998, "time_this_iter_s": 29.029622316360474, "time_total_s": 21687.928236961365, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 263.5191764831543, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 52.09024390243902, "ram_util_percent": 13.76341463414634}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1355878727584942, "cur_lr": 5e-06, "total_loss": 0.8300720346470674, "policy_loss": -0.01417359293748935, "vf_loss": 0.8424772207935651, "vf_explained_var": 0.7247637063264847, "kl": 0.01304251034453135, "entropy": -1.786838987469673, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 318432, "num_env_steps_trained": 318432, "num_agent_steps_sampled": 318432, "num_agent_steps_trained": 318432}, "sampler_results": {"episode_reward_max": 383.3850708007815, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 352.646228026023, "episode_len_mean": 49.733333333333334, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4476, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.531815986613567, "mean_inference_ms": 1.3051037259293596, "mean_action_processing_ms": 0.21487198375039893, "mean_env_wait_ms": 325.18074704189706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012565188937717013, "StateBufferConnector_ms": 0.006372133890787761, "ViewRequirementAgentConnector_ms": 0.17873684565226236}, "num_episodes": 11, "episode_return_max": 383.3850708007815, "episode_return_min": 124.05234419786365, "episode_return_mean": 352.646228026023}, "env_runner_results": {"episode_reward_max": 383.3850708007815, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 352.646228026023, "episode_len_mean": 49.733333333333334, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 4476, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.531815986613567, "mean_inference_ms": 1.3051037259293596, "mean_action_processing_ms": 0.21487198375039893, "mean_env_wait_ms": 325.18074704189706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012565188937717013, "StateBufferConnector_ms": 0.006372133890787761, "ViewRequirementAgentConnector_ms": 0.17873684565226236}, "num_episodes": 11, "episode_return_max": 383.3850708007815, "episode_return_min": 124.05234419786365, "episode_return_mean": 352.646228026023}, "episode_reward_max": 383.3850708007815, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 352.646228026023, "episode_len_mean": 49.733333333333334, "episodes_this_iter": 11, "episodes_timesteps_total": 4476, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.89806885141047, 331.7931012574107, 355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.531815986613567, "mean_inference_ms": 1.3051037259293596, "mean_action_processing_ms": 0.21487198375039893, "mean_env_wait_ms": 325.18074704189706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012565188937717013, "StateBufferConnector_ms": 0.006372133890787761, "ViewRequirementAgentConnector_ms": 0.17873684565226236}, "num_episodes": 11, "episode_return_max": 383.3850708007815, "episode_return_min": 124.05234419786365, "episode_return_mean": 352.646228026023, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 318432, "num_agent_steps_trained": 318432, "num_env_steps_sampled": 318432, "num_env_steps_trained": 318432, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 14.140031876048525, "num_env_steps_trained_throughput_per_sec": 14.140031876048525, "timesteps_total": 318432, "num_env_steps_sampled_lifetime": 318432, "num_agent_steps_sampled_lifetime": 318432, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 318432, "timers": {"training_iteration_time_ms": 33331.544, "restore_workers_time_ms": 0.021, "training_step_time_ms": 33331.481, "sample_time_ms": 32539.322, "load_time_ms": 1.177, "load_throughput": 438365.841, "learn_time_ms": 776.822, "learn_throughput": 664.245, "synch_weights_time_ms": 13.87}, "counters": {"num_env_steps_sampled": 318432, "num_env_steps_trained": 318432, "num_agent_steps_sampled": 318432, "num_agent_steps_trained": 318432}, "done": false, "episodes_total": 6461, "training_iteration": 301, "trial_id": "fd033_00000", "date": "2024-06-11_15-40-35", "timestamp": 1718142035, "time_this_iter_s": 36.495747566223145, "time_total_s": 21724.423984527588, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 300.01492404937744, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 41.142307692307696, "ram_util_percent": 13.907692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1355878727584942, "cur_lr": 5e-06, "total_loss": 0.7462832942605019, "policy_loss": -0.012573031972472866, "vf_loss": 0.7543776378035545, "vf_explained_var": 0.3933934956789017, "kl": 0.03303161245081962, "entropy": -1.9010829697052638, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 318948, "num_env_steps_trained": 318948, "num_agent_steps_sampled": 318948, "num_agent_steps_trained": 318948}, "sampler_results": {"episode_reward_max": 383.3850708007815, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 353.1760513579596, "episode_len_mean": 49.76, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4976, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5836977685988085, "mean_inference_ms": 1.304792522703289, "mean_action_processing_ms": 0.21478640224914847, "mean_env_wait_ms": 326.81413707999025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012331247329711914, "StateBufferConnector_ms": 0.006341457366943359, "ViewRequirementAgentConnector_ms": 0.1786940097808838}, "num_episodes": 12, "episode_return_max": 383.3850708007815, "episode_return_min": 124.05234419786365, "episode_return_mean": 353.1760513579596}, "env_runner_results": {"episode_reward_max": 383.3850708007815, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 353.1760513579596, "episode_len_mean": 49.76, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 4976, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5836977685988085, "mean_inference_ms": 1.304792522703289, "mean_action_processing_ms": 0.21478640224914847, "mean_env_wait_ms": 326.81413707999025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012331247329711914, "StateBufferConnector_ms": 0.006341457366943359, "ViewRequirementAgentConnector_ms": 0.1786940097808838}, "num_episodes": 12, "episode_return_max": 383.3850708007815, "episode_return_min": 124.05234419786365, "episode_return_mean": 353.1760513579596}, "episode_reward_max": 383.3850708007815, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 353.1760513579596, "episode_len_mean": 49.76, "episodes_this_iter": 12, "episodes_timesteps_total": 4976, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [355.53917454516323, 342.5110143963799, 360.75861347899473, 382.5117554668941, 340.406248801845, 357.6194438933429, 374.8903196890392, 367.94848706494537, 361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5836977685988085, "mean_inference_ms": 1.304792522703289, "mean_action_processing_ms": 0.21478640224914847, "mean_env_wait_ms": 326.81413707999025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012331247329711914, "StateBufferConnector_ms": 0.006341457366943359, "ViewRequirementAgentConnector_ms": 0.1786940097808838}, "num_episodes": 12, "episode_return_max": 383.3850708007815, "episode_return_min": 124.05234419786365, "episode_return_mean": 353.1760513579596, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 318948, "num_agent_steps_trained": 318948, "num_env_steps_sampled": 318948, "num_env_steps_trained": 318948, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 17.60670657218103, "num_env_steps_trained_throughput_per_sec": 17.60670657218103, "timesteps_total": 318948, "num_env_steps_sampled_lifetime": 318948, "num_agent_steps_sampled_lifetime": 318948, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 318948, "timers": {"training_iteration_time_ms": 32929.092, "restore_workers_time_ms": 0.021, "training_step_time_ms": 32929.031, "sample_time_ms": 32139.401, "load_time_ms": 1.171, "load_throughput": 440696.572, "learn_time_ms": 774.325, "learn_throughput": 666.387, "synch_weights_time_ms": 13.849}, "counters": {"num_env_steps_sampled": 318948, "num_env_steps_trained": 318948, "num_agent_steps_sampled": 318948, "num_agent_steps_trained": 318948}, "done": false, "episodes_total": 6473, "training_iteration": 302, "trial_id": "fd033_00000", "date": "2024-06-11_15-41-04", "timestamp": 1718142064, "time_this_iter_s": 29.310782432556152, "time_total_s": 21753.734766960144, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 329.3257064819336, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 51.09761904761905, "ram_util_percent": 14.00952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20338180913774123, "cur_lr": 5e-06, "total_loss": 1.4299798717101415, "policy_loss": -0.013038025951633852, "vf_loss": 1.4418914516766865, "vf_explained_var": 0.3565841550628344, "kl": 0.005538590627111262, "entropy": -1.4510243733723958, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 319464, "num_env_steps_trained": 319464, "num_agent_steps_sampled": 319464, "num_agent_steps_trained": 319464}, "sampler_results": {"episode_reward_max": 383.3850708007815, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 348.4919558450308, "episode_len_mean": 49.53, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 4953, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.656658124579682, "mean_inference_ms": 1.3045248497296549, "mean_action_processing_ms": 0.214767474829588, "mean_env_wait_ms": 329.6577115878903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012144088745117188, "StateBufferConnector_ms": 0.006323337554931641, "ViewRequirementAgentConnector_ms": 0.17847061157226562}, "num_episodes": 8, "episode_return_max": 383.3850708007815, "episode_return_min": 124.05234419786365, "episode_return_mean": 348.4919558450308}, "env_runner_results": {"episode_reward_max": 383.3850708007815, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 348.4919558450308, "episode_len_mean": 49.53, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 4953, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.656658124579682, "mean_inference_ms": 1.3045248497296549, "mean_action_processing_ms": 0.214767474829588, "mean_env_wait_ms": 329.6577115878903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012144088745117188, "StateBufferConnector_ms": 0.006323337554931641, "ViewRequirementAgentConnector_ms": 0.17847061157226562}, "num_episodes": 8, "episode_return_max": 383.3850708007815, "episode_return_min": 124.05234419786365, "episode_return_mean": 348.4919558450308}, "episode_reward_max": 383.3850708007815, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 348.4919558450308, "episode_len_mean": 49.53, "episodes_this_iter": 8, "episodes_timesteps_total": 4953, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [361.9338957376065, 344.1416435177268, 372.0462843081458, 366.4996122322607, 350.11480842222005, 371.3932175136373, 357.84142355488746, 362.94380531881524, 343.7633113346046, 366.039169735304, 378.9427532121737, 328.0004280586857, 340.062737909082, 306.1879914486725, 328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.656658124579682, "mean_inference_ms": 1.3045248497296549, "mean_action_processing_ms": 0.214767474829588, "mean_env_wait_ms": 329.6577115878903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012144088745117188, "StateBufferConnector_ms": 0.006323337554931641, "ViewRequirementAgentConnector_ms": 0.17847061157226562}, "num_episodes": 8, "episode_return_max": 383.3850708007815, "episode_return_min": 124.05234419786365, "episode_return_mean": 348.4919558450308, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 319464, "num_agent_steps_trained": 319464, "num_env_steps_sampled": 319464, "num_env_steps_trained": 319464, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.942146088555301, "num_env_steps_trained_throughput_per_sec": 13.942146088555301, "timesteps_total": 319464, "num_env_steps_sampled_lifetime": 319464, "num_agent_steps_sampled_lifetime": 319464, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 319464, "timers": {"training_iteration_time_ms": 33912.279, "restore_workers_time_ms": 0.02, "training_step_time_ms": 33912.22, "sample_time_ms": 33137.087, "load_time_ms": 1.118, "load_throughput": 461728.685, "learn_time_ms": 759.93, "learn_throughput": 679.01, "synch_weights_time_ms": 13.832}, "counters": {"num_env_steps_sampled": 319464, "num_env_steps_trained": 319464, "num_agent_steps_sampled": 319464, "num_agent_steps_trained": 319464}, "done": false, "episodes_total": 6481, "training_iteration": 303, "trial_id": "fd033_00000", "date": "2024-06-11_15-41-41", "timestamp": 1718142101, "time_this_iter_s": 37.01382613182068, "time_total_s": 21790.748593091965, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 366.3395326137543, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 41.79433962264151, "ram_util_percent": 14.094339622641511}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20338180913774123, "cur_lr": 5e-06, "total_loss": 1.4482340807716052, "policy_loss": -0.014507547641793886, "vf_loss": 1.4620548630754153, "vf_explained_var": 0.36980120092630386, "kl": 0.00337676449953601, "entropy": -1.3416122515996298, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 319980, "num_env_steps_trained": 319980, "num_agent_steps_sampled": 319980, "num_agent_steps_trained": 319980}, "sampler_results": {"episode_reward_max": 383.3850708007815, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 340.96883287920906, "episode_len_mean": 48.86, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 4886, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6987098457218215, "mean_inference_ms": 1.3039348472271053, "mean_action_processing_ms": 0.2144920201943627, "mean_env_wait_ms": 331.67992732142324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011620044708251953, "StateBufferConnector_ms": 0.006278514862060547, "ViewRequirementAgentConnector_ms": 0.17855548858642578}, "num_episodes": 14, "episode_return_max": 383.3850708007815, "episode_return_min": 124.05234419786365, "episode_return_mean": 340.96883287920906}, "env_runner_results": {"episode_reward_max": 383.3850708007815, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 340.96883287920906, "episode_len_mean": 48.86, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 4886, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6987098457218215, "mean_inference_ms": 1.3039348472271053, "mean_action_processing_ms": 0.2144920201943627, "mean_env_wait_ms": 331.67992732142324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011620044708251953, "StateBufferConnector_ms": 0.006278514862060547, "ViewRequirementAgentConnector_ms": 0.17855548858642578}, "num_episodes": 14, "episode_return_max": 383.3850708007815, "episode_return_min": 124.05234419786365, "episode_return_mean": 340.96883287920906}, "episode_reward_max": 383.3850708007815, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 340.96883287920906, "episode_len_mean": 48.86, "episodes_this_iter": 14, "episodes_timesteps_total": 4886, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [328.81369822888996, 360.7798104964645, 358.04723405507644, 369.99425437629543, 364.1789058546096, 348.2985870200678, 374.25076716636676, 337.53490575114563, 364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6987098457218215, "mean_inference_ms": 1.3039348472271053, "mean_action_processing_ms": 0.2144920201943627, "mean_env_wait_ms": 331.67992732142324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011620044708251953, "StateBufferConnector_ms": 0.006278514862060547, "ViewRequirementAgentConnector_ms": 0.17855548858642578}, "num_episodes": 14, "episode_return_max": 383.3850708007815, "episode_return_min": 124.05234419786365, "episode_return_mean": 340.96883287920906, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 319980, "num_agent_steps_trained": 319980, "num_env_steps_sampled": 319980, "num_env_steps_trained": 319980, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 16.96331633556302, "num_env_steps_trained_throughput_per_sec": 16.96331633556302, "timesteps_total": 319980, "num_env_steps_sampled_lifetime": 319980, "num_agent_steps_sampled_lifetime": 319980, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 319980, "timers": {"training_iteration_time_ms": 33408.398, "restore_workers_time_ms": 0.019, "training_step_time_ms": 33408.342, "sample_time_ms": 32634.977, "load_time_ms": 1.105, "load_throughput": 466767.499, "learn_time_ms": 758.184, "learn_throughput": 680.574, "synch_weights_time_ms": 13.826}, "counters": {"num_env_steps_sampled": 319980, "num_env_steps_trained": 319980, "num_agent_steps_sampled": 319980, "num_agent_steps_trained": 319980}, "done": false, "episodes_total": 6495, "training_iteration": 304, "trial_id": "fd033_00000", "date": "2024-06-11_15-42-12", "timestamp": 1718142132, "time_this_iter_s": 30.422486305236816, "time_total_s": 21821.1710793972, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 396.7620189189911, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 50.41395348837211, "ram_util_percent": 14.172093023255815}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10169090456887062, "cur_lr": 5e-06, "total_loss": 0.8952671685566505, "policy_loss": -0.020591616195937, "vf_loss": 0.9145738263924916, "vf_explained_var": 0.302069387336572, "kl": 0.012635940772453235, "entropy": -1.8453726748625436, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 320496, "num_env_steps_trained": 320496, "num_agent_steps_sampled": 320496, "num_agent_steps_trained": 320496}, "sampler_results": {"episode_reward_max": 384.34083251953143, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 341.4880631376236, "episode_len_mean": 48.86, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 4886, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629, 332.29325022930396, 315.2192613052283, 379.1225545704578, 364.40574352513636, 375.03040429413227, 368.3651970340791, 384.34083251953143, 375.0439453125007], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.709300818002797, "mean_inference_ms": 1.3036376983670315, "mean_action_processing_ms": 0.2143471036964424, "mean_env_wait_ms": 333.0574750952791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011365413665771484, "StateBufferConnector_ms": 0.006305694580078125, "ViewRequirementAgentConnector_ms": 0.17919135093688965}, "num_episodes": 8, "episode_return_max": 384.34083251953143, "episode_return_min": 124.05234419786365, "episode_return_mean": 341.4880631376236}, "env_runner_results": {"episode_reward_max": 384.34083251953143, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 341.4880631376236, "episode_len_mean": 48.86, "episode_media": {}, "episodes_this_iter": 8, "episodes_timesteps_total": 4886, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629, 332.29325022930396, 315.2192613052283, 379.1225545704578, 364.40574352513636, 375.03040429413227, 368.3651970340791, 384.34083251953143, 375.0439453125007], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.709300818002797, "mean_inference_ms": 1.3036376983670315, "mean_action_processing_ms": 0.2143471036964424, "mean_env_wait_ms": 333.0574750952791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011365413665771484, "StateBufferConnector_ms": 0.006305694580078125, "ViewRequirementAgentConnector_ms": 0.17919135093688965}, "num_episodes": 8, "episode_return_max": 384.34083251953143, "episode_return_min": 124.05234419786365, "episode_return_mean": 341.4880631376236}, "episode_reward_max": 384.34083251953143, "episode_reward_min": 124.05234419786365, "episode_reward_mean": 341.4880631376236, "episode_len_mean": 48.86, "episodes_this_iter": 8, "episodes_timesteps_total": 4886, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [364.2997893755966, 358.90107585915786, 370.7742514576184, 315.8878314400657, 379.36815739462105, 371.5050518747716, 377.3153198812627, 358.68983613906784, 342.0118503854413, 124.05234419786365, 340.6279882862091, 354.54382282252664, 340.16056836522324, 349.31354084885766, 376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629, 332.29325022930396, 315.2192613052283, 379.1225545704578, 364.40574352513636, 375.03040429413227, 368.3651970340791, 384.34083251953143, 375.0439453125007], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.709300818002797, "mean_inference_ms": 1.3036376983670315, "mean_action_processing_ms": 0.2143471036964424, "mean_env_wait_ms": 333.0574750952791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011365413665771484, "StateBufferConnector_ms": 0.006305694580078125, "ViewRequirementAgentConnector_ms": 0.17919135093688965}, "num_episodes": 8, "episode_return_max": 384.34083251953143, "episode_return_min": 124.05234419786365, "episode_return_mean": 341.4880631376236, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320496, "num_agent_steps_trained": 320496, "num_env_steps_sampled": 320496, "num_env_steps_trained": 320496, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.09933294300735, "num_env_steps_trained_throughput_per_sec": 13.09933294300735, "timesteps_total": 320496, "num_env_steps_sampled_lifetime": 320496, "num_agent_steps_sampled_lifetime": 320496, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 320496, "timers": {"training_iteration_time_ms": 34344.958, "restore_workers_time_ms": 0.019, "training_step_time_ms": 34344.903, "sample_time_ms": 33562.291, "load_time_ms": 1.338, "load_throughput": 385793.127, "learn_time_ms": 767.267, "learn_throughput": 672.517, "synch_weights_time_ms": 13.762}, "counters": {"num_env_steps_sampled": 320496, "num_env_steps_trained": 320496, "num_agent_steps_sampled": 320496, "num_agent_steps_trained": 320496}, "done": false, "episodes_total": 6503, "training_iteration": 305, "trial_id": "fd033_00000", "date": "2024-06-11_15-42-51", "timestamp": 1718142171, "time_this_iter_s": 39.3947114944458, "time_total_s": 21860.565790891647, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 436.1567304134369, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 38.64385964912281, "ram_util_percent": 14.233333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10169090456887062, "cur_lr": 5e-06, "total_loss": 1.212998399635156, "policy_loss": -0.006960562771807114, "vf_loss": 1.2195196067293486, "vf_explained_var": 0.5310584435860316, "kl": 0.004320465856289956, "entropy": -1.6160678337017695, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 321012, "num_env_steps_trained": 321012, "num_agent_steps_sampled": 321012, "num_agent_steps_trained": 321012}, "sampler_results": {"episode_reward_max": 384.34083251953143, "episode_reward_min": 95.43839707123573, "episode_reward_mean": 337.0676566961662, "episode_len_mean": 48.51, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 4851, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629, 332.29325022930396, 315.2192613052283, 379.1225545704578, 364.40574352513636, 375.03040429413227, 368.3651970340791, 384.34083251953143, 375.0439453125007, 373.9625854492192, 308.622896934244, 354.6804312811837, 315.2426031028508, 313.97115924053986, 319.51492798128464, 95.43839707123573, 314.8390285469258, 357.64827337692384, 125.30082243917218, 347.09590712762775, 357.8117741711684, 378.6343090074505, 342.6476684527116], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 22, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.743392576171134, "mean_inference_ms": 1.303055589440167, "mean_action_processing_ms": 0.21418978195771346, "mean_env_wait_ms": 334.177591952615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011008501052856445, "StateBufferConnector_ms": 0.006283283233642578, "ViewRequirementAgentConnector_ms": 0.17909002304077148}, "num_episodes": 14, "episode_return_max": 384.34083251953143, "episode_return_min": 95.43839707123573, "episode_return_mean": 337.0676566961662}, "env_runner_results": {"episode_reward_max": 384.34083251953143, "episode_reward_min": 95.43839707123573, "episode_reward_mean": 337.0676566961662, "episode_len_mean": 48.51, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 4851, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629, 332.29325022930396, 315.2192613052283, 379.1225545704578, 364.40574352513636, 375.03040429413227, 368.3651970340791, 384.34083251953143, 375.0439453125007, 373.9625854492192, 308.622896934244, 354.6804312811837, 315.2426031028508, 313.97115924053986, 319.51492798128464, 95.43839707123573, 314.8390285469258, 357.64827337692384, 125.30082243917218, 347.09590712762775, 357.8117741711684, 378.6343090074505, 342.6476684527116], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 22, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.743392576171134, "mean_inference_ms": 1.303055589440167, "mean_action_processing_ms": 0.21418978195771346, "mean_env_wait_ms": 334.177591952615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011008501052856445, "StateBufferConnector_ms": 0.006283283233642578, "ViewRequirementAgentConnector_ms": 0.17909002304077148}, "num_episodes": 14, "episode_return_max": 384.34083251953143, "episode_return_min": 95.43839707123573, "episode_return_mean": 337.0676566961662}, "episode_reward_max": 384.34083251953143, "episode_reward_min": 95.43839707123573, "episode_reward_mean": 337.0676566961662, "episode_len_mean": 48.51, "episodes_this_iter": 14, "episodes_timesteps_total": 4851, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [376.9181168936837, 347.6338461068393, 361.52980563368476, 366.7675110132781, 369.42569678173044, 356.51807855883584, 302.25375606440593, 358.1160832431189, 358.27593322208094, 366.17349045788944, 361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629, 332.29325022930396, 315.2192613052283, 379.1225545704578, 364.40574352513636, 375.03040429413227, 368.3651970340791, 384.34083251953143, 375.0439453125007, 373.9625854492192, 308.622896934244, 354.6804312811837, 315.2426031028508, 313.97115924053986, 319.51492798128464, 95.43839707123573, 314.8390285469258, 357.64827337692384, 125.30082243917218, 347.09590712762775, 357.8117741711684, 378.6343090074505, 342.6476684527116], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 22, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.743392576171134, "mean_inference_ms": 1.303055589440167, "mean_action_processing_ms": 0.21418978195771346, "mean_env_wait_ms": 334.177591952615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011008501052856445, "StateBufferConnector_ms": 0.006283283233642578, "ViewRequirementAgentConnector_ms": 0.17909002304077148}, "num_episodes": 14, "episode_return_max": 384.34083251953143, "episode_return_min": 95.43839707123573, "episode_return_mean": 337.0676566961662, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 321012, "num_agent_steps_trained": 321012, "num_env_steps_sampled": 321012, "num_env_steps_trained": 321012, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.096572518460825, "num_env_steps_trained_throughput_per_sec": 13.096572518460825, "timesteps_total": 321012, "num_env_steps_sampled_lifetime": 321012, "num_agent_steps_sampled_lifetime": 321012, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 321012, "timers": {"training_iteration_time_ms": 34394.936, "restore_workers_time_ms": 0.018, "training_step_time_ms": 34394.885, "sample_time_ms": 33613.985, "load_time_ms": 1.331, "load_throughput": 387533.952, "learn_time_ms": 765.604, "learn_throughput": 673.977, "synch_weights_time_ms": 13.721}, "counters": {"num_env_steps_sampled": 321012, "num_env_steps_trained": 321012, "num_agent_steps_sampled": 321012, "num_agent_steps_trained": 321012}, "done": false, "episodes_total": 6517, "training_iteration": 306, "trial_id": "fd033_00000", "date": "2024-06-11_15-43-30", "timestamp": 1718142210, "time_this_iter_s": 39.403398513793945, "time_total_s": 21899.96918940544, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 475.56012892723083, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 39.841071428571425, "ram_util_percent": 14.337500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05084545228443531, "cur_lr": 5e-06, "total_loss": 0.6420255447427432, "policy_loss": -0.008554189186543226, "vf_loss": 0.6503488148252169, "vf_explained_var": 0.4314880649248759, "kl": 0.004541571739597809, "entropy": -2.0017922828594843, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 321528, "num_env_steps_trained": 321528, "num_agent_steps_sampled": 321528, "num_agent_steps_trained": 321528}, "sampler_results": {"episode_reward_max": 384.34083251953143, "episode_reward_min": 95.43839707123573, "episode_reward_mean": 336.28173872799226, "episode_len_mean": 48.33, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4833, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629, 332.29325022930396, 315.2192613052283, 379.1225545704578, 364.40574352513636, 375.03040429413227, 368.3651970340791, 384.34083251953143, 375.0439453125007, 373.9625854492192, 308.622896934244, 354.6804312811837, 315.2426031028508, 313.97115924053986, 319.51492798128464, 95.43839707123573, 314.8390285469258, 357.64827337692384, 125.30082243917218, 347.09590712762775, 357.8117741711684, 378.6343090074505, 342.6476684527116, 367.28810762087585, 361.9587690858039, 379.94776294893865, 359.72289146335476, 360.8966120025557, 180.06925884855696, 374.2108164299532, 347.5857735966584, 380.48386504917266, 372.8566641122906], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.759515899948086, "mean_inference_ms": 1.3027983380776873, "mean_action_processing_ms": 0.21411643669331945, "mean_env_wait_ms": 334.70488919554913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010913848876953125, "StateBufferConnector_ms": 0.0063135623931884766, "ViewRequirementAgentConnector_ms": 0.18005061149597168}, "num_episodes": 10, "episode_return_max": 384.34083251953143, "episode_return_min": 95.43839707123573, "episode_return_mean": 336.28173872799226}, "env_runner_results": {"episode_reward_max": 384.34083251953143, "episode_reward_min": 95.43839707123573, "episode_reward_mean": 336.28173872799226, "episode_len_mean": 48.33, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4833, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629, 332.29325022930396, 315.2192613052283, 379.1225545704578, 364.40574352513636, 375.03040429413227, 368.3651970340791, 384.34083251953143, 375.0439453125007, 373.9625854492192, 308.622896934244, 354.6804312811837, 315.2426031028508, 313.97115924053986, 319.51492798128464, 95.43839707123573, 314.8390285469258, 357.64827337692384, 125.30082243917218, 347.09590712762775, 357.8117741711684, 378.6343090074505, 342.6476684527116, 367.28810762087585, 361.9587690858039, 379.94776294893865, 359.72289146335476, 360.8966120025557, 180.06925884855696, 374.2108164299532, 347.5857735966584, 380.48386504917266, 372.8566641122906], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.759515899948086, "mean_inference_ms": 1.3027983380776873, "mean_action_processing_ms": 0.21411643669331945, "mean_env_wait_ms": 334.70488919554913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010913848876953125, "StateBufferConnector_ms": 0.0063135623931884766, "ViewRequirementAgentConnector_ms": 0.18005061149597168}, "num_episodes": 10, "episode_return_max": 384.34083251953143, "episode_return_min": 95.43839707123573, "episode_return_mean": 336.28173872799226}, "episode_reward_max": 384.34083251953143, "episode_reward_min": 95.43839707123573, "episode_reward_mean": 336.28173872799226, "episode_len_mean": 48.33, "episodes_this_iter": 10, "episodes_timesteps_total": 4833, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [361.8893994692591, 377.5888901169307, 349.4978698012802, 346.6998455084622, 361.8009949080632, 367.7929389994381, 358.46328258037374, 372.6127615857752, 362.04553977385996, 363.7696028849224, 370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629, 332.29325022930396, 315.2192613052283, 379.1225545704578, 364.40574352513636, 375.03040429413227, 368.3651970340791, 384.34083251953143, 375.0439453125007, 373.9625854492192, 308.622896934244, 354.6804312811837, 315.2426031028508, 313.97115924053986, 319.51492798128464, 95.43839707123573, 314.8390285469258, 357.64827337692384, 125.30082243917218, 347.09590712762775, 357.8117741711684, 378.6343090074505, 342.6476684527116, 367.28810762087585, 361.9587690858039, 379.94776294893865, 359.72289146335476, 360.8966120025557, 180.06925884855696, 374.2108164299532, 347.5857735966584, 380.48386504917266, 372.8566641122906], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.759515899948086, "mean_inference_ms": 1.3027983380776873, "mean_action_processing_ms": 0.21411643669331945, "mean_env_wait_ms": 334.70488919554913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010913848876953125, "StateBufferConnector_ms": 0.0063135623931884766, "ViewRequirementAgentConnector_ms": 0.18005061149597168}, "num_episodes": 10, "episode_return_max": 384.34083251953143, "episode_return_min": 95.43839707123573, "episode_return_mean": 336.28173872799226, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 321528, "num_agent_steps_trained": 321528, "num_env_steps_sampled": 321528, "num_env_steps_trained": 321528, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 18.28504596504182, "num_env_steps_trained_throughput_per_sec": 18.28504596504182, "timesteps_total": 321528, "num_env_steps_sampled_lifetime": 321528, "num_agent_steps_sampled_lifetime": 321528, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 321528, "timers": {"training_iteration_time_ms": 34114.92, "restore_workers_time_ms": 0.018, "training_step_time_ms": 34114.871, "sample_time_ms": 33336.012, "load_time_ms": 1.33, "load_throughput": 387922.938, "learn_time_ms": 763.589, "learn_throughput": 675.756, "synch_weights_time_ms": 13.704}, "counters": {"num_env_steps_sampled": 321528, "num_env_steps_trained": 321528, "num_agent_steps_sampled": 321528, "num_agent_steps_trained": 321528}, "done": false, "episodes_total": 6527, "training_iteration": 307, "trial_id": "fd033_00000", "date": "2024-06-11_15-43-59", "timestamp": 1718142239, "time_this_iter_s": 28.22318196296692, "time_total_s": 21928.19237136841, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 503.78331089019775, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 46.6, "ram_util_percent": 12.882500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025422726142217654, "cur_lr": 5e-06, "total_loss": 0.8616667797168096, "policy_loss": 0.00660175079635034, "vf_loss": 0.8482916861772537, "vf_explained_var": 0.3643587201833725, "kl": 0.26642873403616363, "entropy": -1.850662887096405, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 322044, "num_env_steps_trained": 322044, "num_agent_steps_sampled": 322044, "num_agent_steps_trained": 322044}, "sampler_results": {"episode_reward_max": 384.43173477204385, "episode_reward_min": 95.43839707123573, "episode_reward_mean": 335.32797151672514, "episode_len_mean": 48.33, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4833, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629, 332.29325022930396, 315.2192613052283, 379.1225545704578, 364.40574352513636, 375.03040429413227, 368.3651970340791, 384.34083251953143, 375.0439453125007, 373.9625854492192, 308.622896934244, 354.6804312811837, 315.2426031028508, 313.97115924053986, 319.51492798128464, 95.43839707123573, 314.8390285469258, 357.64827337692384, 125.30082243917218, 347.09590712762775, 357.8117741711684, 378.6343090074505, 342.6476684527116, 367.28810762087585, 361.9587690858039, 379.94776294893865, 359.72289146335476, 360.8966120025557, 180.06925884855696, 374.2108164299532, 347.5857735966584, 380.48386504917266, 372.8566641122906, 384.43173477204385, 347.5292236328128, 372.0254757178961, 375.4682744693948, 328.6946367784905, 377.1093146204555, 334.352578664214, 358.88234361857906, 285.72435881051746, 362.56646341724763], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.762939275043111, "mean_inference_ms": 1.3024343139268995, "mean_action_processing_ms": 0.21414213120096676, "mean_env_wait_ms": 335.2554844648062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010935306549072266, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.1806783676147461}, "num_episodes": 10, "episode_return_max": 384.43173477204385, "episode_return_min": 95.43839707123573, "episode_return_mean": 335.32797151672514}, "env_runner_results": {"episode_reward_max": 384.43173477204385, "episode_reward_min": 95.43839707123573, "episode_reward_mean": 335.32797151672514, "episode_len_mean": 48.33, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 4833, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629, 332.29325022930396, 315.2192613052283, 379.1225545704578, 364.40574352513636, 375.03040429413227, 368.3651970340791, 384.34083251953143, 375.0439453125007, 373.9625854492192, 308.622896934244, 354.6804312811837, 315.2426031028508, 313.97115924053986, 319.51492798128464, 95.43839707123573, 314.8390285469258, 357.64827337692384, 125.30082243917218, 347.09590712762775, 357.8117741711684, 378.6343090074505, 342.6476684527116, 367.28810762087585, 361.9587690858039, 379.94776294893865, 359.72289146335476, 360.8966120025557, 180.06925884855696, 374.2108164299532, 347.5857735966584, 380.48386504917266, 372.8566641122906, 384.43173477204385, 347.5292236328128, 372.0254757178961, 375.4682744693948, 328.6946367784905, 377.1093146204555, 334.352578664214, 358.88234361857906, 285.72435881051746, 362.56646341724763], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.762939275043111, "mean_inference_ms": 1.3024343139268995, "mean_action_processing_ms": 0.21414213120096676, "mean_env_wait_ms": 335.2554844648062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010935306549072266, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.1806783676147461}, "num_episodes": 10, "episode_return_max": 384.43173477204385, "episode_return_min": 95.43839707123573, "episode_return_mean": 335.32797151672514}, "episode_reward_max": 384.43173477204385, "episode_reward_min": 95.43839707123573, "episode_reward_mean": 335.32797151672514, "episode_len_mean": 48.33, "episodes_this_iter": 10, "episodes_timesteps_total": 4833, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [370.29170856937094, 366.52373120101976, 353.8159251249203, 347.0654928526041, 351.9011139007507, 321.23595440760056, 317.1299211221991, 381.8682762802004, 332.99531354501687, 338.9077075483493, 351.31736144355375, 374.3133119917019, 370.34980907244534, 359.0376379210439, 342.93301551679815, 325.717548266291, 356.5749429853581, 367.2139403958016, 369.14261345922284, 324.56072825473814, 383.3850708007815, 332.77048662979144, 322.19921301119604, 370.99935341095284, 343.7892058963806, 382.75209619608296, 322.85304359876966, 367.0073093120133, 345.2757953481777, 365.8760068719317, 377.12760808105713, 344.1484023509532, 367.81466428537345, 354.1624905405883, 336.1698100225942, 371.15935105878555, 359.13591607154984, 325.2407504291808, 317.18519853398607, 338.9122814990384, 343.5724599772756, 151.254299257024, 251.25484856324124, 327.2197517124393, 333.6091873282898, 342.43327898639666, 129.00567631934754, 371.12266692426766, 174.51361083984398, 218.27945232759595, 364.4699809904713, 353.5251539084159, 359.87098206571426, 344.53305609929396, 127.0037796554463, 343.7788429141303, 360.57242888586245, 374.8806884765629, 332.29325022930396, 315.2192613052283, 379.1225545704578, 364.40574352513636, 375.03040429413227, 368.3651970340791, 384.34083251953143, 375.0439453125007, 373.9625854492192, 308.622896934244, 354.6804312811837, 315.2426031028508, 313.97115924053986, 319.51492798128464, 95.43839707123573, 314.8390285469258, 357.64827337692384, 125.30082243917218, 347.09590712762775, 357.8117741711684, 378.6343090074505, 342.6476684527116, 367.28810762087585, 361.9587690858039, 379.94776294893865, 359.72289146335476, 360.8966120025557, 180.06925884855696, 374.2108164299532, 347.5857735966584, 380.48386504917266, 372.8566641122906, 384.43173477204385, 347.5292236328128, 372.0254757178961, 375.4682744693948, 328.6946367784905, 377.1093146204555, 334.352578664214, 358.88234361857906, 285.72435881051746, 362.56646341724763], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 27, 50, 50, 50, 50, 23, 50, 34, 50, 50, 50, 50, 50, 26, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 19, 50, 50, 22, 50, 50, 50, 50, 50, 50, 50, 50, 50, 32, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.762939275043111, "mean_inference_ms": 1.3024343139268995, "mean_action_processing_ms": 0.21414213120096676, "mean_env_wait_ms": 335.2554844648062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010935306549072266, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.1806783676147461}, "num_episodes": 10, "episode_return_max": 384.43173477204385, "episode_return_min": 95.43839707123573, "episode_return_mean": 335.32797151672514, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 322044, "num_agent_steps_trained": 322044, "num_env_steps_sampled": 322044, "num_env_steps_trained": 322044, "num_env_steps_sampled_this_iter": 516, "num_env_steps_trained_this_iter": 516, "num_env_steps_sampled_throughput_per_sec": 13.75615974923179, "num_env_steps_trained_throughput_per_sec": 13.75615974923179, "timesteps_total": 322044, "num_env_steps_sampled_lifetime": 322044, "num_agent_steps_sampled_lifetime": 322044, "num_steps_trained_this_iter": 516, "agent_timesteps_total": 322044, "timers": {"training_iteration_time_ms": 34341.035, "restore_workers_time_ms": 0.017, "training_step_time_ms": 34340.987, "sample_time_ms": 33563.989, "load_time_ms": 1.322, "load_throughput": 390385.985, "learn_time_ms": 761.783, "learn_throughput": 677.358, "synch_weights_time_ms": 13.655}, "counters": {"num_env_steps_sampled": 322044, "num_env_steps_trained": 322044, "num_agent_steps_sampled": 322044, "num_agent_steps_trained": 322044}, "done": false, "episodes_total": 6537, "training_iteration": 308, "trial_id": "fd033_00000", "date": "2024-06-11_15-44-36", "timestamp": 1718142276, "time_this_iter_s": 37.51389122009277, "time_total_s": 21965.7062625885, "pid": 73974, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 541.2972021102905, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.562962962962956, "ram_util_percent": 13.68888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.48209021425242393, "cur_lr": 5e-06, "total_loss": 0.6833924074346821, "policy_loss": -0.006974318080271284, "vf_loss": 0.6898402088632186, "vf_explained_var": 0.3220742660264174, "kl": 0.0010921530818455015, "entropy": -1.7371368716160456, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 120.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 325074, "num_env_steps_trained": 325074, "num_agent_steps_sampled": 325074, "num_agent_steps_trained": 325074}, "sampler_results": {"episode_reward_max": 378.1629789624244, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 354.47987728231146, "episode_len_mean": 49.44444444444444, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 890, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.87389308566554, 357.1683537933273, 378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.35744775173276, "mean_inference_ms": 1.3073156046312908, "mean_action_processing_ms": 0.2171558927195941, "mean_env_wait_ms": 323.87120270913886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012755393981933594, "StateBufferConnector_ms": 0.006549888186984592, "ViewRequirementAgentConnector_ms": 0.1783384217156304}, "num_episodes": 18, "episode_return_max": 378.1629789624244, "episode_return_min": 253.92516170024493, "episode_return_mean": 354.47987728231146}, "env_runner_results": {"episode_reward_max": 378.1629789624244, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 354.47987728231146, "episode_len_mean": 49.44444444444444, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 890, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.87389308566554, 357.1683537933273, 378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.35744775173276, "mean_inference_ms": 1.3073156046312908, "mean_action_processing_ms": 0.2171558927195941, "mean_env_wait_ms": 323.87120270913886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012755393981933594, "StateBufferConnector_ms": 0.006549888186984592, "ViewRequirementAgentConnector_ms": 0.1783384217156304}, "num_episodes": 18, "episode_return_max": 378.1629789624244, "episode_return_min": 253.92516170024493, "episode_return_mean": 354.47987728231146}, "episode_reward_max": 378.1629789624244, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 354.47987728231146, "episode_len_mean": 49.44444444444444, "episodes_this_iter": 18, "episodes_timesteps_total": 890, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [360.87389308566554, 357.1683537933273, 378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.35744775173276, "mean_inference_ms": 1.3073156046312908, "mean_action_processing_ms": 0.2171558927195941, "mean_env_wait_ms": 323.87120270913886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012755393981933594, "StateBufferConnector_ms": 0.006549888186984592, "ViewRequirementAgentConnector_ms": 0.1783384217156304}, "num_episodes": 18, "episode_return_max": 378.1629789624244, "episode_return_min": 253.92516170024493, "episode_return_mean": 354.47987728231146, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 325074, "num_agent_steps_trained": 325074, "num_env_steps_sampled": 325074, "num_env_steps_trained": 325074, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 16.302674508926714, "num_env_steps_trained_throughput_per_sec": 16.302674508926714, "timesteps_total": 325074, "num_env_steps_sampled_lifetime": 325074, "num_agent_steps_sampled_lifetime": 325074, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 325074, "timers": {"training_iteration_time_ms": 62934.472, "restore_workers_time_ms": 0.023, "training_step_time_ms": 62934.401, "sample_time_ms": 61253.418, "load_time_ms": 1.794, "load_throughput": 572026.572, "learn_time_ms": 1664.198, "learn_throughput": 616.513, "synch_weights_time_ms": 14.372}, "counters": {"num_env_steps_sampled": 325074, "num_env_steps_trained": 325074, "num_agent_steps_sampled": 325074, "num_agent_steps_trained": 325074}, "done": false, "episodes_total": 6599, "training_iteration": 295, "trial_id": "fd033_00000", "date": "2024-06-11_15-45-58", "timestamp": 1718142358, "time_this_iter_s": 62.937463998794556, "time_total_s": 22141.511695623398, "pid": 87991, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 62.937463998794556, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.05555555555556, "ram_util_percent": 12.927777777777774}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.24104510712621197, "cur_lr": 5e-06, "total_loss": 0.626351315403978, "policy_loss": -0.010453565438122798, "vf_loss": 0.6330302406102419, "vf_explained_var": 0.40407389824589096, "kl": 0.0156594922639977, "entropy": -1.803318772216638, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 360.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 326100, "num_env_steps_trained": 326100, "num_agent_steps_sampled": 326100, "num_agent_steps_trained": 326100}, "sampler_results": {"episode_reward_max": 378.7215288001778, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 355.05312737088906, "episode_len_mean": 49.729729729729726, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 1840, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.87389308566554, 357.1683537933273, 378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987, 349.20550379865074, 377.90967317711426, 366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.416559713488015, "mean_inference_ms": 1.3062076430475202, "mean_action_processing_ms": 0.2169853909430228, "mean_env_wait_ms": 324.5798922825336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013607901495856207, "StateBufferConnector_ms": 0.006578419659588788, "ViewRequirementAgentConnector_ms": 0.17802264239336993}, "num_episodes": 19, "episode_return_max": 378.7215288001778, "episode_return_min": 253.92516170024493, "episode_return_mean": 355.05312737088906}, "env_runner_results": {"episode_reward_max": 378.7215288001778, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 355.05312737088906, "episode_len_mean": 49.729729729729726, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 1840, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.87389308566554, 357.1683537933273, 378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987, 349.20550379865074, 377.90967317711426, 366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.416559713488015, "mean_inference_ms": 1.3062076430475202, "mean_action_processing_ms": 0.2169853909430228, "mean_env_wait_ms": 324.5798922825336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013607901495856207, "StateBufferConnector_ms": 0.006578419659588788, "ViewRequirementAgentConnector_ms": 0.17802264239336993}, "num_episodes": 19, "episode_return_max": 378.7215288001778, "episode_return_min": 253.92516170024493, "episode_return_mean": 355.05312737088906}, "episode_reward_max": 378.7215288001778, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 355.05312737088906, "episode_len_mean": 49.729729729729726, "episodes_this_iter": 19, "episodes_timesteps_total": 1840, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [360.87389308566554, 357.1683537933273, 378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987, 349.20550379865074, 377.90967317711426, 366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.416559713488015, "mean_inference_ms": 1.3062076430475202, "mean_action_processing_ms": 0.2169853909430228, "mean_env_wait_ms": 324.5798922825336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013607901495856207, "StateBufferConnector_ms": 0.006578419659588788, "ViewRequirementAgentConnector_ms": 0.17802264239336993}, "num_episodes": 19, "episode_return_max": 378.7215288001778, "episode_return_min": 253.92516170024493, "episode_return_mean": 355.05312737088906, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 326100, "num_agent_steps_trained": 326100, "num_env_steps_sampled": 326100, "num_env_steps_trained": 326100, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 15.66987111058482, "num_env_steps_trained_throughput_per_sec": 15.66987111058482, "timesteps_total": 326100, "num_env_steps_sampled_lifetime": 326100, "num_agent_steps_sampled_lifetime": 326100, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 326100, "timers": {"training_iteration_time_ms": 64205.227, "restore_workers_time_ms": 0.021, "training_step_time_ms": 64205.157, "sample_time_ms": 62585.524, "load_time_ms": 1.499, "load_throughput": 684375.939, "learn_time_ms": 1603.653, "learn_throughput": 639.789, "synch_weights_time_ms": 13.986}, "counters": {"num_env_steps_sampled": 326100, "num_env_steps_trained": 326100, "num_agent_steps_sampled": 326100, "num_agent_steps_trained": 326100}, "done": false, "episodes_total": 6618, "training_iteration": 296, "trial_id": "fd033_00000", "date": "2024-06-11_15-47-03", "timestamp": 1718142423, "time_this_iter_s": 65.47904253005981, "time_total_s": 22206.990738153458, "pid": 87991, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 128.41650652885437, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.63936170212765, "ram_util_percent": 13.47127659574468}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.24104510712621197, "cur_lr": 5e-06, "total_loss": 0.7721448928117752, "policy_loss": -0.011034158429053302, "vf_loss": 0.7813210563113292, "vf_explained_var": 0.710713566839695, "kl": 0.007708077736606857, "entropy": -1.7702318504452705, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 600.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 327126, "num_env_steps_trained": 327126, "num_agent_steps_sampled": 327126, "num_agent_steps_trained": 327126}, "sampler_results": {"episode_reward_max": 378.7215288001778, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 354.71073479161424, "episode_len_mean": 49.833333333333336, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 2990, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.87389308566554, 357.1683537933273, 378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987, 349.20550379865074, 377.90967317711426, 366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525, 370.64122940801025, 372.2838734623762, 352.8016462151826, 367.73178165547944, 358.9268365363113, 352.01029184344384, 342.60806853233083, 339.37771382970794, 348.0798679254327, 342.12858238639234, 374.0920044945312, 360.13557767308004, 363.42899173980237, 344.66164312965384, 335.8782007599309, 366.5935752210436, 368.760080201274, 330.83222362871004, 365.95082764622424, 370.74854592040805, 315.77990161138536, 363.46655358348244, 338.7603573697661], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.527413331605865, "mean_inference_ms": 1.3035237964967508, "mean_action_processing_ms": 0.21699932931756638, "mean_env_wait_ms": 330.26438156155433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013562838236490885, "StateBufferConnector_ms": 0.006563266118367513, "ViewRequirementAgentConnector_ms": 0.1768930753072103}, "num_episodes": 23, "episode_return_max": 378.7215288001778, "episode_return_min": 253.92516170024493, "episode_return_mean": 354.71073479161424}, "env_runner_results": {"episode_reward_max": 378.7215288001778, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 354.71073479161424, "episode_len_mean": 49.833333333333336, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 2990, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.87389308566554, 357.1683537933273, 378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987, 349.20550379865074, 377.90967317711426, 366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525, 370.64122940801025, 372.2838734623762, 352.8016462151826, 367.73178165547944, 358.9268365363113, 352.01029184344384, 342.60806853233083, 339.37771382970794, 348.0798679254327, 342.12858238639234, 374.0920044945312, 360.13557767308004, 363.42899173980237, 344.66164312965384, 335.8782007599309, 366.5935752210436, 368.760080201274, 330.83222362871004, 365.95082764622424, 370.74854592040805, 315.77990161138536, 363.46655358348244, 338.7603573697661], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.527413331605865, "mean_inference_ms": 1.3035237964967508, "mean_action_processing_ms": 0.21699932931756638, "mean_env_wait_ms": 330.26438156155433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013562838236490885, "StateBufferConnector_ms": 0.006563266118367513, "ViewRequirementAgentConnector_ms": 0.1768930753072103}, "num_episodes": 23, "episode_return_max": 378.7215288001778, "episode_return_min": 253.92516170024493, "episode_return_mean": 354.71073479161424}, "episode_reward_max": 378.7215288001778, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 354.71073479161424, "episode_len_mean": 49.833333333333336, "episodes_this_iter": 23, "episodes_timesteps_total": 2990, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [360.87389308566554, 357.1683537933273, 378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987, 349.20550379865074, 377.90967317711426, 366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525, 370.64122940801025, 372.2838734623762, 352.8016462151826, 367.73178165547944, 358.9268365363113, 352.01029184344384, 342.60806853233083, 339.37771382970794, 348.0798679254327, 342.12858238639234, 374.0920044945312, 360.13557767308004, 363.42899173980237, 344.66164312965384, 335.8782007599309, 366.5935752210436, 368.760080201274, 330.83222362871004, 365.95082764622424, 370.74854592040805, 315.77990161138536, 363.46655358348244, 338.7603573697661], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.527413331605865, "mean_inference_ms": 1.3035237964967508, "mean_action_processing_ms": 0.21699932931756638, "mean_env_wait_ms": 330.26438156155433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013562838236490885, "StateBufferConnector_ms": 0.006563266118367513, "ViewRequirementAgentConnector_ms": 0.1768930753072103}, "num_episodes": 23, "episode_return_max": 378.7215288001778, "episode_return_min": 253.92516170024493, "episode_return_mean": 354.71073479161424, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 327126, "num_agent_steps_trained": 327126, "num_env_steps_sampled": 327126, "num_env_steps_trained": 327126, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 14.123052330261876, "num_env_steps_trained_throughput_per_sec": 14.123052330261876, "timesteps_total": 327126, "num_env_steps_sampled_lifetime": 327126, "num_agent_steps_sampled_lifetime": 327126, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 327126, "timers": {"training_iteration_time_ms": 67019.217, "restore_workers_time_ms": 0.019, "training_step_time_ms": 67019.154, "sample_time_ms": 65435.039, "load_time_ms": 1.428, "load_throughput": 718543.313, "learn_time_ms": 1568.559, "learn_throughput": 654.104, "synch_weights_time_ms": 13.707}, "counters": {"num_env_steps_sampled": 327126, "num_env_steps_trained": 327126, "num_agent_steps_sampled": 327126, "num_agent_steps_trained": 327126}, "done": false, "episodes_total": 6641, "training_iteration": 297, "trial_id": "fd033_00000", "date": "2024-06-11_15-48-16", "timestamp": 1718142496, "time_this_iter_s": 72.6509530544281, "time_total_s": 22279.641691207886, "pid": 87991, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 201.06745958328247, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 41.199999999999996, "ram_util_percent": 13.861538461538466}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.24104510712621197, "cur_lr": 5e-06, "total_loss": 0.6869546157618364, "policy_loss": -0.009047982496364662, "vf_loss": 0.6939931277185678, "vf_explained_var": 0.3761594315369924, "kl": 0.008336502773939823, "entropy": -1.7534211724996567, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 840.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 328152, "num_env_steps_trained": 328152, "num_agent_steps_sampled": 328152, "num_agent_steps_trained": 328152}, "sampler_results": {"episode_reward_max": 378.7215288001778, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 354.8649993795094, "episode_len_mean": 49.87179487179487, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3890, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.87389308566554, 357.1683537933273, 378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987, 349.20550379865074, 377.90967317711426, 366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525, 370.64122940801025, 372.2838734623762, 352.8016462151826, 367.73178165547944, 358.9268365363113, 352.01029184344384, 342.60806853233083, 339.37771382970794, 348.0798679254327, 342.12858238639234, 374.0920044945312, 360.13557767308004, 363.42899173980237, 344.66164312965384, 335.8782007599309, 366.5935752210436, 368.760080201274, 330.83222362871004, 365.95082764622424, 370.74854592040805, 315.77990161138536, 363.46655358348244, 338.7603573697661, 377.71365675454234, 346.7835445634305, 353.2432666269401, 369.45287306907403, 370.4397075981227, 348.26455708891564, 367.54609840091285, 367.2298951255231, 323.7261551711883, 371.2698522706384, 357.9386419223188, 360.8614143070788, 349.2992830223777, 353.07537504908544, 324.23669522706297, 365.6089471268586, 323.9729044927061, 366.16299628810964], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5435931032763754, "mean_inference_ms": 1.301802583657225, "mean_action_processing_ms": 0.21683956682340152, "mean_env_wait_ms": 333.67589072902433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012834255511944111, "StateBufferConnector_ms": 0.006557427919827974, "ViewRequirementAgentConnector_ms": 0.17752402868026343}, "num_episodes": 18, "episode_return_max": 378.7215288001778, "episode_return_min": 253.92516170024493, "episode_return_mean": 354.8649993795094}, "env_runner_results": {"episode_reward_max": 378.7215288001778, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 354.8649993795094, "episode_len_mean": 49.87179487179487, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3890, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.87389308566554, 357.1683537933273, 378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987, 349.20550379865074, 377.90967317711426, 366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525, 370.64122940801025, 372.2838734623762, 352.8016462151826, 367.73178165547944, 358.9268365363113, 352.01029184344384, 342.60806853233083, 339.37771382970794, 348.0798679254327, 342.12858238639234, 374.0920044945312, 360.13557767308004, 363.42899173980237, 344.66164312965384, 335.8782007599309, 366.5935752210436, 368.760080201274, 330.83222362871004, 365.95082764622424, 370.74854592040805, 315.77990161138536, 363.46655358348244, 338.7603573697661, 377.71365675454234, 346.7835445634305, 353.2432666269401, 369.45287306907403, 370.4397075981227, 348.26455708891564, 367.54609840091285, 367.2298951255231, 323.7261551711883, 371.2698522706384, 357.9386419223188, 360.8614143070788, 349.2992830223777, 353.07537504908544, 324.23669522706297, 365.6089471268586, 323.9729044927061, 366.16299628810964], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5435931032763754, "mean_inference_ms": 1.301802583657225, "mean_action_processing_ms": 0.21683956682340152, "mean_env_wait_ms": 333.67589072902433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012834255511944111, "StateBufferConnector_ms": 0.006557427919827974, "ViewRequirementAgentConnector_ms": 0.17752402868026343}, "num_episodes": 18, "episode_return_max": 378.7215288001778, "episode_return_min": 253.92516170024493, "episode_return_mean": 354.8649993795094}, "episode_reward_max": 378.7215288001778, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 354.8649993795094, "episode_len_mean": 49.87179487179487, "episodes_this_iter": 18, "episodes_timesteps_total": 3890, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [360.87389308566554, 357.1683537933273, 378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987, 349.20550379865074, 377.90967317711426, 366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525, 370.64122940801025, 372.2838734623762, 352.8016462151826, 367.73178165547944, 358.9268365363113, 352.01029184344384, 342.60806853233083, 339.37771382970794, 348.0798679254327, 342.12858238639234, 374.0920044945312, 360.13557767308004, 363.42899173980237, 344.66164312965384, 335.8782007599309, 366.5935752210436, 368.760080201274, 330.83222362871004, 365.95082764622424, 370.74854592040805, 315.77990161138536, 363.46655358348244, 338.7603573697661, 377.71365675454234, 346.7835445634305, 353.2432666269401, 369.45287306907403, 370.4397075981227, 348.26455708891564, 367.54609840091285, 367.2298951255231, 323.7261551711883, 371.2698522706384, 357.9386419223188, 360.8614143070788, 349.2992830223777, 353.07537504908544, 324.23669522706297, 365.6089471268586, 323.9729044927061, 366.16299628810964], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5435931032763754, "mean_inference_ms": 1.301802583657225, "mean_action_processing_ms": 0.21683956682340152, "mean_env_wait_ms": 333.67589072902433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012834255511944111, "StateBufferConnector_ms": 0.006557427919827974, "ViewRequirementAgentConnector_ms": 0.17752402868026343}, "num_episodes": 18, "episode_return_max": 378.7215288001778, "episode_return_min": 253.92516170024493, "episode_return_mean": 354.8649993795094, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328152, "num_agent_steps_trained": 328152, "num_env_steps_sampled": 328152, "num_env_steps_trained": 328152, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 13.559086926128822, "num_env_steps_trained_throughput_per_sec": 13.559086926128822, "timesteps_total": 328152, "num_env_steps_sampled_lifetime": 328152, "num_agent_steps_sampled_lifetime": 328152, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 328152, "timers": {"training_iteration_time_ms": 69181.619, "restore_workers_time_ms": 0.019, "training_step_time_ms": 69181.557, "sample_time_ms": 67597.918, "load_time_ms": 1.412, "load_throughput": 726427.398, "learn_time_ms": 1568.225, "learn_throughput": 654.243, "synch_weights_time_ms": 13.603}, "counters": {"num_env_steps_sampled": 328152, "num_env_steps_trained": 328152, "num_agent_steps_sampled": 328152, "num_agent_steps_trained": 328152}, "done": false, "episodes_total": 6659, "training_iteration": 298, "trial_id": "fd033_00000", "date": "2024-06-11_15-49-32", "timestamp": 1718142572, "time_this_iter_s": 75.67289233207703, "time_total_s": 22355.314583539963, "pid": 87991, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 276.7403519153595, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.65648148148148, "ram_util_percent": 14.090740740740738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.24104510712621197, "cur_lr": 5e-06, "total_loss": 0.7239462020496528, "policy_loss": -0.0038622584640203663, "vf_loss": 0.7237925286094348, "vf_explained_var": 0.5710290543735027, "kl": 0.01666052382109581, "entropy": -1.8085466494162878, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1080.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 329178, "num_env_steps_trained": 329178, "num_agent_steps_sampled": 329178, "num_agent_steps_trained": 329178}, "sampler_results": {"episode_reward_max": 378.7215288001778, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 355.05952817814745, "episode_len_mean": 49.9, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 4990, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987, 349.20550379865074, 377.90967317711426, 366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525, 370.64122940801025, 372.2838734623762, 352.8016462151826, 367.73178165547944, 358.9268365363113, 352.01029184344384, 342.60806853233083, 339.37771382970794, 348.0798679254327, 342.12858238639234, 374.0920044945312, 360.13557767308004, 363.42899173980237, 344.66164312965384, 335.8782007599309, 366.5935752210436, 368.760080201274, 330.83222362871004, 365.95082764622424, 370.74854592040805, 315.77990161138536, 363.46655358348244, 338.7603573697661, 377.71365675454234, 346.7835445634305, 353.2432666269401, 369.45287306907403, 370.4397075981227, 348.26455708891564, 367.54609840091285, 367.2298951255231, 323.7261551711883, 371.2698522706384, 357.9386419223188, 360.8614143070788, 349.2992830223777, 353.07537504908544, 324.23669522706297, 365.6089471268586, 323.9729044927061, 366.16299628810964, 363.7528716749237, 370.7788606006985, 325.51211892614566, 369.67469961794035, 348.1575998929918, 336.8405521089153, 373.19793569305466, 360.6726693695484, 354.47267316375365, 373.79484493452014, 378.28255212704465, 357.90582927673273, 358.0471274405802, 325.44208102370226, 341.8791659676836, 325.6304046376929, 365.67523094892715, 362.3584752634007, 363.8490934678369, 363.6324063139484, 368.5531678441687, 361.67319476986546, 356.91220030585265, 337.8293577220686], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.599397117149949, "mean_inference_ms": 1.3001724238263588, "mean_action_processing_ms": 0.216620173887868, "mean_env_wait_ms": 334.24448584197904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012353897094726562, "StateBufferConnector_ms": 0.006602048873901367, "ViewRequirementAgentConnector_ms": 0.1782364845275879}, "num_episodes": 24, "episode_return_max": 378.7215288001778, "episode_return_min": 253.92516170024493, "episode_return_mean": 355.05952817814745}, "env_runner_results": {"episode_reward_max": 378.7215288001778, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 355.05952817814745, "episode_len_mean": 49.9, "episode_media": {}, "episodes_this_iter": 24, "episodes_timesteps_total": 4990, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987, 349.20550379865074, 377.90967317711426, 366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525, 370.64122940801025, 372.2838734623762, 352.8016462151826, 367.73178165547944, 358.9268365363113, 352.01029184344384, 342.60806853233083, 339.37771382970794, 348.0798679254327, 342.12858238639234, 374.0920044945312, 360.13557767308004, 363.42899173980237, 344.66164312965384, 335.8782007599309, 366.5935752210436, 368.760080201274, 330.83222362871004, 365.95082764622424, 370.74854592040805, 315.77990161138536, 363.46655358348244, 338.7603573697661, 377.71365675454234, 346.7835445634305, 353.2432666269401, 369.45287306907403, 370.4397075981227, 348.26455708891564, 367.54609840091285, 367.2298951255231, 323.7261551711883, 371.2698522706384, 357.9386419223188, 360.8614143070788, 349.2992830223777, 353.07537504908544, 324.23669522706297, 365.6089471268586, 323.9729044927061, 366.16299628810964, 363.7528716749237, 370.7788606006985, 325.51211892614566, 369.67469961794035, 348.1575998929918, 336.8405521089153, 373.19793569305466, 360.6726693695484, 354.47267316375365, 373.79484493452014, 378.28255212704465, 357.90582927673273, 358.0471274405802, 325.44208102370226, 341.8791659676836, 325.6304046376929, 365.67523094892715, 362.3584752634007, 363.8490934678369, 363.6324063139484, 368.5531678441687, 361.67319476986546, 356.91220030585265, 337.8293577220686], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.599397117149949, "mean_inference_ms": 1.3001724238263588, "mean_action_processing_ms": 0.216620173887868, "mean_env_wait_ms": 334.24448584197904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012353897094726562, "StateBufferConnector_ms": 0.006602048873901367, "ViewRequirementAgentConnector_ms": 0.1782364845275879}, "num_episodes": 24, "episode_return_max": 378.7215288001778, "episode_return_min": 253.92516170024493, "episode_return_mean": 355.05952817814745}, "episode_reward_max": 378.7215288001778, "episode_reward_min": 253.92516170024493, "episode_reward_mean": 355.05952817814745, "episode_len_mean": 49.9, "episodes_this_iter": 24, "episodes_timesteps_total": 4990, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [378.1629789624244, 362.04433769108624, 370.75502633971126, 365.7762658621821, 340.40394529683266, 351.85129466554577, 362.8012302948303, 360.02787936025163, 363.0138722715546, 253.92516170024493, 376.5842090269627, 375.5049843748079, 332.08605778192947, 363.96402134484106, 345.89534474300945, 359.7989344863987, 349.20550379865074, 377.90967317711426, 366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525, 370.64122940801025, 372.2838734623762, 352.8016462151826, 367.73178165547944, 358.9268365363113, 352.01029184344384, 342.60806853233083, 339.37771382970794, 348.0798679254327, 342.12858238639234, 374.0920044945312, 360.13557767308004, 363.42899173980237, 344.66164312965384, 335.8782007599309, 366.5935752210436, 368.760080201274, 330.83222362871004, 365.95082764622424, 370.74854592040805, 315.77990161138536, 363.46655358348244, 338.7603573697661, 377.71365675454234, 346.7835445634305, 353.2432666269401, 369.45287306907403, 370.4397075981227, 348.26455708891564, 367.54609840091285, 367.2298951255231, 323.7261551711883, 371.2698522706384, 357.9386419223188, 360.8614143070788, 349.2992830223777, 353.07537504908544, 324.23669522706297, 365.6089471268586, 323.9729044927061, 366.16299628810964, 363.7528716749237, 370.7788606006985, 325.51211892614566, 369.67469961794035, 348.1575998929918, 336.8405521089153, 373.19793569305466, 360.6726693695484, 354.47267316375365, 373.79484493452014, 378.28255212704465, 357.90582927673273, 358.0471274405802, 325.44208102370226, 341.8791659676836, 325.6304046376929, 365.67523094892715, 362.3584752634007, 363.8490934678369, 363.6324063139484, 368.5531678441687, 361.67319476986546, 356.91220030585265, 337.8293577220686], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 40, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.599397117149949, "mean_inference_ms": 1.3001724238263588, "mean_action_processing_ms": 0.216620173887868, "mean_env_wait_ms": 334.24448584197904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012353897094726562, "StateBufferConnector_ms": 0.006602048873901367, "ViewRequirementAgentConnector_ms": 0.1782364845275879}, "num_episodes": 24, "episode_return_max": 378.7215288001778, "episode_return_min": 253.92516170024493, "episode_return_mean": 355.05952817814745, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 329178, "num_agent_steps_trained": 329178, "num_env_steps_sampled": 329178, "num_env_steps_trained": 329178, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 16.2529703274237, "num_env_steps_trained_throughput_per_sec": 16.2529703274237, "timesteps_total": 329178, "num_env_steps_sampled_lifetime": 329178, "num_agent_steps_sampled_lifetime": 329178, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 329178, "timers": {"training_iteration_time_ms": 67970.683, "restore_workers_time_ms": 0.019, "training_step_time_ms": 67970.621, "sample_time_ms": 66386.586, "load_time_ms": 1.388, "load_throughput": 739433.641, "learn_time_ms": 1568.611, "learn_throughput": 654.082, "synch_weights_time_ms": 13.656}, "counters": {"num_env_steps_sampled": 329178, "num_env_steps_trained": 329178, "num_agent_steps_sampled": 329178, "num_agent_steps_trained": 329178}, "done": false, "episodes_total": 6683, "training_iteration": 299, "trial_id": "fd033_00000", "date": "2024-06-11_15-50-35", "timestamp": 1718142635, "time_this_iter_s": 63.13063168525696, "time_total_s": 22418.44521522522, "pid": 87991, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 339.87098360061646, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.842222222222226, "ram_util_percent": 13.413333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.24104510712621197, "cur_lr": 5e-06, "total_loss": 0.8943729430437088, "policy_loss": -0.009863840563533207, "vf_loss": 0.9010780478517214, "vf_explained_var": 0.5050740778446198, "kl": 0.01310429557828128, "entropy": -1.6719433282812437, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1320.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 330204, "num_env_steps_trained": 330204, "num_agent_steps_sampled": 330204, "num_agent_steps_trained": 330204}, "sampler_results": {"episode_reward_max": 378.7215288001778, "episode_reward_min": 289.59534828718324, "episode_reward_mean": 353.6822199456674, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525, 370.64122940801025, 372.2838734623762, 352.8016462151826, 367.73178165547944, 358.9268365363113, 352.01029184344384, 342.60806853233083, 339.37771382970794, 348.0798679254327, 342.12858238639234, 374.0920044945312, 360.13557767308004, 363.42899173980237, 344.66164312965384, 335.8782007599309, 366.5935752210436, 368.760080201274, 330.83222362871004, 365.95082764622424, 370.74854592040805, 315.77990161138536, 363.46655358348244, 338.7603573697661, 377.71365675454234, 346.7835445634305, 353.2432666269401, 369.45287306907403, 370.4397075981227, 348.26455708891564, 367.54609840091285, 367.2298951255231, 323.7261551711883, 371.2698522706384, 357.9386419223188, 360.8614143070788, 349.2992830223777, 353.07537504908544, 324.23669522706297, 365.6089471268586, 323.9729044927061, 366.16299628810964, 363.7528716749237, 370.7788606006985, 325.51211892614566, 369.67469961794035, 348.1575998929918, 336.8405521089153, 373.19793569305466, 360.6726693695484, 354.47267316375365, 373.79484493452014, 378.28255212704465, 357.90582927673273, 358.0471274405802, 325.44208102370226, 341.8791659676836, 325.6304046376929, 365.67523094892715, 362.3584752634007, 363.8490934678369, 363.6324063139484, 368.5531678441687, 361.67319476986546, 356.91220030585265, 337.8293577220686, 336.9418082078319, 370.36954561845056, 351.3460205078129, 363.0406973823673, 351.42172485001214, 354.52978458486484, 332.88646930671865, 353.96954433381273, 357.6764307498352, 349.00437567053024, 330.5113717970129, 357.0222084919899, 361.2471675907318, 339.6820296274446, 314.70285274659096, 375.59413075206805, 362.4383874251145, 289.59534828718324], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6594851172556355, "mean_inference_ms": 1.2985854287842375, "mean_action_processing_ms": 0.21653269851475096, "mean_env_wait_ms": 336.79244341984685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012015581130981445, "StateBufferConnector_ms": 0.0066165924072265625, "ViewRequirementAgentConnector_ms": 0.17882251739501953}, "num_episodes": 18, "episode_return_max": 378.7215288001778, "episode_return_min": 289.59534828718324, "episode_return_mean": 353.6822199456674}, "env_runner_results": {"episode_reward_max": 378.7215288001778, "episode_reward_min": 289.59534828718324, "episode_reward_mean": 353.6822199456674, "episode_len_mean": 50.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525, 370.64122940801025, 372.2838734623762, 352.8016462151826, 367.73178165547944, 358.9268365363113, 352.01029184344384, 342.60806853233083, 339.37771382970794, 348.0798679254327, 342.12858238639234, 374.0920044945312, 360.13557767308004, 363.42899173980237, 344.66164312965384, 335.8782007599309, 366.5935752210436, 368.760080201274, 330.83222362871004, 365.95082764622424, 370.74854592040805, 315.77990161138536, 363.46655358348244, 338.7603573697661, 377.71365675454234, 346.7835445634305, 353.2432666269401, 369.45287306907403, 370.4397075981227, 348.26455708891564, 367.54609840091285, 367.2298951255231, 323.7261551711883, 371.2698522706384, 357.9386419223188, 360.8614143070788, 349.2992830223777, 353.07537504908544, 324.23669522706297, 365.6089471268586, 323.9729044927061, 366.16299628810964, 363.7528716749237, 370.7788606006985, 325.51211892614566, 369.67469961794035, 348.1575998929918, 336.8405521089153, 373.19793569305466, 360.6726693695484, 354.47267316375365, 373.79484493452014, 378.28255212704465, 357.90582927673273, 358.0471274405802, 325.44208102370226, 341.8791659676836, 325.6304046376929, 365.67523094892715, 362.3584752634007, 363.8490934678369, 363.6324063139484, 368.5531678441687, 361.67319476986546, 356.91220030585265, 337.8293577220686, 336.9418082078319, 370.36954561845056, 351.3460205078129, 363.0406973823673, 351.42172485001214, 354.52978458486484, 332.88646930671865, 353.96954433381273, 357.6764307498352, 349.00437567053024, 330.5113717970129, 357.0222084919899, 361.2471675907318, 339.6820296274446, 314.70285274659096, 375.59413075206805, 362.4383874251145, 289.59534828718324], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6594851172556355, "mean_inference_ms": 1.2985854287842375, "mean_action_processing_ms": 0.21653269851475096, "mean_env_wait_ms": 336.79244341984685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012015581130981445, "StateBufferConnector_ms": 0.0066165924072265625, "ViewRequirementAgentConnector_ms": 0.17882251739501953}, "num_episodes": 18, "episode_return_max": 378.7215288001778, "episode_return_min": 289.59534828718324, "episode_return_mean": 353.6822199456674}, "episode_reward_max": 378.7215288001778, "episode_reward_min": 289.59534828718324, "episode_reward_mean": 353.6822199456674, "episode_len_mean": 50.0, "episodes_this_iter": 18, "episodes_timesteps_total": 5000, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [366.5413202829665, 378.7215288001778, 361.6997217438501, 329.58600589286107, 362.81995312837756, 370.3933796634364, 350.97842628873303, 354.7504012705995, 346.27889039350936, 353.4117180000635, 329.18612726329474, 370.229585180009, 339.8969338456311, 351.948605666028, 343.4408634898783, 354.47775677839064, 364.85152697771525, 370.64122940801025, 372.2838734623762, 352.8016462151826, 367.73178165547944, 358.9268365363113, 352.01029184344384, 342.60806853233083, 339.37771382970794, 348.0798679254327, 342.12858238639234, 374.0920044945312, 360.13557767308004, 363.42899173980237, 344.66164312965384, 335.8782007599309, 366.5935752210436, 368.760080201274, 330.83222362871004, 365.95082764622424, 370.74854592040805, 315.77990161138536, 363.46655358348244, 338.7603573697661, 377.71365675454234, 346.7835445634305, 353.2432666269401, 369.45287306907403, 370.4397075981227, 348.26455708891564, 367.54609840091285, 367.2298951255231, 323.7261551711883, 371.2698522706384, 357.9386419223188, 360.8614143070788, 349.2992830223777, 353.07537504908544, 324.23669522706297, 365.6089471268586, 323.9729044927061, 366.16299628810964, 363.7528716749237, 370.7788606006985, 325.51211892614566, 369.67469961794035, 348.1575998929918, 336.8405521089153, 373.19793569305466, 360.6726693695484, 354.47267316375365, 373.79484493452014, 378.28255212704465, 357.90582927673273, 358.0471274405802, 325.44208102370226, 341.8791659676836, 325.6304046376929, 365.67523094892715, 362.3584752634007, 363.8490934678369, 363.6324063139484, 368.5531678441687, 361.67319476986546, 356.91220030585265, 337.8293577220686, 336.9418082078319, 370.36954561845056, 351.3460205078129, 363.0406973823673, 351.42172485001214, 354.52978458486484, 332.88646930671865, 353.96954433381273, 357.6764307498352, 349.00437567053024, 330.5113717970129, 357.0222084919899, 361.2471675907318, 339.6820296274446, 314.70285274659096, 375.59413075206805, 362.4383874251145, 289.59534828718324], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6594851172556355, "mean_inference_ms": 1.2985854287842375, "mean_action_processing_ms": 0.21653269851475096, "mean_env_wait_ms": 336.79244341984685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012015581130981445, "StateBufferConnector_ms": 0.0066165924072265625, "ViewRequirementAgentConnector_ms": 0.17882251739501953}, "num_episodes": 18, "episode_return_max": 378.7215288001778, "episode_return_min": 289.59534828718324, "episode_return_mean": 353.6822199456674, "num_healthy_workers": 6, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 330204, "num_agent_steps_trained": 330204, "num_env_steps_sampled": 330204, "num_env_steps_trained": 330204, "num_env_steps_sampled_this_iter": 1026, "num_env_steps_trained_this_iter": 1026, "num_env_steps_sampled_throughput_per_sec": 15.240677458419261, "num_env_steps_trained_throughput_per_sec": 15.240677458419261, "timesteps_total": 330204, "num_env_steps_sampled_lifetime": 330204, "num_agent_steps_sampled_lifetime": 330204, "num_steps_trained_this_iter": 1026, "agent_timesteps_total": 330204, "timers": {"training_iteration_time_ms": 67862.212, "restore_workers_time_ms": 0.021, "training_step_time_ms": 67862.149, "sample_time_ms": 66278.483, "load_time_ms": 1.357, "load_throughput": 756257.262, "learn_time_ms": 1568.229, "learn_throughput": 654.241, "synch_weights_time_ms": 13.709}, "counters": {"num_env_steps_sampled": 330204, "num_env_steps_trained": 330204, "num_agent_steps_sampled": 330204, "num_agent_steps_trained": 330204}, "done": false, "episodes_total": 6701, "training_iteration": 300, "trial_id": "fd033_00000", "date": "2024-06-11_15-51-42", "timestamp": 1718142702, "time_this_iter_s": 67.3234281539917, "time_total_s": 22485.76864337921, "pid": 87991, "hostname": "r8i1n1", "node_ip": "10.159.28.40", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "Reactor-v8", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 1, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-06, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x147cc1308180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 1.0, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.37184341463865855, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.719391063766803, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6}, "time_since_restore": 407.19441175460815, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 44.95208333333333, "ram_util_percent": 14.097916666666663}}
